$ cd /workspace/shadcn-ui

$ grep -r "nextMaintenance" --include="*.ts" --include="*.tsx" --include="*.js" --include="*.jsx" .

./src/components/EngineHealthScore.tsx:    (engine.nextMaintenance.getTime() - new Date().getTime()) / (1000 * 60 * 60 * 24)
./src/components/EngineHealthScore.tsx:              <div>{engine.nextMaintenance.toLocaleDateString()}</div>
./src/components/EngineHealthScore.tsx:                   (engine.nextMaintenance.getTime() - engine.lastMaintenance.getTime())) * 100
./src/lib/cmapssData.ts:  nextMaintenance: string;
./src/lib/cmapssData.ts:    nextMaintenance: '2024-07-15',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-08-01',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-09-10',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-07-20',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-05-15',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-06-25',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-05-01',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-04-10',
./src/lib/cmapssData.ts:    nextMaintenance: '2024-03-05',
./src/lib/mockData.ts:  nextMaintenance: Date;
./src/lib/mockData.ts:    nextMaintenance: new Date(cmapssEngine.nextMaintenance)
$ grep -r "Engine.*not found" --include="*.ts" --include="*.tsx" .

./src/lib/cmapssData.ts:    throw new Error(`Engine ${engineId} not found`);
$ pnpm run build


> shadcnui@ build /workspace/shadcn-ui
> vite build

vite v5.4.20 building for production...
transforming...
✓ 3103 modules transformed.
rendering chunks...
computing gzip size...
dist/index.html                     1.01 kB │ gzip:   0.52 kB
dist/assets/index-CMmFfDSv.css     66.12 kB │ gzip:  11.43 kB
dist/assets/index-DtsWXmBJ.js   1,831.78 kB │ gzip: 514.88 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 13.92s
$ grep -r "Environment" --include="*.ts" --include="*.tsx" --include="*.js" --include="*.jsx" . | grep -i preset

./node_modules/.pnpm/jiti@1.21.7/node_modules/jiti/dist/babel.js:  `}},"./node_modules/.pnpm/@babel+preset-typescript@7.26.0_@babel+core@7.26.0/node_modules/@babel/preset-typescript/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var helperPluginUtils=__webpack_require__("./node_modules/.pnpm/@babel+helper-plugin-utils@7.25.9/node_modules/@babel/helper-plugin-utils/lib/index.js"),transformTypeScript=__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-typescript@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-typescript/lib/index.js");__webpack_require__("./node_modules/.pnpm/@babel+plugin-syntax-jsx@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-syntax-jsx/lib/index.js");var transformModulesCommonJS=__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-modules-commonjs@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-modules-commonjs/lib/index.js"),helperValidatorOption=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-option@7.25.9/node_modules/@babel/helper-validator-option/lib/index.js");function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var transformTypeScript__default=_interopDefault(transformTypeScript),transformModulesCommonJS__default=_interopDefault(transformModulesCommonJS);const v=new helperValidatorOption.OptionValidator("@babel/preset-typescript");var pluginRewriteTSImports=helperPluginUtils.declare((function({types:t,template}){function maybeReplace(source,path){source&&(t.isStringLiteral(source)?/[\\/]/.test(source.value)&&(source.value=source.value.replace(/(\.[mc]?)ts$/,"$1js").replace(/\.tsx$/,".js")):path.replaceWith(template.expression.ast`(${source} + "").replace(/([\\/].*\.[mc]?)tsx?$/, "$1js")`))}return{name:"preset-typescript/plugin-rewrite-ts-imports",visitor:{"ImportDeclaration|ExportAllDeclaration|ExportNamedDeclaration"(path){const node=path.node;"value"===(t.isImportDeclaration(node)?node.importKind:node.exportKind)&&maybeReplace(node.source,path.get("source"))},CallExpression(path){t.isImport(path.node.callee)&&maybeReplace(path.node.arguments[0],path.get("arguments.0"))},ImportExpression(path){maybeReplace(path.node.source,path.get("source"))}}}})),index=helperPluginUtils.declarePreset(((api,opts)=>{api.assertVersion(7);const{allExtensions,ignoreExtensions,allowNamespaces,disallowAmbiguousJSXLike,isTSX,jsxPragma,jsxPragmaFrag,onlyRemoveTypeImports,optimizeConstEnums,rewriteImportExtensions}=function(options={}){let{allowNamespaces=!0,jsxPragma,onlyRemoveTypeImports}=options;const TopLevelOptions_ignoreExtensions="ignoreExtensions",TopLevelOptions_disallowAmbiguousJSXLike="disallowAmbiguousJSXLike",TopLevelOptions_jsxPragmaFrag="jsxPragmaFrag",TopLevelOptions_optimizeConstEnums="optimizeConstEnums",TopLevelOptions_rewriteImportExtensions="rewriteImportExtensions",TopLevelOptions_allExtensions="allExtensions",TopLevelOptions_isTSX="isTSX",jsxPragmaFrag=v.validateStringOption(TopLevelOptions_jsxPragmaFrag,options.jsxPragmaFrag,"React.Fragment");var allExtensions=v.validateBooleanOption(TopLevelOptions_allExtensions,options.allExtensions,!1),isTSX=v.validateBooleanOption(TopLevelOptions_isTSX,options.isTSX,!1);isTSX&&v.invariant(allExtensions,"isTSX:true requires allExtensions:true");const ignoreExtensions=v.validateBooleanOption(TopLevelOptions_ignoreExtensions,options.ignoreExtensions,!1),disallowAmbiguousJSXLike=v.validateBooleanOption(TopLevelOptions_disallowAmbiguousJSXLike,options.disallowAmbiguousJSXLike,!1);disallowAmbiguousJSXLike&&v.invariant(allExtensions,"disallowAmbiguousJSXLike:true requires allExtensions:true");const normalized={ignoreExtensions,allowNamespaces,disallowAmbiguousJSXLike,jsxPragma,jsxPragmaFrag,onlyRemoveTypeImports,optimizeConstEnums:v.validateBooleanOption(TopLevelOptions_optimizeConstEnums,options.optimizeConstEnums,!1),rewriteImportExtensions:v.validateBooleanOption(TopLevelOptions_rewriteImportExtensions,options.rewriteImportExtensions,!1)};return normalized.allExtensions=allExtensions,normalized.isTSX=isTSX,normalized}(opts),pluginOptions=disallowAmbiguousJSXLike=>({allowDeclareFields:opts.allowDeclareFields,allowNamespaces,disallowAmbiguousJSXLike,jsxPragma,jsxPragmaFrag,onlyRemoveTypeImports,optimizeConstEnums}),getPlugins=(isTSX,disallowAmbiguousJSXLike)=>[[transformTypeScript__default.default,Object.assign({isTSX},pluginOptions(disallowAmbiguousJSXLike))]];return{plugins:rewriteImportExtensions?[pluginRewriteTSImports]:[],overrides:allExtensions||ignoreExtensions?[{plugins:getPlugins(isTSX,disallowAmbiguousJSXLike)}]:[{test:/\.ts$/,plugins:getPlugins(!1,!1)},{test:/\.mts$/,sourceType:"module",plugins:getPlugins(!1,!0)},{test:/\.cts$/,sourceType:"unambiguous",plugins:[[transformModulesCommonJS__default.default,{allowTopLevelThis:!0}],[transformTypeScript__default.default,pluginOptions(!0)]]},{test:/\.tsx$/,plugins:getPlugins(!0,!1)}]}}));exports.default=index},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/builder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function createTemplateBuilder(formatter,defaultOpts){const templateFnCache=new WeakMap,templateAstCache=new WeakMap,cachedOpts=defaultOpts||(0,_options.validate)(null);return Object.assign(((tpl,...args)=>{if("string"==typeof tpl){if(args.length>1)throw new Error("Unexpected extra params.");return extendedTrace((0,_string.default)(formatter,tpl,(0,_options.merge)(cachedOpts,(0,_options.validate)(args[0]))))}if(Array.isArray(tpl)){let builder=templateFnCache.get(tpl);return builder||(builder=(0,_literal.default)(formatter,tpl,cachedOpts),templateFnCache.set(tpl,builder)),extendedTrace(builder(args))}if("object"==typeof tpl&&tpl){if(args.length>0)throw new Error("Unexpected extra params.");return createTemplateBuilder(formatter,(0,_options.merge)(cachedOpts,(0,_options.validate)(tpl)))}throw new Error("Unexpected template param "+typeof tpl)}),{ast:(tpl,...args)=>{if("string"==typeof tpl){if(args.length>1)throw new Error("Unexpected extra params.");return(0,_string.default)(formatter,tpl,(0,_options.merge)((0,_options.merge)(cachedOpts,(0,_options.validate)(args[0])),NO_PLACEHOLDER))()}if(Array.isArray(tpl)){let builder=templateAstCache.get(tpl);return builder||(builder=(0,_literal.default)(formatter,tpl,(0,_options.merge)(cachedOpts,NO_PLACEHOLDER)),templateAstCache.set(tpl,builder)),builder(args)()}throw new Error("Unexpected template param "+typeof tpl)}})};var _options=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js"),_string=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/string.js"),_literal=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/literal.js");const NO_PLACEHOLDER=(0,_options.validate)({placeholderPattern:!1});function extendedTrace(fn){let rootStack="";try{throw new Error}catch(error){error.stack&&(rootStack=error.stack.split("\n").slice(3).join("\n"))}return arg=>{try{return fn(arg)}catch(err){throw err.stack+=`\n    =============\n${rootStack}`,err}}}},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/formatters.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.statements=exports.statement=exports.smart=exports.program=exports.expression=void 0;var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{assertExpressionStatement}=_t;function makeStatementFormatter(fn){return{code:str=>`/* @babel/template */;\n${str}`,validate:()=>{},unwrap:ast=>fn(ast.program.body.slice(1))}}exports.smart=makeStatementFormatter((body=>body.length>1?body:body[0])),exports.statements=makeStatementFormatter((body=>body)),exports.statement=makeStatementFormatter((body=>{if(0===body.length)throw new Error("Found nothing to return.");if(body.length>1)throw new Error("Found multiple statements but wanted one");return body[0]}));const expression=exports.expression={code:str=>`(\n${str}\n)`,validate:ast=>{if(ast.program.body.length>1)throw new Error("Found multiple statements but wanted one");if(0===expression.unwrap(ast).start)throw new Error("Parse result included parens.")},unwrap:({program})=>{const[stmt]=program.body;return assertExpressionStatement(stmt),stmt.expression}};exports.program={code:str=>str,validate:()=>{},unwrap:ast=>ast.program}},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.statements=exports.statement=exports.smart=exports.program=exports.expression=exports.default=void 0;var formatters=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/formatters.js"),_builder=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/builder.js");const smart=exports.smart=(0,_builder.default)(formatters.smart),statement=exports.statement=(0,_builder.default)(formatters.statement),statements=exports.statements=(0,_builder.default)(formatters.statements),expression=exports.expression=(0,_builder.default)(formatters.expression),program=exports.program=(0,_builder.default)(formatters.program);exports.default=Object.assign(smart.bind(void 0),{smart,statement,statements,expression,program,ast:smart.ast})},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/literal.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(formatter,tpl,opts){const{metadata,names}=function(formatter,tpl,opts){let prefix="BABEL_TPL$";const raw=tpl.join("");do{prefix="$$"+prefix}while(raw.includes(prefix));const{names,code}=function(tpl,prefix){const names=[];let code=tpl[0];for(let i=1;i<tpl.length;i++){const value=`${prefix}${i-1}`;names.push(value),code+=value+tpl[i]}return{names,code}}(tpl,prefix),metadata=(0,_parse.default)(formatter,formatter.code(code),{parser:opts.parser,placeholderWhitelist:new Set(names.concat(opts.placeholderWhitelist?Array.from(opts.placeholderWhitelist):[])),placeholderPattern:opts.placeholderPattern,preserveComments:opts.preserveComments,syntacticPlaceholders:opts.syntacticPlaceholders});return{metadata,names}}(formatter,tpl,opts);return arg=>{const defaultReplacements={};return arg.forEach(((replacement,i)=>{defaultReplacements[names[i]]=replacement})),arg=>{const replacements=(0,_options.normalizeReplacements)(arg);return replacements&&Object.keys(replacements).forEach((key=>{if(hasOwnProperty.call(defaultReplacements,key))throw new Error("Unexpected replacement overlap.")})),formatter.unwrap((0,_populate.default)(metadata,replacements?Object.assign(replacements,defaultReplacements):defaultReplacements))}}};var _options=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js"),_parse=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/parse.js"),_populate=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/populate.js")},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.merge=function(a,b){const{placeholderWhitelist=a.placeholderWhitelist,placeholderPattern=a.placeholderPattern,preserveComments=a.preserveComments,syntacticPlaceholders=a.syntacticPlaceholders}=b;return{parser:Object.assign({},a.parser,b.parser),placeholderWhitelist,placeholderPattern,preserveComments,syntacticPlaceholders}},exports.normalizeReplacements=function(replacements){if(Array.isArray(replacements))return replacements.reduce(((acc,replacement,i)=>(acc["$"+i]=replacement,acc)),{});if("object"==typeof replacements||null==replacements)return replacements||void 0;throw new Error("Template replacements must be an array, object, null, or undefined")},exports.validate=function(opts){if(null!=opts&&"object"!=typeof opts)throw new Error("Unknown template options.");const _ref=opts||{},{placeholderWhitelist,placeholderPattern,preserveComments,syntacticPlaceholders}=_ref,parser=function(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(_ref,_excluded);if(null!=placeholderWhitelist&&!(placeholderWhitelist instanceof Set))throw new Error("'.placeholderWhitelist' must be a Set, null, or undefined");if(null!=placeholderPattern&&!(placeholderPattern instanceof RegExp)&&!1!==placeholderPattern)throw new Error("'.placeholderPattern' must be a RegExp, false, null, or undefined");if(null!=preserveComments&&"boolean"!=typeof preserveComments)throw new Error("'.preserveComments' must be a boolean, null, or undefined");if(null!=syntacticPlaceholders&&"boolean"!=typeof syntacticPlaceholders)throw new Error("'.syntacticPlaceholders' must be a boolean, null, or undefined");if(!0===syntacticPlaceholders&&(null!=placeholderWhitelist||null!=placeholderPattern))throw new Error("'.placeholderWhitelist' and '.placeholderPattern' aren't compatible with '.syntacticPlaceholders: true'");return{parser,placeholderWhitelist:placeholderWhitelist||void 0,placeholderPattern:null==placeholderPattern?void 0:placeholderPattern,preserveComments:null==preserveComments?void 0:preserveComments,syntacticPlaceholders:null==syntacticPlaceholders?void 0:syntacticPlaceholders}};const _excluded=["placeholderWhitelist","placeholderPattern","preserveComments","syntacticPlaceholders"]},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/parse.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(formatter,code,opts){const{placeholderWhitelist,placeholderPattern,preserveComments,syntacticPlaceholders}=opts,ast=function(code,parserOpts,syntacticPlaceholders){const plugins=(parserOpts.plugins||[]).slice();!1!==syntacticPlaceholders&&plugins.push("placeholders");parserOpts=Object.assign({allowReturnOutsideFunction:!0,allowSuperOutsideMethod:!0,sourceType:"module"},parserOpts,{plugins});try{return(0,_parser.parse)(code,parserOpts)}catch(err){const loc=err.loc;throw loc&&(err.message+="\n"+(0,_codeFrame.codeFrameColumns)(code,{start:loc}),err.code="BABEL_TEMPLATE_PARSE_ERROR"),err}}(code,opts.parser,syntacticPlaceholders);removePropertiesDeep(ast,{preserveComments}),formatter.validate(ast);const state={syntactic:{placeholders:[],placeholderNames:new Set},legacy:{placeholders:[],placeholderNames:new Set},placeholderWhitelist,placeholderPattern,syntacticPlaceholders};return traverse(ast,placeholderVisitorHandler,state),Object.assign({ast},state.syntactic.placeholders.length?state.syntactic:state.legacy)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_parser=__webpack_require__("./node_modules/.pnpm/@babel+parser@7.26.3/node_modules/@babel/parser/lib/index.js"),_codeFrame=__webpack_require__("./stubs/babel-codeframe.js");const{isCallExpression,isExpressionStatement,isFunction,isIdentifier,isJSXIdentifier,isNewExpression,isPlaceholder,isStatement,isStringLiteral,removePropertiesDeep,traverse}=_t,PATTERN=/^[_$A-Z0-9]+$/;function placeholderVisitorHandler(node,ancestors,state){var _state$placeholderWhi;let name,hasSyntacticPlaceholders=state.syntactic.placeholders.length>0;if(isPlaceholder(node)){if(!1===state.syntacticPlaceholders)throw new Error("%%foo%%-style placeholders can't be used when '.syntacticPlaceholders' is false.");name=node.name.name,hasSyntacticPlaceholders=!0}else{if(hasSyntacticPlaceholders||state.syntacticPlaceholders)return;if(isIdentifier(node)||isJSXIdentifier(node))name=node.name;else{if(!isStringLiteral(node))return;name=node.value}}if(hasSyntacticPlaceholders&&(null!=state.placeholderPattern||null!=state.placeholderWhitelist))throw new Error("'.placeholderWhitelist' and '.placeholderPattern' aren't compatible with '.syntacticPlaceholders: true'");if(!(hasSyntacticPlaceholders||!1!==state.placeholderPattern&&(state.placeholderPattern||PATTERN).test(name)||null!=(_state$placeholderWhi=state.placeholderWhitelist)&&_state$placeholderWhi.has(name)))return;ancestors=ancestors.slice();const{node:parent,key}=ancestors[ancestors.length-1];let type;isStringLiteral(node)||isPlaceholder(node,{expectedNode:"StringLiteral"})?type="string":isNewExpression(parent)&&"arguments"===key||isCallExpression(parent)&&"arguments"===key||isFunction(parent)&&"params"===key?type="param":isExpressionStatement(parent)&&!isPlaceholder(node)?(type="statement",ancestors=ancestors.slice(0,-1)):type=isStatement(node)&&isPlaceholder(node)?"statement":"other";const{placeholders,placeholderNames}=hasSyntacticPlaceholders?state.syntactic:state.legacy;placeholders.push({name,type,resolve:ast=>function(ast,ancestors){let parent=ast;for(let i=0;i<ancestors.length-1;i++){const{key,index}=ancestors[i];parent=void 0===index?parent[key]:parent[key][index]}const{key,index}=ancestors[ancestors.length-1];return{parent,key,index}}(ast,ancestors),isDuplicate:placeholderNames.has(name)}),placeholderNames.add(name)}},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/populate.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(metadata,replacements){const ast=cloneNode(metadata.ast);replacements&&(metadata.placeholders.forEach((placeholder=>{if(!hasOwnProperty.call(replacements,placeholder.name)){const placeholderName=placeholder.name;throw new Error(`Error: No substitution given for "${placeholderName}". If this is not meant to be a\n            placeholder you may want to consider passing one of the following options to @babel/template:\n            - { placeholderPattern: false, placeholderWhitelist: new Set(['${placeholderName}'])}\n            - { placeholderPattern: /^${placeholderName}$/ }`)}})),Object.keys(replacements).forEach((key=>{if(!metadata.placeholderNames.has(key))throw new Error(`Unknown substitution "${key}" given`)})));return metadata.placeholders.slice().reverse().forEach((placeholder=>{try{!function(placeholder,ast,replacement){placeholder.isDuplicate&&(Array.isArray(replacement)?replacement=replacement.map((node=>cloneNode(node))):"object"==typeof replacement&&(replacement=cloneNode(replacement)));const{parent,key,index}=placeholder.resolve(ast);if("string"===placeholder.type){if("string"==typeof replacement&&(replacement=stringLiteral(replacement)),!replacement||!isStringLiteral(replacement))throw new Error("Expected string substitution")}else if("statement"===placeholder.type)void 0===index?replacement?Array.isArray(replacement)?replacement=blockStatement(replacement):"string"==typeof replacement?replacement=expressionStatement(identifier(replacement)):isStatement(replacement)||(replacement=expressionStatement(replacement)):replacement=emptyStatement():replacement&&!Array.isArray(replacement)&&("string"==typeof replacement&&(replacement=identifier(replacement)),isStatement(replacement)||(replacement=expressionStatement(replacement)));else if("param"===placeholder.type){if("string"==typeof replacement&&(replacement=identifier(replacement)),void 0===index)throw new Error("Assertion failure.")}else if("string"==typeof replacement&&(replacement=identifier(replacement)),Array.isArray(replacement))throw new Error("Cannot replace single expression with an array.");function set(parent,key,value){const node=parent[key];parent[key]=value,"Identifier"!==node.type&&"Placeholder"!==node.type||(node.typeAnnotation&&(value.typeAnnotation=node.typeAnnotation),node.optional&&(value.optional=node.optional),node.decorators&&(value.decorators=node.decorators))}if(void 0===index)validate(parent,key,replacement),set(parent,key,replacement);else{const items=parent[key].slice();"statement"===placeholder.type||"param"===placeholder.type?null==replacement?items.splice(index,1):Array.isArray(replacement)?items.splice(index,1,...replacement):set(items,index,replacement):set(items,index,replacement),validate(parent,key,items),parent[key]=items}}(placeholder,ast,replacements&&replacements[placeholder.name]||null)}catch(e){throw e.message=`@babel/template placeholder "${placeholder.name}": ${e.message}`,e}})),ast};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{blockStatement,cloneNode,emptyStatement,expressionStatement,identifier,isStatement,isStringLiteral,stringLiteral,validate}=_t},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/string.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(formatter,code,opts){let metadata;return code=formatter.code(code),arg=>{const replacements=(0,_options.normalizeReplacements)(arg);return metadata||(metadata=(0,_parse.default)(formatter,code,opts)),formatter.unwrap((0,_populate.default)(metadata,replacements))}};var _options=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js"),_parse=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/parse.js"),_populate=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/populate.js")},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=function(){clearPath(),clearScope()},exports.clearPath=clearPath,exports.clearScope=clearScope,exports.getCachedPaths=function(hub,parent){var _pathsCache$get;return null==(_pathsCache$get=pathsCache.get(null!=null?null:nullHub))?void 0:_pathsCache$get.get(parent)},exports.getOrCreateCachedPaths=function(hub,parent){0;let parents=pathsCache.get(null!=null?null:nullHub);parents||pathsCache.set(null!=null?null:nullHub,parents=new WeakMap);let paths=parents.get(parent);paths||parents.set(parent,paths=new Map);return paths},exports.scope=exports.path=void 0;let pathsCache=exports.path=new WeakMap,scope=exports.scope=new WeakMap;function clearPath(){exports.path=pathsCache=new WeakMap}function clearScope(){exports.scope=scope=new WeakMap}const nullHub=Object.freeze({})},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/context.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{VISITOR_KEYS}=_t;exports.default=class{constructor(scope,opts,state,parentPath){this.queue=null,this.priorityQueue=null,this.parentPath=parentPath,this.scope=scope,this.state=state,this.opts=opts}shouldVisit(node){const opts=this.opts;if(opts.enter||opts.exit)return!0;if(opts[node.type])return!0;const keys=VISITOR_KEYS[node.type];if(null==keys||!keys.length)return!1;for(const key of keys)if(node[key])return!0;return!1}create(node,container,key,listKey){return _index.default.get({parentPath:this.parentPath,parent:node,container,key,listKey})}maybeQueue(path,notPriority){this.queue&&(notPriority?this.queue.push(path):this.priorityQueue.push(path))}visitMultiple(container,parent,listKey){if(0===container.length)return!1;const queue=[];for(let key=0;key<container.length;key++){const node=container[key];node&&this.shouldVisit(node)&&queue.push(this.create(parent,container,key,listKey))}return this.visitQueue(queue)}visitSingle(node,key){return!!this.shouldVisit(node[key])&&this.visitQueue([this.create(node,node,key)])}visitQueue(queue){this.queue=queue,this.priorityQueue=[];const visited=new WeakSet;let stop=!1,visitIndex=0;for(;visitIndex<queue.length;){const path=queue[visitIndex];if(visitIndex++,_context.resync.call(path),0!==path.contexts.length&&path.contexts[path.contexts.length-1]===this||_context.pushContext.call(path,this),null===path.key)continue;const{node}=path;if(!visited.has(node)){if(node&&visited.add(node),path.visit()){stop=!0;break}if(this.priorityQueue.length&&(stop=this.visitQueue(this.priorityQueue),this.priorityQueue=[],this.queue=queue,stop))break}}for(let i=0;i<visitIndex;i++)_context.popContext.call(queue[i]);return this.queue=null,stop}visit(node,key){const nodes=node[key];return!!nodes&&(Array.isArray(nodes)?this.visitMultiple(nodes,node,key):this.visitSingle(node,key))}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/hub.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;exports.default=class{getCode(){}getScope(){}addHelper(){throw new Error("Helpers are not supported by the default hub.")}buildError(node,msg,Error=TypeError){return new Error(msg)}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Hub",{enumerable:!0,get:function(){return _hub.default}}),Object.defineProperty(exports,"NodePath",{enumerable:!0,get:function(){return _index.default}}),Object.defineProperty(exports,"Scope",{enumerable:!0,get:function(){return _index2.default}}),exports.visitors=exports.default=void 0,__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");var visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js");exports.visitors=visitors;var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_traverseNode=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/index.js"),_hub=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/hub.js");const{VISITOR_KEYS,removeProperties,traverseFast}=_t;function traverse(parent,opts={},scope,state,parentPath,visitSelf){if(parent){if(!opts.noScope&&!scope&&"Program"!==parent.type&&"File"!==parent.type)throw new Error(`You must pass a scope and parentPath unless traversing a Program/File. Instead of that you tried to traverse a ${parent.type} node without passing scope and parentPath.`);if(!parentPath&&visitSelf)throw new Error("visitSelf can only be used when providing a NodePath.");VISITOR_KEYS[parent.type]&&(visitors.explode(opts),(0,_traverseNode.traverseNode)(parent,opts,scope,state,parentPath,null,visitSelf))}}exports.default=traverse;function hasDenylistedType(path,state){path.node.type===state.type&&(state.has=!0,path.stop())}traverse.visitors=visitors,traverse.verify=visitors.verify,traverse.explode=visitors.explode,traverse.cheap=function(node,enter){traverseFast(node,enter)},traverse.node=function(node,opts,scope,state,path,skipKeys){(0,_traverseNode.traverseNode)(node,opts,scope,state,path,skipKeys)},traverse.clearNode=function(node,opts){removeProperties(node,opts)},traverse.removeProperties=function(tree,opts){return traverseFast(tree,traverse.clearNode,opts),tree},traverse.hasType=function(tree,type,denylistTypes){if(null!=denylistTypes&&denylistTypes.includes(tree.type))return!1;if(tree.type===type)return!0;const state={has:!1,type};return traverse(tree,{noScope:!0,denylist:denylistTypes,enter:hasDenylistedType},null,state),state.has},traverse.cache=cache},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/ancestry.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.find=function(callback){let path=this;do{if(callback(path))return path}while(path=path.parentPath);return null},exports.findParent=function(callback){let path=this;for(;path=path.parentPath;)if(callback(path))return path;return null},exports.getAncestry=function(){let path=this;const paths=[];do{paths.push(path)}while(path=path.parentPath);return paths},exports.getDeepestCommonAncestorFrom=function(paths,filter){if(!paths.length)return this;if(1===paths.length)return paths[0];let lastCommonIndex,lastCommon,minDepth=1/0;const ancestries=paths.map((path=>{const ancestry=[];do{ancestry.unshift(path)}while((path=path.parentPath)&&path!==this);return ancestry.length<minDepth&&(minDepth=ancestry.length),ancestry})),first=ancestries[0];depthLoop:for(let i=0;i<minDepth;i++){const shouldMatch=first[i];for(const ancestry of ancestries)if(ancestry[i]!==shouldMatch)break depthLoop;lastCommonIndex=i,lastCommon=shouldMatch}if(lastCommon)return filter?filter(lastCommon,lastCommonIndex,ancestries):lastCommon;throw new Error("Couldn't find intersection")},exports.getEarliestCommonAncestorFrom=function(paths){return this.getDeepestCommonAncestorFrom(paths,(function(deepest,i,ancestries){let earliest;const keys=VISITOR_KEYS[deepest.type];for(const ancestry of ancestries){const path=ancestry[i+1];if(!earliest){earliest=path;continue}if(path.listKey&&earliest.listKey===path.listKey&&path.key<earliest.key){earliest=path;continue}keys.indexOf(earliest.parentKey)>keys.indexOf(path.parentKey)&&(earliest=path)}return earliest}))},exports.getFunctionParent=function(){return this.findParent((p=>p.isFunction()))},exports.getStatementParent=function(){let path=this;do{if(!path.parentPath||Array.isArray(path.container)&&path.isStatement())break;path=path.parentPath}while(path);if(path&&(path.isProgram()||path.isFile()))throw new Error("File/Program node, we can't possibly find a statement parent to this");return path},exports.inType=function(...candidateTypes){let path=this;for(;path;){for(const type of candidateTypes)if(path.node.type===type)return!0;path=path.parentPath}return!1},exports.isAncestor=function(maybeDescendant){return maybeDescendant.isDescendant(this)},exports.isDescendant=function(maybeAncestor){return!!this.findParent((parent=>parent===maybeAncestor))};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{VISITOR_KEYS}=_t},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/comments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addComment=function(type,content,line){_addComment(this.node,type,content,line)},exports.addComments=function(type,comments){_addComments(this.node,type,comments)},exports.shareCommentsWithSiblings=function(){if("string"==typeof this.key)return;const node=this.node;if(!node)return;const trailing=node.trailingComments,leading=node.leadingComments;if(!trailing&&!leading)return;const prev=this.getSibling(this.key-1),next=this.getSibling(this.key+1),hasPrev=Boolean(prev.node),hasNext=Boolean(next.node);hasPrev&&(leading&&prev.addComments("trailing",removeIfExisting(leading,prev.node.trailingComments)),trailing&&!hasNext&&prev.addComments("trailing",trailing));hasNext&&(trailing&&next.addComments("leading",removeIfExisting(trailing,next.node.leadingComments)),leading&&!hasPrev&&next.addComments("leading",leading))};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{addComment:_addComment,addComments:_addComments}=_t;function removeIfExisting(list,toRemove){if(null==toRemove||!toRemove.length)return list;const set=new Set(toRemove);return list.filter((el=>!set.has(el)))}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._call=_call,exports._getQueueContexts=function(){let path=this,contexts=this.contexts;for(;!contexts.length&&(path=path.parentPath,path);)contexts=path.contexts;return contexts},exports._resyncKey=_resyncKey,exports._resyncList=_resyncList,exports._resyncParent=_resyncParent,exports._resyncRemoved=function(){null!=this.key&&this.container&&this.container[this.key]===this.node||_removal._markRemoved.call(this)},exports.call=call,exports.isDenylisted=isDenylisted,exports.popContext=function(){this.contexts.pop(),this.contexts.length>0?this.setContext(this.contexts[this.contexts.length-1]):this.setContext(void 0)},exports.pushContext=function(context){this.contexts.push(context),this.setContext(context)},exports.requeue=function(pathToQueue=this){if(pathToQueue.removed)return;const contexts=this.contexts;for(const context of contexts)context.maybeQueue(pathToQueue)},exports.requeueComputedKeyAndDecorators=function(){const{context,node}=this;!t.isPrivate(node)&&node.computed&&context.maybeQueue(this.get("key"));if(node.decorators)for(const decorator of this.get("decorators"))context.maybeQueue(decorator)},exports.resync=function(){if(this.removed)return;_resyncParent.call(this),_resyncList.call(this),_resyncKey.call(this)},exports.setContext=function(context){null!=this.skipKeys&&(this.skipKeys={});this._traverseFlags=0,context&&(this.context=context,this.state=context.state,this.opts=context.opts);return setScope.call(this),this},exports.setKey=setKey,exports.setScope=setScope,exports.setup=function(parentPath,container,listKey,key){this.listKey=listKey,this.container=container,this.parentPath=parentPath||this.parentPath,setKey.call(this,key)},exports.skip=function(){this.shouldSkip=!0},exports.skipKey=function(key){null==this.skipKeys&&(this.skipKeys={});this.skipKeys[key]=!0},exports.stop=function(){this._traverseFlags|=_index.SHOULD_SKIP|_index.SHOULD_STOP},exports.visit=function(){var _this$opts$shouldSkip,_this$opts;if(!this.node)return!1;if(this.isDenylisted())return!1;if(null!=(_this$opts$shouldSkip=(_this$opts=this.opts).shouldSkip)&&_this$opts$shouldSkip.call(_this$opts,this))return!1;const currentContext=this.context;if(this.shouldSkip||call.call(this,"enter"))return this.debug("Skip..."),this.shouldStop;return restoreContext(this,currentContext),this.debug("Recursing into..."),this.shouldStop=(0,_traverseNode.traverseNode)(this.node,this.opts,this.scope,this.state,this,this.skipKeys),restoreContext(this,currentContext),call.call(this,"exit"),this.shouldStop};var _traverseNode=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_removal=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js"),t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");function call(key){const opts=this.opts;return this.debug(key),!(!this.node||!_call.call(this,opts[key]))||!!this.node&&_call.call(this,null==(_opts$this$node$type=opts[this.node.type])?void 0:_opts$this$node$type[key]);var _opts$this$node$type}function _call(fns){if(!fns)return!1;for(const fn of fns){if(!fn)continue;const node=this.node;if(!node)return!0;const ret=fn.call(this.state,this,this.state);if(ret&&"object"==typeof ret&&"function"==typeof ret.then)throw new Error("You appear to be using a plugin with an async traversal visitor, which your current version of Babel does not support. If you're using a published plugin, you may need to upgrade your @babel/core version.");if(ret)throw new Error(`Unexpected return value from visitor method ${fn}`);if(this.node!==node)return!0;if(this._traverseFlags>0)return!0}return!1}function isDenylisted(){var _this$opts$denylist;const denylist=null!=(_this$opts$denylist=this.opts.denylist)?_this$opts$denylist:this.opts.blacklist;return null==denylist?void 0:denylist.includes(this.node.type)}function restoreContext(path,context){path.context!==context&&(path.context=context,path.state=context.state,path.opts=context.opts)}function setScope(){var _this$opts2,_this$scope;if(null!=(_this$opts2=this.opts)&&_this$opts2.noScope)return;let target,path=this.parentPath;for((("key"===this.key||"decorators"===this.listKey)&&path.isMethod()||"discriminant"===this.key&&path.isSwitchStatement())&&(path=path.parentPath);path&&!target;){var _path$opts;if(null!=(_path$opts=path.opts)&&_path$opts.noScope)return;target=path.scope,path=path.parentPath}this.scope=this.getScope(target),null==(_this$scope=this.scope)||_this$scope.init()}function _resyncParent(){this.parentPath&&(this.parent=this.parentPath.node)}function _resyncKey(){if(this.container&&this.node!==this.container[this.key]){if(Array.isArray(this.container)){for(let i=0;i<this.container.length;i++)if(this.container[i]===this.node)return void setKey.call(this,i)}else for(const key of Object.keys(this.container))if(this.container[key]===this.node)return void setKey.call(this,key);this.key=null}}function _resyncList(){if(!this.parent||!this.inList)return;const newContainer=this.parent[this.listKey];this.container!==newContainer&&(this.container=newContainer||null)}function setKey(key){var _this$node;this.key=key,this.node=this.container[this.key],this.type=null==(_this$node=this.node)?void 0:_this$node.type}exports.isBlacklisted=isDenylisted},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/conversion.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.arrowFunctionToExpression=function({allowInsertArrow=!0,allowInsertArrowWithRest=allowInsertArrow,noNewArrows=!(_arguments$=>null==(_arguments$=arguments[0])?void 0:_arguments$.specCompliant)()}={}){if(!this.isArrowFunctionExpression())throw this.buildCodeFrameError("Cannot convert non-arrow function to a function expression.");let self=this;var _self$ensureFunctionN;noNewArrows||(self=null!=(_self$ensureFunctionN=self.ensureFunctionName(!1))?_self$ensureFunctionN:self);const{thisBinding,fnPath:fn}=hoistFunctionEnvironment(self,noNewArrows,allowInsertArrow,allowInsertArrowWithRest);if(fn.ensureBlock(),function(path,type){path.node.type=type}(fn,"FunctionExpression"),!noNewArrows){const checkBinding=thisBinding?null:fn.scope.generateUidIdentifier("arrowCheckId");return checkBinding&&fn.parentPath.scope.push({id:checkBinding,init:objectExpression([])}),fn.get("body").unshiftContainer("body",expressionStatement(callExpression(this.hub.addHelper("newArrowCheck"),[thisExpression(),identifier(checkBinding?checkBinding.name:thisBinding)]))),fn.replaceWith(callExpression(memberExpression(fn.node,identifier("bind")),[checkBinding?identifier(checkBinding.name):thisExpression()])),fn.get("callee.object")}return fn},exports.ensureBlock=function(){const body=this.get("body"),bodyNode=body.node;if(Array.isArray(body))throw new Error("Can't convert array path to a block statement");if(!bodyNode)throw new Error("Can't convert node without a body");if(body.isBlockStatement())return bodyNode;const statements=[];let key,listKey,stringPath="body";body.isStatement()?(listKey="body",key=0,statements.push(body.node)):(stringPath+=".body.0",this.isFunction()?(key="argument",statements.push(returnStatement(body.node))):(key="expression",statements.push(expressionStatement(body.node))));this.node.body=blockStatement(statements);const parentPath=this.get(stringPath);return _context.setup.call(body,parentPath,listKey?parentPath.node[listKey]:parentPath.node,listKey,key),this.node},exports.ensureFunctionName=function(supportUnicodeId){if(this.node.id)return this;const res=getFunctionName(this.node,this.parent);if(null==res)return this;let{name}=res;if(!supportUnicodeId&&/[\uD800-\uDFFF]/.test(name))return null;if(name.startsWith("get ")||name.startsWith("set "))return null;name=toBindingIdentifierName(name.replace(/[/ ]/g,"_"));const id=identifier(name);inherits(id,res.originalNode);const state={needsRename:!1,name},{scope}=this,binding=scope.getOwnBinding(name);binding?"param"===binding.kind&&(state.needsRename=!0):(scope.parent.hasBinding(name)||scope.hasGlobal(name))&&this.traverse(refersOuterBindingVisitor,state);if(!state.needsRename)return this.node.id=id,scope.getProgramParent().references[id.name]=!0,this;if(scope.hasBinding(id.name)&&!scope.hasGlobal(id.name))return scope.rename(id.name),this.node.id=id,scope.getProgramParent().references[id.name]=!0,this;if(!isFunction(this.node))return null;const key=scope.generateUidIdentifier(id.name),params=[];for(let i=0,len=function(node){const count=node.params.findIndex((param=>isAssignmentPattern(param)||isRestElement(param)));return-1===count?node.params.length:count}(this.node);i<len;i++)params.push(scope.generateUidIdentifier("x"));const call=_template.default.expression.ast`
./node_modules/.pnpm/jiti@1.21.7/node_modules/jiti/dist/babel.js:  `;return this.replaceWith(call)[0].get("arguments.0")},exports.splitExportDeclaration=function(){if(!this.isExportDeclaration()||this.isExportAllDeclaration())throw new Error("Only default and named export declarations can be split.");if(this.isExportNamedDeclaration()&&this.get("specifiers").length>0)throw new Error("It doesn't make sense to split exported specifiers.");const declaration=this.get("declaration");if(this.isExportDefaultDeclaration()){const standaloneDeclaration=declaration.isFunctionDeclaration()||declaration.isClassDeclaration(),exportExpr=declaration.isFunctionExpression()||declaration.isClassExpression(),scope=declaration.isScope()?declaration.scope.parent:declaration.scope;let id=declaration.node.id,needBindingRegistration=!1;id?exportExpr&&scope.hasBinding(id.name)&&(needBindingRegistration=!0,id=scope.generateUidIdentifier(id.name)):(needBindingRegistration=!0,id=scope.generateUidIdentifier("default"),(standaloneDeclaration||exportExpr)&&(declaration.node.id=cloneNode(id)));const updatedDeclaration=standaloneDeclaration?declaration.node:variableDeclaration("var",[variableDeclarator(cloneNode(id),declaration.node)]),updatedExportDeclaration=exportNamedDeclaration(null,[exportSpecifier(cloneNode(id),identifier("default"))]);return this.insertAfter(updatedExportDeclaration),this.replaceWith(updatedDeclaration),needBindingRegistration&&scope.registerDeclaration(this),this}if(this.get("specifiers").length>0)throw new Error("It doesn't make sense to split exported specifiers.");const bindingIdentifiers=declaration.getOuterBindingIdentifiers(),specifiers=Object.keys(bindingIdentifiers).map((name=>exportSpecifier(identifier(name),identifier(name)))),aliasDeclar=exportNamedDeclaration(null,specifiers);return this.insertAfter(aliasDeclar),this.replaceWith(declaration.node),this},exports.toComputedKey=function(){let key;if(this.isMemberExpression())key=this.node.property;else{if(!this.isProperty()&&!this.isMethod())throw new ReferenceError("todo");key=this.node.key}this.node.computed||isIdentifier(key)&&(key=stringLiteral(key.name));return key},exports.unwrapFunctionEnvironment=function(){if(!this.isArrowFunctionExpression()&&!this.isFunctionExpression()&&!this.isFunctionDeclaration())throw this.buildCodeFrameError("Can only unwrap the environment of a function.");hoistFunctionEnvironment(this)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_template=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/index.js"),_visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{arrowFunctionExpression,assignmentExpression,binaryExpression,blockStatement,callExpression,conditionalExpression,expressionStatement,identifier,isIdentifier,jsxIdentifier,logicalExpression,LOGICAL_OPERATORS,memberExpression,metaProperty,numericLiteral,objectExpression,restElement,returnStatement,sequenceExpression,spreadElement,stringLiteral,super:_super,thisExpression,toExpression,unaryExpression,toBindingIdentifierName,isFunction,isAssignmentPattern,isRestElement,getFunctionName,cloneNode,variableDeclaration,variableDeclarator,exportNamedDeclaration,exportSpecifier,inherits}=_t;exports.arrowFunctionToShadowed=function(){this.isArrowFunctionExpression()&&this.arrowFunctionToExpression()};const getSuperCallsVisitor=(0,_visitors.environmentVisitor)({CallExpression(child,{allSuperCalls}){child.get("callee").isSuper()&&allSuperCalls.push(child)}});function hoistFunctionEnvironment(fnPath,noNewArrows=!0,allowInsertArrow=!0,allowInsertArrowWithRest=!0){let arrowParent,thisEnvFn=fnPath.findParent((p=>p.isArrowFunctionExpression()?(null!=arrowParent||(arrowParent=p),!1):p.isFunction()||p.isProgram()||p.isClassProperty({static:!1})||p.isClassPrivateProperty({static:!1})));const inConstructor=thisEnvFn.isClassMethod({kind:"constructor"});if(thisEnvFn.isClassProperty()||thisEnvFn.isClassPrivateProperty())if(arrowParent)thisEnvFn=arrowParent;else{if(!allowInsertArrow)throw fnPath.buildCodeFrameError("Unable to transform arrow inside class property");fnPath.replaceWith(callExpression(arrowFunctionExpression([],toExpression(fnPath.node)),[])),thisEnvFn=fnPath.get("callee"),fnPath=thisEnvFn.get("body")}const{thisPaths,argumentsPaths,newTargetPaths,superProps,superCalls}=function(fnPath){const thisPaths=[],argumentsPaths=[],newTargetPaths=[],superProps=[],superCalls=[];return fnPath.traverse(getScopeInformationVisitor,{thisPaths,argumentsPaths,newTargetPaths,superProps,superCalls}),{thisPaths,argumentsPaths,newTargetPaths,superProps,superCalls}}(fnPath);if(inConstructor&&superCalls.length>0){if(!allowInsertArrow)throw superCalls[0].buildCodeFrameError("When using '@babel/plugin-transform-arrow-functions', it's not possible to compile `super()` in an arrow function without compiling classes.\nPlease add '@babel/plugin-transform-classes' to your Babel configuration.");if(!allowInsertArrowWithRest)throw superCalls[0].buildCodeFrameError("When using '@babel/plugin-transform-parameters', it's not possible to compile `super()` in an arrow function with default or rest parameters without compiling classes.\nPlease add '@babel/plugin-transform-classes' to your Babel configuration.");const allSuperCalls=[];thisEnvFn.traverse(getSuperCallsVisitor,{allSuperCalls});const superBinding=function(thisEnvFn){return getBinding(thisEnvFn,"supercall",(()=>{const argsBinding=thisEnvFn.scope.generateUidIdentifier("args");return arrowFunctionExpression([restElement(argsBinding)],callExpression(_super(),[spreadElement(identifier(argsBinding.name))]))}))}(thisEnvFn);allSuperCalls.forEach((superCall=>{const callee=identifier(superBinding);callee.loc=superCall.node.callee.loc,superCall.get("callee").replaceWith(callee)}))}if(argumentsPaths.length>0){const argumentsBinding=getBinding(thisEnvFn,"arguments",(()=>{const args=()=>identifier("arguments");return thisEnvFn.scope.path.isProgram()?conditionalExpression(binaryExpression("===",unaryExpression("typeof",args()),stringLiteral("undefined")),thisEnvFn.scope.buildUndefinedNode(),args()):args()}));argumentsPaths.forEach((argumentsChild=>{const argsRef=identifier(argumentsBinding);argsRef.loc=argumentsChild.node.loc,argumentsChild.replaceWith(argsRef)}))}if(newTargetPaths.length>0){const newTargetBinding=getBinding(thisEnvFn,"newtarget",(()=>metaProperty(identifier("new"),identifier("target"))));newTargetPaths.forEach((targetChild=>{const targetRef=identifier(newTargetBinding);targetRef.loc=targetChild.node.loc,targetChild.replaceWith(targetRef)}))}if(superProps.length>0){if(!allowInsertArrow)throw superProps[0].buildCodeFrameError("When using '@babel/plugin-transform-arrow-functions', it's not possible to compile `super.prop` in an arrow function without compiling classes.\nPlease add '@babel/plugin-transform-classes' to your Babel configuration.");superProps.reduce(((acc,superProp)=>acc.concat(function(superProp){if(superProp.parentPath.isAssignmentExpression()&&"="!==superProp.parentPath.node.operator){const assignmentPath=superProp.parentPath,op=assignmentPath.node.operator.slice(0,-1),value=assignmentPath.node.right,isLogicalAssignment=function(op){return LOGICAL_OPERATORS.includes(op)}(op);if(superProp.node.computed){const tmp=superProp.scope.generateDeclaredUidIdentifier("tmp"),object=superProp.node.object,property=superProp.node.property;assignmentPath.get("left").replaceWith(memberExpression(object,assignmentExpression("=",tmp,property),!0)),assignmentPath.get("right").replaceWith(rightExpression(isLogicalAssignment?"=":op,memberExpression(object,identifier(tmp.name),!0),value))}else{const object=superProp.node.object,property=superProp.node.property;assignmentPath.get("left").replaceWith(memberExpression(object,property)),assignmentPath.get("right").replaceWith(rightExpression(isLogicalAssignment?"=":op,memberExpression(object,identifier(property.name)),value))}return isLogicalAssignment?assignmentPath.replaceWith(logicalExpression(op,assignmentPath.node.left,assignmentPath.node.right)):assignmentPath.node.operator="=",[assignmentPath.get("left"),assignmentPath.get("right").get("left")]}if(superProp.parentPath.isUpdateExpression()){const updateExpr=superProp.parentPath,tmp=superProp.scope.generateDeclaredUidIdentifier("tmp"),computedKey=superProp.node.computed?superProp.scope.generateDeclaredUidIdentifier("prop"):null,parts=[assignmentExpression("=",tmp,memberExpression(superProp.node.object,computedKey?assignmentExpression("=",computedKey,superProp.node.property):superProp.node.property,superProp.node.computed)),assignmentExpression("=",memberExpression(superProp.node.object,computedKey?identifier(computedKey.name):superProp.node.property,superProp.node.computed),binaryExpression(superProp.parentPath.node.operator[0],identifier(tmp.name),numericLiteral(1)))];superProp.parentPath.node.prefix||parts.push(identifier(tmp.name)),updateExpr.replaceWith(sequenceExpression(parts));return[updateExpr.get("expressions.0.right"),updateExpr.get("expressions.1.left")]}return[superProp];function rightExpression(op,left,right){return"="===op?assignmentExpression("=",left,right):binaryExpression(op,left,right)}}(superProp))),[]).forEach((superProp=>{const key=superProp.node.computed?"":superProp.get("property").node.name,superParentPath=superProp.parentPath,isAssignment=superParentPath.isAssignmentExpression({left:superProp.node}),isCall=superParentPath.isCallExpression({callee:superProp.node}),isTaggedTemplate=superParentPath.isTaggedTemplateExpression({tag:superProp.node}),superBinding=function(thisEnvFn,isAssignment,propName){const op=isAssignment?"set":"get";return getBinding(thisEnvFn,`superprop_${op}:${propName||""}`,(()=>{const argsList=[];let fnBody;if(propName)fnBody=memberExpression(_super(),identifier(propName));else{const method=thisEnvFn.scope.generateUidIdentifier("prop");argsList.unshift(method),fnBody=memberExpression(_super(),identifier(method.name),!0)}if(isAssignment){const valueIdent=thisEnvFn.scope.generateUidIdentifier("value");argsList.push(valueIdent),fnBody=assignmentExpression("=",fnBody,identifier(valueIdent.name))}return arrowFunctionExpression(argsList,fnBody)}))}(thisEnvFn,isAssignment,key),args=[];if(superProp.node.computed&&args.push(superProp.get("property").node),isAssignment){const value=superParentPath.node.right;args.push(value)}const call=callExpression(identifier(superBinding),args);isCall?(superParentPath.unshiftContainer("arguments",thisExpression()),superProp.replaceWith(memberExpression(call,identifier("call"))),thisPaths.push(superParentPath.get("arguments.0"))):isAssignment?superParentPath.replaceWith(call):isTaggedTemplate?(superProp.replaceWith(callExpression(memberExpression(call,identifier("bind"),!1),[thisExpression()])),thisPaths.push(superProp.get("arguments.0"))):superProp.replaceWith(call)}))}let thisBinding;return(thisPaths.length>0||!noNewArrows)&&(thisBinding=function(thisEnvFn,inConstructor){return getBinding(thisEnvFn,"this",(thisBinding=>{if(!inConstructor||!hasSuperClass(thisEnvFn))return thisExpression();thisEnvFn.traverse(assignSuperThisVisitor,{supers:new WeakSet,thisBinding})}))}(thisEnvFn,inConstructor),(noNewArrows||inConstructor&&hasSuperClass(thisEnvFn))&&(thisPaths.forEach((thisChild=>{const thisRef=thisChild.isJSX()?jsxIdentifier(thisBinding):identifier(thisBinding);thisRef.loc=thisChild.node.loc,thisChild.replaceWith(thisRef)})),noNewArrows||(thisBinding=null))),{thisBinding,fnPath}}function hasSuperClass(thisEnvFn){return thisEnvFn.isClassMethod()&&!!thisEnvFn.parentPath.parentPath.node.superClass}const assignSuperThisVisitor=(0,_visitors.environmentVisitor)({CallExpression(child,{supers,thisBinding}){child.get("callee").isSuper()&&(supers.has(child.node)||(supers.add(child.node),child.replaceWithMultiple([child.node,assignmentExpression("=",identifier(thisBinding),identifier("this"))])))}});function getBinding(thisEnvFn,key,init){const cacheKey="binding:"+key;let data=thisEnvFn.getData(cacheKey);if(!data){const id=thisEnvFn.scope.generateUidIdentifier(key);data=id.name,thisEnvFn.setData(cacheKey,data),thisEnvFn.scope.push({id,init:init(data)})}return data}const getScopeInformationVisitor=(0,_visitors.environmentVisitor)({ThisExpression(child,{thisPaths}){thisPaths.push(child)},JSXIdentifier(child,{thisPaths}){"this"===child.node.name&&(child.parentPath.isJSXMemberExpression({object:child.node})||child.parentPath.isJSXOpeningElement({name:child.node}))&&thisPaths.push(child)},CallExpression(child,{superCalls}){child.get("callee").isSuper()&&superCalls.push(child)},MemberExpression(child,{superProps}){child.get("object").isSuper()&&superProps.push(child)},Identifier(child,{argumentsPaths}){if(!child.isReferencedIdentifier({name:"arguments"}))return;let curr=child.scope;do{if(curr.hasOwnBinding("arguments"))return void curr.rename("arguments");if(curr.path.isFunction()&&!curr.path.isArrowFunctionExpression())break}while(curr=curr.parent);argumentsPaths.push(child)},MetaProperty(child,{newTargetPaths}){child.get("meta").isIdentifier({name:"new"})&&child.get("property").isIdentifier({name:"target"})&&newTargetPaths.push(child)}});const refersOuterBindingVisitor={"ReferencedIdentifier|BindingIdentifier"(path,state){path.node.name===state.name&&(state.needsRename=!0,path.stop())},Scope(path,state){path.scope.hasOwnBinding(state.name)&&path.skip()}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/evaluation.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.evaluate=function(){const state={confident:!0,deoptPath:null,seen:new Map};let value=evaluateCached(this,state);state.confident||(value=void 0);return{confident:state.confident,deopt:state.deoptPath,value}},exports.evaluateTruthy=function(){const res=this.evaluate();if(res.confident)return!!res.value};const VALID_OBJECT_CALLEES=["Number","String","Math"],VALID_IDENTIFIER_CALLEES=["isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent",null,null],INVALID_METHODS=["random"];function isValidObjectCallee(val){return VALID_OBJECT_CALLEES.includes(val)}function deopt(path,state){state.confident&&(state.deoptPath=path,state.confident=!1)}const Globals=new Map([["undefined",void 0],["Infinity",1/0],["NaN",NaN]]);function evaluateCached(path,state){const{node}=path,{seen}=state;if(seen.has(node)){const existing=seen.get(node);return existing.resolved?existing.value:void deopt(path,state)}{const item={resolved:!1};seen.set(node,item);const val=function(path,state){if(!state.confident)return;if(path.isSequenceExpression()){const exprs=path.get("expressions");return evaluateCached(exprs[exprs.length-1],state)}if(path.isStringLiteral()||path.isNumericLiteral()||path.isBooleanLiteral())return path.node.value;if(path.isNullLiteral())return null;if(path.isTemplateLiteral())return evaluateQuasis(path,path.node.quasis,state);if(path.isTaggedTemplateExpression()&&path.get("tag").isMemberExpression()){const object=path.get("tag.object"),{node:{name}}=object,property=path.get("tag.property");if(object.isIdentifier()&&"String"===name&&!path.scope.getBinding(name)&&property.isIdentifier()&&"raw"===property.node.name)return evaluateQuasis(path,path.node.quasi.quasis,state,!0)}if(path.isConditionalExpression()){const testResult=evaluateCached(path.get("test"),state);if(!state.confident)return;return evaluateCached(testResult?path.get("consequent"):path.get("alternate"),state)}if(path.isExpressionWrapper())return evaluateCached(path.get("expression"),state);if(path.isMemberExpression()&&!path.parentPath.isCallExpression({callee:path.node})){const property=path.get("property"),object=path.get("object");if(object.isLiteral()){const value=object.node.value,type=typeof value;let key=null;if(path.node.computed){if(key=evaluateCached(property,state),!state.confident)return}else property.isIdentifier()&&(key=property.node.name);if(!("number"!==type&&"string"!==type||null==key||"number"!=typeof key&&"string"!=typeof key))return value[key]}}if(path.isReferencedIdentifier()){const binding=path.scope.getBinding(path.node.name);if(binding){if(binding.constantViolations.length>0||path.node.start<binding.path.node.end)return void deopt(binding.path,state);if(binding.hasValue)return binding.value}const name=path.node.name;if(Globals.has(name))return binding?void deopt(binding.path,state):Globals.get(name);const resolved=path.resolve();return resolved===path?void deopt(path,state):evaluateCached(resolved,state)}if(path.isUnaryExpression({prefix:!0})){if("void"===path.node.operator)return;const argument=path.get("argument");if("typeof"===path.node.operator&&(argument.isFunction()||argument.isClass()))return"function";const arg=evaluateCached(argument,state);if(!state.confident)return;switch(path.node.operator){case"!":return!arg;case"+":return+arg;case"-":return-arg;case"~":return~arg;case"typeof":return typeof arg}}if(path.isArrayExpression()){const arr=[],elems=path.get("elements");for(const elem of elems){const elemValue=elem.evaluate();if(!elemValue.confident)return void deopt(elemValue.deopt,state);arr.push(elemValue.value)}return arr}if(path.isObjectExpression()){const obj={},props=path.get("properties");for(const prop of props){if(prop.isObjectMethod()||prop.isSpreadElement())return void deopt(prop,state);const keyPath=prop.get("key");let key;if(prop.node.computed){if(key=keyPath.evaluate(),!key.confident)return void deopt(key.deopt,state);key=key.value}else key=keyPath.isIdentifier()?keyPath.node.name:keyPath.node.value;let value=prop.get("value").evaluate();if(!value.confident)return void deopt(value.deopt,state);value=value.value,obj[key]=value}return obj}if(path.isLogicalExpression()){const wasConfident=state.confident,left=evaluateCached(path.get("left"),state),leftConfident=state.confident;state.confident=wasConfident;const right=evaluateCached(path.get("right"),state),rightConfident=state.confident;switch(path.node.operator){case"||":if(state.confident=leftConfident&&(!!left||rightConfident),!state.confident)return;return left||right;case"&&":if(state.confident=leftConfident&&(!left||rightConfident),!state.confident)return;return left&&right;case"??":if(state.confident=leftConfident&&(null!=left||rightConfident),!state.confident)return;return null!=left?left:right}}if(path.isBinaryExpression()){const left=evaluateCached(path.get("left"),state);if(!state.confident)return;const right=evaluateCached(path.get("right"),state);if(!state.confident)return;switch(path.node.operator){case"-":return left-right;case"+":return left+right;case"/":return left/right;case"*":return left*right;case"%":return left%right;case"**":return Math.pow(left,right);case"<":return left<right;case">":return left>right;case"<=":return left<=right;case">=":return left>=right;case"==":return left==right;case"!=":return left!=right;case"===":return left===right;case"!==":return left!==right;case"|":return left|right;case"&":return left&right;case"^":return left^right;case"<<":return left<<right;case">>":return left>>right;case">>>":return left>>>right}}if(path.isCallExpression()){const callee=path.get("callee");let context,func;if(callee.isIdentifier()&&!path.scope.getBinding(callee.node.name)&&(isValidObjectCallee(callee.node.name)||function(val){return VALID_IDENTIFIER_CALLEES.includes(val)}(callee.node.name))&&(func=global[callee.node.name]),callee.isMemberExpression()){const object=callee.get("object"),property=callee.get("property");if(object.isIdentifier()&&property.isIdentifier()&&isValidObjectCallee(object.node.name)&&!function(val){return INVALID_METHODS.includes(val)}(property.node.name)){context=global[object.node.name];const key=property.node.name;hasOwnProperty.call(context,key)&&(func=context[key])}if(object.isLiteral()&&property.isIdentifier()){const type=typeof object.node.value;"string"!==type&&"number"!==type||(context=object.node.value,func=context[property.node.name])}}if(func){const args=path.get("arguments").map((arg=>evaluateCached(arg,state)));if(!state.confident)return;return func.apply(context,args)}}deopt(path,state)}(path,state);return state.confident&&(item.resolved=!0,item.value=val),val}}function evaluateQuasis(path,quasis,state,raw=!1){let str="",i=0;const exprs=path.isTemplateLiteral()?path.get("expressions"):path.get("quasi.expressions");for(const elem of quasis){if(!state.confident)break;str+=raw?elem.value.raw:elem.value.cooked;const expr=exprs[i++];expr&&(str+=String(evaluateCached(expr,state)))}if(state.confident)return str}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/family.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._getKey=_getKey,exports._getPattern=_getPattern,exports.get=function(key,context=!0){!0===context&&(context=this.context);const parts=key.split(".");return 1===parts.length?_getKey.call(this,key,context):_getPattern.call(this,parts,context)},exports.getAllNextSiblings=function(){let _key=this.key,sibling=this.getSibling(++_key);const siblings=[];for(;sibling.node;)siblings.push(sibling),sibling=this.getSibling(++_key);return siblings},exports.getAllPrevSiblings=function(){let _key=this.key,sibling=this.getSibling(--_key);const siblings=[];for(;sibling.node;)siblings.push(sibling),sibling=this.getSibling(--_key);return siblings},exports.getAssignmentIdentifiers=function(){return _getAssignmentIdentifiers(this.node)},exports.getBindingIdentifierPaths=function(duplicates=!1,outerOnly=!1){const search=[this],ids=Object.create(null);for(;search.length;){const id=search.shift();if(!id)continue;if(!id.node)continue;const keys=_getBindingIdentifiers.keys[id.node.type];if(id.isIdentifier())if(duplicates){(ids[id.node.name]=ids[id.node.name]||[]).push(id)}else ids[id.node.name]=id;else if(id.isExportDeclaration()){const declaration=id.get("declaration");declaration.isDeclaration()&&search.push(declaration)}else{if(outerOnly){if(id.isFunctionDeclaration()){search.push(id.get("id"));continue}if(id.isFunctionExpression())continue}if(keys)for(let i=0;i<keys.length;i++){const key=keys[i],child=id.get(key);Array.isArray(child)?search.push(...child):child.node&&search.push(child)}}}return ids},exports.getBindingIdentifiers=function(duplicates){return _getBindingIdentifiers(this.node,duplicates)},exports.getCompletionRecords=function(){return _getCompletionRecords(this,{canHaveBreak:!1,shouldPopulateBreak:!1,inCaseClause:!1}).map((r=>r.path))},exports.getNextSibling=function(){return this.getSibling(this.key+1)},exports.getOpposite=function(){if("left"===this.key)return this.getSibling("right");if("right"===this.key)return this.getSibling("left");return null},exports.getOuterBindingIdentifierPaths=function(duplicates=!1){return this.getBindingIdentifierPaths(duplicates,!0)},exports.getOuterBindingIdentifiers=function(duplicates){return _getOuterBindingIdentifiers(this.node,duplicates)},exports.getPrevSibling=function(){return this.getSibling(this.key-1)},exports.getSibling=function(key){return _index.default.get({parentPath:this.parentPath,parent:this.parent,container:this.container,listKey:this.listKey,key}).setContext(this.context)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{getAssignmentIdentifiers:_getAssignmentIdentifiers,getBindingIdentifiers:_getBindingIdentifiers,getOuterBindingIdentifiers:_getOuterBindingIdentifiers,numericLiteral,unaryExpression}=_t,NORMAL_COMPLETION=0,BREAK_COMPLETION=1;function addCompletionRecords(path,records,context){return path&&records.push(..._getCompletionRecords(path,context)),records}function normalCompletionToBreak(completions){completions.forEach((c=>{c.type=BREAK_COMPLETION}))}function replaceBreakStatementInBreakCompletion(completions,reachable){completions.forEach((c=>{c.path.isBreakStatement({label:null})&&(reachable?c.path.replaceWith(unaryExpression("void",numericLiteral(0))):c.path.remove())}))}function getStatementListCompletion(paths,context){const completions=[];if(context.canHaveBreak){let lastNormalCompletions=[];for(let i=0;i<paths.length;i++){const path=paths[i],newContext=Object.assign({},context,{inCaseClause:!1});path.isBlockStatement()&&(context.inCaseClause||context.shouldPopulateBreak)?newContext.shouldPopulateBreak=!0:newContext.shouldPopulateBreak=!1;const statementCompletions=_getCompletionRecords(path,newContext);if(statementCompletions.length>0&&statementCompletions.every((c=>c.type===BREAK_COMPLETION))){lastNormalCompletions.length>0&&statementCompletions.every((c=>c.path.isBreakStatement({label:null})))?(normalCompletionToBreak(lastNormalCompletions),completions.push(...lastNormalCompletions),lastNormalCompletions.some((c=>c.path.isDeclaration()))&&(completions.push(...statementCompletions),replaceBreakStatementInBreakCompletion(statementCompletions,!0)),replaceBreakStatementInBreakCompletion(statementCompletions,!1)):(completions.push(...statementCompletions),context.shouldPopulateBreak||replaceBreakStatementInBreakCompletion(statementCompletions,!0));break}if(i===paths.length-1)completions.push(...statementCompletions);else{lastNormalCompletions=[];for(let i=0;i<statementCompletions.length;i++){const c=statementCompletions[i];c.type===BREAK_COMPLETION&&completions.push(c),c.type===NORMAL_COMPLETION&&lastNormalCompletions.push(c)}}}}else if(paths.length)for(let i=paths.length-1;i>=0;i--){const pathCompletions=_getCompletionRecords(paths[i],context);if(pathCompletions.length>1||1===pathCompletions.length&&!pathCompletions[0].path.isVariableDeclaration()){completions.push(...pathCompletions);break}}return completions}function _getCompletionRecords(path,context){let records=[];if(path.isIfStatement())records=addCompletionRecords(path.get("consequent"),records,context),records=addCompletionRecords(path.get("alternate"),records,context);else{if(path.isDoExpression()||path.isFor()||path.isWhile()||path.isLabeledStatement())return addCompletionRecords(path.get("body"),records,context);if(path.isProgram()||path.isBlockStatement())return getStatementListCompletion(path.get("body"),context);if(path.isFunction())return _getCompletionRecords(path.get("body"),context);if(path.isTryStatement())records=addCompletionRecords(path.get("block"),records,context),records=addCompletionRecords(path.get("handler"),records,context);else{if(path.isCatchClause())return addCompletionRecords(path.get("body"),records,context);if(path.isSwitchStatement())return function(cases,records,context){let lastNormalCompletions=[];for(let i=0;i<cases.length;i++){const caseCompletions=_getCompletionRecords(cases[i],context),normalCompletions=[],breakCompletions=[];for(const c of caseCompletions)c.type===NORMAL_COMPLETION&&normalCompletions.push(c),c.type===BREAK_COMPLETION&&breakCompletions.push(c);normalCompletions.length&&(lastNormalCompletions=normalCompletions),records.push(...breakCompletions)}return records.push(...lastNormalCompletions),records}(path.get("cases"),records,context);if(path.isSwitchCase())return getStatementListCompletion(path.get("consequent"),{canHaveBreak:!0,shouldPopulateBreak:!1,inCaseClause:!0});path.isBreakStatement()?records.push(function(path){return{type:BREAK_COMPLETION,path}}(path)):records.push(function(path){return{type:NORMAL_COMPLETION,path}}(path))}}return records}function _getKey(key,context){const node=this.node,container=node[key];return Array.isArray(container)?container.map(((_,i)=>_index.default.get({listKey:key,parentPath:this,parent:node,container,key:i}).setContext(context))):_index.default.get({parentPath:this,parent:node,container:node,key}).setContext(context)}function _getPattern(parts,context){let path=this;for(const part of parts)path="."===part?path.parentPath:Array.isArray(path)?path[part]:path.get(part,context);return path}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.SHOULD_STOP=exports.SHOULD_SKIP=exports.REMOVED=void 0;var virtualTypes=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types.js"),_debug=__webpack_require__("./node_modules/.pnpm/debug@4.4.0/node_modules/debug/src/index.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),t=_t,cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_generator=__webpack_require__("./node_modules/.pnpm/@babel+generator@7.26.3/node_modules/@babel/generator/lib/index.js"),NodePath_ancestry=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/ancestry.js"),NodePath_inference=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/index.js"),NodePath_replacement=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/replacement.js"),NodePath_evaluation=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/evaluation.js"),NodePath_conversion=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/conversion.js"),NodePath_introspection=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/introspection.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js"),NodePath_context=_context,NodePath_removal=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js"),NodePath_modification=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js"),NodePath_family=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/family.js"),NodePath_comments=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/comments.js"),NodePath_virtual_types_validator=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types-validator.js");const{validate}=_t,debug=_debug("babel"),NodePath_Final=(exports.REMOVED=1,exports.SHOULD_STOP=2,exports.SHOULD_SKIP=4,exports.default=class NodePath{constructor(hub,parent){this.contexts=[],this.state=null,this.opts=null,this._traverseFlags=0,this.skipKeys=null,this.parentPath=null,this.container=null,this.listKey=null,this.key=null,this.node=null,this.type=null,this.parent=parent,this.hub=hub,this.data=null,this.context=null,this.scope=null}get removed(){return(1&this._traverseFlags)>0}set removed(v){v?this._traverseFlags|=1:this._traverseFlags&=-2}get shouldStop(){return(2&this._traverseFlags)>0}set shouldStop(v){v?this._traverseFlags|=2:this._traverseFlags&=-3}get shouldSkip(){return(4&this._traverseFlags)>0}set shouldSkip(v){v?this._traverseFlags|=4:this._traverseFlags&=-5}static get({hub,parentPath,parent,container,listKey,key}){if(!hub&&parentPath&&(hub=parentPath.hub),!parent)throw new Error("To get a node path the parent needs to exist");const targetNode=container[key],paths=cache.getOrCreateCachedPaths(hub,parent);let path=paths.get(targetNode);return path||(path=new NodePath(hub,parent),targetNode&&paths.set(targetNode,path)),_context.setup.call(path,parentPath,container,listKey,key),path}getScope(scope){return this.isScope()?new _index2.default(this):scope}setData(key,val){return null==this.data&&(this.data=Object.create(null)),this.data[key]=val}getData(key,def){null==this.data&&(this.data=Object.create(null));let val=this.data[key];return void 0===val&&void 0!==def&&(val=this.data[key]=def),val}hasNode(){return null!=this.node}buildCodeFrameError(msg,Error=SyntaxError){return this.hub.buildError(this.node,msg,Error)}traverse(visitor,state){(0,_index.default)(this.node,visitor,this.scope,state,this)}set(key,node){validate(this.node,key,node),this.node[key]=node}getPathLocation(){const parts=[];let path=this;do{let key=path.key;path.inList&&(key=`${path.listKey}[${key}]`),parts.unshift(key)}while(path=path.parentPath);return parts.join(".")}debug(message){debug.enabled&&debug(`${this.getPathLocation()} ${this.type}: ${message}`)}toString(){return(0,_generator.default)(this.node).code}get inList(){return!!this.listKey}set inList(inList){inList||(this.listKey=null)}get parentKey(){return this.listKey||this.key}}),methods={findParent:NodePath_ancestry.findParent,find:NodePath_ancestry.find,getFunctionParent:NodePath_ancestry.getFunctionParent,getStatementParent:NodePath_ancestry.getStatementParent,getEarliestCommonAncestorFrom:NodePath_ancestry.getEarliestCommonAncestorFrom,getDeepestCommonAncestorFrom:NodePath_ancestry.getDeepestCommonAncestorFrom,getAncestry:NodePath_ancestry.getAncestry,isAncestor:NodePath_ancestry.isAncestor,isDescendant:NodePath_ancestry.isDescendant,inType:NodePath_ancestry.inType,getTypeAnnotation:NodePath_inference.getTypeAnnotation,isBaseType:NodePath_inference.isBaseType,couldBeBaseType:NodePath_inference.couldBeBaseType,baseTypeStrictlyMatches:NodePath_inference.baseTypeStrictlyMatches,isGenericType:NodePath_inference.isGenericType,replaceWithMultiple:NodePath_replacement.replaceWithMultiple,replaceWithSourceString:NodePath_replacement.replaceWithSourceString,replaceWith:NodePath_replacement.replaceWith,replaceExpressionWithStatements:NodePath_replacement.replaceExpressionWithStatements,replaceInline:NodePath_replacement.replaceInline,evaluateTruthy:NodePath_evaluation.evaluateTruthy,evaluate:NodePath_evaluation.evaluate,toComputedKey:NodePath_conversion.toComputedKey,ensureBlock:NodePath_conversion.ensureBlock,unwrapFunctionEnvironment:NodePath_conversion.unwrapFunctionEnvironment,arrowFunctionToExpression:NodePath_conversion.arrowFunctionToExpression,splitExportDeclaration:NodePath_conversion.splitExportDeclaration,ensureFunctionName:NodePath_conversion.ensureFunctionName,matchesPattern:NodePath_introspection.matchesPattern,isStatic:NodePath_introspection.isStatic,isNodeType:NodePath_introspection.isNodeType,canHaveVariableDeclarationOrExpression:NodePath_introspection.canHaveVariableDeclarationOrExpression,canSwapBetweenExpressionAndStatement:NodePath_introspection.canSwapBetweenExpressionAndStatement,isCompletionRecord:NodePath_introspection.isCompletionRecord,isStatementOrBlock:NodePath_introspection.isStatementOrBlock,referencesImport:NodePath_introspection.referencesImport,getSource:NodePath_introspection.getSource,willIMaybeExecuteBefore:NodePath_introspection.willIMaybeExecuteBefore,_guessExecutionStatusRelativeTo:NodePath_introspection._guessExecutionStatusRelativeTo,resolve:NodePath_introspection.resolve,isConstantExpression:NodePath_introspection.isConstantExpression,isInStrictMode:NodePath_introspection.isInStrictMode,isDenylisted:NodePath_context.isDenylisted,visit:NodePath_context.visit,skip:NodePath_context.skip,skipKey:NodePath_context.skipKey,stop:NodePath_context.stop,setContext:NodePath_context.setContext,requeue:NodePath_context.requeue,requeueComputedKeyAndDecorators:NodePath_context.requeueComputedKeyAndDecorators,remove:NodePath_removal.remove,insertBefore:NodePath_modification.insertBefore,insertAfter:NodePath_modification.insertAfter,unshiftContainer:NodePath_modification.unshiftContainer,pushContainer:NodePath_modification.pushContainer,getOpposite:NodePath_family.getOpposite,getCompletionRecords:NodePath_family.getCompletionRecords,getSibling:NodePath_family.getSibling,getPrevSibling:NodePath_family.getPrevSibling,getNextSibling:NodePath_family.getNextSibling,getAllNextSiblings:NodePath_family.getAllNextSiblings,getAllPrevSiblings:NodePath_family.getAllPrevSiblings,get:NodePath_family.get,getAssignmentIdentifiers:NodePath_family.getAssignmentIdentifiers,getBindingIdentifiers:NodePath_family.getBindingIdentifiers,getOuterBindingIdentifiers:NodePath_family.getOuterBindingIdentifiers,getBindingIdentifierPaths:NodePath_family.getBindingIdentifierPaths,getOuterBindingIdentifierPaths:NodePath_family.getOuterBindingIdentifierPaths,shareCommentsWithSiblings:NodePath_comments.shareCommentsWithSiblings,addComment:NodePath_comments.addComment,addComments:NodePath_comments.addComments};Object.assign(NodePath_Final.prototype,methods),NodePath_Final.prototype.arrowFunctionToShadowed=NodePath_conversion[String("arrowFunctionToShadowed")],Object.assign(NodePath_Final.prototype,{has:NodePath_introspection[String("has")],is:NodePath_introspection[String("is")],isnt:NodePath_introspection[String("isnt")],equals:NodePath_introspection[String("equals")],hoist:NodePath_modification[String("hoist")],updateSiblingKeys:NodePath_modification.updateSiblingKeys,call:NodePath_context.call,isBlacklisted:NodePath_context[String("isBlacklisted")],setScope:NodePath_context.setScope,resync:NodePath_context.resync,popContext:NodePath_context.popContext,pushContext:NodePath_context.pushContext,setup:NodePath_context.setup,setKey:NodePath_context.setKey}),NodePath_Final.prototype._guessExecutionStatusRelativeToDifferentFunctions=NodePath_introspection._guessExecutionStatusRelativeTo,NodePath_Final.prototype._guessExecutionStatusRelativeToDifferentFunctions=NodePath_introspection._guessExecutionStatusRelativeTo,Object.assign(NodePath_Final.prototype,{_getTypeAnnotation:NodePath_inference._getTypeAnnotation,_replaceWith:NodePath_replacement._replaceWith,_resolve:NodePath_introspection._resolve,_call:NodePath_context._call,_resyncParent:NodePath_context._resyncParent,_resyncKey:NodePath_context._resyncKey,_resyncList:NodePath_context._resyncList,_resyncRemoved:NodePath_context._resyncRemoved,_getQueueContexts:NodePath_context._getQueueContexts,_removeFromScope:NodePath_removal._removeFromScope,_callRemovalHooks:NodePath_removal._callRemovalHooks,_remove:NodePath_removal._remove,_markRemoved:NodePath_removal._markRemoved,_assertUnremoved:NodePath_removal._assertUnremoved,_containerInsert:NodePath_modification._containerInsert,_containerInsertBefore:NodePath_modification._containerInsertBefore,_containerInsertAfter:NodePath_modification._containerInsertAfter,_verifyNodeList:NodePath_modification._verifyNodeList,_getKey:NodePath_family._getKey,_getPattern:NodePath_family._getPattern});for(const type of t.TYPES){const typeKey=`is${type}`,fn=t[typeKey];NodePath_Final.prototype[typeKey]=function(opts){return fn(this.node,opts)},NodePath_Final.prototype[`assert${type}`]=function(opts){if(!fn(this.node,opts))throw new TypeError(`Expected node path of type ${type}`)}}Object.assign(NodePath_Final.prototype,NodePath_virtual_types_validator);for(const type of Object.keys(virtualTypes))"_"!==type[0]&&(t.TYPES.includes(type)||t.TYPES.push(type))},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._getTypeAnnotation=_getTypeAnnotation,exports.baseTypeStrictlyMatches=function(rightArg){const left=this.getTypeAnnotation(),right=rightArg.getTypeAnnotation();if(!isAnyTypeAnnotation(left)&&isFlowBaseAnnotation(left))return right.type===left.type;return!1},exports.couldBeBaseType=function(name){const type=this.getTypeAnnotation();if(isAnyTypeAnnotation(type))return!0;if(isUnionTypeAnnotation(type)){for(const type2 of type.types)if(isAnyTypeAnnotation(type2)||_isBaseType(name,type2,!0))return!0;return!1}return _isBaseType(name,type,!0)},exports.getTypeAnnotation=function(){let type=this.getData("typeAnnotation");if(null!=type)return type;type=_getTypeAnnotation.call(this)||anyTypeAnnotation(),(isTypeAnnotation(type)||isTSTypeAnnotation(type))&&(type=type.typeAnnotation);return this.setData("typeAnnotation",type),type},exports.isBaseType=function(baseName,soft){return _isBaseType(baseName,this.getTypeAnnotation(),soft)},exports.isGenericType=function(genericName){const type=this.getTypeAnnotation();if("Array"===genericName&&(isTSArrayType(type)||isArrayTypeAnnotation(type)||isTupleTypeAnnotation(type)))return!0;return isGenericTypeAnnotation(type)&&isIdentifier(type.id,{name:genericName})||isTSTypeReference(type)&&isIdentifier(type.typeName,{name:genericName})};var inferers=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferers.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{anyTypeAnnotation,isAnyTypeAnnotation,isArrayTypeAnnotation,isBooleanTypeAnnotation,isEmptyTypeAnnotation,isFlowBaseAnnotation,isGenericTypeAnnotation,isIdentifier,isMixedTypeAnnotation,isNumberTypeAnnotation,isStringTypeAnnotation,isTSArrayType,isTSTypeAnnotation,isTSTypeReference,isTupleTypeAnnotation,isTypeAnnotation,isUnionTypeAnnotation,isVoidTypeAnnotation,stringTypeAnnotation,voidTypeAnnotation}=_t;const typeAnnotationInferringNodes=new WeakSet;function _getTypeAnnotation(){const node=this.node;if(node){if(node.typeAnnotation)return node.typeAnnotation;if(!typeAnnotationInferringNodes.has(node)){typeAnnotationInferringNodes.add(node);try{var _inferer;let inferer=inferers[node.type];if(inferer)return inferer.call(this,node);if(inferer=inferers[this.parentPath.type],null!=(_inferer=inferer)&&_inferer.validParent)return this.parentPath.getTypeAnnotation()}finally{typeAnnotationInferringNodes.delete(node)}}}else if("init"===this.key&&this.parentPath.isVariableDeclarator()){const declar=this.parentPath.parentPath,declarParent=declar.parentPath;return"left"===declar.key&&declarParent.isForInStatement()?stringTypeAnnotation():"left"===declar.key&&declarParent.isForOfStatement()?anyTypeAnnotation():voidTypeAnnotation()}}function _isBaseType(baseName,type,soft){if("string"===baseName)return isStringTypeAnnotation(type);if("number"===baseName)return isNumberTypeAnnotation(type);if("boolean"===baseName)return isBooleanTypeAnnotation(type);if("any"===baseName)return isAnyTypeAnnotation(type);if("mixed"===baseName)return isMixedTypeAnnotation(type);if("empty"===baseName)return isEmptyTypeAnnotation(type);if("void"===baseName)return isVoidTypeAnnotation(type);if(soft)return!1;throw new Error(`Unknown base type ${baseName}`)}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferer-reference.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){if(!this.isReferenced())return;const binding=this.scope.getBinding(node.name);if(binding)return binding.identifier.typeAnnotation?binding.identifier.typeAnnotation:function(binding,path,name){const types=[],functionConstantViolations=[];let constantViolations=getConstantViolationsBefore(binding,path,functionConstantViolations);const testType=getConditionalAnnotation(binding,path,name);if(testType){const testConstantViolations=getConstantViolationsBefore(binding,testType.ifStatement);constantViolations=constantViolations.filter((path=>!testConstantViolations.includes(path))),types.push(testType.typeAnnotation)}if(constantViolations.length){constantViolations.push(...functionConstantViolations);for(const violation of constantViolations)types.push(violation.getTypeAnnotation())}if(!types.length)return;return(0,_util.createUnionType)(types)}(binding,this,node.name);if("undefined"===node.name)return voidTypeAnnotation();if("NaN"===node.name||"Infinity"===node.name)return numberTypeAnnotation();node.name};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_util=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/util.js");const{BOOLEAN_NUMBER_BINARY_OPERATORS,createTypeAnnotationBasedOnTypeof,numberTypeAnnotation,voidTypeAnnotation}=_t;function getConstantViolationsBefore(binding,path,functions){const violations=binding.constantViolations.slice();return violations.unshift(binding.path),violations.filter((violation=>{const status=(violation=violation.resolve())._guessExecutionStatusRelativeTo(path);return functions&&"unknown"===status&&functions.push(violation),"before"===status}))}function inferAnnotationFromBinaryExpression(name,path){const operator=path.node.operator,right=path.get("right").resolve(),left=path.get("left").resolve();let target,typeofPath,typePath;if(left.isIdentifier({name})?target=right:right.isIdentifier({name})&&(target=left),target)return"==="===operator?target.getTypeAnnotation():BOOLEAN_NUMBER_BINARY_OPERATORS.includes(operator)?numberTypeAnnotation():void 0;if("==="!==operator&&"=="!==operator)return;if(left.isUnaryExpression({operator:"typeof"})?(typeofPath=left,typePath=right):right.isUnaryExpression({operator:"typeof"})&&(typeofPath=right,typePath=left),!typeofPath)return;if(!typeofPath.get("argument").isIdentifier({name}))return;if(typePath=typePath.resolve(),!typePath.isLiteral())return;const typeValue=typePath.node.value;return"string"==typeof typeValue?createTypeAnnotationBasedOnTypeof(typeValue):void 0}function getConditionalAnnotation(binding,path,name){const ifStatement=function(binding,path,name){let parentPath;for(;parentPath=path.parentPath;){if(parentPath.isIfStatement()||parentPath.isConditionalExpression()){if("test"===path.key)return;return parentPath}if(parentPath.isFunction()&&parentPath.parentPath.scope.getBinding(name)!==binding)return;path=parentPath}}(binding,path,name);if(!ifStatement)return;const paths=[ifStatement.get("test")],types=[];for(let i=0;i<paths.length;i++){const path=paths[i];if(path.isLogicalExpression())"&&"===path.node.operator&&(paths.push(path.get("left")),paths.push(path.get("right")));else if(path.isBinaryExpression()){const type=inferAnnotationFromBinaryExpression(name,path);type&&types.push(type)}}return types.length?{typeAnnotation:(0,_util.createUnionType)(types),ifStatement}:getConditionalAnnotation(binding,ifStatement,name)}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferers.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArrayExpression=ArrayExpression,exports.AssignmentExpression=function(){return this.get("right").getTypeAnnotation()},exports.BinaryExpression=function(node){const operator=node.operator;if(NUMBER_BINARY_OPERATORS.includes(operator))return numberTypeAnnotation();if(BOOLEAN_BINARY_OPERATORS.includes(operator))return booleanTypeAnnotation();if("+"===operator){const right=this.get("right"),left=this.get("left");return left.isBaseType("number")&&right.isBaseType("number")?numberTypeAnnotation():left.isBaseType("string")||right.isBaseType("string")?stringTypeAnnotation():unionTypeAnnotation([stringTypeAnnotation(),numberTypeAnnotation()])}},exports.BooleanLiteral=function(){return booleanTypeAnnotation()},exports.CallExpression=function(){const{callee}=this.node;if(isObjectKeys(callee))return arrayTypeAnnotation(stringTypeAnnotation());if(isArrayFrom(callee)||isObjectValues(callee)||isIdentifier(callee,{name:"Array"}))return arrayTypeAnnotation(anyTypeAnnotation());if(isObjectEntries(callee))return arrayTypeAnnotation(tupleTypeAnnotation([stringTypeAnnotation(),anyTypeAnnotation()]));return resolveCall(this.get("callee"))},exports.ConditionalExpression=function(){const argumentTypes=[this.get("consequent").getTypeAnnotation(),this.get("alternate").getTypeAnnotation()];return(0,_util.createUnionType)(argumentTypes)},exports.ClassDeclaration=exports.ClassExpression=exports.FunctionDeclaration=exports.ArrowFunctionExpression=exports.FunctionExpression=function(){return genericTypeAnnotation(identifier("Function"))},Object.defineProperty(exports,"Identifier",{enumerable:!0,get:function(){return _infererReference.default}}),exports.LogicalExpression=function(){const argumentTypes=[this.get("left").getTypeAnnotation(),this.get("right").getTypeAnnotation()];return(0,_util.createUnionType)(argumentTypes)},exports.NewExpression=function(node){if("Identifier"===node.callee.type)return genericTypeAnnotation(node.callee)},exports.NullLiteral=function(){return nullLiteralTypeAnnotation()},exports.NumericLiteral=function(){return numberTypeAnnotation()},exports.ObjectExpression=function(){return genericTypeAnnotation(identifier("Object"))},exports.ParenthesizedExpression=function(){return this.get("expression").getTypeAnnotation()},exports.RegExpLiteral=function(){return genericTypeAnnotation(identifier("RegExp"))},exports.RestElement=RestElement,exports.SequenceExpression=function(){return this.get("expressions").pop().getTypeAnnotation()},exports.StringLiteral=function(){return stringTypeAnnotation()},exports.TSAsExpression=TSAsExpression,exports.TSNonNullExpression=function(){return this.get("expression").getTypeAnnotation()},exports.TaggedTemplateExpression=function(){return resolveCall(this.get("tag"))},exports.TemplateLiteral=function(){return stringTypeAnnotation()},exports.TypeCastExpression=TypeCastExpression,exports.UnaryExpression=function(node){const operator=node.operator;if("void"===operator)return voidTypeAnnotation();if(NUMBER_UNARY_OPERATORS.includes(operator))return numberTypeAnnotation();if(STRING_UNARY_OPERATORS.includes(operator))return stringTypeAnnotation();if(BOOLEAN_UNARY_OPERATORS.includes(operator))return booleanTypeAnnotation()},exports.UpdateExpression=function(node){const operator=node.operator;if("++"===operator||"--"===operator)return numberTypeAnnotation()},exports.VariableDeclarator=function(){if(!this.get("id").isIdentifier())return;return this.get("init").getTypeAnnotation()};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_infererReference=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferer-reference.js"),_util=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/util.js");const{BOOLEAN_BINARY_OPERATORS,BOOLEAN_UNARY_OPERATORS,NUMBER_BINARY_OPERATORS,NUMBER_UNARY_OPERATORS,STRING_UNARY_OPERATORS,anyTypeAnnotation,arrayTypeAnnotation,booleanTypeAnnotation,buildMatchMemberExpression,genericTypeAnnotation,identifier,nullLiteralTypeAnnotation,numberTypeAnnotation,stringTypeAnnotation,tupleTypeAnnotation,unionTypeAnnotation,voidTypeAnnotation,isIdentifier}=_t;function TypeCastExpression(node){return node.typeAnnotation}function TSAsExpression(node){return node.typeAnnotation}function ArrayExpression(){return genericTypeAnnotation(identifier("Array"))}function RestElement(){return ArrayExpression()}TypeCastExpression.validParent=!0,TSAsExpression.validParent=!0,RestElement.validParent=!0;const isArrayFrom=buildMatchMemberExpression("Array.from"),isObjectKeys=buildMatchMemberExpression("Object.keys"),isObjectValues=buildMatchMemberExpression("Object.values"),isObjectEntries=buildMatchMemberExpression("Object.entries");function resolveCall(callee){if((callee=callee.resolve()).isFunction()){const{node}=callee;if(node.async)return node.generator?genericTypeAnnotation(identifier("AsyncIterator")):genericTypeAnnotation(identifier("Promise"));if(node.generator)return genericTypeAnnotation(identifier("Iterator"));if(callee.node.returnType)return callee.node.returnType}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/util.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createUnionType=function(types){if(types.every((v=>isFlowType(v))))return createFlowUnionType?createFlowUnionType(types):createUnionTypeAnnotation(types);if(types.every((v=>isTSType(v)))&&createTSUnionType)return createTSUnionType(types)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{createFlowUnionType,createTSUnionType,createUnionTypeAnnotation,isFlowType,isTSType}=_t},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/introspection.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._guessExecutionStatusRelativeTo=function(target){return _guessExecutionStatusRelativeToCached(this,target,new Map)},exports._resolve=_resolve,exports.canHaveVariableDeclarationOrExpression=function(){return("init"===this.key||"left"===this.key)&&this.parentPath.isFor()},exports.canSwapBetweenExpressionAndStatement=function(replacement){if("body"!==this.key||!this.parentPath.isArrowFunctionExpression())return!1;if(this.isExpression())return isBlockStatement(replacement);if(this.isBlockStatement())return isExpression(replacement);return!1},exports.getSource=function(){const node=this.node;if(node.end){const code=this.hub.getCode();if(code)return code.slice(node.start,node.end)}return""},exports.isCompletionRecord=function(allowInsideFunction){let path=this,first=!0;do{const{type,container}=path;if(!first&&(path.isFunction()||"StaticBlock"===type))return!!allowInsideFunction;if(first=!1,Array.isArray(container)&&path.key!==container.length-1)return!1}while((path=path.parentPath)&&!path.isProgram()&&!path.isDoExpression());return!0},exports.isConstantExpression=function(){if(this.isIdentifier()){const binding=this.scope.getBinding(this.node.name);return!!binding&&binding.constant}if(this.isLiteral())return!this.isRegExpLiteral()&&(!this.isTemplateLiteral()||this.get("expressions").every((expression=>expression.isConstantExpression())));if(this.isUnaryExpression())return"void"===this.node.operator&&this.get("argument").isConstantExpression();if(this.isBinaryExpression()){const{operator}=this.node;return"in"!==operator&&"instanceof"!==operator&&this.get("left").isConstantExpression()&&this.get("right").isConstantExpression()}if(this.isMemberExpression())return!this.node.computed&&this.get("object").isIdentifier({name:"Symbol"})&&!this.scope.hasBinding("Symbol",{noGlobals:!0});if(this.isCallExpression())return 1===this.node.arguments.length&&this.get("callee").matchesPattern("Symbol.for")&&!this.scope.hasBinding("Symbol",{noGlobals:!0})&&this.get("arguments")[0].isStringLiteral();return!1},exports.isInStrictMode=function(){const start=this.isProgram()?this:this.parentPath;return!!start.find((path=>{if(path.isProgram({sourceType:"module"}))return!0;if(path.isClass())return!0;if(path.isArrowFunctionExpression()&&!path.get("body").isBlockStatement())return!1;let body;if(path.isFunction())body=path.node.body;else{if(!path.isProgram())return!1;body=path.node}for(const directive of body.directives)if("use strict"===directive.value.value)return!0}))},exports.isNodeType=function(type){return isType(this.type,type)},exports.isStatementOrBlock=function(){return!this.parentPath.isLabeledStatement()&&!isBlockStatement(this.container)&&STATEMENT_OR_BLOCK_KEYS.includes(this.key)},exports.isStatic=function(){return this.scope.isStatic(this.node)},exports.matchesPattern=function(pattern,allowPartial){return _matchesPattern(this.node,pattern,allowPartial)},exports.referencesImport=function(moduleSource,importName){if(!this.isReferencedIdentifier()){if(this.isJSXMemberExpression()&&this.node.property.name===importName||(this.isMemberExpression()||this.isOptionalMemberExpression())&&(this.node.computed?isStringLiteral(this.node.property,{value:importName}):this.node.property.name===importName)){const object=this.get("object");return object.isReferencedIdentifier()&&object.referencesImport(moduleSource,"*")}return!1}const binding=this.scope.getBinding(this.node.name);if(!binding||"module"!==binding.kind)return!1;const path=binding.path,parent=path.parentPath;if(!parent.isImportDeclaration())return!1;if(parent.node.source.value!==moduleSource)return!1;if(!importName)return!0;if(path.isImportDefaultSpecifier()&&"default"===importName)return!0;if(path.isImportNamespaceSpecifier()&&"*"===importName)return!0;if(path.isImportSpecifier()&&isIdentifier(path.node.imported,{name:importName}))return!0;return!1},exports.resolve=function(dangerous,resolved){return _resolve.call(this,dangerous,resolved)||this},exports.willIMaybeExecuteBefore=function(target){return"after"!==this._guessExecutionStatusRelativeTo(target)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{STATEMENT_OR_BLOCK_KEYS,VISITOR_KEYS,isBlockStatement,isExpression,isIdentifier,isLiteral,isStringLiteral,isType,matchesPattern:_matchesPattern}=_t;function getOuterFunction(path){return path.isProgram()?path:(path.parentPath.scope.getFunctionParent()||path.parentPath.scope.getProgramParent()).path}function isExecutionUncertain(type,key){switch(type){case"LogicalExpression":case"AssignmentPattern":return"right"===key;case"ConditionalExpression":case"IfStatement":return"consequent"===key||"alternate"===key;case"WhileStatement":case"DoWhileStatement":case"ForInStatement":case"ForOfStatement":return"body"===key;case"ForStatement":return"body"===key||"update"===key;case"SwitchStatement":return"cases"===key;case"TryStatement":return"handler"===key;case"OptionalMemberExpression":return"property"===key;case"OptionalCallExpression":return"arguments"===key;default:return!1}}function isExecutionUncertainInList(paths,maxIndex){for(let i=0;i<maxIndex;i++){const path=paths[i];if(isExecutionUncertain(path.parent.type,path.parentKey))return!0}return!1}exports.has=function(key){var _this$node;const val=null==(_this$node=this.node)?void 0:_this$node[key];return val&&Array.isArray(val)?!!val.length:!!val},exports.is=exports.has,exports.isnt=function(key){return!this.has(key)},exports.equals=function(key,value){return this.node[key]===value};const SYMBOL_CHECKING=Symbol();function _guessExecutionStatusRelativeToCached(base,target,cache){const funcParent={this:getOuterFunction(base),target:getOuterFunction(target)};if(funcParent.target.node!==funcParent.this.node)return function(base,target,cache){let cached,nodeMap=cache.get(base.node);if(nodeMap){if(cached=nodeMap.get(target.node))return cached===SYMBOL_CHECKING?"unknown":cached}else cache.set(base.node,nodeMap=new Map);nodeMap.set(target.node,SYMBOL_CHECKING);const result=function(base,target,cache){if(!target.isFunctionDeclaration())return"before"===_guessExecutionStatusRelativeToCached(base,target,cache)?"before":"unknown";if(target.parentPath.isExportDeclaration())return"unknown";const binding=target.scope.getBinding(target.node.id.name);if(!binding.references)return"before";const referencePaths=binding.referencePaths;let allStatus;for(const path of referencePaths){if(!!path.find((path=>path.node===target.node)))continue;if("callee"!==path.key||!path.parentPath.isCallExpression())return"unknown";const status=_guessExecutionStatusRelativeToCached(base,path,cache);if(allStatus&&allStatus!==status)return"unknown";allStatus=status}return allStatus}(base,target,cache);return nodeMap.set(target.node,result),result}(base,funcParent.target,cache);const paths={target:target.getAncestry(),this:base.getAncestry()};if(paths.target.includes(base))return"after";if(paths.this.includes(target))return"before";let commonPath;const commonIndex={target:0,this:0};for(;!commonPath&&commonIndex.this<paths.this.length;){const path=paths.this[commonIndex.this];commonIndex.target=paths.target.indexOf(path),commonIndex.target>=0?commonPath=path:commonIndex.this++}if(!commonPath)throw new Error("Internal Babel error - The two compared nodes don't appear to belong to the same program.");if(isExecutionUncertainInList(paths.this,commonIndex.this-1)||isExecutionUncertainInList(paths.target,commonIndex.target-1))return"unknown";const divergence={this:paths.this[commonIndex.this-1],target:paths.target[commonIndex.target-1]};if(divergence.target.listKey&&divergence.this.listKey&&divergence.target.container===divergence.this.container)return divergence.target.key>divergence.this.key?"before":"after";const keys=VISITOR_KEYS[commonPath.type],keyPosition_this=keys.indexOf(divergence.this.parentKey);return keys.indexOf(divergence.target.parentKey)>keyPosition_this?"before":"after"}function _resolve(dangerous,resolved){var _resolved;if(null==(_resolved=resolved)||!_resolved.includes(this))if((resolved=resolved||[]).push(this),this.isVariableDeclarator()){if(this.get("id").isIdentifier())return this.get("init").resolve(dangerous,resolved)}else if(this.isReferencedIdentifier()){const binding=this.scope.getBinding(this.node.name);if(!binding)return;if(!binding.constant)return;if("module"===binding.kind)return;if(binding.path!==this){const ret=binding.path.resolve(dangerous,resolved);if(this.find((parent=>parent.node===ret.node)))return;return ret}}else{if(this.isTypeCastExpression())return this.get("expression").resolve(dangerous,resolved);if(dangerous&&this.isMemberExpression()){const targetKey=this.toComputedKey();if(!isLiteral(targetKey))return;const targetName=targetKey.value,target=this.get("object").resolve(dangerous,resolved);if(target.isObjectExpression()){const props=target.get("properties");for(const prop of props){if(!prop.isProperty())continue;const key=prop.get("key");let match=prop.isnt("computed")&&key.isIdentifier({name:targetName});if(match=match||key.isLiteral({value:targetName}),match)return prop.get("value").resolve(dangerous,resolved)}}else if(target.isArrayExpression()&&!isNaN(+targetName)){const elem=target.get("elements")[targetName];if(elem)return elem.resolve(dangerous,resolved)}}}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/hoister.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_t2=_t;const{react}=_t,{cloneNode,jsxExpressionContainer,variableDeclaration,variableDeclarator}=_t2,referenceVisitor={ReferencedIdentifier(path,state){if(path.isJSXIdentifier()&&react.isCompatTag(path.node.name)&&!path.parentPath.isJSXMemberExpression())return;if("this"===path.node.name){let scope=path.scope;do{if(scope.path.isFunction()&&!scope.path.isArrowFunctionExpression())break}while(scope=scope.parent);scope&&state.breakOnScopePaths.push(scope.path)}const binding=path.scope.getBinding(path.node.name);if(binding){for(const violation of binding.constantViolations)if(violation.scope!==binding.path.scope)return state.mutableBinding=!0,void path.stop();binding===state.scope.getBinding(path.node.name)&&(state.bindings[path.node.name]=binding)}}};exports.default=class{constructor(path,scope){this.breakOnScopePaths=void 0,this.bindings=void 0,this.mutableBinding=void 0,this.scopes=void 0,this.scope=void 0,this.path=void 0,this.attachAfter=void 0,this.breakOnScopePaths=[],this.bindings={},this.mutableBinding=!1,this.scopes=[],this.scope=scope,this.path=path,this.attachAfter=!1}isCompatibleScope(scope){for(const key of Object.keys(this.bindings)){const binding=this.bindings[key];if(!scope.bindingIdentifierEquals(key,binding.identifier))return!1}return!0}getCompatibleScopes(){let scope=this.path.scope;do{if(!this.isCompatibleScope(scope))break;if(this.scopes.push(scope),this.breakOnScopePaths.includes(scope.path))break}while(scope=scope.parent)}getAttachmentPath(){let path=this._getAttachmentPath();if(!path)return;let targetScope=path.scope;if(targetScope.path===path&&(targetScope=path.scope.parent),targetScope.path.isProgram()||targetScope.path.isFunction())for(const name of Object.keys(this.bindings)){if(!targetScope.hasOwnBinding(name))continue;const binding=this.bindings[name];if("param"===binding.kind||"params"===binding.path.parentKey)continue;if(this.getAttachmentParentForPath(binding.path).key>=path.key){this.attachAfter=!0,path=binding.path;for(const violationPath of binding.constantViolations)this.getAttachmentParentForPath(violationPath).key>path.key&&(path=violationPath)}}return path}_getAttachmentPath(){const scope=this.scopes.pop();if(scope)if(scope.path.isFunction()){if(!this.hasOwnParamBindings(scope))return this.getNextScopeAttachmentParent();{if(this.scope===scope)return;const bodies=scope.path.get("body").get("body");for(let i=0;i<bodies.length;i++)if(!bodies[i].node._blockHoist)return bodies[i]}}else if(scope.path.isProgram())return this.getNextScopeAttachmentParent()}getNextScopeAttachmentParent(){const scope=this.scopes.pop();if(scope)return this.getAttachmentParentForPath(scope.path)}getAttachmentParentForPath(path){do{if(!path.parentPath||Array.isArray(path.container)&&path.isStatement())return path}while(path=path.parentPath)}hasOwnParamBindings(scope){for(const name of Object.keys(this.bindings)){if(!scope.hasOwnBinding(name))continue;const binding=this.bindings[name];if("param"===binding.kind&&binding.constant)return!0}return!1}run(){if(this.path.traverse(referenceVisitor,this),this.mutableBinding)return;this.getCompatibleScopes();const attachTo=this.getAttachmentPath();if(!attachTo)return;if(attachTo.getFunctionParent()===this.path.getFunctionParent())return;let uid=attachTo.scope.generateUidIdentifier("ref");const declarator=variableDeclarator(uid,this.path.node),insertFn=this.attachAfter?"insertAfter":"insertBefore",[attached]=attachTo[insertFn]([attachTo.isVariableDeclarator()?declarator:variableDeclaration("var",[declarator])]),parent=this.path.parentPath;return parent.isJSXElement()&&this.path.container===parent.node.children&&(uid=jsxExpressionContainer(uid)),this.path.replaceWith(cloneNode(uid)),attachTo.isVariableDeclarator()?attached.get("init"):attached.get("declarations.0.init")}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/removal-hooks.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hooks=void 0;exports.hooks=[function(self,parent){if("test"===self.key&&(parent.isWhile()||parent.isSwitchCase())||"declaration"===self.key&&parent.isExportDeclaration()||"body"===self.key&&parent.isLabeledStatement()||"declarations"===self.listKey&&parent.isVariableDeclaration()&&1===parent.node.declarations.length||"expression"===self.key&&parent.isExpressionStatement())return parent.remove(),!0},function(self,parent){if(parent.isSequenceExpression()&&1===parent.node.expressions.length)return parent.replaceWith(parent.node.expressions[0]),!0},function(self,parent){if(parent.isBinary())return"left"===self.key?parent.replaceWith(parent.node.right):parent.replaceWith(parent.node.left),!0},function(self,parent){if(parent.isIfStatement()&&"consequent"===self.key||"body"===self.key&&(parent.isLoop()||parent.isArrowFunctionExpression()))return self.replaceWith({type:"BlockStatement",body:[]}),!0}]},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types-validator.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isBindingIdentifier=function(){const{node,parent}=this,grandparent=this.parentPath.parent;return isIdentifier(node)&&isBinding(node,parent,grandparent)},exports.isBlockScoped=function(){return nodeIsBlockScoped(this.node)},exports.isExpression=function(){return this.isIdentifier()?this.isReferencedIdentifier():nodeIsExpression(this.node)},exports.isFlow=function(){const{node}=this;return!!nodeIsFlow(node)||(isImportDeclaration(node)?"type"===node.importKind||"typeof"===node.importKind:isExportDeclaration(node)?"type"===node.exportKind:!!isImportSpecifier(node)&&("type"===node.importKind||"typeof"===node.importKind))},exports.isForAwaitStatement=function(){return isForOfStatement(this.node,{await:!0})},exports.isGenerated=function(){return!this.isUser()},exports.isPure=function(constantsOnly){return this.scope.isPure(this.node,constantsOnly)},exports.isReferenced=function(){return nodeIsReferenced(this.node,this.parent)},exports.isReferencedIdentifier=function(opts){const{node,parent}=this;if(!isIdentifier(node,opts)&&!isJSXMemberExpression(parent,opts)){if(!isJSXIdentifier(node,opts))return!1;if(isCompatTag(node.name))return!1}return nodeIsReferenced(node,parent,this.parentPath.parent)},exports.isReferencedMemberExpression=function(){const{node,parent}=this;return isMemberExpression(node)&&nodeIsReferenced(node,parent)},exports.isRestProperty=function(){var _this$parentPath;return nodeIsRestElement(this.node)&&(null==(_this$parentPath=this.parentPath)?void 0:_this$parentPath.isObjectPattern())},exports.isScope=function(){return nodeIsScope(this.node,this.parent)},exports.isSpreadProperty=function(){var _this$parentPath2;return nodeIsRestElement(this.node)&&(null==(_this$parentPath2=this.parentPath)?void 0:_this$parentPath2.isObjectExpression())},exports.isStatement=function(){const{node,parent}=this;if(nodeIsStatement(node)){if(isVariableDeclaration(node)){if(isForXStatement(parent,{left:node}))return!1;if(isForStatement(parent,{init:node}))return!1}return!0}return!1},exports.isUser=function(){return this.node&&!!this.node.loc},exports.isVar=function(){return nodeIsVar(this.node)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{isBinding,isBlockScoped:nodeIsBlockScoped,isExportDeclaration,isExpression:nodeIsExpression,isFlow:nodeIsFlow,isForStatement,isForXStatement,isIdentifier,isImportDeclaration,isImportSpecifier,isJSXIdentifier,isJSXMemberExpression,isMemberExpression,isRestElement:nodeIsRestElement,isReferenced:nodeIsReferenced,isScope:nodeIsScope,isStatement:nodeIsStatement,isVar:nodeIsVar,isVariableDeclaration,react,isForOfStatement}=_t,{isCompatTag}=react;exports.isExistentialTypeParam=function(){throw new Error("`path.isExistentialTypeParam` has been renamed to `path.isExistsTypeAnnotation()` in Babel 7.")},exports.isNumericLiteralTypeAnnotation=function(){throw new Error("`path.isNumericLiteralTypeAnnotation()` has been renamed to `path.isNumberLiteralTypeAnnotation()` in Babel 7.")}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Var=exports.User=exports.Statement=exports.SpreadProperty=exports.Scope=exports.RestProperty=exports.ReferencedMemberExpression=exports.ReferencedIdentifier=exports.Referenced=exports.Pure=exports.NumericLiteralTypeAnnotation=exports.Generated=exports.ForAwaitStatement=exports.Flow=exports.Expression=exports.ExistentialTypeParam=exports.BlockScoped=exports.BindingIdentifier=void 0;exports.ReferencedIdentifier=["Identifier","JSXIdentifier"],exports.ReferencedMemberExpression=["MemberExpression"],exports.BindingIdentifier=["Identifier"],exports.Statement=["Statement"],exports.Expression=["Expression"],exports.Scope=["Scopable","Pattern"],exports.Referenced=null,exports.BlockScoped=null,exports.Var=["VariableDeclaration"],exports.User=null,exports.Generated=null,exports.Pure=null,exports.Flow=["Flow","ImportDeclaration","ExportDeclaration","ImportSpecifier"],exports.RestProperty=["RestElement"],exports.SpreadProperty=["RestElement"],exports.ExistentialTypeParam=["ExistsTypeAnnotation"],exports.NumericLiteralTypeAnnotation=["NumberLiteralTypeAnnotation"],exports.ForAwaitStatement=["ForOfStatement"]},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._containerInsert=_containerInsert,exports._containerInsertAfter=_containerInsertAfter,exports._containerInsertBefore=_containerInsertBefore,exports._verifyNodeList=_verifyNodeList,exports.insertAfter=function(nodes_){if(_removal._assertUnremoved.call(this),this.isSequenceExpression())return last(this.get("expressions")).insertAfter(nodes_);const nodes=_verifyNodeList.call(this,nodes_),{parentPath,parent}=this;if(parentPath.isExpressionStatement()||parentPath.isLabeledStatement()||isExportNamedDeclaration(parent)||parentPath.isExportDefaultDeclaration()&&this.isDeclaration())return parentPath.insertAfter(nodes.map((node=>isExpression(node)?expressionStatement(node):node)));if(this.isNodeType("Expression")&&!this.isJSXElement()&&!parentPath.isJSXElement()||parentPath.isForStatement()&&"init"===this.key){const self=this;if(self.node){const node=self.node;let{scope}=this;if(scope.path.isPattern())return assertExpression(node),self.replaceWith(callExpression(arrowFunctionExpression([],node),[])),self.get("callee.body").insertAfter(nodes),[self];if(isHiddenInSequenceExpression(self))nodes.unshift(node);else if(isCallExpression(node)&&isSuper(node.callee))nodes.unshift(node),nodes.push(thisExpression());else if(function(node,scope){if(!isAssignmentExpression(node)||!isIdentifier(node.left))return!1;const blockScope=scope.getBlockParent();return blockScope.hasOwnBinding(node.left.name)&&blockScope.getOwnBinding(node.left.name).constantViolations.length<=1}(node,scope))nodes.unshift(node),nodes.push(cloneNode(node.left));else if(scope.isPure(node,!0))nodes.push(node);else{parentPath.isMethod({computed:!0,key:node})&&(scope=scope.parent);const temp=scope.generateDeclaredUidIdentifier();nodes.unshift(expressionStatement(assignmentExpression("=",cloneNode(temp),node))),nodes.push(expressionStatement(cloneNode(temp)))}}return this.replaceExpressionWithStatements(nodes)}if(Array.isArray(this.container))return _containerInsertAfter.call(this,nodes);if(this.isStatementOrBlock()){const node=this.node,shouldInsertCurrentNode=node&&(!this.isExpressionStatement()||null!=node.expression);return this.replaceWith(blockStatement(shouldInsertCurrentNode?[node]:[])),this.pushContainer("body",nodes)}throw new Error("We don't know what to do with this node type. We were previously a Statement but we can't fit in here?")},exports.insertBefore=function(nodes_){_removal._assertUnremoved.call(this);const nodes=_verifyNodeList.call(this,nodes_),{parentPath,parent}=this;if(parentPath.isExpressionStatement()||parentPath.isLabeledStatement()||isExportNamedDeclaration(parent)||parentPath.isExportDefaultDeclaration()&&this.isDeclaration())return parentPath.insertBefore(nodes);if(this.isNodeType("Expression")&&!this.isJSXElement()||parentPath.isForStatement()&&"init"===this.key)return this.node&&nodes.push(this.node),this.replaceExpressionWithStatements(nodes);if(Array.isArray(this.container))return _containerInsertBefore.call(this,nodes);if(this.isStatementOrBlock()){const node=this.node,shouldInsertCurrentNode=node&&(!this.isExpressionStatement()||null!=node.expression);return this.replaceWith(blockStatement(shouldInsertCurrentNode?[node]:[])),this.unshiftContainer("body",nodes)}throw new Error("We don't know what to do with this node type. We were previously a Statement but we can't fit in here?")},exports.pushContainer=function(listKey,nodes){_removal._assertUnremoved.call(this);const verifiedNodes=_verifyNodeList.call(this,nodes),container=this.node[listKey];return _index.default.get({parentPath:this,parent:this.node,container,listKey,key:container.length}).setContext(this.context).replaceWithMultiple(verifiedNodes)},exports.unshiftContainer=function(listKey,nodes){_removal._assertUnremoved.call(this),nodes=_verifyNodeList.call(this,nodes);const path=_index.default.get({parentPath:this,parent:this.node,container:this.node[listKey],listKey,key:0}).setContext(this.context);return _containerInsertBefore.call(path,nodes)},exports.updateSiblingKeys=updateSiblingKeys;var _cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_hoister=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/hoister.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js"),_removal=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{arrowFunctionExpression,assertExpression,assignmentExpression,blockStatement,callExpression,cloneNode,expressionStatement,isAssignmentExpression,isCallExpression,isExportNamedDeclaration,isExpression,isIdentifier,isSequenceExpression,isSuper,thisExpression}=_t;function _containerInsert(from,nodes){updateSiblingKeys.call(this,from,nodes.length);const paths=[];this.container.splice(from,0,...nodes);for(let i=0;i<nodes.length;i++){var _this$context;const to=from+i,path=this.getSibling(to);paths.push(path),null!=(_this$context=this.context)&&_this$context.queue&&_context.pushContext.call(path,this.context)}const contexts=_context._getQueueContexts.call(this);for(const path of paths){_context.setScope.call(path),path.debug("Inserted.");for(const context of contexts)context.maybeQueue(path,!0)}return paths}function _containerInsertBefore(nodes){return _containerInsert.call(this,this.key,nodes)}function _containerInsertAfter(nodes){return _containerInsert.call(this,this.key+1,nodes)}const last=arr=>arr[arr.length-1];function isHiddenInSequenceExpression(path){return isSequenceExpression(path.parent)&&(last(path.parent.expressions)!==path.node||isHiddenInSequenceExpression(path.parentPath))}function updateSiblingKeys(fromIndex,incrementBy){if(!this.parent)return;const paths=(0,_cache.getCachedPaths)(this.hub,this.parent)||[];for(const[,path]of paths)"number"==typeof path.key&&path.container===this.container&&path.key>=fromIndex&&(path.key+=incrementBy)}function _verifyNodeList(nodes){if(!nodes)return[];Array.isArray(nodes)||(nodes=[nodes]);for(let i=0;i<nodes.length;i++){const node=nodes[i];let msg;if(node?"object"!=typeof node?msg="contains a non-object node":node.type?node instanceof _index.default&&(msg="has a NodePath when it expected a raw object"):msg="without a type":msg="has falsy node",msg){const type=Array.isArray(node)?"array":typeof node;throw new Error(`Node list ${msg} with the index of ${i} and type of ${type}`)}}return nodes}exports.hoist=function(scope=this.scope){return new _hoister.default(this,scope).run()}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._assertUnremoved=_assertUnremoved,exports._callRemovalHooks=_callRemovalHooks,exports._markRemoved=_markRemoved,exports._remove=_remove,exports._removeFromScope=_removeFromScope,exports.remove=function(){var _this$opts;if(_assertUnremoved.call(this),_context.resync.call(this),_callRemovalHooks.call(this))return void _markRemoved.call(this);null!=(_this$opts=this.opts)&&_this$opts.noScope||_removeFromScope.call(this);this.shareCommentsWithSiblings(),_remove.call(this),_markRemoved.call(this)};var _removalHooks=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/removal-hooks.js"),_cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_replacement=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/replacement.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_modification=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{getBindingIdentifiers}=_t;function _removeFromScope(){const bindings=getBindingIdentifiers(this.node,!1,!1,!0);Object.keys(bindings).forEach((name=>this.scope.removeBinding(name)))}function _callRemovalHooks(){if(this.parentPath)for(const fn of _removalHooks.hooks)if(fn(this,this.parentPath))return!0}function _remove(){Array.isArray(this.container)?(this.container.splice(this.key,1),_modification.updateSiblingKeys.call(this,this.key,-1)):_replacement._replaceWith.call(this,null)}function _markRemoved(){this._traverseFlags|=_index.SHOULD_SKIP|_index.REMOVED,this.parent&&(0,_cache.getCachedPaths)(this.hub,this.parent).delete(this.node),this.node=null}function _assertUnremoved(){if(this.removed)throw this.buildCodeFrameError("NodePath has been removed so is read-only.")}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/replacement.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._replaceWith=_replaceWith,exports.replaceExpressionWithStatements=function(nodes){_context.resync.call(this);const declars=[],nodesAsSingleExpression=gatherSequenceExpressions(nodes,declars);if(nodesAsSingleExpression){for(const id of declars)this.scope.push({id});return this.replaceWith(nodesAsSingleExpression)[0].get("expressions")}const functionParent=this.getFunctionParent(),isParentAsync=null==functionParent?void 0:functionParent.node.async,isParentGenerator=null==functionParent?void 0:functionParent.node.generator,container=arrowFunctionExpression([],blockStatement(nodes));this.replaceWith(callExpression(container,[]));const callee=this.get("callee");callee.get("body").scope.hoistVariables((id=>this.scope.push({id})));const completionRecords=callee.getCompletionRecords();for(const path of completionRecords){if(!path.isExpressionStatement())continue;const loop=path.findParent((path=>path.isLoop()));if(loop){let uid=loop.getData("expressionReplacementReturnUid");uid?uid=identifier(uid.name):(uid=callee.scope.generateDeclaredUidIdentifier("ret"),callee.get("body").pushContainer("body",returnStatement(cloneNode(uid))),loop.setData("expressionReplacementReturnUid",uid)),path.get("expression").replaceWith(assignmentExpression("=",cloneNode(uid),path.node.expression))}else path.replaceWith(returnStatement(path.node.expression))}callee.arrowFunctionToExpression();const newCallee=callee,needToAwaitFunction=isParentAsync&&_index.default.hasType(this.get("callee.body").node,"AwaitExpression",FUNCTION_TYPES),needToYieldFunction=isParentGenerator&&_index.default.hasType(this.get("callee.body").node,"YieldExpression",FUNCTION_TYPES);needToAwaitFunction&&(newCallee.set("async",!0),needToYieldFunction||this.replaceWith(awaitExpression(this.node)));needToYieldFunction&&(newCallee.set("generator",!0),this.replaceWith(yieldExpression(this.node,!0)));return newCallee.get("body.body")},exports.replaceInline=function(nodes){if(_context.resync.call(this),Array.isArray(nodes)){if(Array.isArray(this.container)){nodes=_modification._verifyNodeList.call(this,nodes);const paths=_modification._containerInsertAfter.call(this,nodes);return this.remove(),paths}return this.replaceWithMultiple(nodes)}return this.replaceWith(nodes)},exports.replaceWith=function(replacementPath){if(_context.resync.call(this),this.removed)throw new Error("You can't replace this node, we've already removed it");let replacement=replacementPath instanceof _index2.default?replacementPath.node:replacementPath;if(!replacement)throw new Error("You passed `path.replaceWith()` a falsy node, use `path.remove()` instead");if(this.node===replacement)return[this];if(this.isProgram()&&!isProgram(replacement))throw new Error("You can only replace a Program root node with another Program node");if(Array.isArray(replacement))throw new Error("Don't use `path.replaceWith()` with an array of nodes, use `path.replaceWithMultiple()`");if("string"==typeof replacement)throw new Error("Don't use `path.replaceWith()` with a source string, use `path.replaceWithSourceString()`");let nodePath="";this.isNodeType("Statement")&&isExpression(replacement)&&(this.canHaveVariableDeclarationOrExpression()||this.canSwapBetweenExpressionAndStatement(replacement)||this.parentPath.isExportDefaultDeclaration()||(replacement=expressionStatement(replacement),nodePath="expression"));if(this.isNodeType("Expression")&&isStatement(replacement)&&!this.canHaveVariableDeclarationOrExpression()&&!this.canSwapBetweenExpressionAndStatement(replacement))return this.replaceExpressionWithStatements([replacement]);const oldNode=this.node;oldNode&&(inheritsComments(replacement,oldNode),removeComments(oldNode));return _replaceWith.call(this,replacement),this.type=replacement.type,_context.setScope.call(this),this.requeue(),[nodePath?this.get(nodePath):this]},exports.replaceWithMultiple=function(nodes){var _getCachedPaths;_context.resync.call(this),nodes=_modification._verifyNodeList.call(this,nodes),inheritLeadingComments(nodes[0],this.node),inheritTrailingComments(nodes[nodes.length-1],this.node),null==(_getCachedPaths=(0,_cache.getCachedPaths)(this.hub,this.parent))||_getCachedPaths.delete(this.node),this.node=this.container[this.key]=null;const paths=this.insertAfter(nodes);this.node?this.requeue():this.remove();return paths},exports.replaceWithSourceString=function(replacement){let ast;_context.resync.call(this);try{replacement=`(${replacement})`,ast=(0,_parser.parse)(replacement)}catch(err){const loc=err.loc;throw loc&&(err.message+=" - make sure this is an expression.\n"+(0,_codeFrame.codeFrameColumns)(replacement,{start:{line:loc.line,column:loc.column+1}}),err.code="BABEL_REPLACE_SOURCE_ERROR"),err}const expressionAST=ast.program.body[0].expression;return _index.default.removeProperties(expressionAST),this.replaceWith(expressionAST)};var _codeFrame=__webpack_require__("./stubs/babel-codeframe.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_modification=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js"),_parser=__webpack_require__("./node_modules/.pnpm/@babel+parser@7.26.3/node_modules/@babel/parser/lib/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{FUNCTION_TYPES,arrowFunctionExpression,assignmentExpression,awaitExpression,blockStatement,buildUndefinedNode,callExpression,cloneNode,conditionalExpression,expressionStatement,getBindingIdentifiers,identifier,inheritLeadingComments,inheritTrailingComments,inheritsComments,isBlockStatement,isEmptyStatement,isExpression,isExpressionStatement,isIfStatement,isProgram,isStatement,isVariableDeclaration,removeComments,returnStatement,sequenceExpression,validate,yieldExpression}=_t;function _replaceWith(node){var _getCachedPaths2;if(!this.container)throw new ReferenceError("Container is falsy");this.inList?validate(this.parent,this.key,[node]):validate(this.parent,this.key,node),this.debug(`Replace with ${null==node?void 0:node.type}`),null==(_getCachedPaths2=(0,_cache.getCachedPaths)(this.hub,this.parent))||_getCachedPaths2.set(node,this).delete(this.node),this.node=this.container[this.key]=node}function gatherSequenceExpressions(nodes,declars){const exprs=[];let ensureLastUndefined=!0;for(const node of nodes)if(isEmptyStatement(node)||(ensureLastUndefined=!1),isExpression(node))exprs.push(node);else if(isExpressionStatement(node))exprs.push(node.expression);else if(isVariableDeclaration(node)){if("var"!==node.kind)return;for(const declar of node.declarations){const bindings=getBindingIdentifiers(declar);for(const key of Object.keys(bindings))declars.push(cloneNode(bindings[key]));declar.init&&exprs.push(assignmentExpression("=",declar.id,declar.init))}ensureLastUndefined=!0}else if(isIfStatement(node)){const consequent=node.consequent?gatherSequenceExpressions([node.consequent],declars):buildUndefinedNode(),alternate=node.alternate?gatherSequenceExpressions([node.alternate],declars):buildUndefinedNode();if(!consequent||!alternate)return;exprs.push(conditionalExpression(node.test,consequent,alternate))}else if(isBlockStatement(node)){const body=gatherSequenceExpressions(node.body,declars);if(!body)return;exprs.push(body)}else{if(!isEmptyStatement(node))return;0===nodes.indexOf(node)&&(ensureLastUndefined=!0)}return ensureLastUndefined&&exprs.push(buildUndefinedNode()),1===exprs.length?exprs[0]:sequenceExpression(exprs)}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/binding.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;exports.default=class{constructor({identifier,scope,path,kind}){this.identifier=void 0,this.scope=void 0,this.path=void 0,this.kind=void 0,this.constantViolations=[],this.constant=!0,this.referencePaths=[],this.referenced=!1,this.references=0,this.identifier=identifier,this.scope=scope,this.path=path,this.kind=kind,"var"!==kind&&"hoisted"!==kind||!function(path){for(let{parentPath,key}=path;parentPath;({parentPath,key}=parentPath)){if(parentPath.isFunctionParent())return!1;if(parentPath.isWhile()||parentPath.isForXStatement()||parentPath.isForStatement()&&"body"===key)return!0}return!1}(path)||this.reassign(path),this.clearValue()}deoptValue(){this.clearValue(),this.hasDeoptedValue=!0}setValue(value){this.hasDeoptedValue||(this.hasValue=!0,this.value=value)}clearValue(){this.hasDeoptedValue=!1,this.hasValue=!1,this.value=null}reassign(path){this.constant=!1,this.constantViolations.includes(path)||this.constantViolations.push(path)}reference(path){this.referencePaths.includes(path)||(this.referenced=!0,this.references++,this.referencePaths.push(path))}dereference(){this.references--,this.referenced=!!this.references}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _renamer=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/lib/renamer.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js"),_binding=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/binding.js"),_globals=__webpack_require__("./node_modules/.pnpm/globals@11.12.0/node_modules/globals/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),t=_t,_cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js");const{NOT_LOCAL_BINDING,assignmentExpression,callExpression,cloneNode,getBindingIdentifiers,identifier,isArrayExpression,isBinary,isCallExpression,isClass,isClassBody,isClassDeclaration,isExportAllDeclaration,isExportDefaultDeclaration,isExportNamedDeclaration,isFunctionDeclaration,isIdentifier,isImportDeclaration,isLiteral,isMemberExpression,isMethod,isModuleSpecifier,isNullLiteral,isObjectExpression,isProperty,isPureish,isRegExpLiteral,isSuper,isTaggedTemplateExpression,isTemplateLiteral,isThisExpression,isUnaryExpression,isVariableDeclaration,expressionStatement,matchesPattern,memberExpression,numericLiteral,toIdentifier,variableDeclaration,variableDeclarator,isRecordExpression,isTupleExpression,isObjectProperty,isTopicReference,isMetaProperty,isPrivateName,isExportDeclaration,buildUndefinedNode,sequenceExpression}=_t;function gatherNodeParts(node,parts){switch(null==node?void 0:node.type){default:var _node$specifiers;if(isImportDeclaration(node)||isExportDeclaration(node))if((isExportAllDeclaration(node)||isExportNamedDeclaration(node)||isImportDeclaration(node))&&node.source)gatherNodeParts(node.source,parts);else if((isExportNamedDeclaration(node)||isImportDeclaration(node))&&null!=(_node$specifiers=node.specifiers)&&_node$specifiers.length)for(const e of node.specifiers)gatherNodeParts(e,parts);else(isExportDefaultDeclaration(node)||isExportNamedDeclaration(node))&&node.declaration&&gatherNodeParts(node.declaration,parts);else isModuleSpecifier(node)?gatherNodeParts(node.local,parts):!isLiteral(node)||isNullLiteral(node)||isRegExpLiteral(node)||isTemplateLiteral(node)||parts.push(node.value);break;case"MemberExpression":case"OptionalMemberExpression":case"JSXMemberExpression":gatherNodeParts(node.object,parts),gatherNodeParts(node.property,parts);break;case"Identifier":case"JSXIdentifier":parts.push(node.name);break;case"CallExpression":case"OptionalCallExpression":case"NewExpression":gatherNodeParts(node.callee,parts);break;case"ObjectExpression":case"ObjectPattern":for(const e of node.properties)gatherNodeParts(e,parts);break;case"SpreadElement":case"RestElement":case"UnaryExpression":case"UpdateExpression":gatherNodeParts(node.argument,parts);break;case"ObjectProperty":case"ObjectMethod":case"ClassProperty":case"ClassMethod":case"ClassPrivateProperty":case"ClassPrivateMethod":gatherNodeParts(node.key,parts);break;case"ThisExpression":parts.push("this");break;case"Super":parts.push("super");break;case"Import":parts.push("import");break;case"DoExpression":parts.push("do");break;case"YieldExpression":parts.push("yield"),gatherNodeParts(node.argument,parts);break;case"AwaitExpression":parts.push("await"),gatherNodeParts(node.argument,parts);break;case"AssignmentExpression":gatherNodeParts(node.left,parts);break;case"VariableDeclarator":case"FunctionExpression":case"FunctionDeclaration":case"ClassExpression":case"ClassDeclaration":case"PrivateName":gatherNodeParts(node.id,parts);break;case"ParenthesizedExpression":gatherNodeParts(node.expression,parts);break;case"MetaProperty":gatherNodeParts(node.meta,parts),gatherNodeParts(node.property,parts);break;case"JSXElement":gatherNodeParts(node.openingElement,parts);break;case"JSXOpeningElement":gatherNodeParts(node.name,parts);break;case"JSXFragment":gatherNodeParts(node.openingFragment,parts);break;case"JSXOpeningFragment":parts.push("Fragment");break;case"JSXNamespacedName":gatherNodeParts(node.namespace,parts),gatherNodeParts(node.name,parts)}}const collectorVisitor={ForStatement(path){const declar=path.get("init");if(declar.isVar()){const{scope}=path;(scope.getFunctionParent()||scope.getProgramParent()).registerBinding("var",declar)}},Declaration(path){if(path.isBlockScoped())return;if(path.isImportDeclaration())return;if(path.isExportDeclaration())return;(path.scope.getFunctionParent()||path.scope.getProgramParent()).registerDeclaration(path)},ImportDeclaration(path){path.scope.getBlockParent().registerDeclaration(path)},ReferencedIdentifier(path,state){state.references.push(path)},ForXStatement(path,state){const left=path.get("left");if(left.isPattern()||left.isIdentifier())state.constantViolations.push(path);else if(left.isVar()){const{scope}=path;(scope.getFunctionParent()||scope.getProgramParent()).registerBinding("var",left)}},ExportDeclaration:{exit(path){const{node,scope}=path;if(isExportAllDeclaration(node))return;const declar=node.declaration;if(isClassDeclaration(declar)||isFunctionDeclaration(declar)){const id=declar.id;if(!id)return;const binding=scope.getBinding(id.name);null==binding||binding.reference(path)}else if(isVariableDeclaration(declar))for(const decl of declar.declarations)for(const name of Object.keys(getBindingIdentifiers(decl))){const binding=scope.getBinding(name);null==binding||binding.reference(path)}}},LabeledStatement(path){path.scope.getBlockParent().registerDeclaration(path)},AssignmentExpression(path,state){state.assignments.push(path)},UpdateExpression(path,state){state.constantViolations.push(path)},UnaryExpression(path,state){"delete"===path.node.operator&&state.constantViolations.push(path)},BlockScoped(path){let scope=path.scope;scope.path===path&&(scope=scope.parent);if(scope.getBlockParent().registerDeclaration(path),path.isClassDeclaration()&&path.node.id){const name=path.node.id.name;path.scope.bindings[name]=path.scope.parent.getBinding(name)}},CatchClause(path){path.scope.registerBinding("let",path)},Function(path){const params=path.get("params");for(const param of params)path.scope.registerBinding("param",param);path.isFunctionExpression()&&path.node.id&&!path.node.id[NOT_LOCAL_BINDING]&&path.scope.registerBinding("local",path.get("id"),path)},ClassExpression(path){path.node.id&&!path.node.id[NOT_LOCAL_BINDING]&&path.scope.registerBinding("local",path.get("id"),path)},TSTypeAnnotation(path){path.skip()}};let uid=0;class Scope{constructor(path){this.uid=void 0,this.path=void 0,this.block=void 0,this.inited=void 0,this.labels=void 0,this.bindings=void 0,this.references=void 0,this.globals=void 0,this.uids=void 0,this.data=void 0,this.crawling=void 0;const{node}=path,cached=_cache.scope.get(node);if((null==cached?void 0:cached.path)===path)return cached;_cache.scope.set(node,this),this.uid=uid++,this.block=node,this.path=path,this.labels=new Map,this.inited=!1}get parent(){var _parent;let parent,path=this.path;do{var _path;const shouldSkip="key"===path.key||"decorators"===path.listKey;path=path.parentPath,shouldSkip&&path.isMethod()&&(path=path.parentPath),null!=(_path=path)&&_path.isScope()&&(parent=path)}while(path&&!parent);return null==(_parent=parent)?void 0:_parent.scope}generateDeclaredUidIdentifier(name){const id=this.generateUidIdentifier(name);return this.push({id}),cloneNode(id)}generateUidIdentifier(name){return identifier(this.generateUid(name))}generateUid(name="temp"){let uid;name=toIdentifier(name).replace(/^_+/,"").replace(/\d+$/g,"");let i=1;do{uid=`_${name}`,i>1&&(uid+=i),i++}while(this.hasLabel(uid)||this.hasBinding(uid)||this.hasGlobal(uid)||this.hasReference(uid));const program=this.getProgramParent();return program.references[uid]=!0,program.uids[uid]=!0,uid}generateUidBasedOnNode(node,defaultName){const parts=[];gatherNodeParts(node,parts);let id=parts.join("$");return id=id.replace(/^_/,"")||defaultName||"ref",this.generateUid(id.slice(0,20))}generateUidIdentifierBasedOnNode(node,defaultName){return identifier(this.generateUidBasedOnNode(node,defaultName))}isStatic(node){if(isThisExpression(node)||isSuper(node)||isTopicReference(node))return!0;if(isIdentifier(node)){const binding=this.getBinding(node.name);return binding?binding.constant:this.hasBinding(node.name)}return!1}maybeGenerateMemoised(node,dontPush){if(this.isStatic(node))return null;{const id=this.generateUidIdentifierBasedOnNode(node);return dontPush?id:(this.push({id}),cloneNode(id))}}checkBlockScopedCollisions(local,kind,name,id){if("param"===kind)return;if("local"===local.kind)return;if("let"===kind||"let"===local.kind||"const"===local.kind||"module"===local.kind||"param"===local.kind&&"const"===kind)throw this.path.hub.buildError(id,`Duplicate declaration "${name}"`,TypeError)}rename(oldName,newName){const binding=this.getBinding(oldName);if(binding){newName||(newName=this.generateUidIdentifier(oldName).name);new _renamer.default(binding,oldName,newName).rename(arguments[2])}}dump(){const sep="-".repeat(60);console.log(sep);let scope=this;do{console.log("#",scope.block.type);for(const name of Object.keys(scope.bindings)){const binding=scope.bindings[name];console.log(" -",name,{constant:binding.constant,references:binding.references,violations:binding.constantViolations.length,kind:binding.kind})}}while(scope=scope.parent);console.log(sep)}hasLabel(name){return!!this.getLabel(name)}getLabel(name){return this.labels.get(name)}registerLabel(path){this.labels.set(path.node.label.name,path)}registerDeclaration(path){if(path.isLabeledStatement())this.registerLabel(path);else if(path.isFunctionDeclaration())this.registerBinding("hoisted",path.get("id"),path);else if(path.isVariableDeclaration()){const declarations=path.get("declarations"),{kind}=path.node;for(const declar of declarations)this.registerBinding("using"===kind||"await using"===kind?"const":kind,declar)}else if(path.isClassDeclaration()){if(path.node.declare)return;this.registerBinding("let",path)}else if(path.isImportDeclaration()){const isTypeDeclaration="type"===path.node.importKind||"typeof"===path.node.importKind,specifiers=path.get("specifiers");for(const specifier of specifiers){const isTypeSpecifier=isTypeDeclaration||specifier.isImportSpecifier()&&("type"===specifier.node.importKind||"typeof"===specifier.node.importKind);this.registerBinding(isTypeSpecifier?"unknown":"module",specifier)}}else if(path.isExportDeclaration()){const declar=path.get("declaration");(declar.isClassDeclaration()||declar.isFunctionDeclaration()||declar.isVariableDeclaration())&&this.registerDeclaration(declar)}else this.registerBinding("unknown",path)}buildUndefinedNode(){return buildUndefinedNode()}registerConstantViolation(path){const ids=path.getAssignmentIdentifiers();for(const name of Object.keys(ids)){var _this$getBinding;null==(_this$getBinding=this.getBinding(name))||_this$getBinding.reassign(path)}}registerBinding(kind,path,bindingPath=path){if(!kind)throw new ReferenceError("no `kind`");if(path.isVariableDeclaration()){const declarators=path.get("declarations");for(const declar of declarators)this.registerBinding(kind,declar);return}const parent=this.getProgramParent(),ids=path.getOuterBindingIdentifiers(!0);for(const name of Object.keys(ids)){parent.references[name]=!0;for(const id of ids[name]){const local=this.getOwnBinding(name);if(local){if(local.identifier===id)continue;this.checkBlockScopedCollisions(local,kind,name,id)}local?local.reassign(bindingPath):this.bindings[name]=new _binding.default({identifier:id,scope:this,path:bindingPath,kind})}}}addGlobal(node){this.globals[node.name]=node}hasUid(name){let scope=this;do{if(scope.uids[name])return!0}while(scope=scope.parent);return!1}hasGlobal(name){let scope=this;do{if(scope.globals[name])return!0}while(scope=scope.parent);return!1}hasReference(name){return!!this.getProgramParent().references[name]}isPure(node,constantsOnly){if(isIdentifier(node)){const binding=this.getBinding(node.name);return!!binding&&(!constantsOnly||binding.constant)}if(isThisExpression(node)||isMetaProperty(node)||isTopicReference(node)||isPrivateName(node))return!0;var _node$decorators,_node$decorators2,_node$decorators3;if(isClass(node))return!(node.superClass&&!this.isPure(node.superClass,constantsOnly))&&(!((null==(_node$decorators=node.decorators)?void 0:_node$decorators.length)>0)&&this.isPure(node.body,constantsOnly));if(isClassBody(node)){for(const method of node.body)if(!this.isPure(method,constantsOnly))return!1;return!0}if(isBinary(node))return this.isPure(node.left,constantsOnly)&&this.isPure(node.right,constantsOnly);if(isArrayExpression(node)||isTupleExpression(node)){for(const elem of node.elements)if(null!==elem&&!this.isPure(elem,constantsOnly))return!1;return!0}if(isObjectExpression(node)||isRecordExpression(node)){for(const prop of node.properties)if(!this.isPure(prop,constantsOnly))return!1;return!0}if(isMethod(node))return!(node.computed&&!this.isPure(node.key,constantsOnly))&&!((null==(_node$decorators2=node.decorators)?void 0:_node$decorators2.length)>0);if(isProperty(node))return!(node.computed&&!this.isPure(node.key,constantsOnly))&&(!((null==(_node$decorators3=node.decorators)?void 0:_node$decorators3.length)>0)&&!((isObjectProperty(node)||node.static)&&null!==node.value&&!this.isPure(node.value,constantsOnly)));if(isUnaryExpression(node))return this.isPure(node.argument,constantsOnly);if(isTemplateLiteral(node)){for(const expression of node.expressions)if(!this.isPure(expression,constantsOnly))return!1;return!0}return isTaggedTemplateExpression(node)?matchesPattern(node.tag,"String.raw")&&!this.hasBinding("String",{noGlobals:!0})&&this.isPure(node.quasi,constantsOnly):isMemberExpression(node)?!node.computed&&isIdentifier(node.object)&&"Symbol"===node.object.name&&isIdentifier(node.property)&&"for"!==node.property.name&&!this.hasBinding("Symbol",{noGlobals:!0}):isCallExpression(node)?matchesPattern(node.callee,"Symbol.for")&&!this.hasBinding("Symbol",{noGlobals:!0})&&1===node.arguments.length&&t.isStringLiteral(node.arguments[0]):isPureish(node)}setData(key,val){return this.data[key]=val}getData(key){let scope=this;do{const data=scope.data[key];if(null!=data)return data}while(scope=scope.parent)}removeData(key){let scope=this;do{null!=scope.data[key]&&(scope.data[key]=null)}while(scope=scope.parent)}init(){this.inited||(this.inited=!0,this.crawl())}crawl(){const path=this.path;this.references=Object.create(null),this.bindings=Object.create(null),this.globals=Object.create(null),this.uids=Object.create(null),this.data=Object.create(null);let scope=this;do{if(scope.crawling)return;if(scope.path.isProgram())break}while(scope=scope.parent);const programParent=scope,state={references:[],constantViolations:[],assignments:[]};if(this.crawling=!0,"Program"!==path.type&&(0,_visitors.isExplodedVisitor)(collectorVisitor)){for(const visit of collectorVisitor.enter)visit.call(state,path,state);const typeVisitors=collectorVisitor[path.type];if(typeVisitors)for(const visit of typeVisitors.enter)visit.call(state,path,state)}path.traverse(collectorVisitor,state),this.crawling=!1;for(const path of state.assignments){const ids=path.getAssignmentIdentifiers();for(const name of Object.keys(ids))path.scope.getBinding(name)||programParent.addGlobal(ids[name]);path.scope.registerConstantViolation(path)}for(const ref of state.references){const binding=ref.scope.getBinding(ref.node.name);binding?binding.reference(ref):programParent.addGlobal(ref.node)}for(const path of state.constantViolations)path.scope.registerConstantViolation(path)}push(opts){let path=this.path;path.isPattern()?path=this.getPatternParent().path:path.isBlockStatement()||path.isProgram()||(path=this.getBlockParent().path),path.isSwitchStatement()&&(path=(this.getFunctionParent()||this.getProgramParent()).path);const{init,unique,kind="var",id}=opts;if(!init&&!unique&&("var"===kind||"let"===kind)&&path.isFunction()&&!path.node.name&&isCallExpression(path.parent,{callee:path.node})&&path.parent.arguments.length<=path.node.params.length&&isIdentifier(id))return path.pushContainer("params",id),void path.scope.registerBinding("param",path.get("params")[path.node.params.length-1]);(path.isLoop()||path.isCatchClause()||path.isFunction())&&(path.ensureBlock(),path=path.get("body"));const blockHoist=null==opts._blockHoist?2:opts._blockHoist,dataKey=`declaration:${kind}:${blockHoist}`;let declarPath=!unique&&path.getData(dataKey);if(!declarPath){const declar=variableDeclaration(kind,[]);declar._blockHoist=blockHoist,[declarPath]=path.unshiftContainer("body",[declar]),unique||path.setData(dataKey,declarPath)}const declarator=variableDeclarator(id,init),len=declarPath.node.declarations.push(declarator);path.scope.registerBinding(kind,declarPath.get("declarations")[len-1])}getProgramParent(){let scope=this;do{if(scope.path.isProgram())return scope}while(scope=scope.parent);throw new Error("Couldn't find a Program")}getFunctionParent(){let scope=this;do{if(scope.path.isFunctionParent())return scope}while(scope=scope.parent);return null}getBlockParent(){let scope=this;do{if(scope.path.isBlockParent())return scope}while(scope=scope.parent);throw new Error("We couldn't find a BlockStatement, For, Switch, Function, Loop or Program...")}getPatternParent(){let scope=this;do{if(!scope.path.isPattern())return scope.getBlockParent()}while(scope=scope.parent.parent);throw new Error("We couldn't find a BlockStatement, For, Switch, Function, Loop or Program...")}getAllBindings(){const ids=Object.create(null);let scope=this;do{for(const key of Object.keys(scope.bindings))key in ids==!1&&(ids[key]=scope.bindings[key]);scope=scope.parent}while(scope);return ids}bindingIdentifierEquals(name,node){return this.getBindingIdentifier(name)===node}getBinding(name){let previousPath,scope=this;do{const binding=scope.getOwnBinding(name);var _previousPath;if(binding){if(null==(_previousPath=previousPath)||!_previousPath.isPattern()||"param"===binding.kind||"local"===binding.kind)return binding}else if(!binding&&"arguments"===name&&scope.path.isFunction()&&!scope.path.isArrowFunctionExpression())break;previousPath=scope.path}while(scope=scope.parent)}getOwnBinding(name){return this.bindings[name]}getBindingIdentifier(name){var _this$getBinding2;return null==(_this$getBinding2=this.getBinding(name))?void 0:_this$getBinding2.identifier}getOwnBindingIdentifier(name){const binding=this.bindings[name];return null==binding?void 0:binding.identifier}hasOwnBinding(name){return!!this.getOwnBinding(name)}hasBinding(name,opts){if(!name)return!1;let noGlobals,noUids,scope=this;do{if(scope.hasOwnBinding(name))return!0}while(scope=scope.parent);return"object"==typeof opts?(noGlobals=opts.noGlobals,noUids=opts.noUids):"boolean"==typeof opts&&(noGlobals=opts),!(noUids||!this.hasUid(name))||(!(noGlobals||!Scope.globals.includes(name))||!(noGlobals||!Scope.contextVariables.includes(name)))}parentHasBinding(name,opts){var _this$parent;return null==(_this$parent=this.parent)?void 0:_this$parent.hasBinding(name,opts)}moveBindingTo(name,scope){const info=this.getBinding(name);info&&(info.scope.removeOwnBinding(name),info.scope=scope,scope.bindings[name]=info)}removeOwnBinding(name){delete this.bindings[name]}removeBinding(name){var _this$getBinding3;null==(_this$getBinding3=this.getBinding(name))||_this$getBinding3.scope.removeOwnBinding(name);let scope=this;do{scope.uids[name]&&(scope.uids[name]=!1)}while(scope=scope.parent)}hoistVariables(emit=id=>this.push({id})){this.crawl();const seen=new Set;for(const name of Object.keys(this.bindings)){const binding=this.bindings[name];if(!binding)continue;const{path}=binding;if(!path.isVariableDeclarator())continue;const{parent,parentPath}=path;if("var"!==parent.kind||seen.has(parent))continue;let firstId;seen.add(path.parent);const init=[];for(const decl of parent.declarations){null!=firstId||(firstId=decl.id),decl.init&&init.push(assignmentExpression("=",decl.id,decl.init));const ids=Object.keys(getBindingIdentifiers(decl,!1,!0,!0));for(const name of ids)emit(identifier(name),null!=decl.init)}if(parentPath.parentPath.isFor({left:parent}))parentPath.replaceWith(firstId);else if(0===init.length)parentPath.remove();else{const expr=1===init.length?init[0]:sequenceExpression(init);parentPath.parentPath.isForStatement({init:parent})?parentPath.replaceWith(expr):parentPath.replaceWith(expressionStatement(expr))}}}}exports.default=Scope,Scope.globals=Object.keys(_globals.builtin),Scope.contextVariables=["arguments","undefined","Infinity","NaN"],Scope.prototype._renameFromMap=function(map,oldName,newName,value){map[oldName]&&(map[newName]=value,map[oldName]=null)},Scope.prototype.traverse=function(node,opts,state){(0,_index.default)(node,opts,this,state,this.path)},Scope.prototype._generateUid=function(name,i){let id=name;return i>1&&(id+=i),`_${id}`},Scope.prototype.toArray=function(node,i,arrayLikeIsIterable){if(isIdentifier(node)){const binding=this.getBinding(node.name);if(null!=binding&&binding.constant&&binding.path.isGenericType("Array"))return node}if(isArrayExpression(node))return node;if(isIdentifier(node,{name:"arguments"}))return callExpression(memberExpression(memberExpression(memberExpression(identifier("Array"),identifier("prototype")),identifier("slice")),identifier("call")),[node]);let helperName;const args=[node];return!0===i?helperName="toConsumableArray":"number"==typeof i?(args.push(numericLiteral(i)),helperName="slicedToArray"):helperName="toArray",arrayLikeIsIterable&&(args.unshift(this.path.hub.addHelper(helperName)),helperName="maybeArrayLike"),callExpression(this.path.hub.addHelper(helperName),args)},Scope.prototype.getAllBindingsOfKind=function(...kinds){const ids=Object.create(null);for(const kind of kinds){let scope=this;do{for(const name of Object.keys(scope.bindings)){const binding=scope.bindings[name];binding.kind===kind&&(ids[name]=binding)}scope=scope.parent}while(scope)}return ids},Object.defineProperties(Scope.prototype,{parentBlock:{configurable:!0,enumerable:!0,get(){return this.path.parent}},hub:{configurable:!0,enumerable:!0,get(){return this.path.hub}}})},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/lib/renamer.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_t=t,_traverseNode=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js"),_visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{getAssignmentIdentifiers}=_t,renameVisitor={ReferencedIdentifier({node},state){node.name===state.oldName&&(node.name=state.newName)},Scope(path,state){path.scope.bindingIdentifierEquals(state.oldName,state.binding.identifier)||(path.skip(),path.isMethod()&&(path.requeueComputedKeyAndDecorators?path.requeueComputedKeyAndDecorators():_context.requeueComputedKeyAndDecorators.call(path)))},ObjectProperty({node,scope},state){const{name}=node.key;var _node$extra;!node.shorthand||name!==state.oldName&&name!==state.newName||scope.getBindingIdentifier(name)!==state.binding.identifier||(node.shorthand=!1,null!=(_node$extra=node.extra)&&_node$extra.shorthand&&(node.extra.shorthand=!1))},"AssignmentExpression|Declaration|VariableDeclarator"(path,state){if(path.isVariableDeclaration())return;const ids=path.isAssignmentExpression()?getAssignmentIdentifiers(path.node):path.getOuterBindingIdentifiers();for(const name in ids)name===state.oldName&&(ids[name].name=state.newName)}};exports.default=class{constructor(binding,oldName,newName){this.newName=newName,this.oldName=oldName,this.binding=binding}maybeConvertFromExportDeclaration(parentDeclar){const maybeExportDeclar=parentDeclar.parentPath;if(maybeExportDeclar.isExportDeclaration()){if(maybeExportDeclar.isExportDefaultDeclaration()){const{declaration}=maybeExportDeclar.node;if(t.isDeclaration(declaration)&&!declaration.id)return}maybeExportDeclar.isExportAllDeclaration()||maybeExportDeclar.splitExportDeclaration()}}maybeConvertFromClassFunctionDeclaration(path){return path}maybeConvertFromClassFunctionExpression(path){return path}rename(){const{binding,oldName,newName}=this,{scope,path}=binding,parentDeclar=path.find((path=>path.isDeclaration()||path.isFunctionExpression()||path.isClassExpression()));if(parentDeclar){parentDeclar.getOuterBindingIdentifiers()[oldName]===binding.identifier&&this.maybeConvertFromExportDeclaration(parentDeclar)}const blockToTraverse=arguments[0]||scope.block,skipKeys={discriminant:!0};t.isMethod(blockToTraverse)&&(blockToTraverse.computed&&(skipKeys.key=!0),t.isObjectMethod(blockToTraverse)||(skipKeys.decorators=!0)),(0,_traverseNode.traverseNode)(blockToTraverse,(0,_visitors.explode)(renameVisitor),scope,this,scope.path,skipKeys),arguments[0]||(scope.removeOwnBinding(oldName),scope.bindings[newName]=binding,this.binding.identifier.name=newName),parentDeclar&&(this.maybeConvertFromClassFunctionDeclaration(path),this.maybeConvertFromClassFunctionExpression(path))}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.traverseNode=function(node,opts,scope,state,path,skipKeys,visitSelf){const keys=VISITOR_KEYS[node.type];if(!keys)return!1;const context=new _context.default(scope,opts,state,path);if(visitSelf)return(null==skipKeys||!skipKeys[path.parentKey])&&context.visitQueue([path]);for(const key of keys)if((null==skipKeys||!skipKeys[key])&&context.visit(node,key))return!0;return!1};var _context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/context.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{VISITOR_KEYS}=_t},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.environmentVisitor=function(visitor){return merge([_environmentVisitor,visitor])},exports.explode=explode$1,exports.isExplodedVisitor=isExplodedVisitor,exports.merge=merge,exports.verify=verify$1;var virtualTypes=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types.js"),virtualTypesValidators=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types-validator.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{DEPRECATED_KEYS,DEPRECATED_ALIASES,FLIPPED_ALIAS_KEYS,TYPES,__internal__deprecationWarning:deprecationWarning}=_t;function isExplodedVisitor(visitor){return null==visitor?void 0:visitor._exploded}function explode$1(visitor){if(isExplodedVisitor(visitor))return visitor;visitor._exploded=!0;for(const nodeType of Object.keys(visitor)){if(shouldIgnoreKey(nodeType))continue;const parts=nodeType.split("|");if(1===parts.length)continue;const fns=visitor[nodeType];delete visitor[nodeType];for(const part of parts)visitor[part]=fns}verify$1(visitor),delete visitor.__esModule,function(obj){for(const key of Object.keys(obj)){if(shouldIgnoreKey(key))continue;const fns=obj[key];"function"==typeof fns&&(obj[key]={enter:fns})}}(visitor),ensureCallbackArrays(visitor);for(const nodeType of Object.keys(visitor)){if(shouldIgnoreKey(nodeType))continue;if(!(nodeType in virtualTypes))continue;const fns=visitor[nodeType];for(const type of Object.keys(fns))fns[type]=wrapCheck(nodeType,fns[type]);delete visitor[nodeType];const types=virtualTypes[nodeType];if(null!==types)for(const type of types)visitor[type]?mergePair(visitor[type],fns):visitor[type]=fns;else mergePair(visitor,fns)}for(const nodeType of Object.keys(visitor)){if(shouldIgnoreKey(nodeType))continue;let aliases=FLIPPED_ALIAS_KEYS[nodeType];if(nodeType in DEPRECATED_KEYS){const deprecatedKey=DEPRECATED_KEYS[nodeType];deprecationWarning(nodeType,deprecatedKey,"Visitor "),aliases=[deprecatedKey]}else if(nodeType in DEPRECATED_ALIASES){const deprecatedAlias=DEPRECATED_ALIASES[nodeType];deprecationWarning(nodeType,deprecatedAlias,"Visitor "),aliases=FLIPPED_ALIAS_KEYS[deprecatedAlias]}if(!aliases)continue;const fns=visitor[nodeType];delete visitor[nodeType];for(const alias of aliases){const existing=visitor[alias];existing?mergePair(existing,fns):visitor[alias]=Object.assign({},fns)}}for(const nodeType of Object.keys(visitor))shouldIgnoreKey(nodeType)||ensureCallbackArrays(visitor[nodeType]);return visitor}function verify$1(visitor){if(!visitor._verified){if("function"==typeof visitor)throw new Error("You passed `traverse()` a function when it expected a visitor object, are you sure you didn't mean `{ enter: Function }`?");for(const nodeType of Object.keys(visitor)){if("enter"!==nodeType&&"exit"!==nodeType||validateVisitorMethods(nodeType,visitor[nodeType]),shouldIgnoreKey(nodeType))continue;if(!TYPES.includes(nodeType))throw new Error(`You gave us a visitor for the node type ${nodeType} but it's not a valid type in @babel/traverse 7.26.4`);const visitors=visitor[nodeType];if("object"==typeof visitors)for(const visitorKey of Object.keys(visitors)){if("enter"!==visitorKey&&"exit"!==visitorKey)throw new Error(`You passed \`traverse()\` a visitor object with the property ${nodeType} that has the invalid property ${visitorKey}`);validateVisitorMethods(`${nodeType}.${visitorKey}`,visitors[visitorKey])}}visitor._verified=!0}}function validateVisitorMethods(path,val){const fns=[].concat(val);for(const fn of fns)if("function"!=typeof fn)throw new TypeError(`Non-function found defined in ${path} with type ${typeof fn}`)}function merge(visitors,states=[],wrapper){const mergedVisitor={_verified:!0,_exploded:!0};Object.defineProperty(mergedVisitor,"_exploded",{enumerable:!1}),Object.defineProperty(mergedVisitor,"_verified",{enumerable:!1});for(let i=0;i<visitors.length;i++){const visitor=explode$1(visitors[i]),state=states[i];let topVisitor=visitor;(state||wrapper)&&(topVisitor=wrapWithStateOrWrapper(topVisitor,state,wrapper)),mergePair(mergedVisitor,topVisitor);for(const key of Object.keys(visitor)){if(shouldIgnoreKey(key))continue;let typeVisitor=visitor[key];(state||wrapper)&&(typeVisitor=wrapWithStateOrWrapper(typeVisitor,state,wrapper));mergePair(mergedVisitor[key]||(mergedVisitor[key]={}),typeVisitor)}}return mergedVisitor}function wrapWithStateOrWrapper(oldVisitor,state,wrapper){const newVisitor={};for(const phase of["enter","exit"]){let fns=oldVisitor[phase];Array.isArray(fns)&&(fns=fns.map((function(fn){let newFn=fn;return state&&(newFn=function(path){fn.call(state,path,state)}),wrapper&&(newFn=wrapper(null==state?void 0:state.key,phase,newFn)),newFn!==fn&&(newFn.toString=()=>fn.toString()),newFn})),newVisitor[phase]=fns)}return newVisitor}function ensureCallbackArrays(obj){obj.enter&&!Array.isArray(obj.enter)&&(obj.enter=[obj.enter]),obj.exit&&!Array.isArray(obj.exit)&&(obj.exit=[obj.exit])}function wrapCheck(nodeType,fn){const validator=virtualTypesValidators[`is${nodeType}`],newFn=function(path){if(validator.call(path))return fn.apply(this,arguments)};return newFn.toString=()=>fn.toString(),newFn}function shouldIgnoreKey(key){return"_"===key[0]||("enter"===key||"exit"===key||"shouldSkip"===key||("denylist"===key||"noScope"===key||"skipKeys"===key||"blacklist"===key))}function mergePair(dest,src){for(const phase of["enter","exit"])src[phase]&&(dest[phase]=[].concat(dest[phase]||[],src[phase]))}const _environmentVisitor={FunctionParent(path){path.isArrowFunctionExpression()||(path.skip(),path.isMethod()&&(path.requeueComputedKeyAndDecorators?path.requeueComputedKeyAndDecorators():_context.requeueComputedKeyAndDecorators.call(path)))},Property(path){path.isObjectProperty()||(path.skip(),path.requeueComputedKeyAndDecorators?path.requeueComputedKeyAndDecorators():_context.requeueComputedKeyAndDecorators.call(path))}}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/assertNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){if(!(0,_isNode.default)(node)){var _node$type;const type=null!=(_node$type=null==node?void 0:node.type)?_node$type:JSON.stringify(node);throw new TypeError(`Not a valid node of type "${type}"`)}};var _isNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertAccessor=function(node,opts){assert("Accessor",node,opts)},exports.assertAnyTypeAnnotation=function(node,opts){assert("AnyTypeAnnotation",node,opts)},exports.assertArgumentPlaceholder=function(node,opts){assert("ArgumentPlaceholder",node,opts)},exports.assertArrayExpression=function(node,opts){assert("ArrayExpression",node,opts)},exports.assertArrayPattern=function(node,opts){assert("ArrayPattern",node,opts)},exports.assertArrayTypeAnnotation=function(node,opts){assert("ArrayTypeAnnotation",node,opts)},exports.assertArrowFunctionExpression=function(node,opts){assert("ArrowFunctionExpression",node,opts)},exports.assertAssignmentExpression=function(node,opts){assert("AssignmentExpression",node,opts)},exports.assertAssignmentPattern=function(node,opts){assert("AssignmentPattern",node,opts)},exports.assertAwaitExpression=function(node,opts){assert("AwaitExpression",node,opts)},exports.assertBigIntLiteral=function(node,opts){assert("BigIntLiteral",node,opts)},exports.assertBinary=function(node,opts){assert("Binary",node,opts)},exports.assertBinaryExpression=function(node,opts){assert("BinaryExpression",node,opts)},exports.assertBindExpression=function(node,opts){assert("BindExpression",node,opts)},exports.assertBlock=function(node,opts){assert("Block",node,opts)},exports.assertBlockParent=function(node,opts){assert("BlockParent",node,opts)},exports.assertBlockStatement=function(node,opts){assert("BlockStatement",node,opts)},exports.assertBooleanLiteral=function(node,opts){assert("BooleanLiteral",node,opts)},exports.assertBooleanLiteralTypeAnnotation=function(node,opts){assert("BooleanLiteralTypeAnnotation",node,opts)},exports.assertBooleanTypeAnnotation=function(node,opts){assert("BooleanTypeAnnotation",node,opts)},exports.assertBreakStatement=function(node,opts){assert("BreakStatement",node,opts)},exports.assertCallExpression=function(node,opts){assert("CallExpression",node,opts)},exports.assertCatchClause=function(node,opts){assert("CatchClause",node,opts)},exports.assertClass=function(node,opts){assert("Class",node,opts)},exports.assertClassAccessorProperty=function(node,opts){assert("ClassAccessorProperty",node,opts)},exports.assertClassBody=function(node,opts){assert("ClassBody",node,opts)},exports.assertClassDeclaration=function(node,opts){assert("ClassDeclaration",node,opts)},exports.assertClassExpression=function(node,opts){assert("ClassExpression",node,opts)},exports.assertClassImplements=function(node,opts){assert("ClassImplements",node,opts)},exports.assertClassMethod=function(node,opts){assert("ClassMethod",node,opts)},exports.assertClassPrivateMethod=function(node,opts){assert("ClassPrivateMethod",node,opts)},exports.assertClassPrivateProperty=function(node,opts){assert("ClassPrivateProperty",node,opts)},exports.assertClassProperty=function(node,opts){assert("ClassProperty",node,opts)},exports.assertCompletionStatement=function(node,opts){assert("CompletionStatement",node,opts)},exports.assertConditional=function(node,opts){assert("Conditional",node,opts)},exports.assertConditionalExpression=function(node,opts){assert("ConditionalExpression",node,opts)},exports.assertContinueStatement=function(node,opts){assert("ContinueStatement",node,opts)},exports.assertDebuggerStatement=function(node,opts){assert("DebuggerStatement",node,opts)},exports.assertDecimalLiteral=function(node,opts){assert("DecimalLiteral",node,opts)},exports.assertDeclaration=function(node,opts){assert("Declaration",node,opts)},exports.assertDeclareClass=function(node,opts){assert("DeclareClass",node,opts)},exports.assertDeclareExportAllDeclaration=function(node,opts){assert("DeclareExportAllDeclaration",node,opts)},exports.assertDeclareExportDeclaration=function(node,opts){assert("DeclareExportDeclaration",node,opts)},exports.assertDeclareFunction=function(node,opts){assert("DeclareFunction",node,opts)},exports.assertDeclareInterface=function(node,opts){assert("DeclareInterface",node,opts)},exports.assertDeclareModule=function(node,opts){assert("DeclareModule",node,opts)},exports.assertDeclareModuleExports=function(node,opts){assert("DeclareModuleExports",node,opts)},exports.assertDeclareOpaqueType=function(node,opts){assert("DeclareOpaqueType",node,opts)},exports.assertDeclareTypeAlias=function(node,opts){assert("DeclareTypeAlias",node,opts)},exports.assertDeclareVariable=function(node,opts){assert("DeclareVariable",node,opts)},exports.assertDeclaredPredicate=function(node,opts){assert("DeclaredPredicate",node,opts)},exports.assertDecorator=function(node,opts){assert("Decorator",node,opts)},exports.assertDirective=function(node,opts){assert("Directive",node,opts)},exports.assertDirectiveLiteral=function(node,opts){assert("DirectiveLiteral",node,opts)},exports.assertDoExpression=function(node,opts){assert("DoExpression",node,opts)},exports.assertDoWhileStatement=function(node,opts){assert("DoWhileStatement",node,opts)},exports.assertEmptyStatement=function(node,opts){assert("EmptyStatement",node,opts)},exports.assertEmptyTypeAnnotation=function(node,opts){assert("EmptyTypeAnnotation",node,opts)},exports.assertEnumBody=function(node,opts){assert("EnumBody",node,opts)},exports.assertEnumBooleanBody=function(node,opts){assert("EnumBooleanBody",node,opts)},exports.assertEnumBooleanMember=function(node,opts){assert("EnumBooleanMember",node,opts)},exports.assertEnumDeclaration=function(node,opts){assert("EnumDeclaration",node,opts)},exports.assertEnumDefaultedMember=function(node,opts){assert("EnumDefaultedMember",node,opts)},exports.assertEnumMember=function(node,opts){assert("EnumMember",node,opts)},exports.assertEnumNumberBody=function(node,opts){assert("EnumNumberBody",node,opts)},exports.assertEnumNumberMember=function(node,opts){assert("EnumNumberMember",node,opts)},exports.assertEnumStringBody=function(node,opts){assert("EnumStringBody",node,opts)},exports.assertEnumStringMember=function(node,opts){assert("EnumStringMember",node,opts)},exports.assertEnumSymbolBody=function(node,opts){assert("EnumSymbolBody",node,opts)},exports.assertExistsTypeAnnotation=function(node,opts){assert("ExistsTypeAnnotation",node,opts)},exports.assertExportAllDeclaration=function(node,opts){assert("ExportAllDeclaration",node,opts)},exports.assertExportDeclaration=function(node,opts){assert("ExportDeclaration",node,opts)},exports.assertExportDefaultDeclaration=function(node,opts){assert("ExportDefaultDeclaration",node,opts)},exports.assertExportDefaultSpecifier=function(node,opts){assert("ExportDefaultSpecifier",node,opts)},exports.assertExportNamedDeclaration=function(node,opts){assert("ExportNamedDeclaration",node,opts)},exports.assertExportNamespaceSpecifier=function(node,opts){assert("ExportNamespaceSpecifier",node,opts)},exports.assertExportSpecifier=function(node,opts){assert("ExportSpecifier",node,opts)},exports.assertExpression=function(node,opts){assert("Expression",node,opts)},exports.assertExpressionStatement=function(node,opts){assert("ExpressionStatement",node,opts)},exports.assertExpressionWrapper=function(node,opts){assert("ExpressionWrapper",node,opts)},exports.assertFile=function(node,opts){assert("File",node,opts)},exports.assertFlow=function(node,opts){assert("Flow",node,opts)},exports.assertFlowBaseAnnotation=function(node,opts){assert("FlowBaseAnnotation",node,opts)},exports.assertFlowDeclaration=function(node,opts){assert("FlowDeclaration",node,opts)},exports.assertFlowPredicate=function(node,opts){assert("FlowPredicate",node,opts)},exports.assertFlowType=function(node,opts){assert("FlowType",node,opts)},exports.assertFor=function(node,opts){assert("For",node,opts)},exports.assertForInStatement=function(node,opts){assert("ForInStatement",node,opts)},exports.assertForOfStatement=function(node,opts){assert("ForOfStatement",node,opts)},exports.assertForStatement=function(node,opts){assert("ForStatement",node,opts)},exports.assertForXStatement=function(node,opts){assert("ForXStatement",node,opts)},exports.assertFunction=function(node,opts){assert("Function",node,opts)},exports.assertFunctionDeclaration=function(node,opts){assert("FunctionDeclaration",node,opts)},exports.assertFunctionExpression=function(node,opts){assert("FunctionExpression",node,opts)},exports.assertFunctionParent=function(node,opts){assert("FunctionParent",node,opts)},exports.assertFunctionTypeAnnotation=function(node,opts){assert("FunctionTypeAnnotation",node,opts)},exports.assertFunctionTypeParam=function(node,opts){assert("FunctionTypeParam",node,opts)},exports.assertGenericTypeAnnotation=function(node,opts){assert("GenericTypeAnnotation",node,opts)},exports.assertIdentifier=function(node,opts){assert("Identifier",node,opts)},exports.assertIfStatement=function(node,opts){assert("IfStatement",node,opts)},exports.assertImmutable=function(node,opts){assert("Immutable",node,opts)},exports.assertImport=function(node,opts){assert("Import",node,opts)},exports.assertImportAttribute=function(node,opts){assert("ImportAttribute",node,opts)},exports.assertImportDeclaration=function(node,opts){assert("ImportDeclaration",node,opts)},exports.assertImportDefaultSpecifier=function(node,opts){assert("ImportDefaultSpecifier",node,opts)},exports.assertImportExpression=function(node,opts){assert("ImportExpression",node,opts)},exports.assertImportNamespaceSpecifier=function(node,opts){assert("ImportNamespaceSpecifier",node,opts)},exports.assertImportOrExportDeclaration=function(node,opts){assert("ImportOrExportDeclaration",node,opts)},exports.assertImportSpecifier=function(node,opts){assert("ImportSpecifier",node,opts)},exports.assertIndexedAccessType=function(node,opts){assert("IndexedAccessType",node,opts)},exports.assertInferredPredicate=function(node,opts){assert("InferredPredicate",node,opts)},exports.assertInterfaceDeclaration=function(node,opts){assert("InterfaceDeclaration",node,opts)},exports.assertInterfaceExtends=function(node,opts){assert("InterfaceExtends",node,opts)},exports.assertInterfaceTypeAnnotation=function(node,opts){assert("InterfaceTypeAnnotation",node,opts)},exports.assertInterpreterDirective=function(node,opts){assert("InterpreterDirective",node,opts)},exports.assertIntersectionTypeAnnotation=function(node,opts){assert("IntersectionTypeAnnotation",node,opts)},exports.assertJSX=function(node,opts){assert("JSX",node,opts)},exports.assertJSXAttribute=function(node,opts){assert("JSXAttribute",node,opts)},exports.assertJSXClosingElement=function(node,opts){assert("JSXClosingElement",node,opts)},exports.assertJSXClosingFragment=function(node,opts){assert("JSXClosingFragment",node,opts)},exports.assertJSXElement=function(node,opts){assert("JSXElement",node,opts)},exports.assertJSXEmptyExpression=function(node,opts){assert("JSXEmptyExpression",node,opts)},exports.assertJSXExpressionContainer=function(node,opts){assert("JSXExpressionContainer",node,opts)},exports.assertJSXFragment=function(node,opts){assert("JSXFragment",node,opts)},exports.assertJSXIdentifier=function(node,opts){assert("JSXIdentifier",node,opts)},exports.assertJSXMemberExpression=function(node,opts){assert("JSXMemberExpression",node,opts)},exports.assertJSXNamespacedName=function(node,opts){assert("JSXNamespacedName",node,opts)},exports.assertJSXOpeningElement=function(node,opts){assert("JSXOpeningElement",node,opts)},exports.assertJSXOpeningFragment=function(node,opts){assert("JSXOpeningFragment",node,opts)},exports.assertJSXSpreadAttribute=function(node,opts){assert("JSXSpreadAttribute",node,opts)},exports.assertJSXSpreadChild=function(node,opts){assert("JSXSpreadChild",node,opts)},exports.assertJSXText=function(node,opts){assert("JSXText",node,opts)},exports.assertLVal=function(node,opts){assert("LVal",node,opts)},exports.assertLabeledStatement=function(node,opts){assert("LabeledStatement",node,opts)},exports.assertLiteral=function(node,opts){assert("Literal",node,opts)},exports.assertLogicalExpression=function(node,opts){assert("LogicalExpression",node,opts)},exports.assertLoop=function(node,opts){assert("Loop",node,opts)},exports.assertMemberExpression=function(node,opts){assert("MemberExpression",node,opts)},exports.assertMetaProperty=function(node,opts){assert("MetaProperty",node,opts)},exports.assertMethod=function(node,opts){assert("Method",node,opts)},exports.assertMiscellaneous=function(node,opts){assert("Miscellaneous",node,opts)},exports.assertMixedTypeAnnotation=function(node,opts){assert("MixedTypeAnnotation",node,opts)},exports.assertModuleDeclaration=function(node,opts){(0,_deprecationWarning.default)("assertModuleDeclaration","assertImportOrExportDeclaration"),assert("ModuleDeclaration",node,opts)},exports.assertModuleExpression=function(node,opts){assert("ModuleExpression",node,opts)},exports.assertModuleSpecifier=function(node,opts){assert("ModuleSpecifier",node,opts)},exports.assertNewExpression=function(node,opts){assert("NewExpression",node,opts)},exports.assertNoop=function(node,opts){assert("Noop",node,opts)},exports.assertNullLiteral=function(node,opts){assert("NullLiteral",node,opts)},exports.assertNullLiteralTypeAnnotation=function(node,opts){assert("NullLiteralTypeAnnotation",node,opts)},exports.assertNullableTypeAnnotation=function(node,opts){assert("NullableTypeAnnotation",node,opts)},exports.assertNumberLiteral=function(node,opts){(0,_deprecationWarning.default)("assertNumberLiteral","assertNumericLiteral"),assert("NumberLiteral",node,opts)},exports.assertNumberLiteralTypeAnnotation=function(node,opts){assert("NumberLiteralTypeAnnotation",node,opts)},exports.assertNumberTypeAnnotation=function(node,opts){assert("NumberTypeAnnotation",node,opts)},exports.assertNumericLiteral=function(node,opts){assert("NumericLiteral",node,opts)},exports.assertObjectExpression=function(node,opts){assert("ObjectExpression",node,opts)},exports.assertObjectMember=function(node,opts){assert("ObjectMember",node,opts)},exports.assertObjectMethod=function(node,opts){assert("ObjectMethod",node,opts)},exports.assertObjectPattern=function(node,opts){assert("ObjectPattern",node,opts)},exports.assertObjectProperty=function(node,opts){assert("ObjectProperty",node,opts)},exports.assertObjectTypeAnnotation=function(node,opts){assert("ObjectTypeAnnotation",node,opts)},exports.assertObjectTypeCallProperty=function(node,opts){assert("ObjectTypeCallProperty",node,opts)},exports.assertObjectTypeIndexer=function(node,opts){assert("ObjectTypeIndexer",node,opts)},exports.assertObjectTypeInternalSlot=function(node,opts){assert("ObjectTypeInternalSlot",node,opts)},exports.assertObjectTypeProperty=function(node,opts){assert("ObjectTypeProperty",node,opts)},exports.assertObjectTypeSpreadProperty=function(node,opts){assert("ObjectTypeSpreadProperty",node,opts)},exports.assertOpaqueType=function(node,opts){assert("OpaqueType",node,opts)},exports.assertOptionalCallExpression=function(node,opts){assert("OptionalCallExpression",node,opts)},exports.assertOptionalIndexedAccessType=function(node,opts){assert("OptionalIndexedAccessType",node,opts)},exports.assertOptionalMemberExpression=function(node,opts){assert("OptionalMemberExpression",node,opts)},exports.assertParenthesizedExpression=function(node,opts){assert("ParenthesizedExpression",node,opts)},exports.assertPattern=function(node,opts){assert("Pattern",node,opts)},exports.assertPatternLike=function(node,opts){assert("PatternLike",node,opts)},exports.assertPipelineBareFunction=function(node,opts){assert("PipelineBareFunction",node,opts)},exports.assertPipelinePrimaryTopicReference=function(node,opts){assert("PipelinePrimaryTopicReference",node,opts)},exports.assertPipelineTopicExpression=function(node,opts){assert("PipelineTopicExpression",node,opts)},exports.assertPlaceholder=function(node,opts){assert("Placeholder",node,opts)},exports.assertPrivate=function(node,opts){assert("Private",node,opts)},exports.assertPrivateName=function(node,opts){assert("PrivateName",node,opts)},exports.assertProgram=function(node,opts){assert("Program",node,opts)},exports.assertProperty=function(node,opts){assert("Property",node,opts)},exports.assertPureish=function(node,opts){assert("Pureish",node,opts)},exports.assertQualifiedTypeIdentifier=function(node,opts){assert("QualifiedTypeIdentifier",node,opts)},exports.assertRecordExpression=function(node,opts){assert("RecordExpression",node,opts)},exports.assertRegExpLiteral=function(node,opts){assert("RegExpLiteral",node,opts)},exports.assertRegexLiteral=function(node,opts){(0,_deprecationWarning.default)("assertRegexLiteral","assertRegExpLiteral"),assert("RegexLiteral",node,opts)},exports.assertRestElement=function(node,opts){assert("RestElement",node,opts)},exports.assertRestProperty=function(node,opts){(0,_deprecationWarning.default)("assertRestProperty","assertRestElement"),assert("RestProperty",node,opts)},exports.assertReturnStatement=function(node,opts){assert("ReturnStatement",node,opts)},exports.assertScopable=function(node,opts){assert("Scopable",node,opts)},exports.assertSequenceExpression=function(node,opts){assert("SequenceExpression",node,opts)},exports.assertSpreadElement=function(node,opts){assert("SpreadElement",node,opts)},exports.assertSpreadProperty=function(node,opts){(0,_deprecationWarning.default)("assertSpreadProperty","assertSpreadElement"),assert("SpreadProperty",node,opts)},exports.assertStandardized=function(node,opts){assert("Standardized",node,opts)},exports.assertStatement=function(node,opts){assert("Statement",node,opts)},exports.assertStaticBlock=function(node,opts){assert("StaticBlock",node,opts)},exports.assertStringLiteral=function(node,opts){assert("StringLiteral",node,opts)},exports.assertStringLiteralTypeAnnotation=function(node,opts){assert("StringLiteralTypeAnnotation",node,opts)},exports.assertStringTypeAnnotation=function(node,opts){assert("StringTypeAnnotation",node,opts)},exports.assertSuper=function(node,opts){assert("Super",node,opts)},exports.assertSwitchCase=function(node,opts){assert("SwitchCase",node,opts)},exports.assertSwitchStatement=function(node,opts){assert("SwitchStatement",node,opts)},exports.assertSymbolTypeAnnotation=function(node,opts){assert("SymbolTypeAnnotation",node,opts)},exports.assertTSAnyKeyword=function(node,opts){assert("TSAnyKeyword",node,opts)},exports.assertTSArrayType=function(node,opts){assert("TSArrayType",node,opts)},exports.assertTSAsExpression=function(node,opts){assert("TSAsExpression",node,opts)},exports.assertTSBaseType=function(node,opts){assert("TSBaseType",node,opts)},exports.assertTSBigIntKeyword=function(node,opts){assert("TSBigIntKeyword",node,opts)},exports.assertTSBooleanKeyword=function(node,opts){assert("TSBooleanKeyword",node,opts)},exports.assertTSCallSignatureDeclaration=function(node,opts){assert("TSCallSignatureDeclaration",node,opts)},exports.assertTSConditionalType=function(node,opts){assert("TSConditionalType",node,opts)},exports.assertTSConstructSignatureDeclaration=function(node,opts){assert("TSConstructSignatureDeclaration",node,opts)},exports.assertTSConstructorType=function(node,opts){assert("TSConstructorType",node,opts)},exports.assertTSDeclareFunction=function(node,opts){assert("TSDeclareFunction",node,opts)},exports.assertTSDeclareMethod=function(node,opts){assert("TSDeclareMethod",node,opts)},exports.assertTSEntityName=function(node,opts){assert("TSEntityName",node,opts)},exports.assertTSEnumDeclaration=function(node,opts){assert("TSEnumDeclaration",node,opts)},exports.assertTSEnumMember=function(node,opts){assert("TSEnumMember",node,opts)},exports.assertTSExportAssignment=function(node,opts){assert("TSExportAssignment",node,opts)},exports.assertTSExpressionWithTypeArguments=function(node,opts){assert("TSExpressionWithTypeArguments",node,opts)},exports.assertTSExternalModuleReference=function(node,opts){assert("TSExternalModuleReference",node,opts)},exports.assertTSFunctionType=function(node,opts){assert("TSFunctionType",node,opts)},exports.assertTSImportEqualsDeclaration=function(node,opts){assert("TSImportEqualsDeclaration",node,opts)},exports.assertTSImportType=function(node,opts){assert("TSImportType",node,opts)},exports.assertTSIndexSignature=function(node,opts){assert("TSIndexSignature",node,opts)},exports.assertTSIndexedAccessType=function(node,opts){assert("TSIndexedAccessType",node,opts)},exports.assertTSInferType=function(node,opts){assert("TSInferType",node,opts)},exports.assertTSInstantiationExpression=function(node,opts){assert("TSInstantiationExpression",node,opts)},exports.assertTSInterfaceBody=function(node,opts){assert("TSInterfaceBody",node,opts)},exports.assertTSInterfaceDeclaration=function(node,opts){assert("TSInterfaceDeclaration",node,opts)},exports.assertTSIntersectionType=function(node,opts){assert("TSIntersectionType",node,opts)},exports.assertTSIntrinsicKeyword=function(node,opts){assert("TSIntrinsicKeyword",node,opts)},exports.assertTSLiteralType=function(node,opts){assert("TSLiteralType",node,opts)},exports.assertTSMappedType=function(node,opts){assert("TSMappedType",node,opts)},exports.assertTSMethodSignature=function(node,opts){assert("TSMethodSignature",node,opts)},exports.assertTSModuleBlock=function(node,opts){assert("TSModuleBlock",node,opts)},exports.assertTSModuleDeclaration=function(node,opts){assert("TSModuleDeclaration",node,opts)},exports.assertTSNamedTupleMember=function(node,opts){assert("TSNamedTupleMember",node,opts)},exports.assertTSNamespaceExportDeclaration=function(node,opts){assert("TSNamespaceExportDeclaration",node,opts)},exports.assertTSNeverKeyword=function(node,opts){assert("TSNeverKeyword",node,opts)},exports.assertTSNonNullExpression=function(node,opts){assert("TSNonNullExpression",node,opts)},exports.assertTSNullKeyword=function(node,opts){assert("TSNullKeyword",node,opts)},exports.assertTSNumberKeyword=function(node,opts){assert("TSNumberKeyword",node,opts)},exports.assertTSObjectKeyword=function(node,opts){assert("TSObjectKeyword",node,opts)},exports.assertTSOptionalType=function(node,opts){assert("TSOptionalType",node,opts)},exports.assertTSParameterProperty=function(node,opts){assert("TSParameterProperty",node,opts)},exports.assertTSParenthesizedType=function(node,opts){assert("TSParenthesizedType",node,opts)},exports.assertTSPropertySignature=function(node,opts){assert("TSPropertySignature",node,opts)},exports.assertTSQualifiedName=function(node,opts){assert("TSQualifiedName",node,opts)},exports.assertTSRestType=function(node,opts){assert("TSRestType",node,opts)},exports.assertTSSatisfiesExpression=function(node,opts){assert("TSSatisfiesExpression",node,opts)},exports.assertTSStringKeyword=function(node,opts){assert("TSStringKeyword",node,opts)},exports.assertTSSymbolKeyword=function(node,opts){assert("TSSymbolKeyword",node,opts)},exports.assertTSThisType=function(node,opts){assert("TSThisType",node,opts)},exports.assertTSTupleType=function(node,opts){assert("TSTupleType",node,opts)},exports.assertTSType=function(node,opts){assert("TSType",node,opts)},exports.assertTSTypeAliasDeclaration=function(node,opts){assert("TSTypeAliasDeclaration",node,opts)},exports.assertTSTypeAnnotation=function(node,opts){assert("TSTypeAnnotation",node,opts)},exports.assertTSTypeAssertion=function(node,opts){assert("TSTypeAssertion",node,opts)},exports.assertTSTypeElement=function(node,opts){assert("TSTypeElement",node,opts)},exports.assertTSTypeLiteral=function(node,opts){assert("TSTypeLiteral",node,opts)},exports.assertTSTypeOperator=function(node,opts){assert("TSTypeOperator",node,opts)},exports.assertTSTypeParameter=function(node,opts){assert("TSTypeParameter",node,opts)},exports.assertTSTypeParameterDeclaration=function(node,opts){assert("TSTypeParameterDeclaration",node,opts)},exports.assertTSTypeParameterInstantiation=function(node,opts){assert("TSTypeParameterInstantiation",node,opts)},exports.assertTSTypePredicate=function(node,opts){assert("TSTypePredicate",node,opts)},exports.assertTSTypeQuery=function(node,opts){assert("TSTypeQuery",node,opts)},exports.assertTSTypeReference=function(node,opts){assert("TSTypeReference",node,opts)},exports.assertTSUndefinedKeyword=function(node,opts){assert("TSUndefinedKeyword",node,opts)},exports.assertTSUnionType=function(node,opts){assert("TSUnionType",node,opts)},exports.assertTSUnknownKeyword=function(node,opts){assert("TSUnknownKeyword",node,opts)},exports.assertTSVoidKeyword=function(node,opts){assert("TSVoidKeyword",node,opts)},exports.assertTaggedTemplateExpression=function(node,opts){assert("TaggedTemplateExpression",node,opts)},exports.assertTemplateElement=function(node,opts){assert("TemplateElement",node,opts)},exports.assertTemplateLiteral=function(node,opts){assert("TemplateLiteral",node,opts)},exports.assertTerminatorless=function(node,opts){assert("Terminatorless",node,opts)},exports.assertThisExpression=function(node,opts){assert("ThisExpression",node,opts)},exports.assertThisTypeAnnotation=function(node,opts){assert("ThisTypeAnnotation",node,opts)},exports.assertThrowStatement=function(node,opts){assert("ThrowStatement",node,opts)},exports.assertTopicReference=function(node,opts){assert("TopicReference",node,opts)},exports.assertTryStatement=function(node,opts){assert("TryStatement",node,opts)},exports.assertTupleExpression=function(node,opts){assert("TupleExpression",node,opts)},exports.assertTupleTypeAnnotation=function(node,opts){assert("TupleTypeAnnotation",node,opts)},exports.assertTypeAlias=function(node,opts){assert("TypeAlias",node,opts)},exports.assertTypeAnnotation=function(node,opts){assert("TypeAnnotation",node,opts)},exports.assertTypeCastExpression=function(node,opts){assert("TypeCastExpression",node,opts)},exports.assertTypeParameter=function(node,opts){assert("TypeParameter",node,opts)},exports.assertTypeParameterDeclaration=function(node,opts){assert("TypeParameterDeclaration",node,opts)},exports.assertTypeParameterInstantiation=function(node,opts){assert("TypeParameterInstantiation",node,opts)},exports.assertTypeScript=function(node,opts){assert("TypeScript",node,opts)},exports.assertTypeofTypeAnnotation=function(node,opts){assert("TypeofTypeAnnotation",node,opts)},exports.assertUnaryExpression=function(node,opts){assert("UnaryExpression",node,opts)},exports.assertUnaryLike=function(node,opts){assert("UnaryLike",node,opts)},exports.assertUnionTypeAnnotation=function(node,opts){assert("UnionTypeAnnotation",node,opts)},exports.assertUpdateExpression=function(node,opts){assert("UpdateExpression",node,opts)},exports.assertUserWhitespacable=function(node,opts){assert("UserWhitespacable",node,opts)},exports.assertV8IntrinsicIdentifier=function(node,opts){assert("V8IntrinsicIdentifier",node,opts)},exports.assertVariableDeclaration=function(node,opts){assert("VariableDeclaration",node,opts)},exports.assertVariableDeclarator=function(node,opts){assert("VariableDeclarator",node,opts)},exports.assertVariance=function(node,opts){assert("Variance",node,opts)},exports.assertVoidTypeAnnotation=function(node,opts){assert("VoidTypeAnnotation",node,opts)},exports.assertWhile=function(node,opts){assert("While",node,opts)},exports.assertWhileStatement=function(node,opts){assert("WhileStatement",node,opts)},exports.assertWithStatement=function(node,opts){assert("WithStatement",node,opts)},exports.assertYieldExpression=function(node,opts){assert("YieldExpression",node,opts)};var _is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js");function assert(type,node,opts){if(!(0,_is.default)(type,node,opts))throw new Error(`Expected type "${type}" with option ${JSON.stringify(opts)}, but instead got "${node.type}".`)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createFlowUnionType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(types){const flattened=(0,_removeTypeDuplicates.default)(types);return 1===flattened.length?flattened[0]:(0,_index.unionTypeAnnotation)(flattened)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_removeTypeDuplicates=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/flow/removeTypeDuplicates.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createTypeAnnotationBasedOnTypeof.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");exports.default=function(type){switch(type){case"string":return(0,_index.stringTypeAnnotation)();case"number":return(0,_index.numberTypeAnnotation)();case"undefined":return(0,_index.voidTypeAnnotation)();case"boolean":return(0,_index.booleanTypeAnnotation)();case"function":return(0,_index.genericTypeAnnotation)((0,_index.identifier)("Function"));case"object":return(0,_index.genericTypeAnnotation)((0,_index.identifier)("Object"));case"symbol":return(0,_index.genericTypeAnnotation)((0,_index.identifier)("Symbol"));case"bigint":return(0,_index.anyTypeAnnotation)()}throw new Error("Invalid typeof value: "+type)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.anyTypeAnnotation=function(){return{type:"AnyTypeAnnotation"}},exports.argumentPlaceholder=function(){return{type:"ArgumentPlaceholder"}},exports.arrayExpression=function(elements=[]){const node={type:"ArrayExpression",elements},defs=NODE_FIELDS.ArrayExpression;return validate(defs.elements,node,"elements",elements,1),node},exports.arrayPattern=function(elements){const node={type:"ArrayPattern",elements},defs=NODE_FIELDS.ArrayPattern;return validate(defs.elements,node,"elements",elements,1),node},exports.arrayTypeAnnotation=function(elementType){const node={type:"ArrayTypeAnnotation",elementType},defs=NODE_FIELDS.ArrayTypeAnnotation;return validate(defs.elementType,node,"elementType",elementType,1),node},exports.arrowFunctionExpression=function(params,body,async=!1){const node={type:"ArrowFunctionExpression",params,body,async,expression:null},defs=NODE_FIELDS.ArrowFunctionExpression;return validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.async,node,"async",async),node},exports.assignmentExpression=function(operator,left,right){const node={type:"AssignmentExpression",operator,left,right},defs=NODE_FIELDS.AssignmentExpression;return validate(defs.operator,node,"operator",operator),validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.assignmentPattern=function(left,right){const node={type:"AssignmentPattern",left,right},defs=NODE_FIELDS.AssignmentPattern;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.awaitExpression=function(argument){const node={type:"AwaitExpression",argument},defs=NODE_FIELDS.AwaitExpression;return validate(defs.argument,node,"argument",argument,1),node},exports.bigIntLiteral=function(value){const node={type:"BigIntLiteral",value},defs=NODE_FIELDS.BigIntLiteral;return validate(defs.value,node,"value",value),node},exports.binaryExpression=function(operator,left,right){const node={type:"BinaryExpression",operator,left,right},defs=NODE_FIELDS.BinaryExpression;return validate(defs.operator,node,"operator",operator),validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.bindExpression=function(object,callee){const node={type:"BindExpression",object,callee},defs=NODE_FIELDS.BindExpression;return validate(defs.object,node,"object",object,1),validate(defs.callee,node,"callee",callee,1),node},exports.blockStatement=function(body,directives=[]){const node={type:"BlockStatement",body,directives},defs=NODE_FIELDS.BlockStatement;return validate(defs.body,node,"body",body,1),validate(defs.directives,node,"directives",directives,1),node},exports.booleanLiteral=function(value){const node={type:"BooleanLiteral",value},defs=NODE_FIELDS.BooleanLiteral;return validate(defs.value,node,"value",value),node},exports.booleanLiteralTypeAnnotation=function(value){const node={type:"BooleanLiteralTypeAnnotation",value},defs=NODE_FIELDS.BooleanLiteralTypeAnnotation;return validate(defs.value,node,"value",value),node},exports.booleanTypeAnnotation=function(){return{type:"BooleanTypeAnnotation"}},exports.breakStatement=function(label=null){const node={type:"BreakStatement",label},defs=NODE_FIELDS.BreakStatement;return validate(defs.label,node,"label",label,1),node},exports.callExpression=function(callee,_arguments){const node={type:"CallExpression",callee,arguments:_arguments},defs=NODE_FIELDS.CallExpression;return validate(defs.callee,node,"callee",callee,1),validate(defs.arguments,node,"arguments",_arguments,1),node},exports.catchClause=function(param=null,body){const node={type:"CatchClause",param,body},defs=NODE_FIELDS.CatchClause;return validate(defs.param,node,"param",param,1),validate(defs.body,node,"body",body,1),node},exports.classAccessorProperty=function(key,value=null,typeAnnotation=null,decorators=null,computed=!1,_static=!1){const node={type:"ClassAccessorProperty",key,value,typeAnnotation,decorators,computed,static:_static},defs=NODE_FIELDS.ClassAccessorProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.decorators,node,"decorators",decorators,1),validate(defs.computed,node,"computed",computed),validate(defs.static,node,"static",_static),node},exports.classBody=function(body){const node={type:"ClassBody",body},defs=NODE_FIELDS.ClassBody;return validate(defs.body,node,"body",body,1),node},exports.classDeclaration=function(id=null,superClass=null,body,decorators=null){const node={type:"ClassDeclaration",id,superClass,body,decorators},defs=NODE_FIELDS.ClassDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.superClass,node,"superClass",superClass,1),validate(defs.body,node,"body",body,1),validate(defs.decorators,node,"decorators",decorators,1),node},exports.classExpression=function(id=null,superClass=null,body,decorators=null){const node={type:"ClassExpression",id,superClass,body,decorators},defs=NODE_FIELDS.ClassExpression;return validate(defs.id,node,"id",id,1),validate(defs.superClass,node,"superClass",superClass,1),validate(defs.body,node,"body",body,1),validate(defs.decorators,node,"decorators",decorators,1),node},exports.classImplements=function(id,typeParameters=null){const node={type:"ClassImplements",id,typeParameters},defs=NODE_FIELDS.ClassImplements;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.classMethod=function(kind="method",key,params,body,computed=!1,_static=!1,generator=!1,async=!1){const node={type:"ClassMethod",kind,key,params,body,computed,static:_static,generator,async},defs=NODE_FIELDS.ClassMethod;return validate(defs.kind,node,"kind",kind),validate(defs.key,node,"key",key,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.computed,node,"computed",computed),validate(defs.static,node,"static",_static),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.classPrivateMethod=function(kind="method",key,params,body,_static=!1){const node={type:"ClassPrivateMethod",kind,key,params,body,static:_static},defs=NODE_FIELDS.ClassPrivateMethod;return validate(defs.kind,node,"kind",kind),validate(defs.key,node,"key",key,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.static,node,"static",_static),node},exports.classPrivateProperty=function(key,value=null,decorators=null,_static=!1){const node={type:"ClassPrivateProperty",key,value,decorators,static:_static},defs=NODE_FIELDS.ClassPrivateProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.decorators,node,"decorators",decorators,1),validate(defs.static,node,"static",_static),node},exports.classProperty=function(key,value=null,typeAnnotation=null,decorators=null,computed=!1,_static=!1){const node={type:"ClassProperty",key,value,typeAnnotation,decorators,computed,static:_static},defs=NODE_FIELDS.ClassProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.decorators,node,"decorators",decorators,1),validate(defs.computed,node,"computed",computed),validate(defs.static,node,"static",_static),node},exports.conditionalExpression=function(test,consequent,alternate){const node={type:"ConditionalExpression",test,consequent,alternate},defs=NODE_FIELDS.ConditionalExpression;return validate(defs.test,node,"test",test,1),validate(defs.consequent,node,"consequent",consequent,1),validate(defs.alternate,node,"alternate",alternate,1),node},exports.continueStatement=function(label=null){const node={type:"ContinueStatement",label},defs=NODE_FIELDS.ContinueStatement;return validate(defs.label,node,"label",label,1),node},exports.debuggerStatement=function(){return{type:"DebuggerStatement"}},exports.decimalLiteral=function(value){const node={type:"DecimalLiteral",value},defs=NODE_FIELDS.DecimalLiteral;return validate(defs.value,node,"value",value),node},exports.declareClass=function(id,typeParameters=null,_extends=null,body){const node={type:"DeclareClass",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.DeclareClass;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.declareExportAllDeclaration=function(source,attributes=null){const node={type:"DeclareExportAllDeclaration",source,attributes},defs=NODE_FIELDS.DeclareExportAllDeclaration;return validate(defs.source,node,"source",source,1),validate(defs.attributes,node,"attributes",attributes,1),node},exports.declareExportDeclaration=function(declaration=null,specifiers=null,source=null,attributes=null){const node={type:"DeclareExportDeclaration",declaration,specifiers,source,attributes},defs=NODE_FIELDS.DeclareExportDeclaration;return validate(defs.declaration,node,"declaration",declaration,1),validate(defs.specifiers,node,"specifiers",specifiers,1),validate(defs.source,node,"source",source,1),validate(defs.attributes,node,"attributes",attributes,1),node},exports.declareFunction=function(id){const node={type:"DeclareFunction",id},defs=NODE_FIELDS.DeclareFunction;return validate(defs.id,node,"id",id,1),node},exports.declareInterface=function(id,typeParameters=null,_extends=null,body){const node={type:"DeclareInterface",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.DeclareInterface;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.declareModule=function(id,body,kind=null){const node={type:"DeclareModule",id,body,kind},defs=NODE_FIELDS.DeclareModule;return validate(defs.id,node,"id",id,1),validate(defs.body,node,"body",body,1),validate(defs.kind,node,"kind",kind),node},exports.declareModuleExports=function(typeAnnotation){const node={type:"DeclareModuleExports",typeAnnotation},defs=NODE_FIELDS.DeclareModuleExports;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.declareOpaqueType=function(id,typeParameters=null,supertype=null){const node={type:"DeclareOpaqueType",id,typeParameters,supertype},defs=NODE_FIELDS.DeclareOpaqueType;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.supertype,node,"supertype",supertype,1),node},exports.declareTypeAlias=function(id,typeParameters=null,right){const node={type:"DeclareTypeAlias",id,typeParameters,right},defs=NODE_FIELDS.DeclareTypeAlias;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.right,node,"right",right,1),node},exports.declareVariable=function(id){const node={type:"DeclareVariable",id},defs=NODE_FIELDS.DeclareVariable;return validate(defs.id,node,"id",id,1),node},exports.declaredPredicate=function(value){const node={type:"DeclaredPredicate",value},defs=NODE_FIELDS.DeclaredPredicate;return validate(defs.value,node,"value",value,1),node},exports.decorator=function(expression){const node={type:"Decorator",expression},defs=NODE_FIELDS.Decorator;return validate(defs.expression,node,"expression",expression,1),node},exports.directive=function(value){const node={type:"Directive",value},defs=NODE_FIELDS.Directive;return validate(defs.value,node,"value",value,1),node},exports.directiveLiteral=function(value){const node={type:"DirectiveLiteral",value},defs=NODE_FIELDS.DirectiveLiteral;return validate(defs.value,node,"value",value),node},exports.doExpression=function(body,async=!1){const node={type:"DoExpression",body,async},defs=NODE_FIELDS.DoExpression;return validate(defs.body,node,"body",body,1),validate(defs.async,node,"async",async),node},exports.doWhileStatement=function(test,body){const node={type:"DoWhileStatement",test,body},defs=NODE_FIELDS.DoWhileStatement;return validate(defs.test,node,"test",test,1),validate(defs.body,node,"body",body,1),node},exports.emptyStatement=function(){return{type:"EmptyStatement"}},exports.emptyTypeAnnotation=function(){return{type:"EmptyTypeAnnotation"}},exports.enumBooleanBody=function(members){const node={type:"EnumBooleanBody",members,explicitType:null,hasUnknownMembers:null},defs=NODE_FIELDS.EnumBooleanBody;return validate(defs.members,node,"members",members,1),node},exports.enumBooleanMember=function(id){const node={type:"EnumBooleanMember",id,init:null},defs=NODE_FIELDS.EnumBooleanMember;return validate(defs.id,node,"id",id,1),node},exports.enumDeclaration=function(id,body){const node={type:"EnumDeclaration",id,body},defs=NODE_FIELDS.EnumDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.body,node,"body",body,1),node},exports.enumDefaultedMember=function(id){const node={type:"EnumDefaultedMember",id},defs=NODE_FIELDS.EnumDefaultedMember;return validate(defs.id,node,"id",id,1),node},exports.enumNumberBody=function(members){const node={type:"EnumNumberBody",members,explicitType:null,hasUnknownMembers:null},defs=NODE_FIELDS.EnumNumberBody;return validate(defs.members,node,"members",members,1),node},exports.enumNumberMember=function(id,init){const node={type:"EnumNumberMember",id,init},defs=NODE_FIELDS.EnumNumberMember;return validate(defs.id,node,"id",id,1),validate(defs.init,node,"init",init,1),node},exports.enumStringBody=function(members){const node={type:"EnumStringBody",members,explicitType:null,hasUnknownMembers:null},defs=NODE_FIELDS.EnumStringBody;return validate(defs.members,node,"members",members,1),node},exports.enumStringMember=function(id,init){const node={type:"EnumStringMember",id,init},defs=NODE_FIELDS.EnumStringMember;return validate(defs.id,node,"id",id,1),validate(defs.init,node,"init",init,1),node},exports.enumSymbolBody=function(members){const node={type:"EnumSymbolBody",members,hasUnknownMembers:null},defs=NODE_FIELDS.EnumSymbolBody;return validate(defs.members,node,"members",members,1),node},exports.existsTypeAnnotation=function(){return{type:"ExistsTypeAnnotation"}},exports.exportAllDeclaration=function(source){const node={type:"ExportAllDeclaration",source},defs=NODE_FIELDS.ExportAllDeclaration;return validate(defs.source,node,"source",source,1),node},exports.exportDefaultDeclaration=function(declaration){const node={type:"ExportDefaultDeclaration",declaration},defs=NODE_FIELDS.ExportDefaultDeclaration;return validate(defs.declaration,node,"declaration",declaration,1),node},exports.exportDefaultSpecifier=function(exported){const node={type:"ExportDefaultSpecifier",exported},defs=NODE_FIELDS.ExportDefaultSpecifier;return validate(defs.exported,node,"exported",exported,1),node},exports.exportNamedDeclaration=function(declaration=null,specifiers=[],source=null){const node={type:"ExportNamedDeclaration",declaration,specifiers,source},defs=NODE_FIELDS.ExportNamedDeclaration;return validate(defs.declaration,node,"declaration",declaration,1),validate(defs.specifiers,node,"specifiers",specifiers,1),validate(defs.source,node,"source",source,1),node},exports.exportNamespaceSpecifier=function(exported){const node={type:"ExportNamespaceSpecifier",exported},defs=NODE_FIELDS.ExportNamespaceSpecifier;return validate(defs.exported,node,"exported",exported,1),node},exports.exportSpecifier=function(local,exported){const node={type:"ExportSpecifier",local,exported},defs=NODE_FIELDS.ExportSpecifier;return validate(defs.local,node,"local",local,1),validate(defs.exported,node,"exported",exported,1),node},exports.expressionStatement=function(expression){const node={type:"ExpressionStatement",expression},defs=NODE_FIELDS.ExpressionStatement;return validate(defs.expression,node,"expression",expression,1),node},exports.file=function(program,comments=null,tokens=null){const node={type:"File",program,comments,tokens},defs=NODE_FIELDS.File;return validate(defs.program,node,"program",program,1),validate(defs.comments,node,"comments",comments,1),validate(defs.tokens,node,"tokens",tokens),node},exports.forInStatement=function(left,right,body){const node={type:"ForInStatement",left,right,body},defs=NODE_FIELDS.ForInStatement;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),validate(defs.body,node,"body",body,1),node},exports.forOfStatement=function(left,right,body,_await=!1){const node={type:"ForOfStatement",left,right,body,await:_await},defs=NODE_FIELDS.ForOfStatement;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),validate(defs.body,node,"body",body,1),validate(defs.await,node,"await",_await),node},exports.forStatement=function(init=null,test=null,update=null,body){const node={type:"ForStatement",init,test,update,body},defs=NODE_FIELDS.ForStatement;return validate(defs.init,node,"init",init,1),validate(defs.test,node,"test",test,1),validate(defs.update,node,"update",update,1),validate(defs.body,node,"body",body,1),node},exports.functionDeclaration=function(id=null,params,body,generator=!1,async=!1){const node={type:"FunctionDeclaration",id,params,body,generator,async},defs=NODE_FIELDS.FunctionDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.functionExpression=function(id=null,params,body,generator=!1,async=!1){const node={type:"FunctionExpression",id,params,body,generator,async},defs=NODE_FIELDS.FunctionExpression;return validate(defs.id,node,"id",id,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.functionTypeAnnotation=function(typeParameters=null,params,rest=null,returnType){const node={type:"FunctionTypeAnnotation",typeParameters,params,rest,returnType},defs=NODE_FIELDS.FunctionTypeAnnotation;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.params,node,"params",params,1),validate(defs.rest,node,"rest",rest,1),validate(defs.returnType,node,"returnType",returnType,1),node},exports.functionTypeParam=function(name=null,typeAnnotation){const node={type:"FunctionTypeParam",name,typeAnnotation},defs=NODE_FIELDS.FunctionTypeParam;return validate(defs.name,node,"name",name,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.genericTypeAnnotation=function(id,typeParameters=null){const node={type:"GenericTypeAnnotation",id,typeParameters},defs=NODE_FIELDS.GenericTypeAnnotation;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.identifier=function(name){const node={type:"Identifier",name},defs=NODE_FIELDS.Identifier;return validate(defs.name,node,"name",name),node},exports.ifStatement=function(test,consequent,alternate=null){const node={type:"IfStatement",test,consequent,alternate},defs=NODE_FIELDS.IfStatement;return validate(defs.test,node,"test",test,1),validate(defs.consequent,node,"consequent",consequent,1),validate(defs.alternate,node,"alternate",alternate,1),node},exports.import=function(){return{type:"Import"}},exports.importAttribute=function(key,value){const node={type:"ImportAttribute",key,value},defs=NODE_FIELDS.ImportAttribute;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),node},exports.importDeclaration=function(specifiers,source){const node={type:"ImportDeclaration",specifiers,source},defs=NODE_FIELDS.ImportDeclaration;return validate(defs.specifiers,node,"specifiers",specifiers,1),validate(defs.source,node,"source",source,1),node},exports.importDefaultSpecifier=function(local){const node={type:"ImportDefaultSpecifier",local},defs=NODE_FIELDS.ImportDefaultSpecifier;return validate(defs.local,node,"local",local,1),node},exports.importExpression=function(source,options=null){const node={type:"ImportExpression",source,options},defs=NODE_FIELDS.ImportExpression;return validate(defs.source,node,"source",source,1),validate(defs.options,node,"options",options,1),node},exports.importNamespaceSpecifier=function(local){const node={type:"ImportNamespaceSpecifier",local},defs=NODE_FIELDS.ImportNamespaceSpecifier;return validate(defs.local,node,"local",local,1),node},exports.importSpecifier=function(local,imported){const node={type:"ImportSpecifier",local,imported},defs=NODE_FIELDS.ImportSpecifier;return validate(defs.local,node,"local",local,1),validate(defs.imported,node,"imported",imported,1),node},exports.indexedAccessType=function(objectType,indexType){const node={type:"IndexedAccessType",objectType,indexType},defs=NODE_FIELDS.IndexedAccessType;return validate(defs.objectType,node,"objectType",objectType,1),validate(defs.indexType,node,"indexType",indexType,1),node},exports.inferredPredicate=function(){return{type:"InferredPredicate"}},exports.interfaceDeclaration=function(id,typeParameters=null,_extends=null,body){const node={type:"InterfaceDeclaration",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.InterfaceDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.interfaceExtends=function(id,typeParameters=null){const node={type:"InterfaceExtends",id,typeParameters},defs=NODE_FIELDS.InterfaceExtends;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.interfaceTypeAnnotation=function(_extends=null,body){const node={type:"InterfaceTypeAnnotation",extends:_extends,body},defs=NODE_FIELDS.InterfaceTypeAnnotation;return validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.interpreterDirective=function(value){const node={type:"InterpreterDirective",value},defs=NODE_FIELDS.InterpreterDirective;return validate(defs.value,node,"value",value),node},exports.intersectionTypeAnnotation=function(types){const node={type:"IntersectionTypeAnnotation",types},defs=NODE_FIELDS.IntersectionTypeAnnotation;return validate(defs.types,node,"types",types,1),node},exports.jSXAttribute=exports.jsxAttribute=function(name,value=null){const node={type:"JSXAttribute",name,value},defs=NODE_FIELDS.JSXAttribute;return validate(defs.name,node,"name",name,1),validate(defs.value,node,"value",value,1),node},exports.jSXClosingElement=exports.jsxClosingElement=function(name){const node={type:"JSXClosingElement",name},defs=NODE_FIELDS.JSXClosingElement;return validate(defs.name,node,"name",name,1),node},exports.jSXClosingFragment=exports.jsxClosingFragment=function(){return{type:"JSXClosingFragment"}},exports.jSXElement=exports.jsxElement=function(openingElement,closingElement=null,children,selfClosing=null){const node={type:"JSXElement",openingElement,closingElement,children,selfClosing},defs=NODE_FIELDS.JSXElement;return validate(defs.openingElement,node,"openingElement",openingElement,1),validate(defs.closingElement,node,"closingElement",closingElement,1),validate(defs.children,node,"children",children,1),validate(defs.selfClosing,node,"selfClosing",selfClosing),node},exports.jSXEmptyExpression=exports.jsxEmptyExpression=function(){return{type:"JSXEmptyExpression"}},exports.jSXExpressionContainer=exports.jsxExpressionContainer=function(expression){const node={type:"JSXExpressionContainer",expression},defs=NODE_FIELDS.JSXExpressionContainer;return validate(defs.expression,node,"expression",expression,1),node},exports.jSXFragment=exports.jsxFragment=function(openingFragment,closingFragment,children){const node={type:"JSXFragment",openingFragment,closingFragment,children},defs=NODE_FIELDS.JSXFragment;return validate(defs.openingFragment,node,"openingFragment",openingFragment,1),validate(defs.closingFragment,node,"closingFragment",closingFragment,1),validate(defs.children,node,"children",children,1),node},exports.jSXIdentifier=exports.jsxIdentifier=function(name){const node={type:"JSXIdentifier",name},defs=NODE_FIELDS.JSXIdentifier;return validate(defs.name,node,"name",name),node},exports.jSXMemberExpression=exports.jsxMemberExpression=function(object,property){const node={type:"JSXMemberExpression",object,property},defs=NODE_FIELDS.JSXMemberExpression;return validate(defs.object,node,"object",object,1),validate(defs.property,node,"property",property,1),node},exports.jSXNamespacedName=exports.jsxNamespacedName=function(namespace,name){const node={type:"JSXNamespacedName",namespace,name},defs=NODE_FIELDS.JSXNamespacedName;return validate(defs.namespace,node,"namespace",namespace,1),validate(defs.name,node,"name",name,1),node},exports.jSXOpeningElement=exports.jsxOpeningElement=function(name,attributes,selfClosing=!1){const node={type:"JSXOpeningElement",name,attributes,selfClosing},defs=NODE_FIELDS.JSXOpeningElement;return validate(defs.name,node,"name",name,1),validate(defs.attributes,node,"attributes",attributes,1),validate(defs.selfClosing,node,"selfClosing",selfClosing),node},exports.jSXOpeningFragment=exports.jsxOpeningFragment=function(){return{type:"JSXOpeningFragment"}},exports.jSXSpreadAttribute=exports.jsxSpreadAttribute=function(argument){const node={type:"JSXSpreadAttribute",argument},defs=NODE_FIELDS.JSXSpreadAttribute;return validate(defs.argument,node,"argument",argument,1),node},exports.jSXSpreadChild=exports.jsxSpreadChild=function(expression){const node={type:"JSXSpreadChild",expression},defs=NODE_FIELDS.JSXSpreadChild;return validate(defs.expression,node,"expression",expression,1),node},exports.jSXText=exports.jsxText=function(value){const node={type:"JSXText",value},defs=NODE_FIELDS.JSXText;return validate(defs.value,node,"value",value),node},exports.labeledStatement=function(label,body){const node={type:"LabeledStatement",label,body},defs=NODE_FIELDS.LabeledStatement;return validate(defs.label,node,"label",label,1),validate(defs.body,node,"body",body,1),node},exports.logicalExpression=function(operator,left,right){const node={type:"LogicalExpression",operator,left,right},defs=NODE_FIELDS.LogicalExpression;return validate(defs.operator,node,"operator",operator),validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.memberExpression=function(object,property,computed=!1,optional=null){const node={type:"MemberExpression",object,property,computed,optional},defs=NODE_FIELDS.MemberExpression;return validate(defs.object,node,"object",object,1),validate(defs.property,node,"property",property,1),validate(defs.computed,node,"computed",computed),validate(defs.optional,node,"optional",optional),node},exports.metaProperty=function(meta,property){const node={type:"MetaProperty",meta,property},defs=NODE_FIELDS.MetaProperty;return validate(defs.meta,node,"meta",meta,1),validate(defs.property,node,"property",property,1),node},exports.mixedTypeAnnotation=function(){return{type:"MixedTypeAnnotation"}},exports.moduleExpression=function(body){const node={type:"ModuleExpression",body},defs=NODE_FIELDS.ModuleExpression;return validate(defs.body,node,"body",body,1),node},exports.newExpression=function(callee,_arguments){const node={type:"NewExpression",callee,arguments:_arguments},defs=NODE_FIELDS.NewExpression;return validate(defs.callee,node,"callee",callee,1),validate(defs.arguments,node,"arguments",_arguments,1),node},exports.noop=function(){return{type:"Noop"}},exports.nullLiteral=function(){return{type:"NullLiteral"}},exports.nullLiteralTypeAnnotation=function(){return{type:"NullLiteralTypeAnnotation"}},exports.nullableTypeAnnotation=function(typeAnnotation){const node={type:"NullableTypeAnnotation",typeAnnotation},defs=NODE_FIELDS.NullableTypeAnnotation;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.numberLiteral=function(value){return(0,_deprecationWarning.default)("NumberLiteral","NumericLiteral","The node type "),numericLiteral(value)},exports.numberLiteralTypeAnnotation=function(value){const node={type:"NumberLiteralTypeAnnotation",value},defs=NODE_FIELDS.NumberLiteralTypeAnnotation;return validate(defs.value,node,"value",value),node},exports.numberTypeAnnotation=function(){return{type:"NumberTypeAnnotation"}},exports.numericLiteral=numericLiteral,exports.objectExpression=function(properties){const node={type:"ObjectExpression",properties},defs=NODE_FIELDS.ObjectExpression;return validate(defs.properties,node,"properties",properties,1),node},exports.objectMethod=function(kind="method",key,params,body,computed=!1,generator=!1,async=!1){const node={type:"ObjectMethod",kind,key,params,body,computed,generator,async},defs=NODE_FIELDS.ObjectMethod;return validate(defs.kind,node,"kind",kind),validate(defs.key,node,"key",key,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.computed,node,"computed",computed),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.objectPattern=function(properties){const node={type:"ObjectPattern",properties},defs=NODE_FIELDS.ObjectPattern;return validate(defs.properties,node,"properties",properties,1),node},exports.objectProperty=function(key,value,computed=!1,shorthand=!1,decorators=null){const node={type:"ObjectProperty",key,value,computed,shorthand,decorators},defs=NODE_FIELDS.ObjectProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.computed,node,"computed",computed),validate(defs.shorthand,node,"shorthand",shorthand),validate(defs.decorators,node,"decorators",decorators,1),node},exports.objectTypeAnnotation=function(properties,indexers=[],callProperties=[],internalSlots=[],exact=!1){const node={type:"ObjectTypeAnnotation",properties,indexers,callProperties,internalSlots,exact},defs=NODE_FIELDS.ObjectTypeAnnotation;return validate(defs.properties,node,"properties",properties,1),validate(defs.indexers,node,"indexers",indexers,1),validate(defs.callProperties,node,"callProperties",callProperties,1),validate(defs.internalSlots,node,"internalSlots",internalSlots,1),validate(defs.exact,node,"exact",exact),node},exports.objectTypeCallProperty=function(value){const node={type:"ObjectTypeCallProperty",value,static:null},defs=NODE_FIELDS.ObjectTypeCallProperty;return validate(defs.value,node,"value",value,1),node},exports.objectTypeIndexer=function(id=null,key,value,variance=null){const node={type:"ObjectTypeIndexer",id,key,value,variance,static:null},defs=NODE_FIELDS.ObjectTypeIndexer;return validate(defs.id,node,"id",id,1),validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.variance,node,"variance",variance,1),node},exports.objectTypeInternalSlot=function(id,value,optional,_static,method){const node={type:"ObjectTypeInternalSlot",id,value,optional,static:_static,method},defs=NODE_FIELDS.ObjectTypeInternalSlot;return validate(defs.id,node,"id",id,1),validate(defs.value,node,"value",value,1),validate(defs.optional,node,"optional",optional),validate(defs.static,node,"static",_static),validate(defs.method,node,"method",method),node},exports.objectTypeProperty=function(key,value,variance=null){const node={type:"ObjectTypeProperty",key,value,variance,kind:null,method:null,optional:null,proto:null,static:null},defs=NODE_FIELDS.ObjectTypeProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.variance,node,"variance",variance,1),node},exports.objectTypeSpreadProperty=function(argument){const node={type:"ObjectTypeSpreadProperty",argument},defs=NODE_FIELDS.ObjectTypeSpreadProperty;return validate(defs.argument,node,"argument",argument,1),node},exports.opaqueType=function(id,typeParameters=null,supertype=null,impltype){const node={type:"OpaqueType",id,typeParameters,supertype,impltype},defs=NODE_FIELDS.OpaqueType;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.supertype,node,"supertype",supertype,1),validate(defs.impltype,node,"impltype",impltype,1),node},exports.optionalCallExpression=function(callee,_arguments,optional){const node={type:"OptionalCallExpression",callee,arguments:_arguments,optional},defs=NODE_FIELDS.OptionalCallExpression;return validate(defs.callee,node,"callee",callee,1),validate(defs.arguments,node,"arguments",_arguments,1),validate(defs.optional,node,"optional",optional),node},exports.optionalIndexedAccessType=function(objectType,indexType){const node={type:"OptionalIndexedAccessType",objectType,indexType,optional:null},defs=NODE_FIELDS.OptionalIndexedAccessType;return validate(defs.objectType,node,"objectType",objectType,1),validate(defs.indexType,node,"indexType",indexType,1),node},exports.optionalMemberExpression=function(object,property,computed=!1,optional){const node={type:"OptionalMemberExpression",object,property,computed,optional},defs=NODE_FIELDS.OptionalMemberExpression;return validate(defs.object,node,"object",object,1),validate(defs.property,node,"property",property,1),validate(defs.computed,node,"computed",computed),validate(defs.optional,node,"optional",optional),node},exports.parenthesizedExpression=function(expression){const node={type:"ParenthesizedExpression",expression},defs=NODE_FIELDS.ParenthesizedExpression;return validate(defs.expression,node,"expression",expression,1),node},exports.pipelineBareFunction=function(callee){const node={type:"PipelineBareFunction",callee},defs=NODE_FIELDS.PipelineBareFunction;return validate(defs.callee,node,"callee",callee,1),node},exports.pipelinePrimaryTopicReference=function(){return{type:"PipelinePrimaryTopicReference"}},exports.pipelineTopicExpression=function(expression){const node={type:"PipelineTopicExpression",expression},defs=NODE_FIELDS.PipelineTopicExpression;return validate(defs.expression,node,"expression",expression,1),node},exports.placeholder=function(expectedNode,name){const node={type:"Placeholder",expectedNode,name},defs=NODE_FIELDS.Placeholder;return validate(defs.expectedNode,node,"expectedNode",expectedNode),validate(defs.name,node,"name",name,1),node},exports.privateName=function(id){const node={type:"PrivateName",id},defs=NODE_FIELDS.PrivateName;return validate(defs.id,node,"id",id,1),node},exports.program=function(body,directives=[],sourceType="script",interpreter=null){const node={type:"Program",body,directives,sourceType,interpreter},defs=NODE_FIELDS.Program;return validate(defs.body,node,"body",body,1),validate(defs.directives,node,"directives",directives,1),validate(defs.sourceType,node,"sourceType",sourceType),validate(defs.interpreter,node,"interpreter",interpreter,1),node},exports.qualifiedTypeIdentifier=function(id,qualification){const node={type:"QualifiedTypeIdentifier",id,qualification},defs=NODE_FIELDS.QualifiedTypeIdentifier;return validate(defs.id,node,"id",id,1),validate(defs.qualification,node,"qualification",qualification,1),node},exports.recordExpression=function(properties){const node={type:"RecordExpression",properties},defs=NODE_FIELDS.RecordExpression;return validate(defs.properties,node,"properties",properties,1),node},exports.regExpLiteral=regExpLiteral,exports.regexLiteral=function(pattern,flags=""){return(0,_deprecationWarning.default)("RegexLiteral","RegExpLiteral","The node type "),regExpLiteral(pattern,flags)},exports.restElement=restElement,exports.restProperty=function(argument){return(0,_deprecationWarning.default)("RestProperty","RestElement","The node type "),restElement(argument)},exports.returnStatement=function(argument=null){const node={type:"ReturnStatement",argument},defs=NODE_FIELDS.ReturnStatement;return validate(defs.argument,node,"argument",argument,1),node},exports.sequenceExpression=function(expressions){const node={type:"SequenceExpression",expressions},defs=NODE_FIELDS.SequenceExpression;return validate(defs.expressions,node,"expressions",expressions,1),node},exports.spreadElement=spreadElement,exports.spreadProperty=function(argument){return(0,_deprecationWarning.default)("SpreadProperty","SpreadElement","The node type "),spreadElement(argument)},exports.staticBlock=function(body){const node={type:"StaticBlock",body},defs=NODE_FIELDS.StaticBlock;return validate(defs.body,node,"body",body,1),node},exports.stringLiteral=function(value){const node={type:"StringLiteral",value},defs=NODE_FIELDS.StringLiteral;return validate(defs.value,node,"value",value),node},exports.stringLiteralTypeAnnotation=function(value){const node={type:"StringLiteralTypeAnnotation",value},defs=NODE_FIELDS.StringLiteralTypeAnnotation;return validate(defs.value,node,"value",value),node},exports.stringTypeAnnotation=function(){return{type:"StringTypeAnnotation"}},exports.super=function(){return{type:"Super"}},exports.switchCase=function(test=null,consequent){const node={type:"SwitchCase",test,consequent},defs=NODE_FIELDS.SwitchCase;return validate(defs.test,node,"test",test,1),validate(defs.consequent,node,"consequent",consequent,1),node},exports.switchStatement=function(discriminant,cases){const node={type:"SwitchStatement",discriminant,cases},defs=NODE_FIELDS.SwitchStatement;return validate(defs.discriminant,node,"discriminant",discriminant,1),validate(defs.cases,node,"cases",cases,1),node},exports.symbolTypeAnnotation=function(){return{type:"SymbolTypeAnnotation"}},exports.taggedTemplateExpression=function(tag,quasi){const node={type:"TaggedTemplateExpression",tag,quasi},defs=NODE_FIELDS.TaggedTemplateExpression;return validate(defs.tag,node,"tag",tag,1),validate(defs.quasi,node,"quasi",quasi,1),node},exports.templateElement=function(value,tail=!1){const node={type:"TemplateElement",value,tail},defs=NODE_FIELDS.TemplateElement;return validate(defs.value,node,"value",value),validate(defs.tail,node,"tail",tail),node},exports.templateLiteral=function(quasis,expressions){const node={type:"TemplateLiteral",quasis,expressions},defs=NODE_FIELDS.TemplateLiteral;return validate(defs.quasis,node,"quasis",quasis,1),validate(defs.expressions,node,"expressions",expressions,1),node},exports.thisExpression=function(){return{type:"ThisExpression"}},exports.thisTypeAnnotation=function(){return{type:"ThisTypeAnnotation"}},exports.throwStatement=function(argument){const node={type:"ThrowStatement",argument},defs=NODE_FIELDS.ThrowStatement;return validate(defs.argument,node,"argument",argument,1),node},exports.topicReference=function(){return{type:"TopicReference"}},exports.tryStatement=function(block,handler=null,finalizer=null){const node={type:"TryStatement",block,handler,finalizer},defs=NODE_FIELDS.TryStatement;return validate(defs.block,node,"block",block,1),validate(defs.handler,node,"handler",handler,1),validate(defs.finalizer,node,"finalizer",finalizer,1),node},exports.tSAnyKeyword=exports.tsAnyKeyword=function(){return{type:"TSAnyKeyword"}},exports.tSArrayType=exports.tsArrayType=function(elementType){const node={type:"TSArrayType",elementType},defs=NODE_FIELDS.TSArrayType;return validate(defs.elementType,node,"elementType",elementType,1),node},exports.tSAsExpression=exports.tsAsExpression=function(expression,typeAnnotation){const node={type:"TSAsExpression",expression,typeAnnotation},defs=NODE_FIELDS.TSAsExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSBigIntKeyword=exports.tsBigIntKeyword=function(){return{type:"TSBigIntKeyword"}},exports.tSBooleanKeyword=exports.tsBooleanKeyword=function(){return{type:"TSBooleanKeyword"}},exports.tSCallSignatureDeclaration=exports.tsCallSignatureDeclaration=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSCallSignatureDeclaration",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSCallSignatureDeclaration;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSConditionalType=exports.tsConditionalType=function(checkType,extendsType,trueType,falseType){const node={type:"TSConditionalType",checkType,extendsType,trueType,falseType},defs=NODE_FIELDS.TSConditionalType;return validate(defs.checkType,node,"checkType",checkType,1),validate(defs.extendsType,node,"extendsType",extendsType,1),validate(defs.trueType,node,"trueType",trueType,1),validate(defs.falseType,node,"falseType",falseType,1),node},exports.tSConstructSignatureDeclaration=exports.tsConstructSignatureDeclaration=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSConstructSignatureDeclaration",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSConstructSignatureDeclaration;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSConstructorType=exports.tsConstructorType=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSConstructorType",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSConstructorType;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSDeclareFunction=exports.tsDeclareFunction=function(id=null,typeParameters=null,params,returnType=null){const node={type:"TSDeclareFunction",id,typeParameters,params,returnType},defs=NODE_FIELDS.TSDeclareFunction;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.params,node,"params",params,1),validate(defs.returnType,node,"returnType",returnType,1),node},exports.tSDeclareMethod=exports.tsDeclareMethod=function(decorators=null,key,typeParameters=null,params,returnType=null){const node={type:"TSDeclareMethod",decorators,key,typeParameters,params,returnType},defs=NODE_FIELDS.TSDeclareMethod;return validate(defs.decorators,node,"decorators",decorators,1),validate(defs.key,node,"key",key,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.params,node,"params",params,1),validate(defs.returnType,node,"returnType",returnType,1),node},exports.tSEnumDeclaration=exports.tsEnumDeclaration=function(id,members){const node={type:"TSEnumDeclaration",id,members},defs=NODE_FIELDS.TSEnumDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.members,node,"members",members,1),node},exports.tSEnumMember=exports.tsEnumMember=function(id,initializer=null){const node={type:"TSEnumMember",id,initializer},defs=NODE_FIELDS.TSEnumMember;return validate(defs.id,node,"id",id,1),validate(defs.initializer,node,"initializer",initializer,1),node},exports.tSExportAssignment=exports.tsExportAssignment=function(expression){const node={type:"TSExportAssignment",expression},defs=NODE_FIELDS.TSExportAssignment;return validate(defs.expression,node,"expression",expression,1),node},exports.tSExpressionWithTypeArguments=exports.tsExpressionWithTypeArguments=function(expression,typeParameters=null){const node={type:"TSExpressionWithTypeArguments",expression,typeParameters},defs=NODE_FIELDS.TSExpressionWithTypeArguments;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSExternalModuleReference=exports.tsExternalModuleReference=function(expression){const node={type:"TSExternalModuleReference",expression},defs=NODE_FIELDS.TSExternalModuleReference;return validate(defs.expression,node,"expression",expression,1),node},exports.tSFunctionType=exports.tsFunctionType=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSFunctionType",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSFunctionType;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSImportEqualsDeclaration=exports.tsImportEqualsDeclaration=function(id,moduleReference){const node={type:"TSImportEqualsDeclaration",id,moduleReference,isExport:null},defs=NODE_FIELDS.TSImportEqualsDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.moduleReference,node,"moduleReference",moduleReference,1),node},exports.tSImportType=exports.tsImportType=function(argument,qualifier=null,typeParameters=null){const node={type:"TSImportType",argument,qualifier,typeParameters},defs=NODE_FIELDS.TSImportType;return validate(defs.argument,node,"argument",argument,1),validate(defs.qualifier,node,"qualifier",qualifier,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSIndexSignature=exports.tsIndexSignature=function(parameters,typeAnnotation=null){const node={type:"TSIndexSignature",parameters,typeAnnotation},defs=NODE_FIELDS.TSIndexSignature;return validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSIndexedAccessType=exports.tsIndexedAccessType=function(objectType,indexType){const node={type:"TSIndexedAccessType",objectType,indexType},defs=NODE_FIELDS.TSIndexedAccessType;return validate(defs.objectType,node,"objectType",objectType,1),validate(defs.indexType,node,"indexType",indexType,1),node},exports.tSInferType=exports.tsInferType=function(typeParameter){const node={type:"TSInferType",typeParameter},defs=NODE_FIELDS.TSInferType;return validate(defs.typeParameter,node,"typeParameter",typeParameter,1),node},exports.tSInstantiationExpression=exports.tsInstantiationExpression=function(expression,typeParameters=null){const node={type:"TSInstantiationExpression",expression,typeParameters},defs=NODE_FIELDS.TSInstantiationExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSInterfaceBody=exports.tsInterfaceBody=function(body){const node={type:"TSInterfaceBody",body},defs=NODE_FIELDS.TSInterfaceBody;return validate(defs.body,node,"body",body,1),node},exports.tSInterfaceDeclaration=exports.tsInterfaceDeclaration=function(id,typeParameters=null,_extends=null,body){const node={type:"TSInterfaceDeclaration",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.TSInterfaceDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.tSIntersectionType=exports.tsIntersectionType=function(types){const node={type:"TSIntersectionType",types},defs=NODE_FIELDS.TSIntersectionType;return validate(defs.types,node,"types",types,1),node},exports.tSIntrinsicKeyword=exports.tsIntrinsicKeyword=function(){return{type:"TSIntrinsicKeyword"}},exports.tSLiteralType=exports.tsLiteralType=function(literal){const node={type:"TSLiteralType",literal},defs=NODE_FIELDS.TSLiteralType;return validate(defs.literal,node,"literal",literal,1),node},exports.tSMappedType=exports.tsMappedType=function(typeParameter,typeAnnotation=null,nameType=null){const node={type:"TSMappedType",typeParameter,typeAnnotation,nameType},defs=NODE_FIELDS.TSMappedType;return validate(defs.typeParameter,node,"typeParameter",typeParameter,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.nameType,node,"nameType",nameType,1),node},exports.tSMethodSignature=exports.tsMethodSignature=function(key,typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSMethodSignature",key,typeParameters,parameters,typeAnnotation,kind:null},defs=NODE_FIELDS.TSMethodSignature;return validate(defs.key,node,"key",key,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSModuleBlock=exports.tsModuleBlock=function(body){const node={type:"TSModuleBlock",body},defs=NODE_FIELDS.TSModuleBlock;return validate(defs.body,node,"body",body,1),node},exports.tSModuleDeclaration=exports.tsModuleDeclaration=function(id,body){const node={type:"TSModuleDeclaration",id,body,kind:null},defs=NODE_FIELDS.TSModuleDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.body,node,"body",body,1),node},exports.tSNamedTupleMember=exports.tsNamedTupleMember=function(label,elementType,optional=!1){const node={type:"TSNamedTupleMember",label,elementType,optional},defs=NODE_FIELDS.TSNamedTupleMember;return validate(defs.label,node,"label",label,1),validate(defs.elementType,node,"elementType",elementType,1),validate(defs.optional,node,"optional",optional),node},exports.tSNamespaceExportDeclaration=exports.tsNamespaceExportDeclaration=function(id){const node={type:"TSNamespaceExportDeclaration",id},defs=NODE_FIELDS.TSNamespaceExportDeclaration;return validate(defs.id,node,"id",id,1),node},exports.tSNeverKeyword=exports.tsNeverKeyword=function(){return{type:"TSNeverKeyword"}},exports.tSNonNullExpression=exports.tsNonNullExpression=function(expression){const node={type:"TSNonNullExpression",expression},defs=NODE_FIELDS.TSNonNullExpression;return validate(defs.expression,node,"expression",expression,1),node},exports.tSNullKeyword=exports.tsNullKeyword=function(){return{type:"TSNullKeyword"}},exports.tSNumberKeyword=exports.tsNumberKeyword=function(){return{type:"TSNumberKeyword"}},exports.tSObjectKeyword=exports.tsObjectKeyword=function(){return{type:"TSObjectKeyword"}},exports.tSOptionalType=exports.tsOptionalType=function(typeAnnotation){const node={type:"TSOptionalType",typeAnnotation},defs=NODE_FIELDS.TSOptionalType;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSParameterProperty=exports.tsParameterProperty=function(parameter){const node={type:"TSParameterProperty",parameter},defs=NODE_FIELDS.TSParameterProperty;return validate(defs.parameter,node,"parameter",parameter,1),node},exports.tSParenthesizedType=exports.tsParenthesizedType=function(typeAnnotation){const node={type:"TSParenthesizedType",typeAnnotation},defs=NODE_FIELDS.TSParenthesizedType;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSPropertySignature=exports.tsPropertySignature=function(key,typeAnnotation=null){const node={type:"TSPropertySignature",key,typeAnnotation,kind:null},defs=NODE_FIELDS.TSPropertySignature;return validate(defs.key,node,"key",key,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSQualifiedName=exports.tsQualifiedName=function(left,right){const node={type:"TSQualifiedName",left,right},defs=NODE_FIELDS.TSQualifiedName;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.tSRestType=exports.tsRestType=function(typeAnnotation){const node={type:"TSRestType",typeAnnotation},defs=NODE_FIELDS.TSRestType;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSSatisfiesExpression=exports.tsSatisfiesExpression=function(expression,typeAnnotation){const node={type:"TSSatisfiesExpression",expression,typeAnnotation},defs=NODE_FIELDS.TSSatisfiesExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSStringKeyword=exports.tsStringKeyword=function(){return{type:"TSStringKeyword"}},exports.tSSymbolKeyword=exports.tsSymbolKeyword=function(){return{type:"TSSymbolKeyword"}},exports.tSThisType=exports.tsThisType=function(){return{type:"TSThisType"}},exports.tSTupleType=exports.tsTupleType=function(elementTypes){const node={type:"TSTupleType",elementTypes},defs=NODE_FIELDS.TSTupleType;return validate(defs.elementTypes,node,"elementTypes",elementTypes,1),node},exports.tSTypeAliasDeclaration=exports.tsTypeAliasDeclaration=function(id,typeParameters=null,typeAnnotation){const node={type:"TSTypeAliasDeclaration",id,typeParameters,typeAnnotation},defs=NODE_FIELDS.TSTypeAliasDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSTypeAnnotation=exports.tsTypeAnnotation=function(typeAnnotation){const node={type:"TSTypeAnnotation",typeAnnotation},defs=NODE_FIELDS.TSTypeAnnotation;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSTypeAssertion=exports.tsTypeAssertion=function(typeAnnotation,expression){const node={type:"TSTypeAssertion",typeAnnotation,expression},defs=NODE_FIELDS.TSTypeAssertion;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.expression,node,"expression",expression,1),node},exports.tSTypeLiteral=exports.tsTypeLiteral=function(members){const node={type:"TSTypeLiteral",members},defs=NODE_FIELDS.TSTypeLiteral;return validate(defs.members,node,"members",members,1),node},exports.tSTypeOperator=exports.tsTypeOperator=function(typeAnnotation){const node={type:"TSTypeOperator",typeAnnotation,operator:null},defs=NODE_FIELDS.TSTypeOperator;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSTypeParameter=exports.tsTypeParameter=function(constraint=null,_default=null,name){const node={type:"TSTypeParameter",constraint,default:_default,name},defs=NODE_FIELDS.TSTypeParameter;return validate(defs.constraint,node,"constraint",constraint,1),validate(defs.default,node,"default",_default,1),validate(defs.name,node,"name",name),node},exports.tSTypeParameterDeclaration=exports.tsTypeParameterDeclaration=function(params){const node={type:"TSTypeParameterDeclaration",params},defs=NODE_FIELDS.TSTypeParameterDeclaration;return validate(defs.params,node,"params",params,1),node},exports.tSTypeParameterInstantiation=exports.tsTypeParameterInstantiation=function(params){const node={type:"TSTypeParameterInstantiation",params},defs=NODE_FIELDS.TSTypeParameterInstantiation;return validate(defs.params,node,"params",params,1),node},exports.tSTypePredicate=exports.tsTypePredicate=function(parameterName,typeAnnotation=null,asserts=null){const node={type:"TSTypePredicate",parameterName,typeAnnotation,asserts},defs=NODE_FIELDS.TSTypePredicate;return validate(defs.parameterName,node,"parameterName",parameterName,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.asserts,node,"asserts",asserts),node},exports.tSTypeQuery=exports.tsTypeQuery=function(exprName,typeParameters=null){const node={type:"TSTypeQuery",exprName,typeParameters},defs=NODE_FIELDS.TSTypeQuery;return validate(defs.exprName,node,"exprName",exprName,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSTypeReference=exports.tsTypeReference=function(typeName,typeParameters=null){const node={type:"TSTypeReference",typeName,typeParameters},defs=NODE_FIELDS.TSTypeReference;return validate(defs.typeName,node,"typeName",typeName,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSUndefinedKeyword=exports.tsUndefinedKeyword=function(){return{type:"TSUndefinedKeyword"}},exports.tSUnionType=exports.tsUnionType=function(types){const node={type:"TSUnionType",types},defs=NODE_FIELDS.TSUnionType;return validate(defs.types,node,"types",types,1),node},exports.tSUnknownKeyword=exports.tsUnknownKeyword=function(){return{type:"TSUnknownKeyword"}},exports.tSVoidKeyword=exports.tsVoidKeyword=function(){return{type:"TSVoidKeyword"}},exports.tupleExpression=function(elements=[]){const node={type:"TupleExpression",elements},defs=NODE_FIELDS.TupleExpression;return validate(defs.elements,node,"elements",elements,1),node},exports.tupleTypeAnnotation=function(types){const node={type:"TupleTypeAnnotation",types},defs=NODE_FIELDS.TupleTypeAnnotation;return validate(defs.types,node,"types",types,1),node},exports.typeAlias=function(id,typeParameters=null,right){const node={type:"TypeAlias",id,typeParameters,right},defs=NODE_FIELDS.TypeAlias;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.right,node,"right",right,1),node},exports.typeAnnotation=function(typeAnnotation){const node={type:"TypeAnnotation",typeAnnotation},defs=NODE_FIELDS.TypeAnnotation;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.typeCastExpression=function(expression,typeAnnotation){const node={type:"TypeCastExpression",expression,typeAnnotation},defs=NODE_FIELDS.TypeCastExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.typeParameter=function(bound=null,_default=null,variance=null){const node={type:"TypeParameter",bound,default:_default,variance,name:null},defs=NODE_FIELDS.TypeParameter;return validate(defs.bound,node,"bound",bound,1),validate(defs.default,node,"default",_default,1),validate(defs.variance,node,"variance",variance,1),node},exports.typeParameterDeclaration=function(params){const node={type:"TypeParameterDeclaration",params},defs=NODE_FIELDS.TypeParameterDeclaration;return validate(defs.params,node,"params",params,1),node},exports.typeParameterInstantiation=function(params){const node={type:"TypeParameterInstantiation",params},defs=NODE_FIELDS.TypeParameterInstantiation;return validate(defs.params,node,"params",params,1),node},exports.typeofTypeAnnotation=function(argument){const node={type:"TypeofTypeAnnotation",argument},defs=NODE_FIELDS.TypeofTypeAnnotation;return validate(defs.argument,node,"argument",argument,1),node},exports.unaryExpression=function(operator,argument,prefix=!0){const node={type:"UnaryExpression",operator,argument,prefix},defs=NODE_FIELDS.UnaryExpression;return validate(defs.operator,node,"operator",operator),validate(defs.argument,node,"argument",argument,1),validate(defs.prefix,node,"prefix",prefix),node},exports.unionTypeAnnotation=function(types){const node={type:"UnionTypeAnnotation",types},defs=NODE_FIELDS.UnionTypeAnnotation;return validate(defs.types,node,"types",types,1),node},exports.updateExpression=function(operator,argument,prefix=!1){const node={type:"UpdateExpression",operator,argument,prefix},defs=NODE_FIELDS.UpdateExpression;return validate(defs.operator,node,"operator",operator),validate(defs.argument,node,"argument",argument,1),validate(defs.prefix,node,"prefix",prefix),node},exports.v8IntrinsicIdentifier=function(name){const node={type:"V8IntrinsicIdentifier",name},defs=NODE_FIELDS.V8IntrinsicIdentifier;return validate(defs.name,node,"name",name),node},exports.variableDeclaration=function(kind,declarations){const node={type:"VariableDeclaration",kind,declarations},defs=NODE_FIELDS.VariableDeclaration;return validate(defs.kind,node,"kind",kind),validate(defs.declarations,node,"declarations",declarations,1),node},exports.variableDeclarator=function(id,init=null){const node={type:"VariableDeclarator",id,init},defs=NODE_FIELDS.VariableDeclarator;return validate(defs.id,node,"id",id,1),validate(defs.init,node,"init",init,1),node},exports.variance=function(kind){const node={type:"Variance",kind},defs=NODE_FIELDS.Variance;return validate(defs.kind,node,"kind",kind),node},exports.voidTypeAnnotation=function(){return{type:"VoidTypeAnnotation"}},exports.whileStatement=function(test,body){const node={type:"WhileStatement",test,body},defs=NODE_FIELDS.WhileStatement;return validate(defs.test,node,"test",test,1),validate(defs.body,node,"body",body,1),node},exports.withStatement=function(object,body){const node={type:"WithStatement",object,body},defs=NODE_FIELDS.WithStatement;return validate(defs.object,node,"object",object,1),validate(defs.body,node,"body",body,1),node},exports.yieldExpression=function(argument=null,delegate=!1){const node={type:"YieldExpression",argument,delegate},defs=NODE_FIELDS.YieldExpression;return validate(defs.argument,node,"argument",argument,1),validate(defs.delegate,node,"delegate",delegate),node};var _validate=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js"),_deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js"),utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const{validateInternal:validate}=_validate,{NODE_FIELDS}=utils;function numericLiteral(value){const node={type:"NumericLiteral",value},defs=NODE_FIELDS.NumericLiteral;return validate(defs.value,node,"value",value),node}function regExpLiteral(pattern,flags=""){const node={type:"RegExpLiteral",pattern,flags},defs=NODE_FIELDS.RegExpLiteral;return validate(defs.pattern,node,"pattern",pattern),validate(defs.flags,node,"flags",flags),node}function restElement(argument){const node={type:"RestElement",argument},defs=NODE_FIELDS.RestElement;return validate(defs.argument,node,"argument",argument,1),node}function spreadElement(argument){const node={type:"SpreadElement",argument},defs=NODE_FIELDS.SpreadElement;return validate(defs.argument,node,"argument",argument,1),node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/uppercase.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AnyTypeAnnotation",{enumerable:!0,get:function(){return _index.anyTypeAnnotation}}),Object.defineProperty(exports,"ArgumentPlaceholder",{enumerable:!0,get:function(){return _index.argumentPlaceholder}}),Object.defineProperty(exports,"ArrayExpression",{enumerable:!0,get:function(){return _index.arrayExpression}}),Object.defineProperty(exports,"ArrayPattern",{enumerable:!0,get:function(){return _index.arrayPattern}}),Object.defineProperty(exports,"ArrayTypeAnnotation",{enumerable:!0,get:function(){return _index.arrayTypeAnnotation}}),Object.defineProperty(exports,"ArrowFunctionExpression",{enumerable:!0,get:function(){return _index.arrowFunctionExpression}}),Object.defineProperty(exports,"AssignmentExpression",{enumerable:!0,get:function(){return _index.assignmentExpression}}),Object.defineProperty(exports,"AssignmentPattern",{enumerable:!0,get:function(){return _index.assignmentPattern}}),Object.defineProperty(exports,"AwaitExpression",{enumerable:!0,get:function(){return _index.awaitExpression}}),Object.defineProperty(exports,"BigIntLiteral",{enumerable:!0,get:function(){return _index.bigIntLiteral}}),Object.defineProperty(exports,"BinaryExpression",{enumerable:!0,get:function(){return _index.binaryExpression}}),Object.defineProperty(exports,"BindExpression",{enumerable:!0,get:function(){return _index.bindExpression}}),Object.defineProperty(exports,"BlockStatement",{enumerable:!0,get:function(){return _index.blockStatement}}),Object.defineProperty(exports,"BooleanLiteral",{enumerable:!0,get:function(){return _index.booleanLiteral}}),Object.defineProperty(exports,"BooleanLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.booleanLiteralTypeAnnotation}}),Object.defineProperty(exports,"BooleanTypeAnnotation",{enumerable:!0,get:function(){return _index.booleanTypeAnnotation}}),Object.defineProperty(exports,"BreakStatement",{enumerable:!0,get:function(){return _index.breakStatement}}),Object.defineProperty(exports,"CallExpression",{enumerable:!0,get:function(){return _index.callExpression}}),Object.defineProperty(exports,"CatchClause",{enumerable:!0,get:function(){return _index.catchClause}}),Object.defineProperty(exports,"ClassAccessorProperty",{enumerable:!0,get:function(){return _index.classAccessorProperty}}),Object.defineProperty(exports,"ClassBody",{enumerable:!0,get:function(){return _index.classBody}}),Object.defineProperty(exports,"ClassDeclaration",{enumerable:!0,get:function(){return _index.classDeclaration}}),Object.defineProperty(exports,"ClassExpression",{enumerable:!0,get:function(){return _index.classExpression}}),Object.defineProperty(exports,"ClassImplements",{enumerable:!0,get:function(){return _index.classImplements}}),Object.defineProperty(exports,"ClassMethod",{enumerable:!0,get:function(){return _index.classMethod}}),Object.defineProperty(exports,"ClassPrivateMethod",{enumerable:!0,get:function(){return _index.classPrivateMethod}}),Object.defineProperty(exports,"ClassPrivateProperty",{enumerable:!0,get:function(){return _index.classPrivateProperty}}),Object.defineProperty(exports,"ClassProperty",{enumerable:!0,get:function(){return _index.classProperty}}),Object.defineProperty(exports,"ConditionalExpression",{enumerable:!0,get:function(){return _index.conditionalExpression}}),Object.defineProperty(exports,"ContinueStatement",{enumerable:!0,get:function(){return _index.continueStatement}}),Object.defineProperty(exports,"DebuggerStatement",{enumerable:!0,get:function(){return _index.debuggerStatement}}),Object.defineProperty(exports,"DecimalLiteral",{enumerable:!0,get:function(){return _index.decimalLiteral}}),Object.defineProperty(exports,"DeclareClass",{enumerable:!0,get:function(){return _index.declareClass}}),Object.defineProperty(exports,"DeclareExportAllDeclaration",{enumerable:!0,get:function(){return _index.declareExportAllDeclaration}}),Object.defineProperty(exports,"DeclareExportDeclaration",{enumerable:!0,get:function(){return _index.declareExportDeclaration}}),Object.defineProperty(exports,"DeclareFunction",{enumerable:!0,get:function(){return _index.declareFunction}}),Object.defineProperty(exports,"DeclareInterface",{enumerable:!0,get:function(){return _index.declareInterface}}),Object.defineProperty(exports,"DeclareModule",{enumerable:!0,get:function(){return _index.declareModule}}),Object.defineProperty(exports,"DeclareModuleExports",{enumerable:!0,get:function(){return _index.declareModuleExports}}),Object.defineProperty(exports,"DeclareOpaqueType",{enumerable:!0,get:function(){return _index.declareOpaqueType}}),Object.defineProperty(exports,"DeclareTypeAlias",{enumerable:!0,get:function(){return _index.declareTypeAlias}}),Object.defineProperty(exports,"DeclareVariable",{enumerable:!0,get:function(){return _index.declareVariable}}),Object.defineProperty(exports,"DeclaredPredicate",{enumerable:!0,get:function(){return _index.declaredPredicate}}),Object.defineProperty(exports,"Decorator",{enumerable:!0,get:function(){return _index.decorator}}),Object.defineProperty(exports,"Directive",{enumerable:!0,get:function(){return _index.directive}}),Object.defineProperty(exports,"DirectiveLiteral",{enumerable:!0,get:function(){return _index.directiveLiteral}}),Object.defineProperty(exports,"DoExpression",{enumerable:!0,get:function(){return _index.doExpression}}),Object.defineProperty(exports,"DoWhileStatement",{enumerable:!0,get:function(){return _index.doWhileStatement}}),Object.defineProperty(exports,"EmptyStatement",{enumerable:!0,get:function(){return _index.emptyStatement}}),Object.defineProperty(exports,"EmptyTypeAnnotation",{enumerable:!0,get:function(){return _index.emptyTypeAnnotation}}),Object.defineProperty(exports,"EnumBooleanBody",{enumerable:!0,get:function(){return _index.enumBooleanBody}}),Object.defineProperty(exports,"EnumBooleanMember",{enumerable:!0,get:function(){return _index.enumBooleanMember}}),Object.defineProperty(exports,"EnumDeclaration",{enumerable:!0,get:function(){return _index.enumDeclaration}}),Object.defineProperty(exports,"EnumDefaultedMember",{enumerable:!0,get:function(){return _index.enumDefaultedMember}}),Object.defineProperty(exports,"EnumNumberBody",{enumerable:!0,get:function(){return _index.enumNumberBody}}),Object.defineProperty(exports,"EnumNumberMember",{enumerable:!0,get:function(){return _index.enumNumberMember}}),Object.defineProperty(exports,"EnumStringBody",{enumerable:!0,get:function(){return _index.enumStringBody}}),Object.defineProperty(exports,"EnumStringMember",{enumerable:!0,get:function(){return _index.enumStringMember}}),Object.defineProperty(exports,"EnumSymbolBody",{enumerable:!0,get:function(){return _index.enumSymbolBody}}),Object.defineProperty(exports,"ExistsTypeAnnotation",{enumerable:!0,get:function(){return _index.existsTypeAnnotation}}),Object.defineProperty(exports,"ExportAllDeclaration",{enumerable:!0,get:function(){return _index.exportAllDeclaration}}),Object.defineProperty(exports,"ExportDefaultDeclaration",{enumerable:!0,get:function(){return _index.exportDefaultDeclaration}}),Object.defineProperty(exports,"ExportDefaultSpecifier",{enumerable:!0,get:function(){return _index.exportDefaultSpecifier}}),Object.defineProperty(exports,"ExportNamedDeclaration",{enumerable:!0,get:function(){return _index.exportNamedDeclaration}}),Object.defineProperty(exports,"ExportNamespaceSpecifier",{enumerable:!0,get:function(){return _index.exportNamespaceSpecifier}}),Object.defineProperty(exports,"ExportSpecifier",{enumerable:!0,get:function(){return _index.exportSpecifier}}),Object.defineProperty(exports,"ExpressionStatement",{enumerable:!0,get:function(){return _index.expressionStatement}}),Object.defineProperty(exports,"File",{enumerable:!0,get:function(){return _index.file}}),Object.defineProperty(exports,"ForInStatement",{enumerable:!0,get:function(){return _index.forInStatement}}),Object.defineProperty(exports,"ForOfStatement",{enumerable:!0,get:function(){return _index.forOfStatement}}),Object.defineProperty(exports,"ForStatement",{enumerable:!0,get:function(){return _index.forStatement}}),Object.defineProperty(exports,"FunctionDeclaration",{enumerable:!0,get:function(){return _index.functionDeclaration}}),Object.defineProperty(exports,"FunctionExpression",{enumerable:!0,get:function(){return _index.functionExpression}}),Object.defineProperty(exports,"FunctionTypeAnnotation",{enumerable:!0,get:function(){return _index.functionTypeAnnotation}}),Object.defineProperty(exports,"FunctionTypeParam",{enumerable:!0,get:function(){return _index.functionTypeParam}}),Object.defineProperty(exports,"GenericTypeAnnotation",{enumerable:!0,get:function(){return _index.genericTypeAnnotation}}),Object.defineProperty(exports,"Identifier",{enumerable:!0,get:function(){return _index.identifier}}),Object.defineProperty(exports,"IfStatement",{enumerable:!0,get:function(){return _index.ifStatement}}),Object.defineProperty(exports,"Import",{enumerable:!0,get:function(){return _index.import}}),Object.defineProperty(exports,"ImportAttribute",{enumerable:!0,get:function(){return _index.importAttribute}}),Object.defineProperty(exports,"ImportDeclaration",{enumerable:!0,get:function(){return _index.importDeclaration}}),Object.defineProperty(exports,"ImportDefaultSpecifier",{enumerable:!0,get:function(){return _index.importDefaultSpecifier}}),Object.defineProperty(exports,"ImportExpression",{enumerable:!0,get:function(){return _index.importExpression}}),Object.defineProperty(exports,"ImportNamespaceSpecifier",{enumerable:!0,get:function(){return _index.importNamespaceSpecifier}}),Object.defineProperty(exports,"ImportSpecifier",{enumerable:!0,get:function(){return _index.importSpecifier}}),Object.defineProperty(exports,"IndexedAccessType",{enumerable:!0,get:function(){return _index.indexedAccessType}}),Object.defineProperty(exports,"InferredPredicate",{enumerable:!0,get:function(){return _index.inferredPredicate}}),Object.defineProperty(exports,"InterfaceDeclaration",{enumerable:!0,get:function(){return _index.interfaceDeclaration}}),Object.defineProperty(exports,"InterfaceExtends",{enumerable:!0,get:function(){return _index.interfaceExtends}}),Object.defineProperty(exports,"InterfaceTypeAnnotation",{enumerable:!0,get:function(){return _index.interfaceTypeAnnotation}}),Object.defineProperty(exports,"InterpreterDirective",{enumerable:!0,get:function(){return _index.interpreterDirective}}),Object.defineProperty(exports,"IntersectionTypeAnnotation",{enumerable:!0,get:function(){return _index.intersectionTypeAnnotation}}),Object.defineProperty(exports,"JSXAttribute",{enumerable:!0,get:function(){return _index.jsxAttribute}}),Object.defineProperty(exports,"JSXClosingElement",{enumerable:!0,get:function(){return _index.jsxClosingElement}}),Object.defineProperty(exports,"JSXClosingFragment",{enumerable:!0,get:function(){return _index.jsxClosingFragment}}),Object.defineProperty(exports,"JSXElement",{enumerable:!0,get:function(){return _index.jsxElement}}),Object.defineProperty(exports,"JSXEmptyExpression",{enumerable:!0,get:function(){return _index.jsxEmptyExpression}}),Object.defineProperty(exports,"JSXExpressionContainer",{enumerable:!0,get:function(){return _index.jsxExpressionContainer}}),Object.defineProperty(exports,"JSXFragment",{enumerable:!0,get:function(){return _index.jsxFragment}}),Object.defineProperty(exports,"JSXIdentifier",{enumerable:!0,get:function(){return _index.jsxIdentifier}}),Object.defineProperty(exports,"JSXMemberExpression",{enumerable:!0,get:function(){return _index.jsxMemberExpression}}),Object.defineProperty(exports,"JSXNamespacedName",{enumerable:!0,get:function(){return _index.jsxNamespacedName}}),Object.defineProperty(exports,"JSXOpeningElement",{enumerable:!0,get:function(){return _index.jsxOpeningElement}}),Object.defineProperty(exports,"JSXOpeningFragment",{enumerable:!0,get:function(){return _index.jsxOpeningFragment}}),Object.defineProperty(exports,"JSXSpreadAttribute",{enumerable:!0,get:function(){return _index.jsxSpreadAttribute}}),Object.defineProperty(exports,"JSXSpreadChild",{enumerable:!0,get:function(){return _index.jsxSpreadChild}}),Object.defineProperty(exports,"JSXText",{enumerable:!0,get:function(){return _index.jsxText}}),Object.defineProperty(exports,"LabeledStatement",{enumerable:!0,get:function(){return _index.labeledStatement}}),Object.defineProperty(exports,"LogicalExpression",{enumerable:!0,get:function(){return _index.logicalExpression}}),Object.defineProperty(exports,"MemberExpression",{enumerable:!0,get:function(){return _index.memberExpression}}),Object.defineProperty(exports,"MetaProperty",{enumerable:!0,get:function(){return _index.metaProperty}}),Object.defineProperty(exports,"MixedTypeAnnotation",{enumerable:!0,get:function(){return _index.mixedTypeAnnotation}}),Object.defineProperty(exports,"ModuleExpression",{enumerable:!0,get:function(){return _index.moduleExpression}}),Object.defineProperty(exports,"NewExpression",{enumerable:!0,get:function(){return _index.newExpression}}),Object.defineProperty(exports,"Noop",{enumerable:!0,get:function(){return _index.noop}}),Object.defineProperty(exports,"NullLiteral",{enumerable:!0,get:function(){return _index.nullLiteral}}),Object.defineProperty(exports,"NullLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.nullLiteralTypeAnnotation}}),Object.defineProperty(exports,"NullableTypeAnnotation",{enumerable:!0,get:function(){return _index.nullableTypeAnnotation}}),Object.defineProperty(exports,"NumberLiteral",{enumerable:!0,get:function(){return _index.numberLiteral}}),Object.defineProperty(exports,"NumberLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.numberLiteralTypeAnnotation}}),Object.defineProperty(exports,"NumberTypeAnnotation",{enumerable:!0,get:function(){return _index.numberTypeAnnotation}}),Object.defineProperty(exports,"NumericLiteral",{enumerable:!0,get:function(){return _index.numericLiteral}}),Object.defineProperty(exports,"ObjectExpression",{enumerable:!0,get:function(){return _index.objectExpression}}),Object.defineProperty(exports,"ObjectMethod",{enumerable:!0,get:function(){return _index.objectMethod}}),Object.defineProperty(exports,"ObjectPattern",{enumerable:!0,get:function(){return _index.objectPattern}}),Object.defineProperty(exports,"ObjectProperty",{enumerable:!0,get:function(){return _index.objectProperty}}),Object.defineProperty(exports,"ObjectTypeAnnotation",{enumerable:!0,get:function(){return _index.objectTypeAnnotation}}),Object.defineProperty(exports,"ObjectTypeCallProperty",{enumerable:!0,get:function(){return _index.objectTypeCallProperty}}),Object.defineProperty(exports,"ObjectTypeIndexer",{enumerable:!0,get:function(){return _index.objectTypeIndexer}}),Object.defineProperty(exports,"ObjectTypeInternalSlot",{enumerable:!0,get:function(){return _index.objectTypeInternalSlot}}),Object.defineProperty(exports,"ObjectTypeProperty",{enumerable:!0,get:function(){return _index.objectTypeProperty}}),Object.defineProperty(exports,"ObjectTypeSpreadProperty",{enumerable:!0,get:function(){return _index.objectTypeSpreadProperty}}),Object.defineProperty(exports,"OpaqueType",{enumerable:!0,get:function(){return _index.opaqueType}}),Object.defineProperty(exports,"OptionalCallExpression",{enumerable:!0,get:function(){return _index.optionalCallExpression}}),Object.defineProperty(exports,"OptionalIndexedAccessType",{enumerable:!0,get:function(){return _index.optionalIndexedAccessType}}),Object.defineProperty(exports,"OptionalMemberExpression",{enumerable:!0,get:function(){return _index.optionalMemberExpression}}),Object.defineProperty(exports,"ParenthesizedExpression",{enumerable:!0,get:function(){return _index.parenthesizedExpression}}),Object.defineProperty(exports,"PipelineBareFunction",{enumerable:!0,get:function(){return _index.pipelineBareFunction}}),Object.defineProperty(exports,"PipelinePrimaryTopicReference",{enumerable:!0,get:function(){return _index.pipelinePrimaryTopicReference}}),Object.defineProperty(exports,"PipelineTopicExpression",{enumerable:!0,get:function(){return _index.pipelineTopicExpression}}),Object.defineProperty(exports,"Placeholder",{enumerable:!0,get:function(){return _index.placeholder}}),Object.defineProperty(exports,"PrivateName",{enumerable:!0,get:function(){return _index.privateName}}),Object.defineProperty(exports,"Program",{enumerable:!0,get:function(){return _index.program}}),Object.defineProperty(exports,"QualifiedTypeIdentifier",{enumerable:!0,get:function(){return _index.qualifiedTypeIdentifier}}),Object.defineProperty(exports,"RecordExpression",{enumerable:!0,get:function(){return _index.recordExpression}}),Object.defineProperty(exports,"RegExpLiteral",{enumerable:!0,get:function(){return _index.regExpLiteral}}),Object.defineProperty(exports,"RegexLiteral",{enumerable:!0,get:function(){return _index.regexLiteral}}),Object.defineProperty(exports,"RestElement",{enumerable:!0,get:function(){return _index.restElement}}),Object.defineProperty(exports,"RestProperty",{enumerable:!0,get:function(){return _index.restProperty}}),Object.defineProperty(exports,"ReturnStatement",{enumerable:!0,get:function(){return _index.returnStatement}}),Object.defineProperty(exports,"SequenceExpression",{enumerable:!0,get:function(){return _index.sequenceExpression}}),Object.defineProperty(exports,"SpreadElement",{enumerable:!0,get:function(){return _index.spreadElement}}),Object.defineProperty(exports,"SpreadProperty",{enumerable:!0,get:function(){return _index.spreadProperty}}),Object.defineProperty(exports,"StaticBlock",{enumerable:!0,get:function(){return _index.staticBlock}}),Object.defineProperty(exports,"StringLiteral",{enumerable:!0,get:function(){return _index.stringLiteral}}),Object.defineProperty(exports,"StringLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.stringLiteralTypeAnnotation}}),Object.defineProperty(exports,"StringTypeAnnotation",{enumerable:!0,get:function(){return _index.stringTypeAnnotation}}),Object.defineProperty(exports,"Super",{enumerable:!0,get:function(){return _index.super}}),Object.defineProperty(exports,"SwitchCase",{enumerable:!0,get:function(){return _index.switchCase}}),Object.defineProperty(exports,"SwitchStatement",{enumerable:!0,get:function(){return _index.switchStatement}}),Object.defineProperty(exports,"SymbolTypeAnnotation",{enumerable:!0,get:function(){return _index.symbolTypeAnnotation}}),Object.defineProperty(exports,"TSAnyKeyword",{enumerable:!0,get:function(){return _index.tsAnyKeyword}}),Object.defineProperty(exports,"TSArrayType",{enumerable:!0,get:function(){return _index.tsArrayType}}),Object.defineProperty(exports,"TSAsExpression",{enumerable:!0,get:function(){return _index.tsAsExpression}}),Object.defineProperty(exports,"TSBigIntKeyword",{enumerable:!0,get:function(){return _index.tsBigIntKeyword}}),Object.defineProperty(exports,"TSBooleanKeyword",{enumerable:!0,get:function(){return _index.tsBooleanKeyword}}),Object.defineProperty(exports,"TSCallSignatureDeclaration",{enumerable:!0,get:function(){return _index.tsCallSignatureDeclaration}}),Object.defineProperty(exports,"TSConditionalType",{enumerable:!0,get:function(){return _index.tsConditionalType}}),Object.defineProperty(exports,"TSConstructSignatureDeclaration",{enumerable:!0,get:function(){return _index.tsConstructSignatureDeclaration}}),Object.defineProperty(exports,"TSConstructorType",{enumerable:!0,get:function(){return _index.tsConstructorType}}),Object.defineProperty(exports,"TSDeclareFunction",{enumerable:!0,get:function(){return _index.tsDeclareFunction}}),Object.defineProperty(exports,"TSDeclareMethod",{enumerable:!0,get:function(){return _index.tsDeclareMethod}}),Object.defineProperty(exports,"TSEnumDeclaration",{enumerable:!0,get:function(){return _index.tsEnumDeclaration}}),Object.defineProperty(exports,"TSEnumMember",{enumerable:!0,get:function(){return _index.tsEnumMember}}),Object.defineProperty(exports,"TSExportAssignment",{enumerable:!0,get:function(){return _index.tsExportAssignment}}),Object.defineProperty(exports,"TSExpressionWithTypeArguments",{enumerable:!0,get:function(){return _index.tsExpressionWithTypeArguments}}),Object.defineProperty(exports,"TSExternalModuleReference",{enumerable:!0,get:function(){return _index.tsExternalModuleReference}}),Object.defineProperty(exports,"TSFunctionType",{enumerable:!0,get:function(){return _index.tsFunctionType}}),Object.defineProperty(exports,"TSImportEqualsDeclaration",{enumerable:!0,get:function(){return _index.tsImportEqualsDeclaration}}),Object.defineProperty(exports,"TSImportType",{enumerable:!0,get:function(){return _index.tsImportType}}),Object.defineProperty(exports,"TSIndexSignature",{enumerable:!0,get:function(){return _index.tsIndexSignature}}),Object.defineProperty(exports,"TSIndexedAccessType",{enumerable:!0,get:function(){return _index.tsIndexedAccessType}}),Object.defineProperty(exports,"TSInferType",{enumerable:!0,get:function(){return _index.tsInferType}}),Object.defineProperty(exports,"TSInstantiationExpression",{enumerable:!0,get:function(){return _index.tsInstantiationExpression}}),Object.defineProperty(exports,"TSInterfaceBody",{enumerable:!0,get:function(){return _index.tsInterfaceBody}}),Object.defineProperty(exports,"TSInterfaceDeclaration",{enumerable:!0,get:function(){return _index.tsInterfaceDeclaration}}),Object.defineProperty(exports,"TSIntersectionType",{enumerable:!0,get:function(){return _index.tsIntersectionType}}),Object.defineProperty(exports,"TSIntrinsicKeyword",{enumerable:!0,get:function(){return _index.tsIntrinsicKeyword}}),Object.defineProperty(exports,"TSLiteralType",{enumerable:!0,get:function(){return _index.tsLiteralType}}),Object.defineProperty(exports,"TSMappedType",{enumerable:!0,get:function(){return _index.tsMappedType}}),Object.defineProperty(exports,"TSMethodSignature",{enumerable:!0,get:function(){return _index.tsMethodSignature}}),Object.defineProperty(exports,"TSModuleBlock",{enumerable:!0,get:function(){return _index.tsModuleBlock}}),Object.defineProperty(exports,"TSModuleDeclaration",{enumerable:!0,get:function(){return _index.tsModuleDeclaration}}),Object.defineProperty(exports,"TSNamedTupleMember",{enumerable:!0,get:function(){return _index.tsNamedTupleMember}}),Object.defineProperty(exports,"TSNamespaceExportDeclaration",{enumerable:!0,get:function(){return _index.tsNamespaceExportDeclaration}}),Object.defineProperty(exports,"TSNeverKeyword",{enumerable:!0,get:function(){return _index.tsNeverKeyword}}),Object.defineProperty(exports,"TSNonNullExpression",{enumerable:!0,get:function(){return _index.tsNonNullExpression}}),Object.defineProperty(exports,"TSNullKeyword",{enumerable:!0,get:function(){return _index.tsNullKeyword}}),Object.defineProperty(exports,"TSNumberKeyword",{enumerable:!0,get:function(){return _index.tsNumberKeyword}}),Object.defineProperty(exports,"TSObjectKeyword",{enumerable:!0,get:function(){return _index.tsObjectKeyword}}),Object.defineProperty(exports,"TSOptionalType",{enumerable:!0,get:function(){return _index.tsOptionalType}}),Object.defineProperty(exports,"TSParameterProperty",{enumerable:!0,get:function(){return _index.tsParameterProperty}}),Object.defineProperty(exports,"TSParenthesizedType",{enumerable:!0,get:function(){return _index.tsParenthesizedType}}),Object.defineProperty(exports,"TSPropertySignature",{enumerable:!0,get:function(){return _index.tsPropertySignature}}),Object.defineProperty(exports,"TSQualifiedName",{enumerable:!0,get:function(){return _index.tsQualifiedName}}),Object.defineProperty(exports,"TSRestType",{enumerable:!0,get:function(){return _index.tsRestType}}),Object.defineProperty(exports,"TSSatisfiesExpression",{enumerable:!0,get:function(){return _index.tsSatisfiesExpression}}),Object.defineProperty(exports,"TSStringKeyword",{enumerable:!0,get:function(){return _index.tsStringKeyword}}),Object.defineProperty(exports,"TSSymbolKeyword",{enumerable:!0,get:function(){return _index.tsSymbolKeyword}}),Object.defineProperty(exports,"TSThisType",{enumerable:!0,get:function(){return _index.tsThisType}}),Object.defineProperty(exports,"TSTupleType",{enumerable:!0,get:function(){return _index.tsTupleType}}),Object.defineProperty(exports,"TSTypeAliasDeclaration",{enumerable:!0,get:function(){return _index.tsTypeAliasDeclaration}}),Object.defineProperty(exports,"TSTypeAnnotation",{enumerable:!0,get:function(){return _index.tsTypeAnnotation}}),Object.defineProperty(exports,"TSTypeAssertion",{enumerable:!0,get:function(){return _index.tsTypeAssertion}}),Object.defineProperty(exports,"TSTypeLiteral",{enumerable:!0,get:function(){return _index.tsTypeLiteral}}),Object.defineProperty(exports,"TSTypeOperator",{enumerable:!0,get:function(){return _index.tsTypeOperator}}),Object.defineProperty(exports,"TSTypeParameter",{enumerable:!0,get:function(){return _index.tsTypeParameter}}),Object.defineProperty(exports,"TSTypeParameterDeclaration",{enumerable:!0,get:function(){return _index.tsTypeParameterDeclaration}}),Object.defineProperty(exports,"TSTypeParameterInstantiation",{enumerable:!0,get:function(){return _index.tsTypeParameterInstantiation}}),Object.defineProperty(exports,"TSTypePredicate",{enumerable:!0,get:function(){return _index.tsTypePredicate}}),Object.defineProperty(exports,"TSTypeQuery",{enumerable:!0,get:function(){return _index.tsTypeQuery}}),Object.defineProperty(exports,"TSTypeReference",{enumerable:!0,get:function(){return _index.tsTypeReference}}),Object.defineProperty(exports,"TSUndefinedKeyword",{enumerable:!0,get:function(){return _index.tsUndefinedKeyword}}),Object.defineProperty(exports,"TSUnionType",{enumerable:!0,get:function(){return _index.tsUnionType}}),Object.defineProperty(exports,"TSUnknownKeyword",{enumerable:!0,get:function(){return _index.tsUnknownKeyword}}),Object.defineProperty(exports,"TSVoidKeyword",{enumerable:!0,get:function(){return _index.tsVoidKeyword}}),Object.defineProperty(exports,"TaggedTemplateExpression",{enumerable:!0,get:function(){return _index.taggedTemplateExpression}}),Object.defineProperty(exports,"TemplateElement",{enumerable:!0,get:function(){return _index.templateElement}}),Object.defineProperty(exports,"TemplateLiteral",{enumerable:!0,get:function(){return _index.templateLiteral}}),Object.defineProperty(exports,"ThisExpression",{enumerable:!0,get:function(){return _index.thisExpression}}),Object.defineProperty(exports,"ThisTypeAnnotation",{enumerable:!0,get:function(){return _index.thisTypeAnnotation}}),Object.defineProperty(exports,"ThrowStatement",{enumerable:!0,get:function(){return _index.throwStatement}}),Object.defineProperty(exports,"TopicReference",{enumerable:!0,get:function(){return _index.topicReference}}),Object.defineProperty(exports,"TryStatement",{enumerable:!0,get:function(){return _index.tryStatement}}),Object.defineProperty(exports,"TupleExpression",{enumerable:!0,get:function(){return _index.tupleExpression}}),Object.defineProperty(exports,"TupleTypeAnnotation",{enumerable:!0,get:function(){return _index.tupleTypeAnnotation}}),Object.defineProperty(exports,"TypeAlias",{enumerable:!0,get:function(){return _index.typeAlias}}),Object.defineProperty(exports,"TypeAnnotation",{enumerable:!0,get:function(){return _index.typeAnnotation}}),Object.defineProperty(exports,"TypeCastExpression",{enumerable:!0,get:function(){return _index.typeCastExpression}}),Object.defineProperty(exports,"TypeParameter",{enumerable:!0,get:function(){return _index.typeParameter}}),Object.defineProperty(exports,"TypeParameterDeclaration",{enumerable:!0,get:function(){return _index.typeParameterDeclaration}}),Object.defineProperty(exports,"TypeParameterInstantiation",{enumerable:!0,get:function(){return _index.typeParameterInstantiation}}),Object.defineProperty(exports,"TypeofTypeAnnotation",{enumerable:!0,get:function(){return _index.typeofTypeAnnotation}}),Object.defineProperty(exports,"UnaryExpression",{enumerable:!0,get:function(){return _index.unaryExpression}}),Object.defineProperty(exports,"UnionTypeAnnotation",{enumerable:!0,get:function(){return _index.unionTypeAnnotation}}),Object.defineProperty(exports,"UpdateExpression",{enumerable:!0,get:function(){return _index.updateExpression}}),Object.defineProperty(exports,"V8IntrinsicIdentifier",{enumerable:!0,get:function(){return _index.v8IntrinsicIdentifier}}),Object.defineProperty(exports,"VariableDeclaration",{enumerable:!0,get:function(){return _index.variableDeclaration}}),Object.defineProperty(exports,"VariableDeclarator",{enumerable:!0,get:function(){return _index.variableDeclarator}}),Object.defineProperty(exports,"Variance",{enumerable:!0,get:function(){return _index.variance}}),Object.defineProperty(exports,"VoidTypeAnnotation",{enumerable:!0,get:function(){return _index.voidTypeAnnotation}}),Object.defineProperty(exports,"WhileStatement",{enumerable:!0,get:function(){return _index.whileStatement}}),Object.defineProperty(exports,"WithStatement",{enumerable:!0,get:function(){return _index.withStatement}}),Object.defineProperty(exports,"YieldExpression",{enumerable:!0,get:function(){return _index.yieldExpression}});var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/productions.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildUndefinedNode=function(){return(0,_index.unaryExpression)("void",(0,_index.numericLiteral)(0),!0)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/react/buildChildren.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){const elements=[];for(let i=0;i<node.children.length;i++){let child=node.children[i];(0,_index.isJSXText)(child)?(0,_cleanJSXElementLiteralChild.default)(child,elements):((0,_index.isJSXExpressionContainer)(child)&&(child=child.expression),(0,_index.isJSXEmptyExpression)(child)||elements.push(child))}return elements};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_cleanJSXElementLiteralChild=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/react/cleanJSXElementLiteralChild.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/typescript/createTSUnionType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(typeAnnotations){const types=typeAnnotations.map((type=>(0,_index2.isTSTypeAnnotation)(type)?type.typeAnnotation:type)),flattened=(0,_removeTypeDuplicates.default)(types);return 1===flattened.length?flattened[0]:(0,_index.tsUnionType)(flattened)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_removeTypeDuplicates=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/typescript/removeTypeDuplicates.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/clone.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node,!1)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeep.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeepWithoutLoc.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node,!0,!0)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,deep=!0,withoutLoc=!1){return cloneNodeInternal(node,deep,withoutLoc,new Map)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");const{hasOwn}={hasOwn:Function.call.bind(Object.prototype.hasOwnProperty)};function cloneIfNode(obj,deep,withoutLoc,commentsCache){return obj&&"string"==typeof obj.type?cloneNodeInternal(obj,deep,withoutLoc,commentsCache):obj}function cloneIfNodeOrArray(obj,deep,withoutLoc,commentsCache){return Array.isArray(obj)?obj.map((node=>cloneIfNode(node,deep,withoutLoc,commentsCache))):cloneIfNode(obj,deep,withoutLoc,commentsCache)}function cloneNodeInternal(node,deep=!0,withoutLoc=!1,commentsCache){if(!node)return node;const{type}=node,newNode={type:node.type};if((0,_index2.isIdentifier)(node))newNode.name=node.name,hasOwn(node,"optional")&&"boolean"==typeof node.optional&&(newNode.optional=node.optional),hasOwn(node,"typeAnnotation")&&(newNode.typeAnnotation=deep?cloneIfNodeOrArray(node.typeAnnotation,!0,withoutLoc,commentsCache):node.typeAnnotation),hasOwn(node,"decorators")&&(newNode.decorators=deep?cloneIfNodeOrArray(node.decorators,!0,withoutLoc,commentsCache):node.decorators);else{if(!hasOwn(_index.NODE_FIELDS,type))throw new Error(`Unknown node type: "${type}"`);for(const field of Object.keys(_index.NODE_FIELDS[type]))hasOwn(node,field)&&(newNode[field]=deep?(0,_index2.isFile)(node)&&"comments"===field?maybeCloneComments(node.comments,deep,withoutLoc,commentsCache):cloneIfNodeOrArray(node[field],!0,withoutLoc,commentsCache):node[field])}return hasOwn(node,"loc")&&(newNode.loc=withoutLoc?null:node.loc),hasOwn(node,"leadingComments")&&(newNode.leadingComments=maybeCloneComments(node.leadingComments,deep,withoutLoc,commentsCache)),hasOwn(node,"innerComments")&&(newNode.innerComments=maybeCloneComments(node.innerComments,deep,withoutLoc,commentsCache)),hasOwn(node,"trailingComments")&&(newNode.trailingComments=maybeCloneComments(node.trailingComments,deep,withoutLoc,commentsCache)),hasOwn(node,"extra")&&(newNode.extra=Object.assign({},node.extra)),newNode}function maybeCloneComments(comments,deep,withoutLoc,commentsCache){return comments&&deep?comments.map((comment=>{const cache=commentsCache.get(comment);if(cache)return cache;const{type,value,loc}=comment,ret={type,value,loc};return withoutLoc&&(ret.loc=null),commentsCache.set(comment,ret),ret})):comments}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneWithoutLoc.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node,!1,!0)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComment.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,type,content,line){return(0,_addComments.default)(node,type,[{type:line?"CommentLine":"CommentBlock",value:content}])};var _addComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComments.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComments.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,type,comments){if(!comments||!node)return node;const key=`${type}Comments`;node[key]?"leading"===type?node[key]=comments.concat(node[key]):node[key].push(...comments):node[key]=comments;return node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritInnerComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){(0,_inherit.default)("innerComments",child,parent)};var _inherit=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritLeadingComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){(0,_inherit.default)("leadingComments",child,parent)};var _inherit=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritTrailingComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){(0,_inherit.default)("trailingComments",child,parent)};var _inherit=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritsComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){return(0,_inheritTrailingComments.default)(child,parent),(0,_inheritLeadingComments.default)(child,parent),(0,_inheritInnerComments.default)(child,parent),child};var _inheritTrailingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritTrailingComments.js"),_inheritLeadingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritLeadingComments.js"),_inheritInnerComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritInnerComments.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/removeComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return _index.COMMENT_KEYS.forEach((key=>{node[key]=null})),node};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WHILE_TYPES=exports.USERWHITESPACABLE_TYPES=exports.UNARYLIKE_TYPES=exports.TYPESCRIPT_TYPES=exports.TSTYPE_TYPES=exports.TSTYPEELEMENT_TYPES=exports.TSENTITYNAME_TYPES=exports.TSBASETYPE_TYPES=exports.TERMINATORLESS_TYPES=exports.STATEMENT_TYPES=exports.STANDARDIZED_TYPES=exports.SCOPABLE_TYPES=exports.PUREISH_TYPES=exports.PROPERTY_TYPES=exports.PRIVATE_TYPES=exports.PATTERN_TYPES=exports.PATTERNLIKE_TYPES=exports.OBJECTMEMBER_TYPES=exports.MODULESPECIFIER_TYPES=exports.MODULEDECLARATION_TYPES=exports.MISCELLANEOUS_TYPES=exports.METHOD_TYPES=exports.LVAL_TYPES=exports.LOOP_TYPES=exports.LITERAL_TYPES=exports.JSX_TYPES=exports.IMPORTOREXPORTDECLARATION_TYPES=exports.IMMUTABLE_TYPES=exports.FUNCTION_TYPES=exports.FUNCTIONPARENT_TYPES=exports.FOR_TYPES=exports.FORXSTATEMENT_TYPES=exports.FLOW_TYPES=exports.FLOWTYPE_TYPES=exports.FLOWPREDICATE_TYPES=exports.FLOWDECLARATION_TYPES=exports.FLOWBASEANNOTATION_TYPES=exports.EXPRESSION_TYPES=exports.EXPRESSIONWRAPPER_TYPES=exports.EXPORTDECLARATION_TYPES=exports.ENUMMEMBER_TYPES=exports.ENUMBODY_TYPES=exports.DECLARATION_TYPES=exports.CONDITIONAL_TYPES=exports.COMPLETIONSTATEMENT_TYPES=exports.CLASS_TYPES=exports.BLOCK_TYPES=exports.BLOCKPARENT_TYPES=exports.BINARY_TYPES=exports.ACCESSOR_TYPES=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");exports.STANDARDIZED_TYPES=_index.FLIPPED_ALIAS_KEYS.Standardized,exports.EXPRESSION_TYPES=_index.FLIPPED_ALIAS_KEYS.Expression,exports.BINARY_TYPES=_index.FLIPPED_ALIAS_KEYS.Binary,exports.SCOPABLE_TYPES=_index.FLIPPED_ALIAS_KEYS.Scopable,exports.BLOCKPARENT_TYPES=_index.FLIPPED_ALIAS_KEYS.BlockParent,exports.BLOCK_TYPES=_index.FLIPPED_ALIAS_KEYS.Block,exports.STATEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.Statement,exports.TERMINATORLESS_TYPES=_index.FLIPPED_ALIAS_KEYS.Terminatorless,exports.COMPLETIONSTATEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.CompletionStatement,exports.CONDITIONAL_TYPES=_index.FLIPPED_ALIAS_KEYS.Conditional,exports.LOOP_TYPES=_index.FLIPPED_ALIAS_KEYS.Loop,exports.WHILE_TYPES=_index.FLIPPED_ALIAS_KEYS.While,exports.EXPRESSIONWRAPPER_TYPES=_index.FLIPPED_ALIAS_KEYS.ExpressionWrapper,exports.FOR_TYPES=_index.FLIPPED_ALIAS_KEYS.For,exports.FORXSTATEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.ForXStatement,exports.FUNCTION_TYPES=_index.FLIPPED_ALIAS_KEYS.Function,exports.FUNCTIONPARENT_TYPES=_index.FLIPPED_ALIAS_KEYS.FunctionParent,exports.PUREISH_TYPES=_index.FLIPPED_ALIAS_KEYS.Pureish,exports.DECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.Declaration,exports.PATTERNLIKE_TYPES=_index.FLIPPED_ALIAS_KEYS.PatternLike,exports.LVAL_TYPES=_index.FLIPPED_ALIAS_KEYS.LVal,exports.TSENTITYNAME_TYPES=_index.FLIPPED_ALIAS_KEYS.TSEntityName,exports.LITERAL_TYPES=_index.FLIPPED_ALIAS_KEYS.Literal,exports.IMMUTABLE_TYPES=_index.FLIPPED_ALIAS_KEYS.Immutable,exports.USERWHITESPACABLE_TYPES=_index.FLIPPED_ALIAS_KEYS.UserWhitespacable,exports.METHOD_TYPES=_index.FLIPPED_ALIAS_KEYS.Method,exports.OBJECTMEMBER_TYPES=_index.FLIPPED_ALIAS_KEYS.ObjectMember,exports.PROPERTY_TYPES=_index.FLIPPED_ALIAS_KEYS.Property,exports.UNARYLIKE_TYPES=_index.FLIPPED_ALIAS_KEYS.UnaryLike,exports.PATTERN_TYPES=_index.FLIPPED_ALIAS_KEYS.Pattern,exports.CLASS_TYPES=_index.FLIPPED_ALIAS_KEYS.Class;const IMPORTOREXPORTDECLARATION_TYPES=exports.IMPORTOREXPORTDECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.ImportOrExportDeclaration;exports.EXPORTDECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.ExportDeclaration,exports.MODULESPECIFIER_TYPES=_index.FLIPPED_ALIAS_KEYS.ModuleSpecifier,exports.ACCESSOR_TYPES=_index.FLIPPED_ALIAS_KEYS.Accessor,exports.PRIVATE_TYPES=_index.FLIPPED_ALIAS_KEYS.Private,exports.FLOW_TYPES=_index.FLIPPED_ALIAS_KEYS.Flow,exports.FLOWTYPE_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowType,exports.FLOWBASEANNOTATION_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowBaseAnnotation,exports.FLOWDECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowDeclaration,exports.FLOWPREDICATE_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowPredicate,exports.ENUMBODY_TYPES=_index.FLIPPED_ALIAS_KEYS.EnumBody,exports.ENUMMEMBER_TYPES=_index.FLIPPED_ALIAS_KEYS.EnumMember,exports.JSX_TYPES=_index.FLIPPED_ALIAS_KEYS.JSX,exports.MISCELLANEOUS_TYPES=_index.FLIPPED_ALIAS_KEYS.Miscellaneous,exports.TYPESCRIPT_TYPES=_index.FLIPPED_ALIAS_KEYS.TypeScript,exports.TSTYPEELEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.TSTypeElement,exports.TSTYPE_TYPES=_index.FLIPPED_ALIAS_KEYS.TSType,exports.TSBASETYPE_TYPES=_index.FLIPPED_ALIAS_KEYS.TSBaseType,exports.MODULEDECLARATION_TYPES=IMPORTOREXPORTDECLARATION_TYPES},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UPDATE_OPERATORS=exports.UNARY_OPERATORS=exports.STRING_UNARY_OPERATORS=exports.STATEMENT_OR_BLOCK_KEYS=exports.NUMBER_UNARY_OPERATORS=exports.NUMBER_BINARY_OPERATORS=exports.NOT_LOCAL_BINDING=exports.LOGICAL_OPERATORS=exports.INHERIT_KEYS=exports.FOR_INIT_KEYS=exports.FLATTENABLE_KEYS=exports.EQUALITY_BINARY_OPERATORS=exports.COMPARISON_BINARY_OPERATORS=exports.COMMENT_KEYS=exports.BOOLEAN_UNARY_OPERATORS=exports.BOOLEAN_NUMBER_BINARY_OPERATORS=exports.BOOLEAN_BINARY_OPERATORS=exports.BLOCK_SCOPED_SYMBOL=exports.BINARY_OPERATORS=exports.ASSIGNMENT_OPERATORS=void 0;exports.STATEMENT_OR_BLOCK_KEYS=["consequent","body","alternate"],exports.FLATTENABLE_KEYS=["body","expressions"],exports.FOR_INIT_KEYS=["left","init"],exports.COMMENT_KEYS=["leadingComments","trailingComments","innerComments"];const LOGICAL_OPERATORS=exports.LOGICAL_OPERATORS=["||","&&","??"],BOOLEAN_NUMBER_BINARY_OPERATORS=(exports.UPDATE_OPERATORS=["++","--"],exports.BOOLEAN_NUMBER_BINARY_OPERATORS=[">","<",">=","<="]),EQUALITY_BINARY_OPERATORS=exports.EQUALITY_BINARY_OPERATORS=["==","===","!=","!=="],COMPARISON_BINARY_OPERATORS=exports.COMPARISON_BINARY_OPERATORS=[...EQUALITY_BINARY_OPERATORS,"in","instanceof"],BOOLEAN_BINARY_OPERATORS=exports.BOOLEAN_BINARY_OPERATORS=[...COMPARISON_BINARY_OPERATORS,...BOOLEAN_NUMBER_BINARY_OPERATORS],NUMBER_BINARY_OPERATORS=exports.NUMBER_BINARY_OPERATORS=["-","/","%","*","**","&","|",">>",">>>","<<","^"],BOOLEAN_UNARY_OPERATORS=(exports.BINARY_OPERATORS=["+",...NUMBER_BINARY_OPERATORS,...BOOLEAN_BINARY_OPERATORS,"|>"],exports.ASSIGNMENT_OPERATORS=["=","+=",...NUMBER_BINARY_OPERATORS.map((op=>op+"=")),...LOGICAL_OPERATORS.map((op=>op+"="))],exports.BOOLEAN_UNARY_OPERATORS=["delete","!"]),NUMBER_UNARY_OPERATORS=exports.NUMBER_UNARY_OPERATORS=["+","-","~"],STRING_UNARY_OPERATORS=exports.STRING_UNARY_OPERATORS=["typeof"];exports.UNARY_OPERATORS=["void","throw",...BOOLEAN_UNARY_OPERATORS,...NUMBER_UNARY_OPERATORS,...STRING_UNARY_OPERATORS],exports.INHERIT_KEYS={optional:["typeAnnotation","typeParameters","returnType"],force:["start","loc","end"]},exports.BLOCK_SCOPED_SYMBOL=Symbol.for("var used to be block scoped"),exports.NOT_LOCAL_BINDING=Symbol.for("should not be considered a local binding")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/ensureBlock.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,key="body"){const result=(0,_toBlock.default)(node[key],node);return node[key]=result,result};var _toBlock=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBlock.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/gatherSequenceExpressions.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function gatherSequenceExpressions(nodes,declars){const exprs=[];let ensureLastUndefined=!0;for(const node of nodes)if((0,_index.isEmptyStatement)(node)||(ensureLastUndefined=!1),(0,_index.isExpression)(node))exprs.push(node);else if((0,_index.isExpressionStatement)(node))exprs.push(node.expression);else if((0,_index.isVariableDeclaration)(node)){if("var"!==node.kind)return;for(const declar of node.declarations){const bindings=(0,_getBindingIdentifiers.default)(declar);for(const key of Object.keys(bindings))declars.push({kind:node.kind,id:(0,_cloneNode.default)(bindings[key])});declar.init&&exprs.push((0,_index2.assignmentExpression)("=",declar.id,declar.init))}ensureLastUndefined=!0}else if((0,_index.isIfStatement)(node)){const consequent=node.consequent?gatherSequenceExpressions([node.consequent],declars):(0,_productions.buildUndefinedNode)(),alternate=node.alternate?gatherSequenceExpressions([node.alternate],declars):(0,_productions.buildUndefinedNode)();if(!consequent||!alternate)return;exprs.push((0,_index2.conditionalExpression)(node.test,consequent,alternate))}else if((0,_index.isBlockStatement)(node)){const body=gatherSequenceExpressions(node.body,declars);if(!body)return;exprs.push(body)}else{if(!(0,_index.isEmptyStatement)(node))return;0===nodes.indexOf(node)&&(ensureLastUndefined=!0)}ensureLastUndefined&&exprs.push((0,_productions.buildUndefinedNode)());return 1===exprs.length?exprs[0]:(0,_index2.sequenceExpression)(exprs)};var _getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_productions=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/productions.js"),_cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBindingIdentifierName.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(name){"eval"!==(name=(0,_toIdentifier.default)(name))&&"arguments"!==name||(name="_"+name);return name};var _toIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toIdentifier.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBlock.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent){if((0,_index.isBlockStatement)(node))return node;let blockNodes=[];(0,_index.isEmptyStatement)(node)?blockNodes=[]:((0,_index.isStatement)(node)||(node=(0,_index.isFunction)(parent)?(0,_index2.returnStatement)(node):(0,_index2.expressionStatement)(node)),blockNodes=[node]);return(0,_index2.blockStatement)(blockNodes)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toComputedKey.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,key=node.key||node.property){!node.computed&&(0,_index.isIdentifier)(key)&&(key=(0,_index2.stringLiteral)(key.name));return key};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");exports.default=function(node){(0,_index.isExpressionStatement)(node)&&(node=node.expression);if((0,_index.isExpression)(node))return node;(0,_index.isClass)(node)?node.type="ClassExpression":(0,_index.isFunction)(node)&&(node.type="FunctionExpression");if(!(0,_index.isExpression)(node))throw new Error(`cannot turn ${node.type} to an expression`);return node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toIdentifier.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(input){input+="";let name="";for(const c of input)name+=(0,_helperValidatorIdentifier.isIdentifierChar)(c.codePointAt(0))?c:"-";name=name.replace(/^[-0-9]+/,""),name=name.replace(/[-\s]+(.)?/g,(function(match,c){return c?c.toUpperCase():""})),(0,_isValidIdentifier.default)(name)||(name=`_${name}`);return name||"_"};var _isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_helperValidatorIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-identifier@7.25.9/node_modules/@babel/helper-validator-identifier/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toKeyAlias.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=toKeyAlias;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js"),_removePropertiesDeep=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removePropertiesDeep.js");function toKeyAlias(node,key=node.key){let alias;return"method"===node.kind?toKeyAlias.increment()+"":(alias=(0,_index.isIdentifier)(key)?key.name:(0,_index.isStringLiteral)(key)?JSON.stringify(key.value):JSON.stringify((0,_removePropertiesDeep.default)((0,_cloneNode.default)(key))),node.computed&&(alias=`[${alias}]`),node.static&&(alias=`static:${alias}`),alias)}toKeyAlias.uid=0,toKeyAlias.increment=function(){return toKeyAlias.uid>=Number.MAX_SAFE_INTEGER?toKeyAlias.uid=0:toKeyAlias.uid++}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toSequenceExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";exports.default=function(nodes,scope){if(null==nodes||!nodes.length)return;const declars=[],result=(0,_gatherSequenceExpressions.default)(nodes,declars);if(!result)return;for(const declar of declars)scope.push(declar);return result};var _gatherSequenceExpressions=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/gatherSequenceExpressions.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toStatement.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");exports.default=function(node,ignore){if((0,_index.isStatement)(node))return node;let newType,mustHaveId=!1;if((0,_index.isClass)(node))mustHaveId=!0,newType="ClassDeclaration";else if((0,_index.isFunction)(node))mustHaveId=!0,newType="FunctionDeclaration";else if((0,_index.isAssignmentExpression)(node))return(0,_index2.expressionStatement)(node);mustHaveId&&!node.id&&(newType=!1);if(!newType){if(ignore)return!1;throw new Error(`cannot turn ${node.type} to a statement`)}return node.type=newType,node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/valueToNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");exports.default=function valueToNode(value){if(void 0===value)return(0,_index.identifier)("undefined");if(!0===value||!1===value)return(0,_index.booleanLiteral)(value);if(null===value)return(0,_index.nullLiteral)();if("string"==typeof value)return(0,_index.stringLiteral)(value);if("number"==typeof value){let result;if(Number.isFinite(value))result=(0,_index.numericLiteral)(Math.abs(value));else{let numerator;numerator=Number.isNaN(value)?(0,_index.numericLiteral)(0):(0,_index.numericLiteral)(1),result=(0,_index.binaryExpression)("/",numerator,(0,_index.numericLiteral)(0))}return(value<0||Object.is(value,-0))&&(result=(0,_index.unaryExpression)("-",result)),result}if(function(value){return"[object RegExp]"===objectToString(value)}(value)){const pattern=value.source,flags=/\/([a-z]*)$/.exec(value.toString())[1];return(0,_index.regExpLiteral)(pattern,flags)}if(Array.isArray(value))return(0,_index.arrayExpression)(value.map(valueToNode));if(function(value){if("object"!=typeof value||null===value||"[object Object]"!==Object.prototype.toString.call(value))return!1;const proto=Object.getPrototypeOf(value);return null===proto||null===Object.getPrototypeOf(proto)}(value)){const props=[];for(const key of Object.keys(value)){let nodeKey;nodeKey=(0,_isValidIdentifier.default)(key)?(0,_index.identifier)(key):(0,_index.stringLiteral)(key),props.push((0,_index.objectProperty)(nodeKey,valueToNode(value[key])))}return(0,_index.objectExpression)(props)}throw new Error("don't know how to turn this value into a node")};const objectToString=Function.call.bind(Object.prototype.toString)},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.patternLikeCommon=exports.importAttributes=exports.functionTypeAnnotationCommon=exports.functionDeclarationCommon=exports.functionCommon=exports.classMethodOrPropertyCommon=exports.classMethodOrDeclareMethodCommon=void 0;var _is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_helperValidatorIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-identifier@7.25.9/node_modules/@babel/helper-validator-identifier/lib/index.js"),_helperStringParser=__webpack_require__("./node_modules/.pnpm/@babel+helper-string-parser@7.25.9/node_modules/@babel/helper-string-parser/lib/index.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js"),_utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const defineType=(0,_utils.defineAliasedType)("Standardized");defineType("ArrayExpression",{fields:{elements:{validate:(0,_utils.arrayOf)((0,_utils.assertNodeOrValueType)("null","Expression","SpreadElement")),default:process.env.BABEL_TYPES_8_BREAKING?void 0:[]}},visitor:["elements"],aliases:["Expression"]}),defineType("AssignmentExpression",{fields:{operator:{validate:process.env.BABEL_TYPES_8_BREAKING?Object.assign(function(){const identifier=(0,_utils.assertOneOf)(..._index.ASSIGNMENT_OPERATORS),pattern=(0,_utils.assertOneOf)("=");return function(node,key,val){((0,_is.default)("Pattern",node.left)?pattern:identifier)(node,key,val)}}(),{type:"string"}):(0,_utils.assertValueType)("string")},left:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","MemberExpression","OptionalMemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"):(0,_utils.assertNodeType)("LVal","OptionalMemberExpression")},right:{validate:(0,_utils.assertNodeType)("Expression")}},builder:["operator","left","right"],visitor:["left","right"],aliases:["Expression"]}),defineType("BinaryExpression",{builder:["operator","left","right"],fields:{operator:{validate:(0,_utils.assertOneOf)(..._index.BINARY_OPERATORS)},left:{validate:function(){const expression=(0,_utils.assertNodeType)("Expression"),inOp=(0,_utils.assertNodeType)("Expression","PrivateName");return Object.assign((function(node,key,val){("in"===node.operator?inOp:expression)(node,key,val)}),{oneOfNodeTypes:["Expression","PrivateName"]})}()},right:{validate:(0,_utils.assertNodeType)("Expression")}},visitor:["left","right"],aliases:["Binary","Expression"]}),defineType("InterpreterDirective",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}}}),defineType("Directive",{visitor:["value"],fields:{value:{validate:(0,_utils.assertNodeType)("DirectiveLiteral")}}}),defineType("DirectiveLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}}}),defineType("BlockStatement",{builder:["body","directives"],visitor:["directives","body"],fields:{directives:{validate:(0,_utils.arrayOfType)("Directive"),default:[]},body:(0,_utils.validateArrayOfType)("Statement")},aliases:["Scopable","BlockParent","Block","Statement"]}),defineType("BreakStatement",{visitor:["label"],fields:{label:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0}},aliases:["Statement","Terminatorless","CompletionStatement"]}),defineType("CallExpression",{visitor:["callee","arguments","typeParameters","typeArguments"],builder:["callee","arguments"],aliases:["Expression"],fields:Object.assign({callee:{validate:(0,_utils.assertNodeType)("Expression","Super","V8IntrinsicIdentifier")},arguments:(0,_utils.validateArrayOfType)("Expression","SpreadElement","ArgumentPlaceholder")},process.env.BABEL_TYPES_8_BREAKING?{}:{optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}},{typeArguments:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TSTypeParameterInstantiation"),optional:!0}})}),defineType("CatchClause",{visitor:["param","body"],fields:{param:{validate:(0,_utils.assertNodeType)("Identifier","ArrayPattern","ObjectPattern"),optional:!0},body:{validate:(0,_utils.assertNodeType)("BlockStatement")}},aliases:["Scopable","BlockParent"]}),defineType("ConditionalExpression",{visitor:["test","consequent","alternate"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},consequent:{validate:(0,_utils.assertNodeType)("Expression")},alternate:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Expression","Conditional"]}),defineType("ContinueStatement",{visitor:["label"],fields:{label:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0}},aliases:["Statement","Terminatorless","CompletionStatement"]}),defineType("DebuggerStatement",{aliases:["Statement"]}),defineType("DoWhileStatement",{builder:["test","body"],visitor:["body","test"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}},aliases:["Statement","BlockParent","Loop","While","Scopable"]}),defineType("EmptyStatement",{aliases:["Statement"]}),defineType("ExpressionStatement",{visitor:["expression"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Statement","ExpressionWrapper"]}),defineType("File",{builder:["program","comments","tokens"],visitor:["program"],fields:{program:{validate:(0,_utils.assertNodeType)("Program")},comments:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertEach)((0,_utils.assertNodeType)("CommentBlock","CommentLine")):Object.assign((()=>{}),{each:{oneOfNodeTypes:["CommentBlock","CommentLine"]}}),optional:!0},tokens:{validate:(0,_utils.assertEach)(Object.assign((()=>{}),{type:"any"})),optional:!0}}}),defineType("ForInStatement",{visitor:["left","right","body"],aliases:["Scopable","Statement","For","BlockParent","Loop","ForXStatement"],fields:{left:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("VariableDeclaration","Identifier","MemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"):(0,_utils.assertNodeType)("VariableDeclaration","LVal")},right:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("ForStatement",{visitor:["init","test","update","body"],aliases:["Scopable","Statement","For","BlockParent","Loop"],fields:{init:{validate:(0,_utils.assertNodeType)("VariableDeclaration","Expression"),optional:!0},test:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},update:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},body:{validate:(0,_utils.assertNodeType)("Statement")}}});const functionCommon=()=>({params:(0,_utils.validateArrayOfType)("Identifier","Pattern","RestElement"),generator:{default:!1},async:{default:!1}});exports.functionCommon=functionCommon;const functionTypeAnnotationCommon=()=>({returnType:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterDeclaration","TSTypeParameterDeclaration","Noop"),optional:!0}});exports.functionTypeAnnotationCommon=functionTypeAnnotationCommon;const functionDeclarationCommon=()=>Object.assign({},functionCommon(),{declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0}});exports.functionDeclarationCommon=functionDeclarationCommon,defineType("FunctionDeclaration",{builder:["id","params","body","generator","async"],visitor:["id","typeParameters","params","returnType","body"],fields:Object.assign({},functionDeclarationCommon(),functionTypeAnnotationCommon(),{body:{validate:(0,_utils.assertNodeType)("BlockStatement")},predicate:{validate:(0,_utils.assertNodeType)("DeclaredPredicate","InferredPredicate"),optional:!0}}),aliases:["Scopable","Function","BlockParent","FunctionParent","Statement","Pureish","Declaration"],validate:process.env.BABEL_TYPES_8_BREAKING?function(){const identifier=(0,_utils.assertNodeType)("Identifier");return function(parent,key,node){(0,_is.default)("ExportDefaultDeclaration",parent)||identifier(node,"id",node.id)}}():void 0}),defineType("FunctionExpression",{inherits:"FunctionDeclaration",aliases:["Scopable","Function","BlockParent","FunctionParent","Expression","Pureish"],fields:Object.assign({},functionCommon(),functionTypeAnnotationCommon(),{id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0},body:{validate:(0,_utils.assertNodeType)("BlockStatement")},predicate:{validate:(0,_utils.assertNodeType)("DeclaredPredicate","InferredPredicate"),optional:!0}})});const patternLikeCommon=()=>({typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}});exports.patternLikeCommon=patternLikeCommon,defineType("Identifier",{builder:["name"],visitor:["typeAnnotation","decorators"],aliases:["Expression","PatternLike","LVal","TSEntityName"],fields:Object.assign({},patternLikeCommon(),{name:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("string"),Object.assign((function(node,key,val){if(!(0,_isValidIdentifier.default)(val,!1))throw new TypeError(`"${val}" is not a valid identifier name`)}),{type:"string"})):(0,_utils.assertValueType)("string")}}),validate:process.env.BABEL_TYPES_8_BREAKING?function(parent,key,node){const match=/\.(\w+)$/.exec(key);if(!match)return;const[,parentKey]=match,nonComp={computed:!1};if("property"===parentKey){if((0,_is.default)("MemberExpression",parent,nonComp))return;if((0,_is.default)("OptionalMemberExpression",parent,nonComp))return}else if("key"===parentKey){if((0,_is.default)("Property",parent,nonComp))return;if((0,_is.default)("Method",parent,nonComp))return}else if("exported"===parentKey){if((0,_is.default)("ExportSpecifier",parent))return}else if("imported"===parentKey){if((0,_is.default)("ImportSpecifier",parent,{imported:node}))return}else if("meta"===parentKey&&(0,_is.default)("MetaProperty",parent,{meta:node}))return;if(((0,_helperValidatorIdentifier.isKeyword)(node.name)||(0,_helperValidatorIdentifier.isReservedWord)(node.name,!1))&&"this"!==node.name)throw new TypeError(`"${node.name}" is not a valid identifier`)}:void 0}),defineType("IfStatement",{visitor:["test","consequent","alternate"],aliases:["Statement","Conditional"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},consequent:{validate:(0,_utils.assertNodeType)("Statement")},alternate:{optional:!0,validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("LabeledStatement",{visitor:["label","body"],aliases:["Statement"],fields:{label:{validate:(0,_utils.assertNodeType)("Identifier")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("StringLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("NumericLiteral",{builder:["value"],deprecatedAlias:"NumberLiteral",fields:{value:{validate:(0,_utils.chain)((0,_utils.assertValueType)("number"),Object.assign((function(node,key,val){if(1/val<0||!Number.isFinite(val)){new Error(`NumericLiterals must be non-negative finite numbers. You can use t.valueToNode(${val}) instead.`)}}),{type:"number"}))}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("NullLiteral",{aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("BooleanLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("boolean")}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("RegExpLiteral",{builder:["pattern","flags"],deprecatedAlias:"RegexLiteral",aliases:["Expression","Pureish","Literal"],fields:{pattern:{validate:(0,_utils.assertValueType)("string")},flags:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("string"),Object.assign((function(node,key,val){const invalid=/[^gimsuy]/.exec(val);if(invalid)throw new TypeError(`"${invalid[0]}" is not a valid RegExp flag`)}),{type:"string"})):(0,_utils.assertValueType)("string"),default:""}}}),defineType("LogicalExpression",{builder:["operator","left","right"],visitor:["left","right"],aliases:["Binary","Expression"],fields:{operator:{validate:(0,_utils.assertOneOf)(..._index.LOGICAL_OPERATORS)},left:{validate:(0,_utils.assertNodeType)("Expression")},right:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("MemberExpression",{builder:["object","property","computed",...process.env.BABEL_TYPES_8_BREAKING?[]:["optional"]],visitor:["object","property"],aliases:["Expression","LVal"],fields:Object.assign({object:{validate:(0,_utils.assertNodeType)("Expression","Super")},property:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier","PrivateName"),computed=(0,_utils.assertNodeType)("Expression"),validator=function(node,key,val){(node.computed?computed:normal)(node,key,val)};return validator.oneOfNodeTypes=["Expression","Identifier","PrivateName"],validator}()},computed:{default:!1}},process.env.BABEL_TYPES_8_BREAKING?{}:{optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}})}),defineType("NewExpression",{inherits:"CallExpression"}),defineType("Program",{visitor:["directives","body"],builder:["body","directives","sourceType","interpreter"],fields:{sourceType:{validate:(0,_utils.assertOneOf)("script","module"),default:"script"},interpreter:{validate:(0,_utils.assertNodeType)("InterpreterDirective"),default:null,optional:!0},directives:{validate:(0,_utils.arrayOfType)("Directive"),default:[]},body:(0,_utils.validateArrayOfType)("Statement")},aliases:["Scopable","BlockParent","Block"]}),defineType("ObjectExpression",{visitor:["properties"],aliases:["Expression"],fields:{properties:(0,_utils.validateArrayOfType)("ObjectMethod","ObjectProperty","SpreadElement")}}),defineType("ObjectMethod",{builder:["kind","key","params","body","computed","generator","async"],visitor:["decorators","key","typeParameters","params","returnType","body"],fields:Object.assign({},functionCommon(),functionTypeAnnotationCommon(),{kind:Object.assign({validate:(0,_utils.assertOneOf)("method","get","set")},process.env.BABEL_TYPES_8_BREAKING?{}:{default:"method"}),computed:{default:!1},key:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral"),computed=(0,_utils.assertNodeType)("Expression"),validator=function(node,key,val){(node.computed?computed:normal)(node,key,val)};return validator.oneOfNodeTypes=["Expression","Identifier","StringLiteral","NumericLiteral","BigIntLiteral"],validator}()},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},body:{validate:(0,_utils.assertNodeType)("BlockStatement")}}),aliases:["UserWhitespacable","Function","Scopable","BlockParent","FunctionParent","Method","ObjectMember"]}),defineType("ObjectProperty",{builder:["key","value","computed","shorthand",...process.env.BABEL_TYPES_8_BREAKING?[]:["decorators"]],fields:{computed:{default:!1},key:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","DecimalLiteral","PrivateName"),computed=(0,_utils.assertNodeType)("Expression");return Object.assign((function(node,key,val){(node.computed?computed:normal)(node,key,val)}),{oneOfNodeTypes:["Expression","Identifier","StringLiteral","NumericLiteral","BigIntLiteral","DecimalLiteral","PrivateName"]})}()},value:{validate:(0,_utils.assertNodeType)("Expression","PatternLike")},shorthand:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),Object.assign((function(node,key,shorthand){if(shorthand){if(node.computed)throw new TypeError("Property shorthand of ObjectProperty cannot be true if computed is true");if(!(0,_is.default)("Identifier",node.key))throw new TypeError("Property shorthand of ObjectProperty cannot be true if key is not an Identifier")}}),{type:"boolean"})):(0,_utils.assertValueType)("boolean"),default:!1},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}},visitor:["key","value","decorators"],aliases:["UserWhitespacable","Property","ObjectMember"],validate:process.env.BABEL_TYPES_8_BREAKING?function(){const pattern=(0,_utils.assertNodeType)("Identifier","Pattern","TSAsExpression","TSSatisfiesExpression","TSNonNullExpression","TSTypeAssertion"),expression=(0,_utils.assertNodeType)("Expression");return function(parent,key,node){((0,_is.default)("ObjectPattern",parent)?pattern:expression)(node,"value",node.value)}}():void 0}),defineType("RestElement",{visitor:["argument","typeAnnotation"],builder:["argument"],aliases:["LVal","PatternLike"],deprecatedAlias:"RestProperty",fields:Object.assign({},patternLikeCommon(),{argument:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","ArrayPattern","ObjectPattern","MemberExpression","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"):(0,_utils.assertNodeType)("LVal")}}),validate:process.env.BABEL_TYPES_8_BREAKING?function(parent,key){const match=/(\w+)\[(\d+)\]/.exec(key);if(!match)throw new Error("Internal Babel error: malformed key.");const[,listKey,index]=match;if(parent[listKey].length>+index+1)throw new TypeError(`RestElement must be last element of ${listKey}`)}:void 0}),defineType("ReturnStatement",{visitor:["argument"],aliases:["Statement","Terminatorless","CompletionStatement"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0}}}),defineType("SequenceExpression",{visitor:["expressions"],fields:{expressions:(0,_utils.validateArrayOfType)("Expression")},aliases:["Expression"]}),defineType("ParenthesizedExpression",{visitor:["expression"],aliases:["Expression","ExpressionWrapper"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("SwitchCase",{visitor:["test","consequent"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},consequent:(0,_utils.validateArrayOfType)("Statement")}}),defineType("SwitchStatement",{visitor:["discriminant","cases"],aliases:["Statement","BlockParent","Scopable"],fields:{discriminant:{validate:(0,_utils.assertNodeType)("Expression")},cases:(0,_utils.validateArrayOfType)("SwitchCase")}}),defineType("ThisExpression",{aliases:["Expression"]}),defineType("ThrowStatement",{visitor:["argument"],aliases:["Statement","Terminatorless","CompletionStatement"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("TryStatement",{visitor:["block","handler","finalizer"],aliases:["Statement"],fields:{block:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertNodeType)("BlockStatement"),Object.assign((function(node){if(!node.handler&&!node.finalizer)throw new TypeError("TryStatement expects either a handler or finalizer, or both")}),{oneOfNodeTypes:["BlockStatement"]})):(0,_utils.assertNodeType)("BlockStatement")},handler:{optional:!0,validate:(0,_utils.assertNodeType)("CatchClause")},finalizer:{optional:!0,validate:(0,_utils.assertNodeType)("BlockStatement")}}}),defineType("UnaryExpression",{builder:["operator","argument","prefix"],fields:{prefix:{default:!0},argument:{validate:(0,_utils.assertNodeType)("Expression")},operator:{validate:(0,_utils.assertOneOf)(..._index.UNARY_OPERATORS)}},visitor:["argument"],aliases:["UnaryLike","Expression"]}),defineType("UpdateExpression",{builder:["operator","argument","prefix"],fields:{prefix:{default:!1},argument:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","MemberExpression"):(0,_utils.assertNodeType)("Expression")},operator:{validate:(0,_utils.assertOneOf)(..._index.UPDATE_OPERATORS)}},visitor:["argument"],aliases:["Expression"]}),defineType("VariableDeclaration",{builder:["kind","declarations"],visitor:["declarations"],aliases:["Statement","Declaration"],fields:{declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},kind:{validate:(0,_utils.assertOneOf)("var","let","const","using","await using")},declarations:(0,_utils.validateArrayOfType)("VariableDeclarator")},validate:process.env.BABEL_TYPES_8_BREAKING?(()=>{const withoutInit=(0,_utils.assertNodeType)("Identifier");return function(parent,key,node){if((0,_is.default)("ForXStatement",parent,{left:node})){if(1!==node.declarations.length)throw new TypeError(`Exactly one VariableDeclarator is required in the VariableDeclaration of a ${parent.type}`)}else node.declarations.forEach((decl=>{decl.init||withoutInit(decl,"id",decl.id)}))}})():void 0}),defineType("VariableDeclarator",{visitor:["id","init"],fields:{id:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","ArrayPattern","ObjectPattern"):(0,_utils.assertNodeType)("LVal")},definite:{optional:!0,validate:(0,_utils.assertValueType)("boolean")},init:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("WhileStatement",{visitor:["test","body"],aliases:["Statement","BlockParent","Loop","While","Scopable"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("WithStatement",{visitor:["object","body"],aliases:["Statement"],fields:{object:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("AssignmentPattern",{visitor:["left","right","decorators"],builder:["left","right"],aliases:["Pattern","PatternLike","LVal"],fields:Object.assign({},patternLikeCommon(),{left:{validate:(0,_utils.assertNodeType)("Identifier","ObjectPattern","ArrayPattern","MemberExpression","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression")},right:{validate:(0,_utils.assertNodeType)("Expression")},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}})}),defineType("ArrayPattern",{visitor:["elements","typeAnnotation"],builder:["elements"],aliases:["Pattern","PatternLike","LVal"],fields:Object.assign({},patternLikeCommon(),{elements:{validate:(0,_utils.chain)((0,_utils.assertValueType)("array"),(0,_utils.assertEach)((0,_utils.assertNodeOrValueType)("null","PatternLike","LVal")))}})}),defineType("ArrowFunctionExpression",{builder:["params","body","async"],visitor:["typeParameters","params","returnType","body"],aliases:["Scopable","Function","BlockParent","FunctionParent","Expression","Pureish"],fields:Object.assign({},functionCommon(),functionTypeAnnotationCommon(),{expression:{validate:(0,_utils.assertValueType)("boolean")},body:{validate:(0,_utils.assertNodeType)("BlockStatement","Expression")},predicate:{validate:(0,_utils.assertNodeType)("DeclaredPredicate","InferredPredicate"),optional:!0}})}),defineType("ClassBody",{visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("ClassMethod","ClassPrivateMethod","ClassProperty","ClassPrivateProperty","ClassAccessorProperty","TSDeclareMethod","TSIndexSignature","StaticBlock")}}),defineType("ClassExpression",{builder:["id","superClass","body","decorators"],visitor:["decorators","id","typeParameters","superClass","superTypeParameters","mixins","implements","body"],aliases:["Scopable","Class","Expression"],fields:{id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterDeclaration","TSTypeParameterDeclaration","Noop"),optional:!0},body:{validate:(0,_utils.assertNodeType)("ClassBody")},superClass:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")},superTypeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0},implements:{validate:(0,_utils.arrayOfType)("TSExpressionWithTypeArguments","ClassImplements"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},mixins:{validate:(0,_utils.assertNodeType)("InterfaceExtends"),optional:!0}}}),defineType("ClassDeclaration",{inherits:"ClassExpression",aliases:["Scopable","Class","Statement","Declaration"],fields:{id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterDeclaration","TSTypeParameterDeclaration","Noop"),optional:!0},body:{validate:(0,_utils.assertNodeType)("ClassBody")},superClass:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")},superTypeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0},implements:{validate:(0,_utils.arrayOfType)("TSExpressionWithTypeArguments","ClassImplements"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},mixins:{validate:(0,_utils.assertNodeType)("InterfaceExtends"),optional:!0},declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},abstract:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}},validate:process.env.BABEL_TYPES_8_BREAKING?function(){const identifier=(0,_utils.assertNodeType)("Identifier");return function(parent,key,node){(0,_is.default)("ExportDefaultDeclaration",parent)||identifier(node,"id",node.id)}}():void 0});const importAttributes=exports.importAttributes={attributes:{optional:!0,validate:(0,_utils.arrayOfType)("ImportAttribute")},assertions:{deprecated:!0,optional:!0,validate:(0,_utils.arrayOfType)("ImportAttribute")}};defineType("ExportAllDeclaration",{builder:["source"],visitor:["source","attributes","assertions"],aliases:["Statement","Declaration","ImportOrExportDeclaration","ExportDeclaration"],fields:Object.assign({source:{validate:(0,_utils.assertNodeType)("StringLiteral")},exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("type","value"))},importAttributes)}),defineType("ExportDefaultDeclaration",{visitor:["declaration"],aliases:["Statement","Declaration","ImportOrExportDeclaration","ExportDeclaration"],fields:{declaration:(0,_utils.validateType)("TSDeclareFunction","FunctionDeclaration","ClassDeclaration","Expression"),exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("value"))}}),defineType("ExportNamedDeclaration",{builder:["declaration","specifiers","source"],visitor:process.env?["declaration","specifiers","source","attributes"]:["declaration","specifiers","source","attributes","assertions"],aliases:["Statement","Declaration","ImportOrExportDeclaration","ExportDeclaration"],fields:Object.assign({declaration:{optional:!0,validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertNodeType)("Declaration"),Object.assign((function(node,key,val){if(val&&node.specifiers.length)throw new TypeError("Only declaration or specifiers is allowed on ExportNamedDeclaration");if(val&&node.source)throw new TypeError("Cannot export a declaration from a source")}),{oneOfNodeTypes:["Declaration"]})):(0,_utils.assertNodeType)("Declaration")}},importAttributes,{specifiers:{default:[],validate:(0,_utils.arrayOf)(function(){const sourced=(0,_utils.assertNodeType)("ExportSpecifier","ExportDefaultSpecifier","ExportNamespaceSpecifier"),sourceless=(0,_utils.assertNodeType)("ExportSpecifier");return process.env.BABEL_TYPES_8_BREAKING?Object.assign((function(node,key,val){(node.source?sourced:sourceless)(node,key,val)}),{oneOfNodeTypes:["ExportSpecifier","ExportDefaultSpecifier","ExportNamespaceSpecifier"]}):sourced}())},source:{validate:(0,_utils.assertNodeType)("StringLiteral"),optional:!0},exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("type","value"))})}),defineType("ExportSpecifier",{visitor:["local","exported"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")},exported:{validate:(0,_utils.assertNodeType)("Identifier","StringLiteral")},exportKind:{validate:(0,_utils.assertOneOf)("type","value"),optional:!0}}}),defineType("ForOfStatement",{visitor:["left","right","body"],builder:["left","right","body","await"],aliases:["Scopable","Statement","For","BlockParent","Loop","ForXStatement"],fields:{left:{validate:function(){if(!process.env.BABEL_TYPES_8_BREAKING)return(0,_utils.assertNodeType)("VariableDeclaration","LVal");const declaration=(0,_utils.assertNodeType)("VariableDeclaration"),lval=(0,_utils.assertNodeType)("Identifier","MemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression");return Object.assign((function(node,key,val){(0,_is.default)("VariableDeclaration",val)?declaration(node,key,val):lval(node,key,val)}),{oneOfNodeTypes:["VariableDeclaration","Identifier","MemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"]})}()},right:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")},await:{default:!1}}}),defineType("ImportDeclaration",{builder:["specifiers","source"],visitor:["specifiers","source","attributes","assertions"],aliases:["Statement","Declaration","ImportOrExportDeclaration"],fields:Object.assign({},importAttributes,{module:{optional:!0,validate:(0,_utils.assertValueType)("boolean")},phase:{default:null,validate:(0,_utils.assertOneOf)("source","defer")},specifiers:(0,_utils.validateArrayOfType)("ImportSpecifier","ImportDefaultSpecifier","ImportNamespaceSpecifier"),source:{validate:(0,_utils.assertNodeType)("StringLiteral")},importKind:{validate:(0,_utils.assertOneOf)("type","typeof","value"),optional:!0}})}),defineType("ImportDefaultSpecifier",{visitor:["local"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("ImportNamespaceSpecifier",{visitor:["local"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("ImportSpecifier",{visitor:["imported","local"],builder:["local","imported"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")},imported:{validate:(0,_utils.assertNodeType)("Identifier","StringLiteral")},importKind:{validate:(0,_utils.assertOneOf)("type","typeof","value"),optional:!0}}}),defineType("ImportExpression",{visitor:["source","options"],aliases:["Expression"],fields:{phase:{default:null,validate:(0,_utils.assertOneOf)("source","defer")},source:{validate:(0,_utils.assertNodeType)("Expression")},options:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0}}}),defineType("MetaProperty",{visitor:["meta","property"],aliases:["Expression"],fields:{meta:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertNodeType)("Identifier"),Object.assign((function(node,key,val){let property;switch(val.name){case"function":property="sent";break;case"new":property="target";break;case"import":property="meta"}if(!(0,_is.default)("Identifier",node.property,{name:property}))throw new TypeError("Unrecognised MetaProperty")}),{oneOfNodeTypes:["Identifier"]})):(0,_utils.assertNodeType)("Identifier")},property:{validate:(0,_utils.assertNodeType)("Identifier")}}});const classMethodOrPropertyCommon=()=>({abstract:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},accessibility:{validate:(0,_utils.assertOneOf)("public","private","protected"),optional:!0},static:{default:!1},override:{default:!1},computed:{default:!1},optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},key:{validate:(0,_utils.chain)(function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral"),computed=(0,_utils.assertNodeType)("Expression");return function(node,key,val){(node.computed?computed:normal)(node,key,val)}}(),(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","Expression"))}});exports.classMethodOrPropertyCommon=classMethodOrPropertyCommon;const classMethodOrDeclareMethodCommon=()=>Object.assign({},functionCommon(),classMethodOrPropertyCommon(),{params:(0,_utils.validateArrayOfType)("Identifier","Pattern","RestElement","TSParameterProperty"),kind:{validate:(0,_utils.assertOneOf)("get","set","method","constructor"),default:"method"},access:{validate:(0,_utils.chain)((0,_utils.assertValueType)("string"),(0,_utils.assertOneOf)("public","private","protected")),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}});exports.classMethodOrDeclareMethodCommon=classMethodOrDeclareMethodCommon,defineType("ClassMethod",{aliases:["Function","Scopable","BlockParent","FunctionParent","Method"],builder:["kind","key","params","body","computed","static","generator","async"],visitor:["decorators","key","typeParameters","params","returnType","body"],fields:Object.assign({},classMethodOrDeclareMethodCommon(),functionTypeAnnotationCommon(),{body:{validate:(0,_utils.assertNodeType)("BlockStatement")}})}),defineType("ObjectPattern",{visitor:["properties","typeAnnotation","decorators"],builder:["properties"],aliases:["Pattern","PatternLike","LVal"],fields:Object.assign({},patternLikeCommon(),{properties:(0,_utils.validateArrayOfType)("RestElement","ObjectProperty")})}),defineType("SpreadElement",{visitor:["argument"],aliases:["UnaryLike"],deprecatedAlias:"SpreadProperty",fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("Super",{aliases:["Expression"]}),defineType("TaggedTemplateExpression",{visitor:["tag","typeParameters","quasi"],builder:["tag","quasi"],aliases:["Expression"],fields:{tag:{validate:(0,_utils.assertNodeType)("Expression")},quasi:{validate:(0,_utils.assertNodeType)("TemplateLiteral")},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0}}}),defineType("TemplateElement",{builder:["value","tail"],fields:{value:{validate:(0,_utils.chain)((0,_utils.assertShape)({raw:{validate:(0,_utils.assertValueType)("string")},cooked:{validate:(0,_utils.assertValueType)("string"),optional:!0}}),(function(node){const raw=node.value.raw;let unterminatedCalled=!1;const error=()=>{throw new Error("Internal @babel/types error.")},{str,firstInvalidLoc}=(0,_helperStringParser.readStringContents)("template",raw,0,0,0,{unterminated(){unterminatedCalled=!0},strictNumericEscape:error,invalidEscapeSequence:error,numericSeparatorInEscapeSequence:error,unexpectedNumericSeparator:error,invalidDigit:error,invalidCodePoint:error});if(!unterminatedCalled)throw new Error("Invalid raw");node.value.cooked=firstInvalidLoc?null:str}))},tail:{default:!1}}}),defineType("TemplateLiteral",{visitor:["quasis","expressions"],aliases:["Expression","Literal"],fields:{quasis:(0,_utils.validateArrayOfType)("TemplateElement"),expressions:{validate:(0,_utils.chain)((0,_utils.assertValueType)("array"),(0,_utils.assertEach)((0,_utils.assertNodeType)("Expression","TSType")),(function(node,key,val){if(node.quasis.length!==val.length+1)throw new TypeError(`Number of ${node.type} quasis should be exactly one more than the number of expressions.\nExpected ${val.length+1} quasis but got ${node.quasis.length}`)}))}}}),defineType("YieldExpression",{builder:["argument","delegate"],visitor:["argument"],aliases:["Expression","Terminatorless"],fields:{delegate:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),Object.assign((function(node,key,val){if(val&&!node.argument)throw new TypeError("Property delegate of YieldExpression cannot be true if there is no argument")}),{type:"boolean"})):(0,_utils.assertValueType)("boolean"),default:!1},argument:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("AwaitExpression",{builder:["argument"],visitor:["argument"],aliases:["Expression","Terminatorless"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("Import",{aliases:["Expression"]}),defineType("BigIntLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("ExportNamespaceSpecifier",{visitor:["exported"],aliases:["ModuleSpecifier"],fields:{exported:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("OptionalMemberExpression",{builder:["object","property","computed","optional"],visitor:["object","property"],aliases:["Expression"],fields:{object:{validate:(0,_utils.assertNodeType)("Expression")},property:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier"),computed=(0,_utils.assertNodeType)("Expression");return Object.assign((function(node,key,val){(node.computed?computed:normal)(node,key,val)}),{oneOfNodeTypes:["Expression","Identifier"]})}()},computed:{default:!1},optional:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),(0,_utils.assertOptionalChainStart)()):(0,_utils.assertValueType)("boolean")}}}),defineType("OptionalCallExpression",{visitor:["callee","arguments","typeParameters","typeArguments"],builder:["callee","arguments","optional"],aliases:["Expression"],fields:{callee:{validate:(0,_utils.assertNodeType)("Expression")},arguments:(0,_utils.validateArrayOfType)("Expression","SpreadElement","ArgumentPlaceholder"),optional:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),(0,_utils.assertOptionalChainStart)()):(0,_utils.assertValueType)("boolean")},typeArguments:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TSTypeParameterInstantiation"),optional:!0}}}),defineType("ClassProperty",{visitor:["decorators","key","typeAnnotation","value"],builder:["key","value","typeAnnotation","decorators","computed","static"],aliases:["Property"],fields:Object.assign({},classMethodOrPropertyCommon(),{value:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},definite:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},variance:{validate:(0,_utils.assertNodeType)("Variance"),optional:!0}})}),defineType("ClassAccessorProperty",{visitor:["decorators","key","typeAnnotation","value"],builder:["key","value","typeAnnotation","decorators","computed","static"],aliases:["Property","Accessor"],fields:Object.assign({},classMethodOrPropertyCommon(),{key:{validate:(0,_utils.chain)(function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","PrivateName"),computed=(0,_utils.assertNodeType)("Expression");return function(node,key,val){(node.computed?computed:normal)(node,key,val)}}(),(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","Expression","PrivateName"))},value:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},definite:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},variance:{validate:(0,_utils.assertNodeType)("Variance"),optional:!0}})}),defineType("ClassPrivateProperty",{visitor:["decorators","key","typeAnnotation","value"],builder:["key","value","decorators","static"],aliases:["Property","Private"],fields:{key:{validate:(0,_utils.assertNodeType)("PrivateName")},value:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},static:{validate:(0,_utils.assertValueType)("boolean"),default:!1},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},definite:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},variance:{validate:(0,_utils.assertNodeType)("Variance"),optional:!0}}}),defineType("ClassPrivateMethod",{builder:["kind","key","params","body","static"],visitor:["decorators","key","typeParameters","params","returnType","body"],aliases:["Function","Scopable","BlockParent","FunctionParent","Method","Private"],fields:Object.assign({},classMethodOrDeclareMethodCommon(),functionTypeAnnotationCommon(),{kind:{validate:(0,_utils.assertOneOf)("get","set","method"),default:"method"},key:{validate:(0,_utils.assertNodeType)("PrivateName")},body:{validate:(0,_utils.assertNodeType)("BlockStatement")}})}),defineType("PrivateName",{visitor:["id"],aliases:["Private"],fields:{id:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("StaticBlock",{visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("Statement")},aliases:["Scopable","BlockParent","FunctionParent"]})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/deprecated-aliases.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEPRECATED_ALIASES=void 0;exports.DEPRECATED_ALIASES={ModuleDeclaration:"ImportOrExportDeclaration"}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/experimental.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");(0,_utils.default)("ArgumentPlaceholder",{}),(0,_utils.default)("BindExpression",{visitor:["object","callee"],aliases:["Expression"],fields:process.env.BABEL_TYPES_8_BREAKING?{object:{validate:(0,_utils.assertNodeType)("Expression")},callee:{validate:(0,_utils.assertNodeType)("Expression")}}:{object:{validate:Object.assign((()=>{}),{oneOfNodeTypes:["Expression"]})},callee:{validate:Object.assign((()=>{}),{oneOfNodeTypes:["Expression"]})}}}),(0,_utils.default)("ImportAttribute",{visitor:["key","value"],fields:{key:{validate:(0,_utils.assertNodeType)("Identifier","StringLiteral")},value:{validate:(0,_utils.assertNodeType)("StringLiteral")}}}),(0,_utils.default)("Decorator",{visitor:["expression"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}}}),(0,_utils.default)("DoExpression",{visitor:["body"],builder:["body","async"],aliases:["Expression"],fields:{body:{validate:(0,_utils.assertNodeType)("BlockStatement")},async:{validate:(0,_utils.assertValueType)("boolean"),default:!1}}}),(0,_utils.default)("ExportDefaultSpecifier",{visitor:["exported"],aliases:["ModuleSpecifier"],fields:{exported:{validate:(0,_utils.assertNodeType)("Identifier")}}}),(0,_utils.default)("RecordExpression",{visitor:["properties"],aliases:["Expression"],fields:{properties:(0,_utils.validateArrayOfType)("ObjectProperty","SpreadElement")}}),(0,_utils.default)("TupleExpression",{fields:{elements:{validate:(0,_utils.arrayOfType)("Expression","SpreadElement"),default:[]}},visitor:["elements"],aliases:["Expression"]}),(0,_utils.default)("DecimalLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}},aliases:["Expression","Pureish","Literal","Immutable"]}),(0,_utils.default)("ModuleExpression",{visitor:["body"],fields:{body:{validate:(0,_utils.assertNodeType)("Program")}},aliases:["Expression"]}),(0,_utils.default)("TopicReference",{aliases:["Expression"]}),(0,_utils.default)("PipelineTopicExpression",{builder:["expression"],visitor:["expression"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Expression"]}),(0,_utils.default)("PipelineBareFunction",{builder:["callee"],visitor:["callee"],fields:{callee:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Expression"]}),(0,_utils.default)("PipelinePrimaryTopicReference",{aliases:["Expression"]})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/flow.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _core=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js"),_utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const defineType=(0,_utils.defineAliasedType)("Flow"),defineInterfaceishType=name=>{const isDeclareClass="DeclareClass"===name;defineType(name,{builder:["id","typeParameters","extends","body"],visitor:["id","typeParameters","extends",...isDeclareClass?["mixins","implements"]:[],"body"],aliases:["FlowDeclaration","Statement","Declaration"],fields:Object.assign({id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),extends:(0,_utils.validateOptional)((0,_utils.arrayOfType)("InterfaceExtends"))},isDeclareClass?{mixins:(0,_utils.validateOptional)((0,_utils.arrayOfType)("InterfaceExtends")),implements:(0,_utils.validateOptional)((0,_utils.arrayOfType)("ClassImplements"))}:{},{body:(0,_utils.validateType)("ObjectTypeAnnotation")})})};defineType("AnyTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ArrayTypeAnnotation",{visitor:["elementType"],aliases:["FlowType"],fields:{elementType:(0,_utils.validateType)("FlowType")}}),defineType("BooleanTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("BooleanLiteralTypeAnnotation",{builder:["value"],aliases:["FlowType"],fields:{value:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("NullLiteralTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ClassImplements",{visitor:["id","typeParameters"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterInstantiation")}}),defineInterfaceishType("DeclareClass"),defineType("DeclareFunction",{visitor:["id"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),predicate:(0,_utils.validateOptionalType)("DeclaredPredicate")}}),defineInterfaceishType("DeclareInterface"),defineType("DeclareModule",{builder:["id","body","kind"],visitor:["id","body"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier","StringLiteral"),body:(0,_utils.validateType)("BlockStatement"),kind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("CommonJS","ES"))}}),defineType("DeclareModuleExports",{visitor:["typeAnnotation"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{typeAnnotation:(0,_utils.validateType)("TypeAnnotation")}}),defineType("DeclareTypeAlias",{visitor:["id","typeParameters","right"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),right:(0,_utils.validateType)("FlowType")}}),defineType("DeclareOpaqueType",{visitor:["id","typeParameters","supertype"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),supertype:(0,_utils.validateOptionalType)("FlowType"),impltype:(0,_utils.validateOptionalType)("FlowType")}}),defineType("DeclareVariable",{visitor:["id"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier")}}),defineType("DeclareExportDeclaration",{visitor:["declaration","specifiers","source","attributes"],aliases:["FlowDeclaration","Statement","Declaration"],fields:Object.assign({declaration:(0,_utils.validateOptionalType)("Flow"),specifiers:(0,_utils.validateOptional)((0,_utils.arrayOfType)("ExportSpecifier","ExportNamespaceSpecifier")),source:(0,_utils.validateOptionalType)("StringLiteral"),default:(0,_utils.validateOptional)((0,_utils.assertValueType)("boolean"))},_core.importAttributes)}),defineType("DeclareExportAllDeclaration",{visitor:["source","attributes"],aliases:["FlowDeclaration","Statement","Declaration"],fields:Object.assign({source:(0,_utils.validateType)("StringLiteral"),exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("type","value"))},_core.importAttributes)}),defineType("DeclaredPredicate",{visitor:["value"],aliases:["FlowPredicate"],fields:{value:(0,_utils.validateType)("Flow")}}),defineType("ExistsTypeAnnotation",{aliases:["FlowType"]}),defineType("FunctionTypeAnnotation",{visitor:["typeParameters","params","rest","returnType"],aliases:["FlowType"],fields:{typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),params:(0,_utils.validateArrayOfType)("FunctionTypeParam"),rest:(0,_utils.validateOptionalType)("FunctionTypeParam"),this:(0,_utils.validateOptionalType)("FunctionTypeParam"),returnType:(0,_utils.validateType)("FlowType")}}),defineType("FunctionTypeParam",{visitor:["name","typeAnnotation"],fields:{name:(0,_utils.validateOptionalType)("Identifier"),typeAnnotation:(0,_utils.validateType)("FlowType"),optional:(0,_utils.validateOptional)((0,_utils.assertValueType)("boolean"))}}),defineType("GenericTypeAnnotation",{visitor:["id","typeParameters"],aliases:["FlowType"],fields:{id:(0,_utils.validateType)("Identifier","QualifiedTypeIdentifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterInstantiation")}}),defineType("InferredPredicate",{aliases:["FlowPredicate"]}),defineType("InterfaceExtends",{visitor:["id","typeParameters"],fields:{id:(0,_utils.validateType)("Identifier","QualifiedTypeIdentifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterInstantiation")}}),defineInterfaceishType("InterfaceDeclaration"),defineType("InterfaceTypeAnnotation",{visitor:["extends","body"],aliases:["FlowType"],fields:{extends:(0,_utils.validateOptional)((0,_utils.arrayOfType)("InterfaceExtends")),body:(0,_utils.validateType)("ObjectTypeAnnotation")}}),defineType("IntersectionTypeAnnotation",{visitor:["types"],aliases:["FlowType"],fields:{types:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("MixedTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("EmptyTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("NullableTypeAnnotation",{visitor:["typeAnnotation"],aliases:["FlowType"],fields:{typeAnnotation:(0,_utils.validateType)("FlowType")}}),defineType("NumberLiteralTypeAnnotation",{builder:["value"],aliases:["FlowType"],fields:{value:(0,_utils.validate)((0,_utils.assertValueType)("number"))}}),defineType("NumberTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ObjectTypeAnnotation",{visitor:["properties","indexers","callProperties","internalSlots"],aliases:["FlowType"],builder:["properties","indexers","callProperties","internalSlots","exact"],fields:{properties:(0,_utils.validate)((0,_utils.arrayOfType)("ObjectTypeProperty","ObjectTypeSpreadProperty")),indexers:{validate:(0,_utils.arrayOfType)("ObjectTypeIndexer"),optional:!0,default:[]},callProperties:{validate:(0,_utils.arrayOfType)("ObjectTypeCallProperty"),optional:!0,default:[]},internalSlots:{validate:(0,_utils.arrayOfType)("ObjectTypeInternalSlot"),optional:!0,default:[]},exact:{validate:(0,_utils.assertValueType)("boolean"),default:!1},inexact:(0,_utils.validateOptional)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeInternalSlot",{visitor:["id","value"],builder:["id","value","optional","static","method"],aliases:["UserWhitespacable"],fields:{id:(0,_utils.validateType)("Identifier"),value:(0,_utils.validateType)("FlowType"),optional:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),method:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeCallProperty",{visitor:["value"],aliases:["UserWhitespacable"],fields:{value:(0,_utils.validateType)("FlowType"),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeIndexer",{visitor:["variance","id","key","value"],builder:["id","key","value","variance"],aliases:["UserWhitespacable"],fields:{id:(0,_utils.validateOptionalType)("Identifier"),key:(0,_utils.validateType)("FlowType"),value:(0,_utils.validateType)("FlowType"),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),variance:(0,_utils.validateOptionalType)("Variance")}}),defineType("ObjectTypeProperty",{visitor:["key","value","variance"],aliases:["UserWhitespacable"],fields:{key:(0,_utils.validateType)("Identifier","StringLiteral"),value:(0,_utils.validateType)("FlowType"),kind:(0,_utils.validate)((0,_utils.assertOneOf)("init","get","set")),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),proto:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),optional:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),variance:(0,_utils.validateOptionalType)("Variance"),method:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeSpreadProperty",{visitor:["argument"],aliases:["UserWhitespacable"],fields:{argument:(0,_utils.validateType)("FlowType")}}),defineType("OpaqueType",{visitor:["id","typeParameters","supertype","impltype"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),supertype:(0,_utils.validateOptionalType)("FlowType"),impltype:(0,_utils.validateType)("FlowType")}}),defineType("QualifiedTypeIdentifier",{visitor:["qualification","id"],builder:["id","qualification"],fields:{id:(0,_utils.validateType)("Identifier"),qualification:(0,_utils.validateType)("Identifier","QualifiedTypeIdentifier")}}),defineType("StringLiteralTypeAnnotation",{builder:["value"],aliases:["FlowType"],fields:{value:(0,_utils.validate)((0,_utils.assertValueType)("string"))}}),defineType("StringTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("SymbolTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ThisTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("TupleTypeAnnotation",{visitor:["types"],aliases:["FlowType"],fields:{types:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("TypeofTypeAnnotation",{visitor:["argument"],aliases:["FlowType"],fields:{argument:(0,_utils.validateType)("FlowType")}}),defineType("TypeAlias",{visitor:["id","typeParameters","right"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),right:(0,_utils.validateType)("FlowType")}}),defineType("TypeAnnotation",{visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("FlowType")}}),defineType("TypeCastExpression",{visitor:["expression","typeAnnotation"],aliases:["ExpressionWrapper","Expression"],fields:{expression:(0,_utils.validateType)("Expression"),typeAnnotation:(0,_utils.validateType)("TypeAnnotation")}}),defineType("TypeParameter",{visitor:["bound","default","variance"],fields:{name:(0,_utils.validate)((0,_utils.assertValueType)("string")),bound:(0,_utils.validateOptionalType)("TypeAnnotation"),default:(0,_utils.validateOptionalType)("FlowType"),variance:(0,_utils.validateOptionalType)("Variance")}}),defineType("TypeParameterDeclaration",{visitor:["params"],fields:{params:(0,_utils.validate)((0,_utils.arrayOfType)("TypeParameter"))}}),defineType("TypeParameterInstantiation",{visitor:["params"],fields:{params:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("UnionTypeAnnotation",{visitor:["types"],aliases:["FlowType"],fields:{types:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("Variance",{builder:["kind"],fields:{kind:(0,_utils.validate)((0,_utils.assertOneOf)("minus","plus"))}}),defineType("VoidTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("EnumDeclaration",{aliases:["Statement","Declaration"],visitor:["id","body"],fields:{id:(0,_utils.validateType)("Identifier"),body:(0,_utils.validateType)("EnumBooleanBody","EnumNumberBody","EnumStringBody","EnumSymbolBody")}}),defineType("EnumBooleanBody",{aliases:["EnumBody"],visitor:["members"],fields:{explicitType:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),members:(0,_utils.validateArrayOfType)("EnumBooleanMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumNumberBody",{aliases:["EnumBody"],visitor:["members"],fields:{explicitType:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),members:(0,_utils.validateArrayOfType)("EnumNumberMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumStringBody",{aliases:["EnumBody"],visitor:["members"],fields:{explicitType:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),members:(0,_utils.validateArrayOfType)("EnumStringMember","EnumDefaultedMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumSymbolBody",{aliases:["EnumBody"],visitor:["members"],fields:{members:(0,_utils.validateArrayOfType)("EnumDefaultedMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumBooleanMember",{aliases:["EnumMember"],visitor:["id"],fields:{id:(0,_utils.validateType)("Identifier"),init:(0,_utils.validateType)("BooleanLiteral")}}),defineType("EnumNumberMember",{aliases:["EnumMember"],visitor:["id","init"],fields:{id:(0,_utils.validateType)("Identifier"),init:(0,_utils.validateType)("NumericLiteral")}}),defineType("EnumStringMember",{aliases:["EnumMember"],visitor:["id","init"],fields:{id:(0,_utils.validateType)("Identifier"),init:(0,_utils.validateType)("StringLiteral")}}),defineType("EnumDefaultedMember",{aliases:["EnumMember"],visitor:["id"],fields:{id:(0,_utils.validateType)("Identifier")}}),defineType("IndexedAccessType",{visitor:["objectType","indexType"],aliases:["FlowType"],fields:{objectType:(0,_utils.validateType)("FlowType"),indexType:(0,_utils.validateType)("FlowType")}}),defineType("OptionalIndexedAccessType",{visitor:["objectType","indexType"],aliases:["FlowType"],fields:{objectType:(0,_utils.validateType)("FlowType"),indexType:(0,_utils.validateType)("FlowType"),optional:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ALIAS_KEYS",{enumerable:!0,get:function(){return _utils.ALIAS_KEYS}}),Object.defineProperty(exports,"BUILDER_KEYS",{enumerable:!0,get:function(){return _utils.BUILDER_KEYS}}),Object.defineProperty(exports,"DEPRECATED_ALIASES",{enumerable:!0,get:function(){return _deprecatedAliases.DEPRECATED_ALIASES}}),Object.defineProperty(exports,"DEPRECATED_KEYS",{enumerable:!0,get:function(){return _utils.DEPRECATED_KEYS}}),Object.defineProperty(exports,"FLIPPED_ALIAS_KEYS",{enumerable:!0,get:function(){return _utils.FLIPPED_ALIAS_KEYS}}),Object.defineProperty(exports,"NODE_FIELDS",{enumerable:!0,get:function(){return _utils.NODE_FIELDS}}),Object.defineProperty(exports,"NODE_PARENT_VALIDATIONS",{enumerable:!0,get:function(){return _utils.NODE_PARENT_VALIDATIONS}}),Object.defineProperty(exports,"PLACEHOLDERS",{enumerable:!0,get:function(){return _placeholders.PLACEHOLDERS}}),Object.defineProperty(exports,"PLACEHOLDERS_ALIAS",{enumerable:!0,get:function(){return _placeholders.PLACEHOLDERS_ALIAS}}),Object.defineProperty(exports,"PLACEHOLDERS_FLIPPED_ALIAS",{enumerable:!0,get:function(){return _placeholders.PLACEHOLDERS_FLIPPED_ALIAS}}),exports.TYPES=void 0,Object.defineProperty(exports,"VISITOR_KEYS",{enumerable:!0,get:function(){return _utils.VISITOR_KEYS}}),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/flow.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/jsx.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/misc.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/experimental.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/typescript.js");var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js"),_placeholders=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/placeholders.js"),_deprecatedAliases=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/deprecated-aliases.js");Object.keys(_deprecatedAliases.DEPRECATED_ALIASES).forEach((deprecatedAlias=>{_utils.FLIPPED_ALIAS_KEYS[deprecatedAlias]=_utils.FLIPPED_ALIAS_KEYS[_deprecatedAliases.DEPRECATED_ALIASES[deprecatedAlias]]}));exports.TYPES=[].concat(Object.keys(_utils.VISITOR_KEYS),Object.keys(_utils.FLIPPED_ALIAS_KEYS),Object.keys(_utils.DEPRECATED_KEYS))},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/jsx.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const defineType=(0,_utils.defineAliasedType)("JSX");defineType("JSXAttribute",{visitor:["name","value"],aliases:["Immutable"],fields:{name:{validate:(0,_utils.assertNodeType)("JSXIdentifier","JSXNamespacedName")},value:{optional:!0,validate:(0,_utils.assertNodeType)("JSXElement","JSXFragment","StringLiteral","JSXExpressionContainer")}}}),defineType("JSXClosingElement",{visitor:["name"],aliases:["Immutable"],fields:{name:{validate:(0,_utils.assertNodeType)("JSXIdentifier","JSXMemberExpression","JSXNamespacedName")}}}),defineType("JSXElement",{builder:["openingElement","closingElement","children","selfClosing"],visitor:["openingElement","children","closingElement"],aliases:["Immutable","Expression"],fields:Object.assign({openingElement:{validate:(0,_utils.assertNodeType)("JSXOpeningElement")},closingElement:{optional:!0,validate:(0,_utils.assertNodeType)("JSXClosingElement")},children:(0,_utils.validateArrayOfType)("JSXText","JSXExpressionContainer","JSXSpreadChild","JSXElement","JSXFragment")},{selfClosing:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}})}),defineType("JSXEmptyExpression",{}),defineType("JSXExpressionContainer",{visitor:["expression"],aliases:["Immutable"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression","JSXEmptyExpression")}}}),defineType("JSXSpreadChild",{visitor:["expression"],aliases:["Immutable"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("JSXIdentifier",{builder:["name"],fields:{name:{validate:(0,_utils.assertValueType)("string")}}}),defineType("JSXMemberExpression",{visitor:["object","property"],fields:{object:{validate:(0,_utils.assertNodeType)("JSXMemberExpression","JSXIdentifier")},property:{validate:(0,_utils.assertNodeType)("JSXIdentifier")}}}),defineType("JSXNamespacedName",{visitor:["namespace","name"],fields:{namespace:{validate:(0,_utils.assertNodeType)("JSXIdentifier")},name:{validate:(0,_utils.assertNodeType)("JSXIdentifier")}}}),defineType("JSXOpeningElement",{builder:["name","attributes","selfClosing"],visitor:["name","attributes"],aliases:["Immutable"],fields:{name:{validate:(0,_utils.assertNodeType)("JSXIdentifier","JSXMemberExpression","JSXNamespacedName")},selfClosing:{default:!1},attributes:(0,_utils.validateArrayOfType)("JSXAttribute","JSXSpreadAttribute"),typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0}}}),defineType("JSXSpreadAttribute",{visitor:["argument"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("JSXText",{aliases:["Immutable"],builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}}}),defineType("JSXFragment",{builder:["openingFragment","closingFragment","children"],visitor:["openingFragment","children","closingFragment"],aliases:["Immutable","Expression"],fields:{openingFragment:{validate:(0,_utils.assertNodeType)("JSXOpeningFragment")},closingFragment:{validate:(0,_utils.assertNodeType)("JSXClosingFragment")},children:(0,_utils.validateArrayOfType)("JSXText","JSXExpressionContainer","JSXSpreadChild","JSXElement","JSXFragment")}}),defineType("JSXOpeningFragment",{aliases:["Immutable"]}),defineType("JSXClosingFragment",{aliases:["Immutable"]})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/misc.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js"),_placeholders=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/placeholders.js"),_core=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js");const defineType=(0,_utils.defineAliasedType)("Miscellaneous");defineType("Noop",{visitor:[]}),defineType("Placeholder",{visitor:[],builder:["expectedNode","name"],fields:Object.assign({name:{validate:(0,_utils.assertNodeType)("Identifier")},expectedNode:{validate:(0,_utils.assertOneOf)(..._placeholders.PLACEHOLDERS)}},(0,_core.patternLikeCommon)())}),defineType("V8IntrinsicIdentifier",{builder:["name"],fields:{name:{validate:(0,_utils.assertValueType)("string")}}})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/placeholders.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PLACEHOLDERS_FLIPPED_ALIAS=exports.PLACEHOLDERS_ALIAS=exports.PLACEHOLDERS=void 0;var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const PLACEHOLDERS=exports.PLACEHOLDERS=["Identifier","StringLiteral","Expression","Statement","Declaration","BlockStatement","ClassBody","Pattern"],PLACEHOLDERS_ALIAS=exports.PLACEHOLDERS_ALIAS={Declaration:["Statement"],Pattern:["PatternLike","LVal"]};for(const type of PLACEHOLDERS){const alias=_utils.ALIAS_KEYS[type];null!=alias&&alias.length&&(PLACEHOLDERS_ALIAS[type]=alias)}const PLACEHOLDERS_FLIPPED_ALIAS=exports.PLACEHOLDERS_FLIPPED_ALIAS={};Object.keys(PLACEHOLDERS_ALIAS).forEach((type=>{PLACEHOLDERS_ALIAS[type].forEach((alias=>{hasOwnProperty.call(PLACEHOLDERS_FLIPPED_ALIAS,alias)||(PLACEHOLDERS_FLIPPED_ALIAS[alias]=[]),PLACEHOLDERS_FLIPPED_ALIAS[alias].push(type)}))}))},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/typescript.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js"),_core=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js"),_is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js");const defineType=(0,_utils.defineAliasedType)("TypeScript"),bool=(0,_utils.assertValueType)("boolean"),tSFunctionTypeAnnotationCommon=()=>({returnType:{validate:(0,_utils.assertNodeType)("TSTypeAnnotation","Noop"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TSTypeParameterDeclaration","Noop"),optional:!0}});defineType("TSParameterProperty",{aliases:["LVal"],visitor:["parameter"],fields:{accessibility:{validate:(0,_utils.assertOneOf)("public","private","protected"),optional:!0},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},parameter:{validate:(0,_utils.assertNodeType)("Identifier","AssignmentPattern")},override:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}}}),defineType("TSDeclareFunction",{aliases:["Statement","Declaration"],visitor:["id","typeParameters","params","returnType"],fields:Object.assign({},(0,_core.functionDeclarationCommon)(),tSFunctionTypeAnnotationCommon())}),defineType("TSDeclareMethod",{visitor:["decorators","key","typeParameters","params","returnType"],fields:Object.assign({},(0,_core.classMethodOrDeclareMethodCommon)(),tSFunctionTypeAnnotationCommon())}),defineType("TSQualifiedName",{aliases:["TSEntityName"],visitor:["left","right"],fields:{left:(0,_utils.validateType)("TSEntityName"),right:(0,_utils.validateType)("Identifier")}});const signatureDeclarationCommon=()=>({typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterDeclaration"),parameters:(0,_utils.validateArrayOfType)("ArrayPattern","Identifier","ObjectPattern","RestElement"),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation")}),callConstructSignatureDeclaration={aliases:["TSTypeElement"],visitor:["typeParameters","parameters","typeAnnotation"],fields:signatureDeclarationCommon()};defineType("TSCallSignatureDeclaration",callConstructSignatureDeclaration),defineType("TSConstructSignatureDeclaration",callConstructSignatureDeclaration);const namedTypeElementCommon=()=>({key:(0,_utils.validateType)("Expression"),computed:{default:!1},optional:(0,_utils.validateOptional)(bool)});defineType("TSPropertySignature",{aliases:["TSTypeElement"],visitor:["key","typeAnnotation"],fields:Object.assign({},namedTypeElementCommon(),{readonly:(0,_utils.validateOptional)(bool),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation"),kind:{validate:(0,_utils.assertOneOf)("get","set")}})}),defineType("TSMethodSignature",{aliases:["TSTypeElement"],visitor:["key","typeParameters","parameters","typeAnnotation"],fields:Object.assign({},signatureDeclarationCommon(),namedTypeElementCommon(),{kind:{validate:(0,_utils.assertOneOf)("method","get","set")}})}),defineType("TSIndexSignature",{aliases:["TSTypeElement"],visitor:["parameters","typeAnnotation"],fields:{readonly:(0,_utils.validateOptional)(bool),static:(0,_utils.validateOptional)(bool),parameters:(0,_utils.validateArrayOfType)("Identifier"),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation")}});const tsKeywordTypes=["TSAnyKeyword","TSBooleanKeyword","TSBigIntKeyword","TSIntrinsicKeyword","TSNeverKeyword","TSNullKeyword","TSNumberKeyword","TSObjectKeyword","TSStringKeyword","TSSymbolKeyword","TSUndefinedKeyword","TSUnknownKeyword","TSVoidKeyword"];for(const type of tsKeywordTypes)defineType(type,{aliases:["TSType","TSBaseType"],visitor:[],fields:{}});defineType("TSThisType",{aliases:["TSType","TSBaseType"],visitor:[],fields:{}});const fnOrCtrBase={aliases:["TSType"],visitor:["typeParameters","parameters","typeAnnotation"]};defineType("TSFunctionType",Object.assign({},fnOrCtrBase,{fields:signatureDeclarationCommon()})),defineType("TSConstructorType",Object.assign({},fnOrCtrBase,{fields:Object.assign({},signatureDeclarationCommon(),{abstract:(0,_utils.validateOptional)(bool)})})),defineType("TSTypeReference",{aliases:["TSType"],visitor:["typeName","typeParameters"],fields:{typeName:(0,_utils.validateType)("TSEntityName"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}}),defineType("TSTypePredicate",{aliases:["TSType"],visitor:["parameterName","typeAnnotation"],builder:["parameterName","typeAnnotation","asserts"],fields:{parameterName:(0,_utils.validateType)("Identifier","TSThisType"),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation"),asserts:(0,_utils.validateOptional)(bool)}}),defineType("TSTypeQuery",{aliases:["TSType"],visitor:["exprName","typeParameters"],fields:{exprName:(0,_utils.validateType)("TSEntityName","TSImportType"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}}),defineType("TSTypeLiteral",{aliases:["TSType"],visitor:["members"],fields:{members:(0,_utils.validateArrayOfType)("TSTypeElement")}}),defineType("TSArrayType",{aliases:["TSType"],visitor:["elementType"],fields:{elementType:(0,_utils.validateType)("TSType")}}),defineType("TSTupleType",{aliases:["TSType"],visitor:["elementTypes"],fields:{elementTypes:(0,_utils.validateArrayOfType)("TSType","TSNamedTupleMember")}}),defineType("TSOptionalType",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSRestType",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSNamedTupleMember",{visitor:["label","elementType"],builder:["label","elementType","optional"],fields:{label:(0,_utils.validateType)("Identifier"),optional:{validate:bool,default:!1},elementType:(0,_utils.validateType)("TSType")}});const unionOrIntersection={aliases:["TSType"],visitor:["types"],fields:{types:(0,_utils.validateArrayOfType)("TSType")}};defineType("TSUnionType",unionOrIntersection),defineType("TSIntersectionType",unionOrIntersection),defineType("TSConditionalType",{aliases:["TSType"],visitor:["checkType","extendsType","trueType","falseType"],fields:{checkType:(0,_utils.validateType)("TSType"),extendsType:(0,_utils.validateType)("TSType"),trueType:(0,_utils.validateType)("TSType"),falseType:(0,_utils.validateType)("TSType")}}),defineType("TSInferType",{aliases:["TSType"],visitor:["typeParameter"],fields:{typeParameter:(0,_utils.validateType)("TSTypeParameter")}}),defineType("TSParenthesizedType",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSTypeOperator",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{operator:(0,_utils.validate)((0,_utils.assertValueType)("string")),typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSIndexedAccessType",{aliases:["TSType"],visitor:["objectType","indexType"],fields:{objectType:(0,_utils.validateType)("TSType"),indexType:(0,_utils.validateType)("TSType")}}),defineType("TSMappedType",{aliases:["TSType"],visitor:["typeParameter","nameType","typeAnnotation"],builder:["typeParameter","typeAnnotation","nameType"],fields:Object.assign({},{typeParameter:(0,_utils.validateType)("TSTypeParameter")},{readonly:(0,_utils.validateOptional)((0,_utils.assertOneOf)(!0,!1,"+","-")),optional:(0,_utils.validateOptional)((0,_utils.assertOneOf)(!0,!1,"+","-")),typeAnnotation:(0,_utils.validateOptionalType)("TSType"),nameType:(0,_utils.validateOptionalType)("TSType")})}),defineType("TSLiteralType",{aliases:["TSType","TSBaseType"],visitor:["literal"],fields:{literal:{validate:function(){const unaryExpression=(0,_utils.assertNodeType)("NumericLiteral","BigIntLiteral"),unaryOperator=(0,_utils.assertOneOf)("-"),literal=(0,_utils.assertNodeType)("NumericLiteral","StringLiteral","BooleanLiteral","BigIntLiteral","TemplateLiteral");function validator(parent,key,node){(0,_is.default)("UnaryExpression",node)?(unaryOperator(node,"operator",node.operator),unaryExpression(node,"argument",node.argument)):literal(parent,key,node)}return validator.oneOfNodeTypes=["NumericLiteral","StringLiteral","BooleanLiteral","BigIntLiteral","TemplateLiteral","UnaryExpression"],validator}()}}});defineType("TSExpressionWithTypeArguments",{aliases:["TSType"],visitor:["expression","typeParameters"],fields:{expression:(0,_utils.validateType)("TSEntityName"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}}),defineType("TSInterfaceDeclaration",{aliases:["Statement","Declaration"],visitor:["id","typeParameters","extends","body"],fields:{declare:(0,_utils.validateOptional)(bool),id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterDeclaration"),extends:(0,_utils.validateOptional)((0,_utils.arrayOfType)("TSExpressionWithTypeArguments")),body:(0,_utils.validateType)("TSInterfaceBody")}}),defineType("TSInterfaceBody",{visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("TSTypeElement")}}),defineType("TSTypeAliasDeclaration",{aliases:["Statement","Declaration"],visitor:["id","typeParameters","typeAnnotation"],fields:{declare:(0,_utils.validateOptional)(bool),id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterDeclaration"),typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSInstantiationExpression",{aliases:["Expression"],visitor:["expression","typeParameters"],fields:{expression:(0,_utils.validateType)("Expression"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}});const TSTypeExpression={aliases:["Expression","LVal","PatternLike"],visitor:["expression","typeAnnotation"],fields:{expression:(0,_utils.validateType)("Expression"),typeAnnotation:(0,_utils.validateType)("TSType")}};defineType("TSAsExpression",TSTypeExpression),defineType("TSSatisfiesExpression",TSTypeExpression),defineType("TSTypeAssertion",{aliases:["Expression","LVal","PatternLike"],visitor:["typeAnnotation","expression"],fields:{typeAnnotation:(0,_utils.validateType)("TSType"),expression:(0,_utils.validateType)("Expression")}}),defineType("TSEnumDeclaration",{aliases:["Statement","Declaration"],visitor:["id","members"],fields:{declare:(0,_utils.validateOptional)(bool),const:(0,_utils.validateOptional)(bool),id:(0,_utils.validateType)("Identifier"),members:(0,_utils.validateArrayOfType)("TSEnumMember"),initializer:(0,_utils.validateOptionalType)("Expression")}}),defineType("TSEnumMember",{visitor:["id","initializer"],fields:{id:(0,_utils.validateType)("Identifier","StringLiteral"),initializer:(0,_utils.validateOptionalType)("Expression")}}),defineType("TSModuleDeclaration",{aliases:["Statement","Declaration"],visitor:["id","body"],fields:Object.assign({kind:{validate:(0,_utils.assertOneOf)("global","module","namespace")},declare:(0,_utils.validateOptional)(bool)},{global:(0,_utils.validateOptional)(bool)},{id:(0,_utils.validateType)("Identifier","StringLiteral"),body:(0,_utils.validateType)("TSModuleBlock","TSModuleDeclaration")})}),defineType("TSModuleBlock",{aliases:["Scopable","Block","BlockParent","FunctionParent"],visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("Statement")}}),defineType("TSImportType",{aliases:["TSType"],visitor:["argument","qualifier","typeParameters"],fields:{argument:(0,_utils.validateType)("StringLiteral"),qualifier:(0,_utils.validateOptionalType)("TSEntityName"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation"),options:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0}}}),defineType("TSImportEqualsDeclaration",{aliases:["Statement"],visitor:["id","moduleReference"],fields:{isExport:(0,_utils.validate)(bool),id:(0,_utils.validateType)("Identifier"),moduleReference:(0,_utils.validateType)("TSEntityName","TSExternalModuleReference"),importKind:{validate:(0,_utils.assertOneOf)("type","value"),optional:!0}}}),defineType("TSExternalModuleReference",{visitor:["expression"],fields:{expression:(0,_utils.validateType)("StringLiteral")}}),defineType("TSNonNullExpression",{aliases:["Expression","LVal","PatternLike"],visitor:["expression"],fields:{expression:(0,_utils.validateType)("Expression")}}),defineType("TSExportAssignment",{aliases:["Statement"],visitor:["expression"],fields:{expression:(0,_utils.validateType)("Expression")}}),defineType("TSNamespaceExportDeclaration",{aliases:["Statement"],visitor:["id"],fields:{id:(0,_utils.validateType)("Identifier")}}),defineType("TSTypeAnnotation",{visitor:["typeAnnotation"],fields:{typeAnnotation:{validate:(0,_utils.assertNodeType)("TSType")}}}),defineType("TSTypeParameterInstantiation",{visitor:["params"],fields:{params:(0,_utils.validateArrayOfType)("TSType")}}),defineType("TSTypeParameterDeclaration",{visitor:["params"],fields:{params:(0,_utils.validateArrayOfType)("TSTypeParameter")}}),defineType("TSTypeParameter",{builder:["constraint","default","name"],visitor:["constraint","default"],fields:{name:{validate:(0,_utils.assertValueType)("string")},in:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},out:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},const:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},constraint:{validate:(0,_utils.assertNodeType)("TSType"),optional:!0},default:{validate:(0,_utils.assertNodeType)("TSType"),optional:!0}}})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VISITOR_KEYS=exports.NODE_PARENT_VALIDATIONS=exports.NODE_FIELDS=exports.FLIPPED_ALIAS_KEYS=exports.DEPRECATED_KEYS=exports.BUILDER_KEYS=exports.ALIAS_KEYS=void 0,exports.arrayOf=arrayOf,exports.arrayOfType=arrayOfType,exports.assertEach=assertEach,exports.assertNodeOrValueType=function(...types){function validate(node,key,val){for(const type of types)if(getType(val)===type||(0,_is.default)(type,val))return void(0,_validate.validateChild)(node,key,val);throw new TypeError(`Property ${key} of ${node.type} expected node to be of a type ${JSON.stringify(types)} but instead got ${JSON.stringify(null==val?void 0:val.type)}`)}return validate.oneOfNodeOrValueTypes=types,validate},exports.assertNodeType=assertNodeType,exports.assertOneOf=function(...values){function validate(node,key,val){if(!values.includes(val))throw new TypeError(`Property ${key} expected value to be one of ${JSON.stringify(values)} but got ${JSON.stringify(val)}`)}return validate.oneOf=values,validate},exports.assertOptionalChainStart=function(){return function(node){var _current;let current=node;for(;node;){const{type}=current;if("OptionalCallExpression"!==type){if("OptionalMemberExpression"!==type)break;if(current.optional)return;current=current.object}else{if(current.optional)return;current=current.callee}}throw new TypeError(`Non-optional ${node.type} must chain from an optional OptionalMemberExpression or OptionalCallExpression. Found chain from ${null==(_current=current)?void 0:_current.type}`)}},exports.assertShape=function(shape){function validate(node,key,val){const errors=[];for(const property of Object.keys(shape))try{(0,_validate.validateField)(node,property,val[property],shape[property])}catch(error){if(error instanceof TypeError){errors.push(error.message);continue}throw error}if(errors.length)throw new TypeError(`Property ${key} of ${node.type} expected to have the following:\n${errors.join("\n")}`)}return validate.shapeOf=shape,validate},exports.assertValueType=assertValueType,exports.chain=chain,exports.default=defineType,exports.defineAliasedType=function(...aliases){return(type,opts={})=>{let defined=opts.aliases;var _store$opts$inherits$;defined||(opts.inherits&&(defined=null==(_store$opts$inherits$=store[opts.inherits].aliases)?void 0:_store$opts$inherits$.slice()),null!=defined||(defined=[]),opts.aliases=defined);const additional=aliases.filter((a=>!defined.includes(a)));defined.unshift(...additional),defineType(type,opts)}},exports.validate=validate,exports.validateArrayOfType=function(...typeNames){return validate(arrayOfType(...typeNames))},exports.validateOptional=function(validate){return{validate,optional:!0}},exports.validateOptionalType=function(...typeNames){return{validate:assertNodeType(...typeNames),optional:!0}},exports.validateType=function(...typeNames){return validate(assertNodeType(...typeNames))};var _is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_validate=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js");const VISITOR_KEYS=exports.VISITOR_KEYS={},ALIAS_KEYS=exports.ALIAS_KEYS={},FLIPPED_ALIAS_KEYS=exports.FLIPPED_ALIAS_KEYS={},NODE_FIELDS=exports.NODE_FIELDS={},BUILDER_KEYS=exports.BUILDER_KEYS={},DEPRECATED_KEYS=exports.DEPRECATED_KEYS={},NODE_PARENT_VALIDATIONS=exports.NODE_PARENT_VALIDATIONS={};function getType(val){return Array.isArray(val)?"array":null===val?"null":typeof val}function validate(validate){return{validate}}function arrayOf(elementType){return chain(assertValueType("array"),assertEach(elementType))}function arrayOfType(...typeNames){return arrayOf(assertNodeType(...typeNames))}function assertEach(callback){const childValidator=process.env.BABEL_TYPES_8_BREAKING?_validate.validateChild:()=>{};function validator(node,key,val){if(Array.isArray(val))for(let i=0;i<val.length;i++){const subkey=`${key}[${i}]`,v=val[i];callback(node,subkey,v),childValidator(node,subkey,v)}}return validator.each=callback,validator}function assertNodeType(...types){function validate(node,key,val){for(const type of types)if((0,_is.default)(type,val))return void(0,_validate.validateChild)(node,key,val);throw new TypeError(`Property ${key} of ${node.type} expected node to be of a type ${JSON.stringify(types)} but instead got ${JSON.stringify(null==val?void 0:val.type)}`)}return validate.oneOfNodeTypes=types,validate}function assertValueType(type){function validate(node,key,val){if(!(getType(val)===type))throw new TypeError(`Property ${key} expected type of ${type} but got ${getType(val)}`)}return validate.type=type,validate}function chain(...fns){function validate(...args){for(const fn of fns)fn(...args)}if(validate.chainOf=fns,fns.length>=2&&"type"in fns[0]&&"array"===fns[0].type&&!("each"in fns[1]))throw new Error('An assertValueType("array") validator can only be followed by an assertEach(...) validator.');return validate}const validTypeOpts=new Set(["aliases","builder","deprecatedAlias","fields","inherits","visitor","validate"]),validFieldKeys=new Set(["default","optional","deprecated","validate"]),store={};function defineType(type,opts={}){const inherits=opts.inherits&&store[opts.inherits]||{};let fields=opts.fields;if(!fields&&(fields={},inherits.fields)){const keys=Object.getOwnPropertyNames(inherits.fields);for(const key of keys){const field=inherits.fields[key],def=field.default;if(Array.isArray(def)?def.length>0:def&&"object"==typeof def)throw new Error("field defaults can only be primitives or empty arrays currently");fields[key]={default:Array.isArray(def)?[]:def,optional:field.optional,deprecated:field.deprecated,validate:field.validate}}}const visitor=opts.visitor||inherits.visitor||[],aliases=opts.aliases||inherits.aliases||[],builder=opts.builder||inherits.builder||opts.visitor||[];for(const k of Object.keys(opts))if(!validTypeOpts.has(k))throw new Error(`Unknown type option "${k}" on ${type}`);opts.deprecatedAlias&&(DEPRECATED_KEYS[opts.deprecatedAlias]=type);for(const key of visitor.concat(builder))fields[key]=fields[key]||{};for(const key of Object.keys(fields)){const field=fields[key];void 0===field.default||builder.includes(key)||(field.optional=!0),void 0===field.default?field.default=null:field.validate||null==field.default||(field.validate=assertValueType(getType(field.default)));for(const k of Object.keys(field))if(!validFieldKeys.has(k))throw new Error(`Unknown field key "${k}" on ${type}.${key}`)}VISITOR_KEYS[type]=opts.visitor=visitor,BUILDER_KEYS[type]=opts.builder=builder,NODE_FIELDS[type]=opts.fields=fields,ALIAS_KEYS[type]=opts.aliases=aliases,aliases.forEach((alias=>{FLIPPED_ALIAS_KEYS[alias]=FLIPPED_ALIAS_KEYS[alias]||[],FLIPPED_ALIAS_KEYS[alias].push(type)})),opts.validate&&(NODE_PARENT_VALIDATIONS[type]=opts.validate),store[type]=opts}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _exportNames={react:!0,assertNode:!0,createTypeAnnotationBasedOnTypeof:!0,createUnionTypeAnnotation:!0,createFlowUnionType:!0,createTSUnionType:!0,cloneNode:!0,clone:!0,cloneDeep:!0,cloneDeepWithoutLoc:!0,cloneWithoutLoc:!0,addComment:!0,addComments:!0,inheritInnerComments:!0,inheritLeadingComments:!0,inheritsComments:!0,inheritTrailingComments:!0,removeComments:!0,ensureBlock:!0,toBindingIdentifierName:!0,toBlock:!0,toComputedKey:!0,toExpression:!0,toIdentifier:!0,toKeyAlias:!0,toStatement:!0,valueToNode:!0,appendToMemberExpression:!0,inherits:!0,prependToMemberExpression:!0,removeProperties:!0,removePropertiesDeep:!0,removeTypeDuplicates:!0,getAssignmentIdentifiers:!0,getBindingIdentifiers:!0,getOuterBindingIdentifiers:!0,getFunctionName:!0,traverse:!0,traverseFast:!0,shallowEqual:!0,is:!0,isBinding:!0,isBlockScoped:!0,isImmutable:!0,isLet:!0,isNode:!0,isNodesEquivalent:!0,isPlaceholderType:!0,isReferenced:!0,isScope:!0,isSpecifierDefault:!0,isType:!0,isValidES3Identifier:!0,isValidIdentifier:!0,isVar:!0,matchesPattern:!0,validate:!0,buildMatchMemberExpression:!0,__internal__deprecationWarning:!0};Object.defineProperty(exports,"__internal__deprecationWarning",{enumerable:!0,get:function(){return _deprecationWarning.default}}),Object.defineProperty(exports,"addComment",{enumerable:!0,get:function(){return _addComment.default}}),Object.defineProperty(exports,"addComments",{enumerable:!0,get:function(){return _addComments.default}}),Object.defineProperty(exports,"appendToMemberExpression",{enumerable:!0,get:function(){return _appendToMemberExpression.default}}),Object.defineProperty(exports,"assertNode",{enumerable:!0,get:function(){return _assertNode.default}}),Object.defineProperty(exports,"buildMatchMemberExpression",{enumerable:!0,get:function(){return _buildMatchMemberExpression.default}}),Object.defineProperty(exports,"clone",{enumerable:!0,get:function(){return _clone.default}}),Object.defineProperty(exports,"cloneDeep",{enumerable:!0,get:function(){return _cloneDeep.default}}),Object.defineProperty(exports,"cloneDeepWithoutLoc",{enumerable:!0,get:function(){return _cloneDeepWithoutLoc.default}}),Object.defineProperty(exports,"cloneNode",{enumerable:!0,get:function(){return _cloneNode.default}}),Object.defineProperty(exports,"cloneWithoutLoc",{enumerable:!0,get:function(){return _cloneWithoutLoc.default}}),Object.defineProperty(exports,"createFlowUnionType",{enumerable:!0,get:function(){return _createFlowUnionType.default}}),Object.defineProperty(exports,"createTSUnionType",{enumerable:!0,get:function(){return _createTSUnionType.default}}),Object.defineProperty(exports,"createTypeAnnotationBasedOnTypeof",{enumerable:!0,get:function(){return _createTypeAnnotationBasedOnTypeof.default}}),Object.defineProperty(exports,"createUnionTypeAnnotation",{enumerable:!0,get:function(){return _createFlowUnionType.default}}),Object.defineProperty(exports,"ensureBlock",{enumerable:!0,get:function(){return _ensureBlock.default}}),Object.defineProperty(exports,"getAssignmentIdentifiers",{enumerable:!0,get:function(){return _getAssignmentIdentifiers.default}}),Object.defineProperty(exports,"getBindingIdentifiers",{enumerable:!0,get:function(){return _getBindingIdentifiers.default}}),Object.defineProperty(exports,"getFunctionName",{enumerable:!0,get:function(){return _getFunctionName.default}}),Object.defineProperty(exports,"getOuterBindingIdentifiers",{enumerable:!0,get:function(){return _getOuterBindingIdentifiers.default}}),Object.defineProperty(exports,"inheritInnerComments",{enumerable:!0,get:function(){return _inheritInnerComments.default}}),Object.defineProperty(exports,"inheritLeadingComments",{enumerable:!0,get:function(){return _inheritLeadingComments.default}}),Object.defineProperty(exports,"inheritTrailingComments",{enumerable:!0,get:function(){return _inheritTrailingComments.default}}),Object.defineProperty(exports,"inherits",{enumerable:!0,get:function(){return _inherits.default}}),Object.defineProperty(exports,"inheritsComments",{enumerable:!0,get:function(){return _inheritsComments.default}}),Object.defineProperty(exports,"is",{enumerable:!0,get:function(){return _is.default}}),Object.defineProperty(exports,"isBinding",{enumerable:!0,get:function(){return _isBinding.default}}),Object.defineProperty(exports,"isBlockScoped",{enumerable:!0,get:function(){return _isBlockScoped.default}}),Object.defineProperty(exports,"isImmutable",{enumerable:!0,get:function(){return _isImmutable.default}}),Object.defineProperty(exports,"isLet",{enumerable:!0,get:function(){return _isLet.default}}),Object.defineProperty(exports,"isNode",{enumerable:!0,get:function(){return _isNode.default}}),Object.defineProperty(exports,"isNodesEquivalent",{enumerable:!0,get:function(){return _isNodesEquivalent.default}}),Object.defineProperty(exports,"isPlaceholderType",{enumerable:!0,get:function(){return _isPlaceholderType.default}}),Object.defineProperty(exports,"isReferenced",{enumerable:!0,get:function(){return _isReferenced.default}}),Object.defineProperty(exports,"isScope",{enumerable:!0,get:function(){return _isScope.default}}),Object.defineProperty(exports,"isSpecifierDefault",{enumerable:!0,get:function(){return _isSpecifierDefault.default}}),Object.defineProperty(exports,"isType",{enumerable:!0,get:function(){return _isType.default}}),Object.defineProperty(exports,"isValidES3Identifier",{enumerable:!0,get:function(){return _isValidES3Identifier.default}}),Object.defineProperty(exports,"isValidIdentifier",{enumerable:!0,get:function(){return _isValidIdentifier.default}}),Object.defineProperty(exports,"isVar",{enumerable:!0,get:function(){return _isVar.default}}),Object.defineProperty(exports,"matchesPattern",{enumerable:!0,get:function(){return _matchesPattern.default}}),Object.defineProperty(exports,"prependToMemberExpression",{enumerable:!0,get:function(){return _prependToMemberExpression.default}}),exports.react=void 0,Object.defineProperty(exports,"removeComments",{enumerable:!0,get:function(){return _removeComments.default}}),Object.defineProperty(exports,"removeProperties",{enumerable:!0,get:function(){return _removeProperties.default}}),Object.defineProperty(exports,"removePropertiesDeep",{enumerable:!0,get:function(){return _removePropertiesDeep.default}}),Object.defineProperty(exports,"removeTypeDuplicates",{enumerable:!0,get:function(){return _removeTypeDuplicates.default}}),Object.defineProperty(exports,"shallowEqual",{enumerable:!0,get:function(){return _shallowEqual.default}}),Object.defineProperty(exports,"toBindingIdentifierName",{enumerable:!0,get:function(){return _toBindingIdentifierName.default}}),Object.defineProperty(exports,"toBlock",{enumerable:!0,get:function(){return _toBlock.default}}),Object.defineProperty(exports,"toComputedKey",{enumerable:!0,get:function(){return _toComputedKey.default}}),Object.defineProperty(exports,"toExpression",{enumerable:!0,get:function(){return _toExpression.default}}),Object.defineProperty(exports,"toIdentifier",{enumerable:!0,get:function(){return _toIdentifier.default}}),Object.defineProperty(exports,"toKeyAlias",{enumerable:!0,get:function(){return _toKeyAlias.default}}),Object.defineProperty(exports,"toStatement",{enumerable:!0,get:function(){return _toStatement.default}}),Object.defineProperty(exports,"traverse",{enumerable:!0,get:function(){return _traverse.default}}),Object.defineProperty(exports,"traverseFast",{enumerable:!0,get:function(){return _traverseFast.default}}),Object.defineProperty(exports,"validate",{enumerable:!0,get:function(){return _validate.default}}),Object.defineProperty(exports,"valueToNode",{enumerable:!0,get:function(){return _valueToNode.default}});var _isReactComponent=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isReactComponent.js"),_isCompatTag=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isCompatTag.js"),_buildChildren=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/react/buildChildren.js"),_assertNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/assertNode.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/generated/index.js");Object.keys(_index).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index[key]}}))}));var _createTypeAnnotationBasedOnTypeof=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createTypeAnnotationBasedOnTypeof.js"),_createFlowUnionType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createFlowUnionType.js"),_createTSUnionType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/typescript/createTSUnionType.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");Object.keys(_index2).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index2[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index2[key]}}))}));var _uppercase=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/uppercase.js");Object.keys(_uppercase).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_uppercase[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _uppercase[key]}}))}));var _productions=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/productions.js");Object.keys(_productions).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_productions[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _productions[key]}}))}));var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js"),_clone=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/clone.js"),_cloneDeep=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeep.js"),_cloneDeepWithoutLoc=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeepWithoutLoc.js"),_cloneWithoutLoc=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneWithoutLoc.js"),_addComment=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComment.js"),_addComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComments.js"),_inheritInnerComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritInnerComments.js"),_inheritLeadingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritLeadingComments.js"),_inheritsComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritsComments.js"),_inheritTrailingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritTrailingComments.js"),_removeComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/removeComments.js"),_index3=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/generated/index.js");Object.keys(_index3).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index3[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index3[key]}}))}));var _index4=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js");Object.keys(_index4).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index4[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index4[key]}}))}));var _ensureBlock=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/ensureBlock.js"),_toBindingIdentifierName=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBindingIdentifierName.js"),_toBlock=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBlock.js"),_toComputedKey=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toComputedKey.js"),_toExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toExpression.js"),_toIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toIdentifier.js"),_toKeyAlias=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toKeyAlias.js"),_toStatement=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toStatement.js"),_valueToNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/valueToNode.js"),_index5=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");Object.keys(_index5).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index5[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index5[key]}}))}));var _appendToMemberExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/appendToMemberExpression.js"),_inherits=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/inherits.js"),_prependToMemberExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/prependToMemberExpression.js"),_removeProperties=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removeProperties.js"),_removePropertiesDeep=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removePropertiesDeep.js"),_removeTypeDuplicates=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/flow/removeTypeDuplicates.js"),_getAssignmentIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getAssignmentIdentifiers.js"),_getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js"),_getOuterBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getOuterBindingIdentifiers.js"),_getFunctionName=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getFunctionName.js"),_traverse=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverse.js");Object.keys(_traverse).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_traverse[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _traverse[key]}}))}));var _traverseFast=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverseFast.js"),_shallowEqual=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js"),_is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_isBinding=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBinding.js"),_isBlockScoped=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBlockScoped.js"),_isImmutable=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isImmutable.js"),_isLet=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isLet.js"),_isNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNode.js"),_isNodesEquivalent=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNodesEquivalent.js"),_isPlaceholderType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isPlaceholderType.js"),_isReferenced=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isReferenced.js"),_isScope=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isScope.js"),_isSpecifierDefault=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isSpecifierDefault.js"),_isType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js"),_isValidES3Identifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidES3Identifier.js"),_isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_isVar=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isVar.js"),_matchesPattern=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/matchesPattern.js"),_validate=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js"),_buildMatchMemberExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/buildMatchMemberExpression.js"),_index6=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");Object.keys(_index6).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index6[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index6[key]}}))}));var _deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js");exports.react={isReactComponent:_isReactComponent.default,isCompatTag:_isCompatTag.default,buildChildren:_buildChildren.default};exports.toSequenceExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toSequenceExpression.js").default,process.env.BABEL_TYPES_8_BREAKING&&console.warn("BABEL_TYPES_8_BREAKING is not supported anymore. Use the latest Babel 8.0.0 pre-release instead!")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/appendToMemberExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(member,append,computed=!1){return member.object=(0,_index.memberExpression)(member.object,member.property,member.computed),member.property=append,member.computed=!!computed,member};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/flow/removeTypeDuplicates.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function removeTypeDuplicates(nodesIn){const nodes=Array.from(nodesIn),generics=new Map,bases=new Map,typeGroups=new Set,types=[];for(let i=0;i<nodes.length;i++){const node=nodes[i];if(node&&!types.includes(node)){if((0,_index.isAnyTypeAnnotation)(node))return[node];if((0,_index.isFlowBaseAnnotation)(node))bases.set(node.type,node);else if((0,_index.isUnionTypeAnnotation)(node))typeGroups.has(node.types)||(nodes.push(...node.types),typeGroups.add(node.types));else if((0,_index.isGenericTypeAnnotation)(node)){const name=getQualifiedName(node.id);if(generics.has(name)){let existing=generics.get(name);existing.typeParameters?node.typeParameters&&(existing.typeParameters.params.push(...node.typeParameters.params),existing.typeParameters.params=removeTypeDuplicates(existing.typeParameters.params)):existing=node.typeParameters}else generics.set(name,node)}else types.push(node)}}for(const[,baseType]of bases)types.push(baseType);for(const[,genericName]of generics)types.push(genericName);return types};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getQualifiedName(node){return(0,_index.isIdentifier)(node)?node.name:`${node.id.name}.${getQualifiedName(node.qualification)}`}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/inherits.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){if(!child||!parent)return child;for(const key of _index.INHERIT_KEYS.optional)null==child[key]&&(child[key]=parent[key]);for(const key of Object.keys(parent))"_"===key[0]&&"__clone"!==key&&(child[key]=parent[key]);for(const key of _index.INHERIT_KEYS.force)child[key]=parent[key];return(0,_inheritsComments.default)(child,parent),child};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js"),_inheritsComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritsComments.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/prependToMemberExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(member,prepend){if((0,_index2.isSuper)(member.object))throw new Error("Cannot prepend node to super property access (`super.foo`).");return member.object=(0,_index.memberExpression)(prepend,member.object),member};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removeProperties.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,opts={}){const map=opts.preserveComments?CLEAR_KEYS:CLEAR_KEYS_PLUS_COMMENTS;for(const key of map)null!=node[key]&&(node[key]=void 0);for(const key of Object.keys(node))"_"===key[0]&&null!=node[key]&&(node[key]=void 0);const symbols=Object.getOwnPropertySymbols(node);for(const sym of symbols)node[sym]=null};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js");const CLEAR_KEYS=["tokens","start","end","loc","raw","rawValue"],CLEAR_KEYS_PLUS_COMMENTS=[..._index.COMMENT_KEYS,"comments",...CLEAR_KEYS]},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removePropertiesDeep.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(tree,opts){return(0,_traverseFast.default)(tree,_removeProperties.default,opts),tree};var _traverseFast=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverseFast.js"),_removeProperties=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removeProperties.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/typescript/removeTypeDuplicates.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function removeTypeDuplicates(nodesIn){const nodes=Array.from(nodesIn),generics=new Map,bases=new Map,typeGroups=new Set,types=[];for(let i=0;i<nodes.length;i++){const node=nodes[i];if(node&&!types.includes(node)){if((0,_index.isTSAnyKeyword)(node))return[node];if((0,_index.isTSBaseType)(node))bases.set(node.type,node);else if((0,_index.isTSUnionType)(node))typeGroups.has(node.types)||(nodes.push(...node.types),typeGroups.add(node.types));else if((0,_index.isTSTypeReference)(node)&&node.typeParameters){const name=getQualifiedName(node.typeName);if(generics.has(name)){let existing=generics.get(name);existing.typeParameters?node.typeParameters&&(existing.typeParameters.params.push(...node.typeParameters.params),existing.typeParameters.params=removeTypeDuplicates(existing.typeParameters.params)):existing=node.typeParameters}else generics.set(name,node)}else types.push(node)}}for(const[,baseType]of bases)types.push(baseType);for(const[,genericName]of generics)types.push(genericName);return types};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getQualifiedName(node){return(0,_index.isIdentifier)(node)?node.name:`${node.right.name}.${getQualifiedName(node.left)}`}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getAssignmentIdentifiers.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){const search=[].concat(node),ids=Object.create(null);for(;search.length;){const id=search.pop();if(id)switch(id.type){case"ArrayPattern":search.push(...id.elements);break;case"AssignmentExpression":case"AssignmentPattern":case"ForInStatement":case"ForOfStatement":search.push(id.left);break;case"ObjectPattern":search.push(...id.properties);break;case"ObjectProperty":search.push(id.value);break;case"RestElement":case"UpdateExpression":search.push(id.argument);break;case"UnaryExpression":"delete"===id.operator&&search.push(id.argument);break;case"Identifier":ids[id.name]=id}}return ids}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=getBindingIdentifiers;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getBindingIdentifiers(node,duplicates,outerOnly,newBindingsOnly){const search=[].concat(node),ids=Object.create(null);for(;search.length;){const id=search.shift();if(!id)continue;if(newBindingsOnly&&((0,_index.isAssignmentExpression)(id)||(0,_index.isUnaryExpression)(id)||(0,_index.isUpdateExpression)(id)))continue;if((0,_index.isIdentifier)(id)){if(duplicates){(ids[id.name]=ids[id.name]||[]).push(id)}else ids[id.name]=id;continue}if((0,_index.isExportDeclaration)(id)&&!(0,_index.isExportAllDeclaration)(id)){(0,_index.isDeclaration)(id.declaration)&&search.push(id.declaration);continue}if(outerOnly){if((0,_index.isFunctionDeclaration)(id)){search.push(id.id);continue}if((0,_index.isFunctionExpression)(id))continue}const keys=getBindingIdentifiers.keys[id.type];if(keys)for(let i=0;i<keys.length;i++){const nodes=id[keys[i]];nodes&&(Array.isArray(nodes)?search.push(...nodes):search.push(nodes))}}return ids}getBindingIdentifiers.keys={DeclareClass:["id"],DeclareFunction:["id"],DeclareModule:["id"],DeclareVariable:["id"],DeclareInterface:["id"],DeclareTypeAlias:["id"],DeclareOpaqueType:["id"],InterfaceDeclaration:["id"],TypeAlias:["id"],OpaqueType:["id"],CatchClause:["param"],LabeledStatement:["label"],UnaryExpression:["argument"],AssignmentExpression:["left"],ImportSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportDefaultSpecifier:["local"],ImportDeclaration:["specifiers"],ExportSpecifier:["exported"],ExportNamespaceSpecifier:["exported"],ExportDefaultSpecifier:["exported"],FunctionDeclaration:["id","params"],FunctionExpression:["id","params"],ArrowFunctionExpression:["params"],ObjectMethod:["params"],ClassMethod:["params"],ClassPrivateMethod:["params"],ForInStatement:["left"],ForOfStatement:["left"],ClassDeclaration:["id"],ClassExpression:["id"],RestElement:["argument"],UpdateExpression:["argument"],ObjectProperty:["value"],AssignmentPattern:["left"],ArrayPattern:["elements"],ObjectPattern:["properties"],VariableDeclaration:["declarations"],VariableDeclarator:["id"]}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getFunctionName.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent){if("id"in node&&node.id)return{name:node.id.name,originalNode:node.id};let id,prefix="";(0,_index.isObjectProperty)(parent,{value:node})?id=getObjectMemberKey(parent):(0,_index.isObjectMethod)(node)||(0,_index.isClassMethod)(node)?(id=getObjectMemberKey(node),"get"===node.kind?prefix="get ":"set"===node.kind&&(prefix="set ")):(0,_index.isVariableDeclarator)(parent,{init:node})?id=parent.id:(0,_index.isAssignmentExpression)(parent,{operator:"=",right:node})&&(id=parent.left);if(!id)return null;const name=(0,_index.isLiteral)(id)?function(id){if((0,_index.isNullLiteral)(id))return"null";if((0,_index.isRegExpLiteral)(id))return`/${id.pattern}/${id.flags}`;if((0,_index.isTemplateLiteral)(id))return id.quasis.map((quasi=>quasi.value.raw)).join("");if(void 0!==id.value)return String(id.value);return null}(id):(0,_index.isIdentifier)(id)?id.name:(0,_index.isPrivateName)(id)?id.id.name:null;return null==name?null:{name:prefix+name,originalNode:id}};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getObjectMemberKey(node){if(!node.computed||(0,_index.isLiteral)(node.key))return node.key}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getOuterBindingIdentifiers.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js");exports.default=function(node,duplicates){return(0,_getBindingIdentifiers.default)(node,duplicates,!0)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverse.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,handlers,state){"function"==typeof handlers&&(handlers={enter:handlers});const{enter,exit}=handlers;traverseSimpleImpl(node,enter,exit,state,[])};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");function traverseSimpleImpl(node,enter,exit,state,ancestors){const keys=_index.VISITOR_KEYS[node.type];if(keys){enter&&enter(node,ancestors,state);for(const key of keys){const subNode=node[key];if(Array.isArray(subNode))for(let i=0;i<subNode.length;i++){const child=subNode[i];child&&(ancestors.push({node,key,index:i}),traverseSimpleImpl(child,enter,exit,state,ancestors),ancestors.pop())}else subNode&&(ancestors.push({node,key}),traverseSimpleImpl(subNode,enter,exit,state,ancestors),ancestors.pop())}exit&&exit(node,ancestors,state)}}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverseFast.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function traverseFast(node,enter,opts){if(!node)return;const keys=_index.VISITOR_KEYS[node.type];if(!keys)return;enter(node,opts=opts||{});for(const key of keys){const subNode=node[key];if(Array.isArray(subNode))for(const node of subNode)traverseFast(node,enter,opts);else traverseFast(subNode,enter,opts)}};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(oldName,newName,prefix=""){if(warnings.has(oldName))return;warnings.add(oldName);const{internal,trace}=function(skip,length){const{stackTraceLimit,prepareStackTrace}=Error;let stackTrace;if(Error.stackTraceLimit=1+skip+length,Error.prepareStackTrace=function(err,stack){stackTrace=stack},(new Error).stack,Error.stackTraceLimit=stackTraceLimit,Error.prepareStackTrace=prepareStackTrace,!stackTrace)return{internal:!1,trace:""};const shortStackTrace=stackTrace.slice(1+skip,1+skip+length);return{internal:/[\\/]@babel[\\/]/.test(shortStackTrace[1].getFileName()),trace:shortStackTrace.map((frame=>`    at ${frame}`)).join("\n")}}(1,2);if(internal)return;console.warn(`${prefix}\`${oldName}\` has been deprecated, please migrate to \`${newName}\`\n${trace}`)};const warnings=new Set},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(key,child,parent){child&&parent&&(child[key]=Array.from(new Set([].concat(child[key],parent[key]).filter(Boolean))))}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/react/cleanJSXElementLiteralChild.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,args){const lines=child.value.split(/\r\n|\n|\r/);let lastNonEmptyLine=0;for(let i=0;i<lines.length;i++)/[^ \t]/.exec(lines[i])&&(lastNonEmptyLine=i);let str="";for(let i=0;i<lines.length;i++){const line=lines[i],isFirstLine=0===i,isLastLine=i===lines.length-1,isLastNonEmptyLine=i===lastNonEmptyLine;let trimmedLine=line.replace(/\t/g," ");isFirstLine||(trimmedLine=trimmedLine.replace(/^ +/,"")),isLastLine||(trimmedLine=trimmedLine.replace(/ +$/,"")),trimmedLine&&(isLastNonEmptyLine||(trimmedLine+=" "),str+=trimmedLine)}str&&args.push((0,_index2.inherits)((0,_index.stringLiteral)(str),child))};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(actual,expected){const keys=Object.keys(expected);for(const key of keys)if(actual[key]!==expected[key])return!1;return!0}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/buildMatchMemberExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(match,allowPartial){const parts=match.split(".");return member=>(0,_matchesPattern.default)(member,parts,allowPartial)};var _matchesPattern=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/matchesPattern.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAccessor=function(node,opts){if(!node)return!1;if("ClassAccessorProperty"!==node.type)return!1;return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isAnyTypeAnnotation=function(node,opts){return!!node&&("AnyTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArgumentPlaceholder=function(node,opts){return!!node&&("ArgumentPlaceholder"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrayExpression=function(node,opts){return!!node&&("ArrayExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrayPattern=function(node,opts){return!!node&&("ArrayPattern"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrayTypeAnnotation=function(node,opts){return!!node&&("ArrayTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrowFunctionExpression=function(node,opts){return!!node&&("ArrowFunctionExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isAssignmentExpression=function(node,opts){return!!node&&("AssignmentExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isAssignmentPattern=function(node,opts){return!!node&&("AssignmentPattern"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isAwaitExpression=function(node,opts){return!!node&&("AwaitExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBigIntLiteral=function(node,opts){return!!node&&("BigIntLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBinary=function(node,opts){if(!node)return!1;switch(node.type){case"BinaryExpression":case"LogicalExpression":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isBinaryExpression=function(node,opts){return!!node&&("BinaryExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBindExpression=function(node,opts){return!!node&&("BindExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBlock=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"Program":case"TSModuleBlock":break;case"Placeholder":if("BlockStatement"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isBlockParent=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"FunctionExpression":case"Program":case"ObjectMethod":case"SwitchStatement":case"WhileStatement":case"ArrowFunctionExpression":case"ForOfStatement":case"ClassMethod":case"ClassPrivateMethod":case"StaticBlock":case"TSModuleBlock":break;case"Placeholder":if("BlockStatement"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isBlockStatement=function(node,opts){return!!node&&("BlockStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBooleanLiteral=function(node,opts){return!!node&&("BooleanLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBooleanLiteralTypeAnnotation=function(node,opts){return!!node&&("BooleanLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBooleanTypeAnnotation=function(node,opts){return!!node&&("BooleanTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBreakStatement=function(node,opts){return!!node&&("BreakStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isCallExpression=function(node,opts){return!!node&&("CallExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isCatchClause=function(node,opts){return!!node&&("CatchClause"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClass=function(node,opts){if(!node)return!1;switch(node.type){case"ClassExpression":case"ClassDeclaration":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isClassAccessorProperty=function(node,opts){return!!node&&("ClassAccessorProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassBody=function(node,opts){return!!node&&("ClassBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassDeclaration=function(node,opts){return!!node&&("ClassDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassExpression=function(node,opts){return!!node&&("ClassExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassImplements=function(node,opts){return!!node&&("ClassImplements"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassMethod=function(node,opts){return!!node&&("ClassMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassPrivateMethod=function(node,opts){return!!node&&("ClassPrivateMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassPrivateProperty=function(node,opts){return!!node&&("ClassPrivateProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassProperty=function(node,opts){return!!node&&("ClassProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isCompletionStatement=function(node,opts){if(!node)return!1;switch(node.type){case"BreakStatement":case"ContinueStatement":case"ReturnStatement":case"ThrowStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isConditional=function(node,opts){if(!node)return!1;switch(node.type){case"ConditionalExpression":case"IfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isConditionalExpression=function(node,opts){return!!node&&("ConditionalExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isContinueStatement=function(node,opts){return!!node&&("ContinueStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDebuggerStatement=function(node,opts){return!!node&&("DebuggerStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDecimalLiteral=function(node,opts){return!!node&&("DecimalLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclaration=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"VariableDeclaration":case"ClassDeclaration":case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ImportDeclaration":case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"InterfaceDeclaration":case"OpaqueType":case"TypeAlias":case"EnumDeclaration":case"TSDeclareFunction":case"TSInterfaceDeclaration":case"TSTypeAliasDeclaration":case"TSEnumDeclaration":case"TSModuleDeclaration":break;case"Placeholder":if("Declaration"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isDeclareClass=function(node,opts){return!!node&&("DeclareClass"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareExportAllDeclaration=function(node,opts){return!!node&&("DeclareExportAllDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareExportDeclaration=function(node,opts){return!!node&&("DeclareExportDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareFunction=function(node,opts){return!!node&&("DeclareFunction"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareInterface=function(node,opts){return!!node&&("DeclareInterface"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareModule=function(node,opts){return!!node&&("DeclareModule"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareModuleExports=function(node,opts){return!!node&&("DeclareModuleExports"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareOpaqueType=function(node,opts){return!!node&&("DeclareOpaqueType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareTypeAlias=function(node,opts){return!!node&&("DeclareTypeAlias"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareVariable=function(node,opts){return!!node&&("DeclareVariable"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclaredPredicate=function(node,opts){return!!node&&("DeclaredPredicate"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDecorator=function(node,opts){return!!node&&("Decorator"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDirective=function(node,opts){return!!node&&("Directive"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDirectiveLiteral=function(node,opts){return!!node&&("DirectiveLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDoExpression=function(node,opts){return!!node&&("DoExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDoWhileStatement=function(node,opts){return!!node&&("DoWhileStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEmptyStatement=function(node,opts){return!!node&&("EmptyStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEmptyTypeAnnotation=function(node,opts){return!!node&&("EmptyTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumBody=function(node,opts){if(!node)return!1;switch(node.type){case"EnumBooleanBody":case"EnumNumberBody":case"EnumStringBody":case"EnumSymbolBody":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isEnumBooleanBody=function(node,opts){return!!node&&("EnumBooleanBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumBooleanMember=function(node,opts){return!!node&&("EnumBooleanMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumDeclaration=function(node,opts){return!!node&&("EnumDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumDefaultedMember=function(node,opts){return!!node&&("EnumDefaultedMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumMember=function(node,opts){if(!node)return!1;switch(node.type){case"EnumBooleanMember":case"EnumNumberMember":case"EnumStringMember":case"EnumDefaultedMember":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isEnumNumberBody=function(node,opts){return!!node&&("EnumNumberBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumNumberMember=function(node,opts){return!!node&&("EnumNumberMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumStringBody=function(node,opts){return!!node&&("EnumStringBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumStringMember=function(node,opts){return!!node&&("EnumStringMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumSymbolBody=function(node,opts){return!!node&&("EnumSymbolBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExistsTypeAnnotation=function(node,opts){return!!node&&("ExistsTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportAllDeclaration=function(node,opts){return!!node&&("ExportAllDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportDeclaration=function(node,opts){if(!node)return!1;switch(node.type){case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isExportDefaultDeclaration=function(node,opts){return!!node&&("ExportDefaultDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportDefaultSpecifier=function(node,opts){return!!node&&("ExportDefaultSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportNamedDeclaration=function(node,opts){return!!node&&("ExportNamedDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportNamespaceSpecifier=function(node,opts){return!!node&&("ExportNamespaceSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportSpecifier=function(node,opts){return!!node&&("ExportSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExpression=function(node,opts){if(!node)return!1;switch(node.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ParenthesizedExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":case"ArrowFunctionExpression":case"ClassExpression":case"ImportExpression":case"MetaProperty":case"Super":case"TaggedTemplateExpression":case"TemplateLiteral":case"YieldExpression":case"AwaitExpression":case"Import":case"BigIntLiteral":case"OptionalMemberExpression":case"OptionalCallExpression":case"TypeCastExpression":case"JSXElement":case"JSXFragment":case"BindExpression":case"DoExpression":case"RecordExpression":case"TupleExpression":case"DecimalLiteral":case"ModuleExpression":case"TopicReference":case"PipelineTopicExpression":case"PipelineBareFunction":case"PipelinePrimaryTopicReference":case"TSInstantiationExpression":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":break;case"Placeholder":switch(node.expectedNode){case"Expression":case"Identifier":case"StringLiteral":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isExpressionStatement=function(node,opts){return!!node&&("ExpressionStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExpressionWrapper=function(node,opts){if(!node)return!1;switch(node.type){case"ExpressionStatement":case"ParenthesizedExpression":case"TypeCastExpression":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFile=function(node,opts){return!!node&&("File"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFlow=function(node,opts){if(!node)return!1;switch(node.type){case"AnyTypeAnnotation":case"ArrayTypeAnnotation":case"BooleanTypeAnnotation":case"BooleanLiteralTypeAnnotation":case"NullLiteralTypeAnnotation":case"ClassImplements":case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"DeclaredPredicate":case"ExistsTypeAnnotation":case"FunctionTypeAnnotation":case"FunctionTypeParam":case"GenericTypeAnnotation":case"InferredPredicate":case"InterfaceExtends":case"InterfaceDeclaration":case"InterfaceTypeAnnotation":case"IntersectionTypeAnnotation":case"MixedTypeAnnotation":case"EmptyTypeAnnotation":case"NullableTypeAnnotation":case"NumberLiteralTypeAnnotation":case"NumberTypeAnnotation":case"ObjectTypeAnnotation":case"ObjectTypeInternalSlot":case"ObjectTypeCallProperty":case"ObjectTypeIndexer":case"ObjectTypeProperty":case"ObjectTypeSpreadProperty":case"OpaqueType":case"QualifiedTypeIdentifier":case"StringLiteralTypeAnnotation":case"StringTypeAnnotation":case"SymbolTypeAnnotation":case"ThisTypeAnnotation":case"TupleTypeAnnotation":case"TypeofTypeAnnotation":case"TypeAlias":case"TypeAnnotation":case"TypeCastExpression":case"TypeParameter":case"TypeParameterDeclaration":case"TypeParameterInstantiation":case"UnionTypeAnnotation":case"Variance":case"VoidTypeAnnotation":case"EnumDeclaration":case"EnumBooleanBody":case"EnumNumberBody":case"EnumStringBody":case"EnumSymbolBody":case"EnumBooleanMember":case"EnumNumberMember":case"EnumStringMember":case"EnumDefaultedMember":case"IndexedAccessType":case"OptionalIndexedAccessType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowBaseAnnotation=function(node,opts){if(!node)return!1;switch(node.type){case"AnyTypeAnnotation":case"BooleanTypeAnnotation":case"NullLiteralTypeAnnotation":case"MixedTypeAnnotation":case"EmptyTypeAnnotation":case"NumberTypeAnnotation":case"StringTypeAnnotation":case"SymbolTypeAnnotation":case"ThisTypeAnnotation":case"VoidTypeAnnotation":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowDeclaration=function(node,opts){if(!node)return!1;switch(node.type){case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"InterfaceDeclaration":case"OpaqueType":case"TypeAlias":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowPredicate=function(node,opts){if(!node)return!1;switch(node.type){case"DeclaredPredicate":case"InferredPredicate":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowType=function(node,opts){if(!node)return!1;switch(node.type){case"AnyTypeAnnotation":case"ArrayTypeAnnotation":case"BooleanTypeAnnotation":case"BooleanLiteralTypeAnnotation":case"NullLiteralTypeAnnotation":case"ExistsTypeAnnotation":case"FunctionTypeAnnotation":case"GenericTypeAnnotation":case"InterfaceTypeAnnotation":case"IntersectionTypeAnnotation":case"MixedTypeAnnotation":case"EmptyTypeAnnotation":case"NullableTypeAnnotation":case"NumberLiteralTypeAnnotation":case"NumberTypeAnnotation":case"ObjectTypeAnnotation":case"StringLiteralTypeAnnotation":case"StringTypeAnnotation":case"SymbolTypeAnnotation":case"ThisTypeAnnotation":case"TupleTypeAnnotation":case"TypeofTypeAnnotation":case"UnionTypeAnnotation":case"VoidTypeAnnotation":case"IndexedAccessType":case"OptionalIndexedAccessType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFor=function(node,opts){if(!node)return!1;switch(node.type){case"ForInStatement":case"ForStatement":case"ForOfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isForInStatement=function(node,opts){return!!node&&("ForInStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isForOfStatement=function(node,opts){return!!node&&("ForOfStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isForStatement=function(node,opts){return!!node&&("ForStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isForXStatement=function(node,opts){if(!node)return!1;switch(node.type){case"ForInStatement":case"ForOfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFunction=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"FunctionExpression":case"ObjectMethod":case"ArrowFunctionExpression":case"ClassMethod":case"ClassPrivateMethod":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFunctionDeclaration=function(node,opts){return!!node&&("FunctionDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFunctionExpression=function(node,opts){return!!node&&("FunctionExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFunctionParent=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"FunctionExpression":case"ObjectMethod":case"ArrowFunctionExpression":case"ClassMethod":case"ClassPrivateMethod":case"StaticBlock":case"TSModuleBlock":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFunctionTypeAnnotation=function(node,opts){return!!node&&("FunctionTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFunctionTypeParam=function(node,opts){return!!node&&("FunctionTypeParam"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isGenericTypeAnnotation=function(node,opts){return!!node&&("GenericTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIdentifier=function(node,opts){return!!node&&("Identifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIfStatement=function(node,opts){return!!node&&("IfStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImmutable=function(node,opts){if(!node)return!1;switch(node.type){case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"BigIntLiteral":case"JSXAttribute":case"JSXClosingElement":case"JSXElement":case"JSXExpressionContainer":case"JSXSpreadChild":case"JSXOpeningElement":case"JSXText":case"JSXFragment":case"JSXOpeningFragment":case"JSXClosingFragment":case"DecimalLiteral":break;case"Placeholder":if("StringLiteral"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isImport=function(node,opts){return!!node&&("Import"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportAttribute=function(node,opts){return!!node&&("ImportAttribute"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportDeclaration=function(node,opts){return!!node&&("ImportDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportDefaultSpecifier=function(node,opts){return!!node&&("ImportDefaultSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportExpression=function(node,opts){return!!node&&("ImportExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportNamespaceSpecifier=function(node,opts){return!!node&&("ImportNamespaceSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportOrExportDeclaration=isImportOrExportDeclaration,exports.isImportSpecifier=function(node,opts){return!!node&&("ImportSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIndexedAccessType=function(node,opts){return!!node&&("IndexedAccessType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInferredPredicate=function(node,opts){return!!node&&("InferredPredicate"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterfaceDeclaration=function(node,opts){return!!node&&("InterfaceDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterfaceExtends=function(node,opts){return!!node&&("InterfaceExtends"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterfaceTypeAnnotation=function(node,opts){return!!node&&("InterfaceTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterpreterDirective=function(node,opts){return!!node&&("InterpreterDirective"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIntersectionTypeAnnotation=function(node,opts){return!!node&&("IntersectionTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSX=function(node,opts){if(!node)return!1;switch(node.type){case"JSXAttribute":case"JSXClosingElement":case"JSXElement":case"JSXEmptyExpression":case"JSXExpressionContainer":case"JSXSpreadChild":case"JSXIdentifier":case"JSXMemberExpression":case"JSXNamespacedName":case"JSXOpeningElement":case"JSXSpreadAttribute":case"JSXText":case"JSXFragment":case"JSXOpeningFragment":case"JSXClosingFragment":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isJSXAttribute=function(node,opts){return!!node&&("JSXAttribute"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXClosingElement=function(node,opts){return!!node&&("JSXClosingElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXClosingFragment=function(node,opts){return!!node&&("JSXClosingFragment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXElement=function(node,opts){return!!node&&("JSXElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXEmptyExpression=function(node,opts){return!!node&&("JSXEmptyExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXExpressionContainer=function(node,opts){return!!node&&("JSXExpressionContainer"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXFragment=function(node,opts){return!!node&&("JSXFragment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXIdentifier=function(node,opts){return!!node&&("JSXIdentifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXMemberExpression=function(node,opts){return!!node&&("JSXMemberExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXNamespacedName=function(node,opts){return!!node&&("JSXNamespacedName"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXOpeningElement=function(node,opts){return!!node&&("JSXOpeningElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXOpeningFragment=function(node,opts){return!!node&&("JSXOpeningFragment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXSpreadAttribute=function(node,opts){return!!node&&("JSXSpreadAttribute"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXSpreadChild=function(node,opts){return!!node&&("JSXSpreadChild"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXText=function(node,opts){return!!node&&("JSXText"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isLVal=function(node,opts){if(!node)return!1;switch(node.type){case"Identifier":case"MemberExpression":case"RestElement":case"AssignmentPattern":case"ArrayPattern":case"ObjectPattern":case"TSParameterProperty":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":break;case"Placeholder":switch(node.expectedNode){case"Pattern":case"Identifier":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isLabeledStatement=function(node,opts){return!!node&&("LabeledStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isLiteral=function(node,opts){if(!node)return!1;switch(node.type){case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"TemplateLiteral":case"BigIntLiteral":case"DecimalLiteral":break;case"Placeholder":if("StringLiteral"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isLogicalExpression=function(node,opts){return!!node&&("LogicalExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isLoop=function(node,opts){if(!node)return!1;switch(node.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":case"ForOfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isMemberExpression=function(node,opts){return!!node&&("MemberExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isMetaProperty=function(node,opts){return!!node&&("MetaProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isMethod=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectMethod":case"ClassMethod":case"ClassPrivateMethod":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isMiscellaneous=function(node,opts){if(!node)return!1;switch(node.type){case"Noop":case"Placeholder":case"V8IntrinsicIdentifier":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isMixedTypeAnnotation=function(node,opts){return!!node&&("MixedTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isModuleDeclaration=function(node,opts){return(0,_deprecationWarning.default)("isModuleDeclaration","isImportOrExportDeclaration"),isImportOrExportDeclaration(node,opts)},exports.isModuleExpression=function(node,opts){return!!node&&("ModuleExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isModuleSpecifier=function(node,opts){if(!node)return!1;switch(node.type){case"ExportSpecifier":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"ImportSpecifier":case"ExportNamespaceSpecifier":case"ExportDefaultSpecifier":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isNewExpression=function(node,opts){return!!node&&("NewExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNoop=function(node,opts){return!!node&&("Noop"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNullLiteral=function(node,opts){return!!node&&("NullLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNullLiteralTypeAnnotation=function(node,opts){return!!node&&("NullLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNullableTypeAnnotation=function(node,opts){return!!node&&("NullableTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumberLiteral=function(node,opts){return(0,_deprecationWarning.default)("isNumberLiteral","isNumericLiteral"),!!node&&("NumberLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumberLiteralTypeAnnotation=function(node,opts){return!!node&&("NumberLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumberTypeAnnotation=function(node,opts){return!!node&&("NumberTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumericLiteral=function(node,opts){return!!node&&("NumericLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectExpression=function(node,opts){return!!node&&("ObjectExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectMember=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectMethod":case"ObjectProperty":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isObjectMethod=function(node,opts){return!!node&&("ObjectMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectPattern=function(node,opts){return!!node&&("ObjectPattern"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectProperty=function(node,opts){return!!node&&("ObjectProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeAnnotation=function(node,opts){return!!node&&("ObjectTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeCallProperty=function(node,opts){return!!node&&("ObjectTypeCallProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeIndexer=function(node,opts){return!!node&&("ObjectTypeIndexer"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeInternalSlot=function(node,opts){return!!node&&("ObjectTypeInternalSlot"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeProperty=function(node,opts){return!!node&&("ObjectTypeProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeSpreadProperty=function(node,opts){return!!node&&("ObjectTypeSpreadProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOpaqueType=function(node,opts){return!!node&&("OpaqueType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOptionalCallExpression=function(node,opts){return!!node&&("OptionalCallExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOptionalIndexedAccessType=function(node,opts){return!!node&&("OptionalIndexedAccessType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOptionalMemberExpression=function(node,opts){return!!node&&("OptionalMemberExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isParenthesizedExpression=function(node,opts){return!!node&&("ParenthesizedExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPattern=function(node,opts){if(!node)return!1;switch(node.type){case"AssignmentPattern":case"ArrayPattern":case"ObjectPattern":break;case"Placeholder":if("Pattern"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPatternLike=function(node,opts){if(!node)return!1;switch(node.type){case"Identifier":case"RestElement":case"AssignmentPattern":case"ArrayPattern":case"ObjectPattern":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":break;case"Placeholder":switch(node.expectedNode){case"Pattern":case"Identifier":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPipelineBareFunction=function(node,opts){return!!node&&("PipelineBareFunction"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPipelinePrimaryTopicReference=function(node,opts){return!!node&&("PipelinePrimaryTopicReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPipelineTopicExpression=function(node,opts){return!!node&&("PipelineTopicExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPlaceholder=function(node,opts){return!!node&&("Placeholder"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPrivate=function(node,opts){if(!node)return!1;switch(node.type){case"ClassPrivateProperty":case"ClassPrivateMethod":case"PrivateName":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPrivateName=function(node,opts){return!!node&&("PrivateName"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isProgram=function(node,opts){return!!node&&("Program"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isProperty=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectProperty":case"ClassProperty":case"ClassAccessorProperty":case"ClassPrivateProperty":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPureish=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"FunctionExpression":case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"ArrowFunctionExpression":case"BigIntLiteral":case"DecimalLiteral":break;case"Placeholder":if("StringLiteral"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isQualifiedTypeIdentifier=function(node,opts){return!!node&&("QualifiedTypeIdentifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRecordExpression=function(node,opts){return!!node&&("RecordExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRegExpLiteral=function(node,opts){return!!node&&("RegExpLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRegexLiteral=function(node,opts){return(0,_deprecationWarning.default)("isRegexLiteral","isRegExpLiteral"),!!node&&("RegexLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRestElement=function(node,opts){return!!node&&("RestElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRestProperty=function(node,opts){return(0,_deprecationWarning.default)("isRestProperty","isRestElement"),!!node&&("RestProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isReturnStatement=function(node,opts){return!!node&&("ReturnStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isScopable=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"FunctionExpression":case"Program":case"ObjectMethod":case"SwitchStatement":case"WhileStatement":case"ArrowFunctionExpression":case"ClassExpression":case"ClassDeclaration":case"ForOfStatement":case"ClassMethod":case"ClassPrivateMethod":case"StaticBlock":case"TSModuleBlock":break;case"Placeholder":if("BlockStatement"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isSequenceExpression=function(node,opts){return!!node&&("SequenceExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSpreadElement=function(node,opts){return!!node&&("SpreadElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSpreadProperty=function(node,opts){return(0,_deprecationWarning.default)("isSpreadProperty","isSpreadElement"),!!node&&("SpreadProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStandardized=function(node,opts){if(!node)return!1;switch(node.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"InterpreterDirective":case"Directive":case"DirectiveLiteral":case"BlockStatement":case"BreakStatement":case"CallExpression":case"CatchClause":case"ConditionalExpression":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"File":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"FunctionExpression":case"Identifier":case"IfStatement":case"LabeledStatement":case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"Program":case"ObjectExpression":case"ObjectMethod":case"ObjectProperty":case"RestElement":case"ReturnStatement":case"SequenceExpression":case"ParenthesizedExpression":case"SwitchCase":case"SwitchStatement":case"ThisExpression":case"ThrowStatement":case"TryStatement":case"UnaryExpression":case"UpdateExpression":case"VariableDeclaration":case"VariableDeclarator":case"WhileStatement":case"WithStatement":case"AssignmentPattern":case"ArrayPattern":case"ArrowFunctionExpression":case"ClassBody":case"ClassExpression":case"ClassDeclaration":case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ExportSpecifier":case"ForOfStatement":case"ImportDeclaration":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"ImportSpecifier":case"ImportExpression":case"MetaProperty":case"ClassMethod":case"ObjectPattern":case"SpreadElement":case"Super":case"TaggedTemplateExpression":case"TemplateElement":case"TemplateLiteral":case"YieldExpression":case"AwaitExpression":case"Import":case"BigIntLiteral":case"ExportNamespaceSpecifier":case"OptionalMemberExpression":case"OptionalCallExpression":case"ClassProperty":case"ClassAccessorProperty":case"ClassPrivateProperty":case"ClassPrivateMethod":case"PrivateName":case"StaticBlock":break;case"Placeholder":switch(node.expectedNode){case"Identifier":case"StringLiteral":case"BlockStatement":case"ClassBody":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isStatement=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":case"ClassDeclaration":case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ForOfStatement":case"ImportDeclaration":case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"InterfaceDeclaration":case"OpaqueType":case"TypeAlias":case"EnumDeclaration":case"TSDeclareFunction":case"TSInterfaceDeclaration":case"TSTypeAliasDeclaration":case"TSEnumDeclaration":case"TSModuleDeclaration":case"TSImportEqualsDeclaration":case"TSExportAssignment":case"TSNamespaceExportDeclaration":break;case"Placeholder":switch(node.expectedNode){case"Statement":case"Declaration":case"BlockStatement":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isStaticBlock=function(node,opts){return!!node&&("StaticBlock"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStringLiteral=function(node,opts){return!!node&&("StringLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStringLiteralTypeAnnotation=function(node,opts){return!!node&&("StringLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStringTypeAnnotation=function(node,opts){return!!node&&("StringTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSuper=function(node,opts){return!!node&&("Super"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSwitchCase=function(node,opts){return!!node&&("SwitchCase"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSwitchStatement=function(node,opts){return!!node&&("SwitchStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSymbolTypeAnnotation=function(node,opts){return!!node&&("SymbolTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSAnyKeyword=function(node,opts){return!!node&&("TSAnyKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSArrayType=function(node,opts){return!!node&&("TSArrayType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSAsExpression=function(node,opts){return!!node&&("TSAsExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSBaseType=function(node,opts){if(!node)return!1;switch(node.type){case"TSAnyKeyword":case"TSBooleanKeyword":case"TSBigIntKeyword":case"TSIntrinsicKeyword":case"TSNeverKeyword":case"TSNullKeyword":case"TSNumberKeyword":case"TSObjectKeyword":case"TSStringKeyword":case"TSSymbolKeyword":case"TSUndefinedKeyword":case"TSUnknownKeyword":case"TSVoidKeyword":case"TSThisType":case"TSLiteralType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSBigIntKeyword=function(node,opts){return!!node&&("TSBigIntKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSBooleanKeyword=function(node,opts){return!!node&&("TSBooleanKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSCallSignatureDeclaration=function(node,opts){return!!node&&("TSCallSignatureDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSConditionalType=function(node,opts){return!!node&&("TSConditionalType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSConstructSignatureDeclaration=function(node,opts){return!!node&&("TSConstructSignatureDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSConstructorType=function(node,opts){return!!node&&("TSConstructorType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSDeclareFunction=function(node,opts){return!!node&&("TSDeclareFunction"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSDeclareMethod=function(node,opts){return!!node&&("TSDeclareMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSEntityName=function(node,opts){if(!node)return!1;switch(node.type){case"Identifier":case"TSQualifiedName":break;case"Placeholder":if("Identifier"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSEnumDeclaration=function(node,opts){return!!node&&("TSEnumDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSEnumMember=function(node,opts){return!!node&&("TSEnumMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSExportAssignment=function(node,opts){return!!node&&("TSExportAssignment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSExpressionWithTypeArguments=function(node,opts){return!!node&&("TSExpressionWithTypeArguments"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSExternalModuleReference=function(node,opts){return!!node&&("TSExternalModuleReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSFunctionType=function(node,opts){return!!node&&("TSFunctionType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSImportEqualsDeclaration=function(node,opts){return!!node&&("TSImportEqualsDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSImportType=function(node,opts){return!!node&&("TSImportType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIndexSignature=function(node,opts){return!!node&&("TSIndexSignature"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIndexedAccessType=function(node,opts){return!!node&&("TSIndexedAccessType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInferType=function(node,opts){return!!node&&("TSInferType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInstantiationExpression=function(node,opts){return!!node&&("TSInstantiationExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInterfaceBody=function(node,opts){return!!node&&("TSInterfaceBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInterfaceDeclaration=function(node,opts){return!!node&&("TSInterfaceDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIntersectionType=function(node,opts){return!!node&&("TSIntersectionType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIntrinsicKeyword=function(node,opts){return!!node&&("TSIntrinsicKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSLiteralType=function(node,opts){return!!node&&("TSLiteralType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSMappedType=function(node,opts){return!!node&&("TSMappedType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSMethodSignature=function(node,opts){return!!node&&("TSMethodSignature"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSModuleBlock=function(node,opts){return!!node&&("TSModuleBlock"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSModuleDeclaration=function(node,opts){return!!node&&("TSModuleDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNamedTupleMember=function(node,opts){return!!node&&("TSNamedTupleMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNamespaceExportDeclaration=function(node,opts){return!!node&&("TSNamespaceExportDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNeverKeyword=function(node,opts){return!!node&&("TSNeverKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNonNullExpression=function(node,opts){return!!node&&("TSNonNullExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNullKeyword=function(node,opts){return!!node&&("TSNullKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNumberKeyword=function(node,opts){return!!node&&("TSNumberKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSObjectKeyword=function(node,opts){return!!node&&("TSObjectKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSOptionalType=function(node,opts){return!!node&&("TSOptionalType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSParameterProperty=function(node,opts){return!!node&&("TSParameterProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSParenthesizedType=function(node,opts){return!!node&&("TSParenthesizedType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSPropertySignature=function(node,opts){return!!node&&("TSPropertySignature"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSQualifiedName=function(node,opts){return!!node&&("TSQualifiedName"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSRestType=function(node,opts){return!!node&&("TSRestType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSSatisfiesExpression=function(node,opts){return!!node&&("TSSatisfiesExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSStringKeyword=function(node,opts){return!!node&&("TSStringKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSSymbolKeyword=function(node,opts){return!!node&&("TSSymbolKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSThisType=function(node,opts){return!!node&&("TSThisType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTupleType=function(node,opts){return!!node&&("TSTupleType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSType=function(node,opts){if(!node)return!1;switch(node.type){case"TSAnyKeyword":case"TSBooleanKeyword":case"TSBigIntKeyword":case"TSIntrinsicKeyword":case"TSNeverKeyword":case"TSNullKeyword":case"TSNumberKeyword":case"TSObjectKeyword":case"TSStringKeyword":case"TSSymbolKeyword":case"TSUndefinedKeyword":case"TSUnknownKeyword":case"TSVoidKeyword":case"TSThisType":case"TSFunctionType":case"TSConstructorType":case"TSTypeReference":case"TSTypePredicate":case"TSTypeQuery":case"TSTypeLiteral":case"TSArrayType":case"TSTupleType":case"TSOptionalType":case"TSRestType":case"TSUnionType":case"TSIntersectionType":case"TSConditionalType":case"TSInferType":case"TSParenthesizedType":case"TSTypeOperator":case"TSIndexedAccessType":case"TSMappedType":case"TSLiteralType":case"TSExpressionWithTypeArguments":case"TSImportType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSTypeAliasDeclaration=function(node,opts){return!!node&&("TSTypeAliasDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeAnnotation=function(node,opts){return!!node&&("TSTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeAssertion=function(node,opts){return!!node&&("TSTypeAssertion"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeElement=function(node,opts){if(!node)return!1;switch(node.type){case"TSCallSignatureDeclaration":case"TSConstructSignatureDeclaration":case"TSPropertySignature":case"TSMethodSignature":case"TSIndexSignature":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSTypeLiteral=function(node,opts){return!!node&&("TSTypeLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeOperator=function(node,opts){return!!node&&("TSTypeOperator"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeParameter=function(node,opts){return!!node&&("TSTypeParameter"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeParameterDeclaration=function(node,opts){return!!node&&("TSTypeParameterDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeParameterInstantiation=function(node,opts){return!!node&&("TSTypeParameterInstantiation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypePredicate=function(node,opts){return!!node&&("TSTypePredicate"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeQuery=function(node,opts){return!!node&&("TSTypeQuery"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeReference=function(node,opts){return!!node&&("TSTypeReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSUndefinedKeyword=function(node,opts){return!!node&&("TSUndefinedKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSUnionType=function(node,opts){return!!node&&("TSUnionType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSUnknownKeyword=function(node,opts){return!!node&&("TSUnknownKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSVoidKeyword=function(node,opts){return!!node&&("TSVoidKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTaggedTemplateExpression=function(node,opts){return!!node&&("TaggedTemplateExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTemplateElement=function(node,opts){return!!node&&("TemplateElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTemplateLiteral=function(node,opts){return!!node&&("TemplateLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTerminatorless=function(node,opts){if(!node)return!1;switch(node.type){case"BreakStatement":case"ContinueStatement":case"ReturnStatement":case"ThrowStatement":case"YieldExpression":case"AwaitExpression":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isThisExpression=function(node,opts){return!!node&&("ThisExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isThisTypeAnnotation=function(node,opts){return!!node&&("ThisTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isThrowStatement=function(node,opts){return!!node&&("ThrowStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTopicReference=function(node,opts){return!!node&&("TopicReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTryStatement=function(node,opts){return!!node&&("TryStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTupleExpression=function(node,opts){return!!node&&("TupleExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTupleTypeAnnotation=function(node,opts){return!!node&&("TupleTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeAlias=function(node,opts){return!!node&&("TypeAlias"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeAnnotation=function(node,opts){return!!node&&("TypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeCastExpression=function(node,opts){return!!node&&("TypeCastExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeParameter=function(node,opts){return!!node&&("TypeParameter"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeParameterDeclaration=function(node,opts){return!!node&&("TypeParameterDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeParameterInstantiation=function(node,opts){return!!node&&("TypeParameterInstantiation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeScript=function(node,opts){if(!node)return!1;switch(node.type){case"TSParameterProperty":case"TSDeclareFunction":case"TSDeclareMethod":case"TSQualifiedName":case"TSCallSignatureDeclaration":case"TSConstructSignatureDeclaration":case"TSPropertySignature":case"TSMethodSignature":case"TSIndexSignature":case"TSAnyKeyword":case"TSBooleanKeyword":case"TSBigIntKeyword":case"TSIntrinsicKeyword":case"TSNeverKeyword":case"TSNullKeyword":case"TSNumberKeyword":case"TSObjectKeyword":case"TSStringKeyword":case"TSSymbolKeyword":case"TSUndefinedKeyword":case"TSUnknownKeyword":case"TSVoidKeyword":case"TSThisType":case"TSFunctionType":case"TSConstructorType":case"TSTypeReference":case"TSTypePredicate":case"TSTypeQuery":case"TSTypeLiteral":case"TSArrayType":case"TSTupleType":case"TSOptionalType":case"TSRestType":case"TSNamedTupleMember":case"TSUnionType":case"TSIntersectionType":case"TSConditionalType":case"TSInferType":case"TSParenthesizedType":case"TSTypeOperator":case"TSIndexedAccessType":case"TSMappedType":case"TSLiteralType":case"TSExpressionWithTypeArguments":case"TSInterfaceDeclaration":case"TSInterfaceBody":case"TSTypeAliasDeclaration":case"TSInstantiationExpression":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSEnumDeclaration":case"TSEnumMember":case"TSModuleDeclaration":case"TSModuleBlock":case"TSImportType":case"TSImportEqualsDeclaration":case"TSExternalModuleReference":case"TSNonNullExpression":case"TSExportAssignment":case"TSNamespaceExportDeclaration":case"TSTypeAnnotation":case"TSTypeParameterInstantiation":case"TSTypeParameterDeclaration":case"TSTypeParameter":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTypeofTypeAnnotation=function(node,opts){return!!node&&("TypeofTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUnaryExpression=function(node,opts){return!!node&&("UnaryExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUnaryLike=function(node,opts){if(!node)return!1;switch(node.type){case"UnaryExpression":case"SpreadElement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isUnionTypeAnnotation=function(node,opts){return!!node&&("UnionTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUpdateExpression=function(node,opts){return!!node&&("UpdateExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUserWhitespacable=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectMethod":case"ObjectProperty":case"ObjectTypeInternalSlot":case"ObjectTypeCallProperty":case"ObjectTypeIndexer":case"ObjectTypeProperty":case"ObjectTypeSpreadProperty":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isV8IntrinsicIdentifier=function(node,opts){return!!node&&("V8IntrinsicIdentifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVariableDeclaration=function(node,opts){return!!node&&("VariableDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVariableDeclarator=function(node,opts){return!!node&&("VariableDeclarator"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVariance=function(node,opts){return!!node&&("Variance"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVoidTypeAnnotation=function(node,opts){return!!node&&("VoidTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isWhile=function(node,opts){if(!node)return!1;switch(node.type){case"DoWhileStatement":case"WhileStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isWhileStatement=function(node,opts){return!!node&&("WhileStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isWithStatement=function(node,opts){return!!node&&("WithStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isYieldExpression=function(node,opts){return!!node&&("YieldExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))};var _shallowEqual=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js"),_deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js");function isImportOrExportDeclaration(node,opts){if(!node)return!1;switch(node.type){case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ImportDeclaration":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(type,node,opts){if(!node)return!1;if(!(0,_isType.default)(node.type,type))return!opts&&"Placeholder"===node.type&&type in _index.FLIPPED_ALIAS_KEYS&&(0,_isPlaceholderType.default)(node.expectedNode,type);return void 0===opts||(0,_shallowEqual.default)(node,opts)};var _shallowEqual=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js"),_isType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js"),_isPlaceholderType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isPlaceholderType.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBinding.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent,grandparent){if(grandparent&&"Identifier"===node.type&&"ObjectProperty"===parent.type&&"ObjectExpression"===grandparent.type)return!1;const keys=_getBindingIdentifiers.default.keys[parent.type];if(keys)for(let i=0;i<keys.length;i++){const val=parent[keys[i]];if(Array.isArray(val)){if(val.includes(node))return!0}else if(val===node)return!0}return!1};var _getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBlockScoped.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_index.isFunctionDeclaration)(node)||(0,_index.isClassDeclaration)(node)||(0,_isLet.default)(node)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_isLet=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isLet.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isImmutable.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){if((0,_isType.default)(node.type,"Immutable"))return!0;if((0,_index.isIdentifier)(node))return"undefined"===node.name;return!1};var _isType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isLet.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_index.isVariableDeclaration)(node)&&("var"!==node.kind||node[_index2.BLOCK_SCOPED_SYMBOL])};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return!(!node||!_index.VISITOR_KEYS[node.type])};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNodesEquivalent.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function isNodesEquivalent(a,b){if("object"!=typeof a||"object"!=typeof b||null==a||null==b)return a===b;if(a.type!==b.type)return!1;const fields=Object.keys(_index.NODE_FIELDS[a.type]||a.type),visitorKeys=_index.VISITOR_KEYS[a.type];for(const field of fields){const val_a=a[field],val_b=b[field];if(typeof val_a!=typeof val_b)return!1;if(null!=val_a||null!=val_b){if(null==val_a||null==val_b)return!1;if(Array.isArray(val_a)){if(!Array.isArray(val_b))return!1;if(val_a.length!==val_b.length)return!1;for(let i=0;i<val_a.length;i++)if(!isNodesEquivalent(val_a[i],val_b[i]))return!1}else if("object"!=typeof val_a||null!=visitorKeys&&visitorKeys.includes(field)){if(!isNodesEquivalent(val_a,val_b))return!1}else for(const key of Object.keys(val_a))if(val_a[key]!==val_b[key])return!1}}return!0};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isPlaceholderType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(placeholderType,targetType){if(placeholderType===targetType)return!0;const aliases=_index.PLACEHOLDERS_ALIAS[placeholderType];if(aliases)for(const alias of aliases)if(targetType===alias)return!0;return!1};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isReferenced.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent,grandparent){switch(parent.type){case"MemberExpression":case"OptionalMemberExpression":return parent.property===node?!!parent.computed:parent.object===node;case"JSXMemberExpression":return parent.object===node;case"VariableDeclarator":return parent.init===node;case"ArrowFunctionExpression":return parent.body===node;case"PrivateName":case"LabeledStatement":case"CatchClause":case"RestElement":case"BreakStatement":case"ContinueStatement":case"FunctionDeclaration":case"FunctionExpression":case"ExportNamespaceSpecifier":case"ExportDefaultSpecifier":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"ImportSpecifier":case"ImportAttribute":case"JSXAttribute":case"ObjectPattern":case"ArrayPattern":case"MetaProperty":return!1;case"ClassMethod":case"ClassPrivateMethod":case"ObjectMethod":return parent.key===node&&!!parent.computed;case"ObjectProperty":return parent.key===node?!!parent.computed:!grandparent||"ObjectPattern"!==grandparent.type;case"ClassProperty":case"ClassAccessorProperty":case"TSPropertySignature":return parent.key!==node||!!parent.computed;case"ClassPrivateProperty":case"ObjectTypeProperty":return parent.key!==node;case"ClassDeclaration":case"ClassExpression":return parent.superClass===node;case"AssignmentExpression":case"AssignmentPattern":return parent.right===node;case"ExportSpecifier":return(null==grandparent||!grandparent.source)&&parent.local===node;case"TSEnumMember":return parent.id!==node}return!0}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isScope.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent){if((0,_index.isBlockStatement)(node)&&((0,_index.isFunction)(parent)||(0,_index.isCatchClause)(parent)))return!1;if((0,_index.isPattern)(node)&&((0,_index.isFunction)(parent)||(0,_index.isCatchClause)(parent)))return!0;return(0,_index.isScopable)(node)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isSpecifierDefault.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(specifier){return(0,_index.isImportDefaultSpecifier)(specifier)||(0,_index.isIdentifier)(specifier.imported||specifier.exported,{name:"default"})};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(nodeType,targetType){if(nodeType===targetType)return!0;if(null==nodeType)return!1;if(_index.ALIAS_KEYS[targetType])return!1;const aliases=_index.FLIPPED_ALIAS_KEYS[targetType];if(aliases){if(aliases[0]===nodeType)return!0;for(const alias of aliases)if(nodeType===alias)return!0}return!1};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidES3Identifier.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(name){return(0,_isValidIdentifier.default)(name)&&!RESERVED_WORDS_ES3_ONLY.has(name)};var _isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js");const RESERVED_WORDS_ES3_ONLY=new Set(["abstract","boolean","byte","char","double","enum","final","float","goto","implements","int","interface","long","native","package","private","protected","public","short","static","synchronized","throws","transient","volatile"])},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(name,reserved=!0){if("string"!=typeof name)return!1;if(reserved&&((0,_helperValidatorIdentifier.isKeyword)(name)||(0,_helperValidatorIdentifier.isStrictReservedWord)(name,!0)))return!1;return(0,_helperValidatorIdentifier.isIdentifierName)(name)};var _helperValidatorIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-identifier@7.25.9/node_modules/@babel/helper-validator-identifier/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isVar.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_index.isVariableDeclaration)(node,{kind:"var"})&&!node[_index2.BLOCK_SCOPED_SYMBOL]};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/matchesPattern.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(member,match,allowPartial){if(!(0,_index.isMemberExpression)(member))return!1;const parts=Array.isArray(match)?match:match.split("."),nodes=[];let node;for(node=member;(0,_index.isMemberExpression)(node);node=node.object)nodes.push(node.property);if(nodes.push(node),nodes.length<parts.length)return!1;if(!allowPartial&&nodes.length>parts.length)return!1;for(let i=0,j=nodes.length-1;i<parts.length;i++,j--){const node=nodes[j];let value;if((0,_index.isIdentifier)(node))value=node.name;else if((0,_index.isStringLiteral)(node))value=node.value;else{if(!(0,_index.isThisExpression)(node))return!1;value="this"}if(parts[i]!==value)return!1}return!0};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isCompatTag.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(tagName){return!!tagName&&/^[a-z]/.test(tagName)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isReactComponent.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const isReactComponent=(0,__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/buildMatchMemberExpression.js").default)("React.Component");exports.default=isReactComponent},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,key,val){if(!node)return;const fields=_index.NODE_FIELDS[node.type];if(!fields)return;const field=fields[key];validateField(node,key,val,field),validateChild(node,key,val)},exports.validateChild=validateChild,exports.validateField=validateField,exports.validateInternal=function(field,node,key,val,maybeNode){if(null==field||!field.validate)return;if(field.optional&&null==val)return;if(field.validate(node,key,val),maybeNode){var _NODE_PARENT_VALIDATI;const type=val.type;if(null==type)return;null==(_NODE_PARENT_VALIDATI=_index.NODE_PARENT_VALIDATIONS[type])||_NODE_PARENT_VALIDATI.call(_index.NODE_PARENT_VALIDATIONS,node,key,val)}};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");function validateField(node,key,val,field){null!=field&&field.validate&&(field.optional&&null==val||field.validate(node,key,val))}function validateChild(node,key,val){var _NODE_PARENT_VALIDATI2;const type=null==val?void 0:val.type;null!=type&&(null==(_NODE_PARENT_VALIDATI2=_index.NODE_PARENT_VALIDATIONS[type])||_NODE_PARENT_VALIDATI2.call(_index.NODE_PARENT_VALIDATIONS,node,key,val))}},"./node_modules/.pnpm/json5@2.2.3/node_modules/json5/dist/index.mjs":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var unicode={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},util={isSpaceSeparator:c=>"string"==typeof c&&unicode.Space_Separator.test(c),isIdStartChar:c=>"string"==typeof c&&(c>="a"&&c<="z"||c>="A"&&c<="Z"||"$"===c||"_"===c||unicode.ID_Start.test(c)),isIdContinueChar:c=>"string"==typeof c&&(c>="a"&&c<="z"||c>="A"&&c<="Z"||c>="0"&&c<="9"||"$"===c||"_"===c||"‌"===c||"‍"===c||unicode.ID_Continue.test(c)),isDigit:c=>"string"==typeof c&&/[0-9]/.test(c),isHexDigit:c=>"string"==typeof c&&/[0-9A-Fa-f]/.test(c)};let source,parseState,stack,pos,line,column,token,key,root;function internalize(holder,name,reviver){const value=holder[name];if(null!=value&&"object"==typeof value)if(Array.isArray(value))for(let i=0;i<value.length;i++){const key=String(i),replacement=internalize(value,key,reviver);void 0===replacement?delete value[key]:Object.defineProperty(value,key,{value:replacement,writable:!0,enumerable:!0,configurable:!0})}else for(const key in value){const replacement=internalize(value,key,reviver);void 0===replacement?delete value[key]:Object.defineProperty(value,key,{value:replacement,writable:!0,enumerable:!0,configurable:!0})}return reviver.call(holder,name,value)}let lexState,buffer,doubleQuote,sign,c;function lex(){for(lexState="default",buffer="",doubleQuote=!1,sign=1;;){c=peek();const token=lexStates[lexState]();if(token)return token}}function peek(){if(source[pos])return String.fromCodePoint(source.codePointAt(pos))}function read(){const c=peek();return"\n"===c?(line++,column=0):c?column+=c.length:column++,c&&(pos+=c.length),c}const lexStates={default(){switch(c){case"\t":case"\v":case"\f":case" ":case" ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void read();case"/":return read(),void(lexState="comment");case void 0:return read(),newToken("eof")}if(!util.isSpaceSeparator(c))return lexStates[parseState]();read()},comment(){switch(c){case"*":return read(),void(lexState="multiLineComment");case"/":return read(),void(lexState="singleLineComment")}throw invalidChar(read())},multiLineComment(){switch(c){case"*":return read(),void(lexState="multiLineCommentAsterisk");case void 0:throw invalidChar(read())}read()},multiLineCommentAsterisk(){switch(c){case"*":return void read();case"/":return read(),void(lexState="default");case void 0:throw invalidChar(read())}read(),lexState="multiLineComment"},singleLineComment(){switch(c){case"\n":case"\r":case"\u2028":case"\u2029":return read(),void(lexState="default");case void 0:return read(),newToken("eof")}read()},value(){switch(c){case"{":case"[":return newToken("punctuator",read());case"n":return read(),literal("ull"),newToken("null",null);case"t":return read(),literal("rue"),newToken("boolean",!0);case"f":return read(),literal("alse"),newToken("boolean",!1);case"-":case"+":return"-"===read()&&(sign=-1),void(lexState="sign");case".":return buffer=read(),void(lexState="decimalPointLeading");case"0":return buffer=read(),void(lexState="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return buffer=read(),void(lexState="decimalInteger");case"I":return read(),literal("nfinity"),newToken("numeric",1/0);case"N":return read(),literal("aN"),newToken("numeric",NaN);case'"':case"'":return doubleQuote='"'===read(),buffer="",void(lexState="string")}throw invalidChar(read())},identifierNameStartEscape(){if("u"!==c)throw invalidChar(read());read();const u=unicodeEscape();switch(u){case"$":case"_":break;default:if(!util.isIdStartChar(u))throw invalidIdentifier()}buffer+=u,lexState="identifierName"},identifierName(){switch(c){case"$":case"_":case"‌":case"‍":return void(buffer+=read());case"\\":return read(),void(lexState="identifierNameEscape")}if(!util.isIdContinueChar(c))return newToken("identifier",buffer);buffer+=read()},identifierNameEscape(){if("u"!==c)throw invalidChar(read());read();const u=unicodeEscape();switch(u){case"$":case"_":case"‌":case"‍":break;default:if(!util.isIdContinueChar(u))throw invalidIdentifier()}buffer+=u,lexState="identifierName"},sign(){switch(c){case".":return buffer=read(),void(lexState="decimalPointLeading");case"0":return buffer=read(),void(lexState="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return buffer=read(),void(lexState="decimalInteger");case"I":return read(),literal("nfinity"),newToken("numeric",sign*(1/0));case"N":return read(),literal("aN"),newToken("numeric",NaN)}throw invalidChar(read())},zero(){switch(c){case".":return buffer+=read(),void(lexState="decimalPoint");case"e":case"E":return buffer+=read(),void(lexState="decimalExponent");case"x":case"X":return buffer+=read(),void(lexState="hexadecimal")}return newToken("numeric",0*sign)},decimalInteger(){switch(c){case".":return buffer+=read(),void(lexState="decimalPoint");case"e":case"E":return buffer+=read(),void(lexState="decimalExponent")}if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},decimalPointLeading(){if(util.isDigit(c))return buffer+=read(),void(lexState="decimalFraction");throw invalidChar(read())},decimalPoint(){switch(c){case"e":case"E":return buffer+=read(),void(lexState="decimalExponent")}return util.isDigit(c)?(buffer+=read(),void(lexState="decimalFraction")):newToken("numeric",sign*Number(buffer))},decimalFraction(){switch(c){case"e":case"E":return buffer+=read(),void(lexState="decimalExponent")}if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},decimalExponent(){switch(c){case"+":case"-":return buffer+=read(),void(lexState="decimalExponentSign")}if(util.isDigit(c))return buffer+=read(),void(lexState="decimalExponentInteger");throw invalidChar(read())},decimalExponentSign(){if(util.isDigit(c))return buffer+=read(),void(lexState="decimalExponentInteger");throw invalidChar(read())},decimalExponentInteger(){if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},hexadecimal(){if(util.isHexDigit(c))return buffer+=read(),void(lexState="hexadecimalInteger");throw invalidChar(read())},hexadecimalInteger(){if(!util.isHexDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},string(){switch(c){case"\\":return read(),void(buffer+=function(){switch(peek()){case"b":return read(),"\b";case"f":return read(),"\f";case"n":return read(),"\n";case"r":return read(),"\r";case"t":return read(),"\t";case"v":return read(),"\v";case"0":if(read(),util.isDigit(peek()))throw invalidChar(read());return"\0";case"x":return read(),function(){let buffer="",c=peek();if(!util.isHexDigit(c))throw invalidChar(read());if(buffer+=read(),c=peek(),!util.isHexDigit(c))throw invalidChar(read());return buffer+=read(),String.fromCodePoint(parseInt(buffer,16))}();case"u":return read(),unicodeEscape();case"\n":case"\u2028":case"\u2029":return read(),"";case"\r":return read(),"\n"===peek()&&read(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw invalidChar(read())}return read()}());case'"':return doubleQuote?(read(),newToken("string",buffer)):void(buffer+=read());case"'":return doubleQuote?void(buffer+=read()):(read(),newToken("string",buffer));case"\n":case"\r":throw invalidChar(read());case"\u2028":case"\u2029":!function(c){console.warn(`JSON5: '${formatChar(c)}' in strings is not valid ECMAScript; consider escaping`)}(c);break;case void 0:throw invalidChar(read())}buffer+=read()},start(){switch(c){case"{":case"[":return newToken("punctuator",read())}lexState="value"},beforePropertyName(){switch(c){case"$":case"_":return buffer=read(),void(lexState="identifierName");case"\\":return read(),void(lexState="identifierNameStartEscape");case"}":return newToken("punctuator",read());case'"':case"'":return doubleQuote='"'===read(),void(lexState="string")}if(util.isIdStartChar(c))return buffer+=read(),void(lexState="identifierName");throw invalidChar(read())},afterPropertyName(){if(":"===c)return newToken("punctuator",read());throw invalidChar(read())},beforePropertyValue(){lexState="value"},afterPropertyValue(){switch(c){case",":case"}":return newToken("punctuator",read())}throw invalidChar(read())},beforeArrayValue(){if("]"===c)return newToken("punctuator",read());lexState="value"},afterArrayValue(){switch(c){case",":case"]":return newToken("punctuator",read())}throw invalidChar(read())},end(){throw invalidChar(read())}};function newToken(type,value){return{type,value,line,column}}function literal(s){for(const c of s){if(peek()!==c)throw invalidChar(read());read()}}function unicodeEscape(){let buffer="",count=4;for(;count-- >0;){const c=peek();if(!util.isHexDigit(c))throw invalidChar(read());buffer+=read()}return String.fromCodePoint(parseInt(buffer,16))}const parseStates={start(){if("eof"===token.type)throw invalidEOF();push()},beforePropertyName(){switch(token.type){case"identifier":case"string":return key=token.value,void(parseState="afterPropertyName");case"punctuator":return void pop();case"eof":throw invalidEOF()}},afterPropertyName(){if("eof"===token.type)throw invalidEOF();parseState="beforePropertyValue"},beforePropertyValue(){if("eof"===token.type)throw invalidEOF();push()},beforeArrayValue(){if("eof"===token.type)throw invalidEOF();"punctuator"!==token.type||"]"!==token.value?push():pop()},afterPropertyValue(){if("eof"===token.type)throw invalidEOF();switch(token.value){case",":return void(parseState="beforePropertyName");case"}":pop()}},afterArrayValue(){if("eof"===token.type)throw invalidEOF();switch(token.value){case",":return void(parseState="beforeArrayValue");case"]":pop()}},end(){}};function push(){let value;switch(token.type){case"punctuator":switch(token.value){case"{":value={};break;case"[":value=[]}break;case"null":case"boolean":case"numeric":case"string":value=token.value}if(void 0===root)root=value;else{const parent=stack[stack.length-1];Array.isArray(parent)?parent.push(value):Object.defineProperty(parent,key,{value,writable:!0,enumerable:!0,configurable:!0})}if(null!==value&&"object"==typeof value)stack.push(value),parseState=Array.isArray(value)?"beforeArrayValue":"beforePropertyName";else{const current=stack[stack.length-1];parseState=null==current?"end":Array.isArray(current)?"afterArrayValue":"afterPropertyValue"}}function pop(){stack.pop();const current=stack[stack.length-1];parseState=null==current?"end":Array.isArray(current)?"afterArrayValue":"afterPropertyValue"}function invalidChar(c){return syntaxError(void 0===c?`JSON5: invalid end of input at ${line}:${column}`:`JSON5: invalid character '${formatChar(c)}' at ${line}:${column}`)}function invalidEOF(){return syntaxError(`JSON5: invalid end of input at ${line}:${column}`)}function invalidIdentifier(){return column-=5,syntaxError(`JSON5: invalid identifier character at ${line}:${column}`)}function formatChar(c){const replacements={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(replacements[c])return replacements[c];if(c<" "){const hexString=c.charCodeAt(0).toString(16);return"\\x"+("00"+hexString).substring(hexString.length)}return c}function syntaxError(message){const err=new SyntaxError(message);return err.lineNumber=line,err.columnNumber=column,err}const JSON5={parse:function(text,reviver){source=String(text),parseState="start",stack=[],pos=0,line=1,column=0,token=void 0,key=void 0,root=void 0;do{token=lex(),parseStates[parseState]()}while("eof"!==token.type);return"function"==typeof reviver?internalize({"":root},"",reviver):root},stringify:function(value,replacer,space){const stack=[];let propertyList,replacerFunc,quote,indent="",gap="";if(null==replacer||"object"!=typeof replacer||Array.isArray(replacer)||(space=replacer.space,quote=replacer.quote,replacer=replacer.replacer),"function"==typeof replacer)replacerFunc=replacer;else if(Array.isArray(replacer)){propertyList=[];for(const v of replacer){let item;"string"==typeof v?item=v:("number"==typeof v||v instanceof String||v instanceof Number)&&(item=String(v)),void 0!==item&&propertyList.indexOf(item)<0&&propertyList.push(item)}}return space instanceof Number?space=Number(space):space instanceof String&&(space=String(space)),"number"==typeof space?space>0&&(space=Math.min(10,Math.floor(space)),gap="          ".substr(0,space)):"string"==typeof space&&(gap=space.substr(0,10)),serializeProperty("",{"":value});function serializeProperty(key,holder){let value=holder[key];switch(null!=value&&("function"==typeof value.toJSON5?value=value.toJSON5(key):"function"==typeof value.toJSON&&(value=value.toJSON(key))),replacerFunc&&(value=replacerFunc.call(holder,key,value)),value instanceof Number?value=Number(value):value instanceof String?value=String(value):value instanceof Boolean&&(value=value.valueOf()),value){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof value?quoteString(value):"number"==typeof value?String(value):"object"==typeof value?Array.isArray(value)?function(value){if(stack.indexOf(value)>=0)throw TypeError("Converting circular structure to JSON5");stack.push(value);let stepback=indent;indent+=gap;let final,partial=[];for(let i=0;i<value.length;i++){const propertyString=serializeProperty(String(i),value);partial.push(void 0!==propertyString?propertyString:"null")}if(0===partial.length)final="[]";else if(""===gap){final="["+partial.join(",")+"]"}else{let separator=",\n"+indent,properties=partial.join(separator);final="[\n"+indent+properties+",\n"+stepback+"]"}return stack.pop(),indent=stepback,final}(value):function(value){if(stack.indexOf(value)>=0)throw TypeError("Converting circular structure to JSON5");stack.push(value);let stepback=indent;indent+=gap;let final,keys=propertyList||Object.keys(value),partial=[];for(const key of keys){const propertyString=serializeProperty(key,value);if(void 0!==propertyString){let member=serializeKey(key)+":";""!==gap&&(member+=" "),member+=propertyString,partial.push(member)}}if(0===partial.length)final="{}";else{let properties;if(""===gap)properties=partial.join(","),final="{"+properties+"}";else{let separator=",\n"+indent;properties=partial.join(separator),final="{\n"+indent+properties+",\n"+stepback+"}"}}return stack.pop(),indent=stepback,final}(value):void 0}function quoteString(value){const quotes={"'":.1,'"':.2},replacements={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let product="";for(let i=0;i<value.length;i++){const c=value[i];switch(c){case"'":case'"':quotes[c]++,product+=c;continue;case"\0":if(util.isDigit(value[i+1])){product+="\\x00";continue}}if(replacements[c])product+=replacements[c];else if(c<" "){let hexString=c.charCodeAt(0).toString(16);product+="\\x"+("00"+hexString).substring(hexString.length)}else product+=c}const quoteChar=quote||Object.keys(quotes).reduce(((a,b)=>quotes[a]<quotes[b]?a:b));return product=product.replace(new RegExp(quoteChar,"g"),replacements[quoteChar]),quoteChar+product+quoteChar}function serializeKey(key){if(0===key.length)return quoteString(key);const firstChar=String.fromCodePoint(key.codePointAt(0));if(!util.isIdStartChar(firstChar))return quoteString(key);for(let i=firstChar.length;i<key.length;i++)if(!util.isIdContinueChar(String.fromCodePoint(key.codePointAt(i))))return quoteString(key);return key}}};const __WEBPACK_DEFAULT_EXPORT__=JSON5},"./node_modules/.pnpm/@babel+preset-typescript@7.26.0_@babel+core@7.26.0/node_modules/@babel/preset-typescript/package.json":module=>{"use strict";module.exports=JSON.parse('{"name":"@babel/preset-typescript","version":"7.26.0","description":"Babel preset for TypeScript.","repository":{"type":"git","url":"https://github.com/babel/babel.git","directory":"packages/babel-preset-typescript"},"license":"MIT","publishConfig":{"access":"public"},"main":"./lib/index.js","keywords":["babel-preset","typescript"],"dependencies":{"@babel/helper-plugin-utils":"^7.25.9","@babel/helper-validator-option":"^7.25.9","@babel/plugin-syntax-jsx":"^7.25.9","@babel/plugin-transform-modules-commonjs":"^7.25.9","@babel/plugin-transform-typescript":"^7.25.9"},"peerDependencies":{"@babel/core":"^7.0.0-0"},"devDependencies":{"@babel/core":"^7.26.0","@babel/helper-plugin-test-runner":"^7.25.9"},"homepage":"https://babel.dev/docs/en/next/babel-preset-typescript","bugs":"https://github.com/babel/babel/issues?utf8=%E2%9C%93&q=is%3Aissue+label%3A%22area%3A%20typescript%22+is%3Aopen","engines":{"node":">=6.9.0"},"author":"The Babel Team (https://babel.dev/team)","type":"commonjs"}')},"./node_modules/.pnpm/globals@11.12.0/node_modules/globals/globals.json":module=>{"use strict";module.exports=JSON.parse('{"builtin":{"Array":false,"ArrayBuffer":false,"Atomics":false,"BigInt":false,"BigInt64Array":false,"BigUint64Array":false,"Boolean":false,"constructor":false,"DataView":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Float32Array":false,"Float64Array":false,"Function":false,"globalThis":false,"hasOwnProperty":false,"Infinity":false,"Int16Array":false,"Int32Array":false,"Int8Array":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Map":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"Promise":false,"propertyIsEnumerable":false,"Proxy":false,"RangeError":false,"ReferenceError":false,"Reflect":false,"RegExp":false,"Set":false,"SharedArrayBuffer":false,"String":false,"Symbol":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"Uint16Array":false,"Uint32Array":false,"Uint8Array":false,"Uint8ClampedArray":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false,"WeakMap":false,"WeakSet":false},"es5":{"Array":false,"Boolean":false,"constructor":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Function":false,"hasOwnProperty":false,"Infinity":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"propertyIsEnumerable":false,"RangeError":false,"ReferenceError":false,"RegExp":false,"String":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false},"es2015":{"Array":false,"ArrayBuffer":false,"Boolean":false,"constructor":false,"DataView":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Float32Array":false,"Float64Array":false,"Function":false,"hasOwnProperty":false,"Infinity":false,"Int16Array":false,"Int32Array":false,"Int8Array":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Map":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"Promise":false,"propertyIsEnumerable":false,"Proxy":false,"RangeError":false,"ReferenceError":false,"Reflect":false,"RegExp":false,"Set":false,"String":false,"Symbol":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"Uint16Array":false,"Uint32Array":false,"Uint8Array":false,"Uint8ClampedArray":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false,"WeakMap":false,"WeakSet":false},"es2017":{"Array":false,"ArrayBuffer":false,"Atomics":false,"Boolean":false,"constructor":false,"DataView":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Float32Array":false,"Float64Array":false,"Function":false,"hasOwnProperty":false,"Infinity":false,"Int16Array":false,"Int32Array":false,"Int8Array":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Map":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"Promise":false,"propertyIsEnumerable":false,"Proxy":false,"RangeError":false,"ReferenceError":false,"Reflect":false,"RegExp":false,"Set":false,"SharedArrayBuffer":false,"String":false,"Symbol":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"Uint16Array":false,"Uint32Array":false,"Uint8Array":false,"Uint8ClampedArray":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false,"WeakMap":false,"WeakSet":false},"browser":{"AbortController":false,"AbortSignal":false,"addEventListener":false,"alert":false,"AnalyserNode":false,"Animation":false,"AnimationEffectReadOnly":false,"AnimationEffectTiming":false,"AnimationEffectTimingReadOnly":false,"AnimationEvent":false,"AnimationPlaybackEvent":false,"AnimationTimeline":false,"applicationCache":false,"ApplicationCache":false,"ApplicationCacheErrorEvent":false,"atob":false,"Attr":false,"Audio":false,"AudioBuffer":false,"AudioBufferSourceNode":false,"AudioContext":false,"AudioDestinationNode":false,"AudioListener":false,"AudioNode":false,"AudioParam":false,"AudioProcessingEvent":false,"AudioScheduledSourceNode":false,"AudioWorkletGlobalScope ":false,"AudioWorkletNode":false,"AudioWorkletProcessor":false,"BarProp":false,"BaseAudioContext":false,"BatteryManager":false,"BeforeUnloadEvent":false,"BiquadFilterNode":false,"Blob":false,"BlobEvent":false,"blur":false,"BroadcastChannel":false,"btoa":false,"BudgetService":false,"ByteLengthQueuingStrategy":false,"Cache":false,"caches":false,"CacheStorage":false,"cancelAnimationFrame":false,"cancelIdleCallback":false,"CanvasCaptureMediaStreamTrack":false,"CanvasGradient":false,"CanvasPattern":false,"CanvasRenderingContext2D":false,"ChannelMergerNode":false,"ChannelSplitterNode":false,"CharacterData":false,"clearInterval":false,"clearTimeout":false,"clientInformation":false,"ClipboardEvent":false,"close":false,"closed":false,"CloseEvent":false,"Comment":false,"CompositionEvent":false,"confirm":false,"console":false,"ConstantSourceNode":false,"ConvolverNode":false,"CountQueuingStrategy":false,"createImageBitmap":false,"Credential":false,"CredentialsContainer":false,"crypto":false,"Crypto":false,"CryptoKey":false,"CSS":false,"CSSConditionRule":false,"CSSFontFaceRule":false,"CSSGroupingRule":false,"CSSImportRule":false,"CSSKeyframeRule":false,"CSSKeyframesRule":false,"CSSMediaRule":false,"CSSNamespaceRule":false,"CSSPageRule":false,"CSSRule":false,"CSSRuleList":false,"CSSStyleDeclaration":false,"CSSStyleRule":false,"CSSStyleSheet":false,"CSSSupportsRule":false,"CustomElementRegistry":false,"customElements":false,"CustomEvent":false,"DataTransfer":false,"DataTransferItem":false,"DataTransferItemList":false,"defaultstatus":false,"defaultStatus":false,"DelayNode":false,"DeviceMotionEvent":false,"DeviceOrientationEvent":false,"devicePixelRatio":false,"dispatchEvent":false,"document":false,"Document":false,"DocumentFragment":false,"DocumentType":false,"DOMError":false,"DOMException":false,"DOMImplementation":false,"DOMMatrix":false,"DOMMatrixReadOnly":false,"DOMParser":false,"DOMPoint":false,"DOMPointReadOnly":false,"DOMQuad":false,"DOMRect":false,"DOMRectReadOnly":false,"DOMStringList":false,"DOMStringMap":false,"DOMTokenList":false,"DragEvent":false,"DynamicsCompressorNode":false,"Element":false,"ErrorEvent":false,"event":false,"Event":false,"EventSource":false,"EventTarget":false,"external":false,"fetch":false,"File":false,"FileList":false,"FileReader":false,"find":false,"focus":false,"FocusEvent":false,"FontFace":false,"FontFaceSetLoadEvent":false,"FormData":false,"frameElement":false,"frames":false,"GainNode":false,"Gamepad":false,"GamepadButton":false,"GamepadEvent":false,"getComputedStyle":false,"getSelection":false,"HashChangeEvent":false,"Headers":false,"history":false,"History":false,"HTMLAllCollection":false,"HTMLAnchorElement":false,"HTMLAreaElement":false,"HTMLAudioElement":false,"HTMLBaseElement":false,"HTMLBodyElement":false,"HTMLBRElement":false,"HTMLButtonElement":false,"HTMLCanvasElement":false,"HTMLCollection":false,"HTMLContentElement":false,"HTMLDataElement":false,"HTMLDataListElement":false,"HTMLDetailsElement":false,"HTMLDialogElement":false,"HTMLDirectoryElement":false,"HTMLDivElement":false,"HTMLDListElement":false,"HTMLDocument":false,"HTMLElement":false,"HTMLEmbedElement":false,"HTMLFieldSetElement":false,"HTMLFontElement":false,"HTMLFormControlsCollection":false,"HTMLFormElement":false,"HTMLFrameElement":false,"HTMLFrameSetElement":false,"HTMLHeadElement":false,"HTMLHeadingElement":false,"HTMLHRElement":false,"HTMLHtmlElement":false,"HTMLIFrameElement":false,"HTMLImageElement":false,"HTMLInputElement":false,"HTMLLabelElement":false,"HTMLLegendElement":false,"HTMLLIElement":false,"HTMLLinkElement":false,"HTMLMapElement":false,"HTMLMarqueeElement":false,"HTMLMediaElement":false,"HTMLMenuElement":false,"HTMLMetaElement":false,"HTMLMeterElement":false,"HTMLModElement":false,"HTMLObjectElement":false,"HTMLOListElement":false,"HTMLOptGroupElement":false,"HTMLOptionElement":false,"HTMLOptionsCollection":false,"HTMLOutputElement":false,"HTMLParagraphElement":false,"HTMLParamElement":false,"HTMLPictureElement":false,"HTMLPreElement":false,"HTMLProgressElement":false,"HTMLQuoteElement":false,"HTMLScriptElement":false,"HTMLSelectElement":false,"HTMLShadowElement":false,"HTMLSlotElement":false,"HTMLSourceElement":false,"HTMLSpanElement":false,"HTMLStyleElement":false,"HTMLTableCaptionElement":false,"HTMLTableCellElement":false,"HTMLTableColElement":false,"HTMLTableElement":false,"HTMLTableRowElement":false,"HTMLTableSectionElement":false,"HTMLTemplateElement":false,"HTMLTextAreaElement":false,"HTMLTimeElement":false,"HTMLTitleElement":false,"HTMLTrackElement":false,"HTMLUListElement":false,"HTMLUnknownElement":false,"HTMLVideoElement":false,"IDBCursor":false,"IDBCursorWithValue":false,"IDBDatabase":false,"IDBFactory":false,"IDBIndex":false,"IDBKeyRange":false,"IDBObjectStore":false,"IDBOpenDBRequest":false,"IDBRequest":false,"IDBTransaction":false,"IDBVersionChangeEvent":false,"IdleDeadline":false,"IIRFilterNode":false,"Image":false,"ImageBitmap":false,"ImageBitmapRenderingContext":false,"ImageCapture":false,"ImageData":false,"indexedDB":false,"innerHeight":false,"innerWidth":false,"InputEvent":false,"IntersectionObserver":false,"IntersectionObserverEntry":false,"Intl":false,"isSecureContext":false,"KeyboardEvent":false,"KeyframeEffect":false,"KeyframeEffectReadOnly":false,"length":false,"localStorage":false,"location":true,"Location":false,"locationbar":false,"matchMedia":false,"MediaDeviceInfo":false,"MediaDevices":false,"MediaElementAudioSourceNode":false,"MediaEncryptedEvent":false,"MediaError":false,"MediaKeyMessageEvent":false,"MediaKeySession":false,"MediaKeyStatusMap":false,"MediaKeySystemAccess":false,"MediaList":false,"MediaQueryList":false,"MediaQueryListEvent":false,"MediaRecorder":false,"MediaSettingsRange":false,"MediaSource":false,"MediaStream":false,"MediaStreamAudioDestinationNode":false,"MediaStreamAudioSourceNode":false,"MediaStreamEvent":false,"MediaStreamTrack":false,"MediaStreamTrackEvent":false,"menubar":false,"MessageChannel":false,"MessageEvent":false,"MessagePort":false,"MIDIAccess":false,"MIDIConnectionEvent":false,"MIDIInput":false,"MIDIInputMap":false,"MIDIMessageEvent":false,"MIDIOutput":false,"MIDIOutputMap":false,"MIDIPort":false,"MimeType":false,"MimeTypeArray":false,"MouseEvent":false,"moveBy":false,"moveTo":false,"MutationEvent":false,"MutationObserver":false,"MutationRecord":false,"name":false,"NamedNodeMap":false,"NavigationPreloadManager":false,"navigator":false,"Navigator":false,"NetworkInformation":false,"Node":false,"NodeFilter":false,"NodeIterator":false,"NodeList":false,"Notification":false,"OfflineAudioCompletionEvent":false,"OfflineAudioContext":false,"offscreenBuffering":false,"OffscreenCanvas":true,"onabort":true,"onafterprint":true,"onanimationend":true,"onanimationiteration":true,"onanimationstart":true,"onappinstalled":true,"onauxclick":true,"onbeforeinstallprompt":true,"onbeforeprint":true,"onbeforeunload":true,"onblur":true,"oncancel":true,"oncanplay":true,"oncanplaythrough":true,"onchange":true,"onclick":true,"onclose":true,"oncontextmenu":true,"oncuechange":true,"ondblclick":true,"ondevicemotion":true,"ondeviceorientation":true,"ondeviceorientationabsolute":true,"ondrag":true,"ondragend":true,"ondragenter":true,"ondragleave":true,"ondragover":true,"ondragstart":true,"ondrop":true,"ondurationchange":true,"onemptied":true,"onended":true,"onerror":true,"onfocus":true,"ongotpointercapture":true,"onhashchange":true,"oninput":true,"oninvalid":true,"onkeydown":true,"onkeypress":true,"onkeyup":true,"onlanguagechange":true,"onload":true,"onloadeddata":true,"onloadedmetadata":true,"onloadstart":true,"onlostpointercapture":true,"onmessage":true,"onmessageerror":true,"onmousedown":true,"onmouseenter":true,"onmouseleave":true,"onmousemove":true,"onmouseout":true,"onmouseover":true,"onmouseup":true,"onmousewheel":true,"onoffline":true,"ononline":true,"onpagehide":true,"onpageshow":true,"onpause":true,"onplay":true,"onplaying":true,"onpointercancel":true,"onpointerdown":true,"onpointerenter":true,"onpointerleave":true,"onpointermove":true,"onpointerout":true,"onpointerover":true,"onpointerup":true,"onpopstate":true,"onprogress":true,"onratechange":true,"onrejectionhandled":true,"onreset":true,"onresize":true,"onscroll":true,"onsearch":true,"onseeked":true,"onseeking":true,"onselect":true,"onstalled":true,"onstorage":true,"onsubmit":true,"onsuspend":true,"ontimeupdate":true,"ontoggle":true,"ontransitionend":true,"onunhandledrejection":true,"onunload":true,"onvolumechange":true,"onwaiting":true,"onwheel":true,"open":false,"openDatabase":false,"opener":false,"Option":false,"origin":false,"OscillatorNode":false,"outerHeight":false,"outerWidth":false,"PageTransitionEvent":false,"pageXOffset":false,"pageYOffset":false,"PannerNode":false,"parent":false,"Path2D":false,"PaymentAddress":false,"PaymentRequest":false,"PaymentRequestUpdateEvent":false,"PaymentResponse":false,"performance":false,"Performance":false,"PerformanceEntry":false,"PerformanceLongTaskTiming":false,"PerformanceMark":false,"PerformanceMeasure":false,"PerformanceNavigation":false,"PerformanceNavigationTiming":false,"PerformanceObserver":false,"PerformanceObserverEntryList":false,"PerformancePaintTiming":false,"PerformanceResourceTiming":false,"PerformanceTiming":false,"PeriodicWave":false,"Permissions":false,"PermissionStatus":false,"personalbar":false,"PhotoCapabilities":false,"Plugin":false,"PluginArray":false,"PointerEvent":false,"PopStateEvent":false,"postMessage":false,"Presentation":false,"PresentationAvailability":false,"PresentationConnection":false,"PresentationConnectionAvailableEvent":false,"PresentationConnectionCloseEvent":false,"PresentationConnectionList":false,"PresentationReceiver":false,"PresentationRequest":false,"print":false,"ProcessingInstruction":false,"ProgressEvent":false,"PromiseRejectionEvent":false,"prompt":false,"PushManager":false,"PushSubscription":false,"PushSubscriptionOptions":false,"queueMicrotask":false,"RadioNodeList":false,"Range":false,"ReadableStream":false,"registerProcessor":false,"RemotePlayback":false,"removeEventListener":false,"Request":false,"requestAnimationFrame":false,"requestIdleCallback":false,"resizeBy":false,"ResizeObserver":false,"ResizeObserverEntry":false,"resizeTo":false,"Response":false,"RTCCertificate":false,"RTCDataChannel":false,"RTCDataChannelEvent":false,"RTCDtlsTransport":false,"RTCIceCandidate":false,"RTCIceGatherer":false,"RTCIceTransport":false,"RTCPeerConnection":false,"RTCPeerConnectionIceEvent":false,"RTCRtpContributingSource":false,"RTCRtpReceiver":false,"RTCRtpSender":false,"RTCSctpTransport":false,"RTCSessionDescription":false,"RTCStatsReport":false,"RTCTrackEvent":false,"screen":false,"Screen":false,"screenLeft":false,"ScreenOrientation":false,"screenTop":false,"screenX":false,"screenY":false,"ScriptProcessorNode":false,"scroll":false,"scrollbars":false,"scrollBy":false,"scrollTo":false,"scrollX":false,"scrollY":false,"SecurityPolicyViolationEvent":false,"Selection":false,"self":false,"ServiceWorker":false,"ServiceWorkerContainer":false,"ServiceWorkerRegistration":false,"sessionStorage":false,"setInterval":false,"setTimeout":false,"ShadowRoot":false,"SharedWorker":false,"SourceBuffer":false,"SourceBufferList":false,"speechSynthesis":false,"SpeechSynthesisEvent":false,"SpeechSynthesisUtterance":false,"StaticRange":false,"status":false,"statusbar":false,"StereoPannerNode":false,"stop":false,"Storage":false,"StorageEvent":false,"StorageManager":false,"styleMedia":false,"StyleSheet":false,"StyleSheetList":false,"SubtleCrypto":false,"SVGAElement":false,"SVGAngle":false,"SVGAnimatedAngle":false,"SVGAnimatedBoolean":false,"SVGAnimatedEnumeration":false,"SVGAnimatedInteger":false,"SVGAnimatedLength":false,"SVGAnimatedLengthList":false,"SVGAnimatedNumber":false,"SVGAnimatedNumberList":false,"SVGAnimatedPreserveAspectRatio":false,"SVGAnimatedRect":false,"SVGAnimatedString":false,"SVGAnimatedTransformList":false,"SVGAnimateElement":false,"SVGAnimateMotionElement":false,"SVGAnimateTransformElement":false,"SVGAnimationElement":false,"SVGCircleElement":false,"SVGClipPathElement":false,"SVGComponentTransferFunctionElement":false,"SVGDefsElement":false,"SVGDescElement":false,"SVGDiscardElement":false,"SVGElement":false,"SVGEllipseElement":false,"SVGFEBlendElement":false,"SVGFEColorMatrixElement":false,"SVGFEComponentTransferElement":false,"SVGFECompositeElement":false,"SVGFEConvolveMatrixElement":false,"SVGFEDiffuseLightingElement":false,"SVGFEDisplacementMapElement":false,"SVGFEDistantLightElement":false,"SVGFEDropShadowElement":false,"SVGFEFloodElement":false,"SVGFEFuncAElement":false,"SVGFEFuncBElement":false,"SVGFEFuncGElement":false,"SVGFEFuncRElement":false,"SVGFEGaussianBlurElement":false,"SVGFEImageElement":false,"SVGFEMergeElement":false,"SVGFEMergeNodeElement":false,"SVGFEMorphologyElement":false,"SVGFEOffsetElement":false,"SVGFEPointLightElement":false,"SVGFESpecularLightingElement":false,"SVGFESpotLightElement":false,"SVGFETileElement":false,"SVGFETurbulenceElement":false,"SVGFilterElement":false,"SVGForeignObjectElement":false,"SVGGElement":false,"SVGGeometryElement":false,"SVGGradientElement":false,"SVGGraphicsElement":false,"SVGImageElement":false,"SVGLength":false,"SVGLengthList":false,"SVGLinearGradientElement":false,"SVGLineElement":false,"SVGMarkerElement":false,"SVGMaskElement":false,"SVGMatrix":false,"SVGMetadataElement":false,"SVGMPathElement":false,"SVGNumber":false,"SVGNumberList":false,"SVGPathElement":false,"SVGPatternElement":false,"SVGPoint":false,"SVGPointList":false,"SVGPolygonElement":false,"SVGPolylineElement":false,"SVGPreserveAspectRatio":false,"SVGRadialGradientElement":false,"SVGRect":false,"SVGRectElement":false,"SVGScriptElement":false,"SVGSetElement":false,"SVGStopElement":false,"SVGStringList":false,"SVGStyleElement":false,"SVGSVGElement":false,"SVGSwitchElement":false,"SVGSymbolElement":false,"SVGTextContentElement":false,"SVGTextElement":false,"SVGTextPathElement":false,"SVGTextPositioningElement":false,"SVGTitleElement":false,"SVGTransform":false,"SVGTransformList":false,"SVGTSpanElement":false,"SVGUnitTypes":false,"SVGUseElement":false,"SVGViewElement":false,"TaskAttributionTiming":false,"Text":false,"TextDecoder":false,"TextEncoder":false,"TextEvent":false,"TextMetrics":false,"TextTrack":false,"TextTrackCue":false,"TextTrackCueList":false,"TextTrackList":false,"TimeRanges":false,"toolbar":false,"top":false,"Touch":false,"TouchEvent":false,"TouchList":false,"TrackEvent":false,"TransitionEvent":false,"TreeWalker":false,"UIEvent":false,"URL":false,"URLSearchParams":false,"ValidityState":false,"visualViewport":false,"VisualViewport":false,"VTTCue":false,"WaveShaperNode":false,"WebAssembly":false,"WebGL2RenderingContext":false,"WebGLActiveInfo":false,"WebGLBuffer":false,"WebGLContextEvent":false,"WebGLFramebuffer":false,"WebGLProgram":false,"WebGLQuery":false,"WebGLRenderbuffer":false,"WebGLRenderingContext":false,"WebGLSampler":false,"WebGLShader":false,"WebGLShaderPrecisionFormat":false,"WebGLSync":false,"WebGLTexture":false,"WebGLTransformFeedback":false,"WebGLUniformLocation":false,"WebGLVertexArrayObject":false,"WebSocket":false,"WheelEvent":false,"window":false,"Window":false,"Worker":false,"WritableStream":false,"XMLDocument":false,"XMLHttpRequest":false,"XMLHttpRequestEventTarget":false,"XMLHttpRequestUpload":false,"XMLSerializer":false,"XPathEvaluator":false,"XPathExpression":false,"XPathResult":false,"XSLTProcessor":false},"worker":{"addEventListener":false,"applicationCache":false,"atob":false,"Blob":false,"BroadcastChannel":false,"btoa":false,"Cache":false,"caches":false,"clearInterval":false,"clearTimeout":false,"close":true,"console":false,"fetch":false,"FileReaderSync":false,"FormData":false,"Headers":false,"IDBCursor":false,"IDBCursorWithValue":false,"IDBDatabase":false,"IDBFactory":false,"IDBIndex":false,"IDBKeyRange":false,"IDBObjectStore":false,"IDBOpenDBRequest":false,"IDBRequest":false,"IDBTransaction":false,"IDBVersionChangeEvent":false,"ImageData":false,"importScripts":true,"indexedDB":false,"location":false,"MessageChannel":false,"MessagePort":false,"name":false,"navigator":false,"Notification":false,"onclose":true,"onconnect":true,"onerror":true,"onlanguagechange":true,"onmessage":true,"onoffline":true,"ononline":true,"onrejectionhandled":true,"onunhandledrejection":true,"performance":false,"Performance":false,"PerformanceEntry":false,"PerformanceMark":false,"PerformanceMeasure":false,"PerformanceNavigation":false,"PerformanceResourceTiming":false,"PerformanceTiming":false,"postMessage":true,"Promise":false,"queueMicrotask":false,"removeEventListener":false,"Request":false,"Response":false,"self":true,"ServiceWorkerRegistration":false,"setInterval":false,"setTimeout":false,"TextDecoder":false,"TextEncoder":false,"URL":false,"URLSearchParams":false,"WebSocket":false,"Worker":false,"WorkerGlobalScope":false,"XMLHttpRequest":false},"node":{"__dirname":false,"__filename":false,"Buffer":false,"clearImmediate":false,"clearInterval":false,"clearTimeout":false,"console":false,"exports":true,"global":false,"Intl":false,"module":false,"process":false,"queueMicrotask":false,"require":false,"setImmediate":false,"setInterval":false,"setTimeout":false,"TextDecoder":false,"TextEncoder":false,"URL":false,"URLSearchParams":false},"commonjs":{"exports":true,"global":false,"module":false,"require":false},"amd":{"define":false,"require":false},"mocha":{"after":false,"afterEach":false,"before":false,"beforeEach":false,"context":false,"describe":false,"it":false,"mocha":false,"run":false,"setup":false,"specify":false,"suite":false,"suiteSetup":false,"suiteTeardown":false,"teardown":false,"test":false,"xcontext":false,"xdescribe":false,"xit":false,"xspecify":false},"jasmine":{"afterAll":false,"afterEach":false,"beforeAll":false,"beforeEach":false,"describe":false,"expect":false,"fail":false,"fdescribe":false,"fit":false,"it":false,"jasmine":false,"pending":false,"runs":false,"spyOn":false,"spyOnProperty":false,"waits":false,"waitsFor":false,"xdescribe":false,"xit":false},"jest":{"afterAll":false,"afterEach":false,"beforeAll":false,"beforeEach":false,"describe":false,"expect":false,"fdescribe":false,"fit":false,"it":false,"jest":false,"pit":false,"require":false,"test":false,"xdescribe":false,"xit":false,"xtest":false},"qunit":{"asyncTest":false,"deepEqual":false,"equal":false,"expect":false,"module":false,"notDeepEqual":false,"notEqual":false,"notOk":false,"notPropEqual":false,"notStrictEqual":false,"ok":false,"propEqual":false,"QUnit":false,"raises":false,"start":false,"stop":false,"strictEqual":false,"test":false,"throws":false},"phantomjs":{"console":true,"exports":true,"phantom":true,"require":true,"WebPage":true},"couch":{"emit":false,"exports":false,"getRow":false,"log":false,"module":false,"provides":false,"require":false,"respond":false,"send":false,"start":false,"sum":false},"rhino":{"defineClass":false,"deserialize":false,"gc":false,"help":false,"importClass":false,"importPackage":false,"java":false,"load":false,"loadClass":false,"Packages":false,"print":false,"quit":false,"readFile":false,"readUrl":false,"runCommand":false,"seal":false,"serialize":false,"spawn":false,"sync":false,"toint32":false,"version":false},"nashorn":{"__DIR__":false,"__FILE__":false,"__LINE__":false,"com":false,"edu":false,"exit":false,"java":false,"Java":false,"javafx":false,"JavaImporter":false,"javax":false,"JSAdapter":false,"load":false,"loadWithNewGlobal":false,"org":false,"Packages":false,"print":false,"quit":false},"wsh":{"ActiveXObject":true,"Enumerator":true,"GetObject":true,"ScriptEngine":true,"ScriptEngineBuildVersion":true,"ScriptEngineMajorVersion":true,"ScriptEngineMinorVersion":true,"VBArray":true,"WScript":true,"WSH":true,"XDomainRequest":true},"jquery":{"$":false,"jQuery":false},"yui":{"YAHOO":false,"YAHOO_config":false,"YUI":false,"YUI_config":false},"shelljs":{"cat":false,"cd":false,"chmod":false,"config":false,"cp":false,"dirs":false,"echo":false,"env":false,"error":false,"exec":false,"exit":false,"find":false,"grep":false,"ln":false,"ls":false,"mkdir":false,"mv":false,"popd":false,"pushd":false,"pwd":false,"rm":false,"sed":false,"set":false,"target":false,"tempdir":false,"test":false,"touch":false,"which":false},"prototypejs":{"$":false,"$$":false,"$A":false,"$break":false,"$continue":false,"$F":false,"$H":false,"$R":false,"$w":false,"Abstract":false,"Ajax":false,"Autocompleter":false,"Builder":false,"Class":false,"Control":false,"Draggable":false,"Draggables":false,"Droppables":false,"Effect":false,"Element":false,"Enumerable":false,"Event":false,"Field":false,"Form":false,"Hash":false,"Insertion":false,"ObjectRange":false,"PeriodicalExecuter":false,"Position":false,"Prototype":false,"Scriptaculous":false,"Selector":false,"Sortable":false,"SortableObserver":false,"Sound":false,"Template":false,"Toggle":false,"Try":false},"meteor":{"_":false,"$":false,"Accounts":false,"AccountsClient":false,"AccountsCommon":false,"AccountsServer":false,"App":false,"Assets":false,"Blaze":false,"check":false,"Cordova":false,"DDP":false,"DDPRateLimiter":false,"DDPServer":false,"Deps":false,"EJSON":false,"Email":false,"HTTP":false,"Log":false,"Match":false,"Meteor":false,"Mongo":false,"MongoInternals":false,"Npm":false,"Package":false,"Plugin":false,"process":false,"Random":false,"ReactiveDict":false,"ReactiveVar":false,"Router":false,"ServiceConfiguration":false,"Session":false,"share":false,"Spacebars":false,"Template":false,"Tinytest":false,"Tracker":false,"UI":false,"Utils":false,"WebApp":false,"WebAppInternals":false},"mongo":{"_isWindows":false,"_rand":false,"BulkWriteResult":false,"cat":false,"cd":false,"connect":false,"db":false,"getHostName":false,"getMemInfo":false,"hostname":false,"ISODate":false,"listFiles":false,"load":false,"ls":false,"md5sumFile":false,"mkdir":false,"Mongo":false,"NumberInt":false,"NumberLong":false,"ObjectId":false,"PlanCache":false,"print":false,"printjson":false,"pwd":false,"quit":false,"removeFile":false,"rs":false,"sh":false,"UUID":false,"version":false,"WriteResult":false},"applescript":{"$":false,"Application":false,"Automation":false,"console":false,"delay":false,"Library":false,"ObjC":false,"ObjectSpecifier":false,"Path":false,"Progress":false,"Ref":false},"serviceworker":{"addEventListener":false,"applicationCache":false,"atob":false,"Blob":false,"BroadcastChannel":false,"btoa":false,"Cache":false,"caches":false,"CacheStorage":false,"clearInterval":false,"clearTimeout":false,"Client":false,"clients":false,"Clients":false,"close":true,"console":false,"ExtendableEvent":false,"ExtendableMessageEvent":false,"fetch":false,"FetchEvent":false,"FileReaderSync":false,"FormData":false,"Headers":false,"IDBCursor":false,"IDBCursorWithValue":false,"IDBDatabase":false,"IDBFactory":false,"IDBIndex":false,"IDBKeyRange":false,"IDBObjectStore":false,"IDBOpenDBRequest":false,"IDBRequest":false,"IDBTransaction":false,"IDBVersionChangeEvent":false,"ImageData":false,"importScripts":false,"indexedDB":false,"location":false,"MessageChannel":false,"MessagePort":false,"name":false,"navigator":false,"Notification":false,"onclose":true,"onconnect":true,"onerror":true,"onfetch":true,"oninstall":true,"onlanguagechange":true,"onmessage":true,"onmessageerror":true,"onnotificationclick":true,"onnotificationclose":true,"onoffline":true,"ononline":true,"onpush":true,"onpushsubscriptionchange":true,"onrejectionhandled":true,"onsync":true,"onunhandledrejection":true,"performance":false,"Performance":false,"PerformanceEntry":false,"PerformanceMark":false,"PerformanceMeasure":false,"PerformanceNavigation":false,"PerformanceResourceTiming":false,"PerformanceTiming":false,"postMessage":true,"Promise":false,"queueMicrotask":false,"registration":false,"removeEventListener":false,"Request":false,"Response":false,"self":false,"ServiceWorker":false,"ServiceWorkerContainer":false,"ServiceWorkerGlobalScope":false,"ServiceWorkerMessageEvent":false,"ServiceWorkerRegistration":false,"setInterval":false,"setTimeout":false,"skipWaiting":false,"TextDecoder":false,"TextEncoder":false,"URL":false,"URLSearchParams":false,"WebSocket":false,"WindowClient":false,"Worker":false,"WorkerGlobalScope":false,"XMLHttpRequest":false},"atomtest":{"advanceClock":false,"fakeClearInterval":false,"fakeClearTimeout":false,"fakeSetInterval":false,"fakeSetTimeout":false,"resetTimeouts":false,"waitsForPromise":false},"embertest":{"andThen":false,"click":false,"currentPath":false,"currentRouteName":false,"currentURL":false,"fillIn":false,"find":false,"findAll":false,"findWithAssert":false,"keyEvent":false,"pauseTest":false,"resumeTest":false,"triggerEvent":false,"visit":false,"wait":false},"protractor":{"$":false,"$$":false,"browser":false,"by":false,"By":false,"DartObject":false,"element":false,"protractor":false},"shared-node-browser":{"clearInterval":false,"clearTimeout":false,"console":false,"setInterval":false,"setTimeout":false,"URL":false,"URLSearchParams":false},"webextensions":{"browser":false,"chrome":false,"opr":false},"greasemonkey":{"cloneInto":false,"createObjectIn":false,"exportFunction":false,"GM":false,"GM_addStyle":false,"GM_deleteValue":false,"GM_getResourceText":false,"GM_getResourceURL":false,"GM_getValue":false,"GM_info":false,"GM_listValues":false,"GM_log":false,"GM_openInTab":false,"GM_registerMenuCommand":false,"GM_setClipboard":false,"GM_setValue":false,"GM_xmlhttpRequest":false,"unsafeWindow":false},"devtools":{"$":false,"$_":false,"$$":false,"$0":false,"$1":false,"$2":false,"$3":false,"$4":false,"$x":false,"chrome":false,"clear":false,"copy":false,"debug":false,"dir":false,"dirxml":false,"getEventListeners":false,"inspect":false,"keys":false,"monitor":false,"monitorEvents":false,"profile":false,"profileEnd":false,"queryObjects":false,"table":false,"undebug":false,"unmonitor":false,"unmonitorEvents":false,"values":false}}')}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>transform});var lib=__webpack_require__("./node_modules/.pnpm/@babel+core@7.26.0/node_modules/@babel/core/lib/index.js"),external_url_=__webpack_require__("url"),template_lib=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/index.js");function TransformImportMetaPlugin(_ctx,opts){return{name:"transform-import-meta",visitor:{Program(path){const metas=[];if(path.traverse({MemberExpression(memberExpPath){const{node}=memberExpPath;"MetaProperty"===node.object.type&&"import"===node.object.meta.name&&"meta"===node.object.property.name&&"Identifier"===node.property.type&&"url"===node.property.name&&metas.push(memberExpPath)}}),0!==metas.length)for(const meta of metas)meta.replaceWith(template_lib.smart.ast`${opts.filename?JSON.stringify((0,external_url_.pathToFileURL)(opts.filename)):"require('url').pathToFileURL(__filename).toString()"}`)}}}}function importMetaEnvPlugin({template,types}){return{name:"@import-meta-env/babel",visitor:{Identifier(path){if(!types.isIdentifier(path))return;if(!types.isMemberExpression(path.parentPath)&&!types.isOptionalMemberExpression(path.parentPath))return;if(!types.isMemberExpression(path.parentPath.node))return;const parentNode=path.parentPath.node;if(!types.isMetaProperty(parentNode.object))return;const parentNodeObjMeta=parentNode.object;"import"===parentNodeObjMeta.meta.name&&"meta"===parentNodeObjMeta.property.name&&"env"===parentNode.property.name&&path.parentPath.replaceWith(template.expression.ast("process.env"))}}}}function transform(opts){var _a,_b,_c,_d,_e,_f;const _opts=Object.assign(Object.assign({babelrc:!1,configFile:!1,compact:!1,retainLines:"boolean"!=typeof opts.retainLines||opts.retainLines,filename:"",cwd:"/"},opts.babel),{plugins:[[__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-modules-commonjs@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-modules-commonjs/lib/index.js"),{allowTopLevelThis:!0}],[__webpack_require__("./node_modules/.pnpm/babel-plugin-dynamic-import-node@2.3.3/node_modules/babel-plugin-dynamic-import-node/lib/index.js"),{noInterop:!0}],[TransformImportMetaPlugin,{filename:opts.filename}],[__webpack_require__("./node_modules/.pnpm/@babel+plugin-syntax-class-properties@7.12.13_@babel+core@7.26.0/node_modules/@babel/plugin-syntax-class-properties/lib/index.js")],[__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-export-namespace-from@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-transform-export-namespace-from/lib/index.js")],[importMetaEnvPlugin]]});opts.ts&&(_opts.plugins.push([__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-typescript@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-typescript/lib/index.js"),{allowDeclareFields:!0}]),_opts.plugins.unshift([__webpack_require__("./node_modules/.pnpm/babel-plugin-transform-typescript-metadata@0.3.2_@babel+core@7.26.0_@babel+traverse@7.26.4/node_modules/babel-plugin-transform-typescript-metadata/lib/plugin.js")],[__webpack_require__("./node_modules/.pnpm/@babel+plugin-proposal-decorators@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-proposal-decorators/lib/index.js"),{legacy:!0}]),_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/babel-plugin-parameter-decorator@1.0.16/node_modules/babel-plugin-parameter-decorator/lib/index.js")),_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/@babel+plugin-syntax-import-assertions@7.26.0_@babel+core@7.26.0/node_modules/@babel/plugin-syntax-import-assertions/lib/index.js"))),opts.legacy&&(_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-nullish-coalescing-operator@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-transform-nullish-coalescing-operator/lib/index.js")),_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-optional-chaining@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-transform-optional-chaining/lib/index.js"))),opts.babel&&Array.isArray(opts.babel.plugins)&&(null===(_a=_opts.plugins)||void 0===_a||_a.push(...opts.babel.plugins));try{return{code:(null===(_b=(0,lib.transformSync)(opts.source,_opts))||void 0===_b?void 0:_b.code)||""}}catch(error){return{error,code:"exports.__JITI_ERROR__ = "+JSON.stringify({filename:opts.filename,line:(null===(_c=error.loc)||void 0===_c?void 0:_c.line)||0,column:(null===(_d=error.loc)||void 0===_d?void 0:_d.column)||0,code:null===(_e=error.code)||void 0===_e?void 0:_e.replace("BABEL_","").replace("PARSE_ERROR","ParseError"),message:null===(_f=error.message)||void 0===_f?void 0:_f.replace("/: ","").replace(/\(.+\)\s*$/,"")})}}}})(),module.exports=__webpack_exports__.default})();
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),n=require("react"),t=require("@react-three/fiber"),r=require("three"),o=require("three-stdlib"),u=require("./useEnvironment.cjs.js");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}})),n.default=e,Object.freeze(n)}require("@monogrid/gainmap-js"),require("../helpers/environment-assets.cjs.js");var s=a(e),c=i(n);function l(e,n,r,o,u={}){var a,i,s,c;u={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...u};const l=(e=>{return(n=e).current&&n.current.isScene?e.current:e;var n})(n||r),d=l.background,m=l.environment,g={backgroundBlurriness:l.backgroundBlurriness,backgroundIntensity:l.backgroundIntensity,backgroundRotation:null!==(a=null==(i=l.backgroundRotation)||null==i.clone?void 0:i.clone())&&void 0!==a?a:[0,0,0],environmentIntensity:l.environmentIntensity,environmentRotation:null!==(s=null==(c=l.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==s?s:[0,0,0]};return"only"!==e&&(l.environment=o),e&&(l.background=o),t.applyProps(l,u),()=>{"only"!==e&&(l.environment=m),e&&(l.background=d),t.applyProps(l,g)}}function d({scene:e,background:n=!1,map:r,...o}){const u=t.useThree((e=>e.scene));return c.useLayoutEffect((()=>{if(r)return l(n,e,u,r,o)})),null}function m({background:e=!1,scene:n,blur:r,backgroundBlurriness:o,backgroundIntensity:a,backgroundRotation:i,environmentIntensity:s,environmentRotation:d,...m}){const g=u.useEnvironment(m),b=t.useThree((e=>e.scene));return c.useLayoutEffect((()=>l(e,n,b,g,{backgroundBlurriness:null!=r?r:o,backgroundIntensity:a,backgroundRotation:i,environmentIntensity:s,environmentRotation:d}))),c.useEffect((()=>()=>{g.dispose()}),[g]),null}function g({children:e,near:n=.1,far:o=1e3,resolution:u=256,frames:a=1,map:i,background:s=!1,blur:g,backgroundBlurriness:b,backgroundIntensity:f,backgroundRotation:v,environmentIntensity:p,environmentRotation:k,scene:E,files:y,path:h,preset:I,extensions:R}){const j=t.useThree((e=>e.gl)),x=t.useThree((e=>e.scene)),P=c.useRef(null),[C]=c.useState((()=>new r.Scene)),q=c.useMemo((()=>{const e=new r.WebGLCubeRenderTarget(u);return e.texture.type=r.HalfFloatType,e}),[u]);c.useEffect((()=>()=>{q.dispose()}),[q]),c.useLayoutEffect((()=>{if(1===a){const e=j.autoClear;j.autoClear=!0,P.current.update(j,C),j.autoClear=e}return l(s,E,x,q.texture,{backgroundBlurriness:null!=g?g:b,backgroundIntensity:f,backgroundRotation:v,environmentIntensity:p,environmentRotation:k})}),[e,C,q.texture,E,x,s,a,j]);let B=1;return t.useFrame((()=>{if(a===1/0||B<a){const e=j.autoClear;j.autoClear=!0,P.current.update(j,C),j.autoClear=e,B++}})),c.createElement(c.Fragment,null,t.createPortal(c.createElement(c.Fragment,null,e,c.createElement("cubeCamera",{ref:P,args:[n,o,q]}),y||I?c.createElement(m,{background:!0,files:y,preset:I,path:h,extensions:R}):i?c.createElement(d,{background:!0,map:i,extensions:R}):null),C))}function b(e){var n,r,a,i;const l=u.useEnvironment(e),m=e.map||l;c.useMemo((()=>t.extend({GroundProjectedEnvImpl:o.GroundProjectedEnv})),[]),c.useEffect((()=>()=>{l.dispose()}),[l]);const g=c.useMemo((()=>[m]),[m]),b=null==(n=e.ground)?void 0:n.height,f=null==(r=e.ground)?void 0:r.radius,v=null!==(a=null==(i=e.ground)?void 0:i.scale)&&void 0!==a?a:1e3;return c.createElement(c.Fragment,null,c.createElement(d,s.default({},e,{map:m})),c.createElement("groundProjectedEnvImpl",{args:g,scale:v,height:b,radius:f}))}exports.Environment=function(e){return e.ground?c.createElement(b,e):e.map?c.createElement(d,e):e.children?c.createElement(g,e):c.createElement(m,e)},exports.EnvironmentCube=m,exports.EnvironmentMap=d,exports.EnvironmentPortal=g;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:  }), files || preset ? /*#__PURE__*/React.createElement(EnvironmentCube, {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Stage.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("react"),i=require("./Environment.cjs.js"),n=require("./ContactShadows.cjs.js"),r=require("./Center.cjs.js"),a=require("./AccumulativeShadows.cjs.js"),s=require("./Bounds.cjs.js");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}require("@react-three/fiber"),require("three"),require("three-stdlib"),require("./useEnvironment.cjs.js"),require("@monogrid/gainmap-js"),require("../helpers/environment-assets.cjs.js"),require("./shaderMaterial.cjs.js"),require("../materials/DiscardMaterial.cjs.js"),require("../helpers/constants.cjs.js");var o=l(e),c=u(t);const d={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function m({radius:e,adjustCamera:t}){const i=s.useBounds();return c.useEffect((()=>{t&&i.refresh().clip().fit()}),[e,t]),null}exports.Stage=function({children:e,center:t,adjustCamera:l=!0,intensity:u=.5,shadows:f="contact",environment:p="city",preset:h="rembrandt",...j}){var v,b,g,y,E,q,w,C;const S="string"==typeof h?d[h]:h,[{radius:O,height:z},B]=c.useState({radius:0,width:0,height:0,depth:0}),M=null!==(v=null==f?void 0:f.bias)&&void 0!==v?v:-1e-4,L=null!==(b=null==f?void 0:f.normalBias)&&void 0!==b?b:0,_=null!==(g=null==f?void 0:f.size)&&void 0!==g?g:1024,x=null!==(y=null==f?void 0:f.offset)&&void 0!==y?y:0,P="contact"===f||"contact"===(null==f?void 0:f.type),k="accumulative"===f||"accumulative"===(null==f?void 0:f.type),A={..."object"==typeof f?f:{}},D=p?"string"==typeof p?{preset:p}:p:null,F=c.useCallback((e=>{const{width:i,height:n,depth:r,boundingSphere:a}=e;B({radius:a.radius,width:i,height:n,depth:r}),null!=t&&t.onCentered&&t.onCentered(e)}),[]);return c.createElement(c.Fragment,null,c.createElement("ambientLight",{intensity:u/3}),c.createElement("spotLight",{penumbra:1,position:[S.main[0]*O,S.main[1]*O,S.main[2]*O],intensity:2*u,castShadow:!!f,"shadow-bias":M,"shadow-normalBias":L,"shadow-mapSize":_}),c.createElement("pointLight",{position:[S.fill[0]*O,S.fill[1]*O,S.fill[2]*O],intensity:u}),c.createElement(s.Bounds,o.default({fit:!!l,clip:!!l,margin:Number(l),observe:!0},j),c.createElement(m,{radius:O,adjustCamera:l}),c.createElement(r.Center,o.default({},t,{position:[0,x/2,0],onCentered:F}),e)),c.createElement("group",{position:[0,-z/2-x/2,0]},P&&c.createElement(n.ContactShadows,o.default({scale:4*O,far:O,blur:2},A)),k&&c.createElement(a.AccumulativeShadows,o.default({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:4*O},A),c.createElement(a.RandomizedLight,{amount:null!==(E=A.amount)&&void 0!==E?E:8,radius:null!==(q=A.radius)&&void 0!==q?q:O,ambient:null!==(w=A.ambient)&&void 0!==w?w:.5,intensity:null!==(C=A.intensity)&&void 0!==C?C:1,position:[S.main[0]*O,S.main[1]*O,S.main[2]*O],size:4*O,bias:-M,mapSize:_}))),p&&c.createElement(i.Environment,D))};
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@react-three/fiber"),t=require("three"),n=require("three-stdlib"),r=require("@monogrid/gainmap-js"),s=require("../helpers/environment-assets.cjs.js"),o=require("react");const i="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",p=e=>Array.isArray(e),a=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function l({files:n=a,path:r="",preset:l,colorSpace:c,extensions:u}={}){l&&(d(l),n=s.presetsObj[l],r=i);const h=p(n),{extension:f,isCubemap:j}=g(n),m=b(f);if(!m)throw new Error("useEnvironment: Unrecognized file extension: "+n);const x=e.useThree((e=>e.gl));o.useLayoutEffect((()=>{"webp"!==f&&"jpg"!==f&&"jpeg"!==f||x.domElement.addEventListener("webglcontextlost",(function(){e.useLoader.clear(m,h?[n]:n)}),{once:!0})}),[n,x.domElement]);const w=e.useLoader(m,h?[n]:n,(e=>{"webp"!==f&&"jpg"!==f&&"jpeg"!==f||e.setRenderer(x),null==e.setPath||e.setPath(r),u&&u(e)}));let E=h?w[0]:w;var v;"jpg"!==f&&"jpeg"!==f&&"webp"!==f||(E=null==(v=E.renderTarget)?void 0:v.texture);return E.mapping=j?t.CubeReflectionMapping:t.EquirectangularReflectionMapping,E.colorSpace=null!=c?c:j?"srgb":"srgb-linear",E}const c={files:a,path:"",preset:void 0,extensions:void 0};l.preload=t=>{const n={...c,...t};let{files:r,path:o=""}=n;const{preset:a,extensions:l}=n;a&&(d(a),r=s.presetsObj[a],o=i);const{extension:u}=g(r);if("webp"===u||"jpg"===u||"jpeg"===u)throw new Error("useEnvironment: Preloading gainmaps is not supported");const h=b(u);if(!h)throw new Error("useEnvironment: Unrecognized file extension: "+r);e.useLoader.preload(h,p(r)?[r]:r,(e=>{null==e.setPath||e.setPath(o),l&&l(e)}))};const u={files:a,preset:void 0};function d(e){if(!(e in s.presetsObj))throw new Error("Preset must be one of: "+Object.keys(s.presetsObj).join(", "))}function g(e){var t;const n=p(e)&&6===e.length,r=p(e)&&3===e.length&&e.some((e=>e.endsWith("json"))),s=p(e)?e[0]:e;return{extension:n?"cube":r?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":null==(t=s.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:n,isGainmap:r}}function b(e){return"cube"===e?t.CubeTextureLoader:"hdr"===e?n.RGBELoader:"exr"===e?n.EXRLoader:"jpg"===e||"jpeg"===e?r.HDRJPGLoader:"webp"===e?r.GainMapLoader:null}l.clear=t=>{const n={...u,...t};let{files:r}=n;const{preset:o}=n;o&&(d(o),r=s.presetsObj[o]);const{extension:i}=g(r),a=b(i);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+r);e.useLoader.clear(a,p(r)?[r]:r)},exports.useEnvironment=l;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:export declare function EnvironmentPortal({ children, near, far, resolution, frames, map, background, blur, backgroundBlurriness, backgroundIntensity, backgroundRotation, environmentIntensity, environmentRotation, scene, files, path, preset, extensions, }: EnvironmentProps): React.JSX.Element;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Stage.d.ts:    environment?: PresetsType | Partial<EnvironmentProps> | null;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:export declare function useEnvironment({ files, path, preset, colorSpace, extensions, }?: Partial<EnvironmentLoaderProps>): Texture | CubeTexture;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:type EnvironmentLoaderClearOptions = Pick<EnvironmentLoaderProps, 'files' | 'preset'>;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/index.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("react"),r=require("react-dom/client"),n=require("three"),a=require("@react-three/fiber"),o=require("zustand"),i=require("@use-gesture/react"),s=require("maath"),l=require("zustand/middleware"),c=require("three-stdlib"),u=require("zustand/shallow"),d=require("troika-three-text"),m=require("suspend-react"),f=require("meshline"),p=require("camera-controls"),h=require("hls.js"),x=require("stats.js"),y=require("stats-gl"),v=require("detect-gpu"),g=require("three-mesh-bvh"),w=require("@monogrid/gainmap-js"),z=require("tunnel-rat");function b(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function E(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var M=b(e),S=E(t),C=E(r),T=E(n),P=b(p),R=b(x),D=b(y),F=b(z);const k=new n.Vector3,_=new n.Vector3,A=new n.Vector3,L=new n.Vector2;function I(e,t,r){const n=k.setFromMatrixPosition(e.matrixWorld);n.project(t);const a=r.width/2,o=r.height/2;return[n.x*a+a,-n.y*o+o]}const B=e=>Math.abs(e)<1e-10?0:e;function U(e,t,r=""){let n="matrix3d(";for(let r=0;16!==r;r++)n+=B(t[r]*e.elements[r])+(15!==r?",":")");return r+n}const V=(O=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>U(e,O));var O;const N=(e,t)=>{return U(e,[1/(r=t),1/r,1/r,1,-1/r,-1/r,-1/r,-1,1/r,1/r,1/r,1,1,1,1,1],"translate(-50%,-50%)");var r};const j=S.forwardRef((({children:e,eps:t=.001,style:r,className:o,prepend:i,center:s,fullscreen:l,portal:c,distanceFactor:u,sprite:d=!1,transform:m=!1,occlude:f,onOcclude:p,castShadow:h,receiveShadow:x,material:y,geometry:v,zIndexRange:g=[16777271,0],calculatePosition:w=I,as:z="div",wrapperClass:b,pointerEvents:E="auto",...T},P)=>{const{gl:R,camera:D,scene:F,size:U,raycaster:O,events:j,viewport:W}=a.useThree(),[G]=S.useState((()=>document.createElement(z))),H=S.useRef(null),$=S.useRef(null),q=S.useRef(0),X=S.useRef([0,0]),Z=S.useRef(null),Y=S.useRef(null),Q=(null==c?void 0:c.current)||j.connected||R.domElement.parentNode,K=S.useRef(null),J=S.useRef(!1),ee=S.useMemo((()=>f&&"blending"!==f||Array.isArray(f)&&f.length&&function(e){return e&&"object"==typeof e&&"current"in e}(f[0])),[f]);S.useLayoutEffect((()=>{const e=R.domElement;f&&"blending"===f?(e.style.zIndex=`${Math.floor(g[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)}),[f]),S.useLayoutEffect((()=>{if($.current){const e=H.current=C.createRoot(G);if(F.updateMatrixWorld(),m)G.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=w($.current,D,U);G.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return Q&&(i?Q.prepend(G):Q.appendChild(G)),()=>{Q&&Q.removeChild(G),e.unmount()}}}),[Q,m]),S.useLayoutEffect((()=>{b&&(G.className=b)}),[b]);const te=S.useMemo((()=>m?{position:"absolute",top:0,left:0,width:U.width,height:U.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...l&&{top:-U.height/2,left:-U.width/2,width:U.width,height:U.height},...r}),[r,s,l,U,m]),re=S.useMemo((()=>({position:"absolute",pointerEvents:E})),[E]);S.useLayoutEffect((()=>{var t,n;(J.current=!1,m)?null==(t=H.current)||t.render(S.createElement("div",{ref:Z,style:te},S.createElement("div",{ref:Y,style:re},S.createElement("div",{ref:P,className:o,style:r,children:e})))):null==(n=H.current)||n.render(S.createElement("div",{ref:P,style:te,className:o,children:e}))}));const ne=S.useRef(!0);a.useFrame((e=>{if($.current){D.updateMatrixWorld(),$.current.updateWorldMatrix(!0,!1);const e=m?X.current:w($.current,D,U);if(m||Math.abs(q.current-D.zoom)>t||Math.abs(X.current[0]-e[0])>t||Math.abs(X.current[1]-e[1])>t){const t=function(e,t){const r=k.setFromMatrixPosition(e.matrixWorld),n=_.setFromMatrixPosition(t.matrixWorld),a=r.sub(n),o=t.getWorldDirection(A);return a.angleTo(o)>Math.PI/2}($.current,D);let r=!1;ee&&(Array.isArray(f)?r=f.map((e=>e.current)):"blending"!==f&&(r=[F]));const a=ne.current;if(r){const e=function(e,t,r,n){const a=k.setFromMatrixPosition(e.matrixWorld),o=a.clone();o.project(t),L.set(o.x,o.y),r.setFromCamera(L,t);const i=r.intersectObjects(n,!0);if(i.length){const e=i[0].distance;return a.distanceTo(r.ray.origin)<e}return!0}($.current,D,O,r);ne.current=e&&!t}else ne.current=!t;a!==ne.current&&(p?p(!ne.current):G.style.display=ne.current?"block":"none");const o=Math.floor(g[0]/2),i=f?ee?[g[0],o]:[o-1,0]:g;if(G.style.zIndex=`${function(e,t,r){if(t instanceof n.PerspectiveCamera||t instanceof n.OrthographicCamera){const n=k.setFromMatrixPosition(e.matrixWorld),a=_.setFromMatrixPosition(t.matrixWorld),o=n.distanceTo(a),i=(r[1]-r[0])/(t.far-t.near),s=r[1]-i*t.far;return Math.round(i*o+s)}}($.current,D,i)}`,m){const[e,t]=[U.width/2,U.height/2],r=D.projectionMatrix.elements[5]*t,{isOrthographicCamera:n,top:a,left:o,bottom:i,right:s}=D,l=V(D.matrixWorldInverse),c=n?`scale(${r})translate(${B(-(s+o)/2)}px,${B((a+i)/2)}px)`:`translateZ(${r}px)`;let m=$.current.matrixWorld;d&&(m=D.matrixWorldInverse.clone().transpose().copyPosition(m).scale($.current.scale),m.elements[3]=m.elements[7]=m.elements[11]=0,m.elements[15]=1),G.style.width=U.width+"px",G.style.height=U.height+"px",G.style.perspective=n?"":`${r}px`,Z.current&&Y.current&&(Z.current.style.transform=`${c}${l}translate(${e}px,${t}px)`,Y.current.style.transform=N(m,1/((u||10)/400)))}else{const t=void 0===u?1:function(e,t){if(t instanceof n.OrthographicCamera)return t.zoom;if(t instanceof n.PerspectiveCamera){const r=k.setFromMatrixPosition(e.matrixWorld),n=_.setFromMatrixPosition(t.matrixWorld),a=t.fov*Math.PI/180,o=r.distanceTo(n);return 1/(2*Math.tan(a/2)*o)}return 1}($.current,D)*u;G.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}X.current=e,q.current=D.zoom}}if(!ee&&K.current&&!J.current)if(m){if(Z.current){const e=Z.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=D;if(t||v)T.scale&&(Array.isArray(T.scale)?T.scale instanceof n.Vector3?K.current.scale.copy(T.scale.clone().divideScalar(1)):K.current.scale.set(1/T.scale[0],1/T.scale[1],1/T.scale[2]):K.current.scale.setScalar(1/T.scale));else{const t=(u||10)/400,r=e.clientWidth*t,n=e.clientHeight*t;K.current.scale.set(r,n,1)}J.current=!0}}}else{const t=G.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/W.factor,r=t.clientWidth*e,n=t.clientHeight*e;K.current.scale.set(r,n,1),J.current=!0}K.current.lookAt(e.camera.position)}}));const ae=S.useMemo((()=>({vertexShader:m?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[m]);return S.createElement("group",M.default({},T,{ref:$}),f&&!ee&&S.createElement("mesh",{castShadow:h,receiveShadow:x,ref:K},v||S.createElement("planeGeometry",null),y||S.createElement("shaderMaterial",{side:n.DoubleSide,vertexShader:ae.vertexShader,fragmentShader:ae.fragmentShader})))}));let W=0;const G=o.create((e=>(n.DefaultLoadingManager.onStart=(t,r,n)=>{e({active:!0,item:t,loaded:r,total:n,progress:(r-W)/(n-W)*100})},n.DefaultLoadingManager.onLoad=()=>{e({active:!1})},n.DefaultLoadingManager.onError=t=>e((e=>({errors:[...e.errors,t]}))),n.DefaultLoadingManager.onProgress=(t,r,n)=>{r===n&&(W=n),e({active:!0,item:t,loaded:r,total:n,progress:(r-W)/(n-W)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})));const H=e=>`Loading ${e.toFixed(2)}%`;const $={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}},q=S.createContext(null);function X(){return S.useContext(q)}const Z=S.forwardRef((({children:e},t)=>{const r=S.useRef(null);S.useImperativeHandle(t,(()=>r.current),[]);const n=X(),{width:o,height:i}=a.useThree((e=>e.viewport));return a.useFrame((()=>{r.current.position.x=n.horizontal?-o*(n.pages-1)*n.offset:0,r.current.position.y=n.horizontal?0:i*(n.pages-1)*n.offset})),S.createElement("group",{ref:r},e)})),Y=S.forwardRef((({children:e,style:t,...r},n)=>{const o=X(),i=S.useRef(null);S.useImperativeHandle(n,(()=>i.current),[]);const{width:s,height:l}=a.useThree((e=>e.size)),c=S.useContext(a.context),u=S.useMemo((()=>C.createRoot(o.fixed)),[o.fixed]);return a.useFrame((()=>{o.delta>o.eps&&(i.current.style.transform=`translate3d(${o.horizontal?-s*(o.pages-1)*o.offset:0}px,${o.horizontal?0:l*(o.pages-1)*-o.offset}px,0)`)})),u.render(S.createElement("div",M.default({ref:i,style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},r),S.createElement(q.Provider,{value:o},S.createElement(a.context.Provider,{value:c},e)))),null})),Q=S.forwardRef((({html:e,...t},r)=>{const n=e?Y:Z;return S.createElement(n,M.default({ref:r},t))}));const K=S.createContext(null);const J=S.createContext([]);const ee=S.forwardRef((function({children:e,follow:t=!0,lockX:r=!1,lockY:o=!1,lockZ:i=!1,...s},l){const c=S.useRef(null),u=S.useRef(null),d=new n.Quaternion;return a.useFrame((({camera:e})=>{if(!t||!u.current)return;const n=c.current.rotation.clone();u.current.updateMatrix(),u.current.updateWorldMatrix(!1,!1),u.current.getWorldQuaternion(d),e.getWorldQuaternion(c.current.quaternion).premultiply(d.invert()),r&&(c.current.rotation.x=n.x),o&&(c.current.rotation.y=n.y),i&&(c.current.rotation.z=n.z)})),S.useImperativeHandle(l,(()=>u.current),[]),S.createElement("group",M.default({ref:u},s),S.createElement("group",{ref:c},e))})),te=S.forwardRef((({children:e,depth:t=-1,...r},n)=>{const o=S.useRef(null);return S.useImperativeHandle(n,(()=>o.current),[]),a.useFrame((({camera:e})=>{o.current.quaternion.copy(e.quaternion),o.current.position.copy(e.position)})),S.createElement("group",M.default({ref:o},r),S.createElement("group",{"position-z":-t},e))})),re=new T.Vector3,ne=new T.Vector3,ae=new T.Vector3,oe=(e,t,r,n=1)=>{const a=re.set(e.x/r.width*2-1,-e.y/r.height*2+1,n);return a.unproject(t),a},ie=(e,t,r,n)=>{const a=((e,t,r)=>{const n=r.width/2,a=r.height/2;t.updateMatrixWorld(!1);const o=e.project(t);return o.x=o.x*n+n,o.y=-o.y*a+a,o})(ae.copy(e),r,n);let o=0;for(let i=0;i<2;++i){const s=ne.copy(a).setComponent(i,a.getComponent(i)+t),l=oe(s,r,n,s.z);o=Math.max(o,e.distanceTo(l))}return o},se=new n.Vector3,le=t.forwardRef((({scale:e=1,...r},n)=>{const o=t.useRef(null);return S.useImperativeHandle(n,(()=>o.current),[]),a.useFrame((t=>{const r=o.current;if(!r)return;const n=ie(r.getWorldPosition(se),e,t.camera,t.size);r.scale.setScalar(n*e)})),S.createElement("object3D",M.default({ref:o},r))})),ce=S.forwardRef((function({points:e,color:t=16777215,vertexColors:r,linewidth:o,lineWidth:i,segments:s,dashed:l,...u},d){var m,f;const p=a.useThree((e=>e.size)),h=S.useMemo((()=>s?new c.LineSegments2:new c.Line2),[s]),[x]=S.useState((()=>new c.LineMaterial)),y=4===(null==r||null==(m=r[0])?void 0:m.length)?4:3,v=S.useMemo((()=>{const a=s?new c.LineSegmentsGeometry:new c.LineGeometry,o=e.map((e=>{const t=Array.isArray(e);return e instanceof n.Vector3||e instanceof n.Vector4?[e.x,e.y,e.z]:e instanceof n.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}));if(a.setPositions(o.flat()),r){t=16777215;const e=r.map((e=>e instanceof n.Color?e.toArray():e));a.setColors(e.flat(),y)}return a}),[e,s,r,y]);return S.useLayoutEffect((()=>{h.computeLineDistances()}),[e,h]),S.useLayoutEffect((()=>{l?x.defines.USE_DASH="":delete x.defines.USE_DASH,x.needsUpdate=!0}),[l,x]),S.useEffect((()=>()=>{v.dispose(),x.dispose()}),[v]),S.createElement("primitive",M.default({object:h,ref:d},u),S.createElement("primitive",{object:v,attach:"geometry"}),S.createElement("primitive",M.default({object:x,attach:"material",color:t,vertexColors:Boolean(r),resolution:[p.width,p.height],linewidth:null!==(f=null!=o?o:i)&&void 0!==f?f:1,dashed:l,transparent:4===y},u)))})),ue=new n.Vector3,de=S.forwardRef((function({start:e=[0,0,0],end:t=[0,0,0],mid:r,segments:a=20,...o},i){const s=S.useRef(null);S.useImperativeHandle(i,(()=>s.current));const[l]=S.useState((()=>new n.QuadraticBezierCurve3(void 0,void 0,void 0))),c=S.useCallback(((e,t,r,a=20)=>(e instanceof n.Vector3?l.v0.copy(e):l.v0.set(...e),t instanceof n.Vector3?l.v2.copy(t):l.v2.set(...t),r instanceof n.Vector3?l.v1.copy(r):Array.isArray(r)?l.v1.set(...r):l.v1.copy(l.v0.clone().add(l.v2.clone().sub(l.v0)).add(ue.set(0,l.v0.y-l.v2.y,0))),l.getPoints(a))),[]);S.useLayoutEffect((()=>{s.current.setPoints=(e,t,r)=>{const n=c(e,t,r);s.current.geometry&&s.current.geometry.setPositions(n.map((e=>e.toArray())).flat())}}),[]);const u=S.useMemo((()=>c(e,t,r,a)),[e,t,r,a]);return S.createElement(ce,M.default({ref:s,points:u},o))})),me=S.forwardRef((function({start:e,end:t,midA:r,midB:a,segments:o=20,...i},s){const l=S.useMemo((()=>{const i=e instanceof n.Vector3?e:new n.Vector3(...e),s=t instanceof n.Vector3?t:new n.Vector3(...t),l=r instanceof n.Vector3?r:new n.Vector3(...r),c=a instanceof n.Vector3?a:new n.Vector3(...a);return new n.CubicBezierCurve3(i,l,c,s).getPoints(o)}),[e,t,r,a,o]);return S.createElement(ce,M.default({ref:s,points:l},i))})),fe=S.forwardRef((function({points:e,closed:t=!1,curveType:r="centripetal",tension:a=.5,segments:o=20,vertexColors:i,...s},l){const c=S.useMemo((()=>{const o=e.map((e=>e instanceof n.Vector3?e:new n.Vector3(...e)));return new n.CatmullRomCurve3(o,t,r,a)}),[e,t,r,a]),u=S.useMemo((()=>c.getPoints(o)),[c,o]),d=S.useMemo((()=>{if(!i||i.length<2)return;if(i.length===o+1)return i;const e=i.map((e=>e instanceof n.Color?e:new n.Color(...e)));t&&e.push(e[0].clone());const r=[e[0]],a=o/(e.length-1);for(let t=1;t<o;t++){const n=t%a/a,o=Math.floor(t/a);r.push(e[o].clone().lerp(e[o+1],n))}return r.push(e[e.length-1]),r}),[i,o]);return S.createElement(ce,M.default({ref:l,points:u,vertexColors:d},s))})),pe=S.forwardRef((({url:e,distance:t=1,loop:r=!0,autoplay:o,...i},s)=>{const l=S.useRef(null);S.useImperativeHandle(s,(()=>l.current),[]);const c=a.useThree((({camera:e})=>e)),[u]=S.useState((()=>new n.AudioListener)),d=a.useLoader(n.AudioLoader,e);return S.useEffect((()=>{const e=l.current;e&&(e.setBuffer(d),e.setRefDistance(t),e.setLoop(r),o&&!e.isPlaying&&e.play())}),[d,c,t,r]),S.useEffect((()=>{const e=l.current;return c.add(u),()=>{c.remove(u),e&&(e.isPlaying&&e.stop(),e.source&&e.source._connected&&e.disconnect())}}),[]),S.createElement("positionalAudio",M.default({ref:l,args:[u]},i))})),he=S.forwardRef((({sdfGlyphSize:e=64,anchorX:t="center",anchorY:r="middle",font:n,fontSize:o=1,children:i,characters:s,onSync:l,...c},u)=>{const f=a.useThree((({invalidate:e})=>e)),[p]=S.useState((()=>new d.Text)),[h,x]=S.useMemo((()=>{const e=[];let t="";return S.Children.forEach(i,(r=>{"string"==typeof r||"number"==typeof r?t+=r:e.push(r)})),[e,t]}),[i]);return m.suspend((()=>new Promise((e=>d.preloadFont({font:n,characters:s},e)))),["troika-text",n,s]),S.useLayoutEffect((()=>{p.sync((()=>{f(),l&&l(p)}))})),S.useEffect((()=>()=>p.dispose()),[p]),S.createElement("primitive",M.default({object:p,ref:u,font:n,text:x,anchorX:t,anchorY:r,fontSize:o,sdfGlyphSize:e},c),h)}));let xe=null;async function ye(e){const t=await async function(e){return"string"==typeof e?await(await fetch(e)).json():e}(e);return r=t,xe||(xe=new c.FontLoader),xe.parse(r);var r}function ve(e){return m.suspend(ye,[e])}ve.preload=e=>m.preload(ye,[e]),ve.clear=e=>m.clear([e]);const ge=["string","number"],we=S.forwardRef((({font:e,letterSpacing:r=0,lineHeight:n=1,size:o=1,height:i=.2,bevelThickness:s=.1,bevelSize:l=.01,bevelEnabled:u=!1,bevelOffset:d=0,bevelSegments:m=4,curveSegments:f=8,smooth:p,children:h,...x},y)=>{S.useMemo((()=>a.extend({RenamedTextGeometry:c.TextGeometry})),[]);const v=S.useRef(null),g=ve(e),w=t.useMemo((()=>({font:g,size:o,height:i,bevelThickness:s,bevelSize:l,bevelEnabled:u,bevelSegments:m,bevelOffset:d,curveSegments:f,letterSpacing:r,lineHeight:n})),[g,o,i,s,l,u,m,d,f,r,n]),[z,...b]=t.useMemo((()=>(e=>{let t="";const r=[];return S.Children.forEach(e,(e=>{ge.includes(typeof e)?t+=e+"":r.push(e)})),[t,...r]})(h)),[h]),E=S.useMemo((()=>[z,w]),[z,w]);return S.useLayoutEffect((()=>{p&&(v.current.geometry=c.mergeVertices(v.current.geometry,p),v.current.geometry.computeVertexNormals())}),[E,p]),S.useImperativeHandle(y,(()=>v.current),[]),S.createElement("mesh",M.default({},x,{ref:v}),S.createElement("renamedTextGeometry",{args:E}),b)})),ze=S.forwardRef((({children:e,multisamping:t=8,renderIndex:r=1,disableRender:o,disableGamma:i,disableRenderPass:s,depthBuffer:l=!0,stencilBuffer:u=!1,anisotropy:d=1,colorSpace:m,type:f,...p},h)=>{S.useMemo((()=>a.extend({EffectComposer:c.EffectComposer,RenderPass:c.RenderPass,ShaderPass:c.ShaderPass})),[]);const x=S.useRef(null);S.useImperativeHandle(h,(()=>x.current),[]);const{scene:y,camera:v,gl:g,size:w,viewport:z}=a.useThree(),[b]=S.useState((()=>{const e=new n.WebGLRenderTarget(w.width,w.height,{type:f||n.HalfFloatType,format:n.RGBAFormat,depthBuffer:l,stencilBuffer:u,anisotropy:d});return f===n.UnsignedByteType&&null!=m&&(e.texture.colorSpace=m),e.samples=t,e}));S.useEffect((()=>{var e,t;null==(e=x.current)||e.setSize(w.width,w.height),null==(t=x.current)||t.setPixelRatio(z.dpr)}),[g,w,z.dpr]),a.useFrame((()=>{var e;o||null==(e=x.current)||e.render()}),r);const E=[];return s||E.push(S.createElement("renderPass",{key:"renderpass",attach:`passes-${E.length}`,args:[y,v]})),i||E.push(S.createElement("shaderPass",{attach:`passes-${E.length}`,key:"gammapass",args:[c.GammaCorrectionShader]})),S.Children.forEach(e,(e=>{e&&E.push(S.cloneElement(e,{key:E.length,attach:`passes-${E.length}`}))})),S.createElement("effectComposer",M.default({ref:x,args:[g,b]},p),E)}));let be=function(e){return e.Linear="linear",e.Radial="radial",e}({});function Ee(e,t,r,n){var a;return(a=class extends T.ShaderMaterial{constructor(a){super({vertexShader:t,fragmentShader:r,...a});for(const t in e)this.uniforms[t]=new T.Uniform(e[t]),Object.defineProperty(this,t,{get(){return this.uniforms[t].value},set(e){this.uniforms[t].value=e}});this.uniforms=T.UniformsUtils.clone(this.uniforms),null==n||n(this)}}).key=T.MathUtils.generateUUID(),a}const Me=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function Se(e,r){const o=a.useThree((e=>e.gl)),i=a.useLoader(n.TextureLoader,Me(e)?Object.values(e):e);t.useLayoutEffect((()=>{null==r||r(i)}),[r]),t.useEffect((()=>{if("initTexture"in o){let e=[];Array.isArray(i)?e=i:i instanceof n.Texture?e=[i]:Me(i)&&(e=Object.values(i)),e.forEach((e=>{e instanceof n.Texture&&o.initTexture(e)}))}}),[o,i]);const s=t.useMemo((()=>{if(Me(e)){const t={};let r=0;for(const n in e)t[n]=i[r++];return t}return i}),[e,i]);return s}Se.preload=e=>a.useLoader.preload(n.TextureLoader,e),Se.clear=e=>a.useLoader.clear(n.TextureLoader,e);const Ce=(()=>parseInt(n.REVISION.replace(/\D+/g,"")))(),Te=Ee({color:new T.Color("white"),scale:new T.Vector2(1,1),imageBounds:new T.Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},"\n  varying vec2 vUv;\n  varying vec2 vPos;\n  void main() {\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n    vUv = uv;\n    vPos = position.xy;\n  }\n",`\n  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n  varying vec2 vUv;\n  varying vec2 vPos;\n  uniform vec2 scale;\n  uniform vec2 imageBounds;\n  uniform float resolution;\n  uniform vec3 color;\n  uniform sampler2D map;\n  uniform float radius;\n  uniform float zoom;\n  uniform float grayscale;\n  uniform float opacity;\n  const vec3 luma = vec3(.299, 0.587, 0.114);\n  vec4 toGrayscale(vec4 color, float intensity) {\n    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n  }\n  vec2 aspect(vec2 size) {\n    return size / min(size.x, size.y);\n  }\n  \n  const float PI = 3.14159265;\n    \n  // from https://iquilezles.org/articles/distfunctions\n  float udRoundBox( vec2 p, vec2 b, float r ) {\n    return length(max(abs(p)-b+r,0.0))-r;\n  }\n\n  void main() {\n    vec2 s = aspect(scale);\n    vec2 i = aspect(imageBounds);\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 uv = vUv * s / new + offset;\n    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n\n    vec2 res = vec2(scale * resolution);\n    vec2 halfRes = 0.5 * res;\n    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n\t  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n    \n    #include <tonemapping_fragment>\n    #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n  }\n`),Pe=S.forwardRef((({children:e,color:t,segments:r=1,scale:n=1,zoom:o=1,grayscale:i=0,opacity:s=1,radius:l=0,texture:c,toneMapped:u,transparent:d,side:m,...f},p)=>{a.extend({ImageMaterial:Te});const h=S.useRef(null),x=a.useThree((e=>e.size)),y=Array.isArray(n)?[n[0],n[1]]:[n,n],v=[c.image.width,c.image.height],g=Math.max(x.width,x.height);return S.useImperativeHandle(p,(()=>h.current),[]),S.useLayoutEffect((()=>{h.current.geometry.parameters&&h.current.material.scale.set(y[0]*h.current.geometry.parameters.width,y[1]*h.current.geometry.parameters.height)}),[y[0],y[1]]),S.createElement("mesh",M.default({ref:h,scale:Array.isArray(n)?[...n,1]:n},f),S.createElement("planeGeometry",{args:[1,1,r,r]}),S.createElement("imageMaterial",{color:t,map:c,zoom:o,grayscale:i,opacity:s,scale:y,imageBounds:v,resolution:g,radius:l,toneMapped:u,transparent:d,side:m,key:Te.key}),e)})),Re=S.forwardRef((({url:e,...t},r)=>{const n=Se(e);return S.createElement(Pe,M.default({},t,{texture:n,ref:r}))})),De=S.forwardRef((({url:e,...t},r)=>S.createElement(Pe,M.default({},t,{ref:r})))),Fe=S.forwardRef(((e,t)=>{if(e.url)return S.createElement(Re,M.default({},e,{ref:t}));if(e.texture)return S.createElement(De,M.default({},e,{ref:t}));throw new Error("<Image /> requires a url or texture")})),ke=S.forwardRef((({threshold:e=15,geometry:t,...r},n)=>{const a=S.useRef(null);S.useImperativeHandle(n,(()=>a.current),[]);const o=S.useMemo((()=>[0,0,0,1,0,0]),[]),i=S.useRef(null),s=S.useRef(null);return S.useLayoutEffect((()=>{const r=a.current.parent,n=null!=t?t:null==r?void 0:r.geometry;if(!n)return;if(i.current===n&&s.current===e)return;i.current=n,s.current=e;const o=new T.EdgesGeometry(n,e).attributes.position.array;a.current.geometry.setPositions(o),a.current.geometry.attributes.instanceStart.needsUpdate=!0,a.current.geometry.attributes.instanceEnd.needsUpdate=!0,a.current.computeLineDistances()})),S.createElement(ce,M.default({segments:!0,points:o,ref:a,raycast:()=>null},r))})),_e=Ee({screenspace:!1,color:new T.Color("black"),opacity:1,thickness:.05,size:new T.Vector2},"#include <common>\n   #include <morphtarget_pars_vertex>\n   #include <skinning_pars_vertex>\n   #include <clipping_planes_pars_vertex>\n   uniform float thickness;\n   uniform bool screenspace;\n   uniform vec2 size;\n   void main() {\n     #if defined (USE_SKINNING)\n\t     #include <beginnormal_vertex>\n       #include <morphnormal_vertex>\n       #include <skinbase_vertex>\n       #include <skinnormal_vertex>\n       #include <defaultnormal_vertex>\n     #endif\n     #include <begin_vertex>\n\t   #include <morphtarget_vertex>\n\t   #include <skinning_vertex>\n     #include <project_vertex>\n     #include <clipping_planes_vertex>\n     vec4 tNormal = vec4(normal, 0.0);\n     vec4 tPosition = vec4(transformed, 1.0);\n     #ifdef USE_INSTANCING\n       tNormal = instanceMatrix * tNormal;\n       tPosition = instanceMatrix * tPosition;\n     #endif\n     if (screenspace) {\n       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;\n       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); \n     } else {\n       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;\n       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;\n       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;\n       clipPosition.xy += offset;\n       gl_Position = clipPosition;\n     }\n   }",`uniform vec3 color;\n   uniform float opacity;\n   #include <clipping_planes_pars_fragment>\n   void main(){\n     #include <clipping_planes_fragment>\n     gl_FragColor = vec4(color, opacity);\n     #include <tonemapping_fragment>\n     #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`);const Ae={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},Le=(e,t=1)=>(e.set(e.subarray(t)),e.fill(-1/0,-t),e);function Ie(e,t){const{length:r,local:o,decay:i,interval:s,stride:l}={...Ae,...t},c=S.useRef(null),[u]=S.useState((()=>new n.Vector3));S.useLayoutEffect((()=>{e&&(c.current=Float32Array.from({length:10*r*3},((t,r)=>e.position.getComponent(r%3))))}),[r,e]);const d=S.useRef(new n.Vector3),m=S.useRef(0);return a.useFrame((()=>{if(e&&c.current){if(0===m.current){let t;o?t=e.position:(e.getWorldPosition(u),t=u);const r=1*i;for(let e=0;e<r;e++)t.distanceTo(d.current)<l||(Le(c.current,3),c.current.set(t.toArray(),c.current.length-3));d.current.copy(t)}m.current++,m.current=m.current%s}})),c}const Be=S.forwardRef(((e,t)=>{const{children:r}=e,{width:o,length:i,decay:s,local:l,stride:c,interval:u}={...Ae,...e},{color:d="hotpink",attenuation:m,target:p}=e,h=a.useThree((e=>e.size)),x=a.useThree((e=>e.scene)),y=S.useRef(null),[v,g]=S.useState(null),w=Ie(v,{length:i,decay:s,local:l,stride:c,interval:u});S.useEffect((()=>{const e=(null==p?void 0:p.current)||y.current.children.find((e=>e instanceof n.Object3D));e&&g(e)}),[w,p]);const z=S.useMemo((()=>new f.MeshLineGeometry),[]),b=S.useMemo((()=>{var e,t;const a=new f.MeshLineMaterial({lineWidth:.1*o,color:d,sizeAttenuation:1,resolution:new n.Vector2(h.width,h.height)});let i;if(r)if(Array.isArray(r))i=r.find((e=>{const t=e;return"string"==typeof t.type&&"meshLineMaterial"===t.type}));else{const e=r;"string"==typeof e.type&&"meshLineMaterial"===e.type&&(i=e)}return"object"==typeof(null==(e=i)?void 0:e.props)&&null!==(null==(t=i)?void 0:t.props)&&a.setValues(i.props),a}),[o,d,h,r]);return S.useEffect((()=>{b.uniforms.resolution.value.set(h.width,h.height)}),[h]),a.useFrame((()=>{w.current&&z.setPoints(w.current,m)})),S.createElement("group",null,a.createPortal(S.createElement("mesh",{ref:t,geometry:z,material:b}),x),S.createElement("group",{ref:y},r))}));function Ue(e,t=16,r,a,o){const[i,s]=S.useState((()=>{const e=Array.from({length:t},(()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])).flat();return new n.InstancedBufferAttribute(Float32Array.from(e),16)}));return S.useLayoutEffect((()=>{if(void 0===e.current)return;const l=new c.MeshSurfaceSampler(e.current);a&&l.setWeightAttribute(a),l.build();const u=new n.Vector3,d=new n.Vector3,m=new n.Color,f=new n.Object3D;e.current.updateMatrixWorld(!0);for(let n=0;n<t;n++)l.sample(u,d,m),"function"==typeof r?r({dummy:f,sampledMesh:e.current,position:u,normal:d,color:m},n):f.position.copy(u),f.updateMatrix(),null!=o&&o.current&&o.current.setMatrixAt(n,f.matrix),f.matrix.toArray(i.array,16*n);null!=o&&o.current&&(o.current.instanceMatrix.needsUpdate=!0),i.needsUpdate=!0,s(new n.InstancedBufferAttribute(i.array,i.itemSize).copy(i))}),[e,o,a,t,r]),i}const Ve=S.forwardRef((({isChild:e=!1,object:t,children:r,deep:n,castShadow:a,receiveShadow:o,inject:i,keys:s,...l},u)=>{const d={keys:s,deep:n,inject:i,castShadow:a,receiveShadow:o};if(t=S.useMemo((()=>{if(!1===e&&!Array.isArray(t)){let e=!1;if(t.traverse((t=>{t.isSkinnedMesh&&(e=!0)})),e)return c.SkeletonUtils.clone(t)}return t}),[t,e]),Array.isArray(t))return S.createElement("group",M.default({},l,{ref:u}),t.map((e=>S.createElement(Ve,M.default({key:e.uuid,object:e},d)))),r);const{children:m,...f}=function(e,{keys:t=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:r,inject:n,castShadow:a,receiveShadow:o}){let i={};for(const r of t)i[r]=e[r];return r&&(i.geometry&&"materialsOnly"!==r&&(i.geometry=i.geometry.clone()),i.material&&"geometriesOnly"!==r&&(i.material=i.material.clone())),n&&(i="function"==typeof n?{...i,children:n(e)}:S.isValidElement(n)?{...i,children:n}:{...i,...n}),e instanceof T.Mesh&&(a&&(i.castShadow=!0),o&&(i.receiveShadow=!0)),i}(t,d),p=t.type[0].toLowerCase()+t.type.slice(1);return S.createElement(p,M.default({},f,l,{ref:u}),t.children.map((e=>"Bone"===e.type?S.createElement("primitive",M.default({key:e.uuid,object:e},d)):S.createElement(Ve,M.default({key:e.uuid,object:e},d,{isChild:!0})))),r,m)})),Oe=S.createContext(null),Ne=S.forwardRef((({resolution:e=28,maxPolyCount:t=1e4,enableUvs:r=!1,enableColors:n=!1,children:o,...i},s)=>{const l=S.useRef(null);S.useImperativeHandle(s,(()=>l.current),[]);const u=S.useMemo((()=>new c.MarchingCubes(e,null,r,n,t)),[e,t,r,n]),d=S.useMemo((()=>({getParent:()=>l})),[]);return a.useFrame((()=>{u.update(),u.reset()}),-1),S.createElement(S.Fragment,null,S.createElement("primitive",M.default({object:u,ref:l},i),S.createElement(Oe.Provider,{value:d},o)))})),je=S.forwardRef((({strength:e=.5,subtract:t=12,color:r,...n},o)=>{const{getParent:i}=S.useContext(Oe),s=S.useMemo((()=>i()),[i]),l=S.useRef(null);S.useImperativeHandle(o,(()=>l.current),[]);const c=new T.Vector3;return a.useFrame((n=>{s.current&&l.current&&(l.current.getWorldPosition(c),s.current.addBall(.5+.5*c.x,.5+.5*c.y,.5+.5*c.z,e,t,r))})),S.createElement("group",M.default({ref:l},n))})),We=S.forwardRef((({planeType:e="x",strength:t=.5,subtract:r=12,...n},o)=>{const{getParent:i}=S.useContext(Oe),s=S.useMemo((()=>i()),[i]),l=S.useRef(null);S.useImperativeHandle(o,(()=>l.current),[]);const c=S.useMemo((()=>"x"===e?"addPlaneX":"y"===e?"addPlaneY":"addPlaneZ"),[e]);return a.useFrame((()=>{s.current&&l.current&&s.current[c](t,r)})),S.createElement("group",M.default({ref:l},n))}));function Ge(e=[0,0,0]){return function(e){return Array.isArray(e)}(e)?e:e instanceof T.Vector3||e instanceof T.Euler?[e.x,e.y,e.z]:[e,e,e]}const He=S.forwardRef((function({debug:e,depthTest:t=!1,polygonOffsetFactor:r=-10,map:n,mesh:o,children:i,position:s,rotation:l,scale:u,...d},m){const f=S.useRef(null);S.useImperativeHandle(m,(()=>f.current));const p=S.useRef(null),h=S.useRef({position:new T.Vector3,rotation:new T.Euler,scale:new T.Vector3(1,1,1)});return S.useLayoutEffect((()=>{const e=(null==o?void 0:o.current)||f.current.parent,t=f.current;if(!(e instanceof T.Mesh))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');if(e){a.applyProps(h.current,{position:s,scale:u});const r=e.matrixWorld.clone();if(e.matrixWorld.identity(),l&&"number"!=typeof l)a.applyProps(h.current,{rotation:l});else{const t=new T.Object3D;t.position.copy(h.current.position);const r=e.geometry.attributes.position.array;void 0===e.geometry.attributes.normal&&e.geometry.computeVertexNormals();const n=e.geometry.attributes.normal.array;let o=1/0,i=new T.Vector3;const s=t.position.x,c=t.position.y,u=t.position.z,d=r.length;let m=-1;for(let e=0;e<d;e+=3){const t=r[e]-s,n=r[e+1]-c,a=r[e+2]-u,i=t*t+n*n+a*a;i<o&&(o=i,m=e)}i.fromArray(n,m),t.lookAt(t.position.clone().add(i)),t.rotateZ(Math.PI),t.rotateY(Math.PI),"number"==typeof l&&t.rotateZ(l),a.applyProps(h.current,{rotation:t.rotation})}return p.current&&a.applyProps(p.current,h.current),t.geometry=new c.DecalGeometry(e,h.current.position,h.current.rotation,h.current.scale),e.matrixWorld=r,()=>{t.geometry.dispose()}}}),[o,...Ge(s),...Ge(u),...Ge(l)]),S.useLayoutEffect((()=>{p.current&&p.current.traverse((e=>e.raycast=()=>null))}),[e]),S.createElement("mesh",M.default({ref:f,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":r,"material-depthTest":t,"material-map":n},d),i,e&&S.createElement("mesh",{ref:p},S.createElement("boxGeometry",null),S.createElement("meshNormalMaterial",{wireframe:!0}),S.createElement("axesHelper",null)))})),$e=t.forwardRef((function({src:e,skipFill:r,skipStrokes:o,fillMaterial:i,strokeMaterial:s,fillMeshProps:l,strokeMeshProps:u,...d},m){const f=a.useLoader(c.SVGLoader,e.startsWith("<svg")?`data:image/svg+xml;utf8,${e}`:e),p=t.useMemo((()=>o?[]:f.paths.map((e=>{var t;return void 0===(null==(t=e.userData)?void 0:t.style.stroke)||"none"===e.userData.style.stroke?null:e.subPaths.map((t=>c.SVGLoader.pointsToStroke(t.getPoints(),e.userData.style)))}))),[f,o]);t.useEffect((()=>()=>p.forEach((e=>e&&e.map((e=>e.dispose()))))),[p]);let h=0;return S.createElement("object3D",M.default({ref:m},d),S.createElement("object3D",{scale:[1,-1,1]},f.paths.map(((e,a)=>{var d,m;return S.createElement(t.Fragment,{key:a},!r&&void 0!==(null==(d=e.userData)?void 0:d.style.fill)&&"none"!==e.userData.style.fill&&c.SVGLoader.createShapes(e).map(((t,r)=>S.createElement("mesh",M.default({key:r},l,{renderOrder:h++}),S.createElement("shapeGeometry",{args:[t]}),S.createElement("meshBasicMaterial",M.default({color:e.userData.style.fill,opacity:e.userData.style.fillOpacity,transparent:!0,side:n.DoubleSide,depthWrite:!1},i))))),!o&&void 0!==(null==(m=e.userData)?void 0:m.style.stroke)&&"none"!==e.userData.style.stroke&&e.subPaths.map(((t,r)=>S.createElement("mesh",M.default({key:r,geometry:p[a][r]},u,{renderOrder:h++}),S.createElement("meshBasicMaterial",M.default({color:e.userData.style.stroke,opacity:e.userData.style.strokeOpacity,transparent:!0,side:n.DoubleSide,depthWrite:!1},s))))))}))))}));let qe=null,Xe="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Ze(e=!0,t=!0,r){return n=>{r&&r(n),e&&(qe||(qe=new c.DRACOLoader),qe.setDecoderPath("string"==typeof e?e:Xe),n.setDRACOLoader(qe)),t&&n.setMeshoptDecoder("function"==typeof c.MeshoptDecoder?c.MeshoptDecoder():c.MeshoptDecoder)}}const Ye=(e,t,r,n)=>a.useLoader(c.GLTFLoader,e,Ze(t,r,n));Ye.preload=(e,t,r,n)=>a.useLoader.preload(c.GLTFLoader,e,Ze(t,r,n)),Ye.clear=e=>a.useLoader.clear(c.GLTFLoader,e),Ye.setDecoderPath=e=>{Xe=e};const Qe=S.forwardRef((({src:e,useDraco:t,useMeshOpt:r,extendLoader:n,...a},o)=>{const{scene:i}=Ye(e,t,r,n);return S.createElement(Ve,M.default({ref:o},a,{object:i}))}));const Ke=Ee({alphaTest:0,viewport:new T.Vector2(1980,1080),focal:1e3,centerAndScaleTexture:null,covAndColorTexture:null},"\n    precision highp sampler2D;\n    precision highp usampler2D;\n    out vec4 vColor;\n    out vec3 vPosition;\n    uniform vec2 resolution;\n    uniform vec2 viewport;\n    uniform float focal;\n    attribute uint splatIndex;\n    uniform sampler2D centerAndScaleTexture;\n    uniform usampler2D covAndColorTexture;    \n\n    vec2 unpackInt16(in uint value) {\n      int v = int(value);\n      int v0 = v >> 16;\n      int v1 = (v & 0xFFFF);\n      if((v & 0x8000) != 0)\n        v1 |= 0xFFFF0000;\n      return vec2(float(v1), float(v0));\n    }\n\n    void main () {\n      ivec2 texSize = textureSize(centerAndScaleTexture, 0);\n      ivec2 texPos = ivec2(splatIndex%uint(texSize.x), splatIndex/uint(texSize.x));\n      vec4 centerAndScaleData = texelFetch(centerAndScaleTexture, texPos, 0);\n      vec4 center = vec4(centerAndScaleData.xyz, 1);\n      vec4 camspace = modelViewMatrix * center;\n      vec4 pos2d = projectionMatrix * camspace;\n\n      float bounds = 1.2 * pos2d.w;\n      if (pos2d.z < -pos2d.w || pos2d.x < -bounds || pos2d.x > bounds\n        || pos2d.y < -bounds || pos2d.y > bounds) {\n        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);\n        return;\n      }\n\n      uvec4 covAndColorData = texelFetch(covAndColorTexture, texPos, 0);\n      vec2 cov3D_M11_M12 = unpackInt16(covAndColorData.x) * centerAndScaleData.w;\n      vec2 cov3D_M13_M22 = unpackInt16(covAndColorData.y) * centerAndScaleData.w;\n      vec2 cov3D_M23_M33 = unpackInt16(covAndColorData.z) * centerAndScaleData.w;\n      mat3 Vrk = mat3(\n        cov3D_M11_M12.x, cov3D_M11_M12.y, cov3D_M13_M22.x,\n        cov3D_M11_M12.y, cov3D_M13_M22.y, cov3D_M23_M33.x,\n        cov3D_M13_M22.x, cov3D_M23_M33.x, cov3D_M23_M33.y\n      );\n\n      mat3 J = mat3(\n        focal / camspace.z, 0., -(focal * camspace.x) / (camspace.z * camspace.z),\n        0., focal / camspace.z, -(focal * camspace.y) / (camspace.z * camspace.z),\n        0., 0., 0.\n      );\n\n      mat3 W = transpose(mat3(modelViewMatrix));\n      mat3 T = W * J;\n      mat3 cov = transpose(T) * Vrk * T;\n      vec2 vCenter = vec2(pos2d) / pos2d.w;\n      float diagonal1 = cov[0][0] + 0.3;\n      float offDiagonal = cov[0][1];\n      float diagonal2 = cov[1][1] + 0.3;\n      float mid = 0.5 * (diagonal1 + diagonal2);\n      float radius = length(vec2((diagonal1 - diagonal2) / 2.0, offDiagonal));\n      float lambda1 = mid + radius;\n      float lambda2 = max(mid - radius, 0.1);\n      vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));\n      vec2 v1 = min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector;\n      vec2 v2 = min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x);\n      uint colorUint = covAndColorData.w;\n      vColor = vec4(\n        float(colorUint & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(8)) & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(16)) & uint(0xFF)) / 255.0,\n        float(colorUint >> uint(24)) / 255.0\n      );\n      vPosition = position;\n\n      gl_Position = vec4(\n        vCenter \n          + position.x * v2 / viewport * 2.0 \n          + position.y * v1 / viewport * 2.0, pos2d.z / pos2d.w, 1.0);\n    }\n    ",`\n    #include <alphatest_pars_fragment>\n    #include <alphahash_pars_fragment>\n    in vec4 vColor;\n    in vec3 vPosition;\n    void main () {\n      float A = -dot(vPosition.xy, vPosition.xy);\n      if (A < -4.0) discard;\n      float B = exp(A) * vColor.a;\n      vec4 diffuseColor = vec4(vColor.rgb, B);\n      #include <alphatest_fragment>\n      #include <alphahash_fragment>\n      gl_FragColor = diffuseColor;\n      #include <tonemapping_fragment>\n      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n    }\n  `);function Je(e){let t=null,r=0;e.onmessage=n=>{if("push"==n.data.method){0===r&&(t=new Float32Array(n.data.length));const e=new Float32Array(n.data.matrices);t.set(e,r),r+=e.length}else if("sort"==n.data.method&&null!==t){const r=function(e,r=!1){const n=t.length/16;let a=-1/0,o=1/0;const i=new Float32Array(n),s=new Int32Array(i.buffer),l=new Int32Array(n);let c=0;for(let s=0;s<n;s++){const n=e[0]*t[16*s+12]+e[1]*t[16*s+13]+e[2]*t[16*s+14]+e[3];(r||n<0&&t[16*s+15]>-1e-4*n)&&(i[c]=n,l[c]=s,c++,n>a&&(a=n),n<o&&(o=n))}const u=65535/(a-o),d=new Uint32Array(65536);for(let e=0;e<c;e++)s[e]=(i[e]-o)*u|0,d[s[e]]++;const m=new Uint32Array(65536);for(let e=1;e<65536;e++)m[e]=m[e-1]+d[e-1];const f=new Uint32Array(c);for(let e=0;e<c;e++)f[m[s[e]]++]=l[e];return f}(new Float32Array(n.data.view),n.data.hashed);e.postMessage({indices:r,key:n.data.key},[r.buffer])}}}class et extends T.Loader{constructor(...e){super(...e),this.gl=null,this.chunkSize=25e3}load(e,t,r,n){const a={gl:this.gl,url:this.manager.resolveURL(e),worker:new Worker(URL.createObjectURL(new Blob(["(",Je.toString(),")(self)"],{type:"application/javascript"}))),manager:this.manager,update:(e,t,r)=>function(e,t,r,n){if(e.updateMatrixWorld(),t.gl.getCurrentViewport(r.viewport),r.material.viewport.x=r.viewport.z,r.material.viewport.y=r.viewport.w,r.material.focal=r.viewport.w/2*Math.abs(e.projectionMatrix.elements[5]),r.ready){if(n&&r.sorted)return;r.ready=!1;const e=new Float32Array([r.modelViewMatrix.elements[2],-r.modelViewMatrix.elements[6],r.modelViewMatrix.elements[10],r.modelViewMatrix.elements[14]]);t.worker.postMessage({method:"sort",src:t.url,key:r.uuid,view:e.buffer,hashed:n},[e.buffer]),n&&t.loaded&&(r.sorted=!0)}}(t,a,e,r),connect:e=>function(e,t){e.loading||async function(e){e.loading=!0;let t=0,r=0;const n=[];let a=0;const o=0!==e.totalDownloadBytes;for(;;)try{const{value:i,done:s}=await e.stream.read();if(s)break;if(t+=i.length,null!=e.totalDownloadBytes){const r=t/e.totalDownloadBytes*100;if(e.onProgress&&r-a>1){const n=new ProgressEvent("progress",{lengthComputable:o,loaded:t,total:e.totalDownloadBytes});e.onProgress(n),a=r}}n.push(i);const l=t-r;if(null!=e.totalDownloadBytes&&l>e.rowLength*e.chunkSize){let t=Math.floor(l/e.rowLength);const a=new Uint8Array(l);let i=0;for(const e of n)a.set(e,i),i+=e.length;if(n.length=0,l>t*e.rowLength){const r=new Uint8Array(l-t*e.rowLength);r.set(a.subarray(l-r.length,l),0),n.push(r)}const s=new Uint8Array(t*e.rowLength);s.set(a.subarray(0,s.byteLength),0);const c=tt(e,s.buffer,t);if(e.worker.postMessage({method:"push",src:e.url,length:16*e.numVertices,matrices:c.buffer},[c.buffer]),r+=t*e.rowLength,e.onProgress){const t=new ProgressEvent("progress",{lengthComputable:o,loaded:e.totalDownloadBytes,total:e.totalDownloadBytes});e.onProgress(t)}}}catch(e){console.error(e);break}if(t-r>0){let t=new Uint8Array(n.reduce(((e,t)=>e+t.length),0)),r=0;for(const e of n)t.set(e,r),r+=e.length;let a=Math.floor(t.byteLength/e.rowLength);const o=tt(e,t.buffer,a);e.worker.postMessage({method:"push",src:e.url,length:16*a,matrices:o.buffer},[o.buffer])}e.loaded=!0,e.manager.itemEnd(e.url)}(e);t.ready=!1,t.pm=new T.Matrix4,t.vm1=new T.Matrix4,t.vm2=new T.Matrix4,t.viewport=new T.Vector4;let r=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight);const n=new T.InstancedBufferAttribute(r,1,!1);n.setUsage(T.DynamicDrawUsage);const a=t.geometry=new T.InstancedBufferGeometry,o=new Float32Array(18),i=new T.BufferAttribute(o,3);function s(e){if(t&&e.data.key===t.uuid){let r=new Uint32Array(e.data.indices);a.attributes.splatIndex.set(r),a.attributes.splatIndex.needsUpdate=!0,a.instanceCount=r.length,t.ready=!0}}async function l(){for(;;){const t=e.gl.properties.get(e.centerAndScaleTexture),r=e.gl.properties.get(e.covAndColorTexture);if(null!=t&&t.__webglTexture&&null!=r&&r.__webglTexture&&e.loadedVertexCount>0)break;await new Promise((e=>setTimeout(e,10)))}t.ready=!0}return a.setAttribute("position",i),i.setXYZ(2,-2,2,0),i.setXYZ(1,2,2,0),i.setXYZ(0,-2,-2,0),i.setXYZ(5,-2,-2,0),i.setXYZ(4,2,2,0),i.setXYZ(3,2,-2,0),i.needsUpdate=!0,a.setAttribute("splatIndex",n),a.instanceCount=1,e.worker.addEventListener("message",s),l(),()=>e.worker.removeEventListener("message",s)}(a,e),loading:!1,loaded:!1,loadedVertexCount:0,chunkSize:this.chunkSize,totalDownloadBytes:0,numVertices:0,rowLength:32,maxVertexes:0,bufferTextureWidth:0,bufferTextureHeight:0,stream:null,centerAndScaleData:null,covAndColorData:null,covAndColorTexture:null,centerAndScaleTexture:null,onProgress:r};(async function(e){e.manager.itemStart(e.url);const t=await fetch(e.url);if(null===t.body)throw"Failed to fetch file";let r=t.headers.get("Content-Length");const n=r?parseInt(r):void 0;if(null==n)throw"Failed to get content length";e.stream=t.body.getReader(),e.totalDownloadBytes=n,e.numVertices=Math.floor(e.totalDownloadBytes/e.rowLength);const a=e.gl.getContext();let o=a.getParameter(a.MAX_TEXTURE_SIZE);e.maxVertexes=o*o,e.numVertices>e.maxVertexes&&(e.numVertices=e.maxVertexes);return e.bufferTextureWidth=o,e.bufferTextureHeight=Math.floor((e.numVertices-1)/o)+1,e.centerAndScaleData=new Float32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.covAndColorData=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.centerAndScaleTexture=new T.DataTexture(e.centerAndScaleData,e.bufferTextureWidth,e.bufferTextureHeight,T.RGBAFormat,T.FloatType),e.centerAndScaleTexture.needsUpdate=!0,e.covAndColorTexture=new T.DataTexture(e.covAndColorData,e.bufferTextureWidth,e.bufferTextureHeight,T.RGBAIntegerFormat,T.UnsignedIntType),e.covAndColorTexture.internalFormat="RGBA32UI",e.covAndColorTexture.needsUpdate=!0,e})(a).then(t).catch((e=>{null==n||n(e),a.manager.itemError(a.url)}))}}function tt(e,t,r){const n=e.gl.getContext();if(e.loadedVertexCount+r>e.maxVertexes&&(r=e.maxVertexes-e.loadedVertexCount),r<=0)throw"Failed to parse file";const a=new Uint8Array(t),o=new Float32Array(t),i=new Float32Array(16*r),s=new Uint8Array(e.covAndColorData.buffer),l=new Int16Array(e.covAndColorData.buffer);for(let t=0;t<r;t++){const r=new T.Quaternion(-(a[32*t+28+1]-128)/128,(a[32*t+28+2]-128)/128,(a[32*t+28+3]-128)/128,-(a[32*t+28+0]-128)/128);r.invert();const n=new T.Vector3(o[8*t+0],o[8*t+1],-o[8*t+2]),c=new T.Vector3(o[8*t+3+0],o[8*t+3+1],o[8*t+3+2]),u=new T.Matrix4;u.makeRotationFromQuaternion(r),u.transpose(),u.scale(c);const d=u.clone();u.transpose(),u.premultiply(d),u.setPosition(n);const m=[0,1,2,5,6,10];let f=0;for(let e=0;e<m.length;e++)Math.abs(u.elements[m[e]])>f&&(f=Math.abs(u.elements[m[e]]));let p=4*e.loadedVertexCount+4*t;e.centerAndScaleData[p+0]=n.x,e.centerAndScaleData[p+1]=-n.y,e.centerAndScaleData[p+2]=n.z,e.centerAndScaleData[p+3]=f/32767,p=8*e.loadedVertexCount+4*t*2;for(let e=0;e<m.length;e++)l[p+e]=32767*u.elements[m[e]]/f;p=16*e.loadedVertexCount+4*(4*t+3);const h=new T.Color(a[32*t+24+0]/255,a[32*t+24+1]/255,a[32*t+24+2]/255);h.convertSRGBToLinear(),s[p+0]=255*h.r,s[p+1]=255*h.g,s[p+2]=255*h.b,s[p+3]=a[32*t+24+3],u.elements[15]=Math.max(c.x,c.y,c.z)*a[32*t+24+3]/255;for(let e=0;e<16;e++)i[16*t+e]=u.elements[e]}for(;r>0;){let t=0,a=0;const o=e.loadedVertexCount%e.bufferTextureWidth,i=Math.floor(e.loadedVertexCount/e.bufferTextureWidth);e.loadedVertexCount%e.bufferTextureWidth!=0?(t=Math.min(e.bufferTextureWidth,o+r)-o,a=1):Math.floor(r/e.bufferTextureWidth)>0?(t=e.bufferTextureWidth,a=Math.floor(r/e.bufferTextureWidth)):(t=r%e.bufferTextureWidth,a=1);const s=e.gl.properties.get(e.centerAndScaleTexture);n.bindTexture(n.TEXTURE_2D,s.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,o,i,t,a,n.RGBA,n.FLOAT,e.centerAndScaleData,4*e.loadedVertexCount);const l=e.gl.properties.get(e.covAndColorTexture);n.bindTexture(n.TEXTURE_2D,l.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,o,i,t,a,n.RGBA_INTEGER,n.UNSIGNED_INT,e.covAndColorData,4*e.loadedVertexCount),e.gl.resetState(),e.loadedVertexCount+=t*a,r-=t*a}return i}function rt(e,t,r){const n=a.useThree((e=>e.size)),o=a.useThree((e=>e.viewport)),i="number"==typeof e?e:n.width*o.dpr,s="number"==typeof t?t:n.height*o.dpr,l=("number"==typeof e?r:e)||{},{samples:c=0,depth:u,...d}=l,m=null!=u?u:l.depthBuffer,f=S.useMemo((()=>{const e=new T.WebGLRenderTarget(i,s,{minFilter:T.LinearFilter,magFilter:T.LinearFilter,type:T.HalfFloatType,...d});return m&&(e.depthTexture=new T.DepthTexture(i,s,T.FloatType)),e.samples=c,e}),[]);return S.useLayoutEffect((()=>{f.setSize(i,s),c&&(f.samples=c)}),[c,f,i,s]),S.useEffect((()=>()=>f.dispose()),[]),f}const nt=t.forwardRef((({children:e,width:r,height:n,...a},o)=>{const i=rt(r,n,a);return t.useImperativeHandle(o,(()=>i),[i]),S.createElement(S.Fragment,null,null==e?void 0:e(i))})),at=S.forwardRef((({envMap:e,resolution:t=256,frames:r=1/0,children:n,makeDefault:o,...i},s)=>{const l=a.useThree((({set:e})=>e)),c=a.useThree((({camera:e})=>e)),u=a.useThree((({size:e})=>e)),d=S.useRef(null);S.useImperativeHandle(s,(()=>d.current),[]);const m=S.useRef(null),f=rt(t);S.useLayoutEffect((()=>{i.manual||d.current.updateProjectionMatrix()}),[u,i]),S.useLayoutEffect((()=>{d.current.updateProjectionMatrix()})),S.useLayoutEffect((()=>{if(o){const e=c;return l((()=>({camera:d.current}))),()=>l((()=>({camera:e})))}}),[d,o,l]);let p=0,h=null;const x="function"==typeof n;return a.useFrame((t=>{x&&(r===1/0||p<r)&&(m.current.visible=!1,t.gl.setRenderTarget(f),h=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,d.current),t.scene.background=h,t.gl.setRenderTarget(null),m.current.visible=!0,p++)})),S.createElement(S.Fragment,null,S.createElement("orthographicCamera",M.default({left:u.width/-2,right:u.width/2,top:u.height/2,bottom:u.height/-2,ref:d},i),!x&&n),S.createElement("group",{ref:m},x&&n(f.texture)))})),ot=S.forwardRef((({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:n,children:o,...i},s)=>{const l=a.useThree((({set:e})=>e)),c=a.useThree((({camera:e})=>e)),u=a.useThree((({size:e})=>e)),d=S.useRef(null);S.useImperativeHandle(s,(()=>d.current),[]);const m=S.useRef(null),f=rt(t);S.useLayoutEffect((()=>{i.manual||(d.current.aspect=u.width/u.height)}),[u,i]),S.useLayoutEffect((()=>{d.current.updateProjectionMatrix()}));let p=0,h=null;const x="function"==typeof o;return a.useFrame((t=>{x&&(r===1/0||p<r)&&(m.current.visible=!1,t.gl.setRenderTarget(f),h=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,d.current),t.scene.background=h,t.gl.setRenderTarget(null),m.current.visible=!0,p++)})),S.useLayoutEffect((()=>{if(n){const e=c;return l((()=>({camera:d.current}))),()=>l((()=>({camera:e})))}}),[d,n,l]),S.createElement(S.Fragment,null,S.createElement("perspectiveCamera",M.default({ref:d},i),!x&&o),S.createElement("group",{ref:m},x&&o(f.texture)))}));function it({resolution:e=256,near:r=.1,far:o=1e3,envMap:i,fog:s}={}){const l=a.useThree((({gl:e})=>e)),c=a.useThree((({scene:e})=>e)),u=t.useMemo((()=>{const t=new n.WebGLCubeRenderTarget(e);return t.texture.type=n.HalfFloatType,t}),[e]);t.useEffect((()=>()=>{u.dispose()}),[u]);const d=t.useMemo((()=>new T.CubeCamera(r,o,u)),[r,o,u]);let m,f;const p=S.useCallback((()=>{m=c.fog,f=c.background,c.background=i||f,c.fog=s||m,d.update(l,c),c.fog=m,c.background=f}),[l,c,d]);return{fbo:u,camera:d,update:p}}const st=S.forwardRef(((e,t)=>{const{camera:r,onChange:n,makeDefault:o,...i}=e,s=a.useThree((e=>e.camera)),l=a.useThree((e=>e.invalidate)),u=a.useThree((e=>e.get)),d=a.useThree((e=>e.set)),m=r||s,f=S.useMemo((()=>new c.DeviceOrientationControls(m)),[m]);return S.useEffect((()=>{const e=e=>{l(),n&&n(e)};return null==f||null==f.addEventListener||f.addEventListener("change",e),()=>null==f||null==f.removeEventListener?void 0:f.removeEventListener("change",e)}),[n,f,l]),a.useFrame((()=>null==f?void 0:f.update()),-1),S.useEffect((()=>{const e=f;return null==e||e.connect(),()=>null==e?void 0:e.dispose()}),[f]),S.useEffect((()=>{if(o){const e=u().controls;return d({controls:f}),()=>d({controls:e})}}),[o,f]),f?S.createElement("primitive",M.default({ref:t,object:f},i)):null})),lt=S.forwardRef((({domElement:e,...t},r)=>{const{onChange:n,makeDefault:o,...i}=t,s=a.useThree((e=>e.invalidate)),l=a.useThree((e=>e.camera)),u=a.useThree((e=>e.gl)),d=a.useThree((e=>e.events)),m=a.useThree((e=>e.get)),f=a.useThree((e=>e.set)),p=e||d.connected||u.domElement,h=S.useMemo((()=>new c.FlyControls(l)),[l]);return S.useEffect((()=>(h.connect(p),()=>{h.dispose()})),[p,h,s]),S.useEffect((()=>{const e=e=>{s(),n&&n(e)};return null==h.addEventListener||h.addEventListener("change",e),()=>null==h.removeEventListener?void 0:h.removeEventListener("change",e)}),[n,s]),S.useEffect((()=>{if(o){const e=m().controls;return f({controls:h}),()=>f({controls:e})}}),[o,h]),a.useFrame(((e,t)=>h.update(t))),S.createElement("primitive",M.default({ref:r,object:h,args:[l,p]},i))})),ct=S.forwardRef(((e={enableDamping:!0},t)=>{const{domElement:r,camera:n,makeDefault:o,onChange:i,onStart:s,onEnd:l,...u}=e,d=a.useThree((e=>e.invalidate)),m=a.useThree((e=>e.camera)),f=a.useThree((e=>e.gl)),p=a.useThree((e=>e.events)),h=a.useThree((e=>e.set)),x=a.useThree((e=>e.get)),y=r||p.connected||f.domElement,v=n||m,g=S.useMemo((()=>new c.MapControls(v)),[v]);return S.useEffect((()=>{g.connect(y);const e=e=>{d(),i&&i(e)};return g.addEventListener("change",e),s&&g.addEventListener("start",s),l&&g.addEventListener("end",l),()=>{g.dispose(),g.removeEventListener("change",e),s&&g.removeEventListener("start",s),l&&g.removeEventListener("end",l)}}),[i,s,l,g,d,y]),S.useEffect((()=>{if(o){const e=x().controls;return h({controls:g}),()=>h({controls:e})}}),[o,g]),a.useFrame((()=>g.update()),-1),S.createElement("primitive",M.default({ref:t,object:g,enableDamping:!0},u))})),ut=S.forwardRef((({makeDefault:e,camera:t,regress:r,domElement:n,enableDamping:o=!0,keyEvents:i=!1,onChange:s,onStart:l,onEnd:u,...d},m)=>{const f=a.useThree((e=>e.invalidate)),p=a.useThree((e=>e.camera)),h=a.useThree((e=>e.gl)),x=a.useThree((e=>e.events)),y=a.useThree((e=>e.setEvents)),v=a.useThree((e=>e.set)),g=a.useThree((e=>e.get)),w=a.useThree((e=>e.performance)),z=t||p,b=n||x.connected||h.domElement,E=S.useMemo((()=>new c.OrbitControls(z)),[z]);return a.useFrame((()=>{E.enabled&&E.update()}),-1),S.useEffect((()=>(i&&E.connect(!0===i?b:i),E.connect(b),()=>{E.dispose()})),[i,b,r,E,f]),S.useEffect((()=>{const e=e=>{f(),r&&w.regress(),s&&s(e)},t=e=>{l&&l(e)},n=e=>{u&&u(e)};return E.addEventListener("change",e),E.addEventListener("start",t),E.addEventListener("end",n),()=>{E.removeEventListener("start",t),E.removeEventListener("end",n),E.removeEventListener("change",e)}}),[s,l,u,E,f,y]),S.useEffect((()=>{if(e){const e=g().controls;return v({controls:E}),()=>v({controls:e})}}),[e,E]),S.createElement("primitive",M.default({ref:m,object:E,enableDamping:o},d))})),dt=S.forwardRef((({makeDefault:e,camera:t,domElement:r,regress:n,onChange:o,onStart:i,onEnd:s,...l},u)=>{const{invalidate:d,camera:m,gl:f,events:p,set:h,get:x,performance:y,viewport:v}=a.useThree(),g=t||m,w=r||p.connected||f.domElement,z=S.useMemo((()=>new c.TrackballControls(g)),[g]);return a.useFrame((()=>{z.enabled&&z.update()}),-1),S.useEffect((()=>(z.connect(w),()=>{z.dispose()})),[w,n,z,d]),S.useEffect((()=>{const e=e=>{d(),n&&y.regress(),o&&o(e)};return z.addEventListener("change",e),i&&z.addEventListener("start",i),s&&z.addEventListener("end",s),()=>{i&&z.removeEventListener("start",i),s&&z.removeEventListener("end",s),z.removeEventListener("change",e)}}),[o,i,s,z,d]),S.useEffect((()=>{z.handleResize()}),[v]),S.useEffect((()=>{if(e){const e=x().controls;return h({controls:z}),()=>h({controls:e})}}),[e,z]),S.createElement("primitive",M.default({ref:u,object:z},l))})),mt=t.forwardRef((({camera:e,makeDefault:r,regress:n,domElement:o,onChange:i,onStart:s,onEnd:l,...u},d)=>{const m=a.useThree((e=>e.invalidate)),f=a.useThree((e=>e.camera)),p=a.useThree((e=>e.gl)),h=a.useThree((e=>e.events)),x=a.useThree((e=>e.set)),y=a.useThree((e=>e.get)),v=a.useThree((e=>e.performance)),g=e||f,w=o||h.connected||p.domElement,z=t.useMemo((()=>new c.ArcballControls(g)),[g]);return a.useFrame((()=>{z.enabled&&z.update()}),-1),t.useEffect((()=>(z.connect(w),()=>{z.dispose()})),[w,n,z,m]),t.useEffect((()=>{const e=e=>{m(),n&&v.regress(),i&&i(e)};return z.addEventListener("change",e),s&&z.addEventListener("start",s),l&&z.addEventListener("end",l),()=>{z.removeEventListener("change",e),s&&z.removeEventListener("start",s),l&&z.removeEventListener("end",l)}}),[i,s,l]),t.useEffect((()=>{if(r){const e=y().controls;return x({controls:z}),()=>x({controls:e})}}),[r,z]),S.createElement("primitive",M.default({ref:d,object:z},u))})),ft=S.forwardRef((({children:e,domElement:t,onChange:r,onMouseDown:n,onMouseUp:o,onObjectChange:i,object:s,makeDefault:l,camera:u,enabled:d,axis:m,mode:f,translationSnap:p,rotationSnap:h,scaleSnap:x,space:y,size:v,showX:g,showY:w,showZ:z,...b},E)=>{const C=a.useThree((e=>e.controls)),P=a.useThree((e=>e.gl)),R=a.useThree((e=>e.events)),D=a.useThree((e=>e.camera)),F=a.useThree((e=>e.invalidate)),k=a.useThree((e=>e.get)),_=a.useThree((e=>e.set)),A=u||D,L=t||R.connected||P.domElement,I=S.useMemo((()=>new c.TransformControls(A,L)),[A,L]),B=S.useRef(null);S.useLayoutEffect((()=>(s?I.attach(s instanceof T.Object3D?s:s.current):B.current instanceof T.Object3D&&I.attach(B.current),()=>{I.detach()})),[s,e,I]),S.useEffect((()=>{if(C){const e=e=>C.enabled=!e.value;return I.addEventListener("dragging-changed",e),()=>I.removeEventListener("dragging-changed",e)}}),[I,C]);const U=S.useRef(void 0),V=S.useRef(void 0),O=S.useRef(void 0),N=S.useRef(void 0);return S.useLayoutEffect((()=>{U.current=r}),[r]),S.useLayoutEffect((()=>{V.current=n}),[n]),S.useLayoutEffect((()=>{O.current=o}),[o]),S.useLayoutEffect((()=>{N.current=i}),[i]),S.useEffect((()=>{const e=e=>{F(),null==U.current||U.current(e)},t=e=>null==V.current?void 0:V.current(e),r=e=>null==O.current?void 0:O.current(e),n=e=>null==N.current?void 0:N.current(e);return I.addEventListener("change",e),I.addEventListener("mouseDown",t),I.addEventListener("mouseUp",r),I.addEventListener("objectChange",n),()=>{I.removeEventListener("change",e),I.removeEventListener("mouseDown",t),I.removeEventListener("mouseUp",r),I.removeEventListener("objectChange",n)}}),[F,I]),S.useEffect((()=>{if(l){const e=k().controls;return _({controls:I}),()=>_({controls:e})}}),[l,I]),S.createElement(S.Fragment,null,S.createElement("primitive",{ref:E,object:I,enabled:d,axis:m,mode:f,translationSnap:p,rotationSnap:h,scaleSnap:x,space:y,size:v,showX:g,showY:w,showZ:z}),S.createElement("group",M.default({ref:B},b),e))})),pt=S.forwardRef((({domElement:e,selector:t,onChange:r,onLock:n,onUnlock:o,enabled:i=!0,makeDefault:s,...l},u)=>{const{camera:d,...m}=l,f=a.useThree((e=>e.setEvents)),p=a.useThree((e=>e.gl)),h=a.useThree((e=>e.camera)),x=a.useThree((e=>e.invalidate)),y=a.useThree((e=>e.events)),v=a.useThree((e=>e.get)),g=a.useThree((e=>e.set)),w=d||h,z=e||y.connected||p.domElement,b=S.useMemo((()=>new c.PointerLockControls(w)),[w]);return S.useEffect((()=>{if(i){b.connect(z);const e=v().events.compute;return f({compute(e,t){const r=t.size.width/2,n=t.size.height/2;t.pointer.set(r/t.size.width*2-1,-n/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{b.disconnect(),f({compute:e})}}}),[i,b]),S.useEffect((()=>{const e=e=>{x(),r&&r(e)};b.addEventListener("change",e),n&&b.addEventListener("lock",n),o&&b.addEventListener("unlock",o);const a=()=>b.lock(),i=t?Array.from(document.querySelectorAll(t)):[document];return i.forEach((e=>e&&e.addEventListener("click",a))),()=>{b.removeEventListener("change",e),n&&b.removeEventListener("lock",n),o&&b.removeEventListener("unlock",o),i.forEach((e=>e?e.removeEventListener("click",a):void 0))}}),[r,n,o,t,b,x]),S.useEffect((()=>{if(s){const e=v().controls;return g({controls:b}),()=>g({controls:e})}}),[s,b]),S.createElement("primitive",M.default({ref:u,object:b},m))})),ht=S.forwardRef((({domElement:e,makeDefault:t,...r},n)=>{const o=a.useThree((e=>e.camera)),i=a.useThree((e=>e.gl)),s=a.useThree((e=>e.events)),l=a.useThree((e=>e.get)),u=a.useThree((e=>e.set)),d=e||s.connected||i.domElement,[m]=S.useState((()=>new c.FirstPersonControls(o,d)));return S.useEffect((()=>{if(t){const e=l().controls;return u({controls:m}),()=>u({controls:e})}}),[t,m]),a.useFrame(((e,t)=>{m.update(t)}),-1),m?S.createElement("primitive",M.default({ref:n,object:m},r)):null})),xt=t.forwardRef(((e,r)=>{const{impl:o,camera:i,domElement:s,makeDefault:l,onControlStart:c,onControl:u,onControlEnd:d,onTransitionStart:m,onUpdate:f,onWake:p,onRest:h,onSleep:x,onStart:y,onEnd:v,onChange:g,regress:w,...z}=e,b=null!=o?o:P.default;t.useMemo((()=>{const e={Box3:n.Box3,MathUtils:{clamp:n.MathUtils.clamp},Matrix4:n.Matrix4,Quaternion:n.Quaternion,Raycaster:n.Raycaster,Sphere:n.Sphere,Spherical:n.Spherical,Vector2:n.Vector2,Vector3:n.Vector3,Vector4:n.Vector4};b.install({THREE:e}),a.extend({CameraControlsImpl:b})}),[b]);const E=a.useThree((e=>e.camera)),C=a.useThree((e=>e.gl)),T=a.useThree((e=>e.invalidate)),R=a.useThree((e=>e.events)),D=a.useThree((e=>e.setEvents)),F=a.useThree((e=>e.set)),k=a.useThree((e=>e.get)),_=a.useThree((e=>e.performance)),A=i||E,L=s||R.connected||C.domElement,I=t.useMemo((()=>new b(A)),[b,A]);return a.useFrame(((e,t)=>{I.update(t)}),-1),t.useEffect((()=>(I.connect(L),()=>{I.disconnect()})),[L,I]),t.useEffect((()=>{function e(){T(),w&&_.regress()}const t=t=>{e(),null==c||c(t),null==y||y(t)},r=t=>{e(),null==u||u(t),null==g||g(t)},n=e=>{null==d||d(e),null==v||v(e)},a=t=>{e(),null==m||m(t),null==g||g(t)},o=t=>{e(),null==f||f(t),null==g||g(t)},i=t=>{e(),null==p||p(t),null==g||g(t)},s=e=>{null==h||h(e)},l=e=>{null==x||x(e)};return I.addEventListener("controlstart",t),I.addEventListener("control",r),I.addEventListener("controlend",n),I.addEventListener("transitionstart",a),I.addEventListener("update",o),I.addEventListener("wake",i),I.addEventListener("rest",s),I.addEventListener("sleep",l),()=>{I.removeEventListener("controlstart",t),I.removeEventListener("control",r),I.removeEventListener("controlend",n),I.removeEventListener("transitionstart",a),I.removeEventListener("update",o),I.removeEventListener("wake",i),I.removeEventListener("rest",s),I.removeEventListener("sleep",l)}}),[I,T,D,w,_,c,u,d,m,f,p,h,x,g,y,v]),t.useEffect((()=>{if(l){const e=k().controls;return F({controls:I}),()=>F({controls:e})}}),[l,I]),S.createElement("primitive",M.default({ref:r,object:I},z))})),yt=S.createContext(null);function vt(){const e=S.useContext(yt);if(!e)throw new Error("useMotion hook must be used in a MotionPathControls component.");return e}function gt({points:e=50,color:t="black"}){const{path:r}=vt(),[n,a]=S.useState([]),o=S.useMemo((()=>new T.MeshBasicMaterial({color:t})),[t]),i=S.useMemo((()=>new T.SphereGeometry(.025,16,16)),[]),s=S.useRef([]);return S.useEffect((()=>{r.curves!==s.current&&(a(r.getPoints(e)),s.current=r.curves)})),n.map(((e,t)=>S.createElement("mesh",{key:t,material:o,geometry:i,position:[e.x,e.y,e.z]})))}const wt=S.forwardRef((({children:e,curves:t=[],debug:r=!1,debugColor:n="black",object:o,focus:i,loop:l=!0,offset:c,smooth:u=!1,eps:d=1e-5,damping:m=.1,focusDamping:f=.1,maxSpeed:p=1/0,...h},x)=>{const{camera:y}=a.useThree(),v=S.useRef(null),g=S.useRef(null!=c?c:0),w=S.useMemo((()=>new T.CurvePath),[]),z=S.useMemo((()=>({focus:i,object:(null==o?void 0:o.current)instanceof T.Object3D?o:{current:y},path:w,current:g.current,offset:g.current,point:new T.Vector3,tangent:new T.Vector3,next:new T.Vector3})),[i,o]),b=a.useInstanceHandle(v);S.useLayoutEffect((()=>{const e=b.current;w.curves=[];const r=t.length>0?t:e.children.map((e=>e.object));for(let e=0;e<r.length;e++)w.add(r[e]);if(u){const e=w.getPoints("number"==typeof u?u:1),t=new T.CatmullRomCurve3(e);w.curves=[t]}w.updateArcLengths()})),S.useImperativeHandle(x,(()=>Object.assign(v.current,{motion:z})),[z]),S.useLayoutEffect((()=>{g.current=s.misc.repeat(g.current,1)}),[c]);const E=S.useMemo((()=>new T.Vector3),[]);return a.useFrame(((e,t)=>{const r=z.offset;if(s.easing.damp(g,"current",void 0!==c?c:z.current,m,t,p,void 0,d),z.offset=l?s.misc.repeat(g.current,1):s.misc.clamp(g.current,0,1),w.getCurveLengths().length>0){w.getPointAt(z.offset,z.point),w.getTangentAt(z.offset,z.tangent).normalize(),w.getPointAt(s.misc.repeat(g.current-(r-z.offset),1),z.next);const e=(null==o?void 0:o.current)instanceof T.Object3D?o.current:y;e.position.copy(z.point),i&&s.easing.dampLookAt(e,(e=>(null==e?void 0:e.current)instanceof T.Object3D)(i)?i.current.getWorldPosition(E):i,f,t,p,void 0,d)}})),S.createElement("group",M.default({ref:v},h),S.createElement(yt.Provider,{value:z},e,r&&S.createElement(gt,{color:n})))}));function zt({defaultScene:e,defaultCamera:t,renderPriority:r=1}){const{gl:n,scene:o,camera:i}=a.useThree();let s;return a.useFrame((()=>{s=n.autoClear,1===r&&(n.autoClear=!0,n.render(e,t)),n.autoClear=!1,n.clearDepth(),n.render(o,i),n.autoClear=s}),r),S.createElement("group",{onPointerOver:()=>null})}function bt({children:e,renderPriority:t=1}){const{scene:r,camera:n}=a.useThree(),[o]=S.useState((()=>new T.Scene));return S.createElement(S.Fragment,null,a.createPortal(S.createElement(S.Fragment,null,e,S.createElement(zt,{defaultScene:r,defaultCamera:n,renderPriority:t})),o,{events:{priority:t+1}}))}const Et=S.createContext({}),Mt=()=>S.useContext(Et),St=2*Math.PI,Ct=new n.Object3D,Tt=new n.Matrix4,[Pt,Rt]=[new n.Quaternion,new n.Quaternion],Dt=new n.Vector3,Ft=new n.Vector3,kt=e=>"getTarget"in e,_t="#f0f0f0",At="#999",Lt="black",It="black",Bt=["Right","Left","Top","Bottom","Front","Back"],Ut=e=>new n.Vector3(...e).multiplyScalar(.38),Vt=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(Ut),Ot=[.25,.25,.25],Nt=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(Ut),jt=Nt.map((e=>e.toArray().map((e=>0==e?.5:.25)))),Wt=({hover:e,index:t,font:r="20px Inter var, Arial, sans-serif",faces:o=Bt,color:i=_t,hoverColor:s=At,textColor:l=Lt,strokeColor:c=It,opacity:u=1})=>{const d=a.useThree((e=>e.gl)),m=S.useMemo((()=>{const e=document.createElement("canvas");e.width=128,e.height=128;const a=e.getContext("2d");return a.fillStyle=i,a.fillRect(0,0,e.width,e.height),a.strokeStyle=c,a.strokeRect(0,0,e.width,e.height),a.font=r,a.textAlign="center",a.fillStyle=l,a.fillText(o[t].toUpperCase(),64,76),new n.CanvasTexture(e)}),[t,o,r,i,l,c]);return S.createElement("meshBasicMaterial",{map:m,"map-anisotropy":d.capabilities.getMaxAnisotropy()||1,attach:`material-${t}`,color:e?s:"white",transparent:!0,opacity:u})},Gt=e=>{const{tweenCamera:t}=Mt(),[r,n]=S.useState(null);return S.createElement("mesh",{onPointerOut:e=>{e.stopPropagation(),n(null)},onPointerMove:e=>{e.stopPropagation(),n(Math.floor(e.faceIndex/2))},onClick:e.onClick||(e=>{e.stopPropagation(),t(e.face.normal)})},[...Array(6)].map(((t,n)=>S.createElement(Wt,M.default({key:n,index:n,hover:r===n},e)))),S.createElement("boxGeometry",null))},Ht=({onClick:e,dimensions:t,position:r,hoverColor:n=At})=>{const{tweenCamera:a}=Mt(),[o,i]=S.useState(!1);return S.createElement("mesh",{scale:1.01,position:r,onPointerOver:e=>{e.stopPropagation(),i(!0)},onPointerOut:e=>{e.stopPropagation(),i(!1)},onClick:e||(e=>{e.stopPropagation(),a(r)})},S.createElement("meshBasicMaterial",{color:o?n:"white",transparent:!0,opacity:.6,visible:o}),S.createElement("boxGeometry",{args:t}))};function $t({scale:e=[.8,.05,.05],color:t,rotation:r}){return S.createElement("group",{rotation:r},S.createElement("mesh",{position:[.4,0,0]},S.createElement("boxGeometry",{args:e}),S.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function qt({onClick:e,font:t,disabled:r,arcStyle:o,label:i,labelColor:s,axisHeadScale:l=1,...c}){const u=a.useThree((e=>e.gl)),d=S.useMemo((()=>{const e=document.createElement("canvas");e.width=64,e.height=64;const r=e.getContext("2d");return r.beginPath(),r.arc(32,32,16,0,2*Math.PI),r.closePath(),r.fillStyle=o,r.fill(),i&&(r.font=t,r.textAlign="center",r.fillStyle=s,r.fillText(i,32,41)),new n.CanvasTexture(e)}),[o,i,s,t]),[m,f]=S.useState(!1),p=(i?1:.75)*(m?1.2:1)*l;return S.createElement("sprite",M.default({scale:p,onPointerOver:r?void 0:e=>{e.stopPropagation(),f(!0)},onPointerOut:r?void 0:e||(e=>{e.stopPropagation(),f(!1)})},c),S.createElement("spriteMaterial",{map:d,"map-anisotropy":u.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:i?1:.75,toneMapped:!1}))}const Xt=Ee({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new T.Color,sectionColor:new T.Color,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new T.Vector3,worldPlanePosition:new T.Vector3},"\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform vec3 worldPlanePosition;\n    uniform float fadeDistance;\n    uniform bool infiniteGrid;\n    uniform bool followCamera;\n\n    void main() {\n      localPosition = position.xzy;\n      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;\n      \n      worldPosition = modelMatrix * vec4(localPosition, 1.0);\n      if (followCamera) {\n        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);\n        localPosition = (inverse(modelMatrix) * worldPosition).xyz;\n      }\n\n      gl_Position = projectionMatrix * viewMatrix * worldPosition;\n    }\n  ",`\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform float cellSize;\n    uniform float sectionSize;\n    uniform vec3 cellColor;\n    uniform vec3 sectionColor;\n    uniform float fadeDistance;\n    uniform float fadeStrength;\n    uniform float fadeFrom;\n    uniform float cellThickness;\n    uniform float sectionThickness;\n\n    float getGrid(float size, float thickness) {\n      vec2 r = localPosition.xz / size;\n      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n      float line = min(grid.x, grid.y) + 1.0 - thickness;\n      return 1.0 - min(line, 1.0);\n    }\n\n    void main() {\n      float g1 = getGrid(cellSize, cellThickness);\n      float g2 = getGrid(sectionSize, sectionThickness);\n\n      vec3 from = worldCamProjPosition*vec3(fadeFrom);\n      float dist = distance(from, worldPosition.xyz);\n      float d = 1.0 - min(dist / fadeDistance, 1.0);\n      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));\n\n      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));\n      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);\n      if (gl_FragColor.a <= 0.0) discard;\n\n      #include <tonemapping_fragment>\n      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n    }\n  `),Zt=S.forwardRef((({args:e,cellColor:t="#000000",sectionColor:r="#2080ff",cellSize:n=.5,sectionSize:o=1,followCamera:i=!1,infiniteGrid:s=!1,fadeDistance:l=100,fadeStrength:c=1,fadeFrom:u=1,cellThickness:d=.5,sectionThickness:m=1,side:f=T.BackSide,...p},h)=>{a.extend({GridMaterial:Xt});const x=S.useRef(null);S.useImperativeHandle(h,(()=>x.current),[]);const y=new T.Plane,v=new T.Vector3(0,1,0),g=new T.Vector3(0,0,0);a.useFrame((e=>{y.setFromNormalAndCoplanarPoint(v,g).applyMatrix4(x.current.matrixWorld);const t=x.current.material,r=t.uniforms.worldCamProjPosition,n=t.uniforms.worldPlanePosition;y.projectPoint(e.camera.position,r.value),n.value.set(0,0,0).applyMatrix4(x.current.matrixWorld)}));const w={cellSize:n,sectionSize:o,cellColor:t,sectionColor:r,cellThickness:d,sectionThickness:m},z={fadeDistance:l,fadeStrength:c,fadeFrom:u,infiniteGrid:s,followCamera:i};return S.createElement("mesh",M.default({ref:x,frustumCulled:!1},p),S.createElement("gridMaterial",M.default({transparent:!0,"extensions-derivatives":!0,side:f},w,z)),S.createElement("planeGeometry",{args:e}))}));function Yt(e,{path:t}){const[r]=a.useLoader(n.CubeTextureLoader,[e],(e=>e.setPath(t)));return r}function Qt(e){return a.useLoader(c.FBXLoader,e)}Yt.preload=(e,{path:t})=>a.useLoader.preload(n.CubeTextureLoader,[e],(e=>e.setPath(t))),Qt.preload=e=>a.useLoader.preload(c.FBXLoader,e),Qt.clear=e=>a.useLoader.clear(c.FBXLoader,e);const Kt="https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master";function Jt(e,r=`${Kt}/basis/`){const n=a.useThree((e=>e.gl)),o=a.useLoader(c.KTX2Loader,Me(e)?Object.values(e):e,(e=>{e.detectSupport(n),e.setTranscoderPath(r)}));if(t.useEffect((()=>{(Array.isArray(o)?o:[o]).forEach(n.initTexture)}),[n,o]),Me(e)){const t=Object.keys(e),r={};return t.forEach((e=>Object.assign(r,{[e]:o[t.indexOf(e)]}))),r}return o}Jt.preload=(e,t=`${Kt}/basis/`)=>a.useLoader.preload(c.KTX2Loader,e,(e=>{e.setTranscoderPath(t)})),Jt.clear=e=>a.useLoader.clear(c.KTX2Loader,e);const er=((e,t)=>"undefined"!=typeof window&&"function"==typeof(null==(e=window.document)?void 0:e.createElement)&&"string"==typeof(null==(t=window.navigator)?void 0:t.userAgent))();let tr=null;function rr(e,{unsuspend:r="loadedmetadata",start:n=!0,hls:o={},crossOrigin:i="anonymous",muted:s=!0,loop:l=!0,playsInline:c=!0,onVideoFrame:u,...d}={}){const f=a.useThree((e=>e.gl)),p=t.useRef(null),x=m.suspend((()=>new Promise((async t=>{let n,a;"string"==typeof e?n=e:a=e;const u=Object.assign(document.createElement("video"),{src:n,srcObject:a,crossOrigin:i,loop:l,muted:s,playsInline:c,...d});if(n&&er&&n.endsWith(".m3u8")){const e=p.current=await async function(...e){var t;null!==(t=tr)&&void 0!==t||(tr=await Promise.resolve().then((function(){return E(require("hls.js"))})));const r=tr.default;return r.isSupported()?new r(...e):null}(o);e&&(e.on(h.Events.MEDIA_ATTACHED,(()=>{e.loadSource(n)})),e.attachMedia(u))}const m=new T.VideoTexture(u);m.colorSpace=f.outputColorSpace,u.addEventListener(r,(()=>t(m)))}))),[e]),y=x.source.data;return ar(y,u),t.useEffect((()=>(n&&x.image.play(),()=>{p.current&&(p.current.destroy(),p.current=null)})),[x,n]),x}const nr=t.forwardRef((({children:e,src:r,...n},a)=>{const o=rr(r,n);return t.useEffect((()=>()=>{o.dispose()}),[o]),t.useImperativeHandle(a,(()=>o),[o]),S.createElement(S.Fragment,null,null==e?void 0:e(o))})),ar=(e,r)=>{t.useEffect((()=>{if(!r)return;if(!e.requestVideoFrameCallback)return;let t;const n=(...a)=>{r(...a),t=e.requestVideoFrameCallback(n)};return e.requestVideoFrameCallback(n),()=>e.cancelVideoFrameCallback(t)}),[e,r])},or=(e,t)=>{if(Array.isArray(e))return e[0];return e[null!=t?t:Object.keys(e)[0]][0]},ir=e=>{for(let t=3;t<e.length;t+=4)if(0!==e[t])return!1;return!0};function sr(e,r,o,i,s,l){const c=S.useRef(a.useThree((e=>e.viewport))),u=S.useRef(null),d=S.useRef(0),m=S.useRef(e),f=S.useRef(r),p=S.useRef(o),[h,x]=t.useState(null),[y,v]=S.useState(new T.Texture),g=S.useMemo((()=>new T.TextureLoader),[]),[w,z]=t.useState(null),b=S.useCallback(((e,t,r)=>{const n=t*(c.current.aspect>e/t?c.current.width/e:c.current.height/t),a=e*(c.current.aspect>e/t?c.current.width/e:c.current.height/t)*r,o=n*r;let i=Math.min(1,a),s=Math.min(1,o);return a>1&&(i=1,s=o/a*1),new T.Vector3(i,s,1)}),[]),E=S.useCallback(((e,t)=>{if(e.image){const r=document.createElement("canvas"),n=r.getContext("2d",l);if(!n)throw new Error("Failed to get 2d context");r.width=e.image.width,r.height=e.image.height,n.drawImage(e.image,0,0);const a=e.image.width,o=e.image.height,i=Math.round(Math.sqrt(t*(a/o))),s=Math.round(t/i),c=a/i,u=o/s,d=[];for(let e=0;e<s;e++)for(let r=0;r<i;r++){if(e*i+r>=t){d.push({row:e,col:r});continue}const a=n.getImageData(r*c,e*u,c,u).data;ir(a)&&d.push({row:e,col:r})}return{rows:s,columns:i,frameWidth:c,frameHeight:u,emptyFrames:d}}return{rows:0,columns:0,frameWidth:0,frameHeight:0,emptyFrames:[]}}),[l]),M=S.useCallback((e=>{const t=e=>{let t=null;for(const r of e){const{w:e,h:n}=r.frame,a=e*n;(!t||a>t.area)&&(t={w:e,h:n,area:a})}return e.map((e=>{const{w:r,h:n}=e.frame,a=r*n,o=t?a===t.area?1:Math.sqrt(a/t.area):1;return{...e,scaleRatio:o}}))};if(Array.isArray(e))return t(e);{const r={};for(const n in e)r[n]=t(e[n]);return r}}),[]),C=S.useCallback((()=>{const e={},t=u.current,r=p.current;if(t){if(r&&Array.isArray(t.frames)){for(let n=0;n<r.length;n++){e[r[n]]=[];for(const a of t.frames){const t=a.frame,o=a.sourceSize.w,i=a.sourceSize.h;"string"==typeof a.filename&&-1!==a.filename.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({...a,frame:t,sourceSize:{w:o,h:i}})}}for(const t in e){const r=M(e[t]);Array.isArray(r)&&(e[t]=r)}return e}if(r&&"object"==typeof t.frames){for(let n=0;n<r.length;n++){e[r[n]]=[];for(const a in t.frames){const o=t.frames[a],i=o.frame,s=o.sourceSize.w,l=o.sourceSize.h;"string"==typeof a&&-1!==a.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({...o,frame:i,sourceSize:{w:s,h:l}})}}for(const t in e){const r=M(e[t]);Array.isArray(r)&&(e[t]=r)}return e}{let e=[];return null!=t&&t.frames&&(e=Array.isArray(t.frames)?t.frames.map((e=>({...e,x:e.frame.x,y:e.frame.y,w:e.frame.w,h:e.frame.h}))):Object.values(t.frames).flat().map((e=>({...e,x:e.frame.x,y:e.frame.y,w:e.frame.w,h:e.frame.h})))),M(e)}}return[]}),[M,u]),P=S.useCallback(((e,t)=>{let r=new T.Vector3(1,1,1);if(null===e){if(t&&i){const e=t.image.width,n=t.image.height;d.current=i;const{rows:a,columns:o,frameWidth:s,frameHeight:l,emptyFrames:c}=E(t,i),m={frames:[],meta:{version:"1.0",size:{w:e,h:n},rows:a,columns:o,frameWidth:s,frameHeight:l,scale:"1"}};for(let e=0;e<a;e++)for(let t=0;t<o;t++){(null!=c?c:[]).some((r=>r.row===e&&r.col===t))||Array.isArray(m.frames)&&m.frames.push({frame:{x:t*s,y:e*l,w:s,h:l},scaleRatio:1,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:s,h:l},sourceSize:{w:s,h:l}})}r=b(s,l,.1),u.current=m}u.current&&u.current.frames&&(u.current.frames=M(u.current.frames))}else if(t){u.current=e,u.current.frames=C(),d.current=Array.isArray(e.frames)?e.frames.length:Object.keys(e.frames).length;const{w:t,h:n}=or(e.frames).sourceSize;r=b(t,n,.1)}x(u.current),"encoding"in t?t.encoding=3001:"colorSpace"in t&&(t.colorSpace=T.SRGBColorSpace),v(t),z({spriteTexture:t,spriteData:u.current,aspect:r})}),[E,i,C,b,M]),R=S.useCallback(((e,t,r)=>{const n=fetch(e).then((e=>e.json())),a=new Promise((e=>{g.load(t,e)}));Promise.all([n,a]).then((e=>{r(e[0],e[1])}))}),[g]),D=S.useCallback((e=>{if(!e&&!m.current)throw new Error("Either textureUrl or input must be provided");const t=null!=e?e:m.current;if(!t)throw new Error("A valid texture URL must be provided");g.load(t,(e=>P(null,e)))}),[g,P]),F=S.useCallback(((e,t)=>{t&&e?R(t,e,P):D(e)}),[R,D,P]);return S.useLayoutEffect((()=>{f.current&&m.current?R(f.current,m.current,P):m.current&&D();const e=m.current;return()=>{e&&a.useLoader.clear(n.TextureLoader,e)}}),[R,D,P]),S.useLayoutEffect((()=>{null==s||s(y,null!=h?h:null)}),[y,h,s]),{spriteObj:w,loadJsonAndTexture:F}}function lr(e,t,...r){const n=S.useRef(null),o=a.useThree((e=>e.scene));return S.useLayoutEffect((()=>{let a;if(e&&null!=e&&e.current&&t&&(n.current=a=new t(e.current,...r)),a)return a.traverse((e=>e.raycast=()=>null)),o.add(a),()=>{n.current=void 0,o.remove(a),null==a.dispose||a.dispose()}}),[o,t,e,...r]),a.useFrame((()=>{var e;null==(e=n.current)||null==e.update||e.update()})),n}sr.preload=e=>a.useLoader.preload(n.TextureLoader,e),sr.clear=e=>a.useLoader.clear(n.TextureLoader,e);function cr(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}const ur=S.forwardRef((function({className:e,parent:t,id:r,clearStatsGlStyle:n,...o},i){const s=a.useThree((e=>e.gl)),l=S.useMemo((()=>{const e=new D.default({...o});return e.init(s),e}),[s]);return S.useImperativeHandle(i,(()=>l.domElement),[l]),S.useEffect((()=>{if(l){const o=t&&t.current||document.body;null==o||o.appendChild(l.domElement),l.domElement.querySelectorAll("canvas").forEach((e=>{e.style.removeProperty("position")})),r&&(l.domElement.id=r),n&&l.domElement.removeAttribute("style"),l.domElement.removeAttribute("style");const i=(null!=e?e:"").split(" ").filter((e=>e));i.length&&l.domElement.classList.add(...i);const s=a.addAfterEffect((()=>l.update()));return()=>{i.length&&l.domElement.classList.remove(...i),null==o||o.removeChild(l.domElement),s()}}}),[t,l,e,r,n]),null}));const dr=e=>m.suspend((()=>v.getGPUTier(e)),["useDetectGPU"]);const mr=e=>e.isMesh;const fr=S.forwardRef((({enabled:e=!0,firstHitOnly:t=!1,children:r,strategy:o=g.SAH,verbose:i=!1,setBoundingBox:s=!0,maxDepth:l=40,maxLeafTris:c=10,indirect:u=!1,...d},m)=>{const f=S.useRef(null),p=a.useThree((e=>e.raycaster));return S.useImperativeHandle(m,(()=>f.current),[]),S.useEffect((()=>{if(e){const e={strategy:o,verbose:i,setBoundingBox:s,maxDepth:l,maxLeafTris:c,indirect:u},r=f.current;return p.firstHitOnly=t,r.traverse((t=>{mr(t)&&!t.geometry.boundsTree&&t.raycast===n.Mesh.prototype.raycast&&(t.raycast=g.acceleratedRaycast,t.geometry.computeBoundsTree=g.computeBoundsTree,t.geometry.disposeBoundsTree=g.disposeBoundsTree,t.geometry.computeBoundsTree(e))})),()=>{delete p.firstHitOnly,r.traverse((e=>{mr(e)&&e.geometry.boundsTree&&(e.geometry.disposeBoundsTree(),e.raycast=n.Mesh.prototype.raycast)}))}}}),[]),S.createElement("group",M.default({ref:f},d),r)}));function pr(e){const t=S.useRef(null),r=S.useRef(!1),n=S.useRef(!1),o=S.useRef(e);return S.useLayoutEffect((()=>{o.current=e}),[e]),S.useEffect((()=>{const e=t.current;if(e){const t=a.addEffect((()=>(r.current=!1,!0))),i=e.onBeforeRender;e.onBeforeRender=()=>r.current=!0;const s=a.addAfterEffect((()=>(r.current!==n.current&&(null==o.current||o.current(n.current=r.current)),!0)));return()=>{e.onBeforeRender=i,t(),s()}}}),[]),t}const hr=new T.Box3,xr=new T.Vector3;const yr=e=>Math.sqrt(1-Math.pow(e-1,2));class vr{constructor({size:e=256,maxAge:t=750,radius:r=.3,intensity:n=.2,interpolate:a=0,smoothing:o=0,minForce:i=.3,blend:s="screen",ease:l=yr}={}){this.size=e,this.maxAge=t,this.radius=r,this.intensity=n,this.ease=l,this.interpolate=a,this.smoothing=o,this.minForce=i,this.blend=s,this.trail=[],this.force=0,this.initTexture()}initTexture(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=this.size;const e=this.canvas.getContext("2d");if(null===e)throw new Error("2D not available");this.ctx=e,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.texture=new n.Texture(this.canvas),this.canvas.id="touchTexture",this.canvas.style.width=this.canvas.style.height=`${this.canvas.width}px`}update(e){this.clear(),this.trail.forEach(((t,r)=>{t.age+=1e3*e,t.age>this.maxAge&&this.trail.splice(r,1)})),this.trail.length||(this.force=0),this.trail.forEach((e=>{this.drawTouch(e)})),this.texture.needsUpdate=!0}clear(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}addTouch(e){const t=this.trail[this.trail.length-1];if(t){const r=t.x-e.x,n=t.y-e.y,a=r*r+n*n,o=Math.max(this.minForce,Math.min(1e4*a,1));if(this.force=function(e,t,r=.9){return t*r+e*(1-r)}(o,this.force,this.smoothing),this.interpolate){const e=Math.ceil(a/Math.pow(.5*this.radius/this.interpolate,2));if(e>1)for(let a=1;a<e;a++)this.trail.push({x:t.x-r/e*a,y:t.y-n/e*a,age:0,force:o})}}this.trail.push({x:e.x,y:e.y,age:0,force:this.force})}drawTouch(e){const t={x:e.x*this.size,y:(1-e.y)*this.size};let r=1;r=e.age<.3*this.maxAge?this.ease(e.age/(.3*this.maxAge)):this.ease(1-(e.age-.3*this.maxAge)/(.7*this.maxAge)),r*=e.force,this.ctx.globalCompositeOperation=this.blend;const n=this.size*this.radius*r,a=this.ctx.createRadialGradient(t.x,t.y,Math.max(0,.25*n),t.x,t.y,Math.max(0,n));a.addColorStop(0,`rgba(255, 255, 255, ${this.intensity})`),a.addColorStop(1,"rgba(0, 0, 0, 0.0)"),this.ctx.beginPath(),this.ctx.fillStyle=a,this.ctx.arc(t.x,t.y,Math.max(0,n),0,2*Math.PI),this.ctx.fill()}}function gr(e={}){const{size:r,maxAge:n,radius:o,intensity:i,interpolate:s,smoothing:l,minForce:c,blend:u,ease:d}=e,m=t.useMemo((()=>new vr(e)),[r,n,o,i,s,l,c,u,d]);a.useFrame(((e,t)=>{m.update(t)}));const f=t.useCallback((e=>m.addTouch(e.uv)),[m]);return[m.texture,f]}const wr=S.forwardRef((function({children:e,object:t,disable:r,disableX:a,disableY:o,disableZ:i,left:s,right:l,top:c,bottom:u,front:d,back:m,onCentered:f,precise:p=!0,cacheKey:h=0,...x},y){const v=S.useRef(null),g=S.useRef(null),w=S.useRef(null),[z]=S.useState((()=>new n.Box3)),[b]=S.useState((()=>new n.Vector3)),[E]=S.useState((()=>new n.Sphere));return S.useLayoutEffect((()=>{g.current.matrixWorld.identity(),z.setFromObject(null!=t?t:w.current,p);const e=z.max.x-z.min.x,n=z.max.y-z.min.y,h=z.max.z-z.min.z;z.getCenter(b),z.getBoundingSphere(E);const x=c?n/2:u?-n/2:0,y=s?-e/2:l?e/2:0,M=d?h/2:m?-h/2:0;g.current.position.set(r||a?0:-b.x+y,r||o?0:-b.y+x,r||i?0:-b.z+M),null==f||f({parent:v.current.parent,container:v.current,width:e,height:n,depth:h,boundingBox:z,boundingSphere:E,center:b,verticalAlignment:x,horizontalAlignment:y,depthAlignment:M})}),[h,f,c,s,d,r,a,o,i,t,p,l,u,m,z,b,E]),S.useImperativeHandle(y,(()=>v.current),[]),S.createElement("group",M.default({ref:v},x),S.createElement("group",{ref:g},S.createElement("group",{ref:w},e)))})),zr=S.forwardRef((({font:e,color:t="#cbcbcb",bevelSize:r=.04,debug:n=!1,children:a,...o},i)=>{const[s,l]=S.useState(0),c=S.useCallback(((e=1)=>l(s+e)),[s]),u=S.useCallback(((e=1)=>l(s-e)),[s]),d=S.useMemo((()=>({incr:c,decr:u})),[c,u]);return S.useImperativeHandle(i,(()=>d),[d]),S.createElement("group",o,S.createElement(S.Suspense,{fallback:null},S.createElement(wr,{top:!0,cacheKey:JSON.stringify({counter:s,font:e})},S.createElement(we,{bevelEnabled:!0,bevelSize:r,font:e},n?S.createElement("meshNormalMaterial",{wireframe:!0}):S.createElement("meshStandardMaterial",{color:t}),s))),a)})),br=(e,t)=>{e.updateRanges[0]=t};const Er=new T.Matrix4,Mr=new T.Matrix4,Sr=[],Cr=new T.Mesh;class Tr extends T.Group{constructor(){super(),this.color=new T.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){const r=this.instance.current;if(!r)return;if(!r.geometry||!r.material)return;Cr.geometry=r.geometry;const n=r.matrixWorld,a=r.userData.instances.indexOf(this.instanceKey);if(!(-1===a||a>r.count)){r.getMatrixAt(a,Er),Mr.multiplyMatrices(n,Er),Cr.matrixWorld=Mr,r.material instanceof T.Material?Cr.material.side=r.material.side:Cr.material.side=r.material[0].side,Cr.raycast(e,Sr);for(let e=0,r=Sr.length;e<r;e++){const r=Sr[e];r.instanceId=a,r.object=this,t.push(r)}Sr.length=0}}}const Pr=S.createContext(null),Rr=new T.Matrix4,Dr=new T.Matrix4,Fr=new T.Matrix4,kr=new T.Vector3,_r=new T.Quaternion,Ar=new T.Vector3,Lr=S.forwardRef((({context:e,children:t,...r},n)=>{S.useMemo((()=>a.extend({PositionMesh:Tr})),[]);const o=S.useRef(null);S.useImperativeHandle(n,(()=>o.current),[]);const{subscribe:i,getParent:s}=S.useContext(e||Pr);return S.useLayoutEffect((()=>i(o)),[]),S.createElement("positionMesh",M.default({instance:s(),instanceKey:o,ref:o},r),t)})),Ir=S.forwardRef((({context:e,children:t,range:r,limit:n=1e3,frames:o=1/0,...i},s)=>{const[{localContext:l,instance:c}]=S.useState((()=>{const e=S.createContext(null);return{localContext:e,instance:S.forwardRef(((t,r)=>S.createElement(Lr,M.default({context:e},t,{ref:r}))))}})),u=S.useRef(null);S.useImperativeHandle(s,(()=>u.current),[]);const[d,m]=S.useState([]),[[f,p]]=S.useState((()=>{const e=new Float32Array(16*n);for(let t=0;t<n;t++)Fr.identity().toArray(e,16*t);return[e,new Float32Array([...new Array(3*n)].map((()=>1)))]}));S.useEffect((()=>{u.current.instanceMatrix.needsUpdate=!0}));let h=0,x=0;const y=S.useRef([]);S.useLayoutEffect((()=>{y.current=Object.entries(u.current.geometry.attributes).filter((([e,t])=>t.isInstancedBufferAttribute))})),a.useFrame((()=>{if(o===1/0||h<o){u.current.updateMatrix(),u.current.updateMatrixWorld(),Rr.copy(u.current.matrixWorld).invert(),x=Math.min(n,void 0!==r?r:n,d.length),u.current.count=x,br(u.current.instanceMatrix,{start:0,count:16*x}),br(u.current.instanceColor,{start:0,count:3*x});for(let e=0;e<d.length;e++){const t=d[e].current;t.matrixWorld.decompose(kr,_r,Ar),Dr.compose(kr,_r,Ar).premultiply(Rr),Dr.toArray(f,16*e),u.current.instanceMatrix.needsUpdate=!0,t.color.toArray(p,3*e),u.current.instanceColor.needsUpdate=!0}h++}}));const v=S.useMemo((()=>({getParent:()=>u,subscribe:e=>(m((t=>[...t,e])),()=>m((t=>t.filter((t=>t.current!==e.current)))))})),[]);return S.createElement("instancedMesh",M.default({userData:{instances:d,limit:n,frames:o},matrixAutoUpdate:!1,ref:u,args:[null,null,0],raycast:()=>null},i),S.createElement("instancedBufferAttribute",{attach:"instanceMatrix",args:[f,16],usage:T.DynamicDrawUsage}),S.createElement("instancedBufferAttribute",{attach:"instanceColor",args:[p,3],usage:T.DynamicDrawUsage}),"function"==typeof t?S.createElement(l.Provider,{value:v},t(c)):e?S.createElement(e.Provider,{value:v},t):S.createElement(Pr.Provider,{value:v},t))})),Br=S.forwardRef((function({meshes:e,children:t,...r},n){const a=Array.isArray(e);if(!a)for(const t of Object.keys(e))e[t].isMesh||delete e[t];const o=(a?e:Object.values(e)).map((({geometry:e,material:t})=>S.createElement(Ir,M.default({key:e.uuid,geometry:e,material:t},r))));return S.createElement("group",{ref:n},Ur((r=>a?t(...r):t(Object.keys(e).filter((t=>e[t].isMesh)).reduce(((e,t,n)=>({...e,[t]:r[n]})),{}))),o))}));function Ur(e,t,r=[]){if(!t[0])return e(r);function n(n){return Ur(e,t.slice(1),r.concat([n]))}return"function"==typeof t[0]?t[0]({results:r,render:n}):S.cloneElement(t[0],{children:n})}const Vr=S.forwardRef((({name:e,defaultValue:t,normalized:r,usage:n=T.DynamicDrawUsage},o)=>{const i=S.useRef(null);S.useImperativeHandle(o,(()=>i.current),[]),S.useLayoutEffect((()=>{const r=i.current.__r3f.parent.object;r.geometry.attributes[e]=i.current;const n=Array.isArray(t)?t:[t],a=Array.from({length:r.userData.limit},(()=>n)).flat();return i.current.array=new Float32Array(a),i.current.itemSize=n.length,i.current.count=a.length/i.current.itemSize,()=>{delete r.geometry.attributes[e]}}),[e]);let s=0;return a.useFrame((()=>{const t=i.current.__r3f.parent.object;if(t.userData.frames===1/0||s<t.userData.frames){for(let r=0;r<t.userData.instances.length;r++){const n=t.userData.instances[r].current[e];void 0!==n&&(i.current.set(Array.isArray(n)?n:"function"==typeof n.toArray?n.toArray():[n],r*i.current.itemSize),i.current.needsUpdate=!0)}s++}})),S.createElement("instancedBufferAttribute",{ref:i,usage:n,normalized:r})})),Or=S.createContext(null);const Nr=new T.PlaneGeometry(1,1),jr=S.forwardRef((({startFrame:e=0,endFrame:t,fps:r=30,frameName:n="",textureDataURL:o,textureImageURL:i,loop:s=!1,numberOfFrames:l=1,autoPlay:c=!0,animationNames:u,onStart:d,onEnd:m,onLoopEnd:f,onFrame:p,play:h,pause:x=!1,flipX:y=!1,alphaTest:v=0,children:g,asSprite:w=!1,offset:z,playBackwards:b=!1,resetOnEnd:E=!1,maxItems:C=1,instanceItems:P=[[0,0,0]],spriteDataset:R,canvasRenderingContext2DSettings:D,roundFramePosition:F=!1,meshProps:k={},..._},A)=>{const L=S.useRef(new T.Group),I=S.useRef(null),B=S.useRef(null),U=S.useRef(null),V=S.useRef(window.performance.now()),O=S.useRef(e),N=S.useRef(n),j=r>0?1e3/r:0,[W,G]=S.useState(new T.Texture),H=S.useRef(0),[$,q]=S.useState(new T.Vector3(1,1,1)),X=y?-1:1,Z=S.useRef(x),Y=S.useRef(z),Q=S.useRef(!1),{spriteObj:K,loadJsonAndTexture:J}=sr(null,null,u,l,void 0,D),te=S.useRef(n),re=S.useCallback(((e,t)=>{if(null===t)l&&(H.current=l,b&&(O.current=l-1),I.current=t);else{var r,n;I.current=t,I.current&&Array.isArray(I.current.frames)?H.current=I.current.frames.length:I.current&&"object"==typeof I.current&&te.current?H.current=I.current.frames[te.current].length:H.current=0,b&&(O.current=H.current-1);const{w:a,h:o}=or(null!==(r=null==(n=I.current)?void 0:n.frames)&&void 0!==r?r:[],te.current).sourceSize,i=oe(a,o);q(i),B.current&&(B.current.map=e)}G(e)}),[l,b]),ne=S.useCallback((()=>{if(!I.current)return;const{meta:{size:e},frames:t}=I.current,{w:r,h:a}=Array.isArray(t)?t[0].sourceSize:n&&t[n]?t[n][0].sourceSize:{w:0,h:0};B.current&&B.current.map&&(B.current.map.wrapS=B.current.map.wrapT=T.RepeatWrapping,B.current.map.center.set(0,0),B.current.map.repeat.set(1*X/(e.w/r),1/(e.h/a)));const o=1/((e.h-1)/a);B.current&&B.current.map&&(B.current.map.offset.x=0,B.current.map.offset.y=1-o),d&&d({currentFrameName:null!=n?n:"",currentFrame:O.current})}),[X,n,d]),ae=S.useMemo((()=>({current:Y.current,offset:Y.current,imageUrl:i,hasEnded:!1,ref:A})),[i,A]);S.useImperativeHandle(A,(()=>L.current),[]),S.useLayoutEffect((()=>{Y.current=z}),[z]);const oe=(e,t)=>{var r;const n=new T.Vector3,a=t/e;return n.set(1,a,1),null==(r=U.current)||r.scale.copy(n),n};S.useEffect((()=>{var e;R?re(null==R||null==(e=R.spriteTexture)?void 0:e.clone(),R.spriteData):i&&o&&J(i,o)}),[J,R,o,i,re]),S.useEffect((()=>{var e;K&&re(null==K||null==(e=K.spriteTexture)?void 0:e.clone(),null==K?void 0:K.spriteData)}),[K,re]),S.useEffect((()=>{var e;(ae.hasEnded=!1,I.current&&!0===b)?O.current=(null!==(e=I.current.frames.length)&&void 0!==e?e:0)-1:O.current=0}),[b,ae]),S.useLayoutEffect((()=>{ne()}),[W,y,ne]),S.useEffect((()=>{c&&(Z.current=!1)}),[c]),S.useLayoutEffect((()=>{if(N.current!==n&&n&&(O.current=0,N.current=n,ae.hasEnded=!1,j<=0&&(O.current=t||e||0),I.current)){const{w:e,h:t}=or(I.current.frames,n).sourceSize,r=oe(e,t);q(r)}}),[n,j,ae,t,e]);const ie=(e,t,r,n)=>{var a=void 0===z?ae.current:z;const o=O.current;let i=0,s=0;oe(e,t);const l=F?Math.round((r.w-1)/e):(r.w-1)/e,c=F?Math.round((r.h-1)/t):(r.h-1)/t;if(!n[o])return;const{frame:{x:u,y:d},sourceSize:{w:m,h:f}}=n[o],p=1/l,h=1/c;if(B.current&&B.current.map&&(i=X>0?p*(u/m):p*(u/m)-B.current.map.repeat.x,s=Math.abs(1-h)-h*(d/f),B.current.map.offset.x=i,B.current.map.offset.y=s),null!=a){let e=Math.floor(a*n.length);e=Math.max(0,Math.min(e,n.length-1)),isNaN(e)&&(e=0),O.current=e}else b?O.current-=1:O.current+=1};return a.useFrame(((r,a)=>{var o,i;null!=(o=I.current)&&o.frames&&null!=(i=B.current)&&i.map&&(Z.current||ae.hasEnded||!c&&!h||((()=>{if(null===(r=I.current)||!("meta"in r)||!("frames"in r))return;var r;const{meta:{size:a},frames:o}=I.current,{w:i,h:l}=or(o,n).sourceSize,c=Array.isArray(o)?o:n?o[n]:[],u=t||c.length-1;var p=void 0===z?ae.current:z;if(j<=0)return O.current=t||e||0,void ie(i,l,a,c);const h=window.performance.now(),x=h-V.current;if(!(x<=j)){var y=b?O.current<0:O.current>u,v=b?O.current===u:0===O.current,g=b?O.current<0:O.current>=u;if(y){if(O.current=s&&null!=e?e:0,b&&(O.current=u),s?null==f||f({currentFrameName:null!=n?n:"",currentFrame:O.current}):(null==m||m({currentFrameName:null!=n?n:"",currentFrame:O.current}),ae.hasEnded=!E,E&&(Z.current=!0)),!s)return}else v&&(null==d||d({currentFrameName:null!=n?n:"",currentFrame:O.current}));void 0!==p&&g?!1===Q.current&&(null==m||m({currentFrameName:null!=n?n:"",currentFrame:O.current}),Q.current=!0):Q.current=!1,x<=j||(V.current=h-x%j,ie(i,l,a,c))}})(),null==p||p({currentFrameName:N.current,currentFrame:O.current})))})),S.createElement("group",M.default({},_,{ref:L,scale:function(e=new T.Vector3(1,1,1),t=1){return"number"==typeof t?e.multiplyScalar(t):Array.isArray(t)?e.multiply(new T.Vector3(...t)):t instanceof T.Vector3?e.multiply(t):void 0}($,_.scale)}),S.createElement(Or.Provider,{value:ae},w&&S.createElement(ee,null,S.createElement("mesh",M.default({ref:U,scale:1,geometry:Nr},k),S.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:T.DoubleSide,ref:B,map:W,transparent:!0,alphaTest:null!=v?v:0}))),!w&&S.createElement(Ir,M.default({geometry:Nr,limit:null!=C?C:1},k),S.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:T.DoubleSide,ref:B,map:W,transparent:!0,alphaTest:null!=v?v:0}),(null!=P?P:[0]).map(((e,t)=>S.createElement(Lr,M.default({key:t,ref:1===(null==P?void 0:P.length)?U:null,position:e,scale:1},k))))),g))})),Wr=S.forwardRef((({children:e,curve:t},r)=>{const[n]=S.useState((()=>new T.Scene)),[o,i]=S.useState(),s=S.useRef(null);return S.useLayoutEffect((()=>{s.current=new c.Flow(n.children[0]),i(s.current.object3D)}),[e]),S.useEffect((()=>{var e;t&&(null==(e=s.current)||e.updateCurve(0,t))}),[t]),S.useImperativeHandle(r,(()=>s.current)),S.createElement(S.Fragment,null,a.createPortal(e,n),o&&S.createElement("primitive",{object:o}))}));class Gr extends n.MeshPhysicalMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader=`\n      uniform float time;\n      uniform float radius;\n      uniform float distort;\n      #define GLSLIFY 1\nvec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}\n      ${e.vertexShader}\n    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        float updateTime = time / 50.0;\n        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));\n        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));\n        ")}get time(){return this._time.value}set time(e){this._time.value=e}get distort(){return this._distort.value}set distort(e){this._distort.value=e}get radius(){return this._radius.value}set radius(e){this._radius.value=e}}const Hr=S.forwardRef((({speed:e=1,...t},r)=>{const[n]=S.useState((()=>new Gr));return a.useFrame((t=>n&&(n.time=t.clock.elapsedTime*e))),S.createElement("primitive",M.default({object:n,ref:r,attach:"material"},t))}));class $r extends n.MeshStandardMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader=`\n      uniform float time;\n      uniform float factor;\n      ${e.vertexShader}\n    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n        float c = cos( theta );\n        float s = sin( theta );\n        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n        vec3 transformed = vec3( position ) * m;\n        vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const qr=S.forwardRef((({speed:e=1,...t},r)=>{const[n]=S.useState((()=>new $r));return a.useFrame((t=>n&&(n.time=t.clock.elapsedTime*e))),S.createElement("primitive",M.default({object:n,ref:r,attach:"material"},t))}));class Xr extends T.ShaderMaterial{constructor(e=new T.Vector2){super({uniforms:{inputBuffer:new T.Uniform(null),depthBuffer:new T.Uniform(null),resolution:new T.Uniform(new T.Vector2),texelSize:new T.Uniform(new T.Vector2),halfTexelSize:new T.Uniform(new T.Vector2),kernel:new T.Uniform(0),scale:new T.Uniform(1),cameraNear:new T.Uniform(0),cameraFar:new T.Uniform(1),minDepthThreshold:new T.Uniform(0),maxDepthThreshold:new T.Uniform(1),depthScale:new T.Uniform(0),depthToBlurRatioBias:new T.Uniform(.25)},fragmentShader:`#include <common>\n        #include <dithering_pars_fragment>      \n        uniform sampler2D inputBuffer;\n        uniform sampler2D depthBuffer;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          float depthFactor = 0.0;\n          \n          #ifdef USE_DEPTH\n            vec4 depth = texture2D(depthBuffer, vUv);\n            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n            depthFactor *= depthScale;\n            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));\n          #endif\n          \n          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));\n          gl_FragColor = sum * 0.25 ;\n\n          #include <dithering_fragment>\n          #include <tonemapping_fragment>\n          #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n        }`,vertexShader:"uniform vec2 texelSize;\n        uniform vec2 halfTexelSize;\n        uniform float kernel;\n        uniform float scale;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          vec2 uv = position.xy * 0.5 + 0.5;\n          vUv = uv;\n\n          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;\n          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\n          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\n          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\n          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\n\n          gl_Position = vec4(position.xy, 1.0, 1.0);\n        }",blending:T.NoBlending,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class Zr{constructor({gl:e,resolution:t,width:r=500,height:a=500,minDepthThreshold:o=0,maxDepthThreshold:i=1,depthScale:s=0,depthToBlurRatioBias:l=.25}){this.renderToScreen=!1,this.renderTargetA=new n.WebGLRenderTarget(t,t,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,stencilBuffer:!1,depthBuffer:!1,type:n.HalfFloatType}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Xr,this.convolutionMaterial.setTexelSize(1/r,1/a),this.convolutionMaterial.setResolution(new n.Vector2(r,a)),this.scene=new n.Scene,this.camera=new n.Camera,this.convolutionMaterial.uniforms.minDepthThreshold.value=o,this.convolutionMaterial.uniforms.maxDepthThreshold.value=i,this.convolutionMaterial.uniforms.depthScale.value=s,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=l,this.convolutionMaterial.defines.USE_DEPTH=s>0;const c=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),u=new Float32Array([0,0,2,0,0,2]),d=new n.BufferGeometry;d.setAttribute("position",new n.BufferAttribute(c,3)),d.setAttribute("uv",new n.BufferAttribute(u,2)),this.screen=new n.Mesh(d,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,r){const n=this.scene,a=this.camera,o=this.renderTargetA,i=this.renderTargetB;let s=this.convolutionMaterial,l=s.uniforms;l.depthBuffer.value=t.depthTexture;const c=s.kernel;let u,d,m,f=t;for(d=0,m=c.length-1;d<m;++d)u=1&d?i:o,l.kernel.value=c[d],l.inputBuffer.value=f.texture,e.setRenderTarget(u),e.render(n,a),f=u;l.kernel.value=c[d],l.inputBuffer.value=f.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(n,a)}}class Yr extends n.MeshStandardMaterial{constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}onBeforeCompile(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`\n        uniform mat4 textureMatrix;\n        varying vec4 my_vUv;\n      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n        my_vUv = textureMatrix * vec4( position, 1.0 );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"),e.fragmentShader=`\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDiffuseBlur;\n        uniform sampler2D tDepth;\n        uniform sampler2D distortionMap;\n        uniform float distortion;\n        uniform float cameraNear;\n\t\t\t  uniform float cameraFar;\n        uniform bool hasBlur;\n        uniform float mixBlur;\n        uniform float mirror;\n        uniform float mixStrength;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float mixContrast;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec4 my_vUv;\n        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>","#include <emissivemap_fragment>\n\n      float distortionFactor = 0.0;\n      #ifdef USE_DISTORTION\n        distortionFactor = texture2D(distortionMap, vUv).r * distortion;\n      #endif\n\n      vec4 new_vUv = my_vUv;\n      new_vUv.x += distortionFactor;\n      new_vUv.y += distortionFactor;\n\n      vec4 base = texture2DProj(tDiffuse, new_vUv);\n      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);\n\n      vec4 merge = base;\n\n      #ifdef USE_NORMALMAP\n        vec2 normal_uv = vec2(0.0);\n        vec4 normalColor = texture2D(normalMap, vUv * normalScale);\n        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\n        vec3 coord = new_vUv.xyz / new_vUv.w;\n        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;\n        vec4 base_normal = texture2D(tDiffuse, normal_uv);\n        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);\n        merge = base_normal;\n        blur = blur_normal;\n      #endif\n\n      float depthFactor = 0.0001;\n      float blurFactor = 0.0;\n\n      #ifdef USE_DEPTH\n        vec4 depth = texture2DProj(tDepth, new_vUv);\n        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n        depthFactor *= depthScale;\n        depthFactor = max(0.0001, min(1.0, depthFactor));\n\n        #ifdef USE_BLUR\n          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);\n          merge = merge * min(1.0, depthFactor + 0.5);\n        #else\n          merge = merge * depthFactor;\n        #endif\n\n      #endif\n\n      float reflectorRoughnessFactor = roughness;\n      #ifdef USE_ROUGHNESSMAP\n        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );\n        reflectorRoughnessFactor *= reflectorTexelRoughness.g;\n      #endif\n\n      #ifdef USE_BLUR\n        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);\n        merge = mix(merge, blur, blurFactor);\n      #endif\n\n      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);\n      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;\n      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;\n      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;\n\n      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);\n      ")}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}}const Qr=S.forwardRef((({mixBlur:e=0,mixStrength:t=1,resolution:r=256,blur:o=[0,0],minDepthThreshold:i=.9,maxDepthThreshold:s=1,depthScale:l=0,depthToBlurRatioBias:c=.25,mirror:u=0,distortion:d=1,mixContrast:m=1,distortionMap:f,reflectorOffset:p=0,...h},x)=>{a.extend({MeshReflectorMaterialImpl:Yr});const y=a.useThree((({gl:e})=>e)),v=a.useThree((({camera:e})=>e)),g=a.useThree((({scene:e})=>e)),w=(o=Array.isArray(o)?o:[o,o])[0]+o[1]>0,z=o[0],b=o[1],E=S.useRef(null);S.useImperativeHandle(x,(()=>E.current),[]);const[C]=S.useState((()=>new n.Plane)),[T]=S.useState((()=>new n.Vector3)),[P]=S.useState((()=>new n.Vector3)),[R]=S.useState((()=>new n.Vector3)),[D]=S.useState((()=>new n.Matrix4)),[F]=S.useState((()=>new n.Vector3(0,0,-1))),[k]=S.useState((()=>new n.Vector4)),[_]=S.useState((()=>new n.Vector3)),[A]=S.useState((()=>new n.Vector3)),[L]=S.useState((()=>new n.Vector4)),[I]=S.useState((()=>new n.Matrix4)),[B]=S.useState((()=>new n.PerspectiveCamera)),U=S.useCallback((()=>{var e;const t=E.current.parent||(null==(e=E.current)||null==(e=e.__r3f.parent)?void 0:e.object);if(!t)return;if(P.setFromMatrixPosition(t.matrixWorld),R.setFromMatrixPosition(v.matrixWorld),D.extractRotation(t.matrixWorld),T.set(0,0,1),T.applyMatrix4(D),P.addScaledVector(T,p),_.subVectors(P,R),_.dot(T)>0)return;_.reflect(T).negate(),_.add(P),D.extractRotation(v.matrixWorld),F.set(0,0,-1),F.applyMatrix4(D),F.add(R),A.subVectors(P,F),A.reflect(T).negate(),A.add(P),B.position.copy(_),B.up.set(0,1,0),B.up.applyMatrix4(D),B.up.reflect(T),B.lookAt(A),B.far=v.far,B.updateMatrixWorld(),B.projectionMatrix.copy(v.projectionMatrix),I.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),I.multiply(B.projectionMatrix),I.multiply(B.matrixWorldInverse),I.multiply(t.matrixWorld),C.setFromNormalAndCoplanarPoint(T,P),C.applyMatrix4(B.matrixWorldInverse),k.set(C.normal.x,C.normal.y,C.normal.z,C.constant);const r=B.projectionMatrix;L.x=(Math.sign(k.x)+r.elements[8])/r.elements[0],L.y=(Math.sign(k.y)+r.elements[9])/r.elements[5],L.z=-1,L.w=(1+r.elements[10])/r.elements[14],k.multiplyScalar(2/k.dot(L)),r.elements[2]=k.x,r.elements[6]=k.y,r.elements[10]=k.z+1,r.elements[14]=k.w}),[v,p]),[V,O,N,j]=S.useMemo((()=>{const a={minFilter:n.LinearFilter,magFilter:n.LinearFilter,type:n.HalfFloatType},o=new n.WebGLRenderTarget(r,r,a);o.depthBuffer=!0,o.depthTexture=new n.DepthTexture(r,r),o.depthTexture.format=n.DepthFormat,o.depthTexture.type=n.UnsignedShortType;const p=new n.WebGLRenderTarget(r,r,a);return[o,p,new Zr({gl:y,resolution:r,width:z,height:b,minDepthThreshold:i,maxDepthThreshold:s,depthScale:l,depthToBlurRatioBias:c}),{mirror:u,textureMatrix:I,mixBlur:e,tDiffuse:o.texture,tDepth:o.depthTexture,tDiffuseBlur:p.texture,hasBlur:w,mixStrength:t,minDepthThreshold:i,maxDepthThreshold:s,depthScale:l,depthToBlurRatioBias:c,distortion:d,distortionMap:f,mixContrast:m,"defines-USE_BLUR":w?"":void 0,"defines-USE_DEPTH":l>0?"":void 0,"defines-USE_DISTORTION":f?"":void 0}]}),[y,z,b,I,r,u,w,e,t,i,s,l,c,d,f,m]);return a.useFrame((()=>{var e;const t=E.current.parent||(null==(e=E.current)||null==(e=e.__r3f.parent)?void 0:e.object);if(!t)return;t.visible=!1;const r=y.xr.enabled,n=y.shadowMap.autoUpdate;U(),y.xr.enabled=!1,y.shadowMap.autoUpdate=!1,y.setRenderTarget(V),y.state.buffers.depth.setMask(!0),y.autoClear||y.clear(),y.render(g,B),w&&N.render(y,V,O),y.xr.enabled=r,y.shadowMap.autoUpdate=n,t.visible=!0,y.setRenderTarget(null)})),S.createElement("meshReflectorMaterialImpl",M.default({attach:"material",key:"key"+j["defines-USE_BLUR"]+j["defines-USE_DEPTH"]+j["defines-USE_DISTORTION"],ref:E},j,h))})),Kr=Ee({envMap:null,bounces:3,ior:2.4,correctMips:!0,aberrationStrength:.01,fresnel:0,bvh:new g.MeshBVHUniformStruct,color:new T.Color("white"),opacity:1,resolution:new T.Vector2,viewMatrixInverse:new T.Matrix4,projectionMatrixInverse:new T.Matrix4},"\n  uniform mat4 viewMatrixInverse;\n\n  varying vec3 vWorldPosition;\n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #include <color_pars_vertex>\n\n  void main() {\n    #include <color_vertex>\n\n    vec4 transformedNormal = vec4(normal, 0.0);\n    vec4 transformedPosition = vec4(position, 1.0);\n    #ifdef USE_INSTANCING\n      transformedNormal = instanceMatrix * transformedNormal;\n      transformedPosition = instanceMatrix * transformedPosition;\n    #endif\n\n    #ifdef USE_INSTANCING\n      vModelMatrixInverse = inverse(modelMatrix * instanceMatrix);\n    #else\n      vModelMatrixInverse = inverse(modelMatrix);\n    #endif\n\n    vWorldPosition = (modelMatrix * transformedPosition).xyz;\n    vNormal = normalize((viewMatrixInverse * vec4(normalMatrix * transformedNormal.xyz, 0.0)).xyz);\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * transformedPosition;\n  }",`\n  #define ENVMAP_TYPE_CUBE_UV\n  precision highp isampler2D;\n  precision highp usampler2D;\n  varying vec3 vWorldPosition;\n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #include <color_pars_fragment>\n\n  #ifdef ENVMAP_TYPE_CUBEM\n    uniform samplerCube envMap;\n  #else\n    uniform sampler2D envMap;\n  #endif\n\n  uniform float bounces;\n  ${g.shaderStructs}\n  ${g.shaderIntersectFunction}\n  uniform BVH bvh;\n  uniform float ior;\n  uniform bool correctMips;\n  uniform vec2 resolution;\n  uniform float fresnel;\n  uniform mat4 modelMatrix;\n  uniform mat4 projectionMatrixInverse;\n  uniform mat4 viewMatrixInverse;\n  uniform float aberrationStrength;\n  uniform vec3 color;\n  uniform float opacity;\n\n  float fresnelFunc(vec3 viewDirection, vec3 worldNormal) {\n    return pow( 1.0 + dot( viewDirection, worldNormal), 10.0 );\n  }\n\n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 normal, float ior, mat4 modelMatrixInverse) {\n    vec3 rayOrigin = ro;\n    vec3 rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = vWorldPosition + rayDirection * 0.001;\n    rayOrigin = (modelMatrixInverse * vec4(rayOrigin, 1.0)).xyz;\n    rayDirection = normalize((modelMatrixInverse * vec4(rayDirection, 0.0)).xyz);\n    for(float i = 0.0; i < bounces; i++) {\n      uvec4 faceIndices = uvec4( 0u );\n      vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );\n      vec3 barycoord = vec3( 0.0 );\n      float side = 1.0;\n      float dist = 0.0;\n      bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );\n      vec3 hitPos = rayOrigin + rayDirection * max(dist - 0.001, 0.0);\n      vec3 tempDir = refract(rayDirection, faceNormal, ior);\n      if (length(tempDir) != 0.0) {\n        rayDirection = tempDir;\n        break;\n      }\n      rayDirection = reflect(rayDirection, faceNormal);\n      rayOrigin = hitPos + rayDirection * 0.01;\n    }\n    rayDirection = normalize((modelMatrix * vec4(rayDirection, 0.0)).xyz);\n    return rayDirection;\n  }\n\n  #include <common>\n  #include <cube_uv_reflection_fragment>\n\n  #ifdef ENVMAP_TYPE_CUBEM\n    vec4 textureGradient(samplerCube envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      return textureGrad(envMap, rayDirection, dFdx(correctMips ? directionCamPerfect: rayDirection), dFdy(correctMips ? directionCamPerfect: rayDirection));\n    }\n  #else\n    vec4 textureGradient(sampler2D envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      vec2 uvv = equirectUv( rayDirection );\n      vec2 smoothUv = equirectUv( directionCamPerfect );\n      return textureGrad(envMap, uvv, dFdx(correctMips ? smoothUv : uvv), dFdy(correctMips ? smoothUv : uvv));\n    }\n  #endif\n\n  void main() {\n    vec2 uv = gl_FragCoord.xy / resolution;\n    vec3 directionCamPerfect = (projectionMatrixInverse * vec4(uv * 2.0 - 1.0, 0.0, 1.0)).xyz;\n    directionCamPerfect = (viewMatrixInverse * vec4(directionCamPerfect, 0.0)).xyz;\n    directionCamPerfect = normalize(directionCamPerfect);\n    vec3 normal = vNormal;\n    vec3 rayOrigin = cameraPosition;\n    vec3 rayDirection = normalize(vWorldPosition - cameraPosition);\n\n    vec4 diffuseColor = vec4(color, opacity);\n    #include <color_fragment>\n\n    #ifdef CHROMATIC_ABERRATIONS\n      vec3 rayDirectionG = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      #ifdef FAST_CHROMA\n        vec3 rayDirectionR = normalize(rayDirectionG + 1.0 * vec3(aberrationStrength / 2.0));\n        vec3 rayDirectionB = normalize(rayDirectionG - 1.0 * vec3(aberrationStrength / 2.0));\n      #else\n        vec3 rayDirectionR = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 - aberrationStrength), 1.0), vModelMatrixInverse);\n        vec3 rayDirectionB = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 + aberrationStrength), 1.0), vModelMatrixInverse);\n      #endif\n      float finalColorR = textureGradient(envMap, rayDirectionR, directionCamPerfect).r;\n      float finalColorG = textureGradient(envMap, rayDirectionG, directionCamPerfect).g;\n      float finalColorB = textureGradient(envMap, rayDirectionB, directionCamPerfect).b;\n      diffuseColor.rgb *= vec3(finalColorR, finalColorG, finalColorB);\n    #else\n      rayDirection = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      diffuseColor.rgb *= textureGradient(envMap, rayDirection, directionCamPerfect).rgb;\n    #endif\n\n    vec3 viewDirection = normalize(vWorldPosition - cameraPosition);\n    float nFresnel = fresnelFunc(viewDirection, normal) * fresnel;\n    gl_FragColor = vec4(mix(diffuseColor.rgb, vec3(1.0), nFresnel), diffuseColor.a);\n\n    #include <tonemapping_fragment>\n    #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n  }`);const Jr=Ee({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class en extends T.MeshPhysicalMaterial{constructor(e=6,t=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new T.Color("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=r=>{r.uniforms={...r.uniforms,...this.uniforms},this.anisotropy>0&&(r.defines.USE_ANISOTROPY=""),t?r.defines.USE_SAMPLER="":r.defines.USE_TRANSMISSION="",r.fragmentShader="\n      uniform float chromaticAberration;         \n      uniform float anisotropicBlur;      \n      uniform float time;\n      uniform float distortion;\n      uniform float distortionScale;\n      uniform float temporalDistortion;\n      uniform sampler2D buffer;\n\n      vec3 random3(vec3 c) {\n        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n        vec3 r;\n        r.z = fract(512.0*j);\n        j *= .125;\n        r.x = fract(512.0*j);\n        j *= .125;\n        r.y = fract(512.0*j);\n        return r-0.5;\n      }\n\n      uint hash( uint x ) {\n        x += ( x << 10u );\n        x ^= ( x >>  6u );\n        x += ( x <<  3u );\n        x ^= ( x >> 11u );\n        x += ( x << 15u );\n        return x;\n      }\n\n      // Compound versions of the hashing algorithm I whipped together.\n      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }\n      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }\n      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }\n\n      // Construct a float with half-open range [0:1] using low 23 bits.\n      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.\n      float floatConstruct( uint m ) {\n        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask\n        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32\n        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)\n        m |= ieeeOne;                          // Add fractional part to 1.0\n        float  f = uintBitsToFloat( m );       // Range [1:2]\n        return f - 1.0;                        // Range [0:1]\n      }\n\n      // Pseudo-random value in half-open range [0:1].\n      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }\n      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float rand(float seed) {\n        float result = randomBase(vec3(gl_FragCoord.xy, seed));\n        return result;\n      }\n\n      const float F3 =  0.3333333;\n      const float G3 =  0.1666667;\n\n      float snoise(vec3 p) {\n        vec3 s = floor(p + dot(p, vec3(F3)));\n        vec3 x = p - s + dot(s, vec3(G3));\n        vec3 e = step(vec3(0.0), x - x.yzx);\n        vec3 i1 = e*(1.0 - e.zxy);\n        vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n        vec3 x1 = x - i1 + G3;\n        vec3 x2 = x - i2 + 2.0*G3;\n        vec3 x3 = x - 1.0 + 3.0*G3;\n        vec4 w, d;\n        w.x = dot(x, x);\n        w.y = dot(x1, x1);\n        w.z = dot(x2, x2);\n        w.w = dot(x3, x3);\n        w = max(0.6 - w, 0.0);\n        d.x = dot(random3(s), x);\n        d.y = dot(random3(s + i1), x1);\n        d.z = dot(random3(s + i2), x2);\n        d.w = dot(random3(s + 1.0), x3);\n        w *= w;\n        w *= w;\n        d *= w;\n        return dot(d, vec4(52.0));\n      }\n\n      float snoiseFractal(vec3 m) {\n        return 0.5333333* snoise(m)\n              +0.2666667* snoise(2.0*m)\n              +0.1333333* snoise(4.0*m)\n              +0.0666667* snoise(8.0*m);\n      }\n"+r.fragmentShader,r.fragmentShader=r.fragmentShader.replace("#include <transmission_pars_fragment>","\n        #ifdef USE_TRANSMISSION\n          // Transmission code is based on glTF-Sampler-Viewer\n          // https://github.com/KhronosGroup/glTF-Sample-Viewer\n          uniform float _transmission;\n          uniform float thickness;\n          uniform float attenuationDistance;\n          uniform vec3 attenuationColor;\n          #ifdef USE_TRANSMISSIONMAP\n            uniform sampler2D transmissionMap;\n          #endif\n          #ifdef USE_THICKNESSMAP\n            uniform sampler2D thicknessMap;\n          #endif\n          uniform vec2 transmissionSamplerSize;\n          uniform sampler2D transmissionSamplerMap;\n          uniform mat4 modelMatrix;\n          uniform mat4 projectionMatrix;\n          varying vec3 vWorldPosition;\n          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n            // Direction of refracted light.\n            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n            // Compute rotation-independant scaling of the model matrix.\n            vec3 modelScale;\n            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n            // The thickness is specified in local space.\n            return normalize( refractionVector ) * thickness * modelScale;\n          }\n          float applyIorToRoughness( const in float roughness, const in float ior ) {\n            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n            // an IOR of 1.5 results in the default amount of microfacet refraction.\n            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n          }\n          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            \n            #ifdef USE_SAMPLER\n              #ifdef texture2DLodEXT\n                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #else\n                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #endif\n            #else\n              return texture2D(buffer, fragCoord.xy);\n            #endif\n          }\n          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n            if ( isinf( attenuationDistance ) ) {\n              // Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.\n              return radiance;\n            } else {\n              // Compute light attenuation using Beer's law.\n              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law\n              return transmittance * radiance;\n            }\n          }\n          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n            const in vec3 attenuationColor, const in float attenuationDistance ) {\n            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n            vec3 refractedRayExit = position + transmissionRay;\n            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n            vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n            refractionCoords += 1.0;\n            refractionCoords /= 2.0;\n            // Sample framebuffer to get pixel the refracted ray hits.\n            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n            // Get the specular component.\n            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n          }\n        #endif\n"),r.fragmentShader=r.fragmentShader.replace("#include <transmission_fragment>",`  \n        // Improve the refraction to use the world pos\n        material.transmission = _transmission;\n        material.transmissionAlpha = 1.0;\n        material.thickness = thickness;\n        material.attenuationDistance = attenuationDistance;\n        material.attenuationColor = attenuationColor;\n        #ifdef USE_TRANSMISSIONMAP\n          material.transmission *= texture2D( transmissionMap, vUv ).r;\n        #endif\n        #ifdef USE_THICKNESSMAP\n          material.thickness *= texture2D( thicknessMap, vUv ).g;\n        #endif\n        \n        vec3 pos = vWorldPosition;\n        float runningSeed = 0.0;\n        vec3 v = normalize( cameraPosition - pos );\n        vec3 n = inverseTransformDirection( normal, viewMatrix );\n        vec3 transmission = vec3(0.0);\n        float transmissionR, transmissionB, transmissionG;\n        float randomCoords = rand(runningSeed++);\n        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);\n        vec3 distortionNormal = vec3(0.0);\n        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;\n        if (distortion > 0.0) {\n          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));\n        }\n        for (float i = 0.0; i < ${e}.0; i ++) {\n          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);\n          transmissionR = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).r;\n          transmissionG = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(${e})) , material.thickness + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).g;\n          transmissionB = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(${e})), material.thickness + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).b;\n          transmission.r += transmissionR;\n          transmission.g += transmissionG;\n          transmission.b += transmissionB;\n        }\n        transmission /= ${e}.0;\n        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n`)},Object.keys(this.uniforms).forEach((e=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t})))}}const tn=S.forwardRef((({buffer:e,transmissionSampler:t=!1,backside:r=!1,side:n=T.FrontSide,transmission:o=1,thickness:i=0,backsideThickness:s=0,backsideEnvMapIntensity:l=1,samples:c=10,resolution:u,backsideResolution:d,background:m,anisotropy:f,anisotropicBlur:p,...h},x)=>{a.extend({MeshTransmissionMaterial:en});const y=S.useRef(null),[v]=S.useState((()=>new Jr)),g=rt(d||u),w=rt(u);let z,b,E,C;return a.useFrame((e=>{var a;(y.current.time=e.clock.elapsedTime,y.current.buffer!==w.texture||t)||(C=null==(a=y.current.__r3f.parent)?void 0:a.object,C&&(E=e.gl.toneMapping,z=e.scene.background,b=y.current.envMapIntensity,e.gl.toneMapping=T.NoToneMapping,m&&(e.scene.background=m),C.material=v,r&&(e.gl.setRenderTarget(g),e.gl.render(e.scene,e.camera),C.material=y.current,C.material.buffer=g.texture,C.material.thickness=s,C.material.side=T.BackSide,C.material.envMapIntensity=l),e.gl.setRenderTarget(w),e.gl.render(e.scene,e.camera),C.material=y.current,C.material.thickness=i,C.material.side=n,C.material.buffer=w.texture,C.material.envMapIntensity=b,e.scene.background=z,e.gl.setRenderTarget(null),e.gl.toneMapping=E))})),S.useImperativeHandle(x,(()=>y.current),[]),S.createElement("meshTransmissionMaterial",M.default({args:[c,t],ref:y},h,{buffer:e||w.texture,_transmission:o,anisotropicBlur:null!=p?p:f,transmission:t?o:0,thickness:i,side:n}))})),rn=S.forwardRef(((e,t)=>(a.extend({DiscardMaterialImpl:Jr}),S.createElement("discardMaterialImpl",M.default({ref:t},e)))));const nn=Ce>=154?"opaque_fragment":"output_fragment";class an extends T.PointsMaterial{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{const{isWebGL2:r}=t.capabilities;e.fragmentShader=e.fragmentShader.replace(`#include <${nn}>`,`\n        ${r?`#include <${nn}>`:`#extension GL_OES_standard_derivatives : enable\n#include <${nn}>`}\n      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n      float r = dot(cxy, cxy);\n      float delta = fwidth(r);     \n      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );\n      #include <tonemapping_fragment>\n      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n      `)}}}const on=S.forwardRef(((e,t)=>{const[r]=S.useState((()=>new an(null)));return S.createElement("primitive",M.default({},e,{object:r,ref:t,attach:"material"}))}));function sn(e,t,r){t.traverse((t=>{t.material&&(e.properties.remove(t.material),null==t.material.dispose||t.material.dispose())})),e.info.programs.length=0,e.compile(t,r)}function ln(e,t){const r=e+"Geometry";return S.forwardRef((({args:e,children:n,...a},o)=>{const i=S.useRef(null);return S.useImperativeHandle(o,(()=>i.current)),S.useLayoutEffect((()=>{null==t||t(i.current)})),S.createElement("mesh",M.default({ref:i},a),S.createElement(r,{attach:"geometry",args:e}),n)}))}const cn=ln("box"),un=ln("circle"),dn=ln("cone"),mn=ln("cylinder"),fn=ln("sphere"),pn=ln("plane"),hn=ln("tube"),xn=ln("torus"),yn=ln("torusKnot"),vn=ln("tetrahedron"),gn=ln("ring"),wn=ln("polyhedron"),zn=ln("icosahedron"),bn=ln("octahedron"),En=ln("dodecahedron"),Mn=ln("extrude"),Sn=ln("lathe"),Cn=ln("capsule"),Tn=ln("shape",(({geometry:e})=>{const t=e.attributes.position,r=(new T.Box3).setFromBufferAttribute(t),n=new T.Vector3;r.getSize(n);const a=[];let o=0,i=0,s=0,l=0;for(let e=0;e<t.count;e++)o=t.getX(e),i=t.getY(e),s=(o-r.min.x)/n.x,l=(i-r.min.y)/n.y,a.push(s,l);e.setAttribute("uv",new T.Float32BufferAttribute(a,2))})),Pn=1e-5;const Rn=S.forwardRef((function({args:[e=1,t=1,r=1]=[],radius:n=.05,steps:a=1,smoothness:o=4,bevelSegments:i=4,creaseAngle:s=.4,children:l,...c},u){return S.createElement("mesh",M.default({ref:u},c),S.createElement(Dn,{args:[e,t,r],radius:n,steps:a,smoothness:o,bevelSegments:i,creaseAngle:s}),l)})),Dn=S.forwardRef((function({args:[e=1,t=1,r=1]=[],radius:a=.05,steps:o=1,smoothness:i=4,bevelSegments:s=4,creaseAngle:l=.4,...u},d){const m=S.useMemo((()=>function(e,t,r){const a=new n.Shape,o=r-Pn;return a.absarc(Pn,Pn,Pn,-Math.PI/2,-Math.PI,!0),a.absarc(Pn,t-2*o,Pn,Math.PI,Math.PI/2,!0),a.absarc(e-2*o,t-2*o,Pn,Math.PI/2,0,!0),a.absarc(e-2*o,Pn,Pn,0,-Math.PI/2,!0),a}(e,t,a)),[e,t,a]),f=S.useMemo((()=>({depth:r-2*a,bevelEnabled:!0,bevelSegments:2*s,steps:o,bevelSize:a-Pn,bevelThickness:a,curveSegments:i})),[r,a,i,s,o]),p=S.useRef(null);return S.useLayoutEffect((()=>{p.current&&(p.current.center(),c.toCreasedNormals(p.current,l))}),[m,f,l]),S.useImperativeHandle(d,(()=>p.current)),S.createElement("extrudeGeometry",M.default({ref:p,args:[m,f]},u))}));function Fn(){const e=new T.BufferGeometry,t=new Float32Array([-1,-1,3,-1,-1,3]);return e.boundingSphere=new T.Sphere,e.boundingSphere.set(new T.Vector3,1/0),e.setAttribute("position",new T.BufferAttribute(t,2)),e}const kn=S.forwardRef((function({children:e,...t},r){const n=S.useMemo(Fn,[]);return S.createElement("mesh",M.default({ref:r,geometry:n,frustumCulled:!1},t),e)})),_n=S.forwardRef((({children:e,width:t,height:r,depth:n,box3:a,precise:o=!0,...i},s)=>{const l=S.useRef(null),c=S.useRef(null),u=S.useRef(null);return S.useLayoutEffect((()=>{c.current.matrixWorld.identity();let e=a||(new T.Box3).setFromObject(u.current,o);const i=e.max.x-e.min.x,s=e.max.y-e.min.y,l=e.max.z-e.min.z;let d=Math.max(i,s,l);t&&(d=i),r&&(d=s),n&&(d=l),c.current.scale.setScalar(1/d)}),[t,r,n,a,o]),S.useImperativeHandle(s,(()=>l.current),[]),S.createElement("group",M.default({ref:l},i),S.createElement("group",{ref:c},S.createElement("group",{ref:u},e)))}));var An=function(e){return e[e.NONE=0]="NONE",e[e.START=1]="START",e[e.ACTIVE=2]="ACTIVE",e}(An||{});const Ln=e=>e&&e.isOrthographicCamera,In=e=>1-Math.exp(-5*e)+.007*e,Bn=S.createContext(null);function Un({children:e,maxDuration:t=1,margin:r=1.2,observe:n,fit:o,clip:i,interpolateFunc:s=In,onFit:l}){const c=S.useRef(null),{camera:u,size:d,invalidate:m}=a.useThree(),f=a.useThree((e=>e.controls)),p=S.useRef(l);p.current=l;const h=S.useRef({camPos:new T.Vector3,camRot:new T.Quaternion,camZoom:1}),x=S.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),y=S.useRef(An.NONE),v=S.useRef(0),[g]=S.useState((()=>new T.Box3)),w=S.useMemo((()=>{function e(){const e=g.getSize(new T.Vector3),t=g.getCenter(new T.Vector3),n=Math.max(e.x,e.y,e.z),a=Ln(u)?4*n:n/(2*Math.atan(Math.PI*u.fov/360)),o=Ln(u)?4*n:a/u.aspect,i=r*Math.max(a,o);return{box:g,size:e,center:t,distance:i}}return{getSize:e,refresh(e){if((t=e)&&t.isBox3)g.copy(e);else{const t=e||c.current;if(!t)return this;t.updateWorldMatrix(!0,!0),g.setFromObject(t)}var t;if(g.isEmpty()){const e=u.position.length()||10;g.setFromCenterAndSize(new T.Vector3,new T.Vector3(e,e,e))}return h.current.camPos.copy(u.position),h.current.camRot.copy(u.quaternion),Ln(u)&&(h.current.camZoom=u.zoom),x.current.camPos=void 0,x.current.camRot=void 0,x.current.camZoom=void 0,x.current.camUp=void 0,x.current.target=void 0,this},reset(){const{center:t,distance:r}=e(),n=u.position.clone().sub(t).normalize();x.current.camPos=t.clone().addScaledVector(n,r),x.current.target=t.clone();const a=(new T.Matrix4).lookAt(x.current.camPos,x.current.target,u.up);return x.current.camRot=(new T.Quaternion).setFromRotationMatrix(a),y.current=An.START,v.current=0,this},moveTo(e){return x.current.camPos=Array.isArray(e)?new T.Vector3(...e):e.clone(),y.current=An.START,v.current=0,this},lookAt({target:e,up:t}){x.current.target=Array.isArray(e)?new T.Vector3(...e):e.clone(),x.current.camUp=t?Array.isArray(t)?new T.Vector3(...t):t.clone():u.up.clone();const r=(new T.Matrix4).lookAt(x.current.camPos||u.position,x.current.target,x.current.camUp);return x.current.camRot=(new T.Quaternion).setFromRotationMatrix(r),y.current=An.START,v.current=0,this},to({position:e,target:t}){return this.moveTo(e).lookAt({target:t})},fit(){if(!Ln(u))return this.reset();let e=0,t=0;const n=[new T.Vector3(g.min.x,g.min.y,g.min.z),new T.Vector3(g.min.x,g.max.y,g.min.z),new T.Vector3(g.min.x,g.min.y,g.max.z),new T.Vector3(g.min.x,g.max.y,g.max.z),new T.Vector3(g.max.x,g.max.y,g.max.z),new T.Vector3(g.max.x,g.max.y,g.min.z),new T.Vector3(g.max.x,g.min.y,g.max.z),new T.Vector3(g.max.x,g.min.y,g.min.z)],a=x.current.camPos||u.position,o=x.current.target||(null==f?void 0:f.target),i=x.current.camUp||u.up,s=o?(new T.Matrix4).lookAt(a,o,i).setPosition(a).invert():u.matrixWorldInverse;for(const r of n)r.applyMatrix4(s),e=Math.max(e,Math.abs(r.y)),t=Math.max(t,Math.abs(r.x));e*=2,t*=2;const l=(u.top-u.bottom)/e,c=(u.right-u.left)/t;return x.current.camZoom=Math.min(l,c)/r,y.current=An.START,v.current=0,p.current&&p.current(this.getSize()),this},clip(){const{distance:t}=e();return u.near=t/100,u.far=100*t,u.updateProjectionMatrix(),f&&(f.maxDistance=10*t,f.update()),m(),this}}}),[g,u,f,r,m]);S.useLayoutEffect((()=>{if(f){const e=()=>{if(f&&x.current.target&&y.current!==An.NONE){const e=(new T.Vector3).setFromMatrixColumn(u.matrix,2),t=h.current.camPos.distanceTo(f.target),r=(x.current.camPos||h.current.camPos).distanceTo(x.current.target),n=(1-v.current)*t+v.current*r;f.target.copy(u.position).addScaledVector(e,-n),f.update()}y.current=An.NONE};return f.addEventListener("start",e),()=>f.removeEventListener("start",e)}}),[f]);const z=S.useRef(0);return S.useLayoutEffect((()=>{(n||0==z.current++)&&(w.refresh(),o&&w.reset().fit(),i&&w.clip())}),[d,i,o,n,u,f]),a.useFrame(((e,r)=>{if(y.current===An.START)y.current=An.ACTIVE,m();else if(y.current===An.ACTIVE){if(v.current+=r/t,v.current>=1)x.current.camPos&&u.position.copy(x.current.camPos),x.current.camRot&&u.quaternion.copy(x.current.camRot),x.current.camUp&&u.up.copy(x.current.camUp),x.current.camZoom&&Ln(u)&&(u.zoom=x.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix(),f&&x.current.target&&(f.target.copy(x.current.target),f.update()),y.current=An.NONE;else{const e=s(v.current);x.current.camPos&&u.position.lerpVectors(h.current.camPos,x.current.camPos,e),x.current.camRot&&u.quaternion.slerpQuaternions(h.current.camRot,x.current.camRot,e),x.current.camUp&&u.up.set(0,1,0).applyQuaternion(u.quaternion),x.current.camZoom&&Ln(u)&&(u.zoom=(1-e)*h.current.camZoom+e*x.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix()}m()}})),S.createElement("group",{ref:c},S.createElement(Bn.Provider,{value:w},e))}function Vn(){return S.useContext(Bn)}const On=S.forwardRef((({intensity:e=1,decay:t,decayRate:r=.65,maxYaw:n=.1,maxPitch:o=.1,maxRoll:i=.1,yawFrequency:s=.1,pitchFrequency:l=.1,rollFrequency:u=.1},d)=>{const m=a.useThree((e=>e.camera)),f=a.useThree((e=>e.controls)),p=S.useRef(e),h=S.useRef(m.rotation.clone()),[x]=S.useState((()=>new c.SimplexNoise)),[y]=S.useState((()=>new c.SimplexNoise)),[v]=S.useState((()=>new c.SimplexNoise)),g=()=>{(p.current<0||p.current>1)&&(p.current=p.current<0?0:1)};return S.useImperativeHandle(d,(()=>({getIntensity:()=>p.current,setIntensity:e=>{p.current=e,g()}})),[]),S.useEffect((()=>{if(f){const e=()=>{h.current=m.rotation.clone()};return f.addEventListener("change",e),e(),()=>{f.removeEventListener("change",e)}}}),[m,f]),a.useFrame(((e,a)=>{const c=Math.pow(p.current,2),d=n*c*x.noise(e.clock.elapsedTime*s,1),f=o*c*y.noise(e.clock.elapsedTime*l,1),w=i*c*v.noise(e.clock.elapsedTime*u,1);m.rotation.set(h.current.x+f,h.current.y+d,h.current.z+w),t&&p.current>0&&(p.current-=r*a,g())})),null})),Nn=S.forwardRef((({children:e,enabled:t=!0,speed:r=1,rotationIntensity:n=1,floatIntensity:o=1,floatingRange:i=[-.1,.1],autoInvalidate:s=!1,...l},c)=>{const u=S.useRef(null);S.useImperativeHandle(c,(()=>u.current),[]);const d=S.useRef(1e4*Math.random());return a.useFrame((e=>{var a,l;if(!t||0===r)return;s&&e.invalidate();const c=d.current+e.clock.elapsedTime;u.current.rotation.x=Math.cos(c/4*r)/8*n,u.current.rotation.y=Math.sin(c/4*r)/8*n,u.current.rotation.z=Math.sin(c/4*r)/20*n;let m=Math.sin(c/4*r)/10;m=T.MathUtils.mapLinear(m,-.1,.1,null!==(a=null==i?void 0:i[0])&&void 0!==a?a:-.1,null!==(l=null==i?void 0:i[1])&&void 0!==l?l:.1),u.current.position.y=m*o,u.current.updateMatrix()})),S.createElement("group",l,S.createElement("group",{ref:u,matrixAutoUpdate:!1},e))})),jn={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},Wn="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Gn=e=>Array.isArray(e),Hn=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function $n({files:e=Hn,path:r="",preset:o,colorSpace:i,extensions:s}={}){o&&(Zn(o),e=jn[o],r=Wn);const l=Gn(e),{extension:c,isCubemap:u}=Yn(e),d=Qn(c);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+e);const m=a.useThree((e=>e.gl));t.useLayoutEffect((()=>{"webp"!==c&&"jpg"!==c&&"jpeg"!==c||m.domElement.addEventListener("webglcontextlost",(function(){a.useLoader.clear(d,l?[e]:e)}),{once:!0})}),[e,m.domElement]);const f=a.useLoader(d,l?[e]:e,(e=>{"webp"!==c&&"jpg"!==c&&"jpeg"!==c||e.setRenderer(m),null==e.setPath||e.setPath(r),s&&s(e)}));let p=l?f[0]:f;var h;"jpg"!==c&&"jpeg"!==c&&"webp"!==c||(p=null==(h=p.renderTarget)?void 0:h.texture);return p.mapping=u?n.CubeReflectionMapping:n.EquirectangularReflectionMapping,p.colorSpace=null!=i?i:u?"srgb":"srgb-linear",p}const qn={files:Hn,path:"",preset:void 0,extensions:void 0};$n.preload=e=>{const t={...qn,...e};let{files:r,path:n=""}=t;const{preset:o,extensions:i}=t;o&&(Zn(o),r=jn[o],n=Wn);const{extension:s}=Yn(r);if("webp"===s||"jpg"===s||"jpeg"===s)throw new Error("useEnvironment: Preloading gainmaps is not supported");const l=Qn(s);if(!l)throw new Error("useEnvironment: Unrecognized file extension: "+r);a.useLoader.preload(l,Gn(r)?[r]:r,(e=>{null==e.setPath||e.setPath(n),i&&i(e)}))};const Xn={files:Hn,preset:void 0};function Zn(e){if(!(e in jn))throw new Error("Preset must be one of: "+Object.keys(jn).join(", "))}function Yn(e){var t;const r=Gn(e)&&6===e.length,n=Gn(e)&&3===e.length&&e.some((e=>e.endsWith("json"))),a=Gn(e)?e[0]:e;return{extension:r?"cube":n?"webp":a.startsWith("data:application/exr")?"exr":a.startsWith("data:application/hdr")?"hdr":a.startsWith("data:image/jpeg")?"jpg":null==(t=a.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:r,isGainmap:n}}function Qn(e){return"cube"===e?n.CubeTextureLoader:"hdr"===e?c.RGBELoader:"exr"===e?c.EXRLoader:"jpg"===e||"jpeg"===e?w.HDRJPGLoader:"webp"===e?w.GainMapLoader:null}$n.clear=e=>{const t={...Xn,...e};let{files:r}=t;const{preset:n}=t;n&&(Zn(n),r=jn[n]);const{extension:o}=Yn(r),i=Qn(o);if(!i)throw new Error("useEnvironment: Unrecognized file extension: "+r);a.useLoader.clear(i,Gn(r)?[r]:r)};function Kn(e,t,r,n,o={}){var i,s,l,c;o={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...o};const u=(e=>{return(t=e).current&&t.current.isScene?e.current:e;var t})(t||r),d=u.background,m=u.environment,f={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:null!==(i=null==(s=u.backgroundRotation)||null==s.clone?void 0:s.clone())&&void 0!==i?i:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:null!==(l=null==(c=u.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==l?l:[0,0,0]};return"only"!==e&&(u.environment=n),e&&(u.background=n),a.applyProps(u,o),()=>{"only"!==e&&(u.environment=m),e&&(u.background=d),a.applyProps(u,f)}}function Jn({scene:e,background:t=!1,map:r,...n}){const o=a.useThree((e=>e.scene));return S.useLayoutEffect((()=>{if(r)return Kn(t,e,o,r,n)})),null}function ea({background:e=!1,scene:t,blur:r,backgroundBlurriness:n,backgroundIntensity:o,backgroundRotation:i,environmentIntensity:s,environmentRotation:l,...c}){const u=$n(c),d=a.useThree((e=>e.scene));return S.useLayoutEffect((()=>Kn(e,t,d,u,{backgroundBlurriness:null!=r?r:n,backgroundIntensity:o,backgroundRotation:i,environmentIntensity:s,environmentRotation:l}))),S.useEffect((()=>()=>{u.dispose()}),[u]),null}function ta({children:e,near:t=.1,far:r=1e3,resolution:o=256,frames:i=1,map:s,background:l=!1,blur:c,backgroundBlurriness:u,backgroundIntensity:d,backgroundRotation:m,environmentIntensity:f,environmentRotation:p,scene:h,files:x,path:y,preset:v,extensions:g}){const w=a.useThree((e=>e.gl)),z=a.useThree((e=>e.scene)),b=S.useRef(null),[E]=S.useState((()=>new n.Scene)),M=S.useMemo((()=>{const e=new n.WebGLCubeRenderTarget(o);return e.texture.type=n.HalfFloatType,e}),[o]);S.useEffect((()=>()=>{M.dispose()}),[M]),S.useLayoutEffect((()=>{if(1===i){const e=w.autoClear;w.autoClear=!0,b.current.update(w,E),w.autoClear=e}return Kn(l,h,z,M.texture,{backgroundBlurriness:null!=c?c:u,backgroundIntensity:d,backgroundRotation:m,environmentIntensity:f,environmentRotation:p})}),[e,E,M.texture,h,z,l,i,w]);let C=1;return a.useFrame((()=>{if(i===1/0||C<i){const e=w.autoClear;w.autoClear=!0,b.current.update(w,E),w.autoClear=e,C++}})),S.createElement(S.Fragment,null,a.createPortal(S.createElement(S.Fragment,null,e,S.createElement("cubeCamera",{ref:b,args:[t,r,M]}),x||v?S.createElement(ea,{background:!0,files:x,preset:v,path:y,extensions:g}):s?S.createElement(Jn,{background:!0,map:s,extensions:g}):null),E))}function ra(e){var t,r,n,o;const i=$n(e),s=e.map||i;S.useMemo((()=>a.extend({GroundProjectedEnvImpl:c.GroundProjectedEnv})),[]),S.useEffect((()=>()=>{i.dispose()}),[i]);const l=S.useMemo((()=>[s]),[s]),u=null==(t=e.ground)?void 0:t.height,d=null==(r=e.ground)?void 0:r.radius,m=null!==(n=null==(o=e.ground)?void 0:o.scale)&&void 0!==n?n:1e3;return S.createElement(S.Fragment,null,S.createElement(Jn,M.default({},e,{map:s})),S.createElement("groundProjectedEnvImpl",{args:l,scale:m,height:u,radius:d}))}function na(e){return e.ground?S.createElement(ra,e):e.map?S.createElement(Jn,e):e.children?S.createElement(ta,e):S.createElement(ea,e)}const aa=S.forwardRef((({scale:e=10,frames:t=1/0,opacity:r=1,width:n=1,height:o=1,blur:i=1,near:s=0,far:l=10,resolution:u=512,smooth:d=!0,color:m="#000000",depthWrite:f=!1,renderOrder:p,...h},x)=>{const y=S.useRef(null),v=a.useThree((e=>e.scene)),g=a.useThree((e=>e.gl)),w=S.useRef(null);n*=Array.isArray(e)?e[0]:e||1,o*=Array.isArray(e)?e[1]:e||1;const[z,b,E,C,P,R,D]=S.useMemo((()=>{const e=new T.WebGLRenderTarget(u,u),t=new T.WebGLRenderTarget(u,u);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;const r=new T.PlaneGeometry(n,o).rotateX(Math.PI/2),a=new T.Mesh(r),i=new T.MeshDepthMaterial;i.depthTest=i.depthWrite=!1,i.onBeforeCompile=e=>{e.uniforms={...e.uniforms,ucolor:{value:new T.Color(m)}},e.fragmentShader=e.fragmentShader.replace("void main() {","uniform vec3 ucolor;\n           void main() {\n          "),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const s=new T.ShaderMaterial(c.HorizontalBlurShader),l=new T.ShaderMaterial(c.VerticalBlurShader);return l.depthTest=s.depthTest=!1,[e,r,i,a,s,l,t]}),[u,n,o,e,m]),F=e=>{C.visible=!0,C.material=P,P.uniforms.tDiffuse.value=z.texture,P.uniforms.h.value=1*e/256,g.setRenderTarget(D),g.render(C,w.current),C.material=R,R.uniforms.tDiffuse.value=D.texture,R.uniforms.v.value=1*e/256,g.setRenderTarget(z),g.render(C,w.current),C.visible=!1};let k,_,A=0;return a.useFrame((()=>{w.current&&(t===1/0||A<t)&&(A++,k=v.background,_=v.overrideMaterial,y.current.visible=!1,v.background=null,v.overrideMaterial=E,g.setRenderTarget(z),g.render(v,w.current),F(i),d&&F(.4*i),g.setRenderTarget(null),y.current.visible=!0,v.overrideMaterial=_,v.background=k)})),S.useImperativeHandle(x,(()=>y.current),[]),S.createElement("group",M.default({"rotation-x":Math.PI/2},h,{ref:y}),S.createElement("mesh",{renderOrder:p,geometry:b,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},S.createElement("meshBasicMaterial",{transparent:!0,map:z.texture,opacity:r,depthWrite:f})),S.createElement("orthographicCamera",{ref:w,args:[-n/2,n/2,o/2,-o/2,s,l]}))}));const oa=S.createContext(null),ia=Ee({color:new T.Color,blend:2,alphaTest:.75,opacity:0,map:null},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vUv = uv;\n   }",`varying vec2 vUv;\n   uniform sampler2D map;\n   uniform vec3 color;\n   uniform float opacity;\n   uniform float alphaTest;\n   uniform float blend;\n   void main() {\n     vec4 sampledDiffuseColor = texture2D(map, vUv);\n     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);\n     #include <tonemapping_fragment>\n     #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),sa=S.forwardRef((({children:e,temporal:t,frames:r=40,limit:n=1/0,blend:o=20,scale:i=10,opacity:s=1,alphaTest:l=.75,color:c="black",colorBlend:u=2,resolution:d=1024,toneMapped:m=!0,...f},p)=>{a.extend({SoftShadowMaterial:ia});const h=a.useThree((e=>e.gl)),x=a.useThree((e=>e.scene)),y=a.useThree((e=>e.camera)),v=a.useThree((e=>e.invalidate)),g=S.useRef(null),w=S.useRef(null),[z]=S.useState((()=>new ca(h,x,d)));S.useLayoutEffect((()=>{z.configure(g.current)}),[]);const b=S.useMemo((()=>({lights:new Map,temporal:!!t,frames:Math.max(2,r),blend:Math.max(2,r===1/0?o:r),count:0,getMesh:()=>g.current,reset:()=>{z.clear();const e=g.current.material;e.opacity=0,e.alphaTest=0,b.count=0},update:(e=1)=>{const t=g.current.material;b.temporal?(t.opacity=Math.min(s,t.opacity+s/b.blend),t.alphaTest=Math.min(l,t.alphaTest+l/b.blend)):(t.opacity=s,t.alphaTest=l),w.current.visible=!0,z.prepare();for(let t=0;t<e;t++)b.lights.forEach((e=>e.update())),z.update(y,b.blend);w.current.visible=!1,z.finish()}})),[z,y,x,t,r,o,s,l]);return S.useLayoutEffect((()=>{b.reset(),b.temporal||b.frames===1/0||b.update(b.blend)})),S.useImperativeHandle(p,(()=>b),[b]),a.useFrame((()=>{(b.temporal||b.frames===1/0)&&b.count<b.frames&&b.count<n&&(v(),b.update(),b.count++)})),S.createElement("group",f,S.createElement("group",{traverse:()=>null,ref:w},S.createElement(oa.Provider,{value:b},e)),S.createElement("mesh",{receiveShadow:!0,ref:g,scale:i,rotation:[-Math.PI/2,0,0]},S.createElement("planeGeometry",null),S.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:m,color:c,blend:u,map:z.progressiveLightMap2.texture})))})),la=S.forwardRef((({castShadow:e=!0,bias:t=.001,mapSize:r=512,size:n=5,near:a=.5,far:o=500,frames:i=1,position:s=[0,0,0],radius:l=1,amount:c=8,intensity:u=(Ce>=155?Math.PI:1),ambient:d=.5,...m},f)=>{const p=S.useRef(null),h=new T.Vector3(...s).length(),x=S.useContext(oa),y=S.useCallback((()=>{let e;if(p.current)for(let t=0;t<p.current.children.length;t++)if(e=p.current.children[t],Math.random()>d)e.position.set(s[0]+T.MathUtils.randFloatSpread(l),s[1]+T.MathUtils.randFloatSpread(l),s[2]+T.MathUtils.randFloatSpread(l));else{let t=Math.acos(2*Math.random()-1)-Math.PI/2,r=2*Math.PI*Math.random();e.position.set(Math.cos(t)*Math.cos(r)*h,Math.abs(Math.cos(t)*Math.sin(r)*h),Math.sin(t)*h)}}),[l,d,h,...s]),v=S.useMemo((()=>({update:y})),[y]);return S.useImperativeHandle(f,(()=>v),[v]),S.useLayoutEffect((()=>{var e;const t=p.current;return x&&(null==(e=x.lights)||e.set(t.uuid,v)),()=>{var e;null==x||null==(e=x.lights)||e.delete(t.uuid)}}),[x,v]),S.createElement("group",M.default({ref:p},m),Array.from({length:c},((i,s)=>S.createElement("directionalLight",{key:s,castShadow:e,"shadow-bias":t,"shadow-mapSize":[r,r],intensity:u/c},S.createElement("orthographicCamera",{attach:"shadow-camera",args:[-n,n,n,-n,a,o]})))))}));class ca{constructor(e,t,r=1024){this.renderer=e,this.res=r,this.scene=t,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new T.Color,this.clearAlpha=0;const n={type:T.HalfFloatType,magFilter:T.NearestFilter,minFilter:T.NearestFilter};this.progressiveLightMap1=new T.WebGLRenderTarget(this.res,this.res,n),this.progressiveLightMap2=new T.WebGLRenderTarget(this.res,this.res,n),this.discardMat=new Jr,this.targetMat=new T.MeshLambertMaterial({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=e=>{e.vertexShader="varying vec2 vUv;\n"+e.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const t=e.fragmentShader.indexOf("void main() {");e.fragmentShader="varying vec2 vUv;\n"+e.fragmentShader.slice(0,t)+"uniform sampler2D previousShadowMap;\n\tuniform float averagingWindow;\n"+e.fragmentShader.slice(t-1,-1)+"\nvec3 texelOld = texture2D(previousShadowMap, vUv).rgb;\n        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);\n      }",e.uniforms.previousShadowMap=this.previousShadowMap,e.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse((e=>{!function(e){return!!e.geometry}(e)?function(e){return e.isLight}(e)&&this.lights.push({object:e,intensity:e.intensity}):this.meshes.push({object:e,material:e.material})}))}prepare(){this.lights.forEach((e=>e.object.intensity=0)),this.meshes.forEach((e=>e.object.material=this.discardMat))}finish(){this.lights.forEach((e=>e.object.intensity=e.intensity)),this.meshes.forEach((e=>e.object.material=e.material))}configure(e){this.object=e}update(e,t=100){if(!this.object)return;this.averagingWindow.value=t,this.object.material=this.targetMat;const r=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,n=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,a=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(r),this.previousShadowMap.value=n.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=a}}const ua={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function da({radius:e,adjustCamera:t}){const r=Vn();return S.useEffect((()=>{t&&r.refresh().clip().fit()}),[e,t]),null}const ma=e=>0===e?0:Math.pow(2,10*e-10);const fa=S.forwardRef((({fog:e=!1,renderOrder:t,depthWrite:r=!1,colorStop:a=0,color:o="black",opacity:i=.5,...s},l)=>{const c=S.useMemo((()=>{const e=document.createElement("canvas");e.width=128,e.height=128;const t=e.getContext("2d"),r=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return r.addColorStop(a,new n.Color(o).getStyle()),r.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height),e}),[o,a]);return S.createElement("mesh",M.default({renderOrder:t,ref:l,"rotation-x":-Math.PI/2},s),S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,opacity:i,fog:e,depthWrite:r,side:n.DoubleSide},S.createElement("canvasTexture",{attach:"map",args:[c]})))}));function pa(e=T.FrontSide){const t={value:new T.Matrix4};return Object.assign(new T.MeshNormalMaterial({side:e}),{viewMatrix:t,onBeforeCompile:e=>{e.uniforms.viewMatrix=t,e.fragmentShader="vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n           return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n         }\n"+e.fragmentShader.replace("#include <normal_fragment_maps>","#include <normal_fragment_maps>\n           normal = inverseTransformDirection( normal, viewMatrix );\n")}})}const ha=Ee({causticsTexture:null,causticsTextureB:null,color:new T.Color,lightProjMatrix:new T.Matrix4,lightViewMatrix:new T.Matrix4},"varying vec3 vWorldPosition;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vec4 worldPosition = modelMatrix * vec4(position, 1.);\n     vWorldPosition = worldPosition.xyz;\n   }",`varying vec3 vWorldPosition;\n  uniform vec3 color;\n  uniform sampler2D causticsTexture;\n  uniform sampler2D causticsTextureB;\n  uniform mat4 lightProjMatrix;\n  uniform mat4 lightViewMatrix;\n   void main() {\n    // Apply caustics\n    vec4 lightSpacePos = lightProjMatrix * lightViewMatrix * vec4(vWorldPosition, 1.0);\n    lightSpacePos.xyz /= lightSpacePos.w;\n    lightSpacePos.xyz = lightSpacePos.xyz * 0.5 + 0.5;\n    vec3 front = texture2D(causticsTexture, lightSpacePos.xy).rgb;\n    vec3 back = texture2D(causticsTextureB, lightSpacePos.xy).rgb;\n    gl_FragColor = vec4((front + back) * color, 1.0);\n    #include <tonemapping_fragment>\n    #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),xa=Ee({cameraMatrixWorld:new T.Matrix4,cameraProjectionMatrixInv:new T.Matrix4,normalTexture:null,depthTexture:null,lightDir:new T.Vector3(0,1,0),lightPlaneNormal:new T.Vector3(0,1,0),lightPlaneConstant:0,near:.1,far:100,modelMatrix:new T.Matrix4,worldRadius:1/40,ior:1.1,bounces:0,resolution:1024,size:10,intensity:.5},"\n  varying vec2 vUv;\n  void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }","\n  uniform mat4 cameraMatrixWorld;\n  uniform mat4 cameraProjectionMatrixInv;\n  uniform vec3 lightDir;\n  uniform vec3 lightPlaneNormal;\n  uniform float lightPlaneConstant;\n  uniform float near;\n  uniform float far;\n  uniform float time;\n  uniform float worldRadius;\n  uniform float resolution;\n  uniform float size;\n  uniform float intensity;\n  uniform float ior;\n  precision highp isampler2D;\n  precision highp usampler2D;\n  uniform sampler2D normalTexture;\n  uniform sampler2D depthTexture;\n  uniform float bounces;\n  varying vec2 vUv;\n  vec3 WorldPosFromDepth(float depth, vec2 coord) {\n    float z = depth * 2.0 - 1.0;\n    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n    vec4 viewSpacePosition = cameraProjectionMatrixInv * clipSpacePosition;\n    // Perspective division\n    viewSpacePosition /= viewSpacePosition.w;\n    vec4 worldSpacePosition = cameraMatrixWorld * viewSpacePosition;\n    return worldSpacePosition.xyz;\n  }\n  float sdPlane( vec3 p, vec3 n, float h ) {\n    // n must be normalized\n    return dot(p,n) + h;\n  }\n  float planeIntersect( vec3 ro, vec3 rd, vec4 p ) {\n    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);\n  }\n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 pos, vec3 normal, float ior, out vec3 rayOrigin, out vec3 rayDirection) {\n    rayOrigin = ro;\n    rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = pos + rayDirection * 0.1;\n    return rayDirection;\n  }\n  void main() {\n    // Each sample consists of random offset in the x and y direction\n    float caustic = 0.0;\n    float causticTexelSize = (1.0 / resolution) * size * 2.0;\n    float texelsNeeded = worldRadius / causticTexelSize;\n    float sampleRadius = texelsNeeded / resolution;\n    float sum = 0.0;\n    if (texture2D(depthTexture, vUv).x == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec2 offset1 = vec2(-0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset2 = vec2(-0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset3 = vec2(0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset4 = vec2(0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 uv1 = vUv + offset1 * sampleRadius;\n    vec2 uv2 = vUv + offset2 * sampleRadius;\n    vec2 uv3 = vUv + offset3 * sampleRadius;\n    vec2 uv4 = vUv + offset4 * sampleRadius;\n    vec3 normal1 = texture2D(normalTexture, uv1, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal2 = texture2D(normalTexture, uv2, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal3 = texture2D(normalTexture, uv3, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal4 = texture2D(normalTexture, uv4, -10.0).rgb * 2.0 - 1.0;\n    float depth1 = texture2D(depthTexture, uv1, -10.0).x;\n    float depth2 = texture2D(depthTexture, uv2, -10.0).x;\n    float depth3 = texture2D(depthTexture, uv3, -10.0).x;\n    float depth4 = texture2D(depthTexture, uv4, -10.0).x;\n    // Sanity check the depths\n    if (depth1 == 1.0 || depth2 == 1.0 || depth3 == 1.0 || depth4 == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec3 pos1 = WorldPosFromDepth(depth1, uv1);\n    vec3 pos2 = WorldPosFromDepth(depth2, uv2);\n    vec3 pos3 = WorldPosFromDepth(depth3, uv3);\n    vec3 pos4 = WorldPosFromDepth(depth4, uv4);\n    vec3 originPos1 = WorldPosFromDepth(0.0, uv1);\n    vec3 originPos2 = WorldPosFromDepth(0.0, uv2);\n    vec3 originPos3 = WorldPosFromDepth(0.0, uv3);\n    vec3 originPos4 = WorldPosFromDepth(0.0, uv4);\n    vec3 endPos1, endPos2, endPos3, endPos4;\n    vec3 endDir1, endDir2, endDir3, endDir4;\n    totalInternalReflection(originPos1, lightDir, pos1, normal1, ior, endPos1, endDir1);\n    totalInternalReflection(originPos2, lightDir, pos2, normal2, ior, endPos2, endDir2);\n    totalInternalReflection(originPos3, lightDir, pos3, normal3, ior, endPos3, endDir3);\n    totalInternalReflection(originPos4, lightDir, pos4, normal4, ior, endPos4, endDir4);\n    float lightPosArea = length(cross(originPos2 - originPos1, originPos3 - originPos1)) + length(cross(originPos3 - originPos1, originPos4 - originPos1));\n    float t1 = planeIntersect(endPos1, endDir1, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t2 = planeIntersect(endPos2, endDir2, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t3 = planeIntersect(endPos3, endDir3, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t4 = planeIntersect(endPos4, endDir4, vec4(lightPlaneNormal, lightPlaneConstant));\n    vec3 finalPos1 = endPos1 + endDir1 * t1;\n    vec3 finalPos2 = endPos2 + endDir2 * t2;\n    vec3 finalPos3 = endPos3 + endDir3 * t3;\n    vec3 finalPos4 = endPos4 + endDir4 * t4;\n    float finalArea = length(cross(finalPos2 - finalPos1, finalPos3 - finalPos1)) + length(cross(finalPos3 - finalPos1, finalPos4 - finalPos1));\n    caustic += intensity * (lightPosArea / finalArea);\n    // Calculate the area of the triangle in light spaces\n    gl_FragColor = vec4(vec3(max(caustic, 0.0)), 1.0);\n  }"),ya={depth:!0,minFilter:T.LinearFilter,magFilter:T.LinearFilter,type:T.UnsignedByteType},va={minFilter:T.LinearMipmapLinearFilter,magFilter:T.LinearFilter,type:T.FloatType,generateMipmaps:!0},ga=S.forwardRef((({debug:e,children:t,frames:r=1,ior:n=1.1,color:o="white",causticsOnly:i=!1,backside:s=!1,backsideIOR:l=1.1,worldRadius:u=.3125,intensity:d=.05,resolution:m=2024,lightSource:f=[5,5,5],...p},h)=>{a.extend({CausticsProjectionMaterial:ha});const x=S.useRef(null),y=S.useRef(null),v=S.useRef(null),g=S.useRef(null),w=a.useThree((e=>e.gl)),z=lr(e&&y,T.CameraHelper),b=rt(m,m,ya),E=rt(m,m,ya),C=rt(m,m,va),P=rt(m,m,va),[R]=S.useState((()=>pa())),[D]=S.useState((()=>pa(T.BackSide))),[F]=S.useState((()=>new xa)),[k]=S.useState((()=>new c.FullScreenQuad(F)));S.useLayoutEffect((()=>{x.current.updateWorldMatrix(!1,!0)}));let _=0;const A=new T.Vector3,L=new T.Frustum,I=new T.Matrix4,B=new T.Plane,U=new T.Vector3,V=new T.Vector3,O=new T.Box3,N=new T.Vector3,j=[],W=[],G=[],H=[],$=new T.Vector3;for(let e=0;e<8;e++)j.push(new T.Vector3),W.push(new T.Vector3),G.push(new T.Vector3),H.push(new T.Vector3);return a.useFrame((()=>{if(r===1/0||_++<r){var t,a;Array.isArray(f)?U.fromArray(f).normalize():U.copy(x.current.worldToLocal(f.current.getWorldPosition(A)).normalize()),V.copy(U).multiplyScalar(-1),null==(t=v.current.parent)||t.matrixWorld.identity(),O.setFromObject(v.current,!0),j[0].set(O.min.x,O.min.y,O.min.z),j[1].set(O.min.x,O.min.y,O.max.z),j[2].set(O.min.x,O.max.y,O.min.z),j[3].set(O.min.x,O.max.y,O.max.z),j[4].set(O.max.x,O.min.y,O.min.z),j[5].set(O.max.x,O.min.y,O.max.z),j[6].set(O.max.x,O.max.y,O.min.z),j[7].set(O.max.x,O.max.y,O.max.z);for(let e=0;e<8;e++)W[e].copy(j[e]);O.getCenter(N),j.map((e=>e.sub(N)));const r=B.set(V,0);j.map(((e,t)=>r.projectPoint(e,G[t])));const o=G.reduce(((e,t)=>e.add(t)),A.set(0,0,0)).divideScalar(G.length),c=G.map((e=>e.distanceTo(o))).reduce(((e,t)=>Math.max(e,t))),p=j.map((e=>e.dot(U))).reduce(((e,t)=>Math.max(e,t)));y.current.position.copy($.copy(U).multiplyScalar(p).add(N)),y.current.lookAt(v.current.localToWorld(N));const h=I.lookAt(y.current.position,N,A.set(0,1,0));y.current.left=-c,y.current.right=c,y.current.top=c,y.current.bottom=-c;const M=A.set(0,c,0).applyMatrix4(h),S=(y.current.position.y+M.y)/U.y;y.current.near=.1,y.current.far=S,y.current.updateProjectionMatrix(),y.current.updateMatrixWorld();const T=W.map(((e,t)=>e.add(H[t].copy(U).multiplyScalar(-e.y/U.y)))),_=T.reduce(((e,t)=>e.add(t)),A.set(0,0,0)).divideScalar(T.length),q=2*T.map((e=>Math.hypot(e.x-_.x,e.z-_.z))).reduce(((e,t)=>Math.max(e,t)));g.current.scale.setScalar(q),g.current.position.copy(_),e&&(null==(a=z.current)||a.update()),D.viewMatrix.value=R.viewMatrix.value=y.current.matrixWorldInverse;const X=L.setFromProjectionMatrix(I.multiplyMatrices(y.current.projectionMatrix,y.current.matrixWorldInverse)).planes[4];F.cameraMatrixWorld=y.current.matrixWorld,F.cameraProjectionMatrixInv=y.current.projectionMatrixInverse,F.lightDir=V,F.lightPlaneNormal=X.normal,F.lightPlaneConstant=X.constant,F.near=y.current.near,F.far=y.current.far,F.resolution=m,F.size=c,F.intensity=d,F.worldRadius=u,v.current.visible=!0,w.setRenderTarget(b),w.clear(),v.current.overrideMaterial=R,w.render(v.current,y.current),w.setRenderTarget(E),w.clear(),s&&(v.current.overrideMaterial=D,w.render(v.current,y.current)),v.current.overrideMaterial=null,F.ior=n,g.current.material.lightProjMatrix=y.current.projectionMatrix,g.current.material.lightViewMatrix=y.current.matrixWorldInverse,F.normalTexture=b.texture,F.depthTexture=b.depthTexture,w.setRenderTarget(C),w.clear(),k.render(w),F.ior=l,F.normalTexture=E.texture,F.depthTexture=E.depthTexture,w.setRenderTarget(P),w.clear(),s&&k.render(w),w.setRenderTarget(null),i&&(v.current.visible=!1)}})),S.useImperativeHandle(h,(()=>x.current),[]),S.createElement("group",M.default({ref:x},p),S.createElement("scene",{ref:v},S.createElement("orthographicCamera",{ref:y,up:[0,1,0]}),t),S.createElement("mesh",{renderOrder:2,ref:g,"rotation-x":-Math.PI/2},S.createElement("planeGeometry",null),S.createElement("causticsProjectionMaterial",{transparent:!0,color:o,causticsTexture:C.texture,causticsTextureB:P.texture,blending:T.CustomBlending,blendSrc:T.OneFactor,blendDst:T.SrcAlphaFactor,depthWrite:!1}),e&&S.createElement(ke,null,S.createElement("lineBasicMaterial",{color:"#ffff00",toneMapped:!1}))))}));class wa extends T.ShaderMaterial{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new T.Vector3(0,0,0)},lightColor:{value:new T.Color("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new T.Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:"\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n        uniform vec3 spotPosition;\n        uniform float attenuation;\n\n        #include <common>\n        #include <logdepthbuf_pars_vertex>\n\n        void main() {\n          // compute intensity\n          vNormal = normalize(normalMatrix * normal);\n          vec4 worldPosition = modelMatrix * vec4(position, 1);\n          vec4 viewPosition = viewMatrix * worldPosition;\n          vViewZ = viewPosition.z;\n\n          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);\n\n          gl_Position = projectionMatrix * viewPosition;\n\n          #include <logdepthbuf_vertex>\n        }\n      ",fragmentShader:`\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n\n        uniform vec3 lightColor;\n        uniform float anglePower;\n        uniform sampler2D depth;\n        uniform vec2 resolution;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float opacity;\n\n        #include <packing>\n        #include <logdepthbuf_pars_fragment>\n\n        float readDepth(sampler2D depthSampler, vec2 uv) {\n          float fragCoordZ = texture(depthSampler, uv).r;\n\n          // https://github.com/mrdoob/three.js/issues/23072\n          #ifdef USE_LOGDEPTHBUF\n            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));\n          #else\n            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n          #endif\n\n          return viewZ;\n        }\n\n        void main() {\n          #include <logdepthbuf_fragment>\n\n          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));\n          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);\n          float intensity = vIntensity * angleIntensity;\n\n          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry\n          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;\n          if (isSoft) {\n            vec2 uv = gl_FragCoord.xy / resolution;\n            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));\n          }\n\n          gl_FragColor = vec4(lightColor, intensity * opacity);\n\n          #include <tonemapping_fragment>\n          #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}}function za({opacity:e=1,radiusTop:t,radiusBottom:r,depthBuffer:o,color:i="white",distance:s=5,angle:l=.15,attenuation:c=5,anglePower:u=5}){const d=S.useRef(null),m=a.useThree((e=>e.size)),f=a.useThree((e=>e.camera)),p=a.useThree((e=>e.viewport.dpr)),[h]=S.useState((()=>new wa)),[x]=S.useState((()=>new n.Vector3));t=void 0===t?.1:t,r=void 0===r?7*l:r,a.useFrame((()=>{h.uniforms.spotPosition.value.copy(d.current.getWorldPosition(x)),d.current.lookAt(d.current.parent.target.getWorldPosition(x))}));const y=S.useMemo((()=>{const e=new n.CylinderGeometry(t,r,s,128,64,!0);return e.applyMatrix4((new n.Matrix4).makeTranslation(0,-s/2,0)),e.applyMatrix4((new n.Matrix4).makeRotationX(-Math.PI/2)),e}),[s,t,r]);return S.createElement(S.Fragment,null,S.createElement("mesh",{ref:d,geometry:y,raycast:()=>null},S.createElement("primitive",{object:h,attach:"material","uniforms-opacity-value":e,"uniforms-lightColor-value":i,"uniforms-attenuation-value":c,"uniforms-anglePower-value":u,"uniforms-depth-value":o,"uniforms-cameraNear-value":f.near,"uniforms-cameraFar-value":f.far,"uniforms-resolution-value":o?[m.width*p,m.height*p]:[0,0]})))}function ba(e,t,r,o,i){const[[s,l]]=S.useState((()=>[new n.Vector3,new n.Vector3]));S.useLayoutEffect((()=>{if(!(null==(t=e.current)?void 0:t.isSpotLight))throw new Error("SpotlightShadow must be a child of a SpotLight");var t;e.current.shadow.mapSize.set(r,o),e.current.shadow.needsUpdate=!0}),[e,r,o]),a.useFrame((()=>{if(!e.current)return;const r=e.current.position,n=e.current.target.position;l.copy(n).sub(r);var a=l.length();l.normalize().multiplyScalar(a*i),s.copy(r).add(l),t.current.position.copy(s),t.current.lookAt(e.current.target.position)}))}function Ea({distance:e=.4,alphaTest:t=.5,map:r,shader:o="#define GLSLIFY 1\nvarying vec2 vUv;uniform sampler2D uShadowMap;uniform float uTime;void main(){vec3 color=texture2D(uShadowMap,vUv).xyz;gl_FragColor=vec4(color,1.);}",width:i=512,height:s=512,scale:l=1,children:u,...d}){const m=S.useRef(null),f=d.spotlightRef,p=d.debug;ba(f,m,i,s,e);const h=S.useMemo((()=>new n.WebGLRenderTarget(i,s,{format:n.RGBAFormat,stencilBuffer:!1})),[i,s]),x=S.useRef({uShadowMap:{value:r},uTime:{value:0}});S.useEffect((()=>{x.current.uShadowMap.value=r}),[r]);const y=S.useMemo((()=>new c.FullScreenQuad(new n.ShaderMaterial({uniforms:x.current,vertexShader:"\n          varying vec2 vUv;\n\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n          ",fragmentShader:o}))),[o]);return S.useEffect((()=>()=>{y.material.dispose(),y.dispose()}),[y]),S.useEffect((()=>()=>h.dispose()),[h]),a.useFrame((({gl:e},t)=>{x.current.uTime.value+=t,e.setRenderTarget(h),y.render(e),e.setRenderTarget(null)})),S.createElement(S.Fragment,null,S.createElement("mesh",{ref:m,scale:l,castShadow:!0},S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,side:n.DoubleSide,alphaTest:t,alphaMap:h.texture,"alphaMap-wrapS":n.RepeatWrapping,"alphaMap-wrapT":n.RepeatWrapping,opacity:p?1:0},u)))}function Ma({distance:e=.4,alphaTest:t=.5,map:r,width:a=512,height:o=512,scale:i,children:s,...l}){const c=S.useRef(null),u=l.spotlightRef,d=l.debug;return ba(u,c,a,o,e),S.createElement(S.Fragment,null,S.createElement("mesh",{ref:c,scale:i,castShadow:!0},S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,side:n.DoubleSide,alphaTest:t,alphaMap:r,"alphaMap-wrapS":n.RepeatWrapping,"alphaMap-wrapT":n.RepeatWrapping,opacity:d?1:0},s)))}const Sa=S.forwardRef((({opacity:e=1,radiusTop:t,radiusBottom:r,depthBuffer:n,color:a="white",distance:o=5,angle:i=.15,attenuation:s=5,anglePower:l=5,volumetric:c=!0,debug:u=!1,children:d,...m},f)=>{const p=S.useRef(null);return S.useImperativeHandle(f,(()=>p.current),[]),S.createElement("group",null,u&&p.current&&S.createElement("spotLightHelper",{args:[p.current]}),S.createElement("spotLight",M.default({ref:p,angle:i,color:a,distance:o,castShadow:!0},m),c&&S.createElement(za,{debug:u,opacity:e,radiusTop:t,radiusBottom:r,depthBuffer:n,color:a,distance:o,angle:i,attenuation:s,anglePower:l})),d&&S.cloneElement(d,{spotlightRef:p,debug:u}))})),Ca=S.forwardRef((({light:e,args:t,map:r,toneMapped:n=!1,color:o="white",form:i="rect",intensity:s=1,scale:l=1,target:c=[0,0,0],children:u,...d},m)=>{const f=S.useRef(null);return S.useImperativeHandle(m,(()=>f.current),[]),S.useLayoutEffect((()=>{u||d.material||(a.applyProps(f.current.material,{color:o}),f.current.material.color.multiplyScalar(s))}),[o,s,u,d.material]),S.useLayoutEffect((()=>{d.rotation||f.current.quaternion.identity(),c&&!d.rotation&&("boolean"==typeof c?f.current.lookAt(0,0,0):f.current.lookAt(Array.isArray(c)?new T.Vector3(...c):c))}),[c,d.rotation]),l=Array.isArray(l)&&2===l.length?[l[0],l[1],1]:l,S.createElement("mesh",M.default({ref:f,scale:l},d),"circle"===i?S.createElement("ringGeometry",{args:t||[0,.5,64]}):"ring"===i?S.createElement("ringGeometry",{args:t||[.25,.5,64]}):"rect"===i||"plane"===i?S.createElement("planeGeometry",{args:t||[1,1]}):"box"===i?S.createElement("boxGeometry",{args:t||[1,1,1]}):S.createElement(i,{args:t}),u||S.createElement("meshBasicMaterial",{toneMapped:n,map:r,side:T.DoubleSide}),e&&S.createElement("pointLight",M.default({castShadow:!0},e)))}));function Ta(e,t,r=new n.Vector3){const a=Math.PI*(e-.5),o=2*Math.PI*(t-.5);return r.x=Math.cos(o),r.y=Math.sin(a),r.z=Math.sin(o),r}const Pa=S.forwardRef((({inclination:e=.6,azimuth:t=.1,distance:r=1e3,mieCoefficient:a=.005,mieDirectionalG:o=.8,rayleigh:i=.5,turbidity:s=10,sunPosition:l=Ta(e,t),...u},d)=>{const m=S.useMemo((()=>(new n.Vector3).setScalar(r)),[r]),[f]=S.useState((()=>new c.Sky));return S.createElement("primitive",M.default({object:f,ref:d,"material-uniforms-mieCoefficient-value":a,"material-uniforms-mieDirectionalG-value":o,"material-uniforms-rayleigh-value":i,"material-uniforms-sunPosition-value":l,"material-uniforms-turbidity-value":s,scale:m},u))}));class Ra extends n.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:`\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n\n        #include <tonemapping_fragment>\n\t      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n      }`})}}const Da=e=>(new n.Vector3).setFromSpherical(new n.Spherical(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),Fa=S.forwardRef((({radius:e=100,depth:t=50,count:r=5e3,saturation:o=0,factor:i=4,fade:s=!1,speed:l=1},c)=>{const u=S.useRef(null),[d,m,f]=S.useMemo((()=>{const a=[],s=[],l=Array.from({length:r},(()=>(.5+.5*Math.random())*i)),c=new n.Color;let u=e+t;const d=t/r;for(let e=0;e<r;e++)u-=d*Math.random(),a.push(...Da(u).toArray()),c.setHSL(e/r,o,.9),s.push(c.r,c.g,c.b);return[new Float32Array(a),new Float32Array(s),new Float32Array(l)]}),[r,t,i,e,o]);a.useFrame((e=>u.current&&(u.current.uniforms.time.value=e.clock.elapsedTime*l)));const[p]=S.useState((()=>new Ra));return S.createElement("points",{ref:c},S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[d,3]}),S.createElement("bufferAttribute",{attach:"attributes-color",args:[m,3]}),S.createElement("bufferAttribute",{attach:"attributes-size",args:[f,1]})),S.createElement("primitive",{ref:u,object:p,attach:"material",blending:n.AdditiveBlending,"uniforms-fade-value":s,depthWrite:!1,transparent:!0,vertexColors:!0}))})),ka=new n.Matrix4,_a=new n.Vector3,Aa=new n.Quaternion,La=new n.Vector3,Ia=new n.Quaternion,Ba=new n.Vector3,Ua=S.createContext(null),Va=S.forwardRef((({children:e,material:t=n.MeshLambertMaterial,texture:r="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",range:o,limit:i=200,frustumCulled:s,...l},c)=>{var u,d;const m=S.useMemo((()=>class extends t{constructor(){super();const e=parseInt(n.REVISION.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=t=>{t.vertexShader="attribute float cloudOpacity;\n               varying float vOpacity;\n              "+t.vertexShader.replace("#include <fog_vertex>","#include <fog_vertex>\n                 vOpacity = cloudOpacity;\n                "),t.fragmentShader="varying float vOpacity;\n              "+t.fragmentShader.replace(`#include <${e}>`,`#include <${e}>\n                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);\n                `)}}}),[t]);a.extend({CloudMaterial:m});const f=S.useRef(null),p=S.useRef([]),h=S.useMemo((()=>new Float32Array(Array.from({length:i},(()=>1)))),[i]),x=S.useMemo((()=>new Float32Array(Array.from({length:i},(()=>[1,1,1])).flat())),[i]),y=Se(r);let v,g=0,w=0;const z=new n.Quaternion,b=new n.Vector3(0,0,1),E=new n.Vector3;a.useFrame(((e,t)=>{for(g=e.clock.elapsedTime,ka.copy(f.current.matrixWorld).invert(),e.camera.matrixWorld.decompose(La,Ia,Ba),w=0;w<p.current.length;w++)v=p.current[w],v.ref.current.matrixWorld.decompose(_a,Aa,Ba),_a.add(E.copy(v.position).applyQuaternion(Aa).multiply(Ba)),Aa.copy(Ia).multiply(z.setFromAxisAngle(b,v.rotation+=t*v.rotationFactor)),Ba.multiplyScalar(v.volume+(1+Math.sin(g*v.density*v.speed))/2*v.growth),v.matrix.compose(_a,Aa,Ba).premultiply(ka),v.dist=_a.distanceTo(La);for(p.current.sort(((e,t)=>t.dist-e.dist)),w=0;w<p.current.length;w++)v=p.current[w],h[w]=v.opacity*(v.dist<v.fade-1?v.dist/v.fade:1),f.current.setMatrixAt(w,v.matrix),f.current.setColorAt(w,v.color);f.current.geometry.attributes.cloudOpacity.needsUpdate=!0,f.current.instanceMatrix.needsUpdate=!0,f.current.instanceColor&&(f.current.instanceColor.needsUpdate=!0)})),S.useLayoutEffect((()=>{const e=Math.min(i,void 0!==o?o:i,p.current.length);f.current.count=e,br(f.current.instanceMatrix,{start:0,count:16*e}),f.current.instanceColor&&br(f.current.instanceColor,{start:0,count:3*e}),br(f.current.geometry.attributes.cloudOpacity,{start:0,count:e})}));let C=[null!==(u=y.image.width)&&void 0!==u?u:1,null!==(d=y.image.height)&&void 0!==d?d:1];const T=Math.max(C[0],C[1]);return C=[C[0]/T,C[1]/T],S.createElement("group",M.default({ref:c},l),S.createElement(Ua.Provider,{value:p},e,S.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:f,args:[null,null,i],frustumCulled:s},S.createElement("instancedBufferAttribute",{usage:n.DynamicDrawUsage,attach:"instanceColor",args:[x,3]}),S.createElement("planeGeometry",{args:[...C]},S.createElement("instancedBufferAttribute",{usage:n.DynamicDrawUsage,attach:"attributes-cloudOpacity",args:[h,1]})),S.createElement("cloudMaterial",{key:t.name,map:y,transparent:!0,depthWrite:!1}))))})),Oa=S.forwardRef((({opacity:e=1,speed:t=0,bounds:r=[5,1,1],segments:o=20,color:i="#ffffff",fade:s=10,volume:l=6,smallestVolume:c=.25,distribute:u=null,growth:d=4,concentrate:m="inside",seed:f=Math.random(),...p},h)=>{function x(){const e=1e4*Math.sin(f++);return e-Math.floor(e)}const y=S.useContext(Ua),v=S.useRef(null),g=S.useId(),w=S.useMemo((()=>[...new Array(o)].map(((e,t)=>({segments:o,bounds:new n.Vector3(1,1,1),position:new n.Vector3,uuid:g,index:t,ref:v,dist:0,matrix:new n.Matrix4,color:new n.Color,rotation:t*(Math.PI/o)})))),[o,g]);return S.useLayoutEffect((()=>{w.forEach(((n,f)=>{a.applyProps(n,{volume:l,color:i,speed:t,growth:d,opacity:e,fade:s,bounds:r,density:Math.max(.5,x()),rotationFactor:Math.max(.2,.5*x())*t});const p=null==u?void 0:u(n,f);var h;(p||o>1)&&n.position.copy(n.bounds).multiply(null!==(h=null==p?void 0:p.point)&&void 0!==h?h:{x:2*x()-1,y:2*x()-1,z:2*x()-1});const y=Math.abs(n.position.x),v=Math.abs(n.position.y),g=Math.abs(n.position.z),w=Math.max(y,v,g);n.length=1,y===w&&(n.length-=y/n.bounds.x),v===w&&(n.length-=v/n.bounds.y),g===w&&(n.length-=g/n.bounds.z),n.volume=(void 0!==(null==p?void 0:p.volume)?p.volume:Math.max(Math.max(0,c),"random"===m?x():"inside"===m?n.length:1-n.length))*l}))}),[m,r,s,i,e,d,l,f,o,t]),S.useLayoutEffect((()=>{const e=w;return y.current=[...y.current,...e],()=>{y.current=y.current.filter((e=>e.uuid!==g))}}),[w]),S.useImperativeHandle(h,(()=>v.current),[]),S.createElement("group",M.default({ref:v},p))})),Na=S.forwardRef(((e,t)=>S.useContext(Ua)?S.createElement(Oa,M.default({ref:t},e)):S.createElement(Va,null,S.createElement(Oa,M.default({ref:t},e)))));class ja extends T.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},pixelRatio:{value:1}},vertexShader:"\n        uniform float pixelRatio;\n        uniform float time;\n        attribute float size;  \n        attribute float speed;  \n        attribute float opacity;\n        attribute vec3 noise;\n        attribute vec3 color;\n        varying vec3 vColor;\n        varying float vOpacity;\n\n        void main() {\n          vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n          modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;\n          modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;\n          modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;\n          vec4 viewPosition = viewMatrix * modelPosition;\n          vec4 projectionPostion = projectionMatrix * viewPosition;\n          gl_Position = projectionPostion;\n          gl_PointSize = size * 25. * pixelRatio;\n          gl_PointSize *= (1.0 / - viewPosition.z);\n          vColor = color;\n          vOpacity = opacity;\n        }\n      ",fragmentShader:`\n        varying vec3 vColor;\n        varying float vOpacity;\n        void main() {\n          float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n          float strength = 0.05 / distanceToCenter - 0.1;\n          gl_FragColor = vec4(vColor, strength * vOpacity);\n          #include <tonemapping_fragment>\n          #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}get pixelRatio(){return this.uniforms.pixelRatio.value}set pixelRatio(e){this.uniforms.pixelRatio.value=e}}const Wa=e=>e&&e.constructor===Float32Array,Ga=e=>e instanceof T.Vector2||e instanceof T.Vector3||e instanceof T.Vector4,Ha=e=>Array.isArray(e)?e:Ga(e)?e.toArray():[e,e,e];function $a(e,t,r){return S.useMemo((()=>{if(void 0!==t){if(Wa(t))return t;if(t instanceof T.Color){const r=Array.from({length:3*e},(()=>(e=>[e.r,e.g,e.b])(t))).flat();return Float32Array.from(r)}if(Ga(t)||Array.isArray(t)){const r=Array.from({length:3*e},(()=>Ha(t))).flat();return Float32Array.from(r)}return Float32Array.from({length:e},(()=>t))}return Float32Array.from({length:e},r)}),[t])}const qa=S.forwardRef((({noise:e=1,count:t=100,speed:r=1,opacity:n=1,scale:o=1,size:i,color:s,children:l,...c},u)=>{S.useMemo((()=>a.extend({SparklesImplMaterial:ja})),[]);const d=S.useRef(null),m=a.useThree((e=>e.viewport.dpr)),f=Ha(o),p=S.useMemo((()=>Float32Array.from(Array.from({length:t},(()=>f.map(T.MathUtils.randFloatSpread))).flat())),[t,...f]),h=$a(t,i,Math.random),x=$a(t,n),y=$a(t,r),v=$a(3*t,e),g=$a(void 0===s?3*t:t,Wa(s)?s:new T.Color(s),(()=>1));return a.useFrame((e=>{d.current&&d.current.material&&(d.current.material.time=e.clock.elapsedTime)})),S.useImperativeHandle(u,(()=>d.current),[]),S.createElement("points",M.default({key:`particle-${t}-${JSON.stringify(o)}`},c,{ref:d}),S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[p,3]}),S.createElement("bufferAttribute",{attach:"attributes-size",args:[h,1]}),S.createElement("bufferAttribute",{attach:"attributes-opacity",args:[x,1]}),S.createElement("bufferAttribute",{attach:"attributes-speed",args:[y,1]}),S.createElement("bufferAttribute",{attach:"attributes-color",args:[g,3]}),S.createElement("bufferAttribute",{attach:"attributes-noise",args:[v,3]})),l||S.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:m,depthWrite:!1}))}));function Xa(e=0,t=1024,r){const n=m.suspend((()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/matcaps.json").then((e=>e.json()))),["matcapList"]),a=n[0],o=S.useMemo((()=>Object.keys(n).length),[]),i=`${S.useMemo((()=>"string"==typeof e?e:"number"==typeof e?n[e]:null),[e])||a}${function(e){switch(e){case 64:return"-64px";case 128:return"-128px";case 256:return"-256px";case 512:return"-512px";default:return""}}(t)}.png`,s=`https://rawcdn.githack.com/emmelleppi/matcaps/9b36ccaaf0a24881a39062d05566c9e92be4aa0d/${t}/${i}`;return[Se(s,r),s,o]}function Za(e=0,t={},r){const{repeat:a=[1,1],anisotropy:o=1,offset:i=[0,0]}=t,s=m.suspend((()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/normals/normals.json").then((e=>e.json()))),["normalsList"]),l=S.useMemo((()=>Object.keys(s).length),[]),c=s[0],u=`https://rawcdn.githack.com/pmndrs/drei-assets/7a3104997e1576f83472829815b00880d88b32fb/normals/${s[e]||c}`,d=Se(u,r);return S.useLayoutEffect((()=>{d&&(d.wrapS=d.wrapT=n.RepeatWrapping,d.repeat=new n.Vector2(a[0],a[1]),d.offset=new n.Vector2(i[0],i[1]),d.anisotropy=o)}),[d,o,a,i]),[d,u,l]}const Ya={uniforms:{strokeOpacity:1,fillOpacity:.25,fillMix:0,thickness:.05,colorBackfaces:!1,dashInvert:!0,dash:!1,dashRepeats:4,dashLength:.5,squeeze:!1,squeezeMin:.2,squeezeMax:1,stroke:new T.Color("#ff0000"),backfaceStroke:new T.Color("#0000ff"),fill:new T.Color("#00ff00")},vertex:"\n\t  attribute vec3 barycentric;\n\t\n\t\tvarying vec3 v_edges_Barycentric;\n\t\tvarying vec3 v_edges_Position;\n\n\t\tvoid initWireframe() {\n\t\t\tv_edges_Barycentric = barycentric;\n\t\t\tv_edges_Position = position.xyz;\n\t\t}\n\t  ",fragment:"\n\t\t#ifndef PI\n\t  \t#define PI 3.1415926535897932384626433832795\n\t\t#endif\n  \n\t  varying vec3 v_edges_Barycentric;\n\t  varying vec3 v_edges_Position;\n  \n\t  uniform float strokeOpacity;\n\t  uniform float fillOpacity;\n\t  uniform float fillMix;\n\t  uniform float thickness;\n\t  uniform bool colorBackfaces;\n  \n\t  // Dash\n\t  uniform bool dashInvert;\n\t  uniform bool dash;\n\t  uniform bool dashOnly;\n\t  uniform float dashRepeats;\n\t  uniform float dashLength;\n  \n\t  // Squeeze\n\t  uniform bool squeeze;\n\t  uniform float squeezeMin;\n\t  uniform float squeezeMax;\n  \n\t  // Colors\n\t  uniform vec3 stroke;\n\t  uniform vec3 backfaceStroke;\n\t  uniform vec3 fill;\n  \n\t  // This is like\n\t  float wireframe_aastep(float threshold, float dist) {\n\t\t  float afwidth = fwidth(dist) * 0.5;\n\t\t  return smoothstep(threshold - afwidth, threshold + afwidth, dist);\n\t  }\n  \n\t  float wireframe_map(float value, float min1, float max1, float min2, float max2) {\n\t\t  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n\t  }\n  \n\t  float getWireframe() {\n\t\t\tvec3 barycentric = v_edges_Barycentric;\n\t\t\n\t\t\t// Distance from center of each triangle to its edges.\n\t\t\tfloat d = min(min(barycentric.x, barycentric.y), barycentric.z);\n\n\t\t\t// for dashed rendering, we can use this to get the 0 .. 1 value of the line length\n\t\t\tfloat positionAlong = max(barycentric.x, barycentric.y);\n\t\t\tif (barycentric.y < barycentric.x && barycentric.y < barycentric.z) {\n\t\t\t\tpositionAlong = 1.0 - positionAlong;\n\t\t\t}\n\n\t\t\t// the thickness of the stroke\n\t\t\tfloat computedThickness = wireframe_map(thickness, 0.0, 1.0, 0.0, 0.34);\n\n\t\t\t// if we want to shrink the thickness toward the center of the line segment\n\t\t\tif (squeeze) {\n\t\t\t\tcomputedThickness *= mix(squeezeMin, squeezeMax, (1.0 - sin(positionAlong * PI)));\n\t\t\t}\n\n\t\t\t// Create dash pattern\n\t\t\tif (dash) {\n\t\t\t\t// here we offset the stroke position depending on whether it\n\t\t\t\t// should overlap or not\n\t\t\t\tfloat offset = 1.0 / dashRepeats * dashLength / 2.0;\n\t\t\t\tif (!dashInvert) {\n\t\t\t\t\toffset += 1.0 / dashRepeats / 2.0;\n\t\t\t\t}\n\n\t\t\t\t// if we should animate the dash or not\n\t\t\t\t// if (dashAnimate) {\n\t\t\t\t// \toffset += time * 0.22;\n\t\t\t\t// }\n\n\t\t\t\t// create the repeating dash pattern\n\t\t\t\tfloat pattern = fract((positionAlong + offset) * dashRepeats);\n\t\t\t\tcomputedThickness *= 1.0 - wireframe_aastep(dashLength, pattern);\n\t\t\t}\n\n\t\t\t// compute the anti-aliased stroke edge  \n\t\t\tfloat edge = 1.0 - wireframe_aastep(computedThickness, d);\n\n\t\t\treturn edge;\n\t  }\n\t  "},Qa=Ee(Ya.uniforms,Ya.vertex+"\n  \tvoid main() {\n\t\tinitWireframe();\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t}\n  ",Ya.fragment+"\n  void main () {\n\t\t// Compute color\n\n\t\tfloat edge = getWireframe();\n\t\tvec4 colorStroke = vec4(stroke, edge);\n\n\t\t#ifdef FLIP_SIDED\n\t\t\tcolorStroke.rgb = backfaceStroke;\n\t\t#endif\n    \n\t\tvec4 colorFill = vec4(fill, fillOpacity);\n\t\tvec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n\t\tgl_FragColor = outColor;\n\t}\n  ");function Ka(e){return void 0!==(null==e?void 0:e.current)}function Ja(e){return"WireframeGeometry"===e.type}function eo(e){const t=null!=(r=e)&&r.current?e.current:e;var r;if(function(e){return!(null==e||!e.isBufferGeometry)}(t))return t;{if(Ja(t))throw new Error("Wireframe: WireframeGeometry is not supported.");const e=t.parent;if(function(e){return!(null==e||!e.geometry)}(e)){if(Ja(e.geometry))throw new Error("Wireframe: WireframeGeometry is not supported.");return e.geometry}}}function to(e,t){if(e.index){console.warn("Wireframe: Requires non-indexed geometry, converting to non-indexed geometry.");const t=e.toNonIndexed();e.copy(t),e.setIndex(null)}const r=function(e,t){const r=e.getAttribute("position").count,n=[];for(let e=0;e<r;e++){const r=t?1:0;e%2==0?n.push(0,0,1,0,1,0,1,0,r):n.push(0,1,0,0,0,1,1,0,r)}return new T.BufferAttribute(Float32Array.from(n),3)}(e,t);e.setAttribute("barycentric",r)}function ro({geometry:e,simplify:t=!1,...r}){a.extend({MeshWireframeMaterial:Qa});const[n,o]=S.useState(null);S.useLayoutEffect((()=>{const r=eo(e);if(!r)throw new Error("Wireframe: geometry prop must be a BufferGeometry or a ref to a BufferGeometry.");to(r,t),Ka(e)&&o(r)}),[t,e]);const i=Ka(e)?n:e;return S.createElement(S.Fragment,null,i&&S.createElement("mesh",{geometry:i},S.createElement("meshWireframeMaterial",M.default({attach:"material",transparent:!0,side:T.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4},r,{extensions:{derivatives:!0,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1}}))))}function no({simplify:e=!1,...t}){const r=S.useRef(null),n=S.useMemo((()=>function(){const e={};for(const t in Ya.uniforms)e[t]={value:Ya.uniforms[t]};return e}()),[Ya.uniforms]);return function(e,t){S.useEffect((()=>{var r;e.fillOpacity.value=null!==(r=t.fillOpacity)&&void 0!==r?r:e.fillOpacity.value}),[t.fillOpacity]),S.useEffect((()=>{var r;e.fillMix.value=null!==(r=t.fillMix)&&void 0!==r?r:e.fillMix.value}),[t.fillMix]),S.useEffect((()=>{var r;e.strokeOpacity.value=null!==(r=t.strokeOpacity)&&void 0!==r?r:e.strokeOpacity.value}),[t.strokeOpacity]),S.useEffect((()=>{var r;e.thickness.value=null!==(r=t.thickness)&&void 0!==r?r:e.thickness.value}),[t.thickness]),S.useEffect((()=>{e.colorBackfaces.value=!!t.colorBackfaces}),[t.colorBackfaces]),S.useEffect((()=>{e.dash.value=!!t.dash}),[t.dash]),S.useEffect((()=>{e.dashInvert.value=!!t.dashInvert}),[t.dashInvert]),S.useEffect((()=>{var r;e.dashRepeats.value=null!==(r=t.dashRepeats)&&void 0!==r?r:e.dashRepeats.value}),[t.dashRepeats]),S.useEffect((()=>{var r;e.dashLength.value=null!==(r=t.dashLength)&&void 0!==r?r:e.dashLength.value}),[t.dashLength]),S.useEffect((()=>{e.squeeze.value=!!t.squeeze}),[t.squeeze]),S.useEffect((()=>{var r;e.squeezeMin.value=null!==(r=t.squeezeMin)&&void 0!==r?r:e.squeezeMin.value}),[t.squeezeMin]),S.useEffect((()=>{var r;e.squeezeMax.value=null!==(r=t.squeezeMax)&&void 0!==r?r:e.squeezeMax.value}),[t.squeezeMax]),S.useEffect((()=>{e.stroke.value=t.stroke?new T.Color(t.stroke):e.stroke.value}),[t.stroke]),S.useEffect((()=>{e.fill.value=t.fill?new T.Color(t.fill):e.fill.value}),[t.fill]),S.useEffect((()=>{e.backfaceStroke.value=t.backfaceStroke?new T.Color(t.backfaceStroke):e.backfaceStroke.value}),[t.backfaceStroke])}(n,t),S.useLayoutEffect((()=>{const t=eo(r);if(!t)throw new Error("Wireframe: Must be a child of a Mesh, Line or Points object or specify a geometry prop.");const n=t.clone();return to(t,e),()=>{t.copy(n),n.dispose()}}),[e]),S.useLayoutEffect((()=>{const e=r.current.parent,t=e.material.clone();return function(e,t){e.onBeforeCompile=e=>{e.uniforms={...e.uniforms,...t},e.vertexShader=e.vertexShader.replace("void main() {",`\n\t\t  ${Ya.vertex}\n\t\t  void main() {\n\t\t\tinitWireframe();\n\t\t`),e.fragmentShader=e.fragmentShader.replace("void main() {",`\n\t\t  ${Ya.fragment}\n\t\t  void main() {\n\t\t`),e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","\n\t\t  #include <color_fragment>\n\t\t\t  float edge = getWireframe();\n\t\t  vec4 colorStroke = vec4(stroke, edge);\n\t\t  #ifdef FLIP_SIDED\n\t\t\tcolorStroke.rgb = backfaceStroke;\n\t\t  #endif\n\t\t  vec4 colorFill = vec4(mix(diffuseColor.rgb, fill, fillMix), mix(diffuseColor.a, fillOpacity, fillMix));\n\t\t  vec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n\t\t  diffuseColor.rgb = outColor.rgb;\n\t\t  diffuseColor.a *= outColor.a;\n\t\t")},e.side=T.DoubleSide,e.transparent=!0}(e.material,n),()=>{e.material.dispose(),e.material=t}}),[]),S.createElement("object3D",{ref:r})}const ao=new T.Matrix4,oo=new T.Ray,io=new T.Sphere,so=new T.Vector3;class lo extends T.Group{constructor(){super(),this.size=0,this.color=new T.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){var r,n;const a=this.instance.current;if(!a||!a.geometry)return;const o=a.userData.instances.indexOf(this.instanceKey);if(-1===o||o>a.geometry.drawRange.count)return;const i=null!==(r=null==(n=e.params.Points)?void 0:n.threshold)&&void 0!==r?r:1;if(io.set(this.getWorldPosition(so),i),!1===e.ray.intersectsSphere(io))return;ao.copy(a.matrixWorld).invert(),oo.copy(e.ray).applyMatrix4(ao);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,c=oo.distanceSqToPoint(this.position);if(c<l){const r=new T.Vector3;oo.closestPointToPoint(this.position,r),r.applyMatrix4(this.matrixWorld);const n=e.ray.origin.distanceTo(r);if(n<e.near||n>e.far)return;t.push({distance:n,distanceToRay:Math.sqrt(c),point:r,index:o,face:null,object:this})}}}let co,uo;const mo=S.createContext(null),fo=new T.Matrix4,po=new T.Vector3,ho=S.forwardRef((({children:e,range:t,limit:r=1e3,...n},o)=>{const i=S.useRef(null);S.useImperativeHandle(o,(()=>i.current),[]);const[s,l]=S.useState([]),[[c,u,d]]=S.useState((()=>[new Float32Array(3*r),Float32Array.from({length:3*r},(()=>1)),Float32Array.from({length:r},(()=>1))]));S.useEffect((()=>{i.current.geometry.attributes.position.needsUpdate=!0})),a.useFrame((()=>{for(i.current.updateMatrix(),i.current.updateMatrixWorld(),fo.copy(i.current.matrixWorld).invert(),i.current.geometry.drawRange.count=Math.min(r,void 0!==t?t:r,s.length),co=0;co<s.length;co++)uo=s[co].current,uo.getWorldPosition(po).applyMatrix4(fo),po.toArray(c,3*co),i.current.geometry.attributes.position.needsUpdate=!0,uo.matrixWorldNeedsUpdate=!0,uo.color.toArray(u,3*co),i.current.geometry.attributes.color.needsUpdate=!0,d.set([uo.size],co),i.current.geometry.attributes.size.needsUpdate=!0}));const m=S.useMemo((()=>({getParent:()=>i,subscribe:e=>(l((t=>[...t,e])),()=>l((t=>t.filter((t=>t.current!==e.current)))))})),[]);return S.createElement("points",M.default({userData:{instances:s},matrixAutoUpdate:!1,ref:i,raycast:()=>null},n),S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[c,3],usage:T.DynamicDrawUsage}),S.createElement("bufferAttribute",{attach:"attributes-color",args:[u,3],usage:T.DynamicDrawUsage}),S.createElement("bufferAttribute",{attach:"attributes-size",args:[d,1],usage:T.DynamicDrawUsage})),S.createElement(mo.Provider,{value:m},e))})),xo=S.forwardRef((({children:e,...t},r)=>{S.useMemo((()=>a.extend({PositionPoint:lo})),[]);const n=S.useRef(null);S.useImperativeHandle(r,(()=>n.current),[]);const{subscribe:o,getParent:i}=S.useContext(mo);return S.useLayoutEffect((()=>o(n)),[]),S.createElement("positionPoint",M.default({instance:i(),instanceKey:n,ref:n},t),e)})),yo=S.forwardRef((({children:e,positions:t,colors:r,sizes:n,stride:o=3,...i},s)=>{const l=S.useRef(null);return S.useImperativeHandle(s,(()=>l.current),[]),a.useFrame((()=>{const e=l.current.geometry.attributes;e.position.needsUpdate=!0,r&&(e.color.needsUpdate=!0),n&&(e.size.needsUpdate=!0)})),S.createElement("points",M.default({ref:l},i),S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[t,o],usage:T.DynamicDrawUsage}),r&&S.createElement("bufferAttribute",{attach:"attributes-color",args:[r,o],count:r.length/o,usage:T.DynamicDrawUsage}),n&&S.createElement("bufferAttribute",{attach:"attributes-size",args:[n,1],count:n.length/o,usage:T.DynamicDrawUsage})),e)})),vo=S.forwardRef(((e,t)=>e.positions instanceof Float32Array?S.createElement(yo,M.default({},e,{ref:t})):S.createElement(ho,M.default({},e,{ref:t})))),go=S.createContext(null),wo=S.forwardRef(((e,t)=>{S.useMemo((()=>a.extend({SegmentObject:zo})),[]);const{limit:r=1e3,lineWidth:n=1,children:o,...i}=e,[s,l]=S.useState([]),[u]=S.useState((()=>new c.Line2)),[d]=S.useState((()=>new c.LineMaterial)),[m]=S.useState((()=>new c.LineSegmentsGeometry)),[f]=S.useState((()=>new T.Vector2(512,512))),[p]=S.useState((()=>Array(6*r).fill(0))),[h]=S.useState((()=>Array(6*r).fill(0))),x=S.useMemo((()=>({subscribe:e=>(l((t=>[...t,e])),()=>l((t=>t.filter((t=>t.current!==e.current)))))})),[]);return a.useFrame((()=>{for(let t=0;t<r;t++){var e;const r=null==(e=s[t])?void 0:e.current;r&&(p[6*t+0]=r.start.x,p[6*t+1]=r.start.y,p[6*t+2]=r.start.z,p[6*t+3]=r.end.x,p[6*t+4]=r.end.y,p[6*t+5]=r.end.z,h[6*t+0]=r.color.r,h[6*t+1]=r.color.g,h[6*t+2]=r.color.b,h[6*t+3]=r.color.r,h[6*t+4]=r.color.g,h[6*t+5]=r.color.b)}m.setColors(h),m.setPositions(p),u.computeLineDistances()})),S.createElement("primitive",{object:u,ref:t},S.createElement("primitive",{object:m,attach:"geometry"}),S.createElement("primitive",M.default({object:d,attach:"material",vertexColors:!0,resolution:f,linewidth:n},i)),S.createElement(go.Provider,{value:x},o))}));class zo{constructor(){this.color=new T.Color("white"),this.start=new T.Vector3(0,0,0),this.end=new T.Vector3(0,0,0)}}const bo=e=>e instanceof T.Vector3?e:new T.Vector3(..."number"==typeof e?[e,e,e]:e),Eo=S.forwardRef((({color:e,start:t,end:r},n)=>{const a=S.useContext(go);if(!a)throw"Segment must used inside Segments component.";const o=S.useRef(null);return S.useImperativeHandle(n,(()=>o.current),[]),S.useLayoutEffect((()=>a.subscribe(o)),[]),S.createElement("segmentObject",{ref:o,color:e,start:bo(t),end:bo(r)})})),Mo=S.forwardRef((({children:e,hysteresis:t=0,distances:r,...n},o)=>{const i=S.useRef(null);return S.useImperativeHandle(o,(()=>i.current),[]),S.useLayoutEffect((()=>{const{current:e}=i;e.levels.length=0,e.children.forEach(((n,a)=>e.levels.push({object:n,hysteresis:t,distance:r[a]})))})),a.useFrame((e=>{var t;return null==(t=i.current)?void 0:t.update(e.camera)})),S.createElement("lOD",M.default({ref:i},n),e)}));const So=new n.Matrix4,Co=new n.Ray,To=new n.Sphere,Po=new n.Vector3;const Ro=t.createContext(null);const Do=S.forwardRef((({children:e,compute:t,width:r,height:n,samples:o=8,renderPriority:i=0,eventPriority:s=0,frames:l=1/0,stencilBuffer:c=!1,depthBuffer:u=!0,generateMipmaps:d=!1,...m},f)=>{const{size:p,viewport:h}=a.useThree(),x=rt((r||p.width)*h.dpr,(n||p.height)*h.dpr,{samples:o,stencilBuffer:c,depthBuffer:u,generateMipmaps:d}),[y]=S.useState((()=>new T.Scene)),v=S.useCallback(((e,t,r)=>{var n,a;let o=null==(n=x.texture)||null==(n=n.__r3f.parent)?void 0:n.object;for(;o&&!(o instanceof T.Object3D);){var i;o=null==(i=o.__r3f.parent)?void 0:i.object}if(!o)return!1;r.raycaster.camera||r.events.compute(e,r,null==(a=r.previousRoot)?void 0:a.getState());const[s]=r.raycaster.intersectObject(o);if(!s)return!1;const l=s.uv;if(!l)return!1;t.raycaster.setFromCamera(t.pointer.set(2*l.x-1,2*l.y-1),t.camera)}),[]);return S.useImperativeHandle(f,(()=>x.texture),[x]),S.createElement(S.Fragment,null,a.createPortal(S.createElement(Fo,{renderPriority:i,frames:l,fbo:x},e,S.createElement("group",{onPointerOver:()=>null})),y,{events:{compute:t||v,priority:s}}),S.createElement("primitive",M.default({object:x.texture},m)))}));function Fo({frames:e,renderPriority:t,children:r,fbo:n}){let o,i,s,l,c=0;return a.useFrame((t=>{(e===1/0||c<e)&&(o=t.gl.autoClear,i=t.gl.xr.enabled,s=t.gl.getRenderTarget(),l=t.gl.xr.isPresenting,t.gl.autoClear=!0,t.gl.xr.enabled=!1,t.gl.xr.isPresenting=!1,t.gl.setRenderTarget(n),t.gl.render(t.scene,t.camera),t.gl.setRenderTarget(s),t.gl.autoClear=o,t.gl.xr.enabled=i,t.gl.xr.isPresenting=l,c++)}),t),S.createElement(S.Fragment,null,r)}const ko=S.forwardRef((({children:e,compute:t,renderPriority:r=-1,eventPriority:n=0,frames:o=1/0,stencilBuffer:i=!1,depthBuffer:s=!0,generateMipmaps:l=!1,resolution:c=896,near:u=.1,far:d=1e3,flip:m=!1,position:f,rotation:p,scale:h,quaternion:x,matrix:y,matrixAutoUpdate:v,...g},w)=>{const{size:z,viewport:b}=a.useThree(),E=S.useRef(null),C=S.useMemo((()=>{const e=new T.WebGLCubeRenderTarget(Math.max((c||z.width)*b.dpr,(c||z.height)*b.dpr),{stencilBuffer:i,depthBuffer:s,generateMipmaps:l});return e.texture.isRenderTargetTexture=!m,e.texture.flipY=!0,e.texture.type=T.HalfFloatType,e}),[c,m]);S.useEffect((()=>()=>C.dispose()),[C]);const[P]=S.useState((()=>new T.Scene));return S.useImperativeHandle(w,(()=>({scene:P,fbo:C,camera:E.current})),[C]),S.createElement(S.Fragment,null,a.createPortal(S.createElement(_o,{renderPriority:r,frames:o,camera:E},e,S.createElement("group",{onPointerOver:()=>null})),P,{events:{compute:t,priority:n}}),S.createElement("primitive",M.default({object:C.texture},g)),S.createElement("cubeCamera",{ref:E,args:[u,d,C],position:f,rotation:p,scale:h,quaternion:x,matrix:y,matrixAutoUpdate:v}))}));function _o({frames:e,renderPriority:t,children:r,camera:n}){let o=0;return a.useFrame((t=>{(e===1/0||o<e)&&(n.current.update(t.gl,t.scene),o++)}),t),S.createElement(S.Fragment,null,r)}const Ao=S.forwardRef((({id:e=1,colorWrite:t=!1,depthWrite:r=!1,...n},a)=>{const o=S.useRef(null),i=S.useMemo((()=>({colorWrite:t,depthWrite:r,stencilWrite:!0,stencilRef:e,stencilFunc:T.AlwaysStencilFunc,stencilFail:T.ReplaceStencilOp,stencilZFail:T.ReplaceStencilOp,stencilZPass:T.ReplaceStencilOp})),[e,t,r]);return S.useLayoutEffect((()=>{Object.assign(o.current.material,i)})),S.useImperativeHandle(a,(()=>o.current),[]),S.createElement("mesh",M.default({ref:o,renderOrder:-e},n))}));function Lo({api:e}){const t=new T.Vector3,r=new T.Quaternion,n=new T.Vector3,o=new T.Euler(0,Math.PI,0);return a.useFrame((a=>{a.camera.matrixWorld.decompose(t,r,n),e.current.camera.position.copy(t),e.current.camera.quaternion.setFromEuler(o).premultiply(r)})),null}const Io=Ee({blur:0,map:null,sdf:null,blend:0,size:0,resolution:new T.Vector2},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n     vUv = uv;\n   }",`uniform sampler2D sdf;\n   uniform sampler2D map;\n   uniform float blur;\n   uniform float size;\n   uniform float time;\n   uniform vec2 resolution;\n   varying vec2 vUv;\n   #include <packing>\n   void main() {\n     vec2 uv = gl_FragCoord.xy / resolution.xy;\n     vec4 t = texture2D(map, uv);\n     float k = blur;\n     float d = texture2D(sdf, vUv).r/size;\n     float alpha = 1.0 - smoothstep(0.0, 1.0, clamp(d/k + 1.0, 0.0, 1.0));\n     gl_FragColor = vec4(t.rgb, blur == 0.0 ? t.a : t.a * alpha);\n     #include <tonemapping_fragment>\n     #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),Bo=S.forwardRef((({children:e,events:t,blur:r=0,eventPriority:n=0,renderPriority:o=0,worldUnits:i=!1,resolution:s=512,...l},c)=>{a.extend({PortalMaterialImpl:Io});const u=S.useRef(null),{scene:d,gl:m,size:f,viewport:p,setEvents:h}=a.useThree(),x=rt(s,s),[y,v]=S.useState(0);a.useFrame((()=>{const e=u.current.blend>0?Math.max(1,o):0;y!==e&&v(e)})),S.useEffect((()=>{void 0!==t&&h({enabled:!t})}),[t]);const[g,w]=S.useState(!0),z=pr(w);S.useLayoutEffect((()=>{var e;z.current=null==(e=u.current)||null==(e=e.__r3f.parent)?void 0:e.object}),[]),S.useLayoutEffect((()=>{if(z.current&&r&&null===u.current.sdf){const e=new T.Mesh(z.current.geometry,new T.MeshBasicMaterial),t=(new T.Box3).setFromBufferAttribute(e.geometry.attributes.position),r=new T.OrthographicCamera(t.min.x*(1+2/s),t.max.x*(1+2/s),t.max.y*(1+2/s),t.min.y*(1+2/s),.1,1e3);r.position.set(0,0,1),r.lookAt(0,0,0),m.setRenderTarget(x),m.render(e,r);const n=Vo(s,s,m)(x.texture),a=new Float32Array(s*s);m.readRenderTargetPixels(n,0,0,s,s,a);let o=1/0;for(let e=0;e<a.length;e++)a[e]<o&&(o=a[e]);o=-o,u.current.size=o,u.current.sdf=n.texture,m.setRenderTarget(null)}}),[s,r]),S.useImperativeHandle(c,(()=>u.current));const b=S.useCallback(((e,t,r)=>{var n;if(!z.current)return!1;if(t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera),0===(null==(n=u.current)?void 0:n.blend)){const[e]=t.raycaster.intersectObject(z.current);if(!e)return t.raycaster.camera=void 0,!1}}),[]);return S.createElement("portalMaterialImpl",M.default({ref:u,blur:r,blend:0,resolution:[f.width*p.dpr,f.height*p.dpr],attach:"material"},l),S.createElement(Do,{attach:"map",frames:g?1/0:0,eventPriority:n,renderPriority:o,compute:b},e,S.createElement(Uo,{events:t,rootScene:d,priority:y,material:u,worldUnits:i})))}));function Uo({events:e,rootScene:t,material:r,priority:n,worldUnits:o}){const i=a.useThree((e=>e.scene)),s=a.useThree((e=>e.setEvents)),l=rt(),u=rt();S.useLayoutEffect((()=>{i.matrixAutoUpdate=!1}),[]),S.useEffect((()=>{void 0!==e&&s({enabled:e})}),[e]);const[d,m]=S.useMemo((()=>{const e={value:0};return[new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{a:{value:l.texture},b:{value:u.texture},blend:e},vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n          }",fragmentShader:`\n          uniform sampler2D a;\n          uniform sampler2D b;\n          uniform float blend;\n          varying vec2 vUv;\n          #include <packing>\n          void main() {\n            vec4 ta = texture2D(a, vUv);\n            vec4 tb = texture2D(b, vUv);\n            gl_FragColor = mix(tb, ta, blend);\n            #include <tonemapping_fragment>\n            #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n          }`})),e]}),[]);return a.useFrame((e=>{var a;let s=null==r||null==(a=r.current)||null==(a=a.__r3f.parent)?void 0:a.object;if(s){var c,f,p,h;if(o)i.matrixWorld.identity();else n&&1===(null==(c=r.current)?void 0:c.blend)&&s.updateWorldMatrix(!0,!1),i.matrixWorld.copy(s.matrixWorld);if(n)(null==(f=r.current)?void 0:f.blend)>0&&(null==(p=r.current)?void 0:p.blend)<1?(m.value=r.current.blend,e.gl.setRenderTarget(l),e.gl.render(i,e.camera),e.gl.setRenderTarget(u),e.gl.render(t,e.camera),e.gl.setRenderTarget(null),d.render(e.gl)):1===(null==(h=r.current)?void 0:h.blend)&&e.gl.render(i,e.camera)}}),n),S.createElement(S.Fragment,null)}const Vo=(e,t,r)=>{let n=new T.WebGLRenderTarget(e,t,{minFilter:T.LinearMipmapLinearFilter,magFilter:T.LinearFilter,type:T.FloatType,format:T.RedFormat,generateMipmaps:!0}),a=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),o=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),i=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),s=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),l=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter,type:T.FloatType,format:T.RedFormat}),u=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter,type:T.FloatType,format:T.RedFormat});const d=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (round(texture2D(tex, vUv).x)));\n        }"})),m=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (1.0 - round(texture2D(tex, vUv).x)));\n        }"})),f=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null},offset:{value:0},level:{value:0},maxSteps:{value:0}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:`\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform float offset;\n        uniform float level;\n        uniform float maxSteps;\n        #include <packing>\n        void main() {\n          float closestDist = 9999999.9;\n          vec2 closestPos = vec2(0.0);\n          for (float x = -1.0; x <= 1.0; x += 1.0) {\n            for (float y = -1.0; y <= 1.0; y += 1.0) {\n              vec2 voffset = vUv;\n              voffset += vec2(x, y) * vec2(${1/e}, ${1/t}) * offset;\n              vec2 pos = unpackRGBATo2Half(texture2D(tex, voffset));\n              float dist = distance(pos.xy, vUv);\n              if(pos.x != 0.0 && pos.y != 0.0 && dist < closestDist) {\n                closestDist = dist;\n                closestPos = pos;\n              }\n            }\n          }\n          gl_FragColor = pack2HalfToRGBA(closestPos);\n        }`})),p=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null},size:{value:new T.Vector2(e,t)}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform vec2 size;\n        #include <packing>\n        void main() {\n          gl_FragColor = vec4(distance(size * unpackRGBATo2Half(texture2D(tex, vUv)), size * vUv), 0.0, 0.0, 0.0);\n        }"})),h=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{inside:{value:u.texture},outside:{value:l.texture},tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D inside;\n        uniform sampler2D outside;\n        uniform sampler2D tex;\n        #include <packing>\n        void main() {\n          float i = texture2D(inside, vUv).x;\n          float o =texture2D(outside, vUv).x;\n          if (texture2D(tex, vUv).x == 0.0) {\n            gl_FragColor = vec4(o, 0.0, 0.0, 0.0);\n          } else {\n            gl_FragColor = vec4(-i, 0.0, 0.0, 0.0);\n          }\n        }"}));return c=>{let x=n;c.minFilter=T.NearestFilter,c.magFilter=T.NearestFilter,d.material.uniforms.tex.value=c,r.setRenderTarget(a),d.render(r);const y=Math.ceil(Math.log(Math.max(e,t))/Math.log(2));let v=a,g=null;for(let e=0;e<y;e++){const t=Math.pow(2,y-e-1);g=v===a?i:a,f.material.uniforms.level.value=e,f.material.uniforms.maxSteps.value=y,f.material.uniforms.offset.value=t,f.material.uniforms.tex.value=v.texture,r.setRenderTarget(g),f.render(r),v=g}r.setRenderTarget(l),p.material.uniforms.tex.value=g.texture,p.render(r),m.material.uniforms.tex.value=c,r.setRenderTarget(o),m.render(r),v=o;for(let e=0;e<y;e++){const t=Math.pow(2,y-e-1);g=v===o?s:o,f.material.uniforms.level.value=e,f.material.uniforms.maxSteps.value=y,f.material.uniforms.offset.value=t,f.material.uniforms.tex.value=v.texture,r.setRenderTarget(g),f.render(r),v=g}return r.setRenderTarget(u),p.material.uniforms.tex.value=g.texture,p.render(r),r.setRenderTarget(x),h.material.uniforms.tex.value=c,h.render(r),r.setRenderTarget(null),x}},Oo=new T.Color,No=F.default();function jo(e,t){const{right:r,top:n,left:a,bottom:o,width:i,height:s}=t,l=t.bottom<0||n>e.height||r<0||t.left>e.width,c=e.top+e.height-o;return{position:{width:i,height:s,left:a-e.left,top:n,bottom:c,right:r},isOffscreen:l}}function Wo(e,{left:t,bottom:r,width:n,height:a}){let o;const i=n/a;var s;return(s=e.camera)&&s.isOrthographicCamera?e.camera.manual?e.camera.updateProjectionMatrix():e.camera.left===n/-2&&e.camera.right===n/2&&e.camera.top===a/2&&e.camera.bottom===a/-2||(Object.assign(e.camera,{left:n/-2,right:n/2,top:a/2,bottom:a/-2}),e.camera.updateProjectionMatrix()):e.camera.aspect!==i&&(e.camera.aspect=i,e.camera.updateProjectionMatrix()),o=e.gl.autoClear,e.gl.autoClear=!1,e.gl.setViewport(t,r,n,a),e.gl.setScissor(t,r,n,a),e.gl.setScissorTest(!0),o}function Go(e,t){e.gl.setScissorTest(!1),e.gl.autoClear=t}function Ho(e){e.gl.getClearColor(Oo),e.gl.setClearColor(Oo,e.gl.getClearAlpha()),e.gl.clear(!0,!0)}function $o({visible:e=!0,canvasSize:t,scene:r,index:n,children:o,frames:i,rect:s,track:l}){const c=a.useThree(),[u,d]=S.useState(!1);let m=0;return a.useFrame((n=>{var a;(i===1/0||m<=i)&&(l&&(s.current=null==(a=l.current)?void 0:a.getBoundingClientRect()),m++);if(s.current){const{position:a,isOffscreen:i}=jo(t,s.current);if(u!==i&&d(i),e&&!u&&s.current){const e=Wo(n,a);n.gl.render(o?n.scene:r,n.camera),Go(n,e)}}}),n),S.useLayoutEffect((()=>{const r=s.current;if(r&&(!e||!u)){const{position:e}=jo(t,r),n=Wo(c,e);Ho(c),Go(c,n)}}),[e,u]),S.useEffect((()=>{if(!l)return;const e=s.current,r=c.get().events.connected;return c.setEvents({connected:l.current}),()=>{if(e){const{position:r}=jo(t,e),n=Wo(c,r);Ho(c),Go(c,n)}c.setEvents({connected:r})}}),[l]),S.createElement(S.Fragment,null,o,S.createElement("group",{onPointerOver:()=>null}))}const qo=S.forwardRef((({track:e,visible:t=!0,index:r=1,id:n,style:o,className:i,frames:s=1/0,children:l,...c},u)=>{var d,m,f,p;const h=S.useRef(null),{size:x,scene:y}=a.useThree(),[v]=S.useState((()=>new T.Scene)),[g,w]=S.useReducer((()=>!0),!1),z=S.useCallback(((t,r)=>{if(h.current&&e&&e.current&&t.target===e.current){const{width:e,height:n,left:a,top:o}=h.current,i=t.clientX-a,s=t.clientY-o;r.pointer.set(i/e*2-1,-s/n*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)}}),[h,e]);return S.useEffect((()=>{var t;e&&(h.current=null==(t=e.current)?void 0:t.getBoundingClientRect()),w()}),[e]),S.createElement("group",M.default({ref:u},c),g&&a.createPortal(S.createElement($o,{visible:t,canvasSize:x,frames:s,scene:y,track:e,rect:h,index:r},l),v,{events:{compute:z,priority:r},size:{width:null==(d=h.current)?void 0:d.width,height:null==(m=h.current)?void 0:m.height,top:null==(f=h.current)?void 0:f.top,left:null==(p=h.current)?void 0:p.left}}))})),Xo=S.forwardRef((({as:e="div",id:t,visible:r,className:n,style:a,index:o=1,track:i,frames:s=1/0,children:l,...c},u)=>{const d=S.useId(),m=S.useRef(null);return S.useImperativeHandle(u,(()=>m.current)),S.createElement(S.Fragment,null,S.createElement(e,M.default({ref:m,id:t,className:n,style:a},c)),S.createElement(No.In,null,S.createElement(qo,{visible:r,key:d,track:m,frames:s,index:o},l)))})),Zo=(()=>{const e=S.forwardRef(((e,t)=>S.useContext(a.context)?S.createElement(qo,M.default({ref:t},e)):S.createElement(Xo,M.default({ref:t},e))));return e.Port=()=>S.createElement(No.Out,null),e})(),Yo=S.createContext(null),Qo=new T.Vector3,Ko=new T.Vector3,Jo=new T.Vector3(0,1,0),ei=new T.Matrix4,ti=({direction:e,axis:t})=>{const{translation:r,translationLimits:n,annotations:o,annotationsClass:i,depthTest:s,scale:l,lineWidth:c,fixed:u,axisColors:d,hoveredColor:m,opacity:f,renderOrder:p,onDragStart:h,onDrag:x,onDragEnd:y,userData:v}=S.useContext(Yo),g=a.useThree((e=>e.controls)),w=S.useRef(null),z=S.useRef(null),b=S.useRef(null),E=S.useRef(0),[M,C]=S.useState(!1),P=S.useCallback((n=>{o&&(w.current.innerText=`${r.current[t].toFixed(2)}`,w.current.style.display="block"),n.stopPropagation();const a=(new T.Matrix4).extractRotation(z.current.matrixWorld),i=n.point.clone(),s=(new T.Vector3).setFromMatrixPosition(z.current.matrixWorld),l=e.clone().applyMatrix4(a).normalize();b.current={clickPoint:i,dir:l},E.current=r.current[t],h({component:"Arrow",axis:t,origin:s,directions:[l]}),g&&(g.enabled=!1),n.target.setPointerCapture(n.pointerId)}),[o,e,g,h,r,t]),R=S.useCallback((e=>{if(e.stopPropagation(),M||C(!0),b.current){const{clickPoint:a,dir:i}=b.current,[s,l]=(null==n?void 0:n[t])||[void 0,void 0];let c=((e,t,r,n)=>{const a=t.dot(t),o=t.dot(e)-t.dot(r),i=t.dot(n);return 0===i?-o/a:(Qo.copy(n).multiplyScalar(a/i).sub(t),Ko.copy(n).multiplyScalar(o/i).add(r).sub(e),-Qo.dot(Ko)/Qo.dot(Qo))})(a,i,e.ray.origin,e.ray.direction);void 0!==s&&(c=Math.max(c,s-E.current)),void 0!==l&&(c=Math.min(c,l-E.current)),r.current[t]=E.current+c,o&&(w.current.innerText=`${r.current[t].toFixed(2)}`),ei.makeTranslation(i.x*c,i.y*c,i.z*c),x(ei)}}),[o,x,M,r,n,t]),D=S.useCallback((e=>{o&&(w.current.style.display="none"),e.stopPropagation(),b.current=null,y(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[o,g,y]),F=S.useCallback((e=>{e.stopPropagation(),C(!1)}),[]),{cylinderLength:k,coneWidth:_,coneLength:A,matrixL:L}=S.useMemo((()=>{const t=u?c/l*1.6:l/20,r=u?.2:l/5,n=u?1-r:l-r,a=(new T.Quaternion).setFromUnitVectors(Jo,e.clone().normalize());return{cylinderLength:n,coneWidth:t,coneLength:r,matrixL:(new T.Matrix4).makeRotationFromQuaternion(a)}}),[e,l,c,u]),I=M?m:d[t];return S.createElement("group",{ref:z},S.createElement("group",{matrix:L,matrixAutoUpdate:!1,onPointerDown:P,onPointerMove:R,onPointerUp:D,onPointerOut:F},o&&S.createElement(j,{position:[0,-A,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:i,ref:w})),S.createElement("mesh",{visible:!1,position:[0,(k+A)/2,0],userData:v},S.createElement("cylinderGeometry",{args:[1.4*_,1.4*_,k+A,8,1]})),S.createElement(ce,{transparent:!0,raycast:()=>null,depthTest:s,points:[0,0,0,0,k,0],lineWidth:c,side:T.DoubleSide,color:I,opacity:f,polygonOffset:!0,renderOrder:p,polygonOffsetFactor:-10,fog:!1}),S.createElement("mesh",{raycast:()=>null,position:[0,k+A/2,0],renderOrder:p},S.createElement("coneGeometry",{args:[_,A,24,1]}),S.createElement("meshBasicMaterial",{transparent:!0,depthTest:s,color:I,opacity:f,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},ri=new T.Vector3,ni=new T.Vector3,ai=e=>180*e/Math.PI,oi=e=>{let t=((e,t)=>{let r=Math.floor(e/t);return r=r<0?r+1:r,e-r*t})(e,2*Math.PI);return Math.abs(t)<1e-6?0:(t<0&&(t+=2*Math.PI),t)},ii=new T.Matrix4,si=new T.Vector3,li=new T.Ray,ci=new T.Vector3,ui=({dir1:e,dir2:t,axis:r})=>{const{rotationLimits:n,annotations:o,annotationsClass:i,depthTest:s,scale:l,lineWidth:c,fixed:u,axisColors:d,hoveredColor:m,renderOrder:f,opacity:p,onDragStart:h,onDrag:x,onDragEnd:y,userData:v}=S.useContext(Yo),g=a.useThree((e=>e.controls)),w=S.useRef(null),z=S.useRef(null),b=S.useRef(0),E=S.useRef(0),M=S.useRef(null),[C,P]=S.useState(!1),R=S.useCallback((e=>{o&&(w.current.innerText=`${ai(E.current).toFixed(0)}º`,w.current.style.display="block"),e.stopPropagation();const t=e.point.clone(),n=(new T.Vector3).setFromMatrixPosition(z.current.matrixWorld),a=(new T.Vector3).setFromMatrixColumn(z.current.matrixWorld,0).normalize(),i=(new T.Vector3).setFromMatrixColumn(z.current.matrixWorld,1).normalize(),s=(new T.Vector3).setFromMatrixColumn(z.current.matrixWorld,2).normalize(),l=(new T.Plane).setFromNormalAndCoplanarPoint(s,n);M.current={clickPoint:t,origin:n,e1:a,e2:i,normal:s,plane:l},h({component:"Rotator",axis:r,origin:n,directions:[a,i,s]}),g&&(g.enabled=!1),e.target.setPointerCapture(e.pointerId)}),[o,g,h,r]),D=S.useCallback((e=>{if(e.stopPropagation(),C||P(!0),M.current){const{clickPoint:t,origin:a,e1:i,e2:s,normal:l,plane:c}=M.current,[u,d]=(null==n?void 0:n[r])||[void 0,void 0];li.copy(e.ray),li.intersectPlane(c,ci),li.direction.negate(),li.intersectPlane(c,ci);let m=((e,t,r,n,a)=>{ri.copy(e).sub(r),ni.copy(t).sub(r);const o=n.dot(n),i=a.dot(a),s=ri.dot(n)/o,l=ri.dot(a)/i,c=ni.dot(n)/o,u=ni.dot(a)/i,d=Math.atan2(l,s);return Math.atan2(u,c)-d})(t,ci,a,i,s),f=ai(m);e.shiftKey&&(f=10*Math.round(f/10),m=(e=>e*Math.PI/180)(f)),void 0!==u&&void 0!==d&&d-u<2*Math.PI?(m=oi(m),m=m>Math.PI?m-2*Math.PI:m,m=T.MathUtils.clamp(m,u-b.current,d-b.current),E.current=b.current+m):(E.current=oi(b.current+m),E.current=E.current>Math.PI?E.current-2*Math.PI:E.current),o&&(f=ai(E.current),w.current.innerText=`${f.toFixed(0)}º`),ii.makeRotationAxis(l,m),si.copy(a).applyMatrix4(ii).sub(a).negate(),ii.setPosition(si),x(ii)}}),[o,x,C,n,r]),F=S.useCallback((e=>{o&&(w.current.style.display="none"),e.stopPropagation(),b.current=E.current,M.current=null,y(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[o,g,y]),k=S.useCallback((e=>{e.stopPropagation(),P(!1)}),[]),_=S.useMemo((()=>{const r=e.clone().normalize(),n=t.clone().normalize();return(new T.Matrix4).makeBasis(r,n,r.clone().cross(n))}),[e,t]),A=u?.65:.65*l,L=S.useMemo((()=>{const e=[];for(let t=0;t<=32;t++){const r=t*(Math.PI/2)/32;e.push(new T.Vector3(Math.cos(r)*A,Math.sin(r)*A,0))}return e}),[A]);return S.createElement("group",{ref:z,onPointerDown:R,onPointerMove:D,onPointerUp:F,onPointerOut:k,matrix:_,matrixAutoUpdate:!1},o&&S.createElement(j,{position:[A,A,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:i,ref:w})),S.createElement(ce,{points:L,lineWidth:4*c,visible:!1,userData:v}),S.createElement(ce,{transparent:!0,raycast:()=>null,depthTest:s,points:L,lineWidth:c,side:T.DoubleSide,color:C?m:d[r],opacity:p,polygonOffset:!0,polygonOffsetFactor:-10,renderOrder:f,fog:!1}))},di=new T.Ray,mi=new T.Vector3,fi=new T.Matrix4,pi=({dir1:e,dir2:t,axis:r})=>{const{translation:n,translationLimits:o,annotations:i,annotationsClass:s,depthTest:l,scale:c,lineWidth:u,fixed:d,axisColors:m,hoveredColor:f,opacity:p,renderOrder:h,onDragStart:x,onDrag:y,onDragEnd:v,userData:g}=S.useContext(Yo),w=a.useThree((e=>e.controls)),z=S.useRef(null),b=S.useRef(null),E=S.useRef(null),M=S.useRef(0),C=S.useRef(0),[P,R]=S.useState(!1),D=S.useCallback((e=>{i&&(z.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`,z.current.style.display="block"),e.stopPropagation();const t=e.point.clone(),a=(new T.Vector3).setFromMatrixPosition(b.current.matrixWorld),o=(new T.Vector3).setFromMatrixColumn(b.current.matrixWorld,0).normalize(),s=(new T.Vector3).setFromMatrixColumn(b.current.matrixWorld,1).normalize(),l=(new T.Vector3).setFromMatrixColumn(b.current.matrixWorld,2).normalize(),c=(new T.Plane).setFromNormalAndCoplanarPoint(l,a);E.current={clickPoint:t,e1:o,e2:s,plane:c},M.current=n.current[(r+1)%3],C.current=n.current[(r+2)%3],x({component:"Slider",axis:r,origin:a,directions:[o,s,l]}),w&&(w.enabled=!1),e.target.setPointerCapture(e.pointerId)}),[i,w,x,r]),F=S.useCallback((e=>{if(e.stopPropagation(),P||R(!0),E.current){const{clickPoint:t,e1:a,e2:s,plane:l}=E.current,[c,u]=(null==o?void 0:o[(r+1)%3])||[void 0,void 0],[d,m]=(null==o?void 0:o[(r+2)%3])||[void 0,void 0];di.copy(e.ray),di.intersectPlane(l,mi),di.direction.negate(),di.intersectPlane(l,mi),mi.sub(t);let[f,p]=((e,t,r)=>{const n=Math.abs(e.x)>=Math.abs(e.y)&&Math.abs(e.x)>=Math.abs(e.z)?0:Math.abs(e.y)>=Math.abs(e.x)&&Math.abs(e.y)>=Math.abs(e.z)?1:2,a=[0,1,2].sort(((e,r)=>Math.abs(t.getComponent(r))-Math.abs(t.getComponent(e)))),o=n===a[0]?a[1]:a[0],i=e.getComponent(n),s=e.getComponent(o),l=t.getComponent(n),c=t.getComponent(o),u=r.getComponent(n),d=(r.getComponent(o)-u*(s/i))/(c-l*(s/i));return[(u-d*l)/i,d]})(a,s,mi);void 0!==c&&(f=Math.max(f,c-M.current)),void 0!==u&&(f=Math.min(f,u-M.current)),void 0!==d&&(p=Math.max(p,d-C.current)),void 0!==m&&(p=Math.min(p,m-C.current)),n.current[(r+1)%3]=M.current+f,n.current[(r+2)%3]=C.current+p,i&&(z.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`),fi.makeTranslation(f*a.x+p*s.x,f*a.y+p*s.y,f*a.z+p*s.z),y(fi)}}),[i,y,P,n,o,r]),k=S.useCallback((e=>{i&&(z.current.style.display="none"),e.stopPropagation(),E.current=null,v(),w&&(w.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[i,w,v]),_=S.useCallback((e=>{e.stopPropagation(),R(!1)}),[]),A=S.useMemo((()=>{const r=e.clone().normalize(),n=t.clone().normalize();return(new T.Matrix4).makeBasis(r,n,r.clone().cross(n))}),[e,t]),L=d?1/7:c/7,I=d?.225:.225*c,B=P?f:m[r],U=S.useMemo((()=>[new T.Vector3(0,0,0),new T.Vector3(0,I,0),new T.Vector3(I,I,0),new T.Vector3(I,0,0),new T.Vector3(0,0,0)]),[I]);return S.createElement("group",{ref:b,matrix:A,matrixAutoUpdate:!1},i&&S.createElement(j,{position:[0,0,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:s,ref:z})),S.createElement("group",{position:[1.7*L,1.7*L,0]},S.createElement("mesh",{visible:!0,onPointerDown:D,onPointerMove:F,onPointerUp:k,onPointerOut:_,scale:I,userData:g,renderOrder:h},S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,depthTest:l,color:B,polygonOffset:!0,polygonOffsetFactor:-10,side:T.DoubleSide,fog:!1})),S.createElement(ce,{position:[-I/2,-I/2,0],transparent:!0,depthTest:l,points:U,lineWidth:u,color:B,opacity:p,polygonOffset:!0,polygonOffsetFactor:-10,userData:g,fog:!1,renderOrder:h})))},hi=new T.Vector3,xi=new T.Vector3,yi=new T.Vector3(0,1,0),vi=new T.Vector3,gi=new T.Matrix4,wi=({direction:e,axis:t})=>{const{scaleLimits:r,annotations:n,annotationsClass:o,depthTest:i,scale:s,lineWidth:l,fixed:c,axisColors:u,hoveredColor:d,opacity:m,renderOrder:f,onDragStart:p,onDrag:h,onDragEnd:x,userData:y}=S.useContext(Yo),v=a.useThree((e=>e.size)),g=a.useThree((e=>e.controls)),w=S.useRef(null),z=S.useRef(null),b=S.useRef(null),E=S.useRef(1),M=S.useRef(1),C=S.useRef(null),[P,R]=S.useState(!1),D=c?1.2:1.2*s,F=S.useCallback((r=>{n&&(w.current.innerText=`${M.current.toFixed(2)}`,w.current.style.display="block"),r.stopPropagation();const a=(new T.Matrix4).extractRotation(z.current.matrixWorld),o=r.point.clone(),i=(new T.Vector3).setFromMatrixPosition(z.current.matrixWorld),l=e.clone().applyMatrix4(a).normalize(),u=z.current.matrixWorld.clone(),d=u.clone().invert(),m=c?1/ie(z.current.getWorldPosition(hi),s,r.camera,v):1;C.current={clickPoint:o,dir:l,mPLG:u,mPLGInv:d,offsetMultiplier:m},p({component:"Sphere",axis:t,origin:i,directions:[l]}),g&&(g.enabled=!1),r.target.setPointerCapture(r.pointerId)}),[n,g,e,p,t,c,s,v]),k=S.useCallback((e=>{if(e.stopPropagation(),P||R(!0),C.current){const{clickPoint:a,dir:o,mPLG:i,mPLGInv:l,offsetMultiplier:u}=C.current,[d,m]=(null==r?void 0:r[t])||[1e-5,void 0],f=((e,t,r,n)=>{const a=t.dot(t),o=t.dot(e)-t.dot(r),i=t.dot(n);return 0===i?-o/a:(hi.copy(n).multiplyScalar(a/i).sub(t),xi.copy(n).multiplyScalar(o/i).add(r).sub(e),-hi.dot(xi)/hi.dot(hi))})(a,o,e.ray.origin,e.ray.direction),p=f*u,x=c?p:p/s;let y=Math.pow(2,.2*x);e.shiftKey&&(y=Math.round(10*y)/10),y=Math.max(y,d/E.current),void 0!==m&&(y=Math.min(y,m/E.current)),M.current=E.current*y,b.current.position.set(0,D+p,0),n&&(w.current.innerText=`${M.current.toFixed(2)}`),vi.set(1,1,1),vi.setComponent(t,y),gi.makeScale(vi.x,vi.y,vi.z).premultiply(i).multiply(l),h(gi)}}),[n,D,h,P,r,t]),_=S.useCallback((e=>{n&&(w.current.style.display="none"),e.stopPropagation(),E.current=M.current,C.current=null,b.current.position.set(0,D,0),x(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[n,g,x,D]),A=S.useCallback((e=>{e.stopPropagation(),R(!1)}),[]),{radius:L,matrixL:I}=S.useMemo((()=>{const t=c?l/s*1.8:s/22.5,r=(new T.Quaternion).setFromUnitVectors(yi,e.clone().normalize());return{radius:t,matrixL:(new T.Matrix4).makeRotationFromQuaternion(r)}}),[e,s,l,c]),B=P?d:u[t];return S.createElement("group",{ref:z},S.createElement("group",{matrix:I,matrixAutoUpdate:!1,onPointerDown:F,onPointerMove:k,onPointerUp:_,onPointerOut:A},n&&S.createElement(j,{position:[0,D/2,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:o,ref:w})),S.createElement("mesh",{ref:b,position:[0,D,0],renderOrder:f,userData:y},S.createElement("sphereGeometry",{args:[L,12,12]}),S.createElement("meshBasicMaterial",{transparent:!0,depthTest:i,color:B,opacity:m,polygonOffset:!0,polygonOffsetFactor:-10}))))},zi=new T.Matrix4,bi=new T.Matrix4,Ei=new T.Matrix4,Mi=new T.Matrix4,Si=new T.Matrix4,Ci=new T.Matrix4,Ti=new T.Matrix4,Pi=new T.Matrix4,Ri=new T.Matrix4,Di=new T.Box3,Fi=new T.Box3,ki=new T.Vector3,_i=new T.Vector3,Ai=new T.Vector3,Li=new T.Vector3,Ii=new T.Vector3,Bi=new T.Vector3(1,0,0),Ui=new T.Vector3(0,1,0),Vi=new T.Vector3(0,0,1),Oi=S.forwardRef((({enabled:e=!0,matrix:t,onDragStart:r,onDrag:n,onDragEnd:o,autoTransform:i=!0,anchor:s,disableAxes:l=!1,disableSliders:c=!1,disableRotations:u=!1,disableScaling:d=!1,activeAxes:m=[!0,!0,!0],offset:f=[0,0,0],rotation:p=[0,0,0],scale:h=1,lineWidth:x=4,fixed:y=!1,translationLimits:v,rotationLimits:g,scaleLimits:w,depthTest:z=!0,renderOrder:b=500,axisColors:E=["#ff2060","#20df80","#2080ff"],hoveredColor:C="#ffff40",annotations:P=!1,annotationsClass:R,opacity:D=1,visible:F=!0,userData:k,children:_,...A},L)=>{const I=a.useThree((e=>e.invalidate)),B=S.useRef(null),U=S.useRef(null),V=S.useRef(null),O=S.useRef(null),N=S.useRef([0,0,0]),j=S.useRef(new T.Vector3(1,1,1)),W=S.useRef(new T.Vector3(1,1,1));S.useLayoutEffect((()=>{s&&(O.current.updateWorldMatrix(!0,!0),Mi.copy(O.current.matrixWorld).invert(),Di.makeEmpty(),O.current.traverse((e=>{e.geometry&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),Ci.copy(e.matrixWorld).premultiply(Mi),Fi.copy(e.geometry.boundingBox),Fi.applyMatrix4(Ci),Di.union(Fi))})),ki.copy(Di.max).add(Di.min).multiplyScalar(.5),_i.copy(Di.max).sub(Di.min).multiplyScalar(.5),Ai.copy(_i).multiply(new T.Vector3(...s)).add(ki),Li.set(...f).add(Ai),V.current.position.copy(Li),I())}));const G=S.useMemo((()=>({onDragStart:e=>{zi.copy(U.current.matrix),bi.copy(U.current.matrixWorld),r&&r(e),I()},onDrag:e=>{Ei.copy(B.current.matrixWorld),Mi.copy(Ei).invert(),Si.copy(bi).premultiply(e),Ci.copy(Si).premultiply(Mi),Ti.copy(zi).invert(),Pi.copy(Ci).multiply(Ti),i&&U.current.matrix.copy(Ci),n&&n(Ci,Pi,Si,e),I()},onDragEnd:()=>{o&&o(),I()},translation:N,translationLimits:v,rotationLimits:g,axisColors:E,hoveredColor:C,opacity:D,scale:h,lineWidth:x,fixed:y,depthTest:z,renderOrder:b,userData:k,annotations:P,annotationsClass:R})),[r,n,o,N,v,g,w,z,h,x,y,...E,C,D,k,i,P,R]),H=new T.Vector3;return a.useFrame((e=>{if(y){const t=ie(V.current.getWorldPosition(H),h,e.camera,e.size);j.current.setScalar(t)}t&&t instanceof T.Matrix4&&(U.current.matrix=t),U.current.updateWorldMatrix(!0,!0),Ri.makeRotationFromEuler(V.current.rotation).setPosition(V.current.position).premultiply(U.current.matrixWorld),W.current.setFromMatrixScale(Ri),Ii.copy(j.current).divide(W.current),(Math.abs(V.current.scale.x-Ii.x)>1e-4||Math.abs(V.current.scale.y-Ii.y)>1e-4||Math.abs(V.current.scale.z-Ii.z)>1e-4)&&(V.current.scale.copy(Ii),e.invalidate())})),S.useImperativeHandle(L,(()=>U.current),[]),S.createElement(Yo.Provider,{value:G},S.createElement("group",{ref:B},S.createElement("group",M.default({ref:U,matrix:t,matrixAutoUpdate:!1},A),S.createElement("group",{visible:F,ref:V,position:f,rotation:p},e&&S.createElement(S.Fragment,null,!l&&m[0]&&S.createElement(ti,{axis:0,direction:Bi}),!l&&m[1]&&S.createElement(ti,{axis:1,direction:Ui}),!l&&m[2]&&S.createElement(ti,{axis:2,direction:Vi}),!c&&m[0]&&m[1]&&S.createElement(pi,{axis:2,dir1:Bi,dir2:Ui}),!c&&m[0]&&m[2]&&S.createElement(pi,{axis:1,dir1:Vi,dir2:Bi}),!c&&m[2]&&m[1]&&S.createElement(pi,{axis:0,dir1:Ui,dir2:Vi}),!u&&m[0]&&m[1]&&S.createElement(ui,{axis:2,dir1:Bi,dir2:Ui}),!u&&m[0]&&m[2]&&S.createElement(ui,{axis:1,dir1:Vi,dir2:Bi}),!u&&m[2]&&m[1]&&S.createElement(ui,{axis:0,dir1:Ui,dir2:Vi}),!d&&m[0]&&S.createElement(wi,{axis:0,direction:Bi}),!d&&m[1]&&S.createElement(wi,{axis:1,direction:Ui}),!d&&m[2]&&S.createElement(wi,{axis:2,direction:Vi}))),S.createElement("group",{ref:O},_))))})),Ni=t.forwardRef((({options:e={video:!0},...r},n)=>{const a=m.suspend((()=>navigator.mediaDevices.getDisplayMedia(e)),[]);return t.useEffect((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop())),m.clear([])}),[a]),S.createElement(nr,M.default({ref:n},r,{src:a}))})),ji=t.forwardRef((({constraints:e={audio:!1,video:{facingMode:"user"}},...r},n)=>{const a=m.suspend((()=>navigator.mediaDevices.getUserMedia(e)),[]);return t.useEffect((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop())),m.clear([])}),[a]),S.createElement(nr,M.default({ref:n},r,{src:a}))})),Wi=new T.Vector3(0,0,-1),Gi=function(){const e=new T.Vector3,t=new T.Vector3,r=new T.Vector3,n=new T.Vector3,a=new T.Vector3;return function(o,i,s,l){return e.copy(o),t.copy(i),r.copy(s),n.copy(t).sub(e),a.copy(r).sub(e),l.crossVectors(a,n).normalize()}}();const Hi=S.forwardRef((({points:e=Xi.SAMPLE_FACELANDMARKER_RESULT.faceLandmarks[0],face:t,facialTransformationMatrix:r,faceBlendshapes:n,offset:o,offsetScalar:i=80,width:s,height:l,depth:c=1,verticalTri:u=[159,386,152],origin:d,eyes:m=!0,eyesAsOrigin:f=!1,debug:p=!1,children:h,...x},y)=>{var v;t&&(e=t.keypoints,console.warn("Facemesh `face` prop is deprecated: use `points` instead"));const g=S.useRef(null),w=S.useRef(null),z=S.useRef(null),b=S.useRef(null),E=S.useRef(null),M=S.useRef(null),C=S.useRef(null),[P]=S.useState((()=>new T.Vector3)),[R]=S.useState((()=>new T.Object3D)),[D]=S.useState((()=>new T.Quaternion)),[F]=S.useState((()=>new T.Vector3)),{invalidate:k}=a.useThree();S.useEffect((()=>{var e;null==(e=E.current)||e.geometry.setIndex(Xi.TRIANGULATION)}),[]);const[_]=S.useState((()=>new T.Vector3));S.useEffect((()=>{var t,a;const h=null==(t=E.current)?void 0:t.geometry;if(!h)return;var x,y;(h.setFromPoints(e),h.setDrawRange(0,Xi.TRIANGULATION.length),r)?(R.matrix.fromArray(r.data),R.matrix.decompose(R.position,R.quaternion,R.scale),R.rotation.y*=-1,R.rotation.z*=-1,D.setFromEuler(R.rotation),o?(R.position.y*=-1,R.position.z*=-1,null==(x=g.current)||x.position.copy(R.position.divideScalar(i))):null==(y=g.current)||y.position.set(0,0,0)):(Gi(e[u[0]],e[u[1]],e[u[2]],P),D.setFromUnitVectors(Wi,P));const v=D.clone().invert();if(h.computeBoundingBox(),p&&k(),h.center(),h.applyQuaternion(v),null==(a=b.current)||a.setRotationFromQuaternion(D),m)if(n){if(M.current&&C.current&&z.current)if(f){const e=M.current._computeSphere(h),t=C.current._computeSphere(h),r=function(e,t){return e.clone().add(t).multiplyScalar(.5)}(e.center,t.center);d=r.negate(),M.current._update(h,n,e),C.current._update(h,n,t)}else M.current._update(h,n),C.current._update(h,n)}else console.warn("Facemesh `eyes` option only works if `faceBlendshapes` is provided: skipping.");if(z.current){if(void 0!==d)if("number"==typeof d){const e=h.getAttribute("position");F.set(-e.getX(d),-e.getY(d),-e.getZ(d))}else d.isVector3&&F.copy(d);else F.setScalar(0);z.current.position.copy(F)}if(w.current){let e=1;(s||l||c)&&(h.boundingBox.getSize(_),s&&(e=s/_.x),l&&(e=l/_.y),c&&(e=c/_.z)),w.current.scale.setScalar(1!==e?e:1)}h.computeVertexNormals(),h.attributes.position.needsUpdate=!0}),[e,r,n,R,o,i,s,l,c,u,d,m,p,k,P,D,_,F]);const A=S.useMemo((()=>({outerRef:b,meshRef:E,eyeRightRef:M,eyeLeftRef:C})),[]);S.useImperativeHandle(y,(()=>A),[A]);const[L]=S.useState((()=>new T.Vector3)),I=null==(v=E.current)?void 0:v.geometry.boundingBox,B=(null==I?void 0:I.getSize(L).z)||1;return S.createElement("group",x,S.createElement("group",{ref:g},S.createElement("group",{ref:b},S.createElement("group",{ref:w},p?S.createElement(S.Fragment,null,S.createElement("axesHelper",{args:[B]}),S.createElement(ce,{points:[[0,0,0],[0,0,-B]],color:65535})):null,S.createElement("group",{ref:z},m&&n&&S.createElement("group",{name:"eyes"},S.createElement(qi,{side:"left",ref:M,debug:p}),S.createElement(qi,{side:"right",ref:C,debug:p})),S.createElement("mesh",{ref:E,name:"face"},h,p?S.createElement(S.Fragment,null,I&&S.createElement("box3Helper",{args:[I]})):null))))))})),$i={contourLandmarks:{right:[33,133,159,145,153],left:[263,362,386,374,380]},blendshapes:{right:[14,16,18,12],left:[13,15,17,11]},color:{right:"red",left:"#00ff00"},fov:{horizontal:100,vertical:90}},qi=S.forwardRef((({side:e,debug:t=!0},r)=>{const n=S.useRef(null),a=S.useRef(null),[o]=S.useState((()=>new T.Sphere)),i=S.useCallback((t=>{const r=t.getAttribute("position"),n=$i.contourLandmarks[e].map((e=>new T.Vector3(r.getX(e),r.getY(e),r.getZ(e))));return o.center.set(0,0,0),n.forEach((e=>o.center.add(e))),o.center.divideScalar(n.length),o.radius=n[0].sub(n[1]).length()/2,o}),[o,e]),[s]=S.useState((()=>new T.Euler)),l=S.useCallback(((t,r,o)=>{var l;n.current&&(null!==(l=o)&&void 0!==l||(o=i(t)),n.current.position.copy(o.center),n.current.scale.setScalar(o.radius));if(r&&a.current){const t=$i.blendshapes[e],n=r.categories[t[0]].score,o=r.categories[t[1]].score,i=r.categories[t[2]].score,l=r.categories[t[3]].score,c=.5*($i.fov.horizontal*T.MathUtils.DEG2RAD)*(l-i),u=.5*($i.fov.vertical*T.MathUtils.DEG2RAD)*(n-o)*("left"===e?1:-1);s.set(c,u,0),a.current.setRotationFromEuler(s)}}),[i,e,s]),c=S.useMemo((()=>({eyeMeshRef:n,irisDirRef:a,_computeSphere:i,_update:l})),[i,l]);S.useImperativeHandle(r,(()=>c),[c]);const u=$i.color[e];return S.createElement("group",null,S.createElement("group",{ref:n},t&&S.createElement("axesHelper",null),S.createElement("group",{ref:a},S.createElement(S.Fragment,null,t&&S.createElement(ce,{points:[[0,0,0],[0,0,-2]],lineWidth:1,color:u})))))})),Xi={TRIANGULATION:[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255],SAMPLE_FACE:{keypoints:[{x:356.2804412841797,y:295.1960563659668,z:-23.786449432373047,name:"lips"},{x:354.8859405517578,y:264.69520568847656,z:-36.718435287475586},{x:355.2180862426758,y:275.3360366821289,z:-21.183712482452393},{x:347.349853515625,y:242.4400234222412,z:-25.093655586242676},{x:354.40135955810547,y:256.67933464050293,z:-38.23572635650635},{x:353.7689971923828,y:247.54886627197266,z:-34.5475435256958},{x:352.1288299560547,y:227.34312057495117,z:-13.095386028289795},{x:303.5013198852539,y:234.67002868652344,z:12.500141859054565,name:"rightEye"},{x:351.09378814697266,y:211.87547206878662,z:-6.413471698760986},{x:350.7115936279297,y:202.1251630783081,z:-6.413471698760986},{x:348.33667755126953,y:168.7741756439209,z:6.483500003814697,name:"faceOval"},{x:356.4806365966797,y:299.2995357513428,z:-23.144519329071045},{x:356.5511703491211,y:302.66146659851074,z:-21.020312309265137},{x:356.6239547729492,y:304.1536331176758,z:-18.137459754943848,name:"lips"},{x:356.5807342529297,y:305.1840591430664,z:-18.767719268798828,name:"lips"},{x:356.8241500854492,y:308.25711250305176,z:-20.16829490661621},{x:357.113037109375,y:312.26277351379395,z:-22.10575819015503},{x:357.34962463378906,y:317.1123218536377,z:-21.837315559387207,name:"lips"},{x:357.6658630371094,y:325.51036834716797,z:-16.27002477645874},{x:355.0201416015625,y:269.36279296875,z:-33.73054027557373},{x:348.5237503051758,y:270.33411026000977,z:-24.93025302886963},{x:279.97331619262695,y:213.24176788330078,z:47.759642601013184,name:"faceOval"},{x:322.66529083251953,y:238.5027265548706,z:5.535193085670471},{x:316.0983657836914,y:239.94489669799805,z:5.777376294136047},{x:309.9431610107422,y:240.24518966674805,z:7.510589361190796},{x:301.31994247436523,y:237.86138534545898,z:13.118728399276733},{x:328.14266204833984,y:235.80496788024902,z:6.646900177001953},{x:313.7326431274414,y:222.11161136627197,z:3.9887237548828125},{x:320.45196533203125,y:221.87729358673096,z:4.601476192474365},{x:307.35679626464844,y:223.63793849945068,z:5.932023525238037},{x:303.0031204223633,y:226.3743782043457,z:8.479321002960205},{x:296.80023193359375,y:242.94299125671387,z:15.931552648544312},{x:332.2352981567383,y:340.77341079711914,z:-10.165848731994629},{x:301.38587951660156,y:233.46447944641113,z:14.764405488967896,name:"rightEye"},{x:279.0147018432617,y:244.37155723571777,z:45.77549457550049},{x:289.60548400878906,y:239.1807460784912,z:23.191204071044922},{x:320.32257080078125,y:267.1292781829834,z:-4.954537749290466},{x:347.64583587646484,y:294.4955062866211,z:-23.062820434570312,name:"lips"},{x:349.28138732910156,y:303.1095886230469,z:-20.238323211669922},{x:338.9453125,y:298.19186210632324,z:-19.456336498260498,name:"lips"},{x:333.36788177490234,y:302.6706790924072,z:-14.776077270507812,name:"lips"},{x:342.89188385009766,y:304.3561363220215,z:-17.752301692962646},{x:337.7375030517578,y:306.0098361968994,z:-13.410515785217285},{x:325.6159210205078,y:316.22995376586914,z:-6.681914925575256},{x:349.0104675292969,y:264.9818515777588,z:-36.274919509887695},{x:347.7138900756836,y:257.5664806365967,z:-37.67549514770508},{x:291.79357528686523,y:218.88171672821045,z:11.578094959259033,name:"rightEyebrow"},{x:332.2689437866211,y:247.56946563720703,z:-3.3730539679527283},{x:332.0074462890625,y:267.1201229095459,z:-19.969879388809204},{x:331.27952575683594,y:263.6967658996582,z:-17.47218608856201},{x:301.04373931884766,y:269.56552505493164,z:3.61815482378006},{x:347.4863815307617,y:249.0706443786621,z:-32.633421421051025},{x:307.26118087768555,y:208.2646894454956,z:1.1591226607561111,name:"rightEyebrow"},{x:297.91919708251953,y:212.22604751586914,z:5.914516448974609,name:"rightEyebrow"},{x:285.1651382446289,y:197.98450469970703,z:36.391637325286865,name:"faceOval"},{x:337.04097747802734,y:211.25229835510254,z:-4.548954665660858},{x:326.5912628173828,y:223.16698551177979,z:6.670243740081787},{x:320.05664825439453,y:309.5834255218506,z:-4.055835008621216},{x:289.6866226196289,y:314.617395401001,z:53.875489234924316,name:"faceOval"},{x:337.4256896972656,y:270.8755302429199,z:-17.67060160636902},{x:343.69922637939453,y:273.0000400543213,z:-18.756048679351807},{x:327.4242401123047,y:309.22399520874023,z:-4.703601002693176,name:"lips"},{x:330.37220001220703,y:308.3323001861572,z:-6.442649960517883},{x:293.87027740478516,y:207.7961826324463,z:9.821539521217346,name:"rightEyebrow"},{x:332.11437225341797,y:271.22812271118164,z:-16.64351224899292},{x:320.1197814941406,y:207.40366458892822,z:-2.48164564371109,name:"rightEyebrow"},{x:318.59575271606445,y:201.07443809509277,z:-3.110446035861969,name:"rightEyebrow"},{x:310.72303771972656,y:175.75075149536133,z:13.328815698623657,name:"faceOval"},{x:289.67578887939453,y:202.29835510253906,z:21.370456218719482},{x:315.30879974365234,y:187.35260009765625,z:5.0304025411605835},{x:287.8936767578125,y:216.54793739318848,z:17.81065821647644,name:"rightEyebrow"},{x:283.9391899108887,y:215.01142501831055,z:32.04984903335571},{x:348.35330963134766,y:299.4155788421631,z:-22.47924566268921},{x:341.1790466308594,y:301.8221855163574,z:-18.977805376052856},{x:335.69713592529297,y:304.4266891479492,z:-14.682706594467163},{x:339.4615173339844,y:272.3654365539551,z:-16.38674020767212},{x:328.99600982666016,y:308.86685371398926,z:-5.616893768310547},{x:332.00313568115234,y:309.1875743865967,z:-10.335084199905396},{x:331.0068130493164,y:307.9274368286133,z:-6.681914925575256,name:"lips"},{x:341.13792419433594,y:266.4876937866211,z:-26.56425952911377},{x:339.02950286865234,y:305.6663703918457,z:-12.33674168586731,name:"lips"},{x:344.22935485839844,y:304.9452781677246,z:-15.161235332489014,name:"lips"},{x:350.1844024658203,y:304.374303817749,z:-17.5305438041687,name:"lips"},{x:348.52630615234375,y:325.9562301635742,z:-16.164982318878174},{x:348.6581802368164,y:317.1624183654785,z:-21.510512828826904,name:"lips"},{x:348.9766311645508,y:312.1923065185547,z:-21.708929538726807},{x:349.2427444458008,y:308.0660820007324,z:-19.643079042434692},{x:349.67491149902344,y:305.42747497558594,z:-18.16080331802368,name:"lips"},{x:337.95589447021484,y:306.6535949707031,z:-12.803598642349243,name:"lips"},{x:337.06878662109375,y:307.63169288635254,z:-14.274203777313232},{x:335.77449798583984,y:309.8449516296387,z:-15.698124170303345},{x:334.6099090576172,y:312.7997016906738,z:-14.764405488967896,name:"lips"},{x:327.2330856323242,y:293.80866050720215,z:-11.864047050476074},{x:280.97679138183594,y:279.79928970336914,z:68.90834331512451,name:"faceOval"},{x:355.13843536376953,y:271.7875671386719,z:-25.350427627563477},{x:334.7235870361328,y:307.4656391143799,z:-9.302158951759338,name:"lips"},{x:333.5293960571289,y:307.89782524108887,z:-10.200862884521484},{x:346.29688262939453,y:276.4256286621094,z:-19.748122692108154},{x:335.16246795654297,y:276.22097969055176,z:-12.313398122787476},{x:345.09132385253906,y:274.7082996368408,z:-19.304605722427368},{x:325.4267883300781,y:252.95130729675293,z:-1.6661019623279572},{x:315.347843170166,y:259.05200958251953,z:-.25604281574487686},{x:330.44933319091797,y:267.7570152282715,z:-14.017432928085327},{x:294.96768951416016,y:185.26001930236816,z:23.903164863586426,name:"faceOval"},{x:299.63531494140625,y:192.7913761138916,z:12.640198469161987},{x:304.5452117919922,y:202.4142837524414,z:3.244667649269104,name:"rightEyebrow"},{x:331.6915512084961,y:320.0467872619629,z:-10.632705688476562},{x:334.5911407470703,y:201.27566814422607,z:-6.133356094360352,name:"rightEyebrow"},{x:331.4815902709961,y:185.44180870056152,z:.6627205014228821},{x:328.05816650390625,y:170.8385467529297,z:7.358860373497009,name:"faceOval"},{x:304.49764251708984,y:239.76297855377197,z:10.387605428695679},{x:290.6382179260254,y:248.85257720947266,z:19.03616428375244},{x:331.5682601928711,y:233.20727348327637,z:7.837390303611755},{x:295.5115509033203,y:228.9834451675415,z:14.41426157951355},{x:336.94332122802734,y:241.8259334564209,z:-5.27842104434967},{x:336.2792205810547,y:262.7049922943115,z:-26.12074375152588},{x:284.4102478027344,y:255.3262710571289,z:25.467140674591064},{x:295.1420593261719,y:253.02655220031738,z:12.430112361907959},{x:303.5196113586426,y:254.20703887939453,z:6.139191389083862},{x:315.73450088500977,y:251.64799690246582,z:3.3788898587226868},{x:324.69661712646484,y:247.56494522094727,z:2.3328344523906708},{x:331.57970428466797,y:243.02241325378418,z:1.1423448473215103},{x:345.6210708618164,y:229.9976634979248,z:-10.825285911560059},{x:286.26644134521484,y:270.37991523742676,z:21.708929538726807},{x:290.2525520324707,y:228.4921360015869,z:17.71728754043579},{x:351.65367126464844,y:269.3400764465332,z:-33.450424671173096},{x:333.1378936767578,y:253.88388633728027,z:-7.230473756790161},{x:277.8318977355957,y:246.95331573486328,z:68.20805549621582,name:"faceOval"},{x:336.6680908203125,y:238.10003757476807,z:.7688578963279724},{x:329.95800018310547,y:269.18323516845703,z:-7.207130789756775},{x:299.17491912841797,y:234.13324356079102,z:15.95489501953125},{x:335.61729431152344,y:258.71752738952637,z:-23.016133308410645},{x:284.1079330444336,y:297.0343494415283,z:63.25934886932373,name:"faceOval"},{x:331.44542694091797,y:230.6892442703247,z:9.92658257484436,name:"rightEye"},{x:341.41536712646484,y:253.01264762878418,z:-29.038610458374023},{x:303.5472869873047,y:327.5896739959717,z:16.725212335586548},{x:304.7756576538086,y:337.4389457702637,z:27.38126277923584,name:"faceOval"},{x:280.80501556396484,y:275.32050132751465,z:45.0752067565918},{x:295.43582916259766,y:318.4501647949219,z:26.2608003616333},{x:281.4303207397461,y:228.7355661392212,z:40.94350814819336},{x:331.2549591064453,y:349.4216537475586,z:-7.376367449760437},{x:352.4247741699219,y:271.7330074310303,z:-24.953596591949463},{x:327.5672912597656,y:260.41900634765625,z:-5.456410646438599},{x:284.5432472229004,y:241.7647933959961,z:29.668869972229004},{x:310,y:235.66174507141113,z:8.502663969993591,name:"rightEye"},{x:315.7071113586426,y:235.7572603225708,z:6.938687562942505,name:"rightEye"},{x:330.41088104248047,y:311.04143142700195,z:-9.325502514839172,name:"lips"},{x:288.5377502441406,y:285.31983375549316,z:21.837315559387207},{x:344.55039978027344,y:359.4300842285156,z:-6.705257892608643,name:"faceOval"},{x:323.41880798339844,y:351.67362213134766,z:7.802375555038452,name:"faceOval"},{x:314.64088439941406,y:346.11894607543945,z:16.36339783668518,name:"faceOval"},{x:349.4945526123047,y:184.8434829711914,z:-.21847527474164963},{x:359.24694061279297,y:359.8348903656006,z:-8.403456211090088,name:"faceOval"},{x:321.26182556152344,y:234.64492321014404,z:6.90950870513916,name:"rightEye"},{x:326.318359375,y:232.90250301361084,z:8.029969334602356,name:"rightEye"},{x:329.6211624145508,y:231.6195774078369,z:9.722331762313843,name:"rightEye"},{x:285.9398078918457,y:228.2351303100586,z:24.650139808654785},{x:325.79288482666016,y:227.88007736206055,z:7.469738721847534,name:"rightEye"},{x:320.1699447631836,y:227.5934886932373,z:6.168370842933655,name:"rightEye"},{x:314.85408782958984,y:227.85282611846924,z:6.2675780057907104,name:"rightEye"},{x:309.3084907531738,y:229.1516876220703,z:7.7031683921813965,name:"rightEye"},{x:305.5621337890625,y:230.92366218566895,z:9.722331762313843,name:"rightEye"},{x:277.8681945800781,y:228.5354232788086,z:59.71122741699219,name:"faceOval"},{x:306.1444664001465,y:235.1954698562622,z:10.603528022766113,name:"rightEye"},{x:355.4478454589844,y:281.96210861206055,z:-20.565123558044434},{x:333.02661895751953,y:288.0105400085449,z:-14.72939133644104},{x:337.15728759765625,y:269.2059516906738,z:-19.8414945602417},{x:345.9898376464844,y:283.5453128814697,z:-20.4834246635437},{x:351.48963928222656,y:219.98916149139404,z:-7.0378947257995605},{x:312.39574432373047,y:336.50628089904785,z:8.671900033950806},{x:321.32152557373047,y:343.1755256652832,z:.9067271649837494},{x:343.78379821777344,y:353.2975959777832,z:-14.355905055999756},{x:296.8791389465332,y:327.91497230529785,z:41.01353645324707,name:"faceOval"},{x:329.6939468383789,y:229.27897453308105,z:8.934508562088013,name:"rightEye"},{x:341.6905212402344,y:241.4073657989502,z:-14.589333534240723},{x:359.03079986572266,y:353.48859786987305,z:-15.803166627883911},{x:333.1861877441406,y:356.43213272094727,z:-1.0234417766332626,name:"faceOval"},{x:283.97483825683594,y:291.4318656921387,z:41.94725513458252},{x:343.33770751953125,y:305.830135345459,z:-15.756480693817139,name:"lips"},{x:342.40283966064453,y:307.7453899383545,z:-17.4021577835083},{x:341.53621673583984,y:311.0595703125,z:-19.047834873199463},{x:340.9107208251953,y:315.4837703704834,z:-18.5576331615448,name:"lips"},{x:339.1478729248047,y:323.42233657836914,z:-14.367576837539673},{x:333.3201599121094,y:307.4406337738037,z:-9.617288708686829},{x:331.2411117553711,y:306.9811820983887,z:-9.669809937477112},{x:329.23255920410156,y:306.0508346557617,z:-9.582273960113525,name:"lips"},{x:322.4586486816406,y:301.33323669433594,z:-7.720675468444824},{x:297.1712112426758,y:286.9552803039551,z:8.240055441856384},{x:341.3060760498047,y:235.4432201385498,z:-7.504753470420837},{x:336.9318389892578,y:224.3451976776123,z:5.829898118972778},{x:332.65323638916016,y:226.70403957366943,z:8.105834126472473},{x:334.67357635498047,y:306.4397621154785,z:-8.981193900108337,name:"lips"},{x:297.4601936340332,y:306.29210472106934,z:15.476365089416504},{x:342.9119110107422,y:222.37077713012695,z:-2.754466235637665},{x:335.4629898071289,y:332.20250129699707,z:-11.823196411132812},{x:353.2412338256836,y:240.56339263916016,z:-27.147831916809082},{x:346.3080596923828,y:236.41446590423584,z:-18.452589511871338},{x:352.6475143432617,y:234.1420555114746,z:-19.748122692108154},{x:337.3209762573242,y:253.39937210083008,z:-16.024924516677856},{x:358.6122131347656,y:344.90861892700195,z:-18.592647314071655},{x:358.1117248535156,y:334.64990615844727,z:-17.49552845954895},{x:346.4450454711914,y:335.0321102142334,z:-16.32838249206543},{x:319.17640686035156,y:320.2833938598633,z:-3.276764452457428},{x:325.2540588378906,y:276.2369728088379,z:-6.460157036781311},{x:326.7214584350586,y:327.3939514160156,z:-7.417217493057251},{x:310.7190132141113,y:277.2265148162842,z:-3.5452082753181458},{x:319.78355407714844,y:284.8238182067871,z:-6.4543211460113525},{x:305.773983001709,y:290.83580017089844,z:.06907138042151928},{x:344.4001770019531,y:344.85408782958984,z:-16.946970224380493},{x:333.1879425048828,y:258.74256134033203,z:-11.90489649772644},{x:313.80598068237305,y:327.08919525146484,z:2.2277912497520447},{x:322.9637908935547,y:334.6819496154785,z:-3.3643004298210144},{x:313.4055519104004,y:311.2166690826416,z:-1.1175429821014404},{x:291.0865783691406,y:298.2831001281738,z:22.467575073242188},{x:305.6580924987793,y:313.3707904815674,z:5.561453700065613},{x:288.23760986328125,y:305.9941864013672,z:36.765122413635254},{x:315.10692596435547,y:296.26991271972656,z:-4.604393839836121},{x:337.50518798828125,y:247.5944423675537,z:-10.597691535949707},{x:338.8450622558594,y:265.47778129577637,z:-27.778091430664062},{x:334.25254821777344,y:269.0671920776367,z:-20.938611030578613},{x:341.64512634277344,y:259.6387195587158,z:-32.189905643463135},{x:331.44081115722656,y:219.0976095199585,z:4.207563698291779},{x:320.56339263916016,y:216.49658203125,z:2.930997312068939},{x:311.21912002563477,y:216.57853603363037,z:2.9674705862998962},{x:303.46256256103516,y:218.54614734649658,z:5.357203483581543},{x:297.99999237060547,y:222.505202293396,z:9.325502514839172},{x:294.93839263916016,y:236.39654159545898,z:18.534289598464966},{x:278.87489318847656,y:259.7095584869385,z:45.68212032318115},{x:300.3782653808594,y:245.38593292236328,z:12.278382778167725},{x:307.06348419189453,y:246.36857986450195,z:8.164191246032715},{x:315.5229187011719,y:245.3949737548828,z:5.503097176551819},{x:323.71395111083984,y:242.75178909301758,z:4.6335723996162415},{x:330.2785873413086,y:239.34658527374268,z:4.937030673027039},{x:334.6982192993164,y:236.0460376739502,z:4.823233783245087},{x:279.3412208557129,y:263.5196113586426,z:70.91583728790283,name:"faceOval"},{x:334.65972900390625,y:271.6648578643799,z:-17.775644063949585},{x:342.05677032470703,y:246.99846267700195,z:-20.84523916244507},{x:344.0357971191406,y:264.5701503753662,z:-32.936880588531494},{x:348.25531005859375,y:268.6645030975342,z:-30.695960521697998},{x:344.12227630615234,y:266.34212493896484,z:-29.808926582336426},{x:337.12318420410156,y:274.2556858062744,z:-15.768152475357056},{x:349.49047088623047,y:269.071683883667,z:-32.51670837402344},{x:350.1683044433594,y:271.4691352844238,z:-24.93025302886963},{x:333.9634704589844,y:230.56639194488525,z:8.89949381351471},{x:338.2147979736328,y:231.4807891845703,z:4.6715047955513},{x:340.4712677001953,y:231.74463272094727,z:-.34996166825294495},{x:303.28975677490234,y:232.24980354309082,z:11.916568279266357,name:"rightEye"},{x:299.4649124145508,y:229.53842639923096,z:12.325069904327393},{x:359.09618377685547,y:241.77349090576172,z:-24.650139808654785},{x:399.46216583251953,y:229.89503860473633,z:15.919880867004395,name:"leftEye"},{x:361.38919830322266,y:269.6129894256592,z:-24.510080814361572},{x:416.9973373413086,y:206.0895538330078,z:53.26857566833496,name:"faceOval"},{x:381.32179260253906,y:235.5476474761963,z:7.6214683055877686},{x:387.8068542480469,y:236.25958442687988,z:8.345099091529846},{x:393.95751953125,y:235.8660364151001,z:10.475142002105713},{x:401.84600830078125,y:232.77019500732422,z:16.760226488113403},{x:375.70568084716797,y:233.48456382751465,z:8.234220147132874},{x:388.17752838134766,y:218.94717693328857,z:6.810300946235657},{x:381.64928436279297,y:219.2656660079956,z:6.711093783378601},{x:394.4760513305664,y:219.66821193695068,z:9.173773527145386},{x:398.8843536376953,y:221.8837022781372,z:12.03328251838684},{x:406.5454864501953,y:237.12156772613525,z:19.7131085395813},{x:383.87447357177734,y:337.6932907104492,z:-8.631049990653992},{x:401.2682342529297,y:228.5916566848755,z:18.359217643737793,name:"leftEye"},{x:422.0449447631836,y:236.73934936523438,z:51.16771221160889},{x:412.69153594970703,y:232.80198097229004,z:27.52131938934326},{x:387.3497772216797,y:263.298397064209,z:-2.8609684109687805},{x:364.5124053955078,y:293.39221000671387,z:-22.397546768188477,name:"lips"},{x:363.62987518310547,y:302.1291446685791,z:-19.643079042434692},{x:373.2334518432617,y:295.8647060394287,z:-18.125789165496826,name:"lips"},{x:378.83365631103516,y:299.5177745819092,z:-13.153743743896484,name:"lips"},{x:369.91477966308594,y:302.5704002380371,z:-16.65518283843994},{x:374.9167251586914,y:303.5416603088379,z:-11.963253021240234},{x:387.58888244628906,y:312.2716999053955,z:-4.680258631706238},{x:360.6635284423828,y:264.31986808776855,z:-35.94811677932739},{x:361.04564666748047,y:256.8225860595703,z:-37.278664112091064},{x:408.3855438232422,y:213.52088928222656,z:15.756480693817139,name:"leftEyebrow"},{x:373.2946014404297,y:245.38101196289062,z:-1.9316278398036957},{x:376.83860778808594,y:264.3721103668213,z:-18.510947227478027},{x:376.9546127319336,y:261.0010528564453,z:-15.989909172058105},{x:406.1498260498047,y:263.5030174255371,z:7.072908878326416},{x:360.07205963134766,y:248.3631706237793,z:-32.16656446456909},{x:393.11119079589844,y:205.10473251342773,z:3.7786373496055603,name:"leftEyebrow"},{x:402.12791442871094,y:207.89000988006592,z:9.383859634399414,name:"leftEyebrow"},{x:410.8693313598633,y:191.6182279586792,z:41.27030849456787,name:"faceOval"},{x:364.9509811401367,y:210.40483474731445,z:-3.758212625980377},{x:375.94444274902344,y:221.1331844329834,z:8.368442058563232},{x:392.1904754638672,y:305.0360298156738,z:-1.752179116010666},{x:419.50225830078125,y:307.25592613220215,z:58.96425247192383,name:"faceOval"},{x:372.0027160644531,y:268.7212657928467,z:-16.631840467453003},{x:366.1614227294922,y:271.6237449645996,z:-18.219159841537476},{x:385.00938415527344,y:305.3863334655762,z:-2.567722797393799},{x:381.99771881103516,y:304.9723720550537,z:-4.575215280056},{x:405.078125,y:203.21216583251953,z:13.713973760604858,name:"leftEyebrow"},{x:377.13207244873047,y:268.4710121154785,z:-15.266278982162476},{x:380.9713363647461,y:205.36980628967285,z:-.7250899076461792,name:"leftEyebrow"},{x:381.7788314819336,y:198.9268398284912,z:-1.184653863310814,name:"leftEyebrow"},{x:385.5204772949219,y:172.1484375,z:16.04826807975769,name:"faceOval"},{x:407.94189453125,y:196.76236152648926,z:25.723915100097656},{x:383.03890228271484,y:184.5157527923584,z:7.393874526023865},{x:411.61781311035156,y:210.79241752624512,z:22.315845489501953,name:"leftEyebrow"},{x:414.30870056152344,y:208.4643030166626,z:37.021894454956055},{x:364.28722381591797,y:298.35777282714844,z:-21.86065673828125},{x:371.3682556152344,y:299.78848457336426,z:-17.834001779556274},{x:376.88201904296875,y:301.6696071624756,z:-13.153743743896484},{x:370.2193832397461,y:270.49095153808594,z:-15.569736957550049},{x:383.5081100463867,y:305.2726364135742,z:-3.673594295978546},{x:380.73760986328125,y:305.96869468688965,z:-8.660228252410889},{x:381.2334442138672,y:304.63574409484863,z:-4.820316135883331,name:"lips"},{x:368.1698989868164,y:264.8884963989258,z:-25.653886795043945},{x:373.5087203979492,y:303.4233856201172,z:-10.95950722694397,name:"lips"},{x:368.4544372558594,y:303.29601287841797,z:-14.169161319732666,name:"lips"},{x:362.76554107666016,y:303.5735607147217,z:-16.911956071853638,name:"lips"},{x:366.60980224609375,y:324.8870658874512,z:-15.616422891616821},{x:365.7067108154297,y:315.95678329467773,z:-20.903596878051758,name:"lips"},{x:365.0083923339844,y:311.2232208251953,z:-21.066999435424805},{x:364.1508102416992,y:307.0583438873291,z:-18.907777070999146},{x:363.37512969970703,y:304.5721435546875,z:-17.42550015449524,name:"lips"},{x:374.580078125,y:304.3059539794922,z:-11.40302300453186,name:"lips"},{x:375.55362701416016,y:305.0998020172119,z:-12.861957550048828},{x:377.2437286376953,y:307.1674346923828,z:-14.215847253799438},{x:378.68587493896484,y:309.9015712738037,z:-13.223772048950195,name:"lips"},{x:383.8992691040039,y:290.29629707336426,z:-9.97326910495758},{x:423.3871841430664,y:271.91688537597656,z:74.37058925628662,name:"faceOval"},{x:377.68043518066406,y:304.62209701538086,z:-7.603961229324341,name:"lips"},{x:379.00428771972656,y:304.9314594268799,z:-8.57852816581726},{x:364.00279998779297,y:275.2813911437988,z:-19.25792098045349},{x:374.68231201171875,y:273.82555961608887,z:-11.28047227859497},{x:365.0354766845703,y:273.4548568725586,z:-18.791062831878662},{x:380.61901092529297,y:249.8848056793213,z:.15501167625188828},{x:391.14158630371094,y:254.7934627532959,z:2.0906515419483185},{x:378.1761169433594,y:264.9612236022949,z:-12.605184316635132},{x:400.9540557861328,y:179.99592304229736,z:27.82477855682373,name:"faceOval"},{x:398.0038833618164,y:188.50656509399414,z:16.094952821731567},{x:394.8717498779297,y:199.0359592437744,z:6.226727366447449,name:"leftEyebrow"},{x:382.10926055908203,y:316.83926582336426,z:-8.946179747581482},{x:366.51588439941406,y:200.32583713531494,z:-5.24632453918457,name:"leftEyebrow"},{x:367.4893569946289,y:183.87210845947266,z:1.9039081037044525},{x:368.6243438720703,y:168.8127565383911,z:8.736093044281006,name:"faceOval"},{x:398.96175384521484,y:234.9675178527832,z:13.713973760604858},{x:412.9645538330078,y:242.23042488098145,z:23.272905349731445},{x:372.05257415771484,y:231.41919136047363,z:9.226294755935669},{x:406.0722351074219,y:223.58965873718262,z:18.370890617370605},{x:368.27442169189453,y:240.2039337158203,z:-4.166713654994965},{x:372.3575210571289,y:260.66442489624023,z:-24.976940155029297},{x:419.2244338989258,y:247.9079246520996,z:30.299127101898193},{x:409.43885803222656,y:246.60913467407227,z:16.398411989212036},{x:401.69139862060547,y:248.76328468322754,z:9.395531415939331},{x:389.7608184814453,y:247.56915092468262,z:5.841569304466248},{x:380.5461883544922,y:244.55984115600586,z:4.263003468513489},{x:373.25817108154297,y:240.80214500427246,z:2.5356262922286987},{x:358.77086639404297,y:229.35615062713623,z:-10.387605428695679},{x:419.5793914794922,y:262.8478717803955,z:26.5175724029541},{x:410.8808898925781,y:222.51372814178467,z:22.199130058288574},{x:358.45714569091797,y:268.91467094421387,z:-33.17030906677246},{x:373.4129333496094,y:251.6385841369629,z:-5.771540403366089},{x:422.5408172607422,y:239.23919677734375,z:74.04378890991211,name:"faceOval"},{x:367.8171920776367,y:236.58040523529053,z:1.820748895406723},{x:378.51959228515625,y:266.2532329559326,z:-5.74819803237915},{x:403.3472442626953,y:229.05112266540527,z:19.689764976501465},{x:372.34840393066406,y:256.6451168060303,z:-21.872329711914062},{x:422.54566192626953,y:289.1587829589844,z:68.67491245269775,name:"faceOval"},{x:371.9297409057617,y:228.90116214752197,z:11.432201862335205,name:"leftEye"},{x:366.21360778808594,y:251.6158962249756,z:-28.19826364517212},{x:409.1571807861328,y:321.3156223297119,z:20.2266526222229},{x:408.52943420410156,y:331.44238471984863,z:31.09278917312622,name:"faceOval"},{x:424.2788314819336,y:267.1992301940918,z:50.467424392700195},{x:415.60352325439453,y:311.6528606414795,z:30.579242706298828},{x:418.12793731689453,y:221.59927368164062,z:46.26569747924805},{x:385.68286895751953,y:346.0184955596924,z:-5.70151150226593},{x:357.82936096191406,y:271.3758373260498,z:-24.836881160736084},{x:379.588623046875,y:257.5071716308594,z:-3.755294680595398},{x:417.4592590332031,y:234.71948146820068,z:34.5475435256958},{x:393.4684371948242,y:231.58967971801758,z:11.408859491348267,name:"leftEye"},{x:387.8864288330078,y:232.14245796203613,z:9.51808214187622,name:"leftEye"},{x:382.4981689453125,y:307.5654888153076,z:-7.522260546684265,name:"lips"},{x:419.00169372558594,y:277.8332805633545,z:26.424202919006348},{x:373.62953186035156,y:357.6375102996826,z:-5.75986921787262,name:"faceOval"},{x:392.8708267211914,y:347.72446632385254,z:10.154176950454712,name:"faceOval"},{x:400.3953552246094,y:341.0005187988281,z:19.39797878265381,name:"faceOval"},{x:382.25440979003906,y:231.66935920715332,z:8.998700976371765,name:"leftEye"},{x:377.14550018310547,y:230.4228687286377,z:9.804032444953918,name:"leftEye"},{x:373.8358688354492,y:229.64950561523438,z:11.292144060134888,name:"leftEye"},{x:414.5794677734375,y:221.67891025543213,z:29.412097930908203},{x:377.00672149658203,y:225.66201210021973,z:9.360517263412476,name:"leftEye"},{x:382.29530334472656,y:224.8431158065796,z:8.32175612449646,name:"leftEye"},{x:387.5133514404297,y:224.49507236480713,z:8.917000889778137,name:"leftEye"},{x:393.15906524658203,y:225.24795055389404,z:10.737749338150024,name:"leftEye"},{x:397.05554962158203,y:226.55359268188477,z:13.002015352249146,name:"leftEye"},{x:420.5299377441406,y:221.014666557312,z:65.40690422058105,name:"faceOval"},{x:397.06920623779297,y:230.6661558151245,z:13.807345628738403,name:"leftEye"},{x:377.94647216796875,y:285.1647090911865,z:-13.305472135543823},{x:372.1118927001953,y:267.1267318725586,z:-18.83774757385254},{x:364.9968719482422,y:282.24411964416504,z:-19.818150997161865},{x:401.973876953125,y:331.20131492614746,z:11.566424369812012},{x:394.3083190917969,y:338.86693954467773,z:3.142542541027069},{x:373.9820861816406,y:351.4504623413086,z:-13.50388765335083},{x:414.3888854980469,y:321.24735832214355,z:45.51872253417969,name:"faceOval"},{x:373.44234466552734,y:227.33163356781006,z:10.626870393753052,name:"leftEye"},{x:364.0731430053711,y:240.31539916992188,z:-13.807345628738403},{x:384.2658233642578,y:353.3793067932129,z:.7385850697755814,name:"faceOval"},{x:423.20526123046875,y:283.5176181793213,z:47.152724266052246},{x:369.42798614501953,y:304.0898895263672,z:-14.647691249847412,name:"lips"},{x:370.63812255859375,y:305.90051651000977,z:-16.211668252944946},{x:371.91192626953125,y:309.0167713165283,z:-17.84567356109619},{x:373.0583953857422,y:313.3545398712158,z:-17.378815412521362,name:"lips"},{x:375.39905548095703,y:321.09289169311523,z:-13.118728399276733},{x:379.2567825317383,y:304.3582534790039,z:-7.924926280975342},{x:381.18797302246094,y:303.7031364440918,z:-7.843226194381714},{x:383.0918502807617,y:302.4884605407715,z:-7.6506465673446655,name:"lips"},{x:389.09461975097656,y:297.1475315093994,z:-5.5497825145721436},{x:411.6408920288086,y:280.24898529052734,z:12.02161192893982},{x:363.3110809326172,y:234.27620887756348,z:-6.775286793708801},{x:366.0474395751953,y:223.29872131347656,z:6.827808618545532},{x:370.34427642822266,y:225.1457118988037,z:9.558931589126587},{x:377.5371551513672,y:303.60079765319824,z:-7.358860373497009,name:"lips"},{x:412.9557800292969,y:299.53579902648926,z:19.39797878265381},{x:360.0810241699219,y:221.72012329101562,z:-2.153385728597641},{x:379.82784271240234,y:329.47723388671875,z:-10.48097848892212},{x:359.08477783203125,y:235.7911491394043,z:-18.079102039337158},{x:369.6688461303711,y:251.5407943725586,z:-14.962821006774902},{x:369.5555114746094,y:333.5307312011719,z:-15.67478060722351},{x:394.0193176269531,y:315.6973171234131,z:-.9920747578144073},{x:383.78997802734375,y:272.7268695831299,z:-4.689012169837952},{x:387.67765045166016,y:323.6722755432129,z:-5.640236139297485},{x:397.8769302368164,y:272.1331214904785,z:-.9395531564950943},{x:389.87476348876953,y:280.5630111694336,z:-4.29218202829361},{x:403.83888244628906,y:285.1167869567871,z:3.0229100584983826},{x:372.5467300415039,y:343.1070327758789,z:-16.153310537338257},{x:374.1112518310547,y:256.3721466064453,z:-10.574349164962769},{x:399.73785400390625,y:321.77515983581543,z:4.849494695663452},{x:392.03365325927734,y:330.56447982788086,z:-1.3407598435878754},{x:398.59134674072266,y:305.93902587890625,z:1.517290621995926},{x:417.95997619628906,y:290.9716987609863,z:26.89105987548828},{x:406.04541778564453,y:307.35154151916504,z:8.666064143180847},{x:420.75328826904297,y:298.40752601623535,z:41.78385257720947},{x:395.4522705078125,y:291.4153575897217,z:-2.1752697229385376},{x:368.6452102661133,y:245.8882999420166,z:-9.453888535499573},{x:370.34900665283203,y:263.56690406799316,z:-26.75100326538086},{x:374.98477935791016,y:266.6126346588135,z:-19.77146625518799},{x:366.99840545654297,y:258.12140464782715,z:-31.372904777526855},{x:371.00616455078125,y:217.63479709625244,z:5.60522198677063},{x:381.30577087402344,y:214.14087295532227,z:4.983716309070587},{x:390.1496124267578,y:213.38221549987793,z:5.593550801277161},{x:397.7696990966797,y:214.3659782409668,z:8.57852816581726},{x:403.1652069091797,y:217.65509605407715,z:13.013685941696167},{x:407.3551940917969,y:230.72525024414062,z:22.444231510162354},{x:424.0876770019531,y:251.7839241027832,z:51.16771221160889},{x:403.50196838378906,y:239.88757610321045,z:15.803166627883911},{x:397.31719970703125,y:241.49806022644043,z:11.233787536621094},{x:388.99425506591797,y:241.4366912841797,z:7.948269248008728},{x:380.7804489135742,y:239.78078842163086,z:6.600214838981628},{x:374.01336669921875,y:237.11946487426758,z:6.349278092384338},{x:369.39125061035156,y:234.35351371765137,z:5.987462401390076},{x:422.9730987548828,y:255.76455116271973,z:76.61150932312012,name:"faceOval"},{x:374.73915100097656,y:269.24214363098145,z:-16.608498096466064},{x:364.61681365966797,y:245.71088790893555,z:-20.02823829650879},{x:365.3834533691406,y:263.34174156188965,z:-32.32996463775635},{x:361.58252716064453,y:267.8273677825928,z:-30.345816612243652},{x:365.37208557128906,y:265.0249671936035,z:-29.178667068481445},{x:372.72605895996094,y:272.05135345458984,z:-14.834434986114502},{x:360.48614501953125,y:268.34827423095703,z:-32.189905643463135},{x:359.9516296386719,y:270.8049201965332,z:-24.650139808654785},{x:369.5049285888672,y:229.01945114135742,z:10.107489824295044},{x:365.5447769165039,y:230.24096488952637,z:5.593550801277161},{x:363.50669860839844,y:230.6208372116089,z:.43622106313705444},{x:399.3529510498047,y:227.65677452087402,z:15.35965085029602,name:"leftEye"},{x:402.5693130493164,y:224.60190296173096,z:15.931552648544312}],box:{xMin:277.8318977355957,yMin:168.7741756439209,xMax:424.2788314819336,yMax:359.8348903656006,width:146.4469337463379,height:191.0607147216797}},SAMPLE_FACELANDMARKER_RESULT:{faceLandmarks:[[{x:.5760777592658997,y:.8639070391654968,z:-.030997956171631813},{x:.572094738483429,y:.7886289358139038,z:-.07189624011516571},{x:.5723551511764526,y:.8075382709503174,z:-.03578168898820877},{x:.5548420548439026,y:.7188365459442139,z:-.057787876576185226},{x:.5706077814102173,y:.7674974799156189,z:-.07740399986505508},{x:.5681378245353699,y:.7387768030166626,z:-.07356284558773041},{x:.5621535181999207,y:.6681165099143982,z:-.04189874976873398},{x:.46613582968711853,y:.6679812073707581,z:.011289681307971478},{x:.5579932928085327,y:.6174106597900391,z:-.03502821549773216},{x:.5563451647758484,y:.5905600190162659,z:-.03928658738732338},{x:.5487832427024841,y:.4900572597980499,z:-.029898937791585922},{x:.5765544176101685,y:.8692144751548767,z:-.02831427752971649},{x:.5771114230155945,y:.873644232749939,z:-.02345779910683632},{x:.5771905779838562,y:.877016007900238,z:-.016658689826726913},{x:.5778058767318726,y:.8770116567611694,z:-.014505492523312569},{x:.5783766508102417,y:.8835000991821289,z:-.015996402129530907},{x:.5792440176010132,y:.8913810849189758,z:-.01924579218029976},{x:.5796768069267273,y:.8996334671974182,z:-.018261712044477463},{x:.5817288160324097,y:.9255813956260681,z:-.007126849144697189},{x:.5726592540740967,y:.7992473244667053,z:-.0643521398305893},{x:.5579419136047363,y:.7996989488601685,z:-.04566684365272522},{x:.4216199815273285,y:.5958762764930725,z:.06776496022939682},{x:.5052269697189331,y:.6796539425849915,z:-.0010737782577052712},{x:.49243026971817017,y:.6838865876197815,z:-.0005227324436418712},{x:.4796970784664154,y:.6856290102005005,z:.002684245817363262},{x:.4618356227874756,y:.6764569878578186,z:.013439622707664967},{x:.5160380601882935,y:.6737282276153564,z:-17607348127057776e-21},{x:.48070961236953735,y:.6255870461463928,z:-.008339674212038517},{x:.49719780683517456,y:.6256808042526245,z:-.008027955889701843},{x:.46674346923828125,y:.6317623853683472,z:-.004460199736058712},{x:.4582492709159851,y:.641118049621582,z:.0011905613355338573},{x:.45408669114112854,y:.6911458969116211,z:.020514748990535736},{x:.535312294960022,y:.9619986414909363,z:.012499462813138962},{x:.4608460068702698,y:.6628725528717041,z:.01517564244568348},{x:.4206731915473938,y:.6828458309173584,z:.07848648726940155},{x:.4390624463558197,y:.6796106696128845,z:.03283142298460007},{x:.5029968619346619,y:.7701570391654968,z:-.009734481573104858},{x:.5595027208328247,y:.8607323169708252,z:-.030043255537748337},{x:.5621269941329956,y:.8738374710083008,z:-.021709579974412918},{x:.5451499819755554,y:.865527331829071,z:-.022014077752828598},{x:.5351184010505676,y:.8705098032951355,z:-.011602800339460373},{x:.5495014190673828,y:.8744956254959106,z:-.016490943729877472},{x:.5395170450210571,y:.8759440779685974,z:-.007333362940698862},{x:.5183624029159546,y:.8959754705429077,z:.010520773939788342},{x:.5604349374771118,y:.7895449995994568,z:-.07082037627696991},{x:.557381272315979,y:.7687489986419678,z:-.07590588927268982},{x:.4432901442050934,y:.6308897733688354,z:.0027153254486620426},{x:.5258325338363647,y:.7151225805282593,z:-.014676518738269806},{x:.5271827578544617,y:.7833116054534912,z:-.037643320858478546},{x:.5257382988929749,y:.7717816233634949,z:-.03401920944452286},{x:.46516409516334534,y:.7705106735229492,z:.0065747760236263275},{x:.5558893084526062,y:.7420997619628906,z:-.0694495290517807},{x:.4720408320426941,y:.6066038608551025,z:-.021204356104135513},{x:.45432573556900024,y:.6158540844917297,z:-.011054684408009052},{x:.4305151402950287,y:.5608053803443909,z:.0396830290555954},{x:.5310865640640259,y:.6157484650611877,z:-.03081176057457924},{x:.5114666223526001,y:.6329749226570129,z:-.00335998204536736},{x:.506435751914978,y:.8786543607711792,z:.012980876490473747},{x:.4480472207069397,y:.8640613555908203,z:.12569651007652283},{x:.5372058153152466,y:.7942581176757812,z:-.03168361634016037},{x:.5488379597663879,y:.8001630306243896,z:-.03280917927622795},{x:.5213388204574585,y:.8794381618499756,z:.011892606504261494},{x:.5242055654525757,y:.8789222240447998,z:.008370225317776203},{x:.4477175176143646,y:.6039950251579285,z:-.0050799972377717495},{x:.526964008808136,y:.7916748523712158,z:-.02968614175915718},{x:.4971255660057068,y:.6050706505775452,z:-.028175678104162216},{x:.4938119053840637,y:.5882453918457031,z:-.03210941329598427},{x:.4757143557071686,y:.5094879865646362,z:-.01300730835646391},{x:.43947282433509827,y:.5816648006439209,z:.01415177434682846},{x:.485664039850235,y:.5477864146232605,z:-.023685332387685776},{x:.43635931611061096,y:.6226438283920288,z:.013606148771941662},{x:.42910251021385193,y:.6102726459503174,z:.03926564007997513},{x:.5605402588844299,y:.8680099248886108,z:-.027318159118294716},{x:.5474816560745239,y:.8702861070632935,z:-.019686367362737656},{x:.5373021364212036,y:.8728838562965393,z:-.010484928265213966},{x:.540735125541687,y:.7979167103767395,z:-.029073253273963928},{x:.5228585004806519,y:.87913578748703,z:.009915109723806381},{x:.530497670173645,y:.8815253973007202,z:.0020524784922599792},{x:.5259912610054016,y:.8790552616119385,z:.007895970717072487},{x:.5433906316757202,y:.7882310748100281,z:-.05121905356645584},{x:.541388213634491,y:.8777219653129578,z:-.00466804439201951},{x:.5515822172164917,y:.8767023086547852,z:-.010475946590304375},{x:.5637003779411316,y:.877059817314148,z:-.015273625031113625},{x:.5640299320220947,y:.9263423085212708,z:-.00658724969252944},{x:.5642300248146057,y:.8993074893951416,z:-.017653480172157288},{x:.5637336373329163,y:.8910360932350159,z:-.01852807030081749},{x:.5637134313583374,y:.8837276697158813,z:-.01482592523097992},{x:.564205527305603,y:.8768964409828186,z:-.01331155002117157},{x:.5419867634773254,y:.8778373599052429,z:-.0037720394320786},{x:.5404468774795532,y:.880696177482605,z:-.005610354244709015},{x:.5392338633537292,y:.8845721483230591,z:-.007352025713771582},{x:.538469672203064,y:.8891173601150513,z:-.005154991988092661},{x:.5189250111579895,y:.8452741503715515,z:-.009755070321261883},{x:.4258975088596344,y:.7662280797958374,z:.1387351155281067},{x:.5725725293159485,y:.8041572570800781,z:-.04583907872438431},{x:.5342061519622803,y:.8785833120346069,z:.002659974154084921},{x:.5324031114578247,y:.8804071545600891,z:.0017832003068178892},{x:.5538818836212158,y:.8078407645225525,z:-.03254539892077446},{x:.5325431823730469,y:.8026832938194275,z:-.019140373915433884},{x:.5514076948165894,y:.8043903112411499,z:-.03313535451889038},{x:.5131856203079224,y:.7284771800041199,z:-.009399853646755219},{x:.49331504106521606,y:.7443980574607849,z:-.005225230939686298},{x:.5239617824554443,y:.7807451486587524,z:-.025881027802824974},{x:.4473606050014496,y:.5315827131271362,z:.011164786294102669},{x:.45718759298324585,y:.5604941248893738,z:-.005943301599472761},{x:.4670005738735199,y:.5909327268600464,z:-.019681761041283607},{x:.5311570167541504,y:.9076261520385742,z:.00389476353302598},{x:.5249923467636108,y:.5893563628196716,z:-.037981919944286346},{x:.5166932344436646,y:.5429551005363464,z:-.03319704160094261},{x:.5085030198097229,y:.49676206707954407,z:-.02691275253891945},{x:.4687720239162445,y:.6834565997123718,z:.008113506250083447},{x:.4426414966583252,y:.7069531679153442,z:.028577271848917007},{x:.5230373740196228,y:.6675713658332825,z:.001773772411979735},{x:.4481240212917328,y:.6527872085571289,z:.012414850294589996},{x:.5339856743812561,y:.7012367844581604,z:-.020220188423991203},{x:.5347223281860352,y:.7761190533638,z:-.05141595005989075},{x:.4315067231655121,y:.7211957573890686,z:.04381405934691429},{x:.45203351974487305,y:.7206180095672607,z:.017288070172071457},{x:.46892452239990234,y:.7265436053276062,z:.005602988880127668},{x:.49314674735069275,y:.7202282547950745,z:-.0006408205372281373},{x:.5104925632476807,y:.7091827392578125,z:-.00362918758764863},{x:.5232142210006714,y:.698553740978241,z:-.00787867046892643},{x:.5497883558273315,y:.6743605136871338,z:-.036349106580019},{x:.43658503890037537,y:.7627100348472595,z:.042555369436740875},{x:.4397648870944977,y:.6528646349906921,z:.017956094816327095},{x:.5653332471847534,y:.7992802858352661,z:-.06365057826042175},{x:.5285563468933105,y:.736810564994812,z:-.018836988136172295},{x:.4180678725242615,y:.6792560815811157,z:.12284679710865021},{x:.5328429937362671,y:.6865872144699097,z:-.010484723374247551},{x:.5230283141136169,y:.7809416055679321,z:-.011922398582100868},{x:.4551771283149719,y:.6650775074958801,z:.01774493046104908},{x:.5337203741073608,y:.7618928551673889,z:-.04697106033563614},{x:.43463975191116333,y:.8133478164672852,z:.1354849934577942},{x:.5225707292556763,y:.6605283617973328,z:.004980515688657761},{x:.5441933870315552,y:.7497199773788452,z:-.06091512367129326},{x:.4774007797241211,y:.9159183502197266,z:.059622734785079956},{x:.48068761825561523,y:.9364941716194153,z:.08404944837093353},{x:.4268292486667633,y:.7657528519630432,z:.09051097184419632},{x:.46051913499832153,y:.8880485892295837,z:.0738474428653717},{x:.4243420660495758,y:.6434382200241089,z:.06230505183339119},{x:.5342157483100891,y:.9835634231567383,z:.021662971004843712},{x:.5668109655380249,y:.8042187094688416,z:-.044937074184417725},{x:.5176341533660889,y:.7530587315559387,z:-.012967454269528389},{x:.430206298828125,y:.6835605502128601,z:.04612284153699875},{x:.4794231951236725,y:.6732114553451538,z:.003970044665038586},{x:.49073347449302673,y:.6722435355186462,z:.0008692514384165406},{x:.5294116139411926,y:.884677529335022,z:.004413890186697245},{x:.4430122375488281,y:.80235356092453,z:.04987282305955887},{x:.5603825449943542,y:1.0092442035675049,z:.026417359709739685},{x:.5186598300933838,y:.9828659892082214,z:.0513598807156086},{x:.5010536909103394,y:.9640932679176331,z:.06591596454381943},{x:.5524769425392151,y:.539441704750061,z:-.035816047340631485},{x:.5879997611045837,y:1.0091472864151,z:.02285068854689598},{x:.5016193985939026,y:.6684437990188599,z:.00028415941051207483},{x:.511952817440033,y:.6642197370529175,z:.0021144719794392586},{x:.5194343328475952,y:.6623469591140747,z:.004674181342124939},{x:.4321230351924896,y:.6496355533599854,z:.03124697133898735},{x:.508686363697052,y:.6479565501213074,z:-.00044765998609364033},{x:.4963986277580261,y:.6431032419204712,z:-.0032507688738405704},{x:.4845542013645172,y:.6430778503417969,z:-.002903624437749386},{x:.4733612537384033,y:.647506833076477,z:.00023347247042693198},{x:.4668654501438141,y:.653346598148346,z:.004762572236359119},{x:.41815051436424255,y:.633708119392395,z:.09809435904026031},{x:.47159942984580994,y:.6711485385894775,z:.007849935442209244},{x:.5734396576881409,y:.8256140351295471,z:-.03155219927430153},{x:.5306524038314819,y:.8337990641593933,z:-.018351426348090172},{x:.5371729135513306,y:.7910830974578857,z:-.037286680191755295},{x:.5549534559249878,y:.8275275826454163,z:-.030664825811982155},{x:.5597432255744934,y:.6418541669845581,z:-.03318847343325615},{x:.4958484172821045,y:.9429569244384766,z:.048340678215026855},{x:.5140507817268372,y:.9634028077125549,z:.03589847311377525},{x:.5587693452835083,y:.9951097369194031,z:.00908728688955307},{x:.46411189436912537,y:.9051855206489563,z:.10601935535669327},{x:.5181609392166138,y:.6554316878318787,z:.002546071307733655},{x:.5436590909957886,y:.7085841298103333,z:-.03844436630606651},{x:.5872187614440918,y:.9960382580757141,z:.0063423276878893375},{x:.5379653573036194,y:.9989125728607178,z:.03636329993605614},{x:.4350326955318451,y:.8088565468788147,z:.09147704392671585},{x:.5523084998130798,y:.8773422837257385,z:-.009068487212061882},{x:.5510149598121643,y:.8816931843757629,z:-.011043853126466274},{x:.5503793954849243,y:.88776695728302,z:-.01348799467086792},{x:.5501549243927002,y:.8954370617866516,z:-.012142189778387547},{x:.546072781085968,y:.9192524552345276,z:-.003157563041895628},{x:.5314661860466003,y:.8771666884422302,z:.0005075141089037061},{x:.5293324589729309,y:.8762547969818115,z:.00039177737198770046},{x:.5275698900222778,y:.8750609755516052,z:47732755774632096e-21},{x:.5104271173477173,y:.8607332110404968,z:.0012934643309563398},{x:.45938700437545776,y:.8134918212890625,z:.023569690063595772},{x:.5418947339057922,y:.6864100694656372,z:-.027333909645676613},{x:.531914234161377,y:.6456130743026733,z:-.005434140563011169},{x:.523697018623352,y:.647885262966156,z:-.0002466466394253075},{x:.5338191390037537,y:.8783687353134155,z:.002268768846988678},{x:.46226605772972107,y:.8610277771949768,z:.04718952998518944},{x:.5434442758560181,y:.6456181406974792,z:-.02327350154519081},{x:.5399754643440247,y:.940219521522522,z:.005075343884527683},{x:.5661457777023315,y:.71457839012146,z:-.06242101639509201},{x:.5523148775100708,y:.6974870562553406,z:-.04863070324063301},{x:.5639959573745728,y:.6923378109931946,z:-.05180761218070984},{x:.5367592573165894,y:.7423217296600342,z:-.03623027727007866},{x:.5853689908981323,y:.9752064943313599,z:-.002361974213272333},{x:.5835235118865967,y:.9493685960769653,z:-.003941743168979883},{x:.5615018606185913,y:.949194610118866,z:-.0015953965485095978},{x:.5068561434745789,y:.9048219323158264,z:.01862684078514576},{x:.5134067535400391,y:.7971825003623962,z:-.008485661819577217},{x:.5223897099494934,y:.925589919090271,z:.01249657291918993},{x:.48500555753707886,y:.7959478497505188,z:-.0032065745908766985},{x:.5037734508514404,y:.8184596300125122,z:-.004932103678584099},{x:.4766361117362976,y:.828806459903717,z:.01027688942849636},{x:.5589827299118042,y:.974656343460083,z:.0009666886180639267},{x:.5294582843780518,y:.7541216611862183,z:-.025603046640753746},{x:.4973002076148987,y:.9208990931510925,z:.031931452453136444},{x:.5163551568984985,y:.9432790875434875,z:.024321340024471283},{x:.49399662017822266,y:.8814862370491028,z:.018687399104237556},{x:.44948166608810425,y:.836137592792511,z:.05702034756541252},{x:.47898444533348083,y:.8836610913276672,z:.03150695189833641},{x:.4454479217529297,y:.8499438166618347,z:.08868525922298431},{x:.49572959542274475,y:.8452823758125305,z:.0036111653316766024},{x:.5362502336502075,y:.7222585678100586,z:-.027912352234125137},{x:.5393770337104797,y:.7850722074508667,z:-.05415399745106697},{x:.531399667263031,y:.7898418307304382,z:-.03883346915245056},{x:.5451627373695374,y:.7717036604881287,z:-.06480253487825394},{x:.5206395983695984,y:.6287745833396912,z:-.010521138086915016},{x:.4974782466888428,y:.6191938519477844,z:-.014098240062594414},{x:.4774145185947418,y:.6193130612373352,z:-.013643337413668633},{x:.4616098403930664,y:.6259890198707581,z:-.008448202162981033},{x:.4516478478908539,y:.6368461847305298,z:9050309745362028e-20},{x:.4485096037387848,y:.6719120740890503,z:.022984720766544342},{x:.42177659273147583,y:.7240667343139648,z:.08511673659086227},{x:.4616215229034424,y:.6988231539726257,z:.014238474890589714},{x:.4755798876285553,y:.7034608721733093,z:.00625590980052948},{x:.4924992024898529,y:.7005885243415833,z:.0009391739731654525},{x:.5082254409790039,y:.693384051322937,z:-.0009464038303121924},{x:.5203112959861755,y:.6849707961082458,z:-.0022114769089967012},{x:.52867591381073,y:.6779075860977173,z:-.002962538506835699},{x:.4213953912258148,y:.7219811677932739,z:.1350894570350647},{x:.5320829749107361,y:.794858992099762,z:-.03181503340601921},{x:.5452795028686523,y:.7286570072174072,z:-.04771539941430092},{x:.5496407747268677,y:.7866933345794678,z:-.06452003121376038},{x:.557040274143219,y:.7962084412574768,z:-.05837344378232956},{x:.549176812171936,y:.7895247936248779,z:-.057761140167713165},{x:.5362890362739563,y:.8005836606025696,z:-.026903774589300156},{x:.560200035572052,y:.7983731031417847,z:-.06172555685043335},{x:.5616944432258606,y:.8022753596305847,z:-.045200999826192856},{x:.5273328423500061,y:.6611284017562866,z:.0029021520167589188},{x:.534850537776947,y:.6660012006759644,z:-.005215510260313749},{x:.5394860506057739,y:.6701375246047974,z:-.014931917190551758},{x:.4634307324886322,y:.658291757106781,z:.009295716881752014},{x:.4538393020629883,y:.6519932150840759,z:.00930330716073513},{x:.5776031613349915,y:.7159298658370972,z:-.057365912944078445},{x:.6504855155944824,y:.6461779475212097,z:.014184834435582161},{x:.5860154032707214,y:.7962266206741333,z:-.04522843658924103},{x:.6842049360275269,y:.5631637573242188,z:.07207967340946198},{x:.6152560710906982,y:.6674962639808655,z:.0007529259892180562},{x:.6280948519706726,y:.6684326529502869,z:.0016892586136236787},{x:.6408625245094299,y:.6663892269134521,z:.005331226624548435},{x:.6557814478874207,y:.6534678936004639,z:.01646413467824459},{x:.6035663485527039,y:.6639701724052429,z:.0013799630105495453},{x:.6329053044319153,y:.608010470867157,z:-.006195899099111557},{x:.6167260408401489,y:.6117533445358276,z:-.006319951266050339},{x:.6471013426780701,y:.6112449765205383,z:-.0017843559617176652},{x:.6560901999473572,y:.6185776591300964,z:.004047257360070944},{x:.6666946411132812,y:.6651176810264587,z:.023647578433156013},{x:.6311345100402832,y:.9495396018028259,z:.014004078693687916},{x:.6544655561447144,y:.6397901773452759,z:.01809609681367874},{x:.6965808868408203,y:.6482675075531006,z:.08304904401302338},{x:.679817259311676,y:.650188148021698,z:.03632688894867897},{x:.6336516737937927,y:.7541458010673523,z:-.007742783520370722},{x:.5921701192855835,y:.8567668199539185,z:-.029399123042821884},{x:.591663658618927,y:.870215654373169,z:-.02103729173541069},{x:.6068367958068848,y:.8584195375442505,z:-.020668085664510727},{x:.6176617741584778,y:.860965371131897,z:-.009790095500648022},{x:.6040634512901306,y:.8686612844467163,z:-.015289564616978168},{x:.6143736839294434,y:.8671170473098755,z:-.005712216719985008},{x:.6373105049133301,y:.8815656900405884,z:.012672550976276398},{x:.5832505822181702,y:.7866312861442566,z:-.07051534950733185},{x:.5836675763130188,y:.7658692598342896,z:-.07566110789775848},{x:.6709531545639038,y:.604898989200592,z:.005951565690338612},{x:.6029891967773438,y:.705652117729187,z:-.013388276100158691},{x:.6131622195243835,y:.7728396058082581,z:-.036248479038476944},{x:.6123163104057312,y:.7612020373344421,z:-.03264721855521202},{x:.6696187853813171,y:.744706928730011,z:.009673702530562878},{x:.5803102254867554,y:.7385968565940857,z:-.0689152330160141},{x:.6404349207878113,y:.5877999663352966,z:-.01929756999015808},{x:.6588467955589294,y:.5929454565048218,z:-.008487257175147533},{x:.6720337867736816,y:.530631422996521,z:.043437421321868896},{x:.584305465221405,y:.6099005341529846,z:-.030301367864012718},{x:.6034283638000488,y:.6217452883720398,z:-.001970183802768588},{x:.6460927724838257,y:.8608663082122803,z:.015541625209152699},{x:.6957815289497375,y:.8326103091239929,z:.13015234470367432},{x:.6043362617492676,y:.7861682772636414,z:-.030476901680231094},{x:.594293475151062,y:.7942103147506714,z:-.032218821346759796},{x:.6324057579040527,y:.8665139675140381,z:.014255806803703308},{x:.6296147704124451,y:.8667733669281006,z:.010388285852968693},{x:.663644552230835,y:.5798642635345459,z:-.0022301070857793093},{x:.6140630841255188,y:.7809288501739502,z:-.02835679054260254},{x:.615908145904541,y:.5921698212623596,z:-.026804860681295395},{x:.617181122303009,y:.5748661756515503,z:-.03060605563223362},{x:.6222207546234131,y:.49137672781944275,z:-.011151673272252083},{x:.6669357419013977,y:.5541607141494751,z:.017466170713305473},{x:.6182981729507446,y:.5320425629615784,z:-.021793590858578682},{x:.6760554313659668,y:.595052182674408,z:.017115700989961624},{x:.6801463961601257,y:.5800720453262329,z:.043127160519361496},{x:.5922210812568665,y:.8644017577171326,z:-.02662893570959568},{x:.6054555177688599,y:.8637874722480774,z:-.018363753333687782},{x:.6161889433860779,y:.8641164898872375,z:-.008808949030935764},{x:.6017249822616577,y:.7901403307914734,z:-.028126630932092667},{x:.631446123123169,y:.8664817810058594,z:.012112865224480629},{x:.6249198913574219,y:.8716511130332947,z:.003882825840264559},{x:.6281915903091431,y:.867301881313324,z:.009891441091895103},{x:.5986843109130859,y:.7813931703567505,z:-.050227612257003784},{x:.6126407384872437,y:.869275689125061,z:-.0031255714129656553},{x:.6027271151542664,y:.8711842894554138,z:-.009324162267148495},{x:.59088134765625,y:.8742044568061829,z:-.014608660712838173},{x:.5984604358673096,y:.9216185212135315,z:-.005981989670544863},{x:.5950398445129395,y:.8964707255363464,z:-.01703473925590515},{x:.5941568613052368,y:.8882410526275635,z:-.017784785479307175},{x:.5928806662559509,y:.8803883194923401,z:-.014153128489851952},{x:.5909661054611206,y:.8748103976249695,z:-.012609979137778282},{x:.6128016710281372,y:.8702545762062073,z:-.0022550546564161777},{x:.6150846481323242,y:.8726804256439209,z:-.00414019962772727},{x:.6173093914985657,y:.8770190477371216,z:-.005970994010567665},{x:.619335412979126,y:.8814800977706909,z:-.0036864024586975574},{x:.6292637586593628,y:.8314558267593384,z:-.007714875973761082},{x:.702275276184082,y:.7320667505264282,z:.1433621346950531},{x:.6204835176467896,y:.8689177632331848,z:.0044869170524179935},{x:.6223508715629578,y:.8704851269721985,z:.00352082890458405},{x:.590448260307312,y:.8029727935791016,z:-.03200828656554222},{x:.6097423434257507,y:.7933741211891174,z:-.018042555078864098},{x:.59229576587677,y:.7993767261505127,z:-.032564569264650345},{x:.6171364188194275,y:.7153720259666443,z:-.007672437466681004},{x:.6389747858047485,y:.726390540599823,z:-.002999067772179842},{x:.6151940226554871,y:.769412100315094,z:-.024427521973848343},{x:.6526776552200317,y:.505868136882782,z:.01412637997418642},{x:.6475822329521179,y:.5375454425811768,z:-.0033899128902703524},{x:.6433356404304504,y:.5714520215988159,z:-.017428796738386154},{x:.626949667930603,y:.8962116837501526,z:.005602736957371235},{x:.5868416428565979,y:.5829002261161804,z:-.03727729618549347},{x:.5877229571342468,y:.5345035791397095,z:-.032396964728832245},{x:.5887066125869751,y:.48655083775520325,z:-.025856535881757736},{x:.6507197618484497,y:.6612282991409302,z:.011114613153040409},{x:.6803066730499268,y:.677992045879364,z:.032125361263751984},{x:.5963194370269775,y:.6598632335662842,z:.002976928371936083},{x:.667536199092865,y:.6274255514144897,z:.015618261881172657},{x:.5930740833282471,y:.6940041780471802,z:-.019217798486351967},{x:.6053346395492554,y:.7676517963409424,z:-.050308309495449066},{x:.6934473514556885,y:.6884298920631409,z:.04794462397694588},{x:.6738007664680481,y:.6934011578559875,z:.020697161555290222},{x:.6588084697723389,y:.7033141851425171,z:.008462334051728249},{x:.6346072554588318,y:.7029502391815186,z:.001542167621664703},{x:.6157816648483276,y:.6966525912284851,z:-.002009218093007803},{x:.6015574336051941,y:.688928484916687,z:-.006588225718587637},{x:.5746836066246033,y:.6711069345474243,z:-.03597589209675789},{x:.6947521567344666,y:.7309479117393494,z:.046707939356565475},{x:.6759101152420044,y:.6249120831489563,z:.021654341369867325},{x:.5794773101806641,y:.7971615195274353,z:-.06339326500892639},{x:.6041849851608276,y:.727514922618866,z:-.017512541264295578},{x:.6968844532966614,y:.6440950036048889,z:.12727996706962585},{x:.5910853147506714,y:.679325520992279,z:-.009497715160250664},{x:.6157375574111938,y:.7695677280426025,z:-.010624290443956852},{x:.6606494784355164,y:.6410489678382874,z:.0208158977329731},{x:.6040687561035156,y:.7531470656394958,z:-.045887019485235214},{x:.7012156248092651,y:.780247151851654,z:.14028730988502502},{x:.595149576663971,y:.6527782678604126,z:.006308757700026035},{x:.5925500392913818,y:.7436665892601013,z:-.060151755809783936},{x:.6780198812484741,y:.8905693888664246,z:.0626060739159584},{x:.676746666431427,y:.9113880395889282,z:.08726003766059875},{x:.7030686140060425,y:.7312687635421753,z:.09529774636030197},{x:.688987135887146,y:.8588417172431946,z:.07752864807844162},{x:.6883691549301147,y:.6109960675239563,z:.06669612973928452},{x:.6358906030654907,y:.9702065587043762,z:.023120900616049767},{x:.5781539678573608,y:.8023634552955627,z:-.044763918966054916},{x:.6170316934585571,y:.7408350706100464,z:-.011375460773706436},{x:.688542366027832,y:.6516284346580505,z:.050206027925014496},{x:.6385149359703064,y:.6540714502334595,z:.006462941411882639},{x:.6279382109642029,y:.6563615798950195,z:.003062846139073372},{x:.6268895268440247,y:.8736732006072998,z:.00627936702221632},{x:.6944946050643921,y:.7709181308746338,z:.053824134171009064},{x:.614617109298706,y:1.0022112131118774,z:.02719894051551819},{x:.6493719220161438,y:.9665167927742004,z:.053563784807920456},{x:.6624587178230286,y:.943530797958374,z:.068605437874794},{x:.6162528991699219,y:.6558693051338196,z:.002187855076044798},{x:.6058168411254883,y:.654328465461731,z:.0036193584091961384},{x:.5987918972969055,y:.6536934971809387,z:.006134530063718557},{x:.6831037402153015,y:.6195642948150635,z:.03511790186166763},{x:.6062582731246948,y:.6356398463249207,z:.001280312892049551},{x:.6174948811531067,y:.62776118516922,z:-.0013642468256875873},{x:.6297246217727661,y:.6253792643547058,z:-.0007034156005829573},{x:.6407091617584229,y:.627578616142273,z:.0028144705574959517},{x:.6479622721672058,y:.6322650909423828,z:.00750273372977972},{x:.6915091276168823,y:.5990704298019409,z:.10270945727825165},{x:.6457163095474243,y:.6504453420639038,z:.010696077719330788},{x:.6164222955703735,y:.8231936097145081,z:-.016772059723734856},{x:.6042401194572449,y:.7830976843833923,z:-.03630910441279411},{x:.5922216773033142,y:.8228387236595154,z:-.029992375522851944},{x:.6646111011505127,y:.92097008228302,z:.050967294722795486},{x:.651232898235321,y:.9460107088088989,z:.038000158965587616},{x:.6140977144241333,y:.9882472157478333,z:.009882091544568539},{x:.6870781183242798,y:.8768675327301025,z:.10980932414531708},{x:.5986856818199158,y:.6456438899040222,z:.003999010659754276},{x:.585981547832489,y:.7034481763839722,z:-.0377722829580307},{x:.6342031359672546,y:.9867448806762695,z:.03786521404981613},{x:.7013950943946838,y:.776049017906189,z:.09598205983638763},{x:.6030206680297852,y:.8719133138656616,z:-.007931148633360863},{x:.6050592064857483,y:.8767156004905701,z:-.009791925549507141},{x:.6073468923568726,y:.8831382393836975,z:-.012361008673906326},{x:.6087977290153503,y:.890143632888794,z:-.01098148338496685},{x:.6147705316543579,y:.9110084772109985,z:-.0018823575228452682},{x:.622577965259552,y:.8670604825019836,z:.002609190298244357},{x:.6241236329078674,y:.8651344180107117,z:.0025534380692988634},{x:.6257084608078003,y:.8638408184051514,z:.0023300074972212315},{x:.639931321144104,y:.8449671268463135,z:.0038123116828501225},{x:.6810906529426575,y:.7856625318527222,z:.02717764675617218},{x:.583532452583313,y:.6811994910240173,z:-.026588857173919678},{x:.5855660438537598,y:.6393819451332092,z:-.004512844607234001},{x:.5932201743125916,y:.6398029327392578,z:.0008020466193556786},{x:.6200879812240601,y:.8683351874351501,z:.00417016725987196},{x:.6842559576034546,y:.8330534100532532,z:.050836317241191864},{x:.5754412412643433,y:.6418221592903137,z:-.022838059812784195},{x:.6232790350914001,y:.9295297265052795,z:.006339520215988159},{x:.5764067769050598,y:.694546639919281,z:-.04825803264975548},{x:.59778892993927,y:.7343927621841431,z:-.035004377365112305},{x:.6042810678482056,y:.9441440105438232,z:-.0010970570147037506},{x:.6496372222900391,y:.8869078159332275,z:.021036235615611076},{x:.6274012327194214,y:.7830310463905334,z:-.006658440921455622},{x:.637792706489563,y:.9104999899864197,z:.014290250837802887},{x:.6549934148788452,y:.7748609185218811,z:-.0006672973395325243},{x:.6404005289077759,y:.801220715045929,z:-.0026642554439604282},{x:.6671456694602966,y:.8045546412467957,z:.013180811889469624},{x:.6107483506202698,y:.9680658578872681,z:.001778992242179811},{x:.6060343980789185,y:.744587242603302,z:-.024382334202528},{x:.6602751612663269,y:.8998945355415344,z:.0344940721988678},{x:.6463775038719177,y:.9262562394142151,z:.02617623284459114},{x:.6579852104187012,y:.8602304458618164,z:.021586716175079346},{x:.6926165223121643,y:.8053340315818787,z:.061075080186128616},{x:.6724731922149658,y:.8594399690628052,z:.03457934781908989},{x:.6975721716880798,y:.8183245062828064,z:.09300774335861206},{x:.6512877941131592,y:.8258221745491028,z:.006324059329926968},{x:.594887375831604,y:.7148372530937195,z:-.026898479089140892},{x:.6017440557479858,y:.7773507833480835,z:-.05312420800328255},{x:.6096571683883667,y:.7806998491287231,z:-.037646256387233734},{x:.5952993035316467,y:.7654367685317993,z:-.06398405134677887},{x:.5950021147727966,y:.6201304793357849,z:-.009297547861933708},{x:.6165438890457153,y:.6052900552749634,z:-.012455573305487633},{x:.6362661719322205,y:.6015968918800354,z:-.011649220250546932},{x:.6522727608680725,y:.6046400666236877,z:-.005903332494199276},{x:.6625409722328186,y:.6128141283988953,z:.0030042496509850025},{x:.6688099503517151,y:.6457712054252625,z:.026322703808546066},{x:.7013440728187561,y:.6893666386604309,z:.08984331786632538},{x:.6608623266220093,y:.6749406456947327,z:.0172116681933403},{x:.6482325196266174,y:.6823726296424866,z:.008881398476660252},{x:.6313265562057495,y:.6842025518417358,z:.0031308617908507586},{x:.6147016286849976,y:.6809731721878052,z:.0007630771724507213},{x:.6018834114074707,y:.6755372285842896,z:-.0008834321051836014},{x:.5925027132034302,y:.670681357383728,z:-.001968748401850462},{x:.700127363204956,y:.6871103644371033,z:.13980500400066376},{x:.6095665693283081,y:.7853189706802368,z:-.03074747882783413},{x:.5880423784255981,y:.7229287028312683,z:-.04691500961780548},{x:.5930182337760925,y:.7811514139175415,z:-.06398335844278336},{x:.5867722034454346,y:.7922660112380981,z:-.05794971063733101},{x:.5933279991149902,y:.7842848896980286,z:-.05714067071676254},{x:.6063535809516907,y:.7920218706130981,z:-.02590685710310936},{x:.5839452743530273,y:.794978141784668,z:-.0615212507545948},{x:.5828126072883606,y:.8000800013542175,z:-.0449722595512867},{x:.5909603834152222,y:.6541213393211365,z:.003991890233010054},{x:.5852181911468506,y:.6602938771247864,z:-.004428438376635313},{x:.5825737714767456,y:.6651063561439514,z:-.014345290139317513},{x:.6517343521118164,y:.6362385153770447,z:.012151890434324741},{x:.6615052819252014,y:.6281577944755554,z:.0123682152479887},{x:.4856873154640198,y:.6568945646286011,z:.000720038078725338},{x:.49988406896591187,y:.6547410488128662,z:.0006949726957827806},{x:.48438939452171326,y:.6392973065376282,z:.000705525919329375},{x:.47143134474754333,y:.6589511632919312,z:.0006980331381782889},{x:.48704618215560913,y:.6752797961235046,z:.0006921177846379578},{x:.6243702173233032,y:.640461802482605,z:-6592126737814397e-20},{x:.6390967965126038,y:.6385173797607422,z:-.00016105435497593135},{x:.6230536699295044,y:.6224825382232666,z:-.00016136496560648084},{x:.6095397472381592,y:.641917884349823,z:-.0001803556369850412},{x:.6250996589660645,y:.6586247682571411,z:-.0001785515050869435}]],faceBlendshapes:[{categories:[{index:0,score:5187174338061595e-21,categoryName:"_neutral",displayName:""},{index:1,score:.24521504342556,categoryName:"browDownLeft",displayName:""},{index:2,score:.1987743377685547,categoryName:"browDownRight",displayName:""},{index:3,score:.013400448486208916,categoryName:"browInnerUp",displayName:""},{index:4,score:.012361560948193073,categoryName:"browOuterUpLeft",displayName:""},{index:5,score:.019305096939206123,categoryName:"browOuterUpRight",displayName:""},{index:6,score:28426356948330067e-21,categoryName:"cheekPuff",displayName:""},{index:7,score:3.4500112633395474e-7,categoryName:"cheekSquintLeft",displayName:""},{index:8,score:4.83789051486383e-7,categoryName:"cheekSquintRight",displayName:""},{index:9,score:.07650448381900787,categoryName:"eyeBlinkLeft",displayName:""},{index:10,score:.05070012807846069,categoryName:"eyeBlinkRight",displayName:""},{index:11,score:.13978900015354156,categoryName:"eyeLookDownLeft",displayName:""},{index:12,score:.14198613166809082,categoryName:"eyeLookDownRight",displayName:""},{index:13,score:.2177766114473343,categoryName:"eyeLookInLeft",displayName:""},{index:14,score:.014739357866346836,categoryName:"eyeLookInRight",displayName:""},{index:15,score:.02361512929201126,categoryName:"eyeLookOutLeft",displayName:""},{index:16,score:.19679604470729828,categoryName:"eyeLookOutRight",displayName:""},{index:17,score:.04874616861343384,categoryName:"eyeLookUpLeft",displayName:""},{index:18,score:.049392376095056534,categoryName:"eyeLookUpRight",displayName:""},{index:19,score:.34944331645965576,categoryName:"eyeSquintLeft",displayName:""},{index:20,score:.2939716875553131,categoryName:"eyeSquintRight",displayName:""},{index:21,score:.005955042317509651,categoryName:"eyeWideLeft",displayName:""},{index:22,score:.006776117719709873,categoryName:"eyeWideRight",displayName:""},{index:23,score:16942436559475027e-21,categoryName:"jawForward",displayName:""},{index:24,score:.0045165494084358215,categoryName:"jawLeft",displayName:""},{index:25,score:.07803940027952194,categoryName:"jawOpen",displayName:""},{index:26,score:2090057751047425e-20,categoryName:"jawRight",displayName:""},{index:27,score:.06032035872340202,categoryName:"mouthClose",displayName:""},{index:28,score:.00228882092051208,categoryName:"mouthDimpleLeft",displayName:""},{index:29,score:.00781762320548296,categoryName:"mouthDimpleRight",displayName:""},{index:30,score:.0017093931091949344,categoryName:"mouthFrownLeft",displayName:""},{index:31,score:.0019319106359034777,categoryName:"mouthFrownRight",displayName:""},{index:32,score:8485237776767462e-20,categoryName:"mouthFunnel",displayName:""},{index:33,score:.0009051355300471187,categoryName:"mouthLeft",displayName:""},{index:34,score:.0003630454302765429,categoryName:"mouthLowerDownLeft",displayName:""},{index:35,score:.00017601238505449146,categoryName:"mouthLowerDownRight",displayName:""},{index:36,score:.12865161895751953,categoryName:"mouthPressLeft",displayName:""},{index:37,score:.20137207210063934,categoryName:"mouthPressRight",displayName:""},{index:38,score:.0022203284315764904,categoryName:"mouthPucker",displayName:""},{index:39,score:.0009096377179957926,categoryName:"mouthRight",displayName:""},{index:40,score:.34189721941947937,categoryName:"mouthRollLower",displayName:""},{index:41,score:.11409689486026764,categoryName:"mouthRollUpper",displayName:""},{index:42,score:.17172536253929138,categoryName:"mouthShrugLower",displayName:""},{index:43,score:.004038424696773291,categoryName:"mouthShrugUpper",displayName:""},{index:44,score:.00023205230536404997,categoryName:"mouthSmileLeft",displayName:""},{index:45,score:.00019313619122840464,categoryName:"mouthSmileRight",displayName:""},{index:46,score:.0018571305554360151,categoryName:"mouthStretchLeft",displayName:""},{index:47,score:.0023813238367438316,categoryName:"mouthStretchRight",displayName:""},{index:48,score:24323100660694763e-21,categoryName:"mouthUpperUpLeft",displayName:""},{index:49,score:3161552012898028e-20,categoryName:"mouthUpperUpRight",displayName:""},{index:50,score:1.08198406678639e-7,categoryName:"noseSneerLeft",displayName:""},{index:51,score:12652527630052646e-22,categoryName:"noseSneerRight",displayName:""}],headIndex:-1,headName:""}],facialTransformationMatrixes:[{rows:4,columns:4,data:[.9947517514228821,.10230544209480286,.0013679931871592999,0,-.10230997204780579,.9947447776794434,.003816320328041911,0,-.000970348424743861,-.0039362297393381596,.9999914169311523,0,2.8888821601867676,-7.808934211730957,-30.52109146118164,1]}]}},Zi=t.createContext({}),Yi={basePath:"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.17/wasm",options:{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",outputFaceBlendshapes:!0,outputFacialTransformationMatrixes:!0}},Qi=t.forwardRef((({basePath:e=Yi.basePath,options:r=Yi.options,children:n},a)=>{const o=JSON.stringify(r),i=m.suspend((async()=>{const{FilesetResolver:t,FaceLandmarker:n}=await Promise.resolve().then((function(){return E(require("@mediapipe/tasks-vision"))})),a=await t.forVisionTasks(e);return n.createFromOptions(a,r)}),[e,o]);return t.useEffect((()=>()=>{null==i||i.close(),m.clear([e,o])}),[i,e,o]),t.useImperativeHandle(a,(()=>i),[i]),S.createElement(Zi.Provider,{value:i},n)}));function Ki(){return t.useContext(Zi)}function Ji(e,t){return e.clone().add(t).multiplyScalar(.5)}function es(e,t,r){const n=e.localToWorld(t);return r.worldToLocal(n)}const ts=t.createContext({}),rs=t.forwardRef((({camera:e,videoTexture:r={start:!0},manualDetect:n=!1,faceLandmarkerResult:o,manualUpdate:i=!1,makeDefault:l,smoothTime:c=.25,offset:u=!0,offsetScalar:d=80,eyes:m=!1,eyesAsOrigin:f=!0,depth:p=.15,debug:h=!1,facemesh:x},y)=>{var v,g;const w=a.useThree((e=>e.scene)),z=a.useThree((e=>e.camera)),b=a.useThree((e=>e.set)),E=a.useThree((e=>e.get)),C=e||z,P=t.useRef(null),[R]=t.useState((()=>new T.Object3D)),[D]=t.useState((()=>new T.Vector3)),[F]=t.useState((()=>new T.Vector3)),[k]=t.useState((()=>new T.Vector3)),[_]=t.useState((()=>new T.Vector3)),A=t.useCallback((()=>{R.parent=C.parent;const e=P.current;if(e){const{outerRef:t,eyeRightRef:r,eyeLeftRef:n}=e;if(r.current&&n.current){const{irisDirRef:e}=r.current,{irisDirRef:a}=n.current;e.current&&a.current&&t.current&&(D.copy(es(e.current,new T.Vector3(0,0,0),t.current)),F.copy(es(a.current,new T.Vector3(0,0,0),t.current)),R.position.copy(es(t.current,Ji(D,F),C.parent||w)),k.copy(es(e.current,new T.Vector3(0,0,1),t.current)),_.copy(es(a.current,new T.Vector3(0,0,1),t.current)),R.lookAt(t.current.localToWorld(Ji(k,_))))}else t.current&&(R.position.copy(es(t.current,new T.Vector3(0,0,0),C.parent||w)),R.lookAt(t.current.localToWorld(new T.Vector3(0,0,1))))}return R}),[C,F,_,D,k,w,R]),[L]=t.useState((()=>new T.Object3D)),I=t.useCallback((function(e,t){if(C){var r;if(null!==(r=t)&&void 0!==r||(t=A()),c>0){const r=1e-9;s.easing.damp3(L.position,t.position,c,e,void 0,void 0,r),s.easing.dampE(L.rotation,t.rotation,c,e,void 0,void 0,r)}else L.position.copy(t.position),L.rotation.copy(t.rotation);C.position.copy(L.position),C.rotation.copy(L.rotation)}}),[C,A,c,L.position,L.rotation]);a.useFrame(((e,t)=>{i||I(t)}));const B=t.useRef(null),[U,V]=t.useState(),O=Ki(),N=t.useCallback(((e,t)=>{const r=B.current;if(!r)return;const n=r.source.data,a=null==O?void 0:O.detectForVideo(n,e);V(a)}),[O]),j=t.useMemo((()=>Object.assign(Object.create(T.EventDispatcher.prototype),{computeTarget:A,update:I,facemeshApiRef:P})),[A,I]);t.useImperativeHandle(y,(()=>j),[j]),t.useEffect((()=>{if(l){const e=E().controls;return b({controls:j}),()=>b({controls:e})}}),[l,j,E,b]);const W=null!=o?o:U,G=null==W?void 0:W.faceLandmarks[0],H=null==W||null==(v=W.facialTransformationMatrixes)?void 0:v[0],$=null==W||null==(g=W.faceBlendshapes)?void 0:g[0],q={onVideoFrame:N,...r};return S.createElement(ts.Provider,{value:j},!n&&S.createElement(t.Suspense,{fallback:null},"src"in q?S.createElement(nr,M.default({ref:B},q)):S.createElement(ji,M.default({ref:B},q))),S.createElement(Hi,M.default({ref:P,children:S.createElement("meshNormalMaterial",{side:T.DoubleSide})},x,{points:G,depth:p,facialTransformationMatrix:H,faceBlendshapes:$,eyes:m,eyesAsOrigin:f,offset:u,offsetScalar:d,debug:h,"rotation-z":Math.PI,visible:h})))})),ns=new T.Vector3,as=new T.Vector2,os=new T.Vector3,is=new T.Vector3,ss=new T.Vector3,ls=new T.Plane,cs=S.forwardRef((({autoTransform:e=!0,matrix:t,axisLock:r,dragLimits:n,onHover:o,onDragStart:s,onDrag:l,onDragEnd:c,children:u,dragConfig:d,...m},f)=>{const p=a.useThree((e=>e.controls)),{camera:h,size:x,raycaster:y,invalidate:v}=a.useThree(),g=S.useRef(null),w=i.useGesture({onHover:({hovering:e})=>o&&o(null!=e&&e),onDragStart:({event:e})=>{p&&(p.enabled=!1);const{point:t}=e;g.current.matrix.decompose(ns,new T.Quaternion,new T.Vector3),os.copy(t),is.copy(os).sub(ns),s&&s(ns),v()},onDrag:({xy:[t,a],intentional:o})=>{if(!o)return;const i=(t-x.left)/x.width*2-1,s=-(a-x.top)/x.height*2+1;if(as.set(i,s),y.setFromCamera(as,h),r)switch(r){case"x":ss.set(1,0,0);break;case"y":ss.set(0,1,0);break;case"z":ss.set(0,0,1)}else h.getWorldDirection(ss).negate();ls.setFromNormalAndCoplanarPoint(ss,os),y.ray.intersectPlane(ls,os);const c=g.current.matrix.clone(),u=g.current.matrixWorld.clone(),d=new T.Vector3(os.x-is.x,os.y-is.y,os.z-is.z);if(n&&(d.x=n[0]?Math.max(Math.min(d.x,n[0][1]),n[0][0]):d.x,d.y=n[1]?Math.max(Math.min(d.y,n[1][1]),n[1][0]):d.y,d.z=n[2]?Math.max(Math.min(d.z,n[2][1]),n[2][0]):d.z),e){g.current.matrix.setPosition(d);const e=g.current.matrix.clone().multiply(c.invert()),t=g.current.matrix.clone().multiply(u.invert());l&&l(g.current.matrix,e,g.current.matrixWorld,t)}else{const e=(new T.Matrix4).copy(g.current.matrix);e.setPosition(d);const t=e.clone().multiply(c.invert()),r=e.clone().multiply(u.invert());l&&l(e,t,g.current.matrixWorld,r)}v()},onDragEnd:()=>{p&&(p.enabled=!0),c&&c(),v()}},{drag:{filterTaps:!0,threshold:1,..."object"==typeof d?d:{}}});return S.useImperativeHandle(f,(()=>g.current),[]),S.useLayoutEffect((()=>{t&&(g.current.matrix=t)}),[t]),S.createElement("group",M.default({ref:g},w(),{matrix:t,matrixAutoUpdate:!1},m),u)}));Object.defineProperty(exports,"CameraControlsImpl",{enumerable:!0,get:function(){return P.default}}),exports.AccumulativeShadows=sa,exports.AdaptiveDpr=function({pixelated:e}){const t=a.useThree((e=>e.gl)),r=a.useThree((e=>e.internal.active)),n=a.useThree((e=>e.performance.current)),o=a.useThree((e=>e.viewport.initialDpr)),i=a.useThree((e=>e.setDpr));return S.useEffect((()=>{const n=t.domElement;return()=>{r&&i(o),e&&n&&(n.style.imageRendering="auto")}}),[]),S.useEffect((()=>{i(n*o),e&&t.domElement&&(t.domElement.style.imageRendering=1===n?"auto":"pixelated")}),[n]),null},exports.AdaptiveEvents=function(){const e=a.useThree((e=>e.get)),t=a.useThree((e=>e.setEvents)),r=a.useThree((e=>e.performance.current));return S.useEffect((()=>{const r=e().events.enabled;return()=>t({enabled:r})}),[]),S.useEffect((()=>t({enabled:1===r})),[r]),null},exports.ArcballControls=mt,exports.AsciiRenderer=function({renderIndex:e=1,bgColor:t="black",fgColor:r="white",characters:n=" .:-+*=%@#",invert:o=!0,color:i=!1,resolution:s=.15}){const{size:l,gl:u,scene:d,camera:m}=a.useThree(),f=S.useMemo((()=>{const e=new c.AsciiEffect(u,n,{invert:o,color:i,resolution:s});return e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.left="0px",e.domElement.style.pointerEvents="none",e}),[n,o,i,s]);return S.useLayoutEffect((()=>{f.domElement.style.color=r,f.domElement.style.backgroundColor=t}),[r,t]),S.useEffect((()=>(u.domElement.style.opacity="0",u.domElement.parentNode.appendChild(f.domElement),()=>{u.domElement.style.opacity="1",u.domElement.parentNode.removeChild(f.domElement)})),[f]),S.useEffect((()=>{f.setSize(l.width,l.height)}),[f,l]),a.useFrame((e=>{f.render(d,m)}),e),S.createElement(S.Fragment,null)},exports.BBAnchor=({anchor:e,...t})=>{const r=S.useRef(null),n=S.useRef(null);return S.useEffect((()=>{var e;null!=(e=r.current)&&null!=(e=e.parent)&&e.parent&&(n.current=r.current.parent,r.current.parent.parent.add(r.current))}),[]),a.useFrame((()=>{n.current&&(hr.setFromObject(n.current),hr.getSize(xr),r.current.position.set(n.current.position.x+xr.x*(Array.isArray(e)?e[0]:e.x)/2,n.current.position.y+xr.y*(Array.isArray(e)?e[1]:e.y)/2,n.current.position.z+xr.z*(Array.isArray(e)?e[2]:e.z)/2))})),S.createElement("group",M.default({ref:r},t))},exports.Backdrop=function({children:e,floor:t=.25,segments:r=20,receiveShadow:n,...a}){const o=S.useRef(null);return S.useLayoutEffect((()=>{let e=0;const n=r/r/2,a=o.current.attributes.position;for(let o=0;o<r+1;o++)for(let i=0;i<r+1;i++)a.setXYZ(e++,o/r-n+(0===o?-t:0),i/r-n,ma(o/r));a.needsUpdate=!0,o.current.computeVertexNormals()}),[r,t]),S.createElement("group",a,S.createElement("mesh",{receiveShadow:n,rotation:[-Math.PI/2,0,Math.PI/2]},S.createElement("planeGeometry",{ref:o,args:[1,1,r,r]}),e))},exports.BakeShadows=function(){const e=a.useThree((e=>e.gl));return t.useEffect((()=>(e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,()=>{e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0})),[e.shadowMap]),null},exports.Billboard=ee,exports.Bounds=Un,exports.Box=cn,exports.Bvh=fr,exports.CameraControls=xt,exports.CameraShake=On,exports.Capsule=Cn,exports.CatmullRomLine=fe,exports.Caustics=ga,exports.Center=wr,exports.Circle=un,exports.Clone=Ve,exports.Cloud=Na,exports.CloudInstance=Oa,exports.Clouds=Va,exports.ComputedAttribute=({compute:e,name:t,...r})=>{const[a]=S.useState((()=>new n.BufferAttribute(new Float32Array(0),1))),o=S.useRef(null);return S.useLayoutEffect((()=>{if(o.current){var t;const r=null!==(t=o.current.parent)&&void 0!==t?t:o.current.__r3f.parent.object,n=e(r);o.current.copy(n)}}),[e]),S.createElement("primitive",M.default({ref:o,object:a,attach:`attributes-${t}`},r))},exports.Cone=dn,exports.ContactShadows=aa,exports.CubeCamera=function({children:e,frames:t=1/0,resolution:r,near:n,far:o,envMap:i,fog:s,...l}){const c=S.useRef(null),{fbo:u,camera:d,update:m}=it({resolution:r,near:n,far:o,envMap:i,fog:s});let f=0;return a.useFrame((()=>{c.current&&(t===1/0||f<t)&&(c.current.visible=!1,m(),c.current.visible=!0,f++)})),S.createElement("group",l,S.createElement("primitive",{object:d}),S.createElement("group",{ref:c},null==e?void 0:e(u.texture)))},exports.CubeTexture=function({children:e,files:t,...r}){const n=Yt(t,{...r});return S.createElement(S.Fragment,null,null==e?void 0:e(n))},exports.CubicBezierLine=me,exports.CurveModifier=Wr,exports.CycleRaycast=function({onChanged:e,portal:t,preventDefault:r=!0,scroll:n=!0,keyCode:o=9}){const i=S.useRef(0),s=a.useThree((e=>e.setEvents)),l=a.useThree((e=>e.get)),c=a.useThree((e=>e.gl));return S.useEffect((()=>{var a;let u,d=[];const m=l().events.filter,f=null!==(a=null==t?void 0:t.current)&&void 0!==a?a:c.domElement.parentNode,p=()=>f&&e&&e(d,Math.round(i.current)%d.length);s({filter:(e,t)=>{let r=[...e];r.length===d.length&&d.every((e=>r.map((e=>e.object.uuid)).includes(e.object.uuid)))||(i.current=0,d=r,p()),m&&(r=m(r,t));for(let e=0;e<Math.round(i.current)%r.length;e++){const e=r.shift();r=[...r,e]}return r}});const h=e=>{var t,r;i.current=e(i.current),null==(t=l().events.handlers)||t.onPointerCancel(void 0),null==(r=l().events.handlers)||r.onPointerMove(u),p()},x=e=>{(e.keyCode||e.which)===o&&(r&&e.preventDefault(),d.length>1&&h((e=>e+1)))},y=e=>{r&&e.preventDefault();let t=0;e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),d.length>1&&h((e=>Math.abs(e-t)))},v=e=>u=e;return document.addEventListener("pointermove",v,{passive:!0}),n&&document.addEventListener("wheel",y),void 0!==o&&document.addEventListener("keydown",x),()=>{s({filter:m}),void 0!==o&&document.removeEventListener("keydown",x),n&&document.removeEventListener("wheel",y),document.removeEventListener("pointermove",v)}}),[c,l,s,r,n,o]),null},exports.Cylinder=mn,exports.Decal=He,exports.Detailed=Mo,exports.DetectGPU=function({children:e,...t}){const r=dr(t);return S.createElement(S.Fragment,null,null==e?void 0:e(r))},exports.DeviceOrientationControls=st,exports.Dodecahedron=En,exports.DragControls=cs,exports.Edges=ke,exports.Effects=ze,exports.Environment=na,exports.EnvironmentCube=ea,exports.EnvironmentMap=Jn,exports.EnvironmentPortal=ta,exports.Example=zr,exports.Extrude=Mn,exports.FaceControls=rs,exports.FaceLandmarker=Qi,exports.FaceLandmarkerDefaults=Yi,exports.Facemesh=Hi,exports.FacemeshDatas=Xi,exports.FacemeshEye=qi,exports.FacemeshEyeDefaults=$i,exports.Fbo=nt,exports.Fbx=function({path:e,...t}){const r=Qt(e).children[0];return S.createElement(Ve,M.default({},t,{object:r}))},exports.FirstPersonControls=ht,exports.Fisheye=function({renderPriority:e=1,zoom:t=0,segments:r=64,children:n,resolution:o=896,...i}){const s=S.useRef(null),l=S.useRef(null),{width:c,height:u}=a.useThree((e=>e.size)),[d]=S.useState((()=>new T.OrthographicCamera));S.useLayoutEffect((()=>{d.position.set(0,0,100),d.zoom=100,d.left=c/-2,d.right=c/2,d.top=u/2,d.bottom=u/-2,d.updateProjectionMatrix()}),[c,u]);const m=Math.sqrt(c*c+u*u)/100*(.5+t/2),f=new T.Vector3,p=new T.Sphere(new T.Vector3,m),h=new T.Matrix3,x=S.useCallback(((e,t,r)=>{t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,d),t.raycaster.ray.intersectSphere(p,f)&&(f.normalize(),h.getNormalMatrix(l.current.camera.matrixWorld),l.current.camera.getWorldPosition(t.raycaster.ray.origin),t.raycaster.ray.direction.set(0,0,1).reflect(f),t.raycaster.ray.direction.x*=-1,t.raycaster.ray.direction.applyNormalMatrix(h).multiplyScalar(-1))}),[]);return a.useFrame((t=>{e&&t.gl.render(s.current,d)}),e),S.createElement(S.Fragment,null,S.createElement("mesh",M.default({ref:s},i,{scale:m}),S.createElement("sphereGeometry",{args:[1,r,r]}),S.createElement("meshBasicMaterial",null,S.createElement(ko,{compute:x,attach:"envMap",flip:!0,resolution:o,ref:l},n,S.createElement(Lo,{api:l})))))},exports.Float=Nn,exports.FlyControls=lt,exports.GizmoHelper=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:r=1,onUpdate:o,onTarget:i,children:s})=>{const l=a.useThree((e=>e.size)),c=a.useThree((e=>e.camera)),u=a.useThree((e=>e.controls)),d=a.useThree((e=>e.invalidate)),m=S.useRef(null),f=S.useRef(null),p=S.useRef(!1),h=S.useRef(0),x=S.useRef(new n.Vector3(0,0,0)),y=S.useRef(new n.Vector3(0,0,0));S.useEffect((()=>{y.current.copy(c.up),Ct.up.copy(c.up)}),[c]);const v=S.useCallback((e=>{p.current=!0,(u||i)&&(x.current=(null==i?void 0:i())||(kt(u)?u.getTarget(x.current):null==u?void 0:u.target)),h.current=c.position.distanceTo(Dt),Pt.copy(c.quaternion),Ft.copy(e).multiplyScalar(h.current).add(Dt),Ct.lookAt(Ft),Rt.copy(Ct.quaternion),d()}),[u,c,i,d]);a.useFrame(((e,t)=>{if(f.current&&m.current){var r;if(p.current)if(Pt.angleTo(Rt)<.01)p.current=!1,"minPolarAngle"in u&&c.up.copy(y.current);else{const e=t*St;Pt.rotateTowards(Rt,e),c.position.set(0,0,1).applyQuaternion(Pt).multiplyScalar(h.current).add(x.current),c.up.set(0,1,0).applyQuaternion(Pt).normalize(),c.quaternion.copy(Pt),kt(u)&&u.setPosition(c.position.x,c.position.y,c.position.z),o?o():u&&u.update(t),d()}Tt.copy(c.matrix).invert(),null==(r=m.current)||r.quaternion.setFromRotationMatrix(Tt)}}));const g=S.useMemo((()=>({tweenCamera:v})),[v]),[w,z]=t,b=e.endsWith("-center")?0:e.endsWith("-left")?-l.width/2+w:l.width/2-w,E=e.startsWith("center-")?0:e.startsWith("top-")?l.height/2-z:-l.height/2+z;return S.createElement(bt,{renderPriority:r},S.createElement(Et.Provider,{value:g},S.createElement(at,{makeDefault:!0,ref:f,position:[0,0,200]}),S.createElement("group",{ref:m,position:[b,E,0]},s)))},exports.GizmoViewcube=e=>S.createElement("group",{scale:[60,60,60]},S.createElement(Gt,e),Nt.map(((t,r)=>S.createElement(Ht,M.default({key:r,position:t,dimensions:jt[r]},e)))),Vt.map(((t,r)=>S.createElement(Ht,M.default({key:r,position:t,dimensions:Ot},e))))),exports.GizmoViewport=({hideNegativeAxes:e,hideAxisHeads:t,disabled:r,font:n="18px Inter var, Arial, sans-serif",axisColors:a=["#ff2060","#20df80","#2080ff"],axisHeadScale:o=1,axisScale:i,labels:s=["X","Y","Z"],labelColor:l="#000",onClick:c,...u})=>{const[d,m,f]=a,{tweenCamera:p}=Mt(),h={font:n,disabled:r,labelColor:l,onClick:c,axisHeadScale:o,onPointerDown:r?void 0:e=>{p(e.object.position),e.stopPropagation()}};return S.createElement("group",M.default({scale:40},u),S.createElement($t,{color:d,rotation:[0,0,0],scale:i}),S.createElement($t,{color:m,rotation:[0,0,Math.PI/2],scale:i}),S.createElement($t,{color:f,rotation:[0,-Math.PI/2,0],scale:i}),!t&&S.createElement(S.Fragment,null,S.createElement(qt,M.default({arcStyle:d,position:[1,0,0],label:s[0]},h)),S.createElement(qt,M.default({arcStyle:m,position:[0,1,0],label:s[1]},h)),S.createElement(qt,M.default({arcStyle:f,position:[0,0,1],label:s[2]},h)),!e&&S.createElement(S.Fragment,null,S.createElement(qt,M.default({arcStyle:d,position:[-1,0,0]},h)),S.createElement(qt,M.default({arcStyle:m,position:[0,-1,0]},h)),S.createElement(qt,M.default({arcStyle:f,position:[0,0,-1]},h)))))},exports.Gltf=Qe,exports.GradientTexture=function({stops:e,colors:t,size:r=1024,width:n=16,type:o=be.Linear,innerCircleRadius:i=0,outerCircleRadius:s="auto",...l}){const c=a.useThree((e=>e.gl)),u=S.useMemo((()=>{const a=document.createElement("canvas"),l=a.getContext("2d");let c;if(a.width=n,a.height=r,o===be.Linear)c=l.createLinearGradient(0,0,0,r);else{const e=a.width/2,t=a.height/2,r="auto"!==s?Math.abs(Number(s)):Math.sqrt(e**2+t**2);c=l.createRadialGradient(e,t,Math.abs(i),e,t,r)}const u=new T.Color;let d=e.length;for(;d--;)c.addColorStop(e[d],u.set(t[d]).getStyle());return l.save(),l.fillStyle=c,l.fillRect(0,0,n,r),l.restore(),a}),[e]);return S.createElement("canvasTexture",M.default({colorSpace:c.outputColorSpace,args:[u],attach:"map"},l))},exports.GradientType=be,exports.Grid=Zt,exports.Helper=({type:e,args:t=[]})=>{const r=S.useRef(null),n=S.useRef(null);return S.useLayoutEffect((()=>{n.current=r.current.parent})),lr(n,e,...t),S.createElement("object3D",{ref:r})},exports.Html=j,exports.Hud=bt,exports.Icosahedron=zn,exports.Image=Fe,exports.Instance=Lr,exports.InstancedAttribute=Vr,exports.Instances=Ir,exports.IsObject=Me,exports.KeyboardControls=function({map:e,children:t,onChange:r,domElement:n}){const a=e.map((e=>e.name+e.keys)).join("-"),i=S.useMemo((()=>o.create(l.subscribeWithSelector((()=>e.reduce(((e,t)=>({...e,[t.name]:!1})),{}))))),[a]),s=S.useMemo((()=>[i.subscribe,i.getState,i]),[a]),c=i.setState;return S.useEffect((()=>{const t=e.map((({name:e,keys:t,up:n})=>({keys:t,up:n,fn:t=>{c({[e]:t}),r&&r(e,t,s[1]())}}))).reduce(((e,{keys:t,fn:r,up:n=!0})=>(t.forEach((t=>e[t]={fn:r,pressed:!1,up:n})),e)),{}),a=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:a,pressed:o,up:i}=n;n.pressed=!0,!i&&o||a(!0)},o=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:a,up:o}=n;n.pressed=!1,o&&a(!1)},i=n||window;return i.addEventListener("keydown",a,{passive:!0}),i.addEventListener("keyup",o,{passive:!0}),()=>{i.removeEventListener("keydown",a),i.removeEventListener("keyup",o)}}),[n,a]),S.createElement(K.Provider,{value:s,children:t})},exports.Ktx2=({children:e,input:t,basisPath:r})=>{const n=Jt(t,r);return S.createElement(S.Fragment,null,null==e?void 0:e(n))},exports.Lathe=Sn,exports.Lightformer=Ca,exports.Line=ce,exports.Loader=function({containerStyles:e,innerStyles:t,barStyles:r,dataStyles:n,dataInterpolation:a=H,initialState:o=e=>e}){const{active:i,progress:s}=G(),l=S.useRef(0),c=S.useRef(0),u=S.useRef(null),[d,m]=S.useState(o(i));S.useEffect((()=>{let e;return i!==d&&(e=setTimeout((()=>m(i)),300)),()=>clearTimeout(e)}),[d,i]);const f=S.useCallback((()=>{u.current&&(l.current+=(s-l.current)/2,(l.current>.95*s||100===s)&&(l.current=s),u.current.innerText=a(l.current),l.current<s&&(c.current=requestAnimationFrame(f)))}),[a,s]);return S.useEffect((()=>(f(),()=>cancelAnimationFrame(c.current))),[f]),d?S.createElement("div",{style:{...$.container,opacity:i?1:0,...e}},S.createElement("div",null,S.createElement("div",{style:{...$.inner,...t}},S.createElement("div",{style:{...$.bar,transform:`scaleX(${s/100})`,...r}}),S.createElement("span",{ref:u,style:{...$.data,...n}})))):null},exports.MapControls=ct,exports.MarchingCube=je,exports.MarchingCubes=Ne,exports.MarchingPlane=We,exports.Mask=Ao,exports.MatcapTexture=({children:e,id:t,format:r,onLoad:n})=>{const a=Xa(t,r,n);return S.createElement(S.Fragment,null,null==e?void 0:e(a))},exports.Merged=Br,exports.MeshDiscardMaterial=rn,exports.MeshDistortMaterial=Hr,exports.MeshPortalMaterial=Bo,exports.MeshReflectorMaterial=Qr,exports.MeshRefractionMaterial=function({aberrationStrength:e=0,fastChroma:r=!0,envMap:n,...o}){a.extend({MeshRefractionMaterial:Kr});const i=t.useRef(null),{size:s}=a.useThree(),l=t.useMemo((()=>{var t,a;const o={},i=(s=n)&&s.isCubeTexture;var s;const l=(null!==(t=i?null==(a=n.image[0])?void 0:a.width:n.image.width)&&void 0!==t?t:1024)/4,c=Math.floor(Math.log2(l)),u=Math.pow(2,c),d=3*Math.max(u,112),m=4*u;return i&&(o.ENVMAP_TYPE_CUBEM=""),o.CUBEUV_TEXEL_WIDTH=""+1/d,o.CUBEUV_TEXEL_HEIGHT=""+1/m,o.CUBEUV_MAX_MIP=`${c}.0`,e>0&&(o.CHROMATIC_ABERRATIONS=""),r&&(o.FAST_CHROMA=""),o}),[e,r]);return t.useLayoutEffect((()=>{var e;const t=null==(e=i.current)||null==(e=e.__r3f)||null==(e=e.parent)||null==(e=e.object)?void 0:e.geometry;t&&(i.current.bvh=new g.MeshBVHUniformStruct,i.current.bvh.updateFrom(new g.MeshBVH(t.clone().toNonIndexed(),{strategy:g.SAH})))}),[]),a.useFrame((({camera:e})=>{i.current.viewMatrixInverse=e.matrixWorld,i.current.projectionMatrixInverse=e.projectionMatrixInverse})),S.createElement("meshRefractionMaterial",M.default({key:JSON.stringify(l),defines:l,ref:i,resolution:[s.width,s.height],aberrationStrength:e,envMap:n},o))},exports.MeshTransmissionMaterial=tn,exports.MeshWobbleMaterial=qr,exports.MotionPathControls=wt,exports.MultiMaterial=function(e){const t=S.useRef(null);return S.useLayoutEffect((()=>{const e=t.current.parent,r=null==e?void 0:e.geometry;if(r){const n=e.material;e.material=t.current.__r3f.children.map((e=>e.object));const a=[...r.groups];return r.clearGroups(),e.material.forEach(((t,n)=>{n<e.material.length-1&&(t.depthWrite=!1),r.addGroup(0,1/0,n)})),()=>{e.material=n,r.groups=a}}})),S.createElement("group",M.default({ref:t},e))},exports.NormalTexture=({children:e,id:t,onLoad:r,...n})=>{const a=Za(t,n,r);return S.createElement(S.Fragment,null,null==e?void 0:e(a))},exports.Octahedron=bn,exports.OrbitControls=ut,exports.OrthographicCamera=at,exports.Outlines=function({color:e="black",opacity:t=1,transparent:r=!1,screenspace:n=!1,toneMapped:o=!0,polygonOffset:i=!1,polygonOffsetFactor:s=0,renderOrder:l=0,thickness:u=.05,angle:d=Math.PI,clippingPlanes:m,...f}){const p=S.useRef(null),[h]=S.useState((()=>new _e({side:T.BackSide}))),{gl:x}=a.useThree(),y=x.getDrawingBufferSize(new T.Vector2);S.useMemo((()=>a.extend({OutlinesMaterial:_e})),[]);const v=S.useRef(0),g=S.useRef(null);return S.useLayoutEffect((()=>{const e=p.current;if(!e)return;const t=e.parent;if(t&&t.geometry&&(v.current!==d||g.current!==t.geometry)){var r;v.current=d,g.current=t.geometry;let n=null==(r=e.children)?void 0:r[0];n&&(d&&n.geometry.dispose(),e.remove(n)),t.skeleton?(n=new T.SkinnedMesh,n.material=h,n.bind(t.skeleton,t.bindMatrix),e.add(n)):t.isInstancedMesh?(n=new T.InstancedMesh(t.geometry,h,t.count),n.instanceMatrix=t.instanceMatrix,e.add(n)):(n=new T.Mesh,n.material=h,e.add(n)),n.geometry=d?c.toCreasedNormals(t.geometry,d):t.geometry,n.morphTargetInfluences=t.morphTargetInfluences,n.morphTargetDictionary=t.morphTargetDictionary}})),S.useLayoutEffect((()=>{const c=p.current;if(!c)return;const d=c.children[0];if(d){d.renderOrder=l;const f=c.parent;a.applyProps(d,{morphTargetInfluences:f.morphTargetInfluences,morphTargetDictionary:f.morphTargetDictionary}),a.applyProps(d.material,{transparent:r,thickness:u,color:e,opacity:t,size:y,screenspace:n,toneMapped:o,polygonOffset:i,polygonOffsetFactor:s,clippingPlanes:m,clipping:m&&m.length>0})}})),S.useEffect((()=>()=>{const e=p.current;if(!e)return;const t=e.children[0];t&&(d&&t.geometry.dispose(),e.remove(t))}),[]),S.createElement("group",M.default({ref:p},f))},exports.PerformanceMonitor=function({iterations:e=10,ms:r=250,threshold:n=.75,step:o=.1,factor:i=.5,flipflops:s=1/0,bounds:l=e=>e>100?[60,100]:[40,60],onIncline:c,onDecline:u,onChange:d,onFallback:m,children:f}){const p=Math.pow(10,0),[h,x]=t.useState((()=>({fps:0,index:0,factor:i,flipped:0,refreshrate:0,fallback:!1,frames:[],averages:[],subscriptions:new Map,subscribe:e=>{const t=Symbol();return h.subscriptions.set(t,e.current),()=>{h.subscriptions.delete(t)}}})));let y=0;return a.useFrame((()=>{const{frames:t,averages:a}=h;if(!h.fallback&&a.length<e){t.push(performance.now());const i=t[t.length-1]-t[0];if(i>=r){if(h.fps=Math.round(t.length/i*1e3*p)/p,h.refreshrate=Math.max(h.refreshrate,h.fps),a[h.index++%e]=h.fps,a.length===e){const[t,r]=l(h.refreshrate),i=a.filter((e=>e>=r)),f=a.filter((e=>e<t));i.length>e*n&&(h.factor=Math.min(1,h.factor+o),h.flipped++,c&&c(h),h.subscriptions.forEach((e=>e.onIncline&&e.onIncline(h)))),f.length>e*n&&(h.factor=Math.max(0,h.factor-o),h.flipped++,u&&u(h),h.subscriptions.forEach((e=>e.onDecline&&e.onDecline(h)))),y!==h.factor&&(y=h.factor,d&&d(h),h.subscriptions.forEach((e=>e.onChange&&e.onChange(h)))),h.flipped>s&&!h.fallback&&(h.fallback=!0,m&&m(h),h.subscriptions.forEach((e=>e.onFallback&&e.onFallback(h)))),h.averages=[]}h.frames=[]}}})),S.createElement(Ro.Provider,{value:h},f)},exports.PerspectiveCamera=ot,exports.PivotControls=Oi,exports.Plane=pn,exports.Point=xo,exports.PointMaterial=on,exports.PointMaterialImpl=an,exports.PointerLockControls=pt,exports.Points=vo,exports.PointsBuffer=yo,exports.Polyhedron=wn,exports.PositionMesh=Tr,exports.PositionPoint=lo,exports.PositionalAudio=pe,exports.Preload=function({all:e,scene:t,camera:r}){const o=a.useThree((({gl:e})=>e)),i=a.useThree((({camera:e})=>e)),s=a.useThree((({scene:e})=>e));return S.useLayoutEffect((()=>{const a=[];e&&(t||s).traverse((e=>{!1===e.visible&&(a.push(e),e.visible=!0)})),o.compile(t||s,r||i);const l=new n.WebGLCubeRenderTarget(128);new n.CubeCamera(.01,1e5,l).update(o,t||s),l.dispose(),a.forEach((e=>e.visible=!1))}),[]),null},exports.PresentationControls=function({enabled:e=!0,snap:t,global:r,domElement:o,cursor:l=!0,children:c,speed:u=1,rotation:d=[0,0,0],zoom:m=1,polar:f=[0,Math.PI/2],azimuth:p=[-1/0,1/0],damping:h=.25}){const x=a.useThree((e=>e.events)),y=a.useThree((e=>e.gl)),v=o||x.connected||y.domElement,{size:g}=a.useThree(),w=S.useMemo((()=>[d[0]+f[0],d[0]+f[1]]),[d[0],f[0],f[1]]),z=S.useMemo((()=>[d[1]+p[0],d[1]+p[1]]),[d[1],p[0],p[1]]),b=S.useMemo((()=>[n.MathUtils.clamp(d[0],...w),n.MathUtils.clamp(d[1],...z),d[2]]),[d[0],d[1],d[2],w,z]);S.useEffect((()=>{if(r&&l&&e)return v.style.cursor="grab",y.domElement.style.cursor="",()=>{v.style.cursor="default",y.domElement.style.cursor="default"}}),[r,l,v,e]);const[E]=S.useState({scale:1,rotation:b,damping:h}),C=S.useRef(null);a.useFrame(((e,t)=>{s.easing.damp3(C.current.scale,E.scale,E.damping,t),s.easing.dampE(C.current.rotation,E.rotation,E.damping,t)}));const T=i.useGesture({onHover:({last:t})=>{l&&!r&&e&&(v.style.cursor=t?"auto":"grab")},onDrag:({down:r,delta:[a,o],memo:[i,s]=E.rotation||b})=>e?(l&&(v.style.cursor=r?"grabbing":"grab"),a=n.MathUtils.clamp(s+a/g.width*Math.PI*u,...z),o=n.MathUtils.clamp(i+o/g.height*Math.PI*u,...w),E.scale=r&&o>w[1]/2?m:1,E.rotation=t&&!r?b:[o,a,0],E.damping=t&&!r&&"boolean"!=typeof t?t:h,[o,a]):[o,a]},{target:r?v:void 0});return S.createElement("group",M.default({ref:C},null==T?void 0:T()),c)},exports.Progress=function({children:e}){const t=G();return S.createElement(S.Fragment,null,null==e?void 0:e(t))},exports.QuadraticBezierLine=de,exports.RandomizedLight=la,exports.RenderCubeTexture=ko,exports.RenderTexture=Do,exports.Resize=_n,exports.Ring=gn,exports.RoundedBox=Rn,exports.RoundedBoxGeometry=Dn,exports.Sampler=function({children:e,weight:t,transform:r,instances:n,mesh:a,count:o=16,...i}){const s=S.useRef(null),l=S.useRef(null),c=S.useRef(null);return S.useLayoutEffect((()=>{var e,t;l.current=null!==(e=null==n?void 0:n.current)&&void 0!==e?e:s.current.children.find((e=>e.hasOwnProperty("instanceMatrix"))),c.current=null!==(t=null==a?void 0:a.current)&&void 0!==t?t:s.current.children.find((e=>"Mesh"===e.type))}),[e,null==a?void 0:a.current,null==n?void 0:n.current]),Ue(c,o,r,t,l),S.createElement("group",M.default({ref:s},i),e)},exports.ScreenQuad=kn,exports.ScreenSizer=le,exports.ScreenSpace=te,exports.ScreenVideoTexture=Ni,exports.Scroll=Q,exports.ScrollControls=function({eps:e=1e-5,enabled:t=!0,infinite:r,horizontal:n,pages:o=1,distance:i=1,damping:l=.25,maxSpeed:c=1/0,prepend:u=!1,style:d={},children:m}){const{get:f,setEvents:p,gl:h,size:x,invalidate:y,events:v}=a.useThree(),[g]=S.useState((()=>document.createElement("div"))),[w]=S.useState((()=>document.createElement("div"))),[z]=S.useState((()=>document.createElement("div"))),b=h.domElement.parentNode,E=S.useRef(0),M=S.useMemo((()=>{const t={el:g,eps:e,fill:w,fixed:z,horizontal:n,damping:l,offset:0,delta:0,scroll:E,pages:o,range(e,t,r=0){const n=e-r,a=n+t+2*r;return this.offset<n?0:this.offset>a?1:(this.offset-n)/(a-n)},curve(e,t,r=0){return Math.sin(this.range(e,t,r)*Math.PI)},visible(e,t,r=0){const n=e-r,a=n+t+2*r;return this.offset>=n&&this.offset<=a}};return t}),[e,l,n,o]);S.useEffect((()=>{g.style.position="absolute",g.style.width="100%",g.style.height="100%",g.style[n?"overflowX":"overflowY"]="auto",g.style[n?"overflowY":"overflowX"]="hidden",g.style.top="0px",g.style.left="0px";for(const e in d)g.style[e]=d[e];z.style.position="sticky",z.style.top="0px",z.style.left="0px",z.style.width="100%",z.style.height="100%",z.style.overflow="hidden",g.appendChild(z),w.style.height=n?"100%":o*i*100+"%",w.style.width=n?o*i*100+"%":"100%",w.style.pointerEvents="none",g.appendChild(w),u?b.prepend(g):b.appendChild(g),g[n?"scrollLeft":"scrollTop"]=1;const e=v.connected||h.domElement;requestAnimationFrame((()=>null==v.connect?void 0:v.connect(g)));const t=f().events.compute;return p({compute(e,t){const{left:r,top:n}=b.getBoundingClientRect(),a=e.clientX-r,o=e.clientY-n;t.pointer.set(a/t.size.width*2-1,-o/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{b.removeChild(g),p({compute:t}),null==v.connect||v.connect(e)}}),[o,i,n,g,w,z,b]),S.useEffect((()=>{if(v.connected===g){const e=x[n?"width":"height"],a=g[n?"scrollWidth":"scrollHeight"],o=a-e;let i=0,s=!0,l=!0;const c=()=>{if(t&&!l&&(y(),i=g[n?"scrollLeft":"scrollTop"],E.current=i/o,r)){if(!s)if(i>=o){const e=1-M.offset;g[n?"scrollLeft":"scrollTop"]=1,E.current=M.offset=-e,s=!0}else if(i<=0){const e=1+M.offset;g[n?"scrollLeft":"scrollTop"]=a,E.current=M.offset=e,s=!0}s&&setTimeout((()=>s=!1),40)}};g.addEventListener("scroll",c,{passive:!0}),requestAnimationFrame((()=>l=!1));const u=e=>g.scrollLeft+=e.deltaY/2;return n&&g.addEventListener("wheel",u,{passive:!0}),()=>{g.removeEventListener("scroll",c),n&&g.removeEventListener("wheel",u)}}}),[g,v,x,r,M,y,n,t]);let C=0;return a.useFrame(((t,r)=>{C=M.offset,s.easing.damp(M,"offset",E.current,l,r,c,void 0,e),s.easing.damp(M,"delta",Math.abs(C-M.offset),l,r,c,void 0,e),M.delta>e&&y()})),S.createElement(q.Provider,{value:M},m)},exports.Segment=Eo,exports.SegmentObject=zo,exports.Segments=wo,exports.Select=function({box:e,multiple:t,children:r,onChange:n,onChangePointerUp:o,border:i="1px solid #55aaff",backgroundColor:s="rgba(75, 160, 255, 0.1)",filter:l=e=>e,...d}){const[m,f]=S.useState(!1),{setEvents:p,camera:h,raycaster:x,gl:y,controls:v,size:g,get:w}=a.useThree(),[z,b]=S.useState(!1),[E,C]=S.useReducer(((e,{object:t,shift:r})=>void 0===t?[]:Array.isArray(t)?t:r?e.includes(t)?e.filter((e=>e!==t)):[t,...e]:e[0]===t?[]:[t]),[]);S.useEffect((()=>{m?null==n||n(E):null==o||o(E)}),[E,m]);const P=S.useCallback((e=>{e.stopPropagation(),C({object:l([e.object])[0],shift:t&&e.shiftKey})}),[]),R=S.useCallback((e=>!z&&C({})),[z]),D=S.useRef(null);return S.useEffect((()=>{if(!e||!t)return;const r=new c.SelectionBox(h,D.current),n=document.createElement("div");n.style.pointerEvents="none",n.style.border=i,n.style.backgroundColor=s,n.style.position="fixed";const a=new T.Vector2,o=new T.Vector2,d=new T.Vector2,m=w().events.enabled,x=null==v?void 0:v.enabled;let z=!1;function b(e,t){const{offsetX:r,offsetY:n}=e,{width:a,height:o}=g;t.set(r/a*2-1,-n/o*2+1)}function E(e){e.shiftKey&&(!function(e){var t;v&&(v.enabled=!1),p({enabled:!1}),f(z=!0),null==(t=y.domElement.parentElement)||t.appendChild(n),n.style.left=`${e.clientX}px`,n.style.top=`${e.clientY}px`,n.style.width="0px",n.style.height="0px",a.x=e.clientX,a.y=e.clientY}(e),b(e,r.startPoint))}let M=[];function S(e){if(z){!function(e){d.x=Math.max(a.x,e.clientX),d.y=Math.max(a.y,e.clientY),o.x=Math.min(a.x,e.clientX),o.y=Math.min(a.y,e.clientY),n.style.left=`${o.x}px`,n.style.top=`${o.y}px`,n.style.width=d.x-o.x+"px",n.style.height=d.y-o.y+"px"}(e),b(e,r.endPoint);const t=r.select().sort((e=>e.uuid)).filter((e=>e.isMesh));u.shallow(t,M)||(M=t,C({object:l(t)}))}}function P(e){var t;z&&z&&(v&&(v.enabled=x),p({enabled:m}),f(z=!1),null==(t=n.parentElement)||t.removeChild(n))}return document.addEventListener("pointerdown",E,{passive:!0}),document.addEventListener("pointermove",S,{passive:!0,capture:!0}),document.addEventListener("pointerup",P,{passive:!0}),()=>{document.removeEventListener("pointerdown",E),document.removeEventListener("pointermove",S,!0),document.removeEventListener("pointerup",P)}}),[g.width,g.height,x,h,v,y]),S.createElement("group",M.default({ref:D,onClick:P,onPointerOver:()=>b(!0),onPointerOut:()=>b(!1),onPointerMissed:R},d),S.createElement(J.Provider,{value:E},r))},exports.Shadow=fa,exports.ShadowAlpha=function({opacity:e,alphaMap:t}){const r=S.useRef(null),n=S.useRef(null),o=S.useRef({value:1}),i=S.useRef({value:null}),s=S.useRef({value:!1});return S.useLayoutEffect((()=>{r.current.onBeforeCompile=n.current.onBeforeCompile=e=>{const t=e.fragmentShader.indexOf("void main");let r,n="",a=t;for(;"\n"!==r&&a<t+100;)r=e.fragmentShader.charAt(a),n+=r,a++;n=n.trim(),e.vertexShader=e.vertexShader.replace("void main() {","\n        varying vec2 custom_vUv;\n\n        void main() {\n          custom_vUv = uv;\n          \n        "),e.fragmentShader=e.fragmentShader.replace(n,"\n          uniform float uShadowOpacity;\n          uniform sampler2D uAlphaMap;\n          uniform bool uHasAlphaMap;\n\n          varying vec2 custom_vUv;\n  \n          float bayerDither2x2( vec2 v ) {\n            return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );\n          }\n    \n          float bayerDither4x4( vec2 v ) {\n            vec2 P1 = mod( v, 2.0 );\n            vec2 P2 = mod( floor( 0.5  * v ), 2.0 );\n            return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );\n          }\n  \n          void main() {\n            float alpha = \n              uHasAlphaMap ? \n                uShadowOpacity * texture2D(uAlphaMap, custom_vUv).x\n              : uShadowOpacity;\n\n            if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;\n            \n          "),e.uniforms.uShadowOpacity=o.current,e.uniforms.uAlphaMap=i.current,e.uniforms.uHasAlphaMap=s.current}}),[]),a.useFrame((()=>{var n;const a=null==(n=r.current.__r3f)||null==(n=n.parent)?void 0:n.object;if(a){const r=a.material;r&&(o.current.value=null!=e?e:r.opacity,!1===t?(i.current.value=null,s.current.value=!1):(i.current.value=t||r.alphaMap,s.current.value=!!i.current.value))}})),S.createElement(S.Fragment,null,S.createElement("meshDepthMaterial",{ref:r,attach:"customDepthMaterial",depthPacking:T.RGBADepthPacking}),S.createElement("meshDistanceMaterial",{ref:n,attach:"customDistanceMaterial"}))},exports.Shape=Tn,exports.Sky=Pa,exports.SoftShadows=function({focus:e=0,samples:t=10,size:r=25}){const n=a.useThree((e=>e.gl)),o=a.useThree((e=>e.scene)),i=a.useThree((e=>e.camera));return S.useEffect((()=>{const a=T.ShaderChunk.shadowmap_pars_fragment;return T.ShaderChunk.shadowmap_pars_fragment=T.ShaderChunk.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP\n"+(({focus:e=0,size:t=25,samples:r=10}={})=>`\n#define PENUMBRA_FILTER_SIZE float(${t})\n#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))\nvec3 randRGB(vec2 uv) {\n  return vec3(\n    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),\n    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),\n    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)\n  );\n}\n\nvec3 lowPassRandRGB(vec2 uv) {\n  // 3x3 convolution (average)\n  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9\n  vec3 result = vec3(0);\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));\n  result *= 0.111111111; // 1.0 / 9.0\n  return result;\n}\nvec3 highPassRandRGB(vec2 uv) {\n  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal\n  // hp(x) = x - lp(x)\n  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;\n}\n\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\nfloat penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation\n  return (zReceiver - zBlocker) / zBlocker;\n}\nfloat findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float blockerDepthSum = float(${e});\n  float blockers = 0.0;\n\n  int j = 0;\n  vec2 offset = vec2(0.);\n  float depth = 0.;\n\n  #pragma unroll_loop_start\n  for(int i = 0; i < ${r}; i ++) {\n    offset = (vogelDiskSample(j, ${r}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;\n    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));\n    if (depth < compare) {\n      blockerDepthSum += depth;\n      blockers++;\n    }\n    j++;\n  }\n  #pragma unroll_loop_end\n\n  if (blockers > 0.0) {\n    return blockerDepthSum / blockers;\n  }\n  return -1.0;\n}\n\n        \nfloat vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float shadow = 0.0f;\n  int j = 0;\n  vec2 vogelSample = vec2(0.0);\n  vec2 offset = vec2(0.0);\n  #pragma unroll_loop_start\n  for (int i = 0; i < ${r}; i++) {\n    vogelSample = vogelDiskSample(j, ${r}, angle) * texelSize;\n    offset = vogelSample * (1.0 + filterRadius * float(${t}));\n    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    j++;\n  }\n  #pragma unroll_loop_end\n  return shadow * 1.0 / ${r}.0;\n}\n\nfloat PCSS (sampler2D shadowMap, vec4 coords) {\n  vec2 uv = coords.xy;\n  float zReceiver = coords.z; // Assumed to be eye-space z in this code\n  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;\n  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);\n  if (avgBlockerDepth == -1.0) {\n    return 1.0;\n  }\n  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\n  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);\n}`)({size:r,samples:t,focus:e})).replace("#if defined( SHADOWMAP_TYPE_PCF )","\nreturn PCSS(shadowMap, shadowCoord);\n#if defined( SHADOWMAP_TYPE_PCF )"),sn(n,o,i),()=>{T.ShaderChunk.shadowmap_pars_fragment=a,sn(n,o,i)}}),[e,r,t]),null},exports.Sparkles=qa,exports.Sphere=fn,exports.Splat=function({src:e,toneMapped:t=!1,alphaTest:r=0,alphaHash:n=!1,chunkSize:o=25e3,...i}){a.extend({SplatMaterial:Ke});const s=S.useRef(null),l=a.useThree((e=>e.gl)),c=a.useThree((e=>e.camera)),u=a.useLoader(et,e,(e=>{e.gl=l,e.chunkSize=o}));return S.useLayoutEffect((()=>u.connect(s.current)),[e]),a.useFrame((()=>u.update(s.current,c,n))),S.createElement("mesh",M.default({ref:s,frustumCulled:!1},i),S.createElement("splatMaterial",{key:`${e}/${r}/${n}${Ke.key}`,transparent:!n,depthTest:!0,alphaTest:n?0:r,centerAndScaleTexture:u.centerAndScaleTexture,covAndColorTexture:u.covAndColorTexture,depthWrite:!!n||r>0,blending:n?T.NormalBlending:T.CustomBlending,blendSrcAlpha:T.OneFactor,alphaHash:!!n,toneMapped:t}))},exports.SpotLight=Sa,exports.SpotLightShadow=function(e){return e.shader?S.createElement(Ea,e):S.createElement(Ma,e)},exports.SpriteAnimator=jr,exports.Stage=function({children:e,center:t,adjustCamera:r=!0,intensity:n=.5,shadows:a="contact",environment:o="city",preset:i="rembrandt",...s}){var l,c,u,d,m,f,p,h;const x="string"==typeof i?ua[i]:i,[{radius:y,height:v},g]=S.useState({radius:0,width:0,height:0,depth:0}),w=null!==(l=null==a?void 0:a.bias)&&void 0!==l?l:-1e-4,z=null!==(c=null==a?void 0:a.normalBias)&&void 0!==c?c:0,b=null!==(u=null==a?void 0:a.size)&&void 0!==u?u:1024,E=null!==(d=null==a?void 0:a.offset)&&void 0!==d?d:0,C="contact"===a||"contact"===(null==a?void 0:a.type),T="accumulative"===a||"accumulative"===(null==a?void 0:a.type),P={..."object"==typeof a?a:{}},R=o?"string"==typeof o?{preset:o}:o:null,D=S.useCallback((e=>{const{width:r,height:n,depth:a,boundingSphere:o}=e;g({radius:o.radius,width:r,height:n,depth:a}),null!=t&&t.onCentered&&t.onCentered(e)}),[]);return S.createElement(S.Fragment,null,S.createElement("ambientLight",{intensity:n/3}),S.createElement("spotLight",{penumbra:1,position:[x.main[0]*y,x.main[1]*y,x.main[2]*y],intensity:2*n,castShadow:!!a,"shadow-bias":w,"shadow-normalBias":z,"shadow-mapSize":b}),S.createElement("pointLight",{position:[x.fill[0]*y,x.fill[1]*y,x.fill[2]*y],intensity:n}),S.createElement(Un,M.default({fit:!!r,clip:!!r,margin:Number(r),observe:!0},s),S.createElement(da,{radius:y,adjustCamera:r}),S.createElement(wr,M.default({},t,{position:[0,E/2,0],onCentered:D}),e)),S.createElement("group",{position:[0,-v/2-E/2,0]},C&&S.createElement(aa,M.default({scale:4*y,far:y,blur:2},P)),T&&S.createElement(sa,M.default({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:4*y},P),S.createElement(la,{amount:null!==(m=P.amount)&&void 0!==m?m:8,radius:null!==(f=P.radius)&&void 0!==f?f:y,ambient:null!==(p=P.ambient)&&void 0!==p?p:.5,intensity:null!==(h=P.intensity)&&void 0!==h?h:1,position:[x.main[0]*y,x.main[1]*y,x.main[2]*y],size:4*y,bias:-w,mapSize:b}))),o&&S.createElement(na,R))},exports.Stars=Fa,exports.Stats=function({showPanel:e=0,className:t,parent:r}){const n=function(e,t=[],r){const[n,a]=S.useState();return S.useLayoutEffect((()=>{const t=e();return a(t),cr(r,t),()=>cr(r,null)}),t),n}((()=>new R.default),[]);return S.useEffect((()=>{if(n){const o=r&&r.current||document.body;n.showPanel(e),null==o||o.appendChild(n.dom);const i=(null!=t?t:"").split(" ").filter((e=>e));i.length&&n.dom.classList.add(...i);const s=a.addEffect((()=>n.begin())),l=a.addAfterEffect((()=>n.end()));return()=>{i.length&&n.dom.classList.remove(...i),null==o||o.removeChild(n.dom),s(),l()}}}),[r,n,t,e]),null},exports.StatsGl=ur,exports.Svg=$e,exports.Tetrahedron=vn,exports.Text=he,exports.Text3D=we,exports.Texture=({children:e,input:t,onLoad:r})=>{const n=Se(t,r);return S.createElement(S.Fragment,null,null==e?void 0:e(n))},exports.Torus=xn,exports.TorusKnot=yn,exports.TrackballControls=dt,exports.Trail=Be,exports.TrailTexture=({children:e,...t})=>{const r=gr(t);return S.createElement(S.Fragment,null,null==e?void 0:e(r))},exports.TransformControls=ft,exports.Tube=hn,exports.VideoTexture=nr,exports.View=Zo,exports.WebcamVideoTexture=ji,exports.Wireframe=function({geometry:e,...t}){return e?S.createElement(ro,M.default({geometry:e},t)):S.createElement(no,t)},exports.accumulativeContext=oa,exports.calcPosFromAngles=Ta,exports.calculateScaleFactor=ie,exports.checkIfFrameIsEmpty=ir,exports.createInstances=function(){const e=S.createContext(null);return[S.forwardRef(((t,r)=>S.createElement(Ir,M.default({ref:r,context:e},t)))),S.forwardRef(((t,r)=>S.createElement(Lr,M.default({ref:r,context:e},t))))]},exports.getFirstFrame=or,exports.isWebGL2Available=()=>{try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},exports.meshBounds=function(e,t){const r=this.geometry,n=this.material,a=this.matrixWorld;void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),To.copy(r.boundingSphere),To.applyMatrix4(a),!1!==e.ray.intersectsSphere(To)&&(So.copy(a).invert(),Co.copy(e.ray).applyMatrix4(So),null!==r.boundingBox&&null===Co.intersectBox(r.boundingBox,Po)||t.push({distance:Po.distanceTo(e.ray.origin),point:Po.clone(),object:this})))},exports.shaderMaterial=Ee,exports.useAnimations=function(e,t){const r=S.useRef(null),[o]=S.useState((()=>t?t instanceof n.Object3D?{current:t}:t:r)),[i]=S.useState((()=>new n.AnimationMixer(void 0)));S.useLayoutEffect((()=>{t&&(o.current=t instanceof n.Object3D?t:t.current),i._root=o.current}));const s=S.useRef({}),l=S.useMemo((()=>{const t={};return e.forEach((e=>Object.defineProperty(t,e.name,{enumerable:!0,get(){if(o.current)return s.current[e.name]||(s.current[e.name]=i.clipAction(e,o.current))},configurable:!0}))),{ref:o,clips:e,actions:t,names:e.map((e=>e.name)),mixer:i}}),[e]);return a.useFrame(((e,t)=>i.update(t))),S.useEffect((()=>{const e=o.current;return()=>{s.current={},i.stopAllAction(),Object.values(l.actions).forEach((t=>{e&&i.uncacheAction(t,e)}))}}),[e]),l},exports.useAspect=function(e,t,r=1){const n=a.useThree((e=>e.viewport)),o=t*(n.aspect>e/t?n.width/e:n.height/t);return[e*(n.aspect>e/t?n.width/e:n.height/t)*r,o*r,1]},exports.useBVH=function(e,t){t={strategy:g.SAH,verbose:!1,setBoundingBox:!0,maxDepth:40,maxLeafTris:10,indirect:!1,...t},S.useEffect((()=>{if(e.current){e.current.raycast=g.acceleratedRaycast;const r=e.current.geometry;return r.computeBoundsTree=g.computeBoundsTree,r.disposeBoundsTree=g.disposeBoundsTree,r.computeBoundsTree(t),()=>{r.boundsTree&&r.disposeBoundsTree()}}}),[e,JSON.stringify(t)])},exports.useBounds=Vn,exports.useBoxProjectedEnv=function(e=new T.Vector3,t=new T.Vector3){const[r]=S.useState((()=>({position:new T.Vector3,size:new T.Vector3})));a.applyProps(r,{position:e,size:t});const n=S.useRef(null),o=S.useMemo((()=>({ref:n,onBeforeCompile:e=>function(e,t,r){e.defines.BOX_PROJECTED_ENV_MAP=!0,e.uniforms.envMapPosition={value:t},e.uniforms.envMapSize={value:r},e.vertexShader=`\n  varying vec3 vWorldPosition;\n  ${e.vertexShader.replace("#include <worldpos_vertex>","\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n  vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n  #ifdef BOX_PROJECTED_ENV_MAP\n    vWorldPosition = worldPosition.xyz;\n  #endif\n#endif\n")}`,e.fragmentShader=`\n    \n#ifdef BOX_PROJECTED_ENV_MAP\n  uniform vec3 envMapSize;\n  uniform vec3 envMapPosition;\n  varying vec3 vWorldPosition;\n    \n  vec3 parallaxCorrectNormal( vec3 v, vec3 cubeSize, vec3 cubePos ) {\n    vec3 nDir = normalize( v );\n    vec3 rbmax = ( .5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbmin = ( -.5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbminmax;\n    rbminmax.x = ( nDir.x > 0. ) ? rbmax.x : rbmin.x;\n    rbminmax.y = ( nDir.y > 0. ) ? rbmax.y : rbmin.y;\n    rbminmax.z = ( nDir.z > 0. ) ? rbmax.z : rbmin.z;\n    float correction = min( min( rbminmax.x, rbminmax.y ), rbminmax.z );\n    vec3 boxIntersection = vWorldPosition + nDir * correction;    \n    return boxIntersection - cubePos;\n  }\n#endif\n\n    ${e.fragmentShader.replace("#include <envmap_physical_pars_fragment>",T.ShaderChunk.envmap_physical_pars_fragment).replace("vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n         \n#ifdef BOX_PROJECTED_ENV_MAP\n  worldNormal = parallaxCorrectNormal( worldNormal, envMapSize, envMapPosition );\n#endif\n\n         ").replace("reflectVec = inverseTransformDirection( reflectVec, viewMatrix );","reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n         \n#ifdef BOX_PROJECTED_ENV_MAP\n  reflectVec = parallaxCorrectNormal( reflectVec, envMapSize, envMapPosition );\n#endif\n\n        ")}`}(e,r.position,r.size),customProgramCacheKey:()=>JSON.stringify(r.position.toArray())+JSON.stringify(r.size.toArray())})),[...r.position.toArray(),...r.size.toArray()]);return S.useLayoutEffect((()=>{n.current.needsUpdate=!0}),[r]),o},exports.useCamera=function(e,t){const r=a.useThree((e=>e.pointer)),[o]=S.useState((()=>{const o=new n.Raycaster;return t&&a.applyProps(o,t),function(t,a){o.setFromCamera(r,e instanceof n.Camera?e:e.current);const i=this.constructor.prototype.raycast.bind(this);i&&i(o,a)}}));return o},exports.useContextBridge=function(...e){const t=S.useRef([]);return t.current=e.map((e=>S.useContext(e))),S.useMemo((()=>({children:r})=>e.reduceRight(((e,r,n)=>S.createElement(r.Provider,{value:t.current[n],children:e})),r)),[])},exports.useCubeCamera=it,exports.useCubeTexture=Yt,exports.useCursor=function(e,t="pointer",r="auto",n=document.body){S.useEffect((()=>{if(e)return n.style.cursor=t,()=>{n.style.cursor=r}}),[e])},exports.useDepthBuffer=function({size:e=256,frames:t=1/0}={}){const r=a.useThree((e=>e.viewport.dpr)),{width:o,height:i}=a.useThree((e=>e.size)),s=e||o*r,l=e||i*r,c=S.useMemo((()=>{const e=new n.DepthTexture(s,l);return e.format=n.DepthFormat,e.type=n.UnsignedShortType,{depthTexture:e}}),[s,l]);let u=0;const d=rt(s,l,c);return a.useFrame((e=>{(t===1/0||u<t)&&(e.gl.setRenderTarget(d),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),u++)})),d.depthTexture},exports.useDetectGPU=dr,exports.useEnvironment=$n,exports.useFBO=rt,exports.useFBX=Qt,exports.useFaceControls=()=>t.useContext(ts),exports.useFaceLandmarker=Ki,exports.useFont=ve,exports.useGLTF=Ye,exports.useGizmoContext=Mt,exports.useHelper=lr,exports.useIntersect=pr,exports.useKTX2=Jt,exports.useKeyboardControls=function(e){const[t,r,n]=S.useContext(K);return e?n(e):[t,r]},exports.useMask=function(e,t=!1){return{stencilWrite:!0,stencilRef:e,stencilFunc:t?T.NotEqualStencilFunc:T.EqualStencilFunc,stencilFail:T.KeepStencilOp,stencilZFail:T.KeepStencilOp,stencilZPass:T.KeepStencilOp}},exports.useMatcapTexture=Xa,exports.useMotion=vt,exports.useNormalTexture=Za,exports.usePerformanceMonitor=function({onIncline:e,onDecline:r,onChange:n,onFallback:a}){const o=t.useContext(Ro),i=t.useRef({onIncline:e,onDecline:r,onChange:n,onFallback:a});t.useLayoutEffect((()=>{i.current.onIncline=e,i.current.onDecline=r,i.current.onChange=n,i.current.onFallback=a}),[e,r,n,a]),t.useLayoutEffect((()=>o.subscribe(i)),[o])},exports.useProgress=G,exports.useScroll=X,exports.useSelect=function(){return S.useContext(J)},exports.useSpriteAnimator=function(){return S.useContext(Or)},exports.useSpriteLoader=sr,exports.useSurfaceSampler=Ue,exports.useTexture=Se,exports.useTrail=Ie,exports.useTrailTexture=gr,exports.useVideoTexture=rr;
./node_modules/.vite/deps/@react-three_drei.js:  }), files || preset ? React100.createElement(EnvironmentCube, {
./src/components/Engine3DVisualization.tsx:          <Environment preset="hangar" />
$ grep -r "hangar\|Environment" --include="*.ts" --include="*.tsx" --include="*.js" --include="*.jsx" .

./node_modules/.pnpm/@babel+traverse@7.28.4/node_modules/@babel/traverse/lib/path/conversion.js:exports.unwrapFunctionEnvironment = unwrapFunctionEnvironment;
./node_modules/.pnpm/@babel+traverse@7.28.4/node_modules/@babel/traverse/lib/path/conversion.js:function unwrapFunctionEnvironment() {
./node_modules/.pnpm/@babel+traverse@7.28.4/node_modules/@babel/traverse/lib/path/conversion.js:  hoistFunctionEnvironment(this);
./node_modules/.pnpm/@babel+traverse@7.28.4/node_modules/@babel/traverse/lib/path/conversion.js:  } = hoistFunctionEnvironment(self, noNewArrows, allowInsertArrow, allowInsertArrowWithRest);
./node_modules/.pnpm/@babel+traverse@7.28.4/node_modules/@babel/traverse/lib/path/conversion.js:function hoistFunctionEnvironment(fnPath, noNewArrows = true, allowInsertArrow = true, allowInsertArrowWithRest = true) {
./node_modules/.pnpm/@babel+traverse@7.28.4/node_modules/@babel/traverse/lib/path/index.js:  unwrapFunctionEnvironment: NodePath_conversion.unwrapFunctionEnvironment,
./node_modules/.pnpm/@types+babel__traverse@7.28.0/node_modules/@types/babel__traverse/index.d.ts:    unwrapFunctionEnvironment(): void;
./node_modules/.pnpm/@vue+compiler-sfc@3.5.21/node_modules/@vue/compiler-sfc/dist/compiler-sfc.cjs.js:		        env = new engine.Environment(options.loader);
./node_modules/.pnpm/@vue+compiler-sfc@3.5.21/node_modules/@vue/compiler-sfc/dist/compiler-sfc.cjs.js:		        env = new engine.Environment(
./node_modules/.pnpm/@vue+compiler-sfc@3.5.21/node_modules/@vue/compiler-sfc/dist/compiler-sfc.cjs.js:		          env = new engine.Environment(new engine.FileSystemLoader(options.nunjucks.loader));
./node_modules/.pnpm/@vue+compiler-sfc@3.5.21/node_modules/@vue/compiler-sfc/dist/compiler-sfc.cjs.js:		          env = new engine.Environment(
./node_modules/.pnpm/@vue+compiler-sfc@3.5.21/node_modules/@vue/compiler-sfc/dist/compiler-sfc.cjs.js:		      new engine.TwingEnvironment(new engine.TwingLoaderNull()).createTemplate(str).then((twingTemplate) => {
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * The `process.allowedNodeEnvironmentFlags` property is a special,
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * `process.allowedNodeEnvironmentFlags` extends `Set`, but overrides `Set.prototype.has` to recognize several different possible flag
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * representations. `process.allowedNodeEnvironmentFlags.has()` will
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * When iterating over `process.allowedNodeEnvironmentFlags`, flags will
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * import { allowedNodeEnvironmentFlags } from 'node:process';
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * allowedNodeEnvironmentFlags.forEach((flag) => {
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * The methods `add()`, `clear()`, and `delete()` of`process.allowedNodeEnvironmentFlags` do nothing, and will fail
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * If Node.js was compiled _without_ `NODE_OPTIONS` support (shown in {@link config}), `process.allowedNodeEnvironmentFlags` will
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                allowedNodeEnvironmentFlags: ReadonlySet<string>;
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/process.d.ts:                 * @param env Environment key-value pairs.
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/trace_events.d.ts: * * `node.environment`: Enables capture of Node.js Environment milestones.
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:     * Within a worker thread, `worker.getEnvironmentData()` returns a clone
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:     * of data passed to the spawning thread's `worker.setEnvironmentData()`.
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:     *   setEnvironmentData,
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:     *   getEnvironmentData,
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:     *   setEnvironmentData('Hello', 'World!');
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:     *   console.log(getEnvironmentData('Hello'));  // Prints 'World!'.
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:    function getEnvironmentData(key: Serializable): Serializable;
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:     * The `worker.setEnvironmentData()` API sets the content of `worker.getEnvironmentData()` in the current thread and all new `Worker` instances spawned from the current context.
./node_modules/.pnpm/@types+node@22.18.3/node_modules/@types/node/worker_threads.d.ts:    function setEnvironmentData(key: Serializable, value?: Serializable): void;
./node_modules/.pnpm/browserslist@4.26.0/node_modules/browserslist/index.d.ts:     * Environment to choose part of config.
./node_modules/.pnpm/caniuse-lite@1.0.30001741/node_modules/caniuse-lite/data/features/css-env-function.js:module.exports={A:{A:{"2":"K D E F A B tC"},B:{"1":"0 1 2 3 4 5 Q H R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z FB GB HB IB JB KB LB MB NB OB PB QB RB SB TB UB I VB","2":"C L M G N O P"},C:{"1":"0 1 2 3 4 5 6B 7B 8B 9B AC BC CC DC EC FC GC HC IC JC Q H R UC S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z FB GB HB IB JB KB LB MB NB OB PB QB RB SB TB UB I VB VC KC WC vC wC","2":"6 7 8 9 uC RC J WB K D E F A B C L M G N O P XB AB BB CB DB EB YB ZB aB bB cB dB eB fB gB hB iB jB kB lB mB nB oB pB qB rB sB tB uB vB wB xB yB zB 0B 1B SC 2B TC 3B 4B 5B xC yC"},D:{"1":"0 1 2 3 4 5 AC BC CC DC EC FC GC HC IC JC Q H R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z FB GB HB IB JB KB LB MB NB OB PB QB RB SB TB UB I VB VC KC WC","2":"6 7 8 9 J WB K D E F A B C L M G N O P XB AB BB CB DB EB YB ZB aB bB cB dB eB fB gB hB iB jB kB lB mB nB oB pB qB rB sB tB uB vB wB xB yB zB 0B 1B SC 2B TC 3B 4B 5B 6B 7B 8B 9B"},E:{"1":"C L M G LC MC 4C 5C 6C ZC aC NC 7C OC bC cC dC eC fC 8C PC gC hC iC jC kC 9C QC lC mC nC oC pC qC AD","2":"J WB K D E F A zC XC 0C 1C 2C 3C YC","132":"B"},F:{"1":"0 1 2 3 4 5 zB 0B 1B 2B 3B 4B 5B 6B 7B 8B 9B AC BC CC DC EC FC GC HC IC JC Q H R UC S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z","2":"6 7 8 9 F B C G N O P XB AB BB CB DB EB YB ZB aB bB cB dB eB fB gB hB iB jB kB lB mB nB oB pB qB rB sB tB uB vB wB xB yB BD CD DD ED LC rC FD MC"},G:{"1":"QD RD SD TD UD VD WD XD YD ZD ZC aC NC aD OC bC cC dC eC fC bD PC gC hC iC jC kC cD QC lC mC nC oC pC qC","2":"E XC GD sC HD ID JD KD LD MD ND OD","132":"PD"},H:{"2":"dD"},I:{"1":"I","2":"RC J eD fD gD hD sC iD jD"},J:{"2":"D A"},K:{"1":"H","2":"A B C LC rC MC"},L:{"1":"I"},M:{"1":"KC"},N:{"2":"A B"},O:{"1":"NC"},P:{"1":"6 7 8 9 AB BB CB DB EB YC pD qD rD sD tD OC PC QC uD","2":"J kD lD mD nD oD"},Q:{"1":"vD"},R:{"1":"wD"},S:{"1":"yD","2":"xD"}},B:7,C:"CSS Environment Variables env()",D:true};
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/types/index.d.ts:		 * @see [Environments](https://eslint.org/docs/latest/use/configure/language-options-deprecated#specifying-environments)
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/types/index.d.ts:	interface Environment {
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/types/index.d.ts:		environments?: Record<string, Environment> | undefined;
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/shared/runtime-info.js:		"Environment Info:",
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:			environments: BuiltInEnvironments,
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:/** @typedef {import("../types").ESLint.Environment} Environment */
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js: * @param {Environment[]} enabledEnvironments The environments enabled in configuration and with inline comments
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:function resolveParserOptions(parser, providedOptions, enabledEnvironments) {
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:	const parserOptionsFromEnv = enabledEnvironments
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js: * @param {Environment[]} enabledEnvironments The environments enabled in configuration and with inline comments
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:function resolveGlobals(providedGlobals, enabledEnvironments) {
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:		...enabledEnvironments
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js: * @returns {Environment|null} The environment.
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:			slots.lastConfigArray.pluginEnvironments.get(envId)) ||
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/linter/linter.js:		BuiltInEnvironments.get(envId) ||
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/eslint/eslint-helpers.js:function mergeEnvironmentFlags(flags) {
./node_modules/.pnpm/eslint@9.35.0/node_modules/eslint/lib/eslint/eslint-helpers.js:		flags: mergeEnvironmentFlags(flags),
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:import BuiltInEnvironments from "../../conf/environments.js";
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:    validateEnvironment(
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:            const env = getAdditionalEnv(id) || BuiltInEnvironments.get(id) || null;
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:                const message = `${source}:\n\tEnvironment key "${id}" is unknown\n`;
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:        this.validateEnvironment(config.env, source, getAdditionalEnv);
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:            this.validateEnvironment(override.env, source, getAdditionalEnv);
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:        const getPluginEnv = Map.prototype.get.bind(configArray.pluginEnvironments);
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/config-validator.js:            this.validateEnvironment(element.env, element.name, getPluginEnv);
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/types.js: * @typedef {Object} Environment
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/shared/types.js: * @property {Record<string, Environment>} [environments] The definition of plugin environments.
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/config-array/config-array.js: * - `pluginEnvironments`
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/config-array/config-array.js:/** @typedef {import("../../shared/types").Environment} Environment */
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/config-array/config-array.js: * @property {ReadonlyMap<string, Environment>|null} envMap The map from environment ID to environment definition.
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/config-array/config-array.js:     * @type {ReadonlyMap<string, Environment>} The plugin environments.
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/config-array/config-array.js:    get pluginEnvironments() {
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/config-array/extracted-config.js:         * Environments.
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/flat-compat.js:/** @typedef {import("../../shared/types").Environment} Environment */
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/flat-compat.js: * @param {ReadOnlyMap<string,Environment>} options.pluginEnvironments A map of plugin environment
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/flat-compat.js:    pluginEnvironments,
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/flat-compat.js:                } else if (pluginEnvironments.has(envName)) {
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/flat-compat.js:                        ...pluginEnvironments.get(envName)
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/lib/flat-compat.js:                    pluginEnvironments: eslintrcArray.pluginEnvironments,
./node_modules/.pnpm/@eslint+eslintrc@3.3.1/node_modules/@eslint/eslintrc/conf/environments.js:/** @type {Map<string, import("../lib/shared/types").Environment>} */
./node_modules/.pnpm/esquery@1.6.0/node_modules/esquery/dist/esquery.esm.js:    exports.cloneEnvironment = function () {
./node_modules/.pnpm/esquery@1.6.0/node_modules/esquery/dist/esquery.esm.min.js:function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],u=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function a(e,t){return e(t={exports:{}},t.exports),t.exports}var i=a((function(e,t){!function e(t){var r,n,o,a,i,s;function u(e){var t,r,n={};for(t in e)e.hasOwnProperty(t)&&(r=e[t],n[t]="object"==typeof r&&null!==r?u(r):r);return n}function l(e,t){this.parent=e,this.key=t}function c(e,t,r,n){this.node=e,this.path=t,this.wrap=r,this.ref=n}function f(){}function p(e){return null!=e&&("object"==typeof e&&"string"==typeof e.type)}function h(e,t){return(e===r.ObjectExpression||e===r.ObjectPattern)&&"properties"===t}function y(e,t){for(var r=e.length-1;r>=0;--r)if(e[r].node===t)return!0;return!1}function d(e,t){return(new f).traverse(e,t)}function m(e,t){var r;return r=function(e,t){var r,n,o,a;for(n=e.length,o=0;n;)t(e[a=o+(r=n>>>1)])?n=r:(o=a+1,n-=r+1);return o}(t,(function(t){return t.range[0]>e.range[0]})),e.extendedRange=[e.range[0],e.range[1]],r!==t.length&&(e.extendedRange[1]=t[r].range[0]),(r-=1)>=0&&(e.extendedRange[0]=t[r].range[1]),e}return r={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},o={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},n={Break:a={},Skip:i={},Remove:s={}},l.prototype.replace=function(e){this.parent[this.key]=e},l.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)},f.prototype.path=function(){var e,t,r,n,o;function a(e,t){if(Array.isArray(t))for(r=0,n=t.length;r<n;++r)e.push(t[r]);else e.push(t)}if(!this.__current.path)return null;for(o=[],e=2,t=this.__leavelist.length;e<t;++e)a(o,this.__leavelist[e].path);return a(o,this.__current.path),o},f.prototype.type=function(){return this.current().type||this.__current.wrap},f.prototype.parents=function(){var e,t,r;for(r=[],e=1,t=this.__leavelist.length;e<t;++e)r.push(this.__leavelist[e].node);return r},f.prototype.current=function(){return this.__current.node},f.prototype.__execute=function(e,t){var r,n;return n=void 0,r=this.__current,this.__current=t,this.__state=null,e&&(n=e.call(this,t.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=r,n},f.prototype.notify=function(e){this.__state=e},f.prototype.skip=function(){this.notify(i)},f.prototype.break=function(){this.notify(a)},f.prototype.remove=function(){this.notify(s)},f.prototype.__initialize=function(e,t){this.visitor=t,this.root=e,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,"iteration"===t.fallback?this.__fallback=Object.keys:"function"==typeof t.fallback&&(this.__fallback=t.fallback),this.__keys=o,t.keys&&(this.__keys=Object.assign(Object.create(this.__keys),t.keys))},f.prototype.traverse=function(e,t){var r,n,o,s,u,l,f,d,m,x,v,g;for(this.__initialize(e,t),g={},r=this.__worklist,n=this.__leavelist,r.push(new c(e,null,null,null)),n.push(new c(null,null,null,null));r.length;)if((o=r.pop())!==g){if(o.node){if(l=this.__execute(t.enter,o),this.__state===a||l===a)return;if(r.push(g),n.push(o),this.__state===i||l===i)continue;if(u=(s=o.node).type||o.wrap,!(x=this.__keys[u])){if(!this.__fallback)throw new Error("Unknown node type "+u+".");x=this.__fallback(s)}for(d=x.length;(d-=1)>=0;)if(v=s[f=x[d]])if(Array.isArray(v)){for(m=v.length;(m-=1)>=0;)if(v[m]&&!y(n,v[m])){if(h(u,x[d]))o=new c(v[m],[f,m],"Property",null);else{if(!p(v[m]))continue;o=new c(v[m],[f,m],null,null)}r.push(o)}}else if(p(v)){if(y(n,v))continue;r.push(new c(v,f,null,null))}}}else if(o=n.pop(),l=this.__execute(t.leave,o),this.__state===a||l===a)return},f.prototype.replace=function(e,t){var r,n,o,u,f,y,d,m,x,v,g,A,E;function b(e){var t,n,o,a;if(e.ref.remove())for(n=e.ref.key,a=e.ref.parent,t=r.length;t--;)if((o=r[t]).ref&&o.ref.parent===a){if(o.ref.key<n)break;--o.ref.key}}for(this.__initialize(e,t),g={},r=this.__worklist,n=this.__leavelist,y=new c(e,null,null,new l(A={root:e},"root")),r.push(y),n.push(y);r.length;)if((y=r.pop())!==g){if(void 0!==(f=this.__execute(t.enter,y))&&f!==a&&f!==i&&f!==s&&(y.ref.replace(f),y.node=f),this.__state!==s&&f!==s||(b(y),y.node=null),this.__state===a||f===a)return A.root;if((o=y.node)&&(r.push(g),n.push(y),this.__state!==i&&f!==i)){if(u=o.type||y.wrap,!(x=this.__keys[u])){if(!this.__fallback)throw new Error("Unknown node type "+u+".");x=this.__fallback(o)}for(d=x.length;(d-=1)>=0;)if(v=o[E=x[d]])if(Array.isArray(v)){for(m=v.length;(m-=1)>=0;)if(v[m]){if(h(u,x[d]))y=new c(v[m],[E,m],"Property",new l(v,m));else{if(!p(v[m]))continue;y=new c(v[m],[E,m],null,new l(v,m))}r.push(y)}}else p(v)&&r.push(new c(v,E,null,new l(o,E)))}}else if(y=n.pop(),void 0!==(f=this.__execute(t.leave,y))&&f!==a&&f!==i&&f!==s&&y.ref.replace(f),this.__state!==s&&f!==s||b(y),this.__state===a||f===a)return A.root;return A.root},t.Syntax=r,t.traverse=d,t.replace=function(e,t){return(new f).replace(e,t)},t.attachComments=function(e,t,r){var o,a,i,s,l=[];if(!e.range)throw new Error("attachComments needs range information");if(!r.length){if(t.length){for(i=0,a=t.length;i<a;i+=1)(o=u(t[i])).extendedRange=[0,e.range[0]],l.push(o);e.leadingComments=l}return e}for(i=0,a=t.length;i<a;i+=1)l.push(m(u(t[i]),r));return s=0,d(e,{enter:function(e){for(var t;s<l.length&&!((t=l[s]).extendedRange[1]>e.range[0]);)t.extendedRange[1]===e.range[0]?(e.leadingComments||(e.leadingComments=[]),e.leadingComments.push(t),l.splice(s,1)):s+=1;return s===l.length?n.Break:l[s].extendedRange[0]>e.range[1]?n.Skip:void 0}}),s=0,d(e,{leave:function(e){for(var t;s<l.length&&(t=l[s],!(e.range[1]<t.extendedRange[0]));)e.range[1]===t.extendedRange[0]?(e.trailingComments||(e.trailingComments=[]),e.trailingComments.push(t),l.splice(s,1)):s+=1;return s===l.length?n.Break:l[s].extendedRange[0]>e.range[1]?n.Skip:void 0}}),e},t.VisitorKeys=o,t.VisitorOption=n,t.Controller=f,t.cloneEnvironment=function(){return e({})},t}(t)})),s=a((function(e){e.exports&&(e.exports=function(){function e(t,r,n,o){this.message=t,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,o,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(o=e[t],r[o.type](o));if(a.sort(),a.length>0){for(t=1,n=1;t<a.length;t++)a[t-1]!==a[t]&&(a[n]=a[t],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,o,a,i,s={},u={start:me},l=me,c=fe(" ",!1),f=/^[^ [\],():#!=><~+.]/,p=pe([" ","[","]",",","(",")",":","#","!","=",">","<","~","+","."],!0,!1),h=fe(">",!1),y=fe("~",!1),d=fe("+",!1),m=fe(",",!1),x=function(e,t){return[e].concat(t.map((function(e){return e[3]})))},v=fe("!",!1),g=fe("*",!1),A=fe("#",!1),E=fe("[",!1),b=fe("]",!1),S=/^[><!]/,_=pe([">","<","!"],!1,!1),C=fe("=",!1),w=function(e){return(e||"")+"="},P=/^[><]/,k=pe([">","<"],!1,!1),D=fe(".",!1),I=function(e,t,r){return{type:"attribute",name:e,operator:t,value:r}},j=fe('"',!1),T=/^[^\\"]/,F=pe(["\\",'"'],!0,!1),R=fe("\\",!1),O={type:"any"},L=function(e,t){return e+t},M=function(e){return{type:"literal",value:(t=e.join(""),t.replace(/\\(.)/g,(function(e,t){switch(t){case"b":return"\b";case"f":return"\f";case"n":return"\n";case"r":return"\r";case"t":return"\t";case"v":return"\v";default:return t}})))};var t},B=fe("'",!1),U=/^[^\\']/,K=pe(["\\","'"],!0,!1),N=/^[0-9]/,W=pe([["0","9"]],!1,!1),V=fe("type(",!1),q=/^[^ )]/,G=pe([" ",")"],!0,!1),z=fe(")",!1),H=/^[imsu]/,Y=pe(["i","m","s","u"],!1,!1),$=fe("/",!1),J=/^[^\/]/,Q=pe(["/"],!0,!1),X=fe(":not(",!1),Z=fe(":matches(",!1),ee=fe(":has(",!1),te=fe(":first-child",!1),re=fe(":last-child",!1),ne=fe(":nth-child(",!1),oe=fe(":nth-last-child(",!1),ae=fe(":",!1),ie=0,se=[{line:1,column:1}],ue=0,le=[],ce={};if("startRule"in r){if(!(r.startRule in u))throw new Error("Can't start parsing from rule \""+r.startRule+'".');l=u[r.startRule]}function fe(e,t){return{type:"literal",text:e,ignoreCase:t}}function pe(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function he(e){var r,n=se[e];if(n)return n;for(r=e-1;!se[r];)r--;for(n={line:(n=se[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return se[e]=n,n}function ye(e,t){var r=he(e),n=he(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function de(e){ie<ue||(ie>ue&&(ue=ie,le=[]),le.push(e))}function me(){var e,t,r,n,o=32*ie+0,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,(t=xe())!==s&&(r=Ae())!==s&&xe()!==s?e=t=1===(n=r).length?n[0]:{type:"matches",selectors:n}:(ie=e,e=s),e===s&&(e=ie,(t=xe())!==s&&(t=void 0),e=t),ce[o]={nextPos:ie,result:e},e)}function xe(){var e,r,n=32*ie+1,o=ce[n];if(o)return ie=o.nextPos,o.result;for(e=[],32===t.charCodeAt(ie)?(r=" ",ie++):(r=s,de(c));r!==s;)e.push(r),32===t.charCodeAt(ie)?(r=" ",ie++):(r=s,de(c));return ce[n]={nextPos:ie,result:e},e}function ve(){var e,r,n,o=32*ie+2,a=ce[o];if(a)return ie=a.nextPos,a.result;if(r=[],f.test(t.charAt(ie))?(n=t.charAt(ie),ie++):(n=s,de(p)),n!==s)for(;n!==s;)r.push(n),f.test(t.charAt(ie))?(n=t.charAt(ie),ie++):(n=s,de(p));else r=s;return r!==s&&(r=r.join("")),e=r,ce[o]={nextPos:ie,result:e},e}function ge(){var e,r,n,o=32*ie+3,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,(r=xe())!==s?(62===t.charCodeAt(ie)?(n=">",ie++):(n=s,de(h)),n!==s&&xe()!==s?e=r="child":(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=xe())!==s?(126===t.charCodeAt(ie)?(n="~",ie++):(n=s,de(y)),n!==s&&xe()!==s?e=r="sibling":(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=xe())!==s?(43===t.charCodeAt(ie)?(n="+",ie++):(n=s,de(d)),n!==s&&xe()!==s?e=r="adjacent":(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,32===t.charCodeAt(ie)?(r=" ",ie++):(r=s,de(c)),r!==s&&(n=xe())!==s?e=r="descendant":(ie=e,e=s)))),ce[o]={nextPos:ie,result:e},e)}function Ae(){var e,r,n,o,a,i,u,l,c=32*ie+5,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,(r=be())!==s){for(n=[],o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=be())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);o!==s;)n.push(o),o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=be())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);n!==s?e=r=x(r,n):(ie=e,e=s)}else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}function Ee(){var e,t,r,n,o,a=32*ie+6,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,(t=ge())===s&&(t=null),t!==s&&(r=be())!==s?(o=r,e=t=(n=t)?{type:n,left:{type:"exactNode"},right:o}:o):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}function be(){var e,t,r,n,o,a,i,u=32*ie+7,l=ce[u];if(l)return ie=l.nextPos,l.result;if(e=ie,(t=Se())!==s){for(r=[],n=ie,(o=ge())!==s&&(a=Se())!==s?n=o=[o,a]:(ie=n,n=s);n!==s;)r.push(n),n=ie,(o=ge())!==s&&(a=Se())!==s?n=o=[o,a]:(ie=n,n=s);r!==s?(i=t,e=t=r.reduce((function(e,t){return{type:t[0],left:e,right:t[1]}}),i)):(ie=e,e=s)}else ie=e,e=s;return ce[u]={nextPos:ie,result:e},e}function Se(){var e,r,n,o,a,i,u,l=32*ie+8,c=ce[l];if(c)return ie=c.nextPos,c.result;if(e=ie,33===t.charCodeAt(ie)?(r="!",ie++):(r=s,de(v)),r===s&&(r=null),r!==s){if(n=[],(o=_e())!==s)for(;o!==s;)n.push(o),o=_e();else n=s;n!==s?(a=r,u=1===(i=n).length?i[0]:{type:"compound",selectors:i},a&&(u.subject=!0),e=r=u):(ie=e,e=s)}else ie=e,e=s;return ce[l]={nextPos:ie,result:e},e}function _e(){var e,r=32*ie+9,n=ce[r];return n?(ie=n.nextPos,n.result):((e=function(){var e,r,n=32*ie+10,o=ce[n];return o?(ie=o.nextPos,o.result):(42===t.charCodeAt(ie)?(r="*",ie++):(r=s,de(g)),r!==s&&(r={type:"wildcard",value:r}),e=r,ce[n]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o=32*ie+11,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,35===t.charCodeAt(ie)?(r="#",ie++):(r=s,de(A)),r===s&&(r=null),r!==s&&(n=ve())!==s?e=r={type:"identifier",value:n}:(ie=e,e=s),ce[o]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a=32*ie+12,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,91===t.charCodeAt(ie)?(r="[",ie++):(r=s,de(E)),r!==s&&xe()!==s&&(n=function(){var e,r,n,o,a=32*ie+16,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,(r=Ce())!==s&&xe()!==s&&(n=function(){var e,r,n,o=32*ie+14,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,33===t.charCodeAt(ie)?(r="!",ie++):(r=s,de(v)),r===s&&(r=null),r!==s?(61===t.charCodeAt(ie)?(n="=",ie++):(n=s,de(C)),n!==s?(r=w(r),e=r):(ie=e,e=s)):(ie=e,e=s),ce[o]={nextPos:ie,result:e},e)}())!==s&&xe()!==s?((o=function(){var e,r,n,o,a,i=32*ie+20,u=ce[i];if(u)return ie=u.nextPos,u.result;if(e=ie,"type("===t.substr(ie,5)?(r="type(",ie+=5):(r=s,de(V)),r!==s)if(xe()!==s){if(n=[],q.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(G)),o!==s)for(;o!==s;)n.push(o),q.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(G));else n=s;n!==s&&(o=xe())!==s?(41===t.charCodeAt(ie)?(a=")",ie++):(a=s,de(z)),a!==s?(r={type:"type",value:n.join("")},e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[i]={nextPos:ie,result:e},e}())===s&&(o=function(){var e,r,n,o,a,i,u=32*ie+22,l=ce[u];if(l)return ie=l.nextPos,l.result;if(e=ie,47===t.charCodeAt(ie)?(r="/",ie++):(r=s,de($)),r!==s){if(n=[],J.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(Q)),o!==s)for(;o!==s;)n.push(o),J.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(Q));else n=s;n!==s?(47===t.charCodeAt(ie)?(o="/",ie++):(o=s,de($)),o!==s?((a=function(){var e,r,n=32*ie+21,o=ce[n];if(o)return ie=o.nextPos,o.result;if(e=[],H.test(t.charAt(ie))?(r=t.charAt(ie),ie++):(r=s,de(Y)),r!==s)for(;r!==s;)e.push(r),H.test(t.charAt(ie))?(r=t.charAt(ie),ie++):(r=s,de(Y));else e=s;return ce[n]={nextPos:ie,result:e},e}())===s&&(a=null),a!==s?(i=a,r={type:"regexp",value:new RegExp(n.join(""),i?i.join(""):"")},e=r):(ie=e,e=s)):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;return ce[u]={nextPos:ie,result:e},e}()),o!==s?(r=I(r,n,o),e=r):(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=Ce())!==s&&xe()!==s&&(n=function(){var e,r,n,o=32*ie+13,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,S.test(t.charAt(ie))?(r=t.charAt(ie),ie++):(r=s,de(_)),r===s&&(r=null),r!==s?(61===t.charCodeAt(ie)?(n="=",ie++):(n=s,de(C)),n!==s?(r=w(r),e=r):(ie=e,e=s)):(ie=e,e=s),e===s&&(P.test(t.charAt(ie))?(e=t.charAt(ie),ie++):(e=s,de(k))),ce[o]={nextPos:ie,result:e},e)}())!==s&&xe()!==s?((o=function(){var e,r,n,o,a,i,u=32*ie+17,l=ce[u];if(l)return ie=l.nextPos,l.result;if(e=ie,34===t.charCodeAt(ie)?(r='"',ie++):(r=s,de(j)),r!==s){for(n=[],T.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(F)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));o!==s;)n.push(o),T.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(F)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));n!==s?(34===t.charCodeAt(ie)?(o='"',ie++):(o=s,de(j)),o!==s?(r=M(n),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;if(e===s)if(e=ie,39===t.charCodeAt(ie)?(r="'",ie++):(r=s,de(B)),r!==s){for(n=[],U.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(K)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));o!==s;)n.push(o),U.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(K)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));n!==s?(39===t.charCodeAt(ie)?(o="'",ie++):(o=s,de(B)),o!==s?(r=M(n),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;return ce[u]={nextPos:ie,result:e},e}())===s&&(o=function(){var e,r,n,o,a,i,u,l=32*ie+18,c=ce[l];if(c)return ie=c.nextPos,c.result;for(e=ie,r=ie,n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));if(n!==s?(46===t.charCodeAt(ie)?(o=".",ie++):(o=s,de(D)),o!==s?r=n=[n,o]:(ie=r,r=s)):(ie=r,r=s),r===s&&(r=null),r!==s){if(n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W)),o!==s)for(;o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));else n=s;n!==s?(i=n,u=(a=r)?[].concat.apply([],a).join(""):"",r={type:"literal",value:parseFloat(u+i.join(""))},e=r):(ie=e,e=s)}else ie=e,e=s;return ce[l]={nextPos:ie,result:e},e}())===s&&(o=function(){var e,t,r=32*ie+19,n=ce[r];return n?(ie=n.nextPos,n.result):((t=ve())!==s&&(t={type:"literal",value:t}),e=t,ce[r]={nextPos:ie,result:e},e)}()),o!==s?(r=I(r,n,o),e=r):(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=Ce())!==s&&(r={type:"attribute",name:r}),e=r)),ce[a]={nextPos:ie,result:e},e)}())!==s&&xe()!==s?(93===t.charCodeAt(ie)?(o="]",ie++):(o=s,de(b)),o!==s?e=r=n:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a,i,u,l,c=32*ie+23,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,46===t.charCodeAt(ie)?(r=".",ie++):(r=s,de(D)),r!==s)if((n=ve())!==s){for(o=[],a=ie,46===t.charCodeAt(ie)?(i=".",ie++):(i=s,de(D)),i!==s&&(u=ve())!==s?a=i=[i,u]:(ie=a,a=s);a!==s;)o.push(a),a=ie,46===t.charCodeAt(ie)?(i=".",ie++):(i=s,de(D)),i!==s&&(u=ve())!==s?a=i=[i,u]:(ie=a,a=s);o!==s?(l=n,r={type:"field",name:o.reduce((function(e,t){return e+t[0]+t[1]}),l)},e=r):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}())===s&&(e=function(){var e,r,n,o,a=32*ie+24,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,":not("===t.substr(ie,5)?(r=":not(",ie+=5):(r=s,de(X)),r!==s&&xe()!==s&&(n=Ae())!==s&&xe()!==s?(41===t.charCodeAt(ie)?(o=")",ie++):(o=s,de(z)),o!==s?e=r={type:"not",selectors:n}:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a=32*ie+25,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,":matches("===t.substr(ie,9)?(r=":matches(",ie+=9):(r=s,de(Z)),r!==s&&xe()!==s&&(n=Ae())!==s&&xe()!==s?(41===t.charCodeAt(ie)?(o=")",ie++):(o=s,de(z)),o!==s?e=r={type:"matches",selectors:n}:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a=32*ie+26,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,":has("===t.substr(ie,5)?(r=":has(",ie+=5):(r=s,de(ee)),r!==s&&xe()!==s&&(n=function(){var e,r,n,o,a,i,u,l,c=32*ie+4,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,(r=Ee())!==s){for(n=[],o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=Ee())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);o!==s;)n.push(o),o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=Ee())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);n!==s?e=r=x(r,n):(ie=e,e=s)}else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}())!==s&&xe()!==s?(41===t.charCodeAt(ie)?(o=")",ie++):(o=s,de(z)),o!==s?e=r={type:"has",selectors:n}:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n=32*ie+27,o=ce[n];return o?(ie=o.nextPos,o.result):(":first-child"===t.substr(ie,12)?(r=":first-child",ie+=12):(r=s,de(te)),r!==s&&(r=we(1)),e=r,ce[n]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n=32*ie+28,o=ce[n];return o?(ie=o.nextPos,o.result):(":last-child"===t.substr(ie,11)?(r=":last-child",ie+=11):(r=s,de(re)),r!==s&&(r=Pe(1)),e=r,ce[n]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a,i=32*ie+29,u=ce[i];if(u)return ie=u.nextPos,u.result;if(e=ie,":nth-child("===t.substr(ie,11)?(r=":nth-child(",ie+=11):(r=s,de(ne)),r!==s)if(xe()!==s){if(n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W)),o!==s)for(;o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));else n=s;n!==s&&(o=xe())!==s?(41===t.charCodeAt(ie)?(a=")",ie++):(a=s,de(z)),a!==s?(r=we(parseInt(n.join(""),10)),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[i]={nextPos:ie,result:e},e}())===s&&(e=function(){var e,r,n,o,a,i=32*ie+30,u=ce[i];if(u)return ie=u.nextPos,u.result;if(e=ie,":nth-last-child("===t.substr(ie,16)?(r=":nth-last-child(",ie+=16):(r=s,de(oe)),r!==s)if(xe()!==s){if(n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W)),o!==s)for(;o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));else n=s;n!==s&&(o=xe())!==s?(41===t.charCodeAt(ie)?(a=")",ie++):(a=s,de(z)),a!==s?(r=Pe(parseInt(n.join(""),10)),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[i]={nextPos:ie,result:e},e}())===s&&(e=function(){var e,r,n,o=32*ie+31,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,58===t.charCodeAt(ie)?(r=":",ie++):(r=s,de(ae)),r!==s&&(n=ve())!==s?e=r={type:"class",name:n}:(ie=e,e=s),ce[o]={nextPos:ie,result:e},e)}()),ce[r]={nextPos:ie,result:e},e)}function Ce(){var e,r,n,o,a,i,u,l,c=32*ie+15,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,(r=ve())!==s){for(n=[],o=ie,46===t.charCodeAt(ie)?(a=".",ie++):(a=s,de(D)),a!==s&&(i=ve())!==s?o=a=[a,i]:(ie=o,o=s);o!==s;)n.push(o),o=ie,46===t.charCodeAt(ie)?(a=".",ie++):(a=s,de(D)),a!==s&&(i=ve())!==s?o=a=[a,i]:(ie=o,o=s);n!==s?(u=r,l=n,e=r=[].concat.apply([u],l).join("")):(ie=e,e=s)}else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}function we(e){return{type:"nth-child",index:{type:"literal",value:e}}}function Pe(e){return{type:"nth-last-child",index:{type:"literal",value:e}}}if((n=l())!==s&&ie===t.length)return n;throw n!==s&&ie<t.length&&de({type:"end"}),o=le,a=ue<t.length?t.charAt(ue):null,i=ue<t.length?ye(ue,ue+1):ye(ue,ue),new e(e.buildMessage(o,a),o,a,i)}}}())}));function u(e,t){for(var r=0;r<t.length;++r){if(null==e)return e;e=e[t[r]]}return e}var l="function"==typeof WeakMap?new WeakMap:null;function c(e){if(null==e)return function(){return!0};if(null!=l){var t=l.get(e);return null!=t||(t=f(e),l.set(e,t)),t}return f(e)}function f(t){switch(t.type){case"wildcard":return function(){return!0};case"identifier":var r=t.value.toLowerCase();return function(e,t,n){var o=n&&n.nodeTypeKey||"type";return r===e[o].toLowerCase()};case"exactNode":return function(e,t){return 0===t.length};case"field":var n=t.name.split(".");return function(e,t){return function e(t,r,n,o){for(var a=r,i=o;i<n.length;++i){if(null==a)return!1;var s=a[n[i]];if(Array.isArray(s)){for(var u=0;u<s.length;++u)if(e(t,s[u],n,i+1))return!0;return!1}a=s}return t===a}(e,t[n.length-1],n,0)};case"matches":var o=t.selectors.map(c);return function(e,t,r){for(var n=0;n<o.length;++n)if(o[n](e,t,r))return!0;return!1};case"compound":var a=t.selectors.map(c);return function(e,t,r){for(var n=0;n<a.length;++n)if(!a[n](e,t,r))return!1;return!0};case"not":var s=t.selectors.map(c);return function(e,t,r){for(var n=0;n<s.length;++n)if(s[n](e,t,r))return!1;return!0};case"has":var l=t.selectors.map(c);return function(e,t,r){var n=!1,o=[];return i.traverse(e,{enter:function(e,t){null!=t&&o.unshift(t);for(var a=0;a<l.length;++a)if(l[a](e,o,r))return n=!0,void this.break()},leave:function(){o.shift()},keys:r&&r.visitorKeys,fallback:r&&r.fallback||"iteration"}),n};case"child":var f=c(t.left),p=c(t.right);return function(e,t,r){return!!(t.length>0&&p(e,t,r))&&f(t[0],t.slice(1),r)};case"descendant":var h=c(t.left),x=c(t.right);return function(e,t,r){if(x(e,t,r))for(var n=0,o=t.length;n<o;++n)if(h(t[n],t.slice(n+1),r))return!0;return!1};case"attribute":var v=t.name.split(".");switch(t.operator){case void 0:return function(e){return null!=u(e,v)};case"=":switch(t.value.type){case"regexp":return function(e){var r=u(e,v);return"string"==typeof r&&t.value.value.test(r)};case"literal":var g="".concat(t.value.value);return function(e){return g==="".concat(u(e,v))};case"type":return function(r){return t.value.value===e(u(r,v))}}throw new Error("Unknown selector value type: ".concat(t.value.type));case"!=":switch(t.value.type){case"regexp":return function(e){return!t.value.value.test(u(e,v))};case"literal":var A="".concat(t.value.value);return function(e){return A!=="".concat(u(e,v))};case"type":return function(r){return t.value.value!==e(u(r,v))}}throw new Error("Unknown selector value type: ".concat(t.value.type));case"<=":return function(e){return u(e,v)<=t.value.value};case"<":return function(e){return u(e,v)<t.value.value};case">":return function(e){return u(e,v)>t.value.value};case">=":return function(e){return u(e,v)>=t.value.value}}throw new Error("Unknown operator: ".concat(t.operator));case"sibling":var E=c(t.left),b=c(t.right);return function(e,r,n){return b(e,r,n)&&y(e,E,r,"LEFT_SIDE",n)||t.left.subject&&E(e,r,n)&&y(e,b,r,"RIGHT_SIDE",n)};case"adjacent":var S=c(t.left),_=c(t.right);return function(e,r,n){return _(e,r,n)&&d(e,S,r,"LEFT_SIDE",n)||t.right.subject&&S(e,r,n)&&d(e,_,r,"RIGHT_SIDE",n)};case"nth-child":var C=t.index.value,w=c(t.right);return function(e,t,r){return w(e,t,r)&&m(e,t,C,r)};case"nth-last-child":var P=-t.index.value,k=c(t.right);return function(e,t,r){return k(e,t,r)&&m(e,t,P,r)};case"class":var D=t.name.toLowerCase();return function(e,r,n){if(n&&n.matchClass)return n.matchClass(t.name,e,r);if(n&&n.nodeTypeKey)return!1;switch(D){case"statement":if("Statement"===e.type.slice(-9))return!0;case"declaration":return"Declaration"===e.type.slice(-11);case"pattern":if("Pattern"===e.type.slice(-7))return!0;case"expression":return"Expression"===e.type.slice(-10)||"Literal"===e.type.slice(-7)||"Identifier"===e.type&&(0===r.length||"MetaProperty"!==r[0].type)||"MetaProperty"===e.type;case"function":return"FunctionDeclaration"===e.type||"FunctionExpression"===e.type||"ArrowFunctionExpression"===e.type}throw new Error("Unknown class name: ".concat(t.name))}}throw new Error("Unknown selector type: ".concat(t.type))}function p(e,t){var r=t&&t.nodeTypeKey||"type",n=e[r];return t&&t.visitorKeys&&t.visitorKeys[n]?t.visitorKeys[n]:i.VisitorKeys[n]?i.VisitorKeys[n]:t&&"function"==typeof t.fallback?t.fallback(e):Object.keys(e).filter((function(e){return e!==r}))}function h(t,r){var n=r&&r.nodeTypeKey||"type";return null!==t&&"object"===e(t)&&"string"==typeof t[n]}function y(e,r,n,o,a){var i=t(n,1)[0];if(!i)return!1;for(var s=p(i,a),u=0;u<s.length;++u){var l=i[s[u]];if(Array.isArray(l)){var c=l.indexOf(e);if(c<0)continue;var f=void 0,y=void 0;"LEFT_SIDE"===o?(f=0,y=c):(f=c+1,y=l.length);for(var d=f;d<y;++d)if(h(l[d],a)&&r(l[d],n,a))return!0}}return!1}function d(e,r,n,o,a){var i=t(n,1)[0];if(!i)return!1;for(var s=p(i,a),u=0;u<s.length;++u){var l=i[s[u]];if(Array.isArray(l)){var c=l.indexOf(e);if(c<0)continue;if("LEFT_SIDE"===o&&c>0&&h(l[c-1],a)&&r(l[c-1],n,a))return!0;if("RIGHT_SIDE"===o&&c<l.length-1&&h(l[c+1],a)&&r(l[c+1],n,a))return!0}}return!1}function m(e,r,n,o){if(0===n)return!1;var a=t(r,1)[0];if(!a)return!1;for(var i=p(a,o),s=0;s<i.length;++s){var u=a[i[s]];if(Array.isArray(u)){var l=n<0?u.length+n:n-1;if(l>=0&&l<u.length&&u[l]===e)return!0}}return!1}function x(t,n,o,a){if(n){var s=[],u=c(n),l=function t(n,o){if(null==n||"object"!=e(n))return[];null==o&&(o=n);for(var a=n.subject?[o]:[],i=Object.keys(n),s=0;s<i.length;++s){var u=i[s],l=n[u];a.push.apply(a,r(t(l,"left"===u?l:o)))}return a}(n).map(c);i.traverse(t,{enter:function(e,t){if(null!=t&&s.unshift(t),u(e,s,a))if(l.length)for(var r=0,n=l.length;r<n;++r){l[r](e,s,a)&&o(e,t,s);for(var i=0,c=s.length;i<c;++i){var f=s.slice(i+1);l[r](s[i],f,a)&&o(s[i],t,f)}}else o(e,t,s)},leave:function(){s.shift()},keys:a&&a.visitorKeys,fallback:a&&a.fallback||"iteration"})}}function v(e,t,r){var n=[];return x(e,t,(function(e){n.push(e)}),r),n}function g(e){return s.parse(e)}function A(e,t,r){return v(e,g(t),r)}A.parse=g,A.match=v,A.traverse=x,A.matches=function(e,t,r,n){return!t||!!e&&(r||(r=[]),c(t)(e,r,n))},A.query=A;export default A;
./node_modules/.pnpm/esquery@1.6.0/node_modules/esquery/dist/esquery.js:      exports.cloneEnvironment = function () {
./node_modules/.pnpm/esquery@1.6.0/node_modules/esquery/dist/esquery.min.js:!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).esquery=t()}(this,(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,s=[],u=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function a(e,t){return e(t={exports:{}},t.exports),t.exports}var i=a((function(e,t){!function e(t){var r,n,o,a,i,s;function u(e){var t,r,n={};for(t in e)e.hasOwnProperty(t)&&(r=e[t],n[t]="object"==typeof r&&null!==r?u(r):r);return n}function l(e,t){this.parent=e,this.key=t}function c(e,t,r,n){this.node=e,this.path=t,this.wrap=r,this.ref=n}function f(){}function p(e){return null!=e&&("object"==typeof e&&"string"==typeof e.type)}function h(e,t){return(e===r.ObjectExpression||e===r.ObjectPattern)&&"properties"===t}function y(e,t){for(var r=e.length-1;r>=0;--r)if(e[r].node===t)return!0;return!1}function d(e,t){return(new f).traverse(e,t)}function m(e,t){var r;return r=function(e,t){var r,n,o,a;for(n=e.length,o=0;n;)t(e[a=o+(r=n>>>1)])?n=r:(o=a+1,n-=r+1);return o}(t,(function(t){return t.range[0]>e.range[0]})),e.extendedRange=[e.range[0],e.range[1]],r!==t.length&&(e.extendedRange[1]=t[r].range[0]),(r-=1)>=0&&(e.extendedRange[0]=t[r].range[1]),e}return r={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},o={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},n={Break:a={},Skip:i={},Remove:s={}},l.prototype.replace=function(e){this.parent[this.key]=e},l.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)},f.prototype.path=function(){var e,t,r,n,o;function a(e,t){if(Array.isArray(t))for(r=0,n=t.length;r<n;++r)e.push(t[r]);else e.push(t)}if(!this.__current.path)return null;for(o=[],e=2,t=this.__leavelist.length;e<t;++e)a(o,this.__leavelist[e].path);return a(o,this.__current.path),o},f.prototype.type=function(){return this.current().type||this.__current.wrap},f.prototype.parents=function(){var e,t,r;for(r=[],e=1,t=this.__leavelist.length;e<t;++e)r.push(this.__leavelist[e].node);return r},f.prototype.current=function(){return this.__current.node},f.prototype.__execute=function(e,t){var r,n;return n=void 0,r=this.__current,this.__current=t,this.__state=null,e&&(n=e.call(this,t.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=r,n},f.prototype.notify=function(e){this.__state=e},f.prototype.skip=function(){this.notify(i)},f.prototype.break=function(){this.notify(a)},f.prototype.remove=function(){this.notify(s)},f.prototype.__initialize=function(e,t){this.visitor=t,this.root=e,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,"iteration"===t.fallback?this.__fallback=Object.keys:"function"==typeof t.fallback&&(this.__fallback=t.fallback),this.__keys=o,t.keys&&(this.__keys=Object.assign(Object.create(this.__keys),t.keys))},f.prototype.traverse=function(e,t){var r,n,o,s,u,l,f,d,m,x,v,g;for(this.__initialize(e,t),g={},r=this.__worklist,n=this.__leavelist,r.push(new c(e,null,null,null)),n.push(new c(null,null,null,null));r.length;)if((o=r.pop())!==g){if(o.node){if(l=this.__execute(t.enter,o),this.__state===a||l===a)return;if(r.push(g),n.push(o),this.__state===i||l===i)continue;if(u=(s=o.node).type||o.wrap,!(x=this.__keys[u])){if(!this.__fallback)throw new Error("Unknown node type "+u+".");x=this.__fallback(s)}for(d=x.length;(d-=1)>=0;)if(v=s[f=x[d]])if(Array.isArray(v)){for(m=v.length;(m-=1)>=0;)if(v[m]&&!y(n,v[m])){if(h(u,x[d]))o=new c(v[m],[f,m],"Property",null);else{if(!p(v[m]))continue;o=new c(v[m],[f,m],null,null)}r.push(o)}}else if(p(v)){if(y(n,v))continue;r.push(new c(v,f,null,null))}}}else if(o=n.pop(),l=this.__execute(t.leave,o),this.__state===a||l===a)return},f.prototype.replace=function(e,t){var r,n,o,u,f,y,d,m,x,v,g,A,E;function b(e){var t,n,o,a;if(e.ref.remove())for(n=e.ref.key,a=e.ref.parent,t=r.length;t--;)if((o=r[t]).ref&&o.ref.parent===a){if(o.ref.key<n)break;--o.ref.key}}for(this.__initialize(e,t),g={},r=this.__worklist,n=this.__leavelist,y=new c(e,null,null,new l(A={root:e},"root")),r.push(y),n.push(y);r.length;)if((y=r.pop())!==g){if(void 0!==(f=this.__execute(t.enter,y))&&f!==a&&f!==i&&f!==s&&(y.ref.replace(f),y.node=f),this.__state!==s&&f!==s||(b(y),y.node=null),this.__state===a||f===a)return A.root;if((o=y.node)&&(r.push(g),n.push(y),this.__state!==i&&f!==i)){if(u=o.type||y.wrap,!(x=this.__keys[u])){if(!this.__fallback)throw new Error("Unknown node type "+u+".");x=this.__fallback(o)}for(d=x.length;(d-=1)>=0;)if(v=o[E=x[d]])if(Array.isArray(v)){for(m=v.length;(m-=1)>=0;)if(v[m]){if(h(u,x[d]))y=new c(v[m],[E,m],"Property",new l(v,m));else{if(!p(v[m]))continue;y=new c(v[m],[E,m],null,new l(v,m))}r.push(y)}}else p(v)&&r.push(new c(v,E,null,new l(o,E)))}}else if(y=n.pop(),void 0!==(f=this.__execute(t.leave,y))&&f!==a&&f!==i&&f!==s&&y.ref.replace(f),this.__state!==s&&f!==s||b(y),this.__state===a||f===a)return A.root;return A.root},t.Syntax=r,t.traverse=d,t.replace=function(e,t){return(new f).replace(e,t)},t.attachComments=function(e,t,r){var o,a,i,s,l=[];if(!e.range)throw new Error("attachComments needs range information");if(!r.length){if(t.length){for(i=0,a=t.length;i<a;i+=1)(o=u(t[i])).extendedRange=[0,e.range[0]],l.push(o);e.leadingComments=l}return e}for(i=0,a=t.length;i<a;i+=1)l.push(m(u(t[i]),r));return s=0,d(e,{enter:function(e){for(var t;s<l.length&&!((t=l[s]).extendedRange[1]>e.range[0]);)t.extendedRange[1]===e.range[0]?(e.leadingComments||(e.leadingComments=[]),e.leadingComments.push(t),l.splice(s,1)):s+=1;return s===l.length?n.Break:l[s].extendedRange[0]>e.range[1]?n.Skip:void 0}}),s=0,d(e,{leave:function(e){for(var t;s<l.length&&(t=l[s],!(e.range[1]<t.extendedRange[0]));)e.range[1]===t.extendedRange[0]?(e.trailingComments||(e.trailingComments=[]),e.trailingComments.push(t),l.splice(s,1)):s+=1;return s===l.length?n.Break:l[s].extendedRange[0]>e.range[1]?n.Skip:void 0}}),e},t.VisitorKeys=o,t.VisitorOption=n,t.Controller=f,t.cloneEnvironment=function(){return e({})},t}(t)})),s=a((function(e){e.exports&&(e.exports=function(){function e(t,r,n,o){this.message=t,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,o,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(o=e[t],r[o.type](o));if(a.sort(),a.length>0){for(t=1,n=1;t<a.length;t++)a[t-1]!==a[t]&&(a[n]=a[t],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,o,a,i,s={},u={start:me},l=me,c=fe(" ",!1),f=/^[^ [\],():#!=><~+.]/,p=pe([" ","[","]",",","(",")",":","#","!","=",">","<","~","+","."],!0,!1),h=fe(">",!1),y=fe("~",!1),d=fe("+",!1),m=fe(",",!1),x=function(e,t){return[e].concat(t.map((function(e){return e[3]})))},v=fe("!",!1),g=fe("*",!1),A=fe("#",!1),E=fe("[",!1),b=fe("]",!1),S=/^[><!]/,_=pe([">","<","!"],!1,!1),C=fe("=",!1),w=function(e){return(e||"")+"="},P=/^[><]/,k=pe([">","<"],!1,!1),D=fe(".",!1),I=function(e,t,r){return{type:"attribute",name:e,operator:t,value:r}},j=fe('"',!1),T=/^[^\\"]/,F=pe(["\\",'"'],!0,!1),R=fe("\\",!1),O={type:"any"},L=function(e,t){return e+t},M=function(e){return{type:"literal",value:(t=e.join(""),t.replace(/\\(.)/g,(function(e,t){switch(t){case"b":return"\b";case"f":return"\f";case"n":return"\n";case"r":return"\r";case"t":return"\t";case"v":return"\v";default:return t}})))};var t},B=fe("'",!1),U=/^[^\\']/,K=pe(["\\","'"],!0,!1),N=/^[0-9]/,W=pe([["0","9"]],!1,!1),q=fe("type(",!1),V=/^[^ )]/,G=pe([" ",")"],!0,!1),z=fe(")",!1),H=/^[imsu]/,Y=pe(["i","m","s","u"],!1,!1),$=fe("/",!1),J=/^[^\/]/,Q=pe(["/"],!0,!1),X=fe(":not(",!1),Z=fe(":matches(",!1),ee=fe(":has(",!1),te=fe(":first-child",!1),re=fe(":last-child",!1),ne=fe(":nth-child(",!1),oe=fe(":nth-last-child(",!1),ae=fe(":",!1),ie=0,se=[{line:1,column:1}],ue=0,le=[],ce={};if("startRule"in r){if(!(r.startRule in u))throw new Error("Can't start parsing from rule \""+r.startRule+'".');l=u[r.startRule]}function fe(e,t){return{type:"literal",text:e,ignoreCase:t}}function pe(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function he(e){var r,n=se[e];if(n)return n;for(r=e-1;!se[r];)r--;for(n={line:(n=se[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return se[e]=n,n}function ye(e,t){var r=he(e),n=he(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function de(e){ie<ue||(ie>ue&&(ue=ie,le=[]),le.push(e))}function me(){var e,t,r,n,o=32*ie+0,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,(t=xe())!==s&&(r=Ae())!==s&&xe()!==s?e=t=1===(n=r).length?n[0]:{type:"matches",selectors:n}:(ie=e,e=s),e===s&&(e=ie,(t=xe())!==s&&(t=void 0),e=t),ce[o]={nextPos:ie,result:e},e)}function xe(){var e,r,n=32*ie+1,o=ce[n];if(o)return ie=o.nextPos,o.result;for(e=[],32===t.charCodeAt(ie)?(r=" ",ie++):(r=s,de(c));r!==s;)e.push(r),32===t.charCodeAt(ie)?(r=" ",ie++):(r=s,de(c));return ce[n]={nextPos:ie,result:e},e}function ve(){var e,r,n,o=32*ie+2,a=ce[o];if(a)return ie=a.nextPos,a.result;if(r=[],f.test(t.charAt(ie))?(n=t.charAt(ie),ie++):(n=s,de(p)),n!==s)for(;n!==s;)r.push(n),f.test(t.charAt(ie))?(n=t.charAt(ie),ie++):(n=s,de(p));else r=s;return r!==s&&(r=r.join("")),e=r,ce[o]={nextPos:ie,result:e},e}function ge(){var e,r,n,o=32*ie+3,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,(r=xe())!==s?(62===t.charCodeAt(ie)?(n=">",ie++):(n=s,de(h)),n!==s&&xe()!==s?e=r="child":(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=xe())!==s?(126===t.charCodeAt(ie)?(n="~",ie++):(n=s,de(y)),n!==s&&xe()!==s?e=r="sibling":(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=xe())!==s?(43===t.charCodeAt(ie)?(n="+",ie++):(n=s,de(d)),n!==s&&xe()!==s?e=r="adjacent":(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,32===t.charCodeAt(ie)?(r=" ",ie++):(r=s,de(c)),r!==s&&(n=xe())!==s?e=r="descendant":(ie=e,e=s)))),ce[o]={nextPos:ie,result:e},e)}function Ae(){var e,r,n,o,a,i,u,l,c=32*ie+5,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,(r=be())!==s){for(n=[],o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=be())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);o!==s;)n.push(o),o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=be())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);n!==s?e=r=x(r,n):(ie=e,e=s)}else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}function Ee(){var e,t,r,n,o,a=32*ie+6,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,(t=ge())===s&&(t=null),t!==s&&(r=be())!==s?(o=r,e=t=(n=t)?{type:n,left:{type:"exactNode"},right:o}:o):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}function be(){var e,t,r,n,o,a,i,u=32*ie+7,l=ce[u];if(l)return ie=l.nextPos,l.result;if(e=ie,(t=Se())!==s){for(r=[],n=ie,(o=ge())!==s&&(a=Se())!==s?n=o=[o,a]:(ie=n,n=s);n!==s;)r.push(n),n=ie,(o=ge())!==s&&(a=Se())!==s?n=o=[o,a]:(ie=n,n=s);r!==s?(i=t,e=t=r.reduce((function(e,t){return{type:t[0],left:e,right:t[1]}}),i)):(ie=e,e=s)}else ie=e,e=s;return ce[u]={nextPos:ie,result:e},e}function Se(){var e,r,n,o,a,i,u,l=32*ie+8,c=ce[l];if(c)return ie=c.nextPos,c.result;if(e=ie,33===t.charCodeAt(ie)?(r="!",ie++):(r=s,de(v)),r===s&&(r=null),r!==s){if(n=[],(o=_e())!==s)for(;o!==s;)n.push(o),o=_e();else n=s;n!==s?(a=r,u=1===(i=n).length?i[0]:{type:"compound",selectors:i},a&&(u.subject=!0),e=r=u):(ie=e,e=s)}else ie=e,e=s;return ce[l]={nextPos:ie,result:e},e}function _e(){var e,r=32*ie+9,n=ce[r];return n?(ie=n.nextPos,n.result):((e=function(){var e,r,n=32*ie+10,o=ce[n];return o?(ie=o.nextPos,o.result):(42===t.charCodeAt(ie)?(r="*",ie++):(r=s,de(g)),r!==s&&(r={type:"wildcard",value:r}),e=r,ce[n]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o=32*ie+11,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,35===t.charCodeAt(ie)?(r="#",ie++):(r=s,de(A)),r===s&&(r=null),r!==s&&(n=ve())!==s?e=r={type:"identifier",value:n}:(ie=e,e=s),ce[o]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a=32*ie+12,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,91===t.charCodeAt(ie)?(r="[",ie++):(r=s,de(E)),r!==s&&xe()!==s&&(n=function(){var e,r,n,o,a=32*ie+16,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,(r=Ce())!==s&&xe()!==s&&(n=function(){var e,r,n,o=32*ie+14,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,33===t.charCodeAt(ie)?(r="!",ie++):(r=s,de(v)),r===s&&(r=null),r!==s?(61===t.charCodeAt(ie)?(n="=",ie++):(n=s,de(C)),n!==s?(r=w(r),e=r):(ie=e,e=s)):(ie=e,e=s),ce[o]={nextPos:ie,result:e},e)}())!==s&&xe()!==s?((o=function(){var e,r,n,o,a,i=32*ie+20,u=ce[i];if(u)return ie=u.nextPos,u.result;if(e=ie,"type("===t.substr(ie,5)?(r="type(",ie+=5):(r=s,de(q)),r!==s)if(xe()!==s){if(n=[],V.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(G)),o!==s)for(;o!==s;)n.push(o),V.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(G));else n=s;n!==s&&(o=xe())!==s?(41===t.charCodeAt(ie)?(a=")",ie++):(a=s,de(z)),a!==s?(r={type:"type",value:n.join("")},e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[i]={nextPos:ie,result:e},e}())===s&&(o=function(){var e,r,n,o,a,i,u=32*ie+22,l=ce[u];if(l)return ie=l.nextPos,l.result;if(e=ie,47===t.charCodeAt(ie)?(r="/",ie++):(r=s,de($)),r!==s){if(n=[],J.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(Q)),o!==s)for(;o!==s;)n.push(o),J.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(Q));else n=s;n!==s?(47===t.charCodeAt(ie)?(o="/",ie++):(o=s,de($)),o!==s?((a=function(){var e,r,n=32*ie+21,o=ce[n];if(o)return ie=o.nextPos,o.result;if(e=[],H.test(t.charAt(ie))?(r=t.charAt(ie),ie++):(r=s,de(Y)),r!==s)for(;r!==s;)e.push(r),H.test(t.charAt(ie))?(r=t.charAt(ie),ie++):(r=s,de(Y));else e=s;return ce[n]={nextPos:ie,result:e},e}())===s&&(a=null),a!==s?(i=a,r={type:"regexp",value:new RegExp(n.join(""),i?i.join(""):"")},e=r):(ie=e,e=s)):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;return ce[u]={nextPos:ie,result:e},e}()),o!==s?(r=I(r,n,o),e=r):(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=Ce())!==s&&xe()!==s&&(n=function(){var e,r,n,o=32*ie+13,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,S.test(t.charAt(ie))?(r=t.charAt(ie),ie++):(r=s,de(_)),r===s&&(r=null),r!==s?(61===t.charCodeAt(ie)?(n="=",ie++):(n=s,de(C)),n!==s?(r=w(r),e=r):(ie=e,e=s)):(ie=e,e=s),e===s&&(P.test(t.charAt(ie))?(e=t.charAt(ie),ie++):(e=s,de(k))),ce[o]={nextPos:ie,result:e},e)}())!==s&&xe()!==s?((o=function(){var e,r,n,o,a,i,u=32*ie+17,l=ce[u];if(l)return ie=l.nextPos,l.result;if(e=ie,34===t.charCodeAt(ie)?(r='"',ie++):(r=s,de(j)),r!==s){for(n=[],T.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(F)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));o!==s;)n.push(o),T.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(F)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));n!==s?(34===t.charCodeAt(ie)?(o='"',ie++):(o=s,de(j)),o!==s?(r=M(n),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;if(e===s)if(e=ie,39===t.charCodeAt(ie)?(r="'",ie++):(r=s,de(B)),r!==s){for(n=[],U.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(K)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));o!==s;)n.push(o),U.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(K)),o===s&&(o=ie,92===t.charCodeAt(ie)?(a="\\",ie++):(a=s,de(R)),a!==s?(t.length>ie?(i=t.charAt(ie),ie++):(i=s,de(O)),i!==s?(a=L(a,i),o=a):(ie=o,o=s)):(ie=o,o=s));n!==s?(39===t.charCodeAt(ie)?(o="'",ie++):(o=s,de(B)),o!==s?(r=M(n),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;return ce[u]={nextPos:ie,result:e},e}())===s&&(o=function(){var e,r,n,o,a,i,u,l=32*ie+18,c=ce[l];if(c)return ie=c.nextPos,c.result;for(e=ie,r=ie,n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));if(n!==s?(46===t.charCodeAt(ie)?(o=".",ie++):(o=s,de(D)),o!==s?r=n=[n,o]:(ie=r,r=s)):(ie=r,r=s),r===s&&(r=null),r!==s){if(n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W)),o!==s)for(;o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));else n=s;n!==s?(i=n,u=(a=r)?[].concat.apply([],a).join(""):"",r={type:"literal",value:parseFloat(u+i.join(""))},e=r):(ie=e,e=s)}else ie=e,e=s;return ce[l]={nextPos:ie,result:e},e}())===s&&(o=function(){var e,t,r=32*ie+19,n=ce[r];return n?(ie=n.nextPos,n.result):((t=ve())!==s&&(t={type:"literal",value:t}),e=t,ce[r]={nextPos:ie,result:e},e)}()),o!==s?(r=I(r,n,o),e=r):(ie=e,e=s)):(ie=e,e=s),e===s&&(e=ie,(r=Ce())!==s&&(r={type:"attribute",name:r}),e=r)),ce[a]={nextPos:ie,result:e},e)}())!==s&&xe()!==s?(93===t.charCodeAt(ie)?(o="]",ie++):(o=s,de(b)),o!==s?e=r=n:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a,i,u,l,c=32*ie+23,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,46===t.charCodeAt(ie)?(r=".",ie++):(r=s,de(D)),r!==s)if((n=ve())!==s){for(o=[],a=ie,46===t.charCodeAt(ie)?(i=".",ie++):(i=s,de(D)),i!==s&&(u=ve())!==s?a=i=[i,u]:(ie=a,a=s);a!==s;)o.push(a),a=ie,46===t.charCodeAt(ie)?(i=".",ie++):(i=s,de(D)),i!==s&&(u=ve())!==s?a=i=[i,u]:(ie=a,a=s);o!==s?(l=n,r={type:"field",name:o.reduce((function(e,t){return e+t[0]+t[1]}),l)},e=r):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}())===s&&(e=function(){var e,r,n,o,a=32*ie+24,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,":not("===t.substr(ie,5)?(r=":not(",ie+=5):(r=s,de(X)),r!==s&&xe()!==s&&(n=Ae())!==s&&xe()!==s?(41===t.charCodeAt(ie)?(o=")",ie++):(o=s,de(z)),o!==s?e=r={type:"not",selectors:n}:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a=32*ie+25,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,":matches("===t.substr(ie,9)?(r=":matches(",ie+=9):(r=s,de(Z)),r!==s&&xe()!==s&&(n=Ae())!==s&&xe()!==s?(41===t.charCodeAt(ie)?(o=")",ie++):(o=s,de(z)),o!==s?e=r={type:"matches",selectors:n}:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a=32*ie+26,i=ce[a];return i?(ie=i.nextPos,i.result):(e=ie,":has("===t.substr(ie,5)?(r=":has(",ie+=5):(r=s,de(ee)),r!==s&&xe()!==s&&(n=function(){var e,r,n,o,a,i,u,l,c=32*ie+4,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,(r=Ee())!==s){for(n=[],o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=Ee())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);o!==s;)n.push(o),o=ie,(a=xe())!==s?(44===t.charCodeAt(ie)?(i=",",ie++):(i=s,de(m)),i!==s&&(u=xe())!==s&&(l=Ee())!==s?o=a=[a,i,u,l]:(ie=o,o=s)):(ie=o,o=s);n!==s?e=r=x(r,n):(ie=e,e=s)}else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}())!==s&&xe()!==s?(41===t.charCodeAt(ie)?(o=")",ie++):(o=s,de(z)),o!==s?e=r={type:"has",selectors:n}:(ie=e,e=s)):(ie=e,e=s),ce[a]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n=32*ie+27,o=ce[n];return o?(ie=o.nextPos,o.result):(":first-child"===t.substr(ie,12)?(r=":first-child",ie+=12):(r=s,de(te)),r!==s&&(r=we(1)),e=r,ce[n]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n=32*ie+28,o=ce[n];return o?(ie=o.nextPos,o.result):(":last-child"===t.substr(ie,11)?(r=":last-child",ie+=11):(r=s,de(re)),r!==s&&(r=Pe(1)),e=r,ce[n]={nextPos:ie,result:e},e)}())===s&&(e=function(){var e,r,n,o,a,i=32*ie+29,u=ce[i];if(u)return ie=u.nextPos,u.result;if(e=ie,":nth-child("===t.substr(ie,11)?(r=":nth-child(",ie+=11):(r=s,de(ne)),r!==s)if(xe()!==s){if(n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W)),o!==s)for(;o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));else n=s;n!==s&&(o=xe())!==s?(41===t.charCodeAt(ie)?(a=")",ie++):(a=s,de(z)),a!==s?(r=we(parseInt(n.join(""),10)),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[i]={nextPos:ie,result:e},e}())===s&&(e=function(){var e,r,n,o,a,i=32*ie+30,u=ce[i];if(u)return ie=u.nextPos,u.result;if(e=ie,":nth-last-child("===t.substr(ie,16)?(r=":nth-last-child(",ie+=16):(r=s,de(oe)),r!==s)if(xe()!==s){if(n=[],N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W)),o!==s)for(;o!==s;)n.push(o),N.test(t.charAt(ie))?(o=t.charAt(ie),ie++):(o=s,de(W));else n=s;n!==s&&(o=xe())!==s?(41===t.charCodeAt(ie)?(a=")",ie++):(a=s,de(z)),a!==s?(r=Pe(parseInt(n.join(""),10)),e=r):(ie=e,e=s)):(ie=e,e=s)}else ie=e,e=s;else ie=e,e=s;return ce[i]={nextPos:ie,result:e},e}())===s&&(e=function(){var e,r,n,o=32*ie+31,a=ce[o];return a?(ie=a.nextPos,a.result):(e=ie,58===t.charCodeAt(ie)?(r=":",ie++):(r=s,de(ae)),r!==s&&(n=ve())!==s?e=r={type:"class",name:n}:(ie=e,e=s),ce[o]={nextPos:ie,result:e},e)}()),ce[r]={nextPos:ie,result:e},e)}function Ce(){var e,r,n,o,a,i,u,l,c=32*ie+15,f=ce[c];if(f)return ie=f.nextPos,f.result;if(e=ie,(r=ve())!==s){for(n=[],o=ie,46===t.charCodeAt(ie)?(a=".",ie++):(a=s,de(D)),a!==s&&(i=ve())!==s?o=a=[a,i]:(ie=o,o=s);o!==s;)n.push(o),o=ie,46===t.charCodeAt(ie)?(a=".",ie++):(a=s,de(D)),a!==s&&(i=ve())!==s?o=a=[a,i]:(ie=o,o=s);n!==s?(u=r,l=n,e=r=[].concat.apply([u],l).join("")):(ie=e,e=s)}else ie=e,e=s;return ce[c]={nextPos:ie,result:e},e}function we(e){return{type:"nth-child",index:{type:"literal",value:e}}}function Pe(e){return{type:"nth-last-child",index:{type:"literal",value:e}}}if((n=l())!==s&&ie===t.length)return n;throw n!==s&&ie<t.length&&de({type:"end"}),o=le,a=ue<t.length?t.charAt(ue):null,i=ue<t.length?ye(ue,ue+1):ye(ue,ue),new e(e.buildMessage(o,a),o,a,i)}}}())}));function u(e,t){for(var r=0;r<t.length;++r){if(null==e)return e;e=e[t[r]]}return e}var l="function"==typeof WeakMap?new WeakMap:null;function c(e){if(null==e)return function(){return!0};if(null!=l){var t=l.get(e);return null!=t||(t=f(e),l.set(e,t)),t}return f(e)}function f(t){switch(t.type){case"wildcard":return function(){return!0};case"identifier":var r=t.value.toLowerCase();return function(e,t,n){var o=n&&n.nodeTypeKey||"type";return r===e[o].toLowerCase()};case"exactNode":return function(e,t){return 0===t.length};case"field":var n=t.name.split(".");return function(e,t){return function e(t,r,n,o){for(var a=r,i=o;i<n.length;++i){if(null==a)return!1;var s=a[n[i]];if(Array.isArray(s)){for(var u=0;u<s.length;++u)if(e(t,s[u],n,i+1))return!0;return!1}a=s}return t===a}(e,t[n.length-1],n,0)};case"matches":var o=t.selectors.map(c);return function(e,t,r){for(var n=0;n<o.length;++n)if(o[n](e,t,r))return!0;return!1};case"compound":var a=t.selectors.map(c);return function(e,t,r){for(var n=0;n<a.length;++n)if(!a[n](e,t,r))return!1;return!0};case"not":var s=t.selectors.map(c);return function(e,t,r){for(var n=0;n<s.length;++n)if(s[n](e,t,r))return!1;return!0};case"has":var l=t.selectors.map(c);return function(e,t,r){var n=!1,o=[];return i.traverse(e,{enter:function(e,t){null!=t&&o.unshift(t);for(var a=0;a<l.length;++a)if(l[a](e,o,r))return n=!0,void this.break()},leave:function(){o.shift()},keys:r&&r.visitorKeys,fallback:r&&r.fallback||"iteration"}),n};case"child":var f=c(t.left),p=c(t.right);return function(e,t,r){return!!(t.length>0&&p(e,t,r))&&f(t[0],t.slice(1),r)};case"descendant":var h=c(t.left),x=c(t.right);return function(e,t,r){if(x(e,t,r))for(var n=0,o=t.length;n<o;++n)if(h(t[n],t.slice(n+1),r))return!0;return!1};case"attribute":var v=t.name.split(".");switch(t.operator){case void 0:return function(e){return null!=u(e,v)};case"=":switch(t.value.type){case"regexp":return function(e){var r=u(e,v);return"string"==typeof r&&t.value.value.test(r)};case"literal":var g="".concat(t.value.value);return function(e){return g==="".concat(u(e,v))};case"type":return function(r){return t.value.value===e(u(r,v))}}throw new Error("Unknown selector value type: ".concat(t.value.type));case"!=":switch(t.value.type){case"regexp":return function(e){return!t.value.value.test(u(e,v))};case"literal":var A="".concat(t.value.value);return function(e){return A!=="".concat(u(e,v))};case"type":return function(r){return t.value.value!==e(u(r,v))}}throw new Error("Unknown selector value type: ".concat(t.value.type));case"<=":return function(e){return u(e,v)<=t.value.value};case"<":return function(e){return u(e,v)<t.value.value};case">":return function(e){return u(e,v)>t.value.value};case">=":return function(e){return u(e,v)>=t.value.value}}throw new Error("Unknown operator: ".concat(t.operator));case"sibling":var E=c(t.left),b=c(t.right);return function(e,r,n){return b(e,r,n)&&y(e,E,r,"LEFT_SIDE",n)||t.left.subject&&E(e,r,n)&&y(e,b,r,"RIGHT_SIDE",n)};case"adjacent":var S=c(t.left),_=c(t.right);return function(e,r,n){return _(e,r,n)&&d(e,S,r,"LEFT_SIDE",n)||t.right.subject&&S(e,r,n)&&d(e,_,r,"RIGHT_SIDE",n)};case"nth-child":var C=t.index.value,w=c(t.right);return function(e,t,r){return w(e,t,r)&&m(e,t,C,r)};case"nth-last-child":var P=-t.index.value,k=c(t.right);return function(e,t,r){return k(e,t,r)&&m(e,t,P,r)};case"class":var D=t.name.toLowerCase();return function(e,r,n){if(n&&n.matchClass)return n.matchClass(t.name,e,r);if(n&&n.nodeTypeKey)return!1;switch(D){case"statement":if("Statement"===e.type.slice(-9))return!0;case"declaration":return"Declaration"===e.type.slice(-11);case"pattern":if("Pattern"===e.type.slice(-7))return!0;case"expression":return"Expression"===e.type.slice(-10)||"Literal"===e.type.slice(-7)||"Identifier"===e.type&&(0===r.length||"MetaProperty"!==r[0].type)||"MetaProperty"===e.type;case"function":return"FunctionDeclaration"===e.type||"FunctionExpression"===e.type||"ArrowFunctionExpression"===e.type}throw new Error("Unknown class name: ".concat(t.name))}}throw new Error("Unknown selector type: ".concat(t.type))}function p(e,t){var r=t&&t.nodeTypeKey||"type",n=e[r];return t&&t.visitorKeys&&t.visitorKeys[n]?t.visitorKeys[n]:i.VisitorKeys[n]?i.VisitorKeys[n]:t&&"function"==typeof t.fallback?t.fallback(e):Object.keys(e).filter((function(e){return e!==r}))}function h(t,r){var n=r&&r.nodeTypeKey||"type";return null!==t&&"object"===e(t)&&"string"==typeof t[n]}function y(e,r,n,o,a){var i=t(n,1)[0];if(!i)return!1;for(var s=p(i,a),u=0;u<s.length;++u){var l=i[s[u]];if(Array.isArray(l)){var c=l.indexOf(e);if(c<0)continue;var f=void 0,y=void 0;"LEFT_SIDE"===o?(f=0,y=c):(f=c+1,y=l.length);for(var d=f;d<y;++d)if(h(l[d],a)&&r(l[d],n,a))return!0}}return!1}function d(e,r,n,o,a){var i=t(n,1)[0];if(!i)return!1;for(var s=p(i,a),u=0;u<s.length;++u){var l=i[s[u]];if(Array.isArray(l)){var c=l.indexOf(e);if(c<0)continue;if("LEFT_SIDE"===o&&c>0&&h(l[c-1],a)&&r(l[c-1],n,a))return!0;if("RIGHT_SIDE"===o&&c<l.length-1&&h(l[c+1],a)&&r(l[c+1],n,a))return!0}}return!1}function m(e,r,n,o){if(0===n)return!1;var a=t(r,1)[0];if(!a)return!1;for(var i=p(a,o),s=0;s<i.length;++s){var u=a[i[s]];if(Array.isArray(u)){var l=n<0?u.length+n:n-1;if(l>=0&&l<u.length&&u[l]===e)return!0}}return!1}function x(t,n,o,a){if(n){var s=[],u=c(n),l=function t(n,o){if(null==n||"object"!=e(n))return[];null==o&&(o=n);for(var a=n.subject?[o]:[],i=Object.keys(n),s=0;s<i.length;++s){var u=i[s],l=n[u];a.push.apply(a,r(t(l,"left"===u?l:o)))}return a}(n).map(c);i.traverse(t,{enter:function(e,t){if(null!=t&&s.unshift(t),u(e,s,a))if(l.length)for(var r=0,n=l.length;r<n;++r){l[r](e,s,a)&&o(e,t,s);for(var i=0,c=s.length;i<c;++i){var f=s.slice(i+1);l[r](s[i],f,a)&&o(s[i],t,f)}}else o(e,t,s)},leave:function(){s.shift()},keys:a&&a.visitorKeys,fallback:a&&a.fallback||"iteration"})}}function v(e,t,r){var n=[];return x(e,t,(function(e){n.push(e)}),r),n}function g(e){return s.parse(e)}function A(e,t,r){return v(e,g(t),r)}return A.parse=g,A.match=v,A.traverse=x,A.matches=function(e,t,r,n){return!t||!!e&&(r||(r=[]),c(t)(e,r,n))},A.query=A,A}));
./node_modules/.pnpm/estraverse@5.3.0/node_modules/estraverse/estraverse.js:    exports.cloneEnvironment = function () { return clone({}); };
./node_modules/.pnpm/tailwindcss@3.4.17/node_modules/tailwindcss/lib/lib/sharedState.js:    // Environment variables are strings, so convert to boolean
./node_modules/.pnpm/tailwindcss@3.4.17/node_modules/tailwindcss/src/lib/sharedState.js:  // Environment variables are strings, so convert to boolean
./node_modules/.pnpm/tailwindcss@3.4.17/node_modules/tailwindcss/peers/index.js:    module2.exports = { A: { A: { "2": "K D E F A B eC" }, B: { "1": "4 5 6 7 8 9 Q H R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x AB BB CB DB EB FB GB HB I", "2": "C L M G N O P" }, C: { "1": "4 5 6 7 8 9 vB wB xB yB zB 0B 1B 2B 3B 4B 5B 6B 7B 8B Q H R JC S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x AB BB CB DB EB FB GB HB I 9B KC LC gC hC", "2": "0 1 2 3 fC GC J IB K D E F A B C L M G N O P JB y z KB LB MB NB OB PB QB RB SB TB UB VB WB XB YB ZB aB bB cB dB eB fB gB hB iB jB kB lB mB nB oB pB qB HC rB IC sB tB uB iC jC" }, D: { "1": "4 5 6 7 8 9 zB 0B 1B 2B 3B 4B 5B 6B 7B 8B Q H R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x AB BB CB DB EB FB GB HB I 9B KC LC", "2": "0 1 2 3 J IB K D E F A B C L M G N O P JB y z KB LB MB NB OB PB QB RB SB TB UB VB WB XB YB ZB aB bB cB dB eB fB gB hB iB jB kB lB mB nB oB pB qB HC rB IC sB tB uB vB wB xB yB" }, E: { "1": "C L M G AC BC pC qC rC OC PC CC sC DC QC RC SC TC UC tC EC VC WC XC YC ZC aC FC bC uC", "2": "J IB K D E F A kC MC lC mC nC oC NC", "132": "B" }, F: { "1": "oB pB qB rB sB tB uB vB wB xB yB zB 0B 1B 2B 3B 4B 5B 6B 7B 8B Q H R JC S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x", "2": "0 1 2 3 F B C G N O P JB y z KB LB MB NB OB PB QB RB SB TB UB VB WB XB YB ZB aB bB cB dB eB fB gB hB iB jB kB lB mB nB vC wC xC yC AC cC zC BC" }, G: { "1": "AD BD CD DD ED FD GD HD ID JD OC PC CC KD DC QC RC SC TC UC LD EC VC WC XC YC ZC aC FC bC", "2": "E MC 0C dC 1C 2C 3C 4C 5C 6C 7C 8C", "132": "9C" }, H: { "2": "MD" }, I: { "1": "I", "2": "GC J ND OD PD QD dC RD SD" }, J: { "2": "D A" }, K: { "1": "H", "2": "A B C AC cC BC" }, L: { "1": "I" }, M: { "1": "9B" }, N: { "2": "A B" }, O: { "1": "CC" }, P: { "1": "0 1 2 3 y z NC YD ZD aD bD cD DC EC FC dD", "2": "J TD UD VD WD XD" }, Q: { "1": "eD" }, R: { "1": "fD" }, S: { "1": "hD", "2": "gD" } }, B: 7, C: "CSS Environment Variables env()", D: true };
./node_modules/.pnpm/jiti@1.21.7/node_modules/jiti/dist/babel.js:  `}},"./node_modules/.pnpm/@babel+preset-typescript@7.26.0_@babel+core@7.26.0/node_modules/@babel/preset-typescript/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var helperPluginUtils=__webpack_require__("./node_modules/.pnpm/@babel+helper-plugin-utils@7.25.9/node_modules/@babel/helper-plugin-utils/lib/index.js"),transformTypeScript=__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-typescript@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-typescript/lib/index.js");__webpack_require__("./node_modules/.pnpm/@babel+plugin-syntax-jsx@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-syntax-jsx/lib/index.js");var transformModulesCommonJS=__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-modules-commonjs@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-modules-commonjs/lib/index.js"),helperValidatorOption=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-option@7.25.9/node_modules/@babel/helper-validator-option/lib/index.js");function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var transformTypeScript__default=_interopDefault(transformTypeScript),transformModulesCommonJS__default=_interopDefault(transformModulesCommonJS);const v=new helperValidatorOption.OptionValidator("@babel/preset-typescript");var pluginRewriteTSImports=helperPluginUtils.declare((function({types:t,template}){function maybeReplace(source,path){source&&(t.isStringLiteral(source)?/[\\/]/.test(source.value)&&(source.value=source.value.replace(/(\.[mc]?)ts$/,"$1js").replace(/\.tsx$/,".js")):path.replaceWith(template.expression.ast`(${source} + "").replace(/([\\/].*\.[mc]?)tsx?$/, "$1js")`))}return{name:"preset-typescript/plugin-rewrite-ts-imports",visitor:{"ImportDeclaration|ExportAllDeclaration|ExportNamedDeclaration"(path){const node=path.node;"value"===(t.isImportDeclaration(node)?node.importKind:node.exportKind)&&maybeReplace(node.source,path.get("source"))},CallExpression(path){t.isImport(path.node.callee)&&maybeReplace(path.node.arguments[0],path.get("arguments.0"))},ImportExpression(path){maybeReplace(path.node.source,path.get("source"))}}}})),index=helperPluginUtils.declarePreset(((api,opts)=>{api.assertVersion(7);const{allExtensions,ignoreExtensions,allowNamespaces,disallowAmbiguousJSXLike,isTSX,jsxPragma,jsxPragmaFrag,onlyRemoveTypeImports,optimizeConstEnums,rewriteImportExtensions}=function(options={}){let{allowNamespaces=!0,jsxPragma,onlyRemoveTypeImports}=options;const TopLevelOptions_ignoreExtensions="ignoreExtensions",TopLevelOptions_disallowAmbiguousJSXLike="disallowAmbiguousJSXLike",TopLevelOptions_jsxPragmaFrag="jsxPragmaFrag",TopLevelOptions_optimizeConstEnums="optimizeConstEnums",TopLevelOptions_rewriteImportExtensions="rewriteImportExtensions",TopLevelOptions_allExtensions="allExtensions",TopLevelOptions_isTSX="isTSX",jsxPragmaFrag=v.validateStringOption(TopLevelOptions_jsxPragmaFrag,options.jsxPragmaFrag,"React.Fragment");var allExtensions=v.validateBooleanOption(TopLevelOptions_allExtensions,options.allExtensions,!1),isTSX=v.validateBooleanOption(TopLevelOptions_isTSX,options.isTSX,!1);isTSX&&v.invariant(allExtensions,"isTSX:true requires allExtensions:true");const ignoreExtensions=v.validateBooleanOption(TopLevelOptions_ignoreExtensions,options.ignoreExtensions,!1),disallowAmbiguousJSXLike=v.validateBooleanOption(TopLevelOptions_disallowAmbiguousJSXLike,options.disallowAmbiguousJSXLike,!1);disallowAmbiguousJSXLike&&v.invariant(allExtensions,"disallowAmbiguousJSXLike:true requires allExtensions:true");const normalized={ignoreExtensions,allowNamespaces,disallowAmbiguousJSXLike,jsxPragma,jsxPragmaFrag,onlyRemoveTypeImports,optimizeConstEnums:v.validateBooleanOption(TopLevelOptions_optimizeConstEnums,options.optimizeConstEnums,!1),rewriteImportExtensions:v.validateBooleanOption(TopLevelOptions_rewriteImportExtensions,options.rewriteImportExtensions,!1)};return normalized.allExtensions=allExtensions,normalized.isTSX=isTSX,normalized}(opts),pluginOptions=disallowAmbiguousJSXLike=>({allowDeclareFields:opts.allowDeclareFields,allowNamespaces,disallowAmbiguousJSXLike,jsxPragma,jsxPragmaFrag,onlyRemoveTypeImports,optimizeConstEnums}),getPlugins=(isTSX,disallowAmbiguousJSXLike)=>[[transformTypeScript__default.default,Object.assign({isTSX},pluginOptions(disallowAmbiguousJSXLike))]];return{plugins:rewriteImportExtensions?[pluginRewriteTSImports]:[],overrides:allExtensions||ignoreExtensions?[{plugins:getPlugins(isTSX,disallowAmbiguousJSXLike)}]:[{test:/\.ts$/,plugins:getPlugins(!1,!1)},{test:/\.mts$/,sourceType:"module",plugins:getPlugins(!1,!0)},{test:/\.cts$/,sourceType:"unambiguous",plugins:[[transformModulesCommonJS__default.default,{allowTopLevelThis:!0}],[transformTypeScript__default.default,pluginOptions(!0)]]},{test:/\.tsx$/,plugins:getPlugins(!0,!1)}]}}));exports.default=index},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/builder.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function createTemplateBuilder(formatter,defaultOpts){const templateFnCache=new WeakMap,templateAstCache=new WeakMap,cachedOpts=defaultOpts||(0,_options.validate)(null);return Object.assign(((tpl,...args)=>{if("string"==typeof tpl){if(args.length>1)throw new Error("Unexpected extra params.");return extendedTrace((0,_string.default)(formatter,tpl,(0,_options.merge)(cachedOpts,(0,_options.validate)(args[0]))))}if(Array.isArray(tpl)){let builder=templateFnCache.get(tpl);return builder||(builder=(0,_literal.default)(formatter,tpl,cachedOpts),templateFnCache.set(tpl,builder)),extendedTrace(builder(args))}if("object"==typeof tpl&&tpl){if(args.length>0)throw new Error("Unexpected extra params.");return createTemplateBuilder(formatter,(0,_options.merge)(cachedOpts,(0,_options.validate)(tpl)))}throw new Error("Unexpected template param "+typeof tpl)}),{ast:(tpl,...args)=>{if("string"==typeof tpl){if(args.length>1)throw new Error("Unexpected extra params.");return(0,_string.default)(formatter,tpl,(0,_options.merge)((0,_options.merge)(cachedOpts,(0,_options.validate)(args[0])),NO_PLACEHOLDER))()}if(Array.isArray(tpl)){let builder=templateAstCache.get(tpl);return builder||(builder=(0,_literal.default)(formatter,tpl,(0,_options.merge)(cachedOpts,NO_PLACEHOLDER)),templateAstCache.set(tpl,builder)),builder(args)()}throw new Error("Unexpected template param "+typeof tpl)}})};var _options=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js"),_string=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/string.js"),_literal=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/literal.js");const NO_PLACEHOLDER=(0,_options.validate)({placeholderPattern:!1});function extendedTrace(fn){let rootStack="";try{throw new Error}catch(error){error.stack&&(rootStack=error.stack.split("\n").slice(3).join("\n"))}return arg=>{try{return fn(arg)}catch(err){throw err.stack+=`\n    =============\n${rootStack}`,err}}}},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/formatters.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.statements=exports.statement=exports.smart=exports.program=exports.expression=void 0;var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{assertExpressionStatement}=_t;function makeStatementFormatter(fn){return{code:str=>`/* @babel/template */;\n${str}`,validate:()=>{},unwrap:ast=>fn(ast.program.body.slice(1))}}exports.smart=makeStatementFormatter((body=>body.length>1?body:body[0])),exports.statements=makeStatementFormatter((body=>body)),exports.statement=makeStatementFormatter((body=>{if(0===body.length)throw new Error("Found nothing to return.");if(body.length>1)throw new Error("Found multiple statements but wanted one");return body[0]}));const expression=exports.expression={code:str=>`(\n${str}\n)`,validate:ast=>{if(ast.program.body.length>1)throw new Error("Found multiple statements but wanted one");if(0===expression.unwrap(ast).start)throw new Error("Parse result included parens.")},unwrap:({program})=>{const[stmt]=program.body;return assertExpressionStatement(stmt),stmt.expression}};exports.program={code:str=>str,validate:()=>{},unwrap:ast=>ast.program}},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.statements=exports.statement=exports.smart=exports.program=exports.expression=exports.default=void 0;var formatters=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/formatters.js"),_builder=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/builder.js");const smart=exports.smart=(0,_builder.default)(formatters.smart),statement=exports.statement=(0,_builder.default)(formatters.statement),statements=exports.statements=(0,_builder.default)(formatters.statements),expression=exports.expression=(0,_builder.default)(formatters.expression),program=exports.program=(0,_builder.default)(formatters.program);exports.default=Object.assign(smart.bind(void 0),{smart,statement,statements,expression,program,ast:smart.ast})},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/literal.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(formatter,tpl,opts){const{metadata,names}=function(formatter,tpl,opts){let prefix="BABEL_TPL$";const raw=tpl.join("");do{prefix="$$"+prefix}while(raw.includes(prefix));const{names,code}=function(tpl,prefix){const names=[];let code=tpl[0];for(let i=1;i<tpl.length;i++){const value=`${prefix}${i-1}`;names.push(value),code+=value+tpl[i]}return{names,code}}(tpl,prefix),metadata=(0,_parse.default)(formatter,formatter.code(code),{parser:opts.parser,placeholderWhitelist:new Set(names.concat(opts.placeholderWhitelist?Array.from(opts.placeholderWhitelist):[])),placeholderPattern:opts.placeholderPattern,preserveComments:opts.preserveComments,syntacticPlaceholders:opts.syntacticPlaceholders});return{metadata,names}}(formatter,tpl,opts);return arg=>{const defaultReplacements={};return arg.forEach(((replacement,i)=>{defaultReplacements[names[i]]=replacement})),arg=>{const replacements=(0,_options.normalizeReplacements)(arg);return replacements&&Object.keys(replacements).forEach((key=>{if(hasOwnProperty.call(defaultReplacements,key))throw new Error("Unexpected replacement overlap.")})),formatter.unwrap((0,_populate.default)(metadata,replacements?Object.assign(replacements,defaultReplacements):defaultReplacements))}}};var _options=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js"),_parse=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/parse.js"),_populate=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/populate.js")},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.merge=function(a,b){const{placeholderWhitelist=a.placeholderWhitelist,placeholderPattern=a.placeholderPattern,preserveComments=a.preserveComments,syntacticPlaceholders=a.syntacticPlaceholders}=b;return{parser:Object.assign({},a.parser,b.parser),placeholderWhitelist,placeholderPattern,preserveComments,syntacticPlaceholders}},exports.normalizeReplacements=function(replacements){if(Array.isArray(replacements))return replacements.reduce(((acc,replacement,i)=>(acc["$"+i]=replacement,acc)),{});if("object"==typeof replacements||null==replacements)return replacements||void 0;throw new Error("Template replacements must be an array, object, null, or undefined")},exports.validate=function(opts){if(null!=opts&&"object"!=typeof opts)throw new Error("Unknown template options.");const _ref=opts||{},{placeholderWhitelist,placeholderPattern,preserveComments,syntacticPlaceholders}=_ref,parser=function(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}(_ref,_excluded);if(null!=placeholderWhitelist&&!(placeholderWhitelist instanceof Set))throw new Error("'.placeholderWhitelist' must be a Set, null, or undefined");if(null!=placeholderPattern&&!(placeholderPattern instanceof RegExp)&&!1!==placeholderPattern)throw new Error("'.placeholderPattern' must be a RegExp, false, null, or undefined");if(null!=preserveComments&&"boolean"!=typeof preserveComments)throw new Error("'.preserveComments' must be a boolean, null, or undefined");if(null!=syntacticPlaceholders&&"boolean"!=typeof syntacticPlaceholders)throw new Error("'.syntacticPlaceholders' must be a boolean, null, or undefined");if(!0===syntacticPlaceholders&&(null!=placeholderWhitelist||null!=placeholderPattern))throw new Error("'.placeholderWhitelist' and '.placeholderPattern' aren't compatible with '.syntacticPlaceholders: true'");return{parser,placeholderWhitelist:placeholderWhitelist||void 0,placeholderPattern:null==placeholderPattern?void 0:placeholderPattern,preserveComments:null==preserveComments?void 0:preserveComments,syntacticPlaceholders:null==syntacticPlaceholders?void 0:syntacticPlaceholders}};const _excluded=["placeholderWhitelist","placeholderPattern","preserveComments","syntacticPlaceholders"]},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/parse.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(formatter,code,opts){const{placeholderWhitelist,placeholderPattern,preserveComments,syntacticPlaceholders}=opts,ast=function(code,parserOpts,syntacticPlaceholders){const plugins=(parserOpts.plugins||[]).slice();!1!==syntacticPlaceholders&&plugins.push("placeholders");parserOpts=Object.assign({allowReturnOutsideFunction:!0,allowSuperOutsideMethod:!0,sourceType:"module"},parserOpts,{plugins});try{return(0,_parser.parse)(code,parserOpts)}catch(err){const loc=err.loc;throw loc&&(err.message+="\n"+(0,_codeFrame.codeFrameColumns)(code,{start:loc}),err.code="BABEL_TEMPLATE_PARSE_ERROR"),err}}(code,opts.parser,syntacticPlaceholders);removePropertiesDeep(ast,{preserveComments}),formatter.validate(ast);const state={syntactic:{placeholders:[],placeholderNames:new Set},legacy:{placeholders:[],placeholderNames:new Set},placeholderWhitelist,placeholderPattern,syntacticPlaceholders};return traverse(ast,placeholderVisitorHandler,state),Object.assign({ast},state.syntactic.placeholders.length?state.syntactic:state.legacy)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_parser=__webpack_require__("./node_modules/.pnpm/@babel+parser@7.26.3/node_modules/@babel/parser/lib/index.js"),_codeFrame=__webpack_require__("./stubs/babel-codeframe.js");const{isCallExpression,isExpressionStatement,isFunction,isIdentifier,isJSXIdentifier,isNewExpression,isPlaceholder,isStatement,isStringLiteral,removePropertiesDeep,traverse}=_t,PATTERN=/^[_$A-Z0-9]+$/;function placeholderVisitorHandler(node,ancestors,state){var _state$placeholderWhi;let name,hasSyntacticPlaceholders=state.syntactic.placeholders.length>0;if(isPlaceholder(node)){if(!1===state.syntacticPlaceholders)throw new Error("%%foo%%-style placeholders can't be used when '.syntacticPlaceholders' is false.");name=node.name.name,hasSyntacticPlaceholders=!0}else{if(hasSyntacticPlaceholders||state.syntacticPlaceholders)return;if(isIdentifier(node)||isJSXIdentifier(node))name=node.name;else{if(!isStringLiteral(node))return;name=node.value}}if(hasSyntacticPlaceholders&&(null!=state.placeholderPattern||null!=state.placeholderWhitelist))throw new Error("'.placeholderWhitelist' and '.placeholderPattern' aren't compatible with '.syntacticPlaceholders: true'");if(!(hasSyntacticPlaceholders||!1!==state.placeholderPattern&&(state.placeholderPattern||PATTERN).test(name)||null!=(_state$placeholderWhi=state.placeholderWhitelist)&&_state$placeholderWhi.has(name)))return;ancestors=ancestors.slice();const{node:parent,key}=ancestors[ancestors.length-1];let type;isStringLiteral(node)||isPlaceholder(node,{expectedNode:"StringLiteral"})?type="string":isNewExpression(parent)&&"arguments"===key||isCallExpression(parent)&&"arguments"===key||isFunction(parent)&&"params"===key?type="param":isExpressionStatement(parent)&&!isPlaceholder(node)?(type="statement",ancestors=ancestors.slice(0,-1)):type=isStatement(node)&&isPlaceholder(node)?"statement":"other";const{placeholders,placeholderNames}=hasSyntacticPlaceholders?state.syntactic:state.legacy;placeholders.push({name,type,resolve:ast=>function(ast,ancestors){let parent=ast;for(let i=0;i<ancestors.length-1;i++){const{key,index}=ancestors[i];parent=void 0===index?parent[key]:parent[key][index]}const{key,index}=ancestors[ancestors.length-1];return{parent,key,index}}(ast,ancestors),isDuplicate:placeholderNames.has(name)}),placeholderNames.add(name)}},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/populate.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(metadata,replacements){const ast=cloneNode(metadata.ast);replacements&&(metadata.placeholders.forEach((placeholder=>{if(!hasOwnProperty.call(replacements,placeholder.name)){const placeholderName=placeholder.name;throw new Error(`Error: No substitution given for "${placeholderName}". If this is not meant to be a\n            placeholder you may want to consider passing one of the following options to @babel/template:\n            - { placeholderPattern: false, placeholderWhitelist: new Set(['${placeholderName}'])}\n            - { placeholderPattern: /^${placeholderName}$/ }`)}})),Object.keys(replacements).forEach((key=>{if(!metadata.placeholderNames.has(key))throw new Error(`Unknown substitution "${key}" given`)})));return metadata.placeholders.slice().reverse().forEach((placeholder=>{try{!function(placeholder,ast,replacement){placeholder.isDuplicate&&(Array.isArray(replacement)?replacement=replacement.map((node=>cloneNode(node))):"object"==typeof replacement&&(replacement=cloneNode(replacement)));const{parent,key,index}=placeholder.resolve(ast);if("string"===placeholder.type){if("string"==typeof replacement&&(replacement=stringLiteral(replacement)),!replacement||!isStringLiteral(replacement))throw new Error("Expected string substitution")}else if("statement"===placeholder.type)void 0===index?replacement?Array.isArray(replacement)?replacement=blockStatement(replacement):"string"==typeof replacement?replacement=expressionStatement(identifier(replacement)):isStatement(replacement)||(replacement=expressionStatement(replacement)):replacement=emptyStatement():replacement&&!Array.isArray(replacement)&&("string"==typeof replacement&&(replacement=identifier(replacement)),isStatement(replacement)||(replacement=expressionStatement(replacement)));else if("param"===placeholder.type){if("string"==typeof replacement&&(replacement=identifier(replacement)),void 0===index)throw new Error("Assertion failure.")}else if("string"==typeof replacement&&(replacement=identifier(replacement)),Array.isArray(replacement))throw new Error("Cannot replace single expression with an array.");function set(parent,key,value){const node=parent[key];parent[key]=value,"Identifier"!==node.type&&"Placeholder"!==node.type||(node.typeAnnotation&&(value.typeAnnotation=node.typeAnnotation),node.optional&&(value.optional=node.optional),node.decorators&&(value.decorators=node.decorators))}if(void 0===index)validate(parent,key,replacement),set(parent,key,replacement);else{const items=parent[key].slice();"statement"===placeholder.type||"param"===placeholder.type?null==replacement?items.splice(index,1):Array.isArray(replacement)?items.splice(index,1,...replacement):set(items,index,replacement):set(items,index,replacement),validate(parent,key,items),parent[key]=items}}(placeholder,ast,replacements&&replacements[placeholder.name]||null)}catch(e){throw e.message=`@babel/template placeholder "${placeholder.name}": ${e.message}`,e}})),ast};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{blockStatement,cloneNode,emptyStatement,expressionStatement,identifier,isStatement,isStringLiteral,stringLiteral,validate}=_t},"./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/string.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(formatter,code,opts){let metadata;return code=formatter.code(code),arg=>{const replacements=(0,_options.normalizeReplacements)(arg);return metadata||(metadata=(0,_parse.default)(formatter,code,opts)),formatter.unwrap((0,_populate.default)(metadata,replacements))}};var _options=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/options.js"),_parse=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/parse.js"),_populate=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/populate.js")},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clear=function(){clearPath(),clearScope()},exports.clearPath=clearPath,exports.clearScope=clearScope,exports.getCachedPaths=function(hub,parent){var _pathsCache$get;return null==(_pathsCache$get=pathsCache.get(null!=null?null:nullHub))?void 0:_pathsCache$get.get(parent)},exports.getOrCreateCachedPaths=function(hub,parent){0;let parents=pathsCache.get(null!=null?null:nullHub);parents||pathsCache.set(null!=null?null:nullHub,parents=new WeakMap);let paths=parents.get(parent);paths||parents.set(parent,paths=new Map);return paths},exports.scope=exports.path=void 0;let pathsCache=exports.path=new WeakMap,scope=exports.scope=new WeakMap;function clearPath(){exports.path=pathsCache=new WeakMap}function clearScope(){exports.scope=scope=new WeakMap}const nullHub=Object.freeze({})},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/context.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{VISITOR_KEYS}=_t;exports.default=class{constructor(scope,opts,state,parentPath){this.queue=null,this.priorityQueue=null,this.parentPath=parentPath,this.scope=scope,this.state=state,this.opts=opts}shouldVisit(node){const opts=this.opts;if(opts.enter||opts.exit)return!0;if(opts[node.type])return!0;const keys=VISITOR_KEYS[node.type];if(null==keys||!keys.length)return!1;for(const key of keys)if(node[key])return!0;return!1}create(node,container,key,listKey){return _index.default.get({parentPath:this.parentPath,parent:node,container,key,listKey})}maybeQueue(path,notPriority){this.queue&&(notPriority?this.queue.push(path):this.priorityQueue.push(path))}visitMultiple(container,parent,listKey){if(0===container.length)return!1;const queue=[];for(let key=0;key<container.length;key++){const node=container[key];node&&this.shouldVisit(node)&&queue.push(this.create(parent,container,key,listKey))}return this.visitQueue(queue)}visitSingle(node,key){return!!this.shouldVisit(node[key])&&this.visitQueue([this.create(node,node,key)])}visitQueue(queue){this.queue=queue,this.priorityQueue=[];const visited=new WeakSet;let stop=!1,visitIndex=0;for(;visitIndex<queue.length;){const path=queue[visitIndex];if(visitIndex++,_context.resync.call(path),0!==path.contexts.length&&path.contexts[path.contexts.length-1]===this||_context.pushContext.call(path,this),null===path.key)continue;const{node}=path;if(!visited.has(node)){if(node&&visited.add(node),path.visit()){stop=!0;break}if(this.priorityQueue.length&&(stop=this.visitQueue(this.priorityQueue),this.priorityQueue=[],this.queue=queue,stop))break}}for(let i=0;i<visitIndex;i++)_context.popContext.call(queue[i]);return this.queue=null,stop}visit(node,key){const nodes=node[key];return!!nodes&&(Array.isArray(nodes)?this.visitMultiple(nodes,node,key):this.visitSingle(node,key))}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/hub.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;exports.default=class{getCode(){}getScope(){}addHelper(){throw new Error("Helpers are not supported by the default hub.")}buildError(node,msg,Error=TypeError){return new Error(msg)}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Hub",{enumerable:!0,get:function(){return _hub.default}}),Object.defineProperty(exports,"NodePath",{enumerable:!0,get:function(){return _index.default}}),Object.defineProperty(exports,"Scope",{enumerable:!0,get:function(){return _index2.default}}),exports.visitors=exports.default=void 0,__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");var visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js");exports.visitors=visitors;var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_traverseNode=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/index.js"),_hub=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/hub.js");const{VISITOR_KEYS,removeProperties,traverseFast}=_t;function traverse(parent,opts={},scope,state,parentPath,visitSelf){if(parent){if(!opts.noScope&&!scope&&"Program"!==parent.type&&"File"!==parent.type)throw new Error(`You must pass a scope and parentPath unless traversing a Program/File. Instead of that you tried to traverse a ${parent.type} node without passing scope and parentPath.`);if(!parentPath&&visitSelf)throw new Error("visitSelf can only be used when providing a NodePath.");VISITOR_KEYS[parent.type]&&(visitors.explode(opts),(0,_traverseNode.traverseNode)(parent,opts,scope,state,parentPath,null,visitSelf))}}exports.default=traverse;function hasDenylistedType(path,state){path.node.type===state.type&&(state.has=!0,path.stop())}traverse.visitors=visitors,traverse.verify=visitors.verify,traverse.explode=visitors.explode,traverse.cheap=function(node,enter){traverseFast(node,enter)},traverse.node=function(node,opts,scope,state,path,skipKeys){(0,_traverseNode.traverseNode)(node,opts,scope,state,path,skipKeys)},traverse.clearNode=function(node,opts){removeProperties(node,opts)},traverse.removeProperties=function(tree,opts){return traverseFast(tree,traverse.clearNode,opts),tree},traverse.hasType=function(tree,type,denylistTypes){if(null!=denylistTypes&&denylistTypes.includes(tree.type))return!1;if(tree.type===type)return!0;const state={has:!1,type};return traverse(tree,{noScope:!0,denylist:denylistTypes,enter:hasDenylistedType},null,state),state.has},traverse.cache=cache},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/ancestry.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.find=function(callback){let path=this;do{if(callback(path))return path}while(path=path.parentPath);return null},exports.findParent=function(callback){let path=this;for(;path=path.parentPath;)if(callback(path))return path;return null},exports.getAncestry=function(){let path=this;const paths=[];do{paths.push(path)}while(path=path.parentPath);return paths},exports.getDeepestCommonAncestorFrom=function(paths,filter){if(!paths.length)return this;if(1===paths.length)return paths[0];let lastCommonIndex,lastCommon,minDepth=1/0;const ancestries=paths.map((path=>{const ancestry=[];do{ancestry.unshift(path)}while((path=path.parentPath)&&path!==this);return ancestry.length<minDepth&&(minDepth=ancestry.length),ancestry})),first=ancestries[0];depthLoop:for(let i=0;i<minDepth;i++){const shouldMatch=first[i];for(const ancestry of ancestries)if(ancestry[i]!==shouldMatch)break depthLoop;lastCommonIndex=i,lastCommon=shouldMatch}if(lastCommon)return filter?filter(lastCommon,lastCommonIndex,ancestries):lastCommon;throw new Error("Couldn't find intersection")},exports.getEarliestCommonAncestorFrom=function(paths){return this.getDeepestCommonAncestorFrom(paths,(function(deepest,i,ancestries){let earliest;const keys=VISITOR_KEYS[deepest.type];for(const ancestry of ancestries){const path=ancestry[i+1];if(!earliest){earliest=path;continue}if(path.listKey&&earliest.listKey===path.listKey&&path.key<earliest.key){earliest=path;continue}keys.indexOf(earliest.parentKey)>keys.indexOf(path.parentKey)&&(earliest=path)}return earliest}))},exports.getFunctionParent=function(){return this.findParent((p=>p.isFunction()))},exports.getStatementParent=function(){let path=this;do{if(!path.parentPath||Array.isArray(path.container)&&path.isStatement())break;path=path.parentPath}while(path);if(path&&(path.isProgram()||path.isFile()))throw new Error("File/Program node, we can't possibly find a statement parent to this");return path},exports.inType=function(...candidateTypes){let path=this;for(;path;){for(const type of candidateTypes)if(path.node.type===type)return!0;path=path.parentPath}return!1},exports.isAncestor=function(maybeDescendant){return maybeDescendant.isDescendant(this)},exports.isDescendant=function(maybeAncestor){return!!this.findParent((parent=>parent===maybeAncestor))};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{VISITOR_KEYS}=_t},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/comments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addComment=function(type,content,line){_addComment(this.node,type,content,line)},exports.addComments=function(type,comments){_addComments(this.node,type,comments)},exports.shareCommentsWithSiblings=function(){if("string"==typeof this.key)return;const node=this.node;if(!node)return;const trailing=node.trailingComments,leading=node.leadingComments;if(!trailing&&!leading)return;const prev=this.getSibling(this.key-1),next=this.getSibling(this.key+1),hasPrev=Boolean(prev.node),hasNext=Boolean(next.node);hasPrev&&(leading&&prev.addComments("trailing",removeIfExisting(leading,prev.node.trailingComments)),trailing&&!hasNext&&prev.addComments("trailing",trailing));hasNext&&(trailing&&next.addComments("leading",removeIfExisting(trailing,next.node.leadingComments)),leading&&!hasPrev&&next.addComments("leading",leading))};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{addComment:_addComment,addComments:_addComments}=_t;function removeIfExisting(list,toRemove){if(null==toRemove||!toRemove.length)return list;const set=new Set(toRemove);return list.filter((el=>!set.has(el)))}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._call=_call,exports._getQueueContexts=function(){let path=this,contexts=this.contexts;for(;!contexts.length&&(path=path.parentPath,path);)contexts=path.contexts;return contexts},exports._resyncKey=_resyncKey,exports._resyncList=_resyncList,exports._resyncParent=_resyncParent,exports._resyncRemoved=function(){null!=this.key&&this.container&&this.container[this.key]===this.node||_removal._markRemoved.call(this)},exports.call=call,exports.isDenylisted=isDenylisted,exports.popContext=function(){this.contexts.pop(),this.contexts.length>0?this.setContext(this.contexts[this.contexts.length-1]):this.setContext(void 0)},exports.pushContext=function(context){this.contexts.push(context),this.setContext(context)},exports.requeue=function(pathToQueue=this){if(pathToQueue.removed)return;const contexts=this.contexts;for(const context of contexts)context.maybeQueue(pathToQueue)},exports.requeueComputedKeyAndDecorators=function(){const{context,node}=this;!t.isPrivate(node)&&node.computed&&context.maybeQueue(this.get("key"));if(node.decorators)for(const decorator of this.get("decorators"))context.maybeQueue(decorator)},exports.resync=function(){if(this.removed)return;_resyncParent.call(this),_resyncList.call(this),_resyncKey.call(this)},exports.setContext=function(context){null!=this.skipKeys&&(this.skipKeys={});this._traverseFlags=0,context&&(this.context=context,this.state=context.state,this.opts=context.opts);return setScope.call(this),this},exports.setKey=setKey,exports.setScope=setScope,exports.setup=function(parentPath,container,listKey,key){this.listKey=listKey,this.container=container,this.parentPath=parentPath||this.parentPath,setKey.call(this,key)},exports.skip=function(){this.shouldSkip=!0},exports.skipKey=function(key){null==this.skipKeys&&(this.skipKeys={});this.skipKeys[key]=!0},exports.stop=function(){this._traverseFlags|=_index.SHOULD_SKIP|_index.SHOULD_STOP},exports.visit=function(){var _this$opts$shouldSkip,_this$opts;if(!this.node)return!1;if(this.isDenylisted())return!1;if(null!=(_this$opts$shouldSkip=(_this$opts=this.opts).shouldSkip)&&_this$opts$shouldSkip.call(_this$opts,this))return!1;const currentContext=this.context;if(this.shouldSkip||call.call(this,"enter"))return this.debug("Skip..."),this.shouldStop;return restoreContext(this,currentContext),this.debug("Recursing into..."),this.shouldStop=(0,_traverseNode.traverseNode)(this.node,this.opts,this.scope,this.state,this,this.skipKeys),restoreContext(this,currentContext),call.call(this,"exit"),this.shouldStop};var _traverseNode=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_removal=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js"),t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");function call(key){const opts=this.opts;return this.debug(key),!(!this.node||!_call.call(this,opts[key]))||!!this.node&&_call.call(this,null==(_opts$this$node$type=opts[this.node.type])?void 0:_opts$this$node$type[key]);var _opts$this$node$type}function _call(fns){if(!fns)return!1;for(const fn of fns){if(!fn)continue;const node=this.node;if(!node)return!0;const ret=fn.call(this.state,this,this.state);if(ret&&"object"==typeof ret&&"function"==typeof ret.then)throw new Error("You appear to be using a plugin with an async traversal visitor, which your current version of Babel does not support. If you're using a published plugin, you may need to upgrade your @babel/core version.");if(ret)throw new Error(`Unexpected return value from visitor method ${fn}`);if(this.node!==node)return!0;if(this._traverseFlags>0)return!0}return!1}function isDenylisted(){var _this$opts$denylist;const denylist=null!=(_this$opts$denylist=this.opts.denylist)?_this$opts$denylist:this.opts.blacklist;return null==denylist?void 0:denylist.includes(this.node.type)}function restoreContext(path,context){path.context!==context&&(path.context=context,path.state=context.state,path.opts=context.opts)}function setScope(){var _this$opts2,_this$scope;if(null!=(_this$opts2=this.opts)&&_this$opts2.noScope)return;let target,path=this.parentPath;for((("key"===this.key||"decorators"===this.listKey)&&path.isMethod()||"discriminant"===this.key&&path.isSwitchStatement())&&(path=path.parentPath);path&&!target;){var _path$opts;if(null!=(_path$opts=path.opts)&&_path$opts.noScope)return;target=path.scope,path=path.parentPath}this.scope=this.getScope(target),null==(_this$scope=this.scope)||_this$scope.init()}function _resyncParent(){this.parentPath&&(this.parent=this.parentPath.node)}function _resyncKey(){if(this.container&&this.node!==this.container[this.key]){if(Array.isArray(this.container)){for(let i=0;i<this.container.length;i++)if(this.container[i]===this.node)return void setKey.call(this,i)}else for(const key of Object.keys(this.container))if(this.container[key]===this.node)return void setKey.call(this,key);this.key=null}}function _resyncList(){if(!this.parent||!this.inList)return;const newContainer=this.parent[this.listKey];this.container!==newContainer&&(this.container=newContainer||null)}function setKey(key){var _this$node;this.key=key,this.node=this.container[this.key],this.type=null==(_this$node=this.node)?void 0:_this$node.type}exports.isBlacklisted=isDenylisted},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/conversion.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.arrowFunctionToExpression=function({allowInsertArrow=!0,allowInsertArrowWithRest=allowInsertArrow,noNewArrows=!(_arguments$=>null==(_arguments$=arguments[0])?void 0:_arguments$.specCompliant)()}={}){if(!this.isArrowFunctionExpression())throw this.buildCodeFrameError("Cannot convert non-arrow function to a function expression.");let self=this;var _self$ensureFunctionN;noNewArrows||(self=null!=(_self$ensureFunctionN=self.ensureFunctionName(!1))?_self$ensureFunctionN:self);const{thisBinding,fnPath:fn}=hoistFunctionEnvironment(self,noNewArrows,allowInsertArrow,allowInsertArrowWithRest);if(fn.ensureBlock(),function(path,type){path.node.type=type}(fn,"FunctionExpression"),!noNewArrows){const checkBinding=thisBinding?null:fn.scope.generateUidIdentifier("arrowCheckId");return checkBinding&&fn.parentPath.scope.push({id:checkBinding,init:objectExpression([])}),fn.get("body").unshiftContainer("body",expressionStatement(callExpression(this.hub.addHelper("newArrowCheck"),[thisExpression(),identifier(checkBinding?checkBinding.name:thisBinding)]))),fn.replaceWith(callExpression(memberExpression(fn.node,identifier("bind")),[checkBinding?identifier(checkBinding.name):thisExpression()])),fn.get("callee.object")}return fn},exports.ensureBlock=function(){const body=this.get("body"),bodyNode=body.node;if(Array.isArray(body))throw new Error("Can't convert array path to a block statement");if(!bodyNode)throw new Error("Can't convert node without a body");if(body.isBlockStatement())return bodyNode;const statements=[];let key,listKey,stringPath="body";body.isStatement()?(listKey="body",key=0,statements.push(body.node)):(stringPath+=".body.0",this.isFunction()?(key="argument",statements.push(returnStatement(body.node))):(key="expression",statements.push(expressionStatement(body.node))));this.node.body=blockStatement(statements);const parentPath=this.get(stringPath);return _context.setup.call(body,parentPath,listKey?parentPath.node[listKey]:parentPath.node,listKey,key),this.node},exports.ensureFunctionName=function(supportUnicodeId){if(this.node.id)return this;const res=getFunctionName(this.node,this.parent);if(null==res)return this;let{name}=res;if(!supportUnicodeId&&/[\uD800-\uDFFF]/.test(name))return null;if(name.startsWith("get ")||name.startsWith("set "))return null;name=toBindingIdentifierName(name.replace(/[/ ]/g,"_"));const id=identifier(name);inherits(id,res.originalNode);const state={needsRename:!1,name},{scope}=this,binding=scope.getOwnBinding(name);binding?"param"===binding.kind&&(state.needsRename=!0):(scope.parent.hasBinding(name)||scope.hasGlobal(name))&&this.traverse(refersOuterBindingVisitor,state);if(!state.needsRename)return this.node.id=id,scope.getProgramParent().references[id.name]=!0,this;if(scope.hasBinding(id.name)&&!scope.hasGlobal(id.name))return scope.rename(id.name),this.node.id=id,scope.getProgramParent().references[id.name]=!0,this;if(!isFunction(this.node))return null;const key=scope.generateUidIdentifier(id.name),params=[];for(let i=0,len=function(node){const count=node.params.findIndex((param=>isAssignmentPattern(param)||isRestElement(param)));return-1===count?node.params.length:count}(this.node);i<len;i++)params.push(scope.generateUidIdentifier("x"));const call=_template.default.expression.ast`
./node_modules/.pnpm/jiti@1.21.7/node_modules/jiti/dist/babel.js:  `;return this.replaceWith(call)[0].get("arguments.0")},exports.splitExportDeclaration=function(){if(!this.isExportDeclaration()||this.isExportAllDeclaration())throw new Error("Only default and named export declarations can be split.");if(this.isExportNamedDeclaration()&&this.get("specifiers").length>0)throw new Error("It doesn't make sense to split exported specifiers.");const declaration=this.get("declaration");if(this.isExportDefaultDeclaration()){const standaloneDeclaration=declaration.isFunctionDeclaration()||declaration.isClassDeclaration(),exportExpr=declaration.isFunctionExpression()||declaration.isClassExpression(),scope=declaration.isScope()?declaration.scope.parent:declaration.scope;let id=declaration.node.id,needBindingRegistration=!1;id?exportExpr&&scope.hasBinding(id.name)&&(needBindingRegistration=!0,id=scope.generateUidIdentifier(id.name)):(needBindingRegistration=!0,id=scope.generateUidIdentifier("default"),(standaloneDeclaration||exportExpr)&&(declaration.node.id=cloneNode(id)));const updatedDeclaration=standaloneDeclaration?declaration.node:variableDeclaration("var",[variableDeclarator(cloneNode(id),declaration.node)]),updatedExportDeclaration=exportNamedDeclaration(null,[exportSpecifier(cloneNode(id),identifier("default"))]);return this.insertAfter(updatedExportDeclaration),this.replaceWith(updatedDeclaration),needBindingRegistration&&scope.registerDeclaration(this),this}if(this.get("specifiers").length>0)throw new Error("It doesn't make sense to split exported specifiers.");const bindingIdentifiers=declaration.getOuterBindingIdentifiers(),specifiers=Object.keys(bindingIdentifiers).map((name=>exportSpecifier(identifier(name),identifier(name)))),aliasDeclar=exportNamedDeclaration(null,specifiers);return this.insertAfter(aliasDeclar),this.replaceWith(declaration.node),this},exports.toComputedKey=function(){let key;if(this.isMemberExpression())key=this.node.property;else{if(!this.isProperty()&&!this.isMethod())throw new ReferenceError("todo");key=this.node.key}this.node.computed||isIdentifier(key)&&(key=stringLiteral(key.name));return key},exports.unwrapFunctionEnvironment=function(){if(!this.isArrowFunctionExpression()&&!this.isFunctionExpression()&&!this.isFunctionDeclaration())throw this.buildCodeFrameError("Can only unwrap the environment of a function.");hoistFunctionEnvironment(this)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_template=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/index.js"),_visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{arrowFunctionExpression,assignmentExpression,binaryExpression,blockStatement,callExpression,conditionalExpression,expressionStatement,identifier,isIdentifier,jsxIdentifier,logicalExpression,LOGICAL_OPERATORS,memberExpression,metaProperty,numericLiteral,objectExpression,restElement,returnStatement,sequenceExpression,spreadElement,stringLiteral,super:_super,thisExpression,toExpression,unaryExpression,toBindingIdentifierName,isFunction,isAssignmentPattern,isRestElement,getFunctionName,cloneNode,variableDeclaration,variableDeclarator,exportNamedDeclaration,exportSpecifier,inherits}=_t;exports.arrowFunctionToShadowed=function(){this.isArrowFunctionExpression()&&this.arrowFunctionToExpression()};const getSuperCallsVisitor=(0,_visitors.environmentVisitor)({CallExpression(child,{allSuperCalls}){child.get("callee").isSuper()&&allSuperCalls.push(child)}});function hoistFunctionEnvironment(fnPath,noNewArrows=!0,allowInsertArrow=!0,allowInsertArrowWithRest=!0){let arrowParent,thisEnvFn=fnPath.findParent((p=>p.isArrowFunctionExpression()?(null!=arrowParent||(arrowParent=p),!1):p.isFunction()||p.isProgram()||p.isClassProperty({static:!1})||p.isClassPrivateProperty({static:!1})));const inConstructor=thisEnvFn.isClassMethod({kind:"constructor"});if(thisEnvFn.isClassProperty()||thisEnvFn.isClassPrivateProperty())if(arrowParent)thisEnvFn=arrowParent;else{if(!allowInsertArrow)throw fnPath.buildCodeFrameError("Unable to transform arrow inside class property");fnPath.replaceWith(callExpression(arrowFunctionExpression([],toExpression(fnPath.node)),[])),thisEnvFn=fnPath.get("callee"),fnPath=thisEnvFn.get("body")}const{thisPaths,argumentsPaths,newTargetPaths,superProps,superCalls}=function(fnPath){const thisPaths=[],argumentsPaths=[],newTargetPaths=[],superProps=[],superCalls=[];return fnPath.traverse(getScopeInformationVisitor,{thisPaths,argumentsPaths,newTargetPaths,superProps,superCalls}),{thisPaths,argumentsPaths,newTargetPaths,superProps,superCalls}}(fnPath);if(inConstructor&&superCalls.length>0){if(!allowInsertArrow)throw superCalls[0].buildCodeFrameError("When using '@babel/plugin-transform-arrow-functions', it's not possible to compile `super()` in an arrow function without compiling classes.\nPlease add '@babel/plugin-transform-classes' to your Babel configuration.");if(!allowInsertArrowWithRest)throw superCalls[0].buildCodeFrameError("When using '@babel/plugin-transform-parameters', it's not possible to compile `super()` in an arrow function with default or rest parameters without compiling classes.\nPlease add '@babel/plugin-transform-classes' to your Babel configuration.");const allSuperCalls=[];thisEnvFn.traverse(getSuperCallsVisitor,{allSuperCalls});const superBinding=function(thisEnvFn){return getBinding(thisEnvFn,"supercall",(()=>{const argsBinding=thisEnvFn.scope.generateUidIdentifier("args");return arrowFunctionExpression([restElement(argsBinding)],callExpression(_super(),[spreadElement(identifier(argsBinding.name))]))}))}(thisEnvFn);allSuperCalls.forEach((superCall=>{const callee=identifier(superBinding);callee.loc=superCall.node.callee.loc,superCall.get("callee").replaceWith(callee)}))}if(argumentsPaths.length>0){const argumentsBinding=getBinding(thisEnvFn,"arguments",(()=>{const args=()=>identifier("arguments");return thisEnvFn.scope.path.isProgram()?conditionalExpression(binaryExpression("===",unaryExpression("typeof",args()),stringLiteral("undefined")),thisEnvFn.scope.buildUndefinedNode(),args()):args()}));argumentsPaths.forEach((argumentsChild=>{const argsRef=identifier(argumentsBinding);argsRef.loc=argumentsChild.node.loc,argumentsChild.replaceWith(argsRef)}))}if(newTargetPaths.length>0){const newTargetBinding=getBinding(thisEnvFn,"newtarget",(()=>metaProperty(identifier("new"),identifier("target"))));newTargetPaths.forEach((targetChild=>{const targetRef=identifier(newTargetBinding);targetRef.loc=targetChild.node.loc,targetChild.replaceWith(targetRef)}))}if(superProps.length>0){if(!allowInsertArrow)throw superProps[0].buildCodeFrameError("When using '@babel/plugin-transform-arrow-functions', it's not possible to compile `super.prop` in an arrow function without compiling classes.\nPlease add '@babel/plugin-transform-classes' to your Babel configuration.");superProps.reduce(((acc,superProp)=>acc.concat(function(superProp){if(superProp.parentPath.isAssignmentExpression()&&"="!==superProp.parentPath.node.operator){const assignmentPath=superProp.parentPath,op=assignmentPath.node.operator.slice(0,-1),value=assignmentPath.node.right,isLogicalAssignment=function(op){return LOGICAL_OPERATORS.includes(op)}(op);if(superProp.node.computed){const tmp=superProp.scope.generateDeclaredUidIdentifier("tmp"),object=superProp.node.object,property=superProp.node.property;assignmentPath.get("left").replaceWith(memberExpression(object,assignmentExpression("=",tmp,property),!0)),assignmentPath.get("right").replaceWith(rightExpression(isLogicalAssignment?"=":op,memberExpression(object,identifier(tmp.name),!0),value))}else{const object=superProp.node.object,property=superProp.node.property;assignmentPath.get("left").replaceWith(memberExpression(object,property)),assignmentPath.get("right").replaceWith(rightExpression(isLogicalAssignment?"=":op,memberExpression(object,identifier(property.name)),value))}return isLogicalAssignment?assignmentPath.replaceWith(logicalExpression(op,assignmentPath.node.left,assignmentPath.node.right)):assignmentPath.node.operator="=",[assignmentPath.get("left"),assignmentPath.get("right").get("left")]}if(superProp.parentPath.isUpdateExpression()){const updateExpr=superProp.parentPath,tmp=superProp.scope.generateDeclaredUidIdentifier("tmp"),computedKey=superProp.node.computed?superProp.scope.generateDeclaredUidIdentifier("prop"):null,parts=[assignmentExpression("=",tmp,memberExpression(superProp.node.object,computedKey?assignmentExpression("=",computedKey,superProp.node.property):superProp.node.property,superProp.node.computed)),assignmentExpression("=",memberExpression(superProp.node.object,computedKey?identifier(computedKey.name):superProp.node.property,superProp.node.computed),binaryExpression(superProp.parentPath.node.operator[0],identifier(tmp.name),numericLiteral(1)))];superProp.parentPath.node.prefix||parts.push(identifier(tmp.name)),updateExpr.replaceWith(sequenceExpression(parts));return[updateExpr.get("expressions.0.right"),updateExpr.get("expressions.1.left")]}return[superProp];function rightExpression(op,left,right){return"="===op?assignmentExpression("=",left,right):binaryExpression(op,left,right)}}(superProp))),[]).forEach((superProp=>{const key=superProp.node.computed?"":superProp.get("property").node.name,superParentPath=superProp.parentPath,isAssignment=superParentPath.isAssignmentExpression({left:superProp.node}),isCall=superParentPath.isCallExpression({callee:superProp.node}),isTaggedTemplate=superParentPath.isTaggedTemplateExpression({tag:superProp.node}),superBinding=function(thisEnvFn,isAssignment,propName){const op=isAssignment?"set":"get";return getBinding(thisEnvFn,`superprop_${op}:${propName||""}`,(()=>{const argsList=[];let fnBody;if(propName)fnBody=memberExpression(_super(),identifier(propName));else{const method=thisEnvFn.scope.generateUidIdentifier("prop");argsList.unshift(method),fnBody=memberExpression(_super(),identifier(method.name),!0)}if(isAssignment){const valueIdent=thisEnvFn.scope.generateUidIdentifier("value");argsList.push(valueIdent),fnBody=assignmentExpression("=",fnBody,identifier(valueIdent.name))}return arrowFunctionExpression(argsList,fnBody)}))}(thisEnvFn,isAssignment,key),args=[];if(superProp.node.computed&&args.push(superProp.get("property").node),isAssignment){const value=superParentPath.node.right;args.push(value)}const call=callExpression(identifier(superBinding),args);isCall?(superParentPath.unshiftContainer("arguments",thisExpression()),superProp.replaceWith(memberExpression(call,identifier("call"))),thisPaths.push(superParentPath.get("arguments.0"))):isAssignment?superParentPath.replaceWith(call):isTaggedTemplate?(superProp.replaceWith(callExpression(memberExpression(call,identifier("bind"),!1),[thisExpression()])),thisPaths.push(superProp.get("arguments.0"))):superProp.replaceWith(call)}))}let thisBinding;return(thisPaths.length>0||!noNewArrows)&&(thisBinding=function(thisEnvFn,inConstructor){return getBinding(thisEnvFn,"this",(thisBinding=>{if(!inConstructor||!hasSuperClass(thisEnvFn))return thisExpression();thisEnvFn.traverse(assignSuperThisVisitor,{supers:new WeakSet,thisBinding})}))}(thisEnvFn,inConstructor),(noNewArrows||inConstructor&&hasSuperClass(thisEnvFn))&&(thisPaths.forEach((thisChild=>{const thisRef=thisChild.isJSX()?jsxIdentifier(thisBinding):identifier(thisBinding);thisRef.loc=thisChild.node.loc,thisChild.replaceWith(thisRef)})),noNewArrows||(thisBinding=null))),{thisBinding,fnPath}}function hasSuperClass(thisEnvFn){return thisEnvFn.isClassMethod()&&!!thisEnvFn.parentPath.parentPath.node.superClass}const assignSuperThisVisitor=(0,_visitors.environmentVisitor)({CallExpression(child,{supers,thisBinding}){child.get("callee").isSuper()&&(supers.has(child.node)||(supers.add(child.node),child.replaceWithMultiple([child.node,assignmentExpression("=",identifier(thisBinding),identifier("this"))])))}});function getBinding(thisEnvFn,key,init){const cacheKey="binding:"+key;let data=thisEnvFn.getData(cacheKey);if(!data){const id=thisEnvFn.scope.generateUidIdentifier(key);data=id.name,thisEnvFn.setData(cacheKey,data),thisEnvFn.scope.push({id,init:init(data)})}return data}const getScopeInformationVisitor=(0,_visitors.environmentVisitor)({ThisExpression(child,{thisPaths}){thisPaths.push(child)},JSXIdentifier(child,{thisPaths}){"this"===child.node.name&&(child.parentPath.isJSXMemberExpression({object:child.node})||child.parentPath.isJSXOpeningElement({name:child.node}))&&thisPaths.push(child)},CallExpression(child,{superCalls}){child.get("callee").isSuper()&&superCalls.push(child)},MemberExpression(child,{superProps}){child.get("object").isSuper()&&superProps.push(child)},Identifier(child,{argumentsPaths}){if(!child.isReferencedIdentifier({name:"arguments"}))return;let curr=child.scope;do{if(curr.hasOwnBinding("arguments"))return void curr.rename("arguments");if(curr.path.isFunction()&&!curr.path.isArrowFunctionExpression())break}while(curr=curr.parent);argumentsPaths.push(child)},MetaProperty(child,{newTargetPaths}){child.get("meta").isIdentifier({name:"new"})&&child.get("property").isIdentifier({name:"target"})&&newTargetPaths.push(child)}});const refersOuterBindingVisitor={"ReferencedIdentifier|BindingIdentifier"(path,state){path.node.name===state.name&&(state.needsRename=!0,path.stop())},Scope(path,state){path.scope.hasOwnBinding(state.name)&&path.skip()}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/evaluation.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.evaluate=function(){const state={confident:!0,deoptPath:null,seen:new Map};let value=evaluateCached(this,state);state.confident||(value=void 0);return{confident:state.confident,deopt:state.deoptPath,value}},exports.evaluateTruthy=function(){const res=this.evaluate();if(res.confident)return!!res.value};const VALID_OBJECT_CALLEES=["Number","String","Math"],VALID_IDENTIFIER_CALLEES=["isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent",null,null],INVALID_METHODS=["random"];function isValidObjectCallee(val){return VALID_OBJECT_CALLEES.includes(val)}function deopt(path,state){state.confident&&(state.deoptPath=path,state.confident=!1)}const Globals=new Map([["undefined",void 0],["Infinity",1/0],["NaN",NaN]]);function evaluateCached(path,state){const{node}=path,{seen}=state;if(seen.has(node)){const existing=seen.get(node);return existing.resolved?existing.value:void deopt(path,state)}{const item={resolved:!1};seen.set(node,item);const val=function(path,state){if(!state.confident)return;if(path.isSequenceExpression()){const exprs=path.get("expressions");return evaluateCached(exprs[exprs.length-1],state)}if(path.isStringLiteral()||path.isNumericLiteral()||path.isBooleanLiteral())return path.node.value;if(path.isNullLiteral())return null;if(path.isTemplateLiteral())return evaluateQuasis(path,path.node.quasis,state);if(path.isTaggedTemplateExpression()&&path.get("tag").isMemberExpression()){const object=path.get("tag.object"),{node:{name}}=object,property=path.get("tag.property");if(object.isIdentifier()&&"String"===name&&!path.scope.getBinding(name)&&property.isIdentifier()&&"raw"===property.node.name)return evaluateQuasis(path,path.node.quasi.quasis,state,!0)}if(path.isConditionalExpression()){const testResult=evaluateCached(path.get("test"),state);if(!state.confident)return;return evaluateCached(testResult?path.get("consequent"):path.get("alternate"),state)}if(path.isExpressionWrapper())return evaluateCached(path.get("expression"),state);if(path.isMemberExpression()&&!path.parentPath.isCallExpression({callee:path.node})){const property=path.get("property"),object=path.get("object");if(object.isLiteral()){const value=object.node.value,type=typeof value;let key=null;if(path.node.computed){if(key=evaluateCached(property,state),!state.confident)return}else property.isIdentifier()&&(key=property.node.name);if(!("number"!==type&&"string"!==type||null==key||"number"!=typeof key&&"string"!=typeof key))return value[key]}}if(path.isReferencedIdentifier()){const binding=path.scope.getBinding(path.node.name);if(binding){if(binding.constantViolations.length>0||path.node.start<binding.path.node.end)return void deopt(binding.path,state);if(binding.hasValue)return binding.value}const name=path.node.name;if(Globals.has(name))return binding?void deopt(binding.path,state):Globals.get(name);const resolved=path.resolve();return resolved===path?void deopt(path,state):evaluateCached(resolved,state)}if(path.isUnaryExpression({prefix:!0})){if("void"===path.node.operator)return;const argument=path.get("argument");if("typeof"===path.node.operator&&(argument.isFunction()||argument.isClass()))return"function";const arg=evaluateCached(argument,state);if(!state.confident)return;switch(path.node.operator){case"!":return!arg;case"+":return+arg;case"-":return-arg;case"~":return~arg;case"typeof":return typeof arg}}if(path.isArrayExpression()){const arr=[],elems=path.get("elements");for(const elem of elems){const elemValue=elem.evaluate();if(!elemValue.confident)return void deopt(elemValue.deopt,state);arr.push(elemValue.value)}return arr}if(path.isObjectExpression()){const obj={},props=path.get("properties");for(const prop of props){if(prop.isObjectMethod()||prop.isSpreadElement())return void deopt(prop,state);const keyPath=prop.get("key");let key;if(prop.node.computed){if(key=keyPath.evaluate(),!key.confident)return void deopt(key.deopt,state);key=key.value}else key=keyPath.isIdentifier()?keyPath.node.name:keyPath.node.value;let value=prop.get("value").evaluate();if(!value.confident)return void deopt(value.deopt,state);value=value.value,obj[key]=value}return obj}if(path.isLogicalExpression()){const wasConfident=state.confident,left=evaluateCached(path.get("left"),state),leftConfident=state.confident;state.confident=wasConfident;const right=evaluateCached(path.get("right"),state),rightConfident=state.confident;switch(path.node.operator){case"||":if(state.confident=leftConfident&&(!!left||rightConfident),!state.confident)return;return left||right;case"&&":if(state.confident=leftConfident&&(!left||rightConfident),!state.confident)return;return left&&right;case"??":if(state.confident=leftConfident&&(null!=left||rightConfident),!state.confident)return;return null!=left?left:right}}if(path.isBinaryExpression()){const left=evaluateCached(path.get("left"),state);if(!state.confident)return;const right=evaluateCached(path.get("right"),state);if(!state.confident)return;switch(path.node.operator){case"-":return left-right;case"+":return left+right;case"/":return left/right;case"*":return left*right;case"%":return left%right;case"**":return Math.pow(left,right);case"<":return left<right;case">":return left>right;case"<=":return left<=right;case">=":return left>=right;case"==":return left==right;case"!=":return left!=right;case"===":return left===right;case"!==":return left!==right;case"|":return left|right;case"&":return left&right;case"^":return left^right;case"<<":return left<<right;case">>":return left>>right;case">>>":return left>>>right}}if(path.isCallExpression()){const callee=path.get("callee");let context,func;if(callee.isIdentifier()&&!path.scope.getBinding(callee.node.name)&&(isValidObjectCallee(callee.node.name)||function(val){return VALID_IDENTIFIER_CALLEES.includes(val)}(callee.node.name))&&(func=global[callee.node.name]),callee.isMemberExpression()){const object=callee.get("object"),property=callee.get("property");if(object.isIdentifier()&&property.isIdentifier()&&isValidObjectCallee(object.node.name)&&!function(val){return INVALID_METHODS.includes(val)}(property.node.name)){context=global[object.node.name];const key=property.node.name;hasOwnProperty.call(context,key)&&(func=context[key])}if(object.isLiteral()&&property.isIdentifier()){const type=typeof object.node.value;"string"!==type&&"number"!==type||(context=object.node.value,func=context[property.node.name])}}if(func){const args=path.get("arguments").map((arg=>evaluateCached(arg,state)));if(!state.confident)return;return func.apply(context,args)}}deopt(path,state)}(path,state);return state.confident&&(item.resolved=!0,item.value=val),val}}function evaluateQuasis(path,quasis,state,raw=!1){let str="",i=0;const exprs=path.isTemplateLiteral()?path.get("expressions"):path.get("quasi.expressions");for(const elem of quasis){if(!state.confident)break;str+=raw?elem.value.raw:elem.value.cooked;const expr=exprs[i++];expr&&(str+=String(evaluateCached(expr,state)))}if(state.confident)return str}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/family.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._getKey=_getKey,exports._getPattern=_getPattern,exports.get=function(key,context=!0){!0===context&&(context=this.context);const parts=key.split(".");return 1===parts.length?_getKey.call(this,key,context):_getPattern.call(this,parts,context)},exports.getAllNextSiblings=function(){let _key=this.key,sibling=this.getSibling(++_key);const siblings=[];for(;sibling.node;)siblings.push(sibling),sibling=this.getSibling(++_key);return siblings},exports.getAllPrevSiblings=function(){let _key=this.key,sibling=this.getSibling(--_key);const siblings=[];for(;sibling.node;)siblings.push(sibling),sibling=this.getSibling(--_key);return siblings},exports.getAssignmentIdentifiers=function(){return _getAssignmentIdentifiers(this.node)},exports.getBindingIdentifierPaths=function(duplicates=!1,outerOnly=!1){const search=[this],ids=Object.create(null);for(;search.length;){const id=search.shift();if(!id)continue;if(!id.node)continue;const keys=_getBindingIdentifiers.keys[id.node.type];if(id.isIdentifier())if(duplicates){(ids[id.node.name]=ids[id.node.name]||[]).push(id)}else ids[id.node.name]=id;else if(id.isExportDeclaration()){const declaration=id.get("declaration");declaration.isDeclaration()&&search.push(declaration)}else{if(outerOnly){if(id.isFunctionDeclaration()){search.push(id.get("id"));continue}if(id.isFunctionExpression())continue}if(keys)for(let i=0;i<keys.length;i++){const key=keys[i],child=id.get(key);Array.isArray(child)?search.push(...child):child.node&&search.push(child)}}}return ids},exports.getBindingIdentifiers=function(duplicates){return _getBindingIdentifiers(this.node,duplicates)},exports.getCompletionRecords=function(){return _getCompletionRecords(this,{canHaveBreak:!1,shouldPopulateBreak:!1,inCaseClause:!1}).map((r=>r.path))},exports.getNextSibling=function(){return this.getSibling(this.key+1)},exports.getOpposite=function(){if("left"===this.key)return this.getSibling("right");if("right"===this.key)return this.getSibling("left");return null},exports.getOuterBindingIdentifierPaths=function(duplicates=!1){return this.getBindingIdentifierPaths(duplicates,!0)},exports.getOuterBindingIdentifiers=function(duplicates){return _getOuterBindingIdentifiers(this.node,duplicates)},exports.getPrevSibling=function(){return this.getSibling(this.key-1)},exports.getSibling=function(key){return _index.default.get({parentPath:this.parentPath,parent:this.parent,container:this.container,listKey:this.listKey,key}).setContext(this.context)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{getAssignmentIdentifiers:_getAssignmentIdentifiers,getBindingIdentifiers:_getBindingIdentifiers,getOuterBindingIdentifiers:_getOuterBindingIdentifiers,numericLiteral,unaryExpression}=_t,NORMAL_COMPLETION=0,BREAK_COMPLETION=1;function addCompletionRecords(path,records,context){return path&&records.push(..._getCompletionRecords(path,context)),records}function normalCompletionToBreak(completions){completions.forEach((c=>{c.type=BREAK_COMPLETION}))}function replaceBreakStatementInBreakCompletion(completions,reachable){completions.forEach((c=>{c.path.isBreakStatement({label:null})&&(reachable?c.path.replaceWith(unaryExpression("void",numericLiteral(0))):c.path.remove())}))}function getStatementListCompletion(paths,context){const completions=[];if(context.canHaveBreak){let lastNormalCompletions=[];for(let i=0;i<paths.length;i++){const path=paths[i],newContext=Object.assign({},context,{inCaseClause:!1});path.isBlockStatement()&&(context.inCaseClause||context.shouldPopulateBreak)?newContext.shouldPopulateBreak=!0:newContext.shouldPopulateBreak=!1;const statementCompletions=_getCompletionRecords(path,newContext);if(statementCompletions.length>0&&statementCompletions.every((c=>c.type===BREAK_COMPLETION))){lastNormalCompletions.length>0&&statementCompletions.every((c=>c.path.isBreakStatement({label:null})))?(normalCompletionToBreak(lastNormalCompletions),completions.push(...lastNormalCompletions),lastNormalCompletions.some((c=>c.path.isDeclaration()))&&(completions.push(...statementCompletions),replaceBreakStatementInBreakCompletion(statementCompletions,!0)),replaceBreakStatementInBreakCompletion(statementCompletions,!1)):(completions.push(...statementCompletions),context.shouldPopulateBreak||replaceBreakStatementInBreakCompletion(statementCompletions,!0));break}if(i===paths.length-1)completions.push(...statementCompletions);else{lastNormalCompletions=[];for(let i=0;i<statementCompletions.length;i++){const c=statementCompletions[i];c.type===BREAK_COMPLETION&&completions.push(c),c.type===NORMAL_COMPLETION&&lastNormalCompletions.push(c)}}}}else if(paths.length)for(let i=paths.length-1;i>=0;i--){const pathCompletions=_getCompletionRecords(paths[i],context);if(pathCompletions.length>1||1===pathCompletions.length&&!pathCompletions[0].path.isVariableDeclaration()){completions.push(...pathCompletions);break}}return completions}function _getCompletionRecords(path,context){let records=[];if(path.isIfStatement())records=addCompletionRecords(path.get("consequent"),records,context),records=addCompletionRecords(path.get("alternate"),records,context);else{if(path.isDoExpression()||path.isFor()||path.isWhile()||path.isLabeledStatement())return addCompletionRecords(path.get("body"),records,context);if(path.isProgram()||path.isBlockStatement())return getStatementListCompletion(path.get("body"),context);if(path.isFunction())return _getCompletionRecords(path.get("body"),context);if(path.isTryStatement())records=addCompletionRecords(path.get("block"),records,context),records=addCompletionRecords(path.get("handler"),records,context);else{if(path.isCatchClause())return addCompletionRecords(path.get("body"),records,context);if(path.isSwitchStatement())return function(cases,records,context){let lastNormalCompletions=[];for(let i=0;i<cases.length;i++){const caseCompletions=_getCompletionRecords(cases[i],context),normalCompletions=[],breakCompletions=[];for(const c of caseCompletions)c.type===NORMAL_COMPLETION&&normalCompletions.push(c),c.type===BREAK_COMPLETION&&breakCompletions.push(c);normalCompletions.length&&(lastNormalCompletions=normalCompletions),records.push(...breakCompletions)}return records.push(...lastNormalCompletions),records}(path.get("cases"),records,context);if(path.isSwitchCase())return getStatementListCompletion(path.get("consequent"),{canHaveBreak:!0,shouldPopulateBreak:!1,inCaseClause:!0});path.isBreakStatement()?records.push(function(path){return{type:BREAK_COMPLETION,path}}(path)):records.push(function(path){return{type:NORMAL_COMPLETION,path}}(path))}}return records}function _getKey(key,context){const node=this.node,container=node[key];return Array.isArray(container)?container.map(((_,i)=>_index.default.get({listKey:key,parentPath:this,parent:node,container,key:i}).setContext(context))):_index.default.get({parentPath:this,parent:node,container:node,key}).setContext(context)}function _getPattern(parts,context){let path=this;for(const part of parts)path="."===part?path.parentPath:Array.isArray(path)?path[part]:path.get(part,context);return path}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.SHOULD_STOP=exports.SHOULD_SKIP=exports.REMOVED=void 0;var virtualTypes=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types.js"),_debug=__webpack_require__("./node_modules/.pnpm/debug@4.4.0/node_modules/debug/src/index.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),t=_t,cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_generator=__webpack_require__("./node_modules/.pnpm/@babel+generator@7.26.3/node_modules/@babel/generator/lib/index.js"),NodePath_ancestry=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/ancestry.js"),NodePath_inference=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/index.js"),NodePath_replacement=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/replacement.js"),NodePath_evaluation=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/evaluation.js"),NodePath_conversion=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/conversion.js"),NodePath_introspection=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/introspection.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js"),NodePath_context=_context,NodePath_removal=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js"),NodePath_modification=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js"),NodePath_family=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/family.js"),NodePath_comments=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/comments.js"),NodePath_virtual_types_validator=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types-validator.js");const{validate}=_t,debug=_debug("babel"),NodePath_Final=(exports.REMOVED=1,exports.SHOULD_STOP=2,exports.SHOULD_SKIP=4,exports.default=class NodePath{constructor(hub,parent){this.contexts=[],this.state=null,this.opts=null,this._traverseFlags=0,this.skipKeys=null,this.parentPath=null,this.container=null,this.listKey=null,this.key=null,this.node=null,this.type=null,this.parent=parent,this.hub=hub,this.data=null,this.context=null,this.scope=null}get removed(){return(1&this._traverseFlags)>0}set removed(v){v?this._traverseFlags|=1:this._traverseFlags&=-2}get shouldStop(){return(2&this._traverseFlags)>0}set shouldStop(v){v?this._traverseFlags|=2:this._traverseFlags&=-3}get shouldSkip(){return(4&this._traverseFlags)>0}set shouldSkip(v){v?this._traverseFlags|=4:this._traverseFlags&=-5}static get({hub,parentPath,parent,container,listKey,key}){if(!hub&&parentPath&&(hub=parentPath.hub),!parent)throw new Error("To get a node path the parent needs to exist");const targetNode=container[key],paths=cache.getOrCreateCachedPaths(hub,parent);let path=paths.get(targetNode);return path||(path=new NodePath(hub,parent),targetNode&&paths.set(targetNode,path)),_context.setup.call(path,parentPath,container,listKey,key),path}getScope(scope){return this.isScope()?new _index2.default(this):scope}setData(key,val){return null==this.data&&(this.data=Object.create(null)),this.data[key]=val}getData(key,def){null==this.data&&(this.data=Object.create(null));let val=this.data[key];return void 0===val&&void 0!==def&&(val=this.data[key]=def),val}hasNode(){return null!=this.node}buildCodeFrameError(msg,Error=SyntaxError){return this.hub.buildError(this.node,msg,Error)}traverse(visitor,state){(0,_index.default)(this.node,visitor,this.scope,state,this)}set(key,node){validate(this.node,key,node),this.node[key]=node}getPathLocation(){const parts=[];let path=this;do{let key=path.key;path.inList&&(key=`${path.listKey}[${key}]`),parts.unshift(key)}while(path=path.parentPath);return parts.join(".")}debug(message){debug.enabled&&debug(`${this.getPathLocation()} ${this.type}: ${message}`)}toString(){return(0,_generator.default)(this.node).code}get inList(){return!!this.listKey}set inList(inList){inList||(this.listKey=null)}get parentKey(){return this.listKey||this.key}}),methods={findParent:NodePath_ancestry.findParent,find:NodePath_ancestry.find,getFunctionParent:NodePath_ancestry.getFunctionParent,getStatementParent:NodePath_ancestry.getStatementParent,getEarliestCommonAncestorFrom:NodePath_ancestry.getEarliestCommonAncestorFrom,getDeepestCommonAncestorFrom:NodePath_ancestry.getDeepestCommonAncestorFrom,getAncestry:NodePath_ancestry.getAncestry,isAncestor:NodePath_ancestry.isAncestor,isDescendant:NodePath_ancestry.isDescendant,inType:NodePath_ancestry.inType,getTypeAnnotation:NodePath_inference.getTypeAnnotation,isBaseType:NodePath_inference.isBaseType,couldBeBaseType:NodePath_inference.couldBeBaseType,baseTypeStrictlyMatches:NodePath_inference.baseTypeStrictlyMatches,isGenericType:NodePath_inference.isGenericType,replaceWithMultiple:NodePath_replacement.replaceWithMultiple,replaceWithSourceString:NodePath_replacement.replaceWithSourceString,replaceWith:NodePath_replacement.replaceWith,replaceExpressionWithStatements:NodePath_replacement.replaceExpressionWithStatements,replaceInline:NodePath_replacement.replaceInline,evaluateTruthy:NodePath_evaluation.evaluateTruthy,evaluate:NodePath_evaluation.evaluate,toComputedKey:NodePath_conversion.toComputedKey,ensureBlock:NodePath_conversion.ensureBlock,unwrapFunctionEnvironment:NodePath_conversion.unwrapFunctionEnvironment,arrowFunctionToExpression:NodePath_conversion.arrowFunctionToExpression,splitExportDeclaration:NodePath_conversion.splitExportDeclaration,ensureFunctionName:NodePath_conversion.ensureFunctionName,matchesPattern:NodePath_introspection.matchesPattern,isStatic:NodePath_introspection.isStatic,isNodeType:NodePath_introspection.isNodeType,canHaveVariableDeclarationOrExpression:NodePath_introspection.canHaveVariableDeclarationOrExpression,canSwapBetweenExpressionAndStatement:NodePath_introspection.canSwapBetweenExpressionAndStatement,isCompletionRecord:NodePath_introspection.isCompletionRecord,isStatementOrBlock:NodePath_introspection.isStatementOrBlock,referencesImport:NodePath_introspection.referencesImport,getSource:NodePath_introspection.getSource,willIMaybeExecuteBefore:NodePath_introspection.willIMaybeExecuteBefore,_guessExecutionStatusRelativeTo:NodePath_introspection._guessExecutionStatusRelativeTo,resolve:NodePath_introspection.resolve,isConstantExpression:NodePath_introspection.isConstantExpression,isInStrictMode:NodePath_introspection.isInStrictMode,isDenylisted:NodePath_context.isDenylisted,visit:NodePath_context.visit,skip:NodePath_context.skip,skipKey:NodePath_context.skipKey,stop:NodePath_context.stop,setContext:NodePath_context.setContext,requeue:NodePath_context.requeue,requeueComputedKeyAndDecorators:NodePath_context.requeueComputedKeyAndDecorators,remove:NodePath_removal.remove,insertBefore:NodePath_modification.insertBefore,insertAfter:NodePath_modification.insertAfter,unshiftContainer:NodePath_modification.unshiftContainer,pushContainer:NodePath_modification.pushContainer,getOpposite:NodePath_family.getOpposite,getCompletionRecords:NodePath_family.getCompletionRecords,getSibling:NodePath_family.getSibling,getPrevSibling:NodePath_family.getPrevSibling,getNextSibling:NodePath_family.getNextSibling,getAllNextSiblings:NodePath_family.getAllNextSiblings,getAllPrevSiblings:NodePath_family.getAllPrevSiblings,get:NodePath_family.get,getAssignmentIdentifiers:NodePath_family.getAssignmentIdentifiers,getBindingIdentifiers:NodePath_family.getBindingIdentifiers,getOuterBindingIdentifiers:NodePath_family.getOuterBindingIdentifiers,getBindingIdentifierPaths:NodePath_family.getBindingIdentifierPaths,getOuterBindingIdentifierPaths:NodePath_family.getOuterBindingIdentifierPaths,shareCommentsWithSiblings:NodePath_comments.shareCommentsWithSiblings,addComment:NodePath_comments.addComment,addComments:NodePath_comments.addComments};Object.assign(NodePath_Final.prototype,methods),NodePath_Final.prototype.arrowFunctionToShadowed=NodePath_conversion[String("arrowFunctionToShadowed")],Object.assign(NodePath_Final.prototype,{has:NodePath_introspection[String("has")],is:NodePath_introspection[String("is")],isnt:NodePath_introspection[String("isnt")],equals:NodePath_introspection[String("equals")],hoist:NodePath_modification[String("hoist")],updateSiblingKeys:NodePath_modification.updateSiblingKeys,call:NodePath_context.call,isBlacklisted:NodePath_context[String("isBlacklisted")],setScope:NodePath_context.setScope,resync:NodePath_context.resync,popContext:NodePath_context.popContext,pushContext:NodePath_context.pushContext,setup:NodePath_context.setup,setKey:NodePath_context.setKey}),NodePath_Final.prototype._guessExecutionStatusRelativeToDifferentFunctions=NodePath_introspection._guessExecutionStatusRelativeTo,NodePath_Final.prototype._guessExecutionStatusRelativeToDifferentFunctions=NodePath_introspection._guessExecutionStatusRelativeTo,Object.assign(NodePath_Final.prototype,{_getTypeAnnotation:NodePath_inference._getTypeAnnotation,_replaceWith:NodePath_replacement._replaceWith,_resolve:NodePath_introspection._resolve,_call:NodePath_context._call,_resyncParent:NodePath_context._resyncParent,_resyncKey:NodePath_context._resyncKey,_resyncList:NodePath_context._resyncList,_resyncRemoved:NodePath_context._resyncRemoved,_getQueueContexts:NodePath_context._getQueueContexts,_removeFromScope:NodePath_removal._removeFromScope,_callRemovalHooks:NodePath_removal._callRemovalHooks,_remove:NodePath_removal._remove,_markRemoved:NodePath_removal._markRemoved,_assertUnremoved:NodePath_removal._assertUnremoved,_containerInsert:NodePath_modification._containerInsert,_containerInsertBefore:NodePath_modification._containerInsertBefore,_containerInsertAfter:NodePath_modification._containerInsertAfter,_verifyNodeList:NodePath_modification._verifyNodeList,_getKey:NodePath_family._getKey,_getPattern:NodePath_family._getPattern});for(const type of t.TYPES){const typeKey=`is${type}`,fn=t[typeKey];NodePath_Final.prototype[typeKey]=function(opts){return fn(this.node,opts)},NodePath_Final.prototype[`assert${type}`]=function(opts){if(!fn(this.node,opts))throw new TypeError(`Expected node path of type ${type}`)}}Object.assign(NodePath_Final.prototype,NodePath_virtual_types_validator);for(const type of Object.keys(virtualTypes))"_"!==type[0]&&(t.TYPES.includes(type)||t.TYPES.push(type))},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._getTypeAnnotation=_getTypeAnnotation,exports.baseTypeStrictlyMatches=function(rightArg){const left=this.getTypeAnnotation(),right=rightArg.getTypeAnnotation();if(!isAnyTypeAnnotation(left)&&isFlowBaseAnnotation(left))return right.type===left.type;return!1},exports.couldBeBaseType=function(name){const type=this.getTypeAnnotation();if(isAnyTypeAnnotation(type))return!0;if(isUnionTypeAnnotation(type)){for(const type2 of type.types)if(isAnyTypeAnnotation(type2)||_isBaseType(name,type2,!0))return!0;return!1}return _isBaseType(name,type,!0)},exports.getTypeAnnotation=function(){let type=this.getData("typeAnnotation");if(null!=type)return type;type=_getTypeAnnotation.call(this)||anyTypeAnnotation(),(isTypeAnnotation(type)||isTSTypeAnnotation(type))&&(type=type.typeAnnotation);return this.setData("typeAnnotation",type),type},exports.isBaseType=function(baseName,soft){return _isBaseType(baseName,this.getTypeAnnotation(),soft)},exports.isGenericType=function(genericName){const type=this.getTypeAnnotation();if("Array"===genericName&&(isTSArrayType(type)||isArrayTypeAnnotation(type)||isTupleTypeAnnotation(type)))return!0;return isGenericTypeAnnotation(type)&&isIdentifier(type.id,{name:genericName})||isTSTypeReference(type)&&isIdentifier(type.typeName,{name:genericName})};var inferers=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferers.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{anyTypeAnnotation,isAnyTypeAnnotation,isArrayTypeAnnotation,isBooleanTypeAnnotation,isEmptyTypeAnnotation,isFlowBaseAnnotation,isGenericTypeAnnotation,isIdentifier,isMixedTypeAnnotation,isNumberTypeAnnotation,isStringTypeAnnotation,isTSArrayType,isTSTypeAnnotation,isTSTypeReference,isTupleTypeAnnotation,isTypeAnnotation,isUnionTypeAnnotation,isVoidTypeAnnotation,stringTypeAnnotation,voidTypeAnnotation}=_t;const typeAnnotationInferringNodes=new WeakSet;function _getTypeAnnotation(){const node=this.node;if(node){if(node.typeAnnotation)return node.typeAnnotation;if(!typeAnnotationInferringNodes.has(node)){typeAnnotationInferringNodes.add(node);try{var _inferer;let inferer=inferers[node.type];if(inferer)return inferer.call(this,node);if(inferer=inferers[this.parentPath.type],null!=(_inferer=inferer)&&_inferer.validParent)return this.parentPath.getTypeAnnotation()}finally{typeAnnotationInferringNodes.delete(node)}}}else if("init"===this.key&&this.parentPath.isVariableDeclarator()){const declar=this.parentPath.parentPath,declarParent=declar.parentPath;return"left"===declar.key&&declarParent.isForInStatement()?stringTypeAnnotation():"left"===declar.key&&declarParent.isForOfStatement()?anyTypeAnnotation():voidTypeAnnotation()}}function _isBaseType(baseName,type,soft){if("string"===baseName)return isStringTypeAnnotation(type);if("number"===baseName)return isNumberTypeAnnotation(type);if("boolean"===baseName)return isBooleanTypeAnnotation(type);if("any"===baseName)return isAnyTypeAnnotation(type);if("mixed"===baseName)return isMixedTypeAnnotation(type);if("empty"===baseName)return isEmptyTypeAnnotation(type);if("void"===baseName)return isVoidTypeAnnotation(type);if(soft)return!1;throw new Error(`Unknown base type ${baseName}`)}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferer-reference.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){if(!this.isReferenced())return;const binding=this.scope.getBinding(node.name);if(binding)return binding.identifier.typeAnnotation?binding.identifier.typeAnnotation:function(binding,path,name){const types=[],functionConstantViolations=[];let constantViolations=getConstantViolationsBefore(binding,path,functionConstantViolations);const testType=getConditionalAnnotation(binding,path,name);if(testType){const testConstantViolations=getConstantViolationsBefore(binding,testType.ifStatement);constantViolations=constantViolations.filter((path=>!testConstantViolations.includes(path))),types.push(testType.typeAnnotation)}if(constantViolations.length){constantViolations.push(...functionConstantViolations);for(const violation of constantViolations)types.push(violation.getTypeAnnotation())}if(!types.length)return;return(0,_util.createUnionType)(types)}(binding,this,node.name);if("undefined"===node.name)return voidTypeAnnotation();if("NaN"===node.name||"Infinity"===node.name)return numberTypeAnnotation();node.name};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_util=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/util.js");const{BOOLEAN_NUMBER_BINARY_OPERATORS,createTypeAnnotationBasedOnTypeof,numberTypeAnnotation,voidTypeAnnotation}=_t;function getConstantViolationsBefore(binding,path,functions){const violations=binding.constantViolations.slice();return violations.unshift(binding.path),violations.filter((violation=>{const status=(violation=violation.resolve())._guessExecutionStatusRelativeTo(path);return functions&&"unknown"===status&&functions.push(violation),"before"===status}))}function inferAnnotationFromBinaryExpression(name,path){const operator=path.node.operator,right=path.get("right").resolve(),left=path.get("left").resolve();let target,typeofPath,typePath;if(left.isIdentifier({name})?target=right:right.isIdentifier({name})&&(target=left),target)return"==="===operator?target.getTypeAnnotation():BOOLEAN_NUMBER_BINARY_OPERATORS.includes(operator)?numberTypeAnnotation():void 0;if("==="!==operator&&"=="!==operator)return;if(left.isUnaryExpression({operator:"typeof"})?(typeofPath=left,typePath=right):right.isUnaryExpression({operator:"typeof"})&&(typeofPath=right,typePath=left),!typeofPath)return;if(!typeofPath.get("argument").isIdentifier({name}))return;if(typePath=typePath.resolve(),!typePath.isLiteral())return;const typeValue=typePath.node.value;return"string"==typeof typeValue?createTypeAnnotationBasedOnTypeof(typeValue):void 0}function getConditionalAnnotation(binding,path,name){const ifStatement=function(binding,path,name){let parentPath;for(;parentPath=path.parentPath;){if(parentPath.isIfStatement()||parentPath.isConditionalExpression()){if("test"===path.key)return;return parentPath}if(parentPath.isFunction()&&parentPath.parentPath.scope.getBinding(name)!==binding)return;path=parentPath}}(binding,path,name);if(!ifStatement)return;const paths=[ifStatement.get("test")],types=[];for(let i=0;i<paths.length;i++){const path=paths[i];if(path.isLogicalExpression())"&&"===path.node.operator&&(paths.push(path.get("left")),paths.push(path.get("right")));else if(path.isBinaryExpression()){const type=inferAnnotationFromBinaryExpression(name,path);type&&types.push(type)}}return types.length?{typeAnnotation:(0,_util.createUnionType)(types),ifStatement}:getConditionalAnnotation(binding,ifStatement,name)}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferers.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArrayExpression=ArrayExpression,exports.AssignmentExpression=function(){return this.get("right").getTypeAnnotation()},exports.BinaryExpression=function(node){const operator=node.operator;if(NUMBER_BINARY_OPERATORS.includes(operator))return numberTypeAnnotation();if(BOOLEAN_BINARY_OPERATORS.includes(operator))return booleanTypeAnnotation();if("+"===operator){const right=this.get("right"),left=this.get("left");return left.isBaseType("number")&&right.isBaseType("number")?numberTypeAnnotation():left.isBaseType("string")||right.isBaseType("string")?stringTypeAnnotation():unionTypeAnnotation([stringTypeAnnotation(),numberTypeAnnotation()])}},exports.BooleanLiteral=function(){return booleanTypeAnnotation()},exports.CallExpression=function(){const{callee}=this.node;if(isObjectKeys(callee))return arrayTypeAnnotation(stringTypeAnnotation());if(isArrayFrom(callee)||isObjectValues(callee)||isIdentifier(callee,{name:"Array"}))return arrayTypeAnnotation(anyTypeAnnotation());if(isObjectEntries(callee))return arrayTypeAnnotation(tupleTypeAnnotation([stringTypeAnnotation(),anyTypeAnnotation()]));return resolveCall(this.get("callee"))},exports.ConditionalExpression=function(){const argumentTypes=[this.get("consequent").getTypeAnnotation(),this.get("alternate").getTypeAnnotation()];return(0,_util.createUnionType)(argumentTypes)},exports.ClassDeclaration=exports.ClassExpression=exports.FunctionDeclaration=exports.ArrowFunctionExpression=exports.FunctionExpression=function(){return genericTypeAnnotation(identifier("Function"))},Object.defineProperty(exports,"Identifier",{enumerable:!0,get:function(){return _infererReference.default}}),exports.LogicalExpression=function(){const argumentTypes=[this.get("left").getTypeAnnotation(),this.get("right").getTypeAnnotation()];return(0,_util.createUnionType)(argumentTypes)},exports.NewExpression=function(node){if("Identifier"===node.callee.type)return genericTypeAnnotation(node.callee)},exports.NullLiteral=function(){return nullLiteralTypeAnnotation()},exports.NumericLiteral=function(){return numberTypeAnnotation()},exports.ObjectExpression=function(){return genericTypeAnnotation(identifier("Object"))},exports.ParenthesizedExpression=function(){return this.get("expression").getTypeAnnotation()},exports.RegExpLiteral=function(){return genericTypeAnnotation(identifier("RegExp"))},exports.RestElement=RestElement,exports.SequenceExpression=function(){return this.get("expressions").pop().getTypeAnnotation()},exports.StringLiteral=function(){return stringTypeAnnotation()},exports.TSAsExpression=TSAsExpression,exports.TSNonNullExpression=function(){return this.get("expression").getTypeAnnotation()},exports.TaggedTemplateExpression=function(){return resolveCall(this.get("tag"))},exports.TemplateLiteral=function(){return stringTypeAnnotation()},exports.TypeCastExpression=TypeCastExpression,exports.UnaryExpression=function(node){const operator=node.operator;if("void"===operator)return voidTypeAnnotation();if(NUMBER_UNARY_OPERATORS.includes(operator))return numberTypeAnnotation();if(STRING_UNARY_OPERATORS.includes(operator))return stringTypeAnnotation();if(BOOLEAN_UNARY_OPERATORS.includes(operator))return booleanTypeAnnotation()},exports.UpdateExpression=function(node){const operator=node.operator;if("++"===operator||"--"===operator)return numberTypeAnnotation()},exports.VariableDeclarator=function(){if(!this.get("id").isIdentifier())return;return this.get("init").getTypeAnnotation()};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_infererReference=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/inferer-reference.js"),_util=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/util.js");const{BOOLEAN_BINARY_OPERATORS,BOOLEAN_UNARY_OPERATORS,NUMBER_BINARY_OPERATORS,NUMBER_UNARY_OPERATORS,STRING_UNARY_OPERATORS,anyTypeAnnotation,arrayTypeAnnotation,booleanTypeAnnotation,buildMatchMemberExpression,genericTypeAnnotation,identifier,nullLiteralTypeAnnotation,numberTypeAnnotation,stringTypeAnnotation,tupleTypeAnnotation,unionTypeAnnotation,voidTypeAnnotation,isIdentifier}=_t;function TypeCastExpression(node){return node.typeAnnotation}function TSAsExpression(node){return node.typeAnnotation}function ArrayExpression(){return genericTypeAnnotation(identifier("Array"))}function RestElement(){return ArrayExpression()}TypeCastExpression.validParent=!0,TSAsExpression.validParent=!0,RestElement.validParent=!0;const isArrayFrom=buildMatchMemberExpression("Array.from"),isObjectKeys=buildMatchMemberExpression("Object.keys"),isObjectValues=buildMatchMemberExpression("Object.values"),isObjectEntries=buildMatchMemberExpression("Object.entries");function resolveCall(callee){if((callee=callee.resolve()).isFunction()){const{node}=callee;if(node.async)return node.generator?genericTypeAnnotation(identifier("AsyncIterator")):genericTypeAnnotation(identifier("Promise"));if(node.generator)return genericTypeAnnotation(identifier("Iterator"));if(callee.node.returnType)return callee.node.returnType}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/inference/util.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createUnionType=function(types){if(types.every((v=>isFlowType(v))))return createFlowUnionType?createFlowUnionType(types):createUnionTypeAnnotation(types);if(types.every((v=>isTSType(v)))&&createTSUnionType)return createTSUnionType(types)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{createFlowUnionType,createTSUnionType,createUnionTypeAnnotation,isFlowType,isTSType}=_t},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/introspection.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._guessExecutionStatusRelativeTo=function(target){return _guessExecutionStatusRelativeToCached(this,target,new Map)},exports._resolve=_resolve,exports.canHaveVariableDeclarationOrExpression=function(){return("init"===this.key||"left"===this.key)&&this.parentPath.isFor()},exports.canSwapBetweenExpressionAndStatement=function(replacement){if("body"!==this.key||!this.parentPath.isArrowFunctionExpression())return!1;if(this.isExpression())return isBlockStatement(replacement);if(this.isBlockStatement())return isExpression(replacement);return!1},exports.getSource=function(){const node=this.node;if(node.end){const code=this.hub.getCode();if(code)return code.slice(node.start,node.end)}return""},exports.isCompletionRecord=function(allowInsideFunction){let path=this,first=!0;do{const{type,container}=path;if(!first&&(path.isFunction()||"StaticBlock"===type))return!!allowInsideFunction;if(first=!1,Array.isArray(container)&&path.key!==container.length-1)return!1}while((path=path.parentPath)&&!path.isProgram()&&!path.isDoExpression());return!0},exports.isConstantExpression=function(){if(this.isIdentifier()){const binding=this.scope.getBinding(this.node.name);return!!binding&&binding.constant}if(this.isLiteral())return!this.isRegExpLiteral()&&(!this.isTemplateLiteral()||this.get("expressions").every((expression=>expression.isConstantExpression())));if(this.isUnaryExpression())return"void"===this.node.operator&&this.get("argument").isConstantExpression();if(this.isBinaryExpression()){const{operator}=this.node;return"in"!==operator&&"instanceof"!==operator&&this.get("left").isConstantExpression()&&this.get("right").isConstantExpression()}if(this.isMemberExpression())return!this.node.computed&&this.get("object").isIdentifier({name:"Symbol"})&&!this.scope.hasBinding("Symbol",{noGlobals:!0});if(this.isCallExpression())return 1===this.node.arguments.length&&this.get("callee").matchesPattern("Symbol.for")&&!this.scope.hasBinding("Symbol",{noGlobals:!0})&&this.get("arguments")[0].isStringLiteral();return!1},exports.isInStrictMode=function(){const start=this.isProgram()?this:this.parentPath;return!!start.find((path=>{if(path.isProgram({sourceType:"module"}))return!0;if(path.isClass())return!0;if(path.isArrowFunctionExpression()&&!path.get("body").isBlockStatement())return!1;let body;if(path.isFunction())body=path.node.body;else{if(!path.isProgram())return!1;body=path.node}for(const directive of body.directives)if("use strict"===directive.value.value)return!0}))},exports.isNodeType=function(type){return isType(this.type,type)},exports.isStatementOrBlock=function(){return!this.parentPath.isLabeledStatement()&&!isBlockStatement(this.container)&&STATEMENT_OR_BLOCK_KEYS.includes(this.key)},exports.isStatic=function(){return this.scope.isStatic(this.node)},exports.matchesPattern=function(pattern,allowPartial){return _matchesPattern(this.node,pattern,allowPartial)},exports.referencesImport=function(moduleSource,importName){if(!this.isReferencedIdentifier()){if(this.isJSXMemberExpression()&&this.node.property.name===importName||(this.isMemberExpression()||this.isOptionalMemberExpression())&&(this.node.computed?isStringLiteral(this.node.property,{value:importName}):this.node.property.name===importName)){const object=this.get("object");return object.isReferencedIdentifier()&&object.referencesImport(moduleSource,"*")}return!1}const binding=this.scope.getBinding(this.node.name);if(!binding||"module"!==binding.kind)return!1;const path=binding.path,parent=path.parentPath;if(!parent.isImportDeclaration())return!1;if(parent.node.source.value!==moduleSource)return!1;if(!importName)return!0;if(path.isImportDefaultSpecifier()&&"default"===importName)return!0;if(path.isImportNamespaceSpecifier()&&"*"===importName)return!0;if(path.isImportSpecifier()&&isIdentifier(path.node.imported,{name:importName}))return!0;return!1},exports.resolve=function(dangerous,resolved){return _resolve.call(this,dangerous,resolved)||this},exports.willIMaybeExecuteBefore=function(target){return"after"!==this._guessExecutionStatusRelativeTo(target)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{STATEMENT_OR_BLOCK_KEYS,VISITOR_KEYS,isBlockStatement,isExpression,isIdentifier,isLiteral,isStringLiteral,isType,matchesPattern:_matchesPattern}=_t;function getOuterFunction(path){return path.isProgram()?path:(path.parentPath.scope.getFunctionParent()||path.parentPath.scope.getProgramParent()).path}function isExecutionUncertain(type,key){switch(type){case"LogicalExpression":case"AssignmentPattern":return"right"===key;case"ConditionalExpression":case"IfStatement":return"consequent"===key||"alternate"===key;case"WhileStatement":case"DoWhileStatement":case"ForInStatement":case"ForOfStatement":return"body"===key;case"ForStatement":return"body"===key||"update"===key;case"SwitchStatement":return"cases"===key;case"TryStatement":return"handler"===key;case"OptionalMemberExpression":return"property"===key;case"OptionalCallExpression":return"arguments"===key;default:return!1}}function isExecutionUncertainInList(paths,maxIndex){for(let i=0;i<maxIndex;i++){const path=paths[i];if(isExecutionUncertain(path.parent.type,path.parentKey))return!0}return!1}exports.has=function(key){var _this$node;const val=null==(_this$node=this.node)?void 0:_this$node[key];return val&&Array.isArray(val)?!!val.length:!!val},exports.is=exports.has,exports.isnt=function(key){return!this.has(key)},exports.equals=function(key,value){return this.node[key]===value};const SYMBOL_CHECKING=Symbol();function _guessExecutionStatusRelativeToCached(base,target,cache){const funcParent={this:getOuterFunction(base),target:getOuterFunction(target)};if(funcParent.target.node!==funcParent.this.node)return function(base,target,cache){let cached,nodeMap=cache.get(base.node);if(nodeMap){if(cached=nodeMap.get(target.node))return cached===SYMBOL_CHECKING?"unknown":cached}else cache.set(base.node,nodeMap=new Map);nodeMap.set(target.node,SYMBOL_CHECKING);const result=function(base,target,cache){if(!target.isFunctionDeclaration())return"before"===_guessExecutionStatusRelativeToCached(base,target,cache)?"before":"unknown";if(target.parentPath.isExportDeclaration())return"unknown";const binding=target.scope.getBinding(target.node.id.name);if(!binding.references)return"before";const referencePaths=binding.referencePaths;let allStatus;for(const path of referencePaths){if(!!path.find((path=>path.node===target.node)))continue;if("callee"!==path.key||!path.parentPath.isCallExpression())return"unknown";const status=_guessExecutionStatusRelativeToCached(base,path,cache);if(allStatus&&allStatus!==status)return"unknown";allStatus=status}return allStatus}(base,target,cache);return nodeMap.set(target.node,result),result}(base,funcParent.target,cache);const paths={target:target.getAncestry(),this:base.getAncestry()};if(paths.target.includes(base))return"after";if(paths.this.includes(target))return"before";let commonPath;const commonIndex={target:0,this:0};for(;!commonPath&&commonIndex.this<paths.this.length;){const path=paths.this[commonIndex.this];commonIndex.target=paths.target.indexOf(path),commonIndex.target>=0?commonPath=path:commonIndex.this++}if(!commonPath)throw new Error("Internal Babel error - The two compared nodes don't appear to belong to the same program.");if(isExecutionUncertainInList(paths.this,commonIndex.this-1)||isExecutionUncertainInList(paths.target,commonIndex.target-1))return"unknown";const divergence={this:paths.this[commonIndex.this-1],target:paths.target[commonIndex.target-1]};if(divergence.target.listKey&&divergence.this.listKey&&divergence.target.container===divergence.this.container)return divergence.target.key>divergence.this.key?"before":"after";const keys=VISITOR_KEYS[commonPath.type],keyPosition_this=keys.indexOf(divergence.this.parentKey);return keys.indexOf(divergence.target.parentKey)>keyPosition_this?"before":"after"}function _resolve(dangerous,resolved){var _resolved;if(null==(_resolved=resolved)||!_resolved.includes(this))if((resolved=resolved||[]).push(this),this.isVariableDeclarator()){if(this.get("id").isIdentifier())return this.get("init").resolve(dangerous,resolved)}else if(this.isReferencedIdentifier()){const binding=this.scope.getBinding(this.node.name);if(!binding)return;if(!binding.constant)return;if("module"===binding.kind)return;if(binding.path!==this){const ret=binding.path.resolve(dangerous,resolved);if(this.find((parent=>parent.node===ret.node)))return;return ret}}else{if(this.isTypeCastExpression())return this.get("expression").resolve(dangerous,resolved);if(dangerous&&this.isMemberExpression()){const targetKey=this.toComputedKey();if(!isLiteral(targetKey))return;const targetName=targetKey.value,target=this.get("object").resolve(dangerous,resolved);if(target.isObjectExpression()){const props=target.get("properties");for(const prop of props){if(!prop.isProperty())continue;const key=prop.get("key");let match=prop.isnt("computed")&&key.isIdentifier({name:targetName});if(match=match||key.isLiteral({value:targetName}),match)return prop.get("value").resolve(dangerous,resolved)}}else if(target.isArrayExpression()&&!isNaN(+targetName)){const elem=target.get("elements")[targetName];if(elem)return elem.resolve(dangerous,resolved)}}}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/hoister.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_t2=_t;const{react}=_t,{cloneNode,jsxExpressionContainer,variableDeclaration,variableDeclarator}=_t2,referenceVisitor={ReferencedIdentifier(path,state){if(path.isJSXIdentifier()&&react.isCompatTag(path.node.name)&&!path.parentPath.isJSXMemberExpression())return;if("this"===path.node.name){let scope=path.scope;do{if(scope.path.isFunction()&&!scope.path.isArrowFunctionExpression())break}while(scope=scope.parent);scope&&state.breakOnScopePaths.push(scope.path)}const binding=path.scope.getBinding(path.node.name);if(binding){for(const violation of binding.constantViolations)if(violation.scope!==binding.path.scope)return state.mutableBinding=!0,void path.stop();binding===state.scope.getBinding(path.node.name)&&(state.bindings[path.node.name]=binding)}}};exports.default=class{constructor(path,scope){this.breakOnScopePaths=void 0,this.bindings=void 0,this.mutableBinding=void 0,this.scopes=void 0,this.scope=void 0,this.path=void 0,this.attachAfter=void 0,this.breakOnScopePaths=[],this.bindings={},this.mutableBinding=!1,this.scopes=[],this.scope=scope,this.path=path,this.attachAfter=!1}isCompatibleScope(scope){for(const key of Object.keys(this.bindings)){const binding=this.bindings[key];if(!scope.bindingIdentifierEquals(key,binding.identifier))return!1}return!0}getCompatibleScopes(){let scope=this.path.scope;do{if(!this.isCompatibleScope(scope))break;if(this.scopes.push(scope),this.breakOnScopePaths.includes(scope.path))break}while(scope=scope.parent)}getAttachmentPath(){let path=this._getAttachmentPath();if(!path)return;let targetScope=path.scope;if(targetScope.path===path&&(targetScope=path.scope.parent),targetScope.path.isProgram()||targetScope.path.isFunction())for(const name of Object.keys(this.bindings)){if(!targetScope.hasOwnBinding(name))continue;const binding=this.bindings[name];if("param"===binding.kind||"params"===binding.path.parentKey)continue;if(this.getAttachmentParentForPath(binding.path).key>=path.key){this.attachAfter=!0,path=binding.path;for(const violationPath of binding.constantViolations)this.getAttachmentParentForPath(violationPath).key>path.key&&(path=violationPath)}}return path}_getAttachmentPath(){const scope=this.scopes.pop();if(scope)if(scope.path.isFunction()){if(!this.hasOwnParamBindings(scope))return this.getNextScopeAttachmentParent();{if(this.scope===scope)return;const bodies=scope.path.get("body").get("body");for(let i=0;i<bodies.length;i++)if(!bodies[i].node._blockHoist)return bodies[i]}}else if(scope.path.isProgram())return this.getNextScopeAttachmentParent()}getNextScopeAttachmentParent(){const scope=this.scopes.pop();if(scope)return this.getAttachmentParentForPath(scope.path)}getAttachmentParentForPath(path){do{if(!path.parentPath||Array.isArray(path.container)&&path.isStatement())return path}while(path=path.parentPath)}hasOwnParamBindings(scope){for(const name of Object.keys(this.bindings)){if(!scope.hasOwnBinding(name))continue;const binding=this.bindings[name];if("param"===binding.kind&&binding.constant)return!0}return!1}run(){if(this.path.traverse(referenceVisitor,this),this.mutableBinding)return;this.getCompatibleScopes();const attachTo=this.getAttachmentPath();if(!attachTo)return;if(attachTo.getFunctionParent()===this.path.getFunctionParent())return;let uid=attachTo.scope.generateUidIdentifier("ref");const declarator=variableDeclarator(uid,this.path.node),insertFn=this.attachAfter?"insertAfter":"insertBefore",[attached]=attachTo[insertFn]([attachTo.isVariableDeclarator()?declarator:variableDeclaration("var",[declarator])]),parent=this.path.parentPath;return parent.isJSXElement()&&this.path.container===parent.node.children&&(uid=jsxExpressionContainer(uid)),this.path.replaceWith(cloneNode(uid)),attachTo.isVariableDeclarator()?attached.get("init"):attached.get("declarations.0.init")}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/removal-hooks.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hooks=void 0;exports.hooks=[function(self,parent){if("test"===self.key&&(parent.isWhile()||parent.isSwitchCase())||"declaration"===self.key&&parent.isExportDeclaration()||"body"===self.key&&parent.isLabeledStatement()||"declarations"===self.listKey&&parent.isVariableDeclaration()&&1===parent.node.declarations.length||"expression"===self.key&&parent.isExpressionStatement())return parent.remove(),!0},function(self,parent){if(parent.isSequenceExpression()&&1===parent.node.expressions.length)return parent.replaceWith(parent.node.expressions[0]),!0},function(self,parent){if(parent.isBinary())return"left"===self.key?parent.replaceWith(parent.node.right):parent.replaceWith(parent.node.left),!0},function(self,parent){if(parent.isIfStatement()&&"consequent"===self.key||"body"===self.key&&(parent.isLoop()||parent.isArrowFunctionExpression()))return self.replaceWith({type:"BlockStatement",body:[]}),!0}]},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types-validator.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isBindingIdentifier=function(){const{node,parent}=this,grandparent=this.parentPath.parent;return isIdentifier(node)&&isBinding(node,parent,grandparent)},exports.isBlockScoped=function(){return nodeIsBlockScoped(this.node)},exports.isExpression=function(){return this.isIdentifier()?this.isReferencedIdentifier():nodeIsExpression(this.node)},exports.isFlow=function(){const{node}=this;return!!nodeIsFlow(node)||(isImportDeclaration(node)?"type"===node.importKind||"typeof"===node.importKind:isExportDeclaration(node)?"type"===node.exportKind:!!isImportSpecifier(node)&&("type"===node.importKind||"typeof"===node.importKind))},exports.isForAwaitStatement=function(){return isForOfStatement(this.node,{await:!0})},exports.isGenerated=function(){return!this.isUser()},exports.isPure=function(constantsOnly){return this.scope.isPure(this.node,constantsOnly)},exports.isReferenced=function(){return nodeIsReferenced(this.node,this.parent)},exports.isReferencedIdentifier=function(opts){const{node,parent}=this;if(!isIdentifier(node,opts)&&!isJSXMemberExpression(parent,opts)){if(!isJSXIdentifier(node,opts))return!1;if(isCompatTag(node.name))return!1}return nodeIsReferenced(node,parent,this.parentPath.parent)},exports.isReferencedMemberExpression=function(){const{node,parent}=this;return isMemberExpression(node)&&nodeIsReferenced(node,parent)},exports.isRestProperty=function(){var _this$parentPath;return nodeIsRestElement(this.node)&&(null==(_this$parentPath=this.parentPath)?void 0:_this$parentPath.isObjectPattern())},exports.isScope=function(){return nodeIsScope(this.node,this.parent)},exports.isSpreadProperty=function(){var _this$parentPath2;return nodeIsRestElement(this.node)&&(null==(_this$parentPath2=this.parentPath)?void 0:_this$parentPath2.isObjectExpression())},exports.isStatement=function(){const{node,parent}=this;if(nodeIsStatement(node)){if(isVariableDeclaration(node)){if(isForXStatement(parent,{left:node}))return!1;if(isForStatement(parent,{init:node}))return!1}return!0}return!1},exports.isUser=function(){return this.node&&!!this.node.loc},exports.isVar=function(){return nodeIsVar(this.node)};var _t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{isBinding,isBlockScoped:nodeIsBlockScoped,isExportDeclaration,isExpression:nodeIsExpression,isFlow:nodeIsFlow,isForStatement,isForXStatement,isIdentifier,isImportDeclaration,isImportSpecifier,isJSXIdentifier,isJSXMemberExpression,isMemberExpression,isRestElement:nodeIsRestElement,isReferenced:nodeIsReferenced,isScope:nodeIsScope,isStatement:nodeIsStatement,isVar:nodeIsVar,isVariableDeclaration,react,isForOfStatement}=_t,{isCompatTag}=react;exports.isExistentialTypeParam=function(){throw new Error("`path.isExistentialTypeParam` has been renamed to `path.isExistsTypeAnnotation()` in Babel 7.")},exports.isNumericLiteralTypeAnnotation=function(){throw new Error("`path.isNumericLiteralTypeAnnotation()` has been renamed to `path.isNumberLiteralTypeAnnotation()` in Babel 7.")}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Var=exports.User=exports.Statement=exports.SpreadProperty=exports.Scope=exports.RestProperty=exports.ReferencedMemberExpression=exports.ReferencedIdentifier=exports.Referenced=exports.Pure=exports.NumericLiteralTypeAnnotation=exports.Generated=exports.ForAwaitStatement=exports.Flow=exports.Expression=exports.ExistentialTypeParam=exports.BlockScoped=exports.BindingIdentifier=void 0;exports.ReferencedIdentifier=["Identifier","JSXIdentifier"],exports.ReferencedMemberExpression=["MemberExpression"],exports.BindingIdentifier=["Identifier"],exports.Statement=["Statement"],exports.Expression=["Expression"],exports.Scope=["Scopable","Pattern"],exports.Referenced=null,exports.BlockScoped=null,exports.Var=["VariableDeclaration"],exports.User=null,exports.Generated=null,exports.Pure=null,exports.Flow=["Flow","ImportDeclaration","ExportDeclaration","ImportSpecifier"],exports.RestProperty=["RestElement"],exports.SpreadProperty=["RestElement"],exports.ExistentialTypeParam=["ExistsTypeAnnotation"],exports.NumericLiteralTypeAnnotation=["NumberLiteralTypeAnnotation"],exports.ForAwaitStatement=["ForOfStatement"]},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._containerInsert=_containerInsert,exports._containerInsertAfter=_containerInsertAfter,exports._containerInsertBefore=_containerInsertBefore,exports._verifyNodeList=_verifyNodeList,exports.insertAfter=function(nodes_){if(_removal._assertUnremoved.call(this),this.isSequenceExpression())return last(this.get("expressions")).insertAfter(nodes_);const nodes=_verifyNodeList.call(this,nodes_),{parentPath,parent}=this;if(parentPath.isExpressionStatement()||parentPath.isLabeledStatement()||isExportNamedDeclaration(parent)||parentPath.isExportDefaultDeclaration()&&this.isDeclaration())return parentPath.insertAfter(nodes.map((node=>isExpression(node)?expressionStatement(node):node)));if(this.isNodeType("Expression")&&!this.isJSXElement()&&!parentPath.isJSXElement()||parentPath.isForStatement()&&"init"===this.key){const self=this;if(self.node){const node=self.node;let{scope}=this;if(scope.path.isPattern())return assertExpression(node),self.replaceWith(callExpression(arrowFunctionExpression([],node),[])),self.get("callee.body").insertAfter(nodes),[self];if(isHiddenInSequenceExpression(self))nodes.unshift(node);else if(isCallExpression(node)&&isSuper(node.callee))nodes.unshift(node),nodes.push(thisExpression());else if(function(node,scope){if(!isAssignmentExpression(node)||!isIdentifier(node.left))return!1;const blockScope=scope.getBlockParent();return blockScope.hasOwnBinding(node.left.name)&&blockScope.getOwnBinding(node.left.name).constantViolations.length<=1}(node,scope))nodes.unshift(node),nodes.push(cloneNode(node.left));else if(scope.isPure(node,!0))nodes.push(node);else{parentPath.isMethod({computed:!0,key:node})&&(scope=scope.parent);const temp=scope.generateDeclaredUidIdentifier();nodes.unshift(expressionStatement(assignmentExpression("=",cloneNode(temp),node))),nodes.push(expressionStatement(cloneNode(temp)))}}return this.replaceExpressionWithStatements(nodes)}if(Array.isArray(this.container))return _containerInsertAfter.call(this,nodes);if(this.isStatementOrBlock()){const node=this.node,shouldInsertCurrentNode=node&&(!this.isExpressionStatement()||null!=node.expression);return this.replaceWith(blockStatement(shouldInsertCurrentNode?[node]:[])),this.pushContainer("body",nodes)}throw new Error("We don't know what to do with this node type. We were previously a Statement but we can't fit in here?")},exports.insertBefore=function(nodes_){_removal._assertUnremoved.call(this);const nodes=_verifyNodeList.call(this,nodes_),{parentPath,parent}=this;if(parentPath.isExpressionStatement()||parentPath.isLabeledStatement()||isExportNamedDeclaration(parent)||parentPath.isExportDefaultDeclaration()&&this.isDeclaration())return parentPath.insertBefore(nodes);if(this.isNodeType("Expression")&&!this.isJSXElement()||parentPath.isForStatement()&&"init"===this.key)return this.node&&nodes.push(this.node),this.replaceExpressionWithStatements(nodes);if(Array.isArray(this.container))return _containerInsertBefore.call(this,nodes);if(this.isStatementOrBlock()){const node=this.node,shouldInsertCurrentNode=node&&(!this.isExpressionStatement()||null!=node.expression);return this.replaceWith(blockStatement(shouldInsertCurrentNode?[node]:[])),this.unshiftContainer("body",nodes)}throw new Error("We don't know what to do with this node type. We were previously a Statement but we can't fit in here?")},exports.pushContainer=function(listKey,nodes){_removal._assertUnremoved.call(this);const verifiedNodes=_verifyNodeList.call(this,nodes),container=this.node[listKey];return _index.default.get({parentPath:this,parent:this.node,container,listKey,key:container.length}).setContext(this.context).replaceWithMultiple(verifiedNodes)},exports.unshiftContainer=function(listKey,nodes){_removal._assertUnremoved.call(this),nodes=_verifyNodeList.call(this,nodes);const path=_index.default.get({parentPath:this,parent:this.node,container:this.node[listKey],listKey,key:0}).setContext(this.context);return _containerInsertBefore.call(path,nodes)},exports.updateSiblingKeys=updateSiblingKeys;var _cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_hoister=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/hoister.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js"),_removal=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{arrowFunctionExpression,assertExpression,assignmentExpression,blockStatement,callExpression,cloneNode,expressionStatement,isAssignmentExpression,isCallExpression,isExportNamedDeclaration,isExpression,isIdentifier,isSequenceExpression,isSuper,thisExpression}=_t;function _containerInsert(from,nodes){updateSiblingKeys.call(this,from,nodes.length);const paths=[];this.container.splice(from,0,...nodes);for(let i=0;i<nodes.length;i++){var _this$context;const to=from+i,path=this.getSibling(to);paths.push(path),null!=(_this$context=this.context)&&_this$context.queue&&_context.pushContext.call(path,this.context)}const contexts=_context._getQueueContexts.call(this);for(const path of paths){_context.setScope.call(path),path.debug("Inserted.");for(const context of contexts)context.maybeQueue(path,!0)}return paths}function _containerInsertBefore(nodes){return _containerInsert.call(this,this.key,nodes)}function _containerInsertAfter(nodes){return _containerInsert.call(this,this.key+1,nodes)}const last=arr=>arr[arr.length-1];function isHiddenInSequenceExpression(path){return isSequenceExpression(path.parent)&&(last(path.parent.expressions)!==path.node||isHiddenInSequenceExpression(path.parentPath))}function updateSiblingKeys(fromIndex,incrementBy){if(!this.parent)return;const paths=(0,_cache.getCachedPaths)(this.hub,this.parent)||[];for(const[,path]of paths)"number"==typeof path.key&&path.container===this.container&&path.key>=fromIndex&&(path.key+=incrementBy)}function _verifyNodeList(nodes){if(!nodes)return[];Array.isArray(nodes)||(nodes=[nodes]);for(let i=0;i<nodes.length;i++){const node=nodes[i];let msg;if(node?"object"!=typeof node?msg="contains a non-object node":node.type?node instanceof _index.default&&(msg="has a NodePath when it expected a raw object"):msg="without a type":msg="has falsy node",msg){const type=Array.isArray(node)?"array":typeof node;throw new Error(`Node list ${msg} with the index of ${i} and type of ${type}`)}}return nodes}exports.hoist=function(scope=this.scope){return new _hoister.default(this,scope).run()}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/removal.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._assertUnremoved=_assertUnremoved,exports._callRemovalHooks=_callRemovalHooks,exports._markRemoved=_markRemoved,exports._remove=_remove,exports._removeFromScope=_removeFromScope,exports.remove=function(){var _this$opts;if(_assertUnremoved.call(this),_context.resync.call(this),_callRemovalHooks.call(this))return void _markRemoved.call(this);null!=(_this$opts=this.opts)&&_this$opts.noScope||_removeFromScope.call(this);this.shareCommentsWithSiblings(),_remove.call(this),_markRemoved.call(this)};var _removalHooks=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/removal-hooks.js"),_cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_replacement=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/replacement.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_modification=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{getBindingIdentifiers}=_t;function _removeFromScope(){const bindings=getBindingIdentifiers(this.node,!1,!1,!0);Object.keys(bindings).forEach((name=>this.scope.removeBinding(name)))}function _callRemovalHooks(){if(this.parentPath)for(const fn of _removalHooks.hooks)if(fn(this,this.parentPath))return!0}function _remove(){Array.isArray(this.container)?(this.container.splice(this.key,1),_modification.updateSiblingKeys.call(this,this.key,-1)):_replacement._replaceWith.call(this,null)}function _markRemoved(){this._traverseFlags|=_index.SHOULD_SKIP|_index.REMOVED,this.parent&&(0,_cache.getCachedPaths)(this.hub,this.parent).delete(this.node),this.node=null}function _assertUnremoved(){if(this.removed)throw this.buildCodeFrameError("NodePath has been removed so is read-only.")}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/replacement.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._replaceWith=_replaceWith,exports.replaceExpressionWithStatements=function(nodes){_context.resync.call(this);const declars=[],nodesAsSingleExpression=gatherSequenceExpressions(nodes,declars);if(nodesAsSingleExpression){for(const id of declars)this.scope.push({id});return this.replaceWith(nodesAsSingleExpression)[0].get("expressions")}const functionParent=this.getFunctionParent(),isParentAsync=null==functionParent?void 0:functionParent.node.async,isParentGenerator=null==functionParent?void 0:functionParent.node.generator,container=arrowFunctionExpression([],blockStatement(nodes));this.replaceWith(callExpression(container,[]));const callee=this.get("callee");callee.get("body").scope.hoistVariables((id=>this.scope.push({id})));const completionRecords=callee.getCompletionRecords();for(const path of completionRecords){if(!path.isExpressionStatement())continue;const loop=path.findParent((path=>path.isLoop()));if(loop){let uid=loop.getData("expressionReplacementReturnUid");uid?uid=identifier(uid.name):(uid=callee.scope.generateDeclaredUidIdentifier("ret"),callee.get("body").pushContainer("body",returnStatement(cloneNode(uid))),loop.setData("expressionReplacementReturnUid",uid)),path.get("expression").replaceWith(assignmentExpression("=",cloneNode(uid),path.node.expression))}else path.replaceWith(returnStatement(path.node.expression))}callee.arrowFunctionToExpression();const newCallee=callee,needToAwaitFunction=isParentAsync&&_index.default.hasType(this.get("callee.body").node,"AwaitExpression",FUNCTION_TYPES),needToYieldFunction=isParentGenerator&&_index.default.hasType(this.get("callee.body").node,"YieldExpression",FUNCTION_TYPES);needToAwaitFunction&&(newCallee.set("async",!0),needToYieldFunction||this.replaceWith(awaitExpression(this.node)));needToYieldFunction&&(newCallee.set("generator",!0),this.replaceWith(yieldExpression(this.node,!0)));return newCallee.get("body.body")},exports.replaceInline=function(nodes){if(_context.resync.call(this),Array.isArray(nodes)){if(Array.isArray(this.container)){nodes=_modification._verifyNodeList.call(this,nodes);const paths=_modification._containerInsertAfter.call(this,nodes);return this.remove(),paths}return this.replaceWithMultiple(nodes)}return this.replaceWith(nodes)},exports.replaceWith=function(replacementPath){if(_context.resync.call(this),this.removed)throw new Error("You can't replace this node, we've already removed it");let replacement=replacementPath instanceof _index2.default?replacementPath.node:replacementPath;if(!replacement)throw new Error("You passed `path.replaceWith()` a falsy node, use `path.remove()` instead");if(this.node===replacement)return[this];if(this.isProgram()&&!isProgram(replacement))throw new Error("You can only replace a Program root node with another Program node");if(Array.isArray(replacement))throw new Error("Don't use `path.replaceWith()` with an array of nodes, use `path.replaceWithMultiple()`");if("string"==typeof replacement)throw new Error("Don't use `path.replaceWith()` with a source string, use `path.replaceWithSourceString()`");let nodePath="";this.isNodeType("Statement")&&isExpression(replacement)&&(this.canHaveVariableDeclarationOrExpression()||this.canSwapBetweenExpressionAndStatement(replacement)||this.parentPath.isExportDefaultDeclaration()||(replacement=expressionStatement(replacement),nodePath="expression"));if(this.isNodeType("Expression")&&isStatement(replacement)&&!this.canHaveVariableDeclarationOrExpression()&&!this.canSwapBetweenExpressionAndStatement(replacement))return this.replaceExpressionWithStatements([replacement]);const oldNode=this.node;oldNode&&(inheritsComments(replacement,oldNode),removeComments(oldNode));return _replaceWith.call(this,replacement),this.type=replacement.type,_context.setScope.call(this),this.requeue(),[nodePath?this.get(nodePath):this]},exports.replaceWithMultiple=function(nodes){var _getCachedPaths;_context.resync.call(this),nodes=_modification._verifyNodeList.call(this,nodes),inheritLeadingComments(nodes[0],this.node),inheritTrailingComments(nodes[nodes.length-1],this.node),null==(_getCachedPaths=(0,_cache.getCachedPaths)(this.hub,this.parent))||_getCachedPaths.delete(this.node),this.node=this.container[this.key]=null;const paths=this.insertAfter(nodes);this.node?this.requeue():this.remove();return paths},exports.replaceWithSourceString=function(replacement){let ast;_context.resync.call(this);try{replacement=`(${replacement})`,ast=(0,_parser.parse)(replacement)}catch(err){const loc=err.loc;throw loc&&(err.message+=" - make sure this is an expression.\n"+(0,_codeFrame.codeFrameColumns)(replacement,{start:{line:loc.line,column:loc.column+1}}),err.code="BABEL_REPLACE_SOURCE_ERROR"),err}const expressionAST=ast.program.body[0].expression;return _index.default.removeProperties(expressionAST),this.replaceWith(expressionAST)};var _codeFrame=__webpack_require__("./stubs/babel-codeframe.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/index.js"),_cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_modification=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/modification.js"),_parser=__webpack_require__("./node_modules/.pnpm/@babel+parser@7.26.3/node_modules/@babel/parser/lib/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{FUNCTION_TYPES,arrowFunctionExpression,assignmentExpression,awaitExpression,blockStatement,buildUndefinedNode,callExpression,cloneNode,conditionalExpression,expressionStatement,getBindingIdentifiers,identifier,inheritLeadingComments,inheritTrailingComments,inheritsComments,isBlockStatement,isEmptyStatement,isExpression,isExpressionStatement,isIfStatement,isProgram,isStatement,isVariableDeclaration,removeComments,returnStatement,sequenceExpression,validate,yieldExpression}=_t;function _replaceWith(node){var _getCachedPaths2;if(!this.container)throw new ReferenceError("Container is falsy");this.inList?validate(this.parent,this.key,[node]):validate(this.parent,this.key,node),this.debug(`Replace with ${null==node?void 0:node.type}`),null==(_getCachedPaths2=(0,_cache.getCachedPaths)(this.hub,this.parent))||_getCachedPaths2.set(node,this).delete(this.node),this.node=this.container[this.key]=node}function gatherSequenceExpressions(nodes,declars){const exprs=[];let ensureLastUndefined=!0;for(const node of nodes)if(isEmptyStatement(node)||(ensureLastUndefined=!1),isExpression(node))exprs.push(node);else if(isExpressionStatement(node))exprs.push(node.expression);else if(isVariableDeclaration(node)){if("var"!==node.kind)return;for(const declar of node.declarations){const bindings=getBindingIdentifiers(declar);for(const key of Object.keys(bindings))declars.push(cloneNode(bindings[key]));declar.init&&exprs.push(assignmentExpression("=",declar.id,declar.init))}ensureLastUndefined=!0}else if(isIfStatement(node)){const consequent=node.consequent?gatherSequenceExpressions([node.consequent],declars):buildUndefinedNode(),alternate=node.alternate?gatherSequenceExpressions([node.alternate],declars):buildUndefinedNode();if(!consequent||!alternate)return;exprs.push(conditionalExpression(node.test,consequent,alternate))}else if(isBlockStatement(node)){const body=gatherSequenceExpressions(node.body,declars);if(!body)return;exprs.push(body)}else{if(!isEmptyStatement(node))return;0===nodes.indexOf(node)&&(ensureLastUndefined=!0)}return ensureLastUndefined&&exprs.push(buildUndefinedNode()),1===exprs.length?exprs[0]:sequenceExpression(exprs)}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/binding.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;exports.default=class{constructor({identifier,scope,path,kind}){this.identifier=void 0,this.scope=void 0,this.path=void 0,this.kind=void 0,this.constantViolations=[],this.constant=!0,this.referencePaths=[],this.referenced=!1,this.references=0,this.identifier=identifier,this.scope=scope,this.path=path,this.kind=kind,"var"!==kind&&"hoisted"!==kind||!function(path){for(let{parentPath,key}=path;parentPath;({parentPath,key}=parentPath)){if(parentPath.isFunctionParent())return!1;if(parentPath.isWhile()||parentPath.isForXStatement()||parentPath.isForStatement()&&"body"===key)return!0}return!1}(path)||this.reassign(path),this.clearValue()}deoptValue(){this.clearValue(),this.hasDeoptedValue=!0}setValue(value){this.hasDeoptedValue||(this.hasValue=!0,this.value=value)}clearValue(){this.hasDeoptedValue=!1,this.hasValue=!1,this.value=null}reassign(path){this.constant=!1,this.constantViolations.includes(path)||this.constantViolations.push(path)}reference(path){this.referencePaths.includes(path)||(this.referenced=!0,this.references++,this.referencePaths.push(path))}dereference(){this.references--,this.referenced=!!this.references}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _renamer=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/lib/renamer.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/index.js"),_binding=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/binding.js"),_globals=__webpack_require__("./node_modules/.pnpm/globals@11.12.0/node_modules/globals/index.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),t=_t,_cache=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/cache.js"),_visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js");const{NOT_LOCAL_BINDING,assignmentExpression,callExpression,cloneNode,getBindingIdentifiers,identifier,isArrayExpression,isBinary,isCallExpression,isClass,isClassBody,isClassDeclaration,isExportAllDeclaration,isExportDefaultDeclaration,isExportNamedDeclaration,isFunctionDeclaration,isIdentifier,isImportDeclaration,isLiteral,isMemberExpression,isMethod,isModuleSpecifier,isNullLiteral,isObjectExpression,isProperty,isPureish,isRegExpLiteral,isSuper,isTaggedTemplateExpression,isTemplateLiteral,isThisExpression,isUnaryExpression,isVariableDeclaration,expressionStatement,matchesPattern,memberExpression,numericLiteral,toIdentifier,variableDeclaration,variableDeclarator,isRecordExpression,isTupleExpression,isObjectProperty,isTopicReference,isMetaProperty,isPrivateName,isExportDeclaration,buildUndefinedNode,sequenceExpression}=_t;function gatherNodeParts(node,parts){switch(null==node?void 0:node.type){default:var _node$specifiers;if(isImportDeclaration(node)||isExportDeclaration(node))if((isExportAllDeclaration(node)||isExportNamedDeclaration(node)||isImportDeclaration(node))&&node.source)gatherNodeParts(node.source,parts);else if((isExportNamedDeclaration(node)||isImportDeclaration(node))&&null!=(_node$specifiers=node.specifiers)&&_node$specifiers.length)for(const e of node.specifiers)gatherNodeParts(e,parts);else(isExportDefaultDeclaration(node)||isExportNamedDeclaration(node))&&node.declaration&&gatherNodeParts(node.declaration,parts);else isModuleSpecifier(node)?gatherNodeParts(node.local,parts):!isLiteral(node)||isNullLiteral(node)||isRegExpLiteral(node)||isTemplateLiteral(node)||parts.push(node.value);break;case"MemberExpression":case"OptionalMemberExpression":case"JSXMemberExpression":gatherNodeParts(node.object,parts),gatherNodeParts(node.property,parts);break;case"Identifier":case"JSXIdentifier":parts.push(node.name);break;case"CallExpression":case"OptionalCallExpression":case"NewExpression":gatherNodeParts(node.callee,parts);break;case"ObjectExpression":case"ObjectPattern":for(const e of node.properties)gatherNodeParts(e,parts);break;case"SpreadElement":case"RestElement":case"UnaryExpression":case"UpdateExpression":gatherNodeParts(node.argument,parts);break;case"ObjectProperty":case"ObjectMethod":case"ClassProperty":case"ClassMethod":case"ClassPrivateProperty":case"ClassPrivateMethod":gatherNodeParts(node.key,parts);break;case"ThisExpression":parts.push("this");break;case"Super":parts.push("super");break;case"Import":parts.push("import");break;case"DoExpression":parts.push("do");break;case"YieldExpression":parts.push("yield"),gatherNodeParts(node.argument,parts);break;case"AwaitExpression":parts.push("await"),gatherNodeParts(node.argument,parts);break;case"AssignmentExpression":gatherNodeParts(node.left,parts);break;case"VariableDeclarator":case"FunctionExpression":case"FunctionDeclaration":case"ClassExpression":case"ClassDeclaration":case"PrivateName":gatherNodeParts(node.id,parts);break;case"ParenthesizedExpression":gatherNodeParts(node.expression,parts);break;case"MetaProperty":gatherNodeParts(node.meta,parts),gatherNodeParts(node.property,parts);break;case"JSXElement":gatherNodeParts(node.openingElement,parts);break;case"JSXOpeningElement":gatherNodeParts(node.name,parts);break;case"JSXFragment":gatherNodeParts(node.openingFragment,parts);break;case"JSXOpeningFragment":parts.push("Fragment");break;case"JSXNamespacedName":gatherNodeParts(node.namespace,parts),gatherNodeParts(node.name,parts)}}const collectorVisitor={ForStatement(path){const declar=path.get("init");if(declar.isVar()){const{scope}=path;(scope.getFunctionParent()||scope.getProgramParent()).registerBinding("var",declar)}},Declaration(path){if(path.isBlockScoped())return;if(path.isImportDeclaration())return;if(path.isExportDeclaration())return;(path.scope.getFunctionParent()||path.scope.getProgramParent()).registerDeclaration(path)},ImportDeclaration(path){path.scope.getBlockParent().registerDeclaration(path)},ReferencedIdentifier(path,state){state.references.push(path)},ForXStatement(path,state){const left=path.get("left");if(left.isPattern()||left.isIdentifier())state.constantViolations.push(path);else if(left.isVar()){const{scope}=path;(scope.getFunctionParent()||scope.getProgramParent()).registerBinding("var",left)}},ExportDeclaration:{exit(path){const{node,scope}=path;if(isExportAllDeclaration(node))return;const declar=node.declaration;if(isClassDeclaration(declar)||isFunctionDeclaration(declar)){const id=declar.id;if(!id)return;const binding=scope.getBinding(id.name);null==binding||binding.reference(path)}else if(isVariableDeclaration(declar))for(const decl of declar.declarations)for(const name of Object.keys(getBindingIdentifiers(decl))){const binding=scope.getBinding(name);null==binding||binding.reference(path)}}},LabeledStatement(path){path.scope.getBlockParent().registerDeclaration(path)},AssignmentExpression(path,state){state.assignments.push(path)},UpdateExpression(path,state){state.constantViolations.push(path)},UnaryExpression(path,state){"delete"===path.node.operator&&state.constantViolations.push(path)},BlockScoped(path){let scope=path.scope;scope.path===path&&(scope=scope.parent);if(scope.getBlockParent().registerDeclaration(path),path.isClassDeclaration()&&path.node.id){const name=path.node.id.name;path.scope.bindings[name]=path.scope.parent.getBinding(name)}},CatchClause(path){path.scope.registerBinding("let",path)},Function(path){const params=path.get("params");for(const param of params)path.scope.registerBinding("param",param);path.isFunctionExpression()&&path.node.id&&!path.node.id[NOT_LOCAL_BINDING]&&path.scope.registerBinding("local",path.get("id"),path)},ClassExpression(path){path.node.id&&!path.node.id[NOT_LOCAL_BINDING]&&path.scope.registerBinding("local",path.get("id"),path)},TSTypeAnnotation(path){path.skip()}};let uid=0;class Scope{constructor(path){this.uid=void 0,this.path=void 0,this.block=void 0,this.inited=void 0,this.labels=void 0,this.bindings=void 0,this.references=void 0,this.globals=void 0,this.uids=void 0,this.data=void 0,this.crawling=void 0;const{node}=path,cached=_cache.scope.get(node);if((null==cached?void 0:cached.path)===path)return cached;_cache.scope.set(node,this),this.uid=uid++,this.block=node,this.path=path,this.labels=new Map,this.inited=!1}get parent(){var _parent;let parent,path=this.path;do{var _path;const shouldSkip="key"===path.key||"decorators"===path.listKey;path=path.parentPath,shouldSkip&&path.isMethod()&&(path=path.parentPath),null!=(_path=path)&&_path.isScope()&&(parent=path)}while(path&&!parent);return null==(_parent=parent)?void 0:_parent.scope}generateDeclaredUidIdentifier(name){const id=this.generateUidIdentifier(name);return this.push({id}),cloneNode(id)}generateUidIdentifier(name){return identifier(this.generateUid(name))}generateUid(name="temp"){let uid;name=toIdentifier(name).replace(/^_+/,"").replace(/\d+$/g,"");let i=1;do{uid=`_${name}`,i>1&&(uid+=i),i++}while(this.hasLabel(uid)||this.hasBinding(uid)||this.hasGlobal(uid)||this.hasReference(uid));const program=this.getProgramParent();return program.references[uid]=!0,program.uids[uid]=!0,uid}generateUidBasedOnNode(node,defaultName){const parts=[];gatherNodeParts(node,parts);let id=parts.join("$");return id=id.replace(/^_/,"")||defaultName||"ref",this.generateUid(id.slice(0,20))}generateUidIdentifierBasedOnNode(node,defaultName){return identifier(this.generateUidBasedOnNode(node,defaultName))}isStatic(node){if(isThisExpression(node)||isSuper(node)||isTopicReference(node))return!0;if(isIdentifier(node)){const binding=this.getBinding(node.name);return binding?binding.constant:this.hasBinding(node.name)}return!1}maybeGenerateMemoised(node,dontPush){if(this.isStatic(node))return null;{const id=this.generateUidIdentifierBasedOnNode(node);return dontPush?id:(this.push({id}),cloneNode(id))}}checkBlockScopedCollisions(local,kind,name,id){if("param"===kind)return;if("local"===local.kind)return;if("let"===kind||"let"===local.kind||"const"===local.kind||"module"===local.kind||"param"===local.kind&&"const"===kind)throw this.path.hub.buildError(id,`Duplicate declaration "${name}"`,TypeError)}rename(oldName,newName){const binding=this.getBinding(oldName);if(binding){newName||(newName=this.generateUidIdentifier(oldName).name);new _renamer.default(binding,oldName,newName).rename(arguments[2])}}dump(){const sep="-".repeat(60);console.log(sep);let scope=this;do{console.log("#",scope.block.type);for(const name of Object.keys(scope.bindings)){const binding=scope.bindings[name];console.log(" -",name,{constant:binding.constant,references:binding.references,violations:binding.constantViolations.length,kind:binding.kind})}}while(scope=scope.parent);console.log(sep)}hasLabel(name){return!!this.getLabel(name)}getLabel(name){return this.labels.get(name)}registerLabel(path){this.labels.set(path.node.label.name,path)}registerDeclaration(path){if(path.isLabeledStatement())this.registerLabel(path);else if(path.isFunctionDeclaration())this.registerBinding("hoisted",path.get("id"),path);else if(path.isVariableDeclaration()){const declarations=path.get("declarations"),{kind}=path.node;for(const declar of declarations)this.registerBinding("using"===kind||"await using"===kind?"const":kind,declar)}else if(path.isClassDeclaration()){if(path.node.declare)return;this.registerBinding("let",path)}else if(path.isImportDeclaration()){const isTypeDeclaration="type"===path.node.importKind||"typeof"===path.node.importKind,specifiers=path.get("specifiers");for(const specifier of specifiers){const isTypeSpecifier=isTypeDeclaration||specifier.isImportSpecifier()&&("type"===specifier.node.importKind||"typeof"===specifier.node.importKind);this.registerBinding(isTypeSpecifier?"unknown":"module",specifier)}}else if(path.isExportDeclaration()){const declar=path.get("declaration");(declar.isClassDeclaration()||declar.isFunctionDeclaration()||declar.isVariableDeclaration())&&this.registerDeclaration(declar)}else this.registerBinding("unknown",path)}buildUndefinedNode(){return buildUndefinedNode()}registerConstantViolation(path){const ids=path.getAssignmentIdentifiers();for(const name of Object.keys(ids)){var _this$getBinding;null==(_this$getBinding=this.getBinding(name))||_this$getBinding.reassign(path)}}registerBinding(kind,path,bindingPath=path){if(!kind)throw new ReferenceError("no `kind`");if(path.isVariableDeclaration()){const declarators=path.get("declarations");for(const declar of declarators)this.registerBinding(kind,declar);return}const parent=this.getProgramParent(),ids=path.getOuterBindingIdentifiers(!0);for(const name of Object.keys(ids)){parent.references[name]=!0;for(const id of ids[name]){const local=this.getOwnBinding(name);if(local){if(local.identifier===id)continue;this.checkBlockScopedCollisions(local,kind,name,id)}local?local.reassign(bindingPath):this.bindings[name]=new _binding.default({identifier:id,scope:this,path:bindingPath,kind})}}}addGlobal(node){this.globals[node.name]=node}hasUid(name){let scope=this;do{if(scope.uids[name])return!0}while(scope=scope.parent);return!1}hasGlobal(name){let scope=this;do{if(scope.globals[name])return!0}while(scope=scope.parent);return!1}hasReference(name){return!!this.getProgramParent().references[name]}isPure(node,constantsOnly){if(isIdentifier(node)){const binding=this.getBinding(node.name);return!!binding&&(!constantsOnly||binding.constant)}if(isThisExpression(node)||isMetaProperty(node)||isTopicReference(node)||isPrivateName(node))return!0;var _node$decorators,_node$decorators2,_node$decorators3;if(isClass(node))return!(node.superClass&&!this.isPure(node.superClass,constantsOnly))&&(!((null==(_node$decorators=node.decorators)?void 0:_node$decorators.length)>0)&&this.isPure(node.body,constantsOnly));if(isClassBody(node)){for(const method of node.body)if(!this.isPure(method,constantsOnly))return!1;return!0}if(isBinary(node))return this.isPure(node.left,constantsOnly)&&this.isPure(node.right,constantsOnly);if(isArrayExpression(node)||isTupleExpression(node)){for(const elem of node.elements)if(null!==elem&&!this.isPure(elem,constantsOnly))return!1;return!0}if(isObjectExpression(node)||isRecordExpression(node)){for(const prop of node.properties)if(!this.isPure(prop,constantsOnly))return!1;return!0}if(isMethod(node))return!(node.computed&&!this.isPure(node.key,constantsOnly))&&!((null==(_node$decorators2=node.decorators)?void 0:_node$decorators2.length)>0);if(isProperty(node))return!(node.computed&&!this.isPure(node.key,constantsOnly))&&(!((null==(_node$decorators3=node.decorators)?void 0:_node$decorators3.length)>0)&&!((isObjectProperty(node)||node.static)&&null!==node.value&&!this.isPure(node.value,constantsOnly)));if(isUnaryExpression(node))return this.isPure(node.argument,constantsOnly);if(isTemplateLiteral(node)){for(const expression of node.expressions)if(!this.isPure(expression,constantsOnly))return!1;return!0}return isTaggedTemplateExpression(node)?matchesPattern(node.tag,"String.raw")&&!this.hasBinding("String",{noGlobals:!0})&&this.isPure(node.quasi,constantsOnly):isMemberExpression(node)?!node.computed&&isIdentifier(node.object)&&"Symbol"===node.object.name&&isIdentifier(node.property)&&"for"!==node.property.name&&!this.hasBinding("Symbol",{noGlobals:!0}):isCallExpression(node)?matchesPattern(node.callee,"Symbol.for")&&!this.hasBinding("Symbol",{noGlobals:!0})&&1===node.arguments.length&&t.isStringLiteral(node.arguments[0]):isPureish(node)}setData(key,val){return this.data[key]=val}getData(key){let scope=this;do{const data=scope.data[key];if(null!=data)return data}while(scope=scope.parent)}removeData(key){let scope=this;do{null!=scope.data[key]&&(scope.data[key]=null)}while(scope=scope.parent)}init(){this.inited||(this.inited=!0,this.crawl())}crawl(){const path=this.path;this.references=Object.create(null),this.bindings=Object.create(null),this.globals=Object.create(null),this.uids=Object.create(null),this.data=Object.create(null);let scope=this;do{if(scope.crawling)return;if(scope.path.isProgram())break}while(scope=scope.parent);const programParent=scope,state={references:[],constantViolations:[],assignments:[]};if(this.crawling=!0,"Program"!==path.type&&(0,_visitors.isExplodedVisitor)(collectorVisitor)){for(const visit of collectorVisitor.enter)visit.call(state,path,state);const typeVisitors=collectorVisitor[path.type];if(typeVisitors)for(const visit of typeVisitors.enter)visit.call(state,path,state)}path.traverse(collectorVisitor,state),this.crawling=!1;for(const path of state.assignments){const ids=path.getAssignmentIdentifiers();for(const name of Object.keys(ids))path.scope.getBinding(name)||programParent.addGlobal(ids[name]);path.scope.registerConstantViolation(path)}for(const ref of state.references){const binding=ref.scope.getBinding(ref.node.name);binding?binding.reference(ref):programParent.addGlobal(ref.node)}for(const path of state.constantViolations)path.scope.registerConstantViolation(path)}push(opts){let path=this.path;path.isPattern()?path=this.getPatternParent().path:path.isBlockStatement()||path.isProgram()||(path=this.getBlockParent().path),path.isSwitchStatement()&&(path=(this.getFunctionParent()||this.getProgramParent()).path);const{init,unique,kind="var",id}=opts;if(!init&&!unique&&("var"===kind||"let"===kind)&&path.isFunction()&&!path.node.name&&isCallExpression(path.parent,{callee:path.node})&&path.parent.arguments.length<=path.node.params.length&&isIdentifier(id))return path.pushContainer("params",id),void path.scope.registerBinding("param",path.get("params")[path.node.params.length-1]);(path.isLoop()||path.isCatchClause()||path.isFunction())&&(path.ensureBlock(),path=path.get("body"));const blockHoist=null==opts._blockHoist?2:opts._blockHoist,dataKey=`declaration:${kind}:${blockHoist}`;let declarPath=!unique&&path.getData(dataKey);if(!declarPath){const declar=variableDeclaration(kind,[]);declar._blockHoist=blockHoist,[declarPath]=path.unshiftContainer("body",[declar]),unique||path.setData(dataKey,declarPath)}const declarator=variableDeclarator(id,init),len=declarPath.node.declarations.push(declarator);path.scope.registerBinding(kind,declarPath.get("declarations")[len-1])}getProgramParent(){let scope=this;do{if(scope.path.isProgram())return scope}while(scope=scope.parent);throw new Error("Couldn't find a Program")}getFunctionParent(){let scope=this;do{if(scope.path.isFunctionParent())return scope}while(scope=scope.parent);return null}getBlockParent(){let scope=this;do{if(scope.path.isBlockParent())return scope}while(scope=scope.parent);throw new Error("We couldn't find a BlockStatement, For, Switch, Function, Loop or Program...")}getPatternParent(){let scope=this;do{if(!scope.path.isPattern())return scope.getBlockParent()}while(scope=scope.parent.parent);throw new Error("We couldn't find a BlockStatement, For, Switch, Function, Loop or Program...")}getAllBindings(){const ids=Object.create(null);let scope=this;do{for(const key of Object.keys(scope.bindings))key in ids==!1&&(ids[key]=scope.bindings[key]);scope=scope.parent}while(scope);return ids}bindingIdentifierEquals(name,node){return this.getBindingIdentifier(name)===node}getBinding(name){let previousPath,scope=this;do{const binding=scope.getOwnBinding(name);var _previousPath;if(binding){if(null==(_previousPath=previousPath)||!_previousPath.isPattern()||"param"===binding.kind||"local"===binding.kind)return binding}else if(!binding&&"arguments"===name&&scope.path.isFunction()&&!scope.path.isArrowFunctionExpression())break;previousPath=scope.path}while(scope=scope.parent)}getOwnBinding(name){return this.bindings[name]}getBindingIdentifier(name){var _this$getBinding2;return null==(_this$getBinding2=this.getBinding(name))?void 0:_this$getBinding2.identifier}getOwnBindingIdentifier(name){const binding=this.bindings[name];return null==binding?void 0:binding.identifier}hasOwnBinding(name){return!!this.getOwnBinding(name)}hasBinding(name,opts){if(!name)return!1;let noGlobals,noUids,scope=this;do{if(scope.hasOwnBinding(name))return!0}while(scope=scope.parent);return"object"==typeof opts?(noGlobals=opts.noGlobals,noUids=opts.noUids):"boolean"==typeof opts&&(noGlobals=opts),!(noUids||!this.hasUid(name))||(!(noGlobals||!Scope.globals.includes(name))||!(noGlobals||!Scope.contextVariables.includes(name)))}parentHasBinding(name,opts){var _this$parent;return null==(_this$parent=this.parent)?void 0:_this$parent.hasBinding(name,opts)}moveBindingTo(name,scope){const info=this.getBinding(name);info&&(info.scope.removeOwnBinding(name),info.scope=scope,scope.bindings[name]=info)}removeOwnBinding(name){delete this.bindings[name]}removeBinding(name){var _this$getBinding3;null==(_this$getBinding3=this.getBinding(name))||_this$getBinding3.scope.removeOwnBinding(name);let scope=this;do{scope.uids[name]&&(scope.uids[name]=!1)}while(scope=scope.parent)}hoistVariables(emit=id=>this.push({id})){this.crawl();const seen=new Set;for(const name of Object.keys(this.bindings)){const binding=this.bindings[name];if(!binding)continue;const{path}=binding;if(!path.isVariableDeclarator())continue;const{parent,parentPath}=path;if("var"!==parent.kind||seen.has(parent))continue;let firstId;seen.add(path.parent);const init=[];for(const decl of parent.declarations){null!=firstId||(firstId=decl.id),decl.init&&init.push(assignmentExpression("=",decl.id,decl.init));const ids=Object.keys(getBindingIdentifiers(decl,!1,!0,!0));for(const name of ids)emit(identifier(name),null!=decl.init)}if(parentPath.parentPath.isFor({left:parent}))parentPath.replaceWith(firstId);else if(0===init.length)parentPath.remove();else{const expr=1===init.length?init[0]:sequenceExpression(init);parentPath.parentPath.isForStatement({init:parent})?parentPath.replaceWith(expr):parentPath.replaceWith(expressionStatement(expr))}}}}exports.default=Scope,Scope.globals=Object.keys(_globals.builtin),Scope.contextVariables=["arguments","undefined","Infinity","NaN"],Scope.prototype._renameFromMap=function(map,oldName,newName,value){map[oldName]&&(map[newName]=value,map[oldName]=null)},Scope.prototype.traverse=function(node,opts,state){(0,_index.default)(node,opts,this,state,this.path)},Scope.prototype._generateUid=function(name,i){let id=name;return i>1&&(id+=i),`_${id}`},Scope.prototype.toArray=function(node,i,arrayLikeIsIterable){if(isIdentifier(node)){const binding=this.getBinding(node.name);if(null!=binding&&binding.constant&&binding.path.isGenericType("Array"))return node}if(isArrayExpression(node))return node;if(isIdentifier(node,{name:"arguments"}))return callExpression(memberExpression(memberExpression(memberExpression(identifier("Array"),identifier("prototype")),identifier("slice")),identifier("call")),[node]);let helperName;const args=[node];return!0===i?helperName="toConsumableArray":"number"==typeof i?(args.push(numericLiteral(i)),helperName="slicedToArray"):helperName="toArray",arrayLikeIsIterable&&(args.unshift(this.path.hub.addHelper(helperName)),helperName="maybeArrayLike"),callExpression(this.path.hub.addHelper(helperName),args)},Scope.prototype.getAllBindingsOfKind=function(...kinds){const ids=Object.create(null);for(const kind of kinds){let scope=this;do{for(const name of Object.keys(scope.bindings)){const binding=scope.bindings[name];binding.kind===kind&&(ids[name]=binding)}scope=scope.parent}while(scope)}return ids},Object.defineProperties(Scope.prototype,{parentBlock:{configurable:!0,enumerable:!0,get(){return this.path.parent}},hub:{configurable:!0,enumerable:!0,get(){return this.path.hub}}})},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/scope/lib/renamer.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_t=t,_traverseNode=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js"),_visitors=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{getAssignmentIdentifiers}=_t,renameVisitor={ReferencedIdentifier({node},state){node.name===state.oldName&&(node.name=state.newName)},Scope(path,state){path.scope.bindingIdentifierEquals(state.oldName,state.binding.identifier)||(path.skip(),path.isMethod()&&(path.requeueComputedKeyAndDecorators?path.requeueComputedKeyAndDecorators():_context.requeueComputedKeyAndDecorators.call(path)))},ObjectProperty({node,scope},state){const{name}=node.key;var _node$extra;!node.shorthand||name!==state.oldName&&name!==state.newName||scope.getBindingIdentifier(name)!==state.binding.identifier||(node.shorthand=!1,null!=(_node$extra=node.extra)&&_node$extra.shorthand&&(node.extra.shorthand=!1))},"AssignmentExpression|Declaration|VariableDeclarator"(path,state){if(path.isVariableDeclaration())return;const ids=path.isAssignmentExpression()?getAssignmentIdentifiers(path.node):path.getOuterBindingIdentifiers();for(const name in ids)name===state.oldName&&(ids[name].name=state.newName)}};exports.default=class{constructor(binding,oldName,newName){this.newName=newName,this.oldName=oldName,this.binding=binding}maybeConvertFromExportDeclaration(parentDeclar){const maybeExportDeclar=parentDeclar.parentPath;if(maybeExportDeclar.isExportDeclaration()){if(maybeExportDeclar.isExportDefaultDeclaration()){const{declaration}=maybeExportDeclar.node;if(t.isDeclaration(declaration)&&!declaration.id)return}maybeExportDeclar.isExportAllDeclaration()||maybeExportDeclar.splitExportDeclaration()}}maybeConvertFromClassFunctionDeclaration(path){return path}maybeConvertFromClassFunctionExpression(path){return path}rename(){const{binding,oldName,newName}=this,{scope,path}=binding,parentDeclar=path.find((path=>path.isDeclaration()||path.isFunctionExpression()||path.isClassExpression()));if(parentDeclar){parentDeclar.getOuterBindingIdentifiers()[oldName]===binding.identifier&&this.maybeConvertFromExportDeclaration(parentDeclar)}const blockToTraverse=arguments[0]||scope.block,skipKeys={discriminant:!0};t.isMethod(blockToTraverse)&&(blockToTraverse.computed&&(skipKeys.key=!0),t.isObjectMethod(blockToTraverse)||(skipKeys.decorators=!0)),(0,_traverseNode.traverseNode)(blockToTraverse,(0,_visitors.explode)(renameVisitor),scope,this,scope.path,skipKeys),arguments[0]||(scope.removeOwnBinding(oldName),scope.bindings[newName]=binding,this.binding.identifier.name=newName),parentDeclar&&(this.maybeConvertFromClassFunctionDeclaration(path),this.maybeConvertFromClassFunctionExpression(path))}}},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/traverse-node.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.traverseNode=function(node,opts,scope,state,path,skipKeys,visitSelf){const keys=VISITOR_KEYS[node.type];if(!keys)return!1;const context=new _context.default(scope,opts,state,path);if(visitSelf)return(null==skipKeys||!skipKeys[path.parentKey])&&context.visitQueue([path]);for(const key of keys)if((null==skipKeys||!skipKeys[key])&&context.visit(node,key))return!0;return!1};var _context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/context.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js");const{VISITOR_KEYS}=_t},"./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/visitors.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.environmentVisitor=function(visitor){return merge([_environmentVisitor,visitor])},exports.explode=explode$1,exports.isExplodedVisitor=isExplodedVisitor,exports.merge=merge,exports.verify=verify$1;var virtualTypes=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types.js"),virtualTypesValidators=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/lib/virtual-types-validator.js"),_t=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js"),_context=__webpack_require__("./node_modules/.pnpm/@babel+traverse@7.26.4/node_modules/@babel/traverse/lib/path/context.js");const{DEPRECATED_KEYS,DEPRECATED_ALIASES,FLIPPED_ALIAS_KEYS,TYPES,__internal__deprecationWarning:deprecationWarning}=_t;function isExplodedVisitor(visitor){return null==visitor?void 0:visitor._exploded}function explode$1(visitor){if(isExplodedVisitor(visitor))return visitor;visitor._exploded=!0;for(const nodeType of Object.keys(visitor)){if(shouldIgnoreKey(nodeType))continue;const parts=nodeType.split("|");if(1===parts.length)continue;const fns=visitor[nodeType];delete visitor[nodeType];for(const part of parts)visitor[part]=fns}verify$1(visitor),delete visitor.__esModule,function(obj){for(const key of Object.keys(obj)){if(shouldIgnoreKey(key))continue;const fns=obj[key];"function"==typeof fns&&(obj[key]={enter:fns})}}(visitor),ensureCallbackArrays(visitor);for(const nodeType of Object.keys(visitor)){if(shouldIgnoreKey(nodeType))continue;if(!(nodeType in virtualTypes))continue;const fns=visitor[nodeType];for(const type of Object.keys(fns))fns[type]=wrapCheck(nodeType,fns[type]);delete visitor[nodeType];const types=virtualTypes[nodeType];if(null!==types)for(const type of types)visitor[type]?mergePair(visitor[type],fns):visitor[type]=fns;else mergePair(visitor,fns)}for(const nodeType of Object.keys(visitor)){if(shouldIgnoreKey(nodeType))continue;let aliases=FLIPPED_ALIAS_KEYS[nodeType];if(nodeType in DEPRECATED_KEYS){const deprecatedKey=DEPRECATED_KEYS[nodeType];deprecationWarning(nodeType,deprecatedKey,"Visitor "),aliases=[deprecatedKey]}else if(nodeType in DEPRECATED_ALIASES){const deprecatedAlias=DEPRECATED_ALIASES[nodeType];deprecationWarning(nodeType,deprecatedAlias,"Visitor "),aliases=FLIPPED_ALIAS_KEYS[deprecatedAlias]}if(!aliases)continue;const fns=visitor[nodeType];delete visitor[nodeType];for(const alias of aliases){const existing=visitor[alias];existing?mergePair(existing,fns):visitor[alias]=Object.assign({},fns)}}for(const nodeType of Object.keys(visitor))shouldIgnoreKey(nodeType)||ensureCallbackArrays(visitor[nodeType]);return visitor}function verify$1(visitor){if(!visitor._verified){if("function"==typeof visitor)throw new Error("You passed `traverse()` a function when it expected a visitor object, are you sure you didn't mean `{ enter: Function }`?");for(const nodeType of Object.keys(visitor)){if("enter"!==nodeType&&"exit"!==nodeType||validateVisitorMethods(nodeType,visitor[nodeType]),shouldIgnoreKey(nodeType))continue;if(!TYPES.includes(nodeType))throw new Error(`You gave us a visitor for the node type ${nodeType} but it's not a valid type in @babel/traverse 7.26.4`);const visitors=visitor[nodeType];if("object"==typeof visitors)for(const visitorKey of Object.keys(visitors)){if("enter"!==visitorKey&&"exit"!==visitorKey)throw new Error(`You passed \`traverse()\` a visitor object with the property ${nodeType} that has the invalid property ${visitorKey}`);validateVisitorMethods(`${nodeType}.${visitorKey}`,visitors[visitorKey])}}visitor._verified=!0}}function validateVisitorMethods(path,val){const fns=[].concat(val);for(const fn of fns)if("function"!=typeof fn)throw new TypeError(`Non-function found defined in ${path} with type ${typeof fn}`)}function merge(visitors,states=[],wrapper){const mergedVisitor={_verified:!0,_exploded:!0};Object.defineProperty(mergedVisitor,"_exploded",{enumerable:!1}),Object.defineProperty(mergedVisitor,"_verified",{enumerable:!1});for(let i=0;i<visitors.length;i++){const visitor=explode$1(visitors[i]),state=states[i];let topVisitor=visitor;(state||wrapper)&&(topVisitor=wrapWithStateOrWrapper(topVisitor,state,wrapper)),mergePair(mergedVisitor,topVisitor);for(const key of Object.keys(visitor)){if(shouldIgnoreKey(key))continue;let typeVisitor=visitor[key];(state||wrapper)&&(typeVisitor=wrapWithStateOrWrapper(typeVisitor,state,wrapper));mergePair(mergedVisitor[key]||(mergedVisitor[key]={}),typeVisitor)}}return mergedVisitor}function wrapWithStateOrWrapper(oldVisitor,state,wrapper){const newVisitor={};for(const phase of["enter","exit"]){let fns=oldVisitor[phase];Array.isArray(fns)&&(fns=fns.map((function(fn){let newFn=fn;return state&&(newFn=function(path){fn.call(state,path,state)}),wrapper&&(newFn=wrapper(null==state?void 0:state.key,phase,newFn)),newFn!==fn&&(newFn.toString=()=>fn.toString()),newFn})),newVisitor[phase]=fns)}return newVisitor}function ensureCallbackArrays(obj){obj.enter&&!Array.isArray(obj.enter)&&(obj.enter=[obj.enter]),obj.exit&&!Array.isArray(obj.exit)&&(obj.exit=[obj.exit])}function wrapCheck(nodeType,fn){const validator=virtualTypesValidators[`is${nodeType}`],newFn=function(path){if(validator.call(path))return fn.apply(this,arguments)};return newFn.toString=()=>fn.toString(),newFn}function shouldIgnoreKey(key){return"_"===key[0]||("enter"===key||"exit"===key||"shouldSkip"===key||("denylist"===key||"noScope"===key||"skipKeys"===key||"blacklist"===key))}function mergePair(dest,src){for(const phase of["enter","exit"])src[phase]&&(dest[phase]=[].concat(dest[phase]||[],src[phase]))}const _environmentVisitor={FunctionParent(path){path.isArrowFunctionExpression()||(path.skip(),path.isMethod()&&(path.requeueComputedKeyAndDecorators?path.requeueComputedKeyAndDecorators():_context.requeueComputedKeyAndDecorators.call(path)))},Property(path){path.isObjectProperty()||(path.skip(),path.requeueComputedKeyAndDecorators?path.requeueComputedKeyAndDecorators():_context.requeueComputedKeyAndDecorators.call(path))}}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/assertNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){if(!(0,_isNode.default)(node)){var _node$type;const type=null!=(_node$type=null==node?void 0:node.type)?_node$type:JSON.stringify(node);throw new TypeError(`Not a valid node of type "${type}"`)}};var _isNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertAccessor=function(node,opts){assert("Accessor",node,opts)},exports.assertAnyTypeAnnotation=function(node,opts){assert("AnyTypeAnnotation",node,opts)},exports.assertArgumentPlaceholder=function(node,opts){assert("ArgumentPlaceholder",node,opts)},exports.assertArrayExpression=function(node,opts){assert("ArrayExpression",node,opts)},exports.assertArrayPattern=function(node,opts){assert("ArrayPattern",node,opts)},exports.assertArrayTypeAnnotation=function(node,opts){assert("ArrayTypeAnnotation",node,opts)},exports.assertArrowFunctionExpression=function(node,opts){assert("ArrowFunctionExpression",node,opts)},exports.assertAssignmentExpression=function(node,opts){assert("AssignmentExpression",node,opts)},exports.assertAssignmentPattern=function(node,opts){assert("AssignmentPattern",node,opts)},exports.assertAwaitExpression=function(node,opts){assert("AwaitExpression",node,opts)},exports.assertBigIntLiteral=function(node,opts){assert("BigIntLiteral",node,opts)},exports.assertBinary=function(node,opts){assert("Binary",node,opts)},exports.assertBinaryExpression=function(node,opts){assert("BinaryExpression",node,opts)},exports.assertBindExpression=function(node,opts){assert("BindExpression",node,opts)},exports.assertBlock=function(node,opts){assert("Block",node,opts)},exports.assertBlockParent=function(node,opts){assert("BlockParent",node,opts)},exports.assertBlockStatement=function(node,opts){assert("BlockStatement",node,opts)},exports.assertBooleanLiteral=function(node,opts){assert("BooleanLiteral",node,opts)},exports.assertBooleanLiteralTypeAnnotation=function(node,opts){assert("BooleanLiteralTypeAnnotation",node,opts)},exports.assertBooleanTypeAnnotation=function(node,opts){assert("BooleanTypeAnnotation",node,opts)},exports.assertBreakStatement=function(node,opts){assert("BreakStatement",node,opts)},exports.assertCallExpression=function(node,opts){assert("CallExpression",node,opts)},exports.assertCatchClause=function(node,opts){assert("CatchClause",node,opts)},exports.assertClass=function(node,opts){assert("Class",node,opts)},exports.assertClassAccessorProperty=function(node,opts){assert("ClassAccessorProperty",node,opts)},exports.assertClassBody=function(node,opts){assert("ClassBody",node,opts)},exports.assertClassDeclaration=function(node,opts){assert("ClassDeclaration",node,opts)},exports.assertClassExpression=function(node,opts){assert("ClassExpression",node,opts)},exports.assertClassImplements=function(node,opts){assert("ClassImplements",node,opts)},exports.assertClassMethod=function(node,opts){assert("ClassMethod",node,opts)},exports.assertClassPrivateMethod=function(node,opts){assert("ClassPrivateMethod",node,opts)},exports.assertClassPrivateProperty=function(node,opts){assert("ClassPrivateProperty",node,opts)},exports.assertClassProperty=function(node,opts){assert("ClassProperty",node,opts)},exports.assertCompletionStatement=function(node,opts){assert("CompletionStatement",node,opts)},exports.assertConditional=function(node,opts){assert("Conditional",node,opts)},exports.assertConditionalExpression=function(node,opts){assert("ConditionalExpression",node,opts)},exports.assertContinueStatement=function(node,opts){assert("ContinueStatement",node,opts)},exports.assertDebuggerStatement=function(node,opts){assert("DebuggerStatement",node,opts)},exports.assertDecimalLiteral=function(node,opts){assert("DecimalLiteral",node,opts)},exports.assertDeclaration=function(node,opts){assert("Declaration",node,opts)},exports.assertDeclareClass=function(node,opts){assert("DeclareClass",node,opts)},exports.assertDeclareExportAllDeclaration=function(node,opts){assert("DeclareExportAllDeclaration",node,opts)},exports.assertDeclareExportDeclaration=function(node,opts){assert("DeclareExportDeclaration",node,opts)},exports.assertDeclareFunction=function(node,opts){assert("DeclareFunction",node,opts)},exports.assertDeclareInterface=function(node,opts){assert("DeclareInterface",node,opts)},exports.assertDeclareModule=function(node,opts){assert("DeclareModule",node,opts)},exports.assertDeclareModuleExports=function(node,opts){assert("DeclareModuleExports",node,opts)},exports.assertDeclareOpaqueType=function(node,opts){assert("DeclareOpaqueType",node,opts)},exports.assertDeclareTypeAlias=function(node,opts){assert("DeclareTypeAlias",node,opts)},exports.assertDeclareVariable=function(node,opts){assert("DeclareVariable",node,opts)},exports.assertDeclaredPredicate=function(node,opts){assert("DeclaredPredicate",node,opts)},exports.assertDecorator=function(node,opts){assert("Decorator",node,opts)},exports.assertDirective=function(node,opts){assert("Directive",node,opts)},exports.assertDirectiveLiteral=function(node,opts){assert("DirectiveLiteral",node,opts)},exports.assertDoExpression=function(node,opts){assert("DoExpression",node,opts)},exports.assertDoWhileStatement=function(node,opts){assert("DoWhileStatement",node,opts)},exports.assertEmptyStatement=function(node,opts){assert("EmptyStatement",node,opts)},exports.assertEmptyTypeAnnotation=function(node,opts){assert("EmptyTypeAnnotation",node,opts)},exports.assertEnumBody=function(node,opts){assert("EnumBody",node,opts)},exports.assertEnumBooleanBody=function(node,opts){assert("EnumBooleanBody",node,opts)},exports.assertEnumBooleanMember=function(node,opts){assert("EnumBooleanMember",node,opts)},exports.assertEnumDeclaration=function(node,opts){assert("EnumDeclaration",node,opts)},exports.assertEnumDefaultedMember=function(node,opts){assert("EnumDefaultedMember",node,opts)},exports.assertEnumMember=function(node,opts){assert("EnumMember",node,opts)},exports.assertEnumNumberBody=function(node,opts){assert("EnumNumberBody",node,opts)},exports.assertEnumNumberMember=function(node,opts){assert("EnumNumberMember",node,opts)},exports.assertEnumStringBody=function(node,opts){assert("EnumStringBody",node,opts)},exports.assertEnumStringMember=function(node,opts){assert("EnumStringMember",node,opts)},exports.assertEnumSymbolBody=function(node,opts){assert("EnumSymbolBody",node,opts)},exports.assertExistsTypeAnnotation=function(node,opts){assert("ExistsTypeAnnotation",node,opts)},exports.assertExportAllDeclaration=function(node,opts){assert("ExportAllDeclaration",node,opts)},exports.assertExportDeclaration=function(node,opts){assert("ExportDeclaration",node,opts)},exports.assertExportDefaultDeclaration=function(node,opts){assert("ExportDefaultDeclaration",node,opts)},exports.assertExportDefaultSpecifier=function(node,opts){assert("ExportDefaultSpecifier",node,opts)},exports.assertExportNamedDeclaration=function(node,opts){assert("ExportNamedDeclaration",node,opts)},exports.assertExportNamespaceSpecifier=function(node,opts){assert("ExportNamespaceSpecifier",node,opts)},exports.assertExportSpecifier=function(node,opts){assert("ExportSpecifier",node,opts)},exports.assertExpression=function(node,opts){assert("Expression",node,opts)},exports.assertExpressionStatement=function(node,opts){assert("ExpressionStatement",node,opts)},exports.assertExpressionWrapper=function(node,opts){assert("ExpressionWrapper",node,opts)},exports.assertFile=function(node,opts){assert("File",node,opts)},exports.assertFlow=function(node,opts){assert("Flow",node,opts)},exports.assertFlowBaseAnnotation=function(node,opts){assert("FlowBaseAnnotation",node,opts)},exports.assertFlowDeclaration=function(node,opts){assert("FlowDeclaration",node,opts)},exports.assertFlowPredicate=function(node,opts){assert("FlowPredicate",node,opts)},exports.assertFlowType=function(node,opts){assert("FlowType",node,opts)},exports.assertFor=function(node,opts){assert("For",node,opts)},exports.assertForInStatement=function(node,opts){assert("ForInStatement",node,opts)},exports.assertForOfStatement=function(node,opts){assert("ForOfStatement",node,opts)},exports.assertForStatement=function(node,opts){assert("ForStatement",node,opts)},exports.assertForXStatement=function(node,opts){assert("ForXStatement",node,opts)},exports.assertFunction=function(node,opts){assert("Function",node,opts)},exports.assertFunctionDeclaration=function(node,opts){assert("FunctionDeclaration",node,opts)},exports.assertFunctionExpression=function(node,opts){assert("FunctionExpression",node,opts)},exports.assertFunctionParent=function(node,opts){assert("FunctionParent",node,opts)},exports.assertFunctionTypeAnnotation=function(node,opts){assert("FunctionTypeAnnotation",node,opts)},exports.assertFunctionTypeParam=function(node,opts){assert("FunctionTypeParam",node,opts)},exports.assertGenericTypeAnnotation=function(node,opts){assert("GenericTypeAnnotation",node,opts)},exports.assertIdentifier=function(node,opts){assert("Identifier",node,opts)},exports.assertIfStatement=function(node,opts){assert("IfStatement",node,opts)},exports.assertImmutable=function(node,opts){assert("Immutable",node,opts)},exports.assertImport=function(node,opts){assert("Import",node,opts)},exports.assertImportAttribute=function(node,opts){assert("ImportAttribute",node,opts)},exports.assertImportDeclaration=function(node,opts){assert("ImportDeclaration",node,opts)},exports.assertImportDefaultSpecifier=function(node,opts){assert("ImportDefaultSpecifier",node,opts)},exports.assertImportExpression=function(node,opts){assert("ImportExpression",node,opts)},exports.assertImportNamespaceSpecifier=function(node,opts){assert("ImportNamespaceSpecifier",node,opts)},exports.assertImportOrExportDeclaration=function(node,opts){assert("ImportOrExportDeclaration",node,opts)},exports.assertImportSpecifier=function(node,opts){assert("ImportSpecifier",node,opts)},exports.assertIndexedAccessType=function(node,opts){assert("IndexedAccessType",node,opts)},exports.assertInferredPredicate=function(node,opts){assert("InferredPredicate",node,opts)},exports.assertInterfaceDeclaration=function(node,opts){assert("InterfaceDeclaration",node,opts)},exports.assertInterfaceExtends=function(node,opts){assert("InterfaceExtends",node,opts)},exports.assertInterfaceTypeAnnotation=function(node,opts){assert("InterfaceTypeAnnotation",node,opts)},exports.assertInterpreterDirective=function(node,opts){assert("InterpreterDirective",node,opts)},exports.assertIntersectionTypeAnnotation=function(node,opts){assert("IntersectionTypeAnnotation",node,opts)},exports.assertJSX=function(node,opts){assert("JSX",node,opts)},exports.assertJSXAttribute=function(node,opts){assert("JSXAttribute",node,opts)},exports.assertJSXClosingElement=function(node,opts){assert("JSXClosingElement",node,opts)},exports.assertJSXClosingFragment=function(node,opts){assert("JSXClosingFragment",node,opts)},exports.assertJSXElement=function(node,opts){assert("JSXElement",node,opts)},exports.assertJSXEmptyExpression=function(node,opts){assert("JSXEmptyExpression",node,opts)},exports.assertJSXExpressionContainer=function(node,opts){assert("JSXExpressionContainer",node,opts)},exports.assertJSXFragment=function(node,opts){assert("JSXFragment",node,opts)},exports.assertJSXIdentifier=function(node,opts){assert("JSXIdentifier",node,opts)},exports.assertJSXMemberExpression=function(node,opts){assert("JSXMemberExpression",node,opts)},exports.assertJSXNamespacedName=function(node,opts){assert("JSXNamespacedName",node,opts)},exports.assertJSXOpeningElement=function(node,opts){assert("JSXOpeningElement",node,opts)},exports.assertJSXOpeningFragment=function(node,opts){assert("JSXOpeningFragment",node,opts)},exports.assertJSXSpreadAttribute=function(node,opts){assert("JSXSpreadAttribute",node,opts)},exports.assertJSXSpreadChild=function(node,opts){assert("JSXSpreadChild",node,opts)},exports.assertJSXText=function(node,opts){assert("JSXText",node,opts)},exports.assertLVal=function(node,opts){assert("LVal",node,opts)},exports.assertLabeledStatement=function(node,opts){assert("LabeledStatement",node,opts)},exports.assertLiteral=function(node,opts){assert("Literal",node,opts)},exports.assertLogicalExpression=function(node,opts){assert("LogicalExpression",node,opts)},exports.assertLoop=function(node,opts){assert("Loop",node,opts)},exports.assertMemberExpression=function(node,opts){assert("MemberExpression",node,opts)},exports.assertMetaProperty=function(node,opts){assert("MetaProperty",node,opts)},exports.assertMethod=function(node,opts){assert("Method",node,opts)},exports.assertMiscellaneous=function(node,opts){assert("Miscellaneous",node,opts)},exports.assertMixedTypeAnnotation=function(node,opts){assert("MixedTypeAnnotation",node,opts)},exports.assertModuleDeclaration=function(node,opts){(0,_deprecationWarning.default)("assertModuleDeclaration","assertImportOrExportDeclaration"),assert("ModuleDeclaration",node,opts)},exports.assertModuleExpression=function(node,opts){assert("ModuleExpression",node,opts)},exports.assertModuleSpecifier=function(node,opts){assert("ModuleSpecifier",node,opts)},exports.assertNewExpression=function(node,opts){assert("NewExpression",node,opts)},exports.assertNoop=function(node,opts){assert("Noop",node,opts)},exports.assertNullLiteral=function(node,opts){assert("NullLiteral",node,opts)},exports.assertNullLiteralTypeAnnotation=function(node,opts){assert("NullLiteralTypeAnnotation",node,opts)},exports.assertNullableTypeAnnotation=function(node,opts){assert("NullableTypeAnnotation",node,opts)},exports.assertNumberLiteral=function(node,opts){(0,_deprecationWarning.default)("assertNumberLiteral","assertNumericLiteral"),assert("NumberLiteral",node,opts)},exports.assertNumberLiteralTypeAnnotation=function(node,opts){assert("NumberLiteralTypeAnnotation",node,opts)},exports.assertNumberTypeAnnotation=function(node,opts){assert("NumberTypeAnnotation",node,opts)},exports.assertNumericLiteral=function(node,opts){assert("NumericLiteral",node,opts)},exports.assertObjectExpression=function(node,opts){assert("ObjectExpression",node,opts)},exports.assertObjectMember=function(node,opts){assert("ObjectMember",node,opts)},exports.assertObjectMethod=function(node,opts){assert("ObjectMethod",node,opts)},exports.assertObjectPattern=function(node,opts){assert("ObjectPattern",node,opts)},exports.assertObjectProperty=function(node,opts){assert("ObjectProperty",node,opts)},exports.assertObjectTypeAnnotation=function(node,opts){assert("ObjectTypeAnnotation",node,opts)},exports.assertObjectTypeCallProperty=function(node,opts){assert("ObjectTypeCallProperty",node,opts)},exports.assertObjectTypeIndexer=function(node,opts){assert("ObjectTypeIndexer",node,opts)},exports.assertObjectTypeInternalSlot=function(node,opts){assert("ObjectTypeInternalSlot",node,opts)},exports.assertObjectTypeProperty=function(node,opts){assert("ObjectTypeProperty",node,opts)},exports.assertObjectTypeSpreadProperty=function(node,opts){assert("ObjectTypeSpreadProperty",node,opts)},exports.assertOpaqueType=function(node,opts){assert("OpaqueType",node,opts)},exports.assertOptionalCallExpression=function(node,opts){assert("OptionalCallExpression",node,opts)},exports.assertOptionalIndexedAccessType=function(node,opts){assert("OptionalIndexedAccessType",node,opts)},exports.assertOptionalMemberExpression=function(node,opts){assert("OptionalMemberExpression",node,opts)},exports.assertParenthesizedExpression=function(node,opts){assert("ParenthesizedExpression",node,opts)},exports.assertPattern=function(node,opts){assert("Pattern",node,opts)},exports.assertPatternLike=function(node,opts){assert("PatternLike",node,opts)},exports.assertPipelineBareFunction=function(node,opts){assert("PipelineBareFunction",node,opts)},exports.assertPipelinePrimaryTopicReference=function(node,opts){assert("PipelinePrimaryTopicReference",node,opts)},exports.assertPipelineTopicExpression=function(node,opts){assert("PipelineTopicExpression",node,opts)},exports.assertPlaceholder=function(node,opts){assert("Placeholder",node,opts)},exports.assertPrivate=function(node,opts){assert("Private",node,opts)},exports.assertPrivateName=function(node,opts){assert("PrivateName",node,opts)},exports.assertProgram=function(node,opts){assert("Program",node,opts)},exports.assertProperty=function(node,opts){assert("Property",node,opts)},exports.assertPureish=function(node,opts){assert("Pureish",node,opts)},exports.assertQualifiedTypeIdentifier=function(node,opts){assert("QualifiedTypeIdentifier",node,opts)},exports.assertRecordExpression=function(node,opts){assert("RecordExpression",node,opts)},exports.assertRegExpLiteral=function(node,opts){assert("RegExpLiteral",node,opts)},exports.assertRegexLiteral=function(node,opts){(0,_deprecationWarning.default)("assertRegexLiteral","assertRegExpLiteral"),assert("RegexLiteral",node,opts)},exports.assertRestElement=function(node,opts){assert("RestElement",node,opts)},exports.assertRestProperty=function(node,opts){(0,_deprecationWarning.default)("assertRestProperty","assertRestElement"),assert("RestProperty",node,opts)},exports.assertReturnStatement=function(node,opts){assert("ReturnStatement",node,opts)},exports.assertScopable=function(node,opts){assert("Scopable",node,opts)},exports.assertSequenceExpression=function(node,opts){assert("SequenceExpression",node,opts)},exports.assertSpreadElement=function(node,opts){assert("SpreadElement",node,opts)},exports.assertSpreadProperty=function(node,opts){(0,_deprecationWarning.default)("assertSpreadProperty","assertSpreadElement"),assert("SpreadProperty",node,opts)},exports.assertStandardized=function(node,opts){assert("Standardized",node,opts)},exports.assertStatement=function(node,opts){assert("Statement",node,opts)},exports.assertStaticBlock=function(node,opts){assert("StaticBlock",node,opts)},exports.assertStringLiteral=function(node,opts){assert("StringLiteral",node,opts)},exports.assertStringLiteralTypeAnnotation=function(node,opts){assert("StringLiteralTypeAnnotation",node,opts)},exports.assertStringTypeAnnotation=function(node,opts){assert("StringTypeAnnotation",node,opts)},exports.assertSuper=function(node,opts){assert("Super",node,opts)},exports.assertSwitchCase=function(node,opts){assert("SwitchCase",node,opts)},exports.assertSwitchStatement=function(node,opts){assert("SwitchStatement",node,opts)},exports.assertSymbolTypeAnnotation=function(node,opts){assert("SymbolTypeAnnotation",node,opts)},exports.assertTSAnyKeyword=function(node,opts){assert("TSAnyKeyword",node,opts)},exports.assertTSArrayType=function(node,opts){assert("TSArrayType",node,opts)},exports.assertTSAsExpression=function(node,opts){assert("TSAsExpression",node,opts)},exports.assertTSBaseType=function(node,opts){assert("TSBaseType",node,opts)},exports.assertTSBigIntKeyword=function(node,opts){assert("TSBigIntKeyword",node,opts)},exports.assertTSBooleanKeyword=function(node,opts){assert("TSBooleanKeyword",node,opts)},exports.assertTSCallSignatureDeclaration=function(node,opts){assert("TSCallSignatureDeclaration",node,opts)},exports.assertTSConditionalType=function(node,opts){assert("TSConditionalType",node,opts)},exports.assertTSConstructSignatureDeclaration=function(node,opts){assert("TSConstructSignatureDeclaration",node,opts)},exports.assertTSConstructorType=function(node,opts){assert("TSConstructorType",node,opts)},exports.assertTSDeclareFunction=function(node,opts){assert("TSDeclareFunction",node,opts)},exports.assertTSDeclareMethod=function(node,opts){assert("TSDeclareMethod",node,opts)},exports.assertTSEntityName=function(node,opts){assert("TSEntityName",node,opts)},exports.assertTSEnumDeclaration=function(node,opts){assert("TSEnumDeclaration",node,opts)},exports.assertTSEnumMember=function(node,opts){assert("TSEnumMember",node,opts)},exports.assertTSExportAssignment=function(node,opts){assert("TSExportAssignment",node,opts)},exports.assertTSExpressionWithTypeArguments=function(node,opts){assert("TSExpressionWithTypeArguments",node,opts)},exports.assertTSExternalModuleReference=function(node,opts){assert("TSExternalModuleReference",node,opts)},exports.assertTSFunctionType=function(node,opts){assert("TSFunctionType",node,opts)},exports.assertTSImportEqualsDeclaration=function(node,opts){assert("TSImportEqualsDeclaration",node,opts)},exports.assertTSImportType=function(node,opts){assert("TSImportType",node,opts)},exports.assertTSIndexSignature=function(node,opts){assert("TSIndexSignature",node,opts)},exports.assertTSIndexedAccessType=function(node,opts){assert("TSIndexedAccessType",node,opts)},exports.assertTSInferType=function(node,opts){assert("TSInferType",node,opts)},exports.assertTSInstantiationExpression=function(node,opts){assert("TSInstantiationExpression",node,opts)},exports.assertTSInterfaceBody=function(node,opts){assert("TSInterfaceBody",node,opts)},exports.assertTSInterfaceDeclaration=function(node,opts){assert("TSInterfaceDeclaration",node,opts)},exports.assertTSIntersectionType=function(node,opts){assert("TSIntersectionType",node,opts)},exports.assertTSIntrinsicKeyword=function(node,opts){assert("TSIntrinsicKeyword",node,opts)},exports.assertTSLiteralType=function(node,opts){assert("TSLiteralType",node,opts)},exports.assertTSMappedType=function(node,opts){assert("TSMappedType",node,opts)},exports.assertTSMethodSignature=function(node,opts){assert("TSMethodSignature",node,opts)},exports.assertTSModuleBlock=function(node,opts){assert("TSModuleBlock",node,opts)},exports.assertTSModuleDeclaration=function(node,opts){assert("TSModuleDeclaration",node,opts)},exports.assertTSNamedTupleMember=function(node,opts){assert("TSNamedTupleMember",node,opts)},exports.assertTSNamespaceExportDeclaration=function(node,opts){assert("TSNamespaceExportDeclaration",node,opts)},exports.assertTSNeverKeyword=function(node,opts){assert("TSNeverKeyword",node,opts)},exports.assertTSNonNullExpression=function(node,opts){assert("TSNonNullExpression",node,opts)},exports.assertTSNullKeyword=function(node,opts){assert("TSNullKeyword",node,opts)},exports.assertTSNumberKeyword=function(node,opts){assert("TSNumberKeyword",node,opts)},exports.assertTSObjectKeyword=function(node,opts){assert("TSObjectKeyword",node,opts)},exports.assertTSOptionalType=function(node,opts){assert("TSOptionalType",node,opts)},exports.assertTSParameterProperty=function(node,opts){assert("TSParameterProperty",node,opts)},exports.assertTSParenthesizedType=function(node,opts){assert("TSParenthesizedType",node,opts)},exports.assertTSPropertySignature=function(node,opts){assert("TSPropertySignature",node,opts)},exports.assertTSQualifiedName=function(node,opts){assert("TSQualifiedName",node,opts)},exports.assertTSRestType=function(node,opts){assert("TSRestType",node,opts)},exports.assertTSSatisfiesExpression=function(node,opts){assert("TSSatisfiesExpression",node,opts)},exports.assertTSStringKeyword=function(node,opts){assert("TSStringKeyword",node,opts)},exports.assertTSSymbolKeyword=function(node,opts){assert("TSSymbolKeyword",node,opts)},exports.assertTSThisType=function(node,opts){assert("TSThisType",node,opts)},exports.assertTSTupleType=function(node,opts){assert("TSTupleType",node,opts)},exports.assertTSType=function(node,opts){assert("TSType",node,opts)},exports.assertTSTypeAliasDeclaration=function(node,opts){assert("TSTypeAliasDeclaration",node,opts)},exports.assertTSTypeAnnotation=function(node,opts){assert("TSTypeAnnotation",node,opts)},exports.assertTSTypeAssertion=function(node,opts){assert("TSTypeAssertion",node,opts)},exports.assertTSTypeElement=function(node,opts){assert("TSTypeElement",node,opts)},exports.assertTSTypeLiteral=function(node,opts){assert("TSTypeLiteral",node,opts)},exports.assertTSTypeOperator=function(node,opts){assert("TSTypeOperator",node,opts)},exports.assertTSTypeParameter=function(node,opts){assert("TSTypeParameter",node,opts)},exports.assertTSTypeParameterDeclaration=function(node,opts){assert("TSTypeParameterDeclaration",node,opts)},exports.assertTSTypeParameterInstantiation=function(node,opts){assert("TSTypeParameterInstantiation",node,opts)},exports.assertTSTypePredicate=function(node,opts){assert("TSTypePredicate",node,opts)},exports.assertTSTypeQuery=function(node,opts){assert("TSTypeQuery",node,opts)},exports.assertTSTypeReference=function(node,opts){assert("TSTypeReference",node,opts)},exports.assertTSUndefinedKeyword=function(node,opts){assert("TSUndefinedKeyword",node,opts)},exports.assertTSUnionType=function(node,opts){assert("TSUnionType",node,opts)},exports.assertTSUnknownKeyword=function(node,opts){assert("TSUnknownKeyword",node,opts)},exports.assertTSVoidKeyword=function(node,opts){assert("TSVoidKeyword",node,opts)},exports.assertTaggedTemplateExpression=function(node,opts){assert("TaggedTemplateExpression",node,opts)},exports.assertTemplateElement=function(node,opts){assert("TemplateElement",node,opts)},exports.assertTemplateLiteral=function(node,opts){assert("TemplateLiteral",node,opts)},exports.assertTerminatorless=function(node,opts){assert("Terminatorless",node,opts)},exports.assertThisExpression=function(node,opts){assert("ThisExpression",node,opts)},exports.assertThisTypeAnnotation=function(node,opts){assert("ThisTypeAnnotation",node,opts)},exports.assertThrowStatement=function(node,opts){assert("ThrowStatement",node,opts)},exports.assertTopicReference=function(node,opts){assert("TopicReference",node,opts)},exports.assertTryStatement=function(node,opts){assert("TryStatement",node,opts)},exports.assertTupleExpression=function(node,opts){assert("TupleExpression",node,opts)},exports.assertTupleTypeAnnotation=function(node,opts){assert("TupleTypeAnnotation",node,opts)},exports.assertTypeAlias=function(node,opts){assert("TypeAlias",node,opts)},exports.assertTypeAnnotation=function(node,opts){assert("TypeAnnotation",node,opts)},exports.assertTypeCastExpression=function(node,opts){assert("TypeCastExpression",node,opts)},exports.assertTypeParameter=function(node,opts){assert("TypeParameter",node,opts)},exports.assertTypeParameterDeclaration=function(node,opts){assert("TypeParameterDeclaration",node,opts)},exports.assertTypeParameterInstantiation=function(node,opts){assert("TypeParameterInstantiation",node,opts)},exports.assertTypeScript=function(node,opts){assert("TypeScript",node,opts)},exports.assertTypeofTypeAnnotation=function(node,opts){assert("TypeofTypeAnnotation",node,opts)},exports.assertUnaryExpression=function(node,opts){assert("UnaryExpression",node,opts)},exports.assertUnaryLike=function(node,opts){assert("UnaryLike",node,opts)},exports.assertUnionTypeAnnotation=function(node,opts){assert("UnionTypeAnnotation",node,opts)},exports.assertUpdateExpression=function(node,opts){assert("UpdateExpression",node,opts)},exports.assertUserWhitespacable=function(node,opts){assert("UserWhitespacable",node,opts)},exports.assertV8IntrinsicIdentifier=function(node,opts){assert("V8IntrinsicIdentifier",node,opts)},exports.assertVariableDeclaration=function(node,opts){assert("VariableDeclaration",node,opts)},exports.assertVariableDeclarator=function(node,opts){assert("VariableDeclarator",node,opts)},exports.assertVariance=function(node,opts){assert("Variance",node,opts)},exports.assertVoidTypeAnnotation=function(node,opts){assert("VoidTypeAnnotation",node,opts)},exports.assertWhile=function(node,opts){assert("While",node,opts)},exports.assertWhileStatement=function(node,opts){assert("WhileStatement",node,opts)},exports.assertWithStatement=function(node,opts){assert("WithStatement",node,opts)},exports.assertYieldExpression=function(node,opts){assert("YieldExpression",node,opts)};var _is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js");function assert(type,node,opts){if(!(0,_is.default)(type,node,opts))throw new Error(`Expected type "${type}" with option ${JSON.stringify(opts)}, but instead got "${node.type}".`)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createFlowUnionType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(types){const flattened=(0,_removeTypeDuplicates.default)(types);return 1===flattened.length?flattened[0]:(0,_index.unionTypeAnnotation)(flattened)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_removeTypeDuplicates=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/flow/removeTypeDuplicates.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createTypeAnnotationBasedOnTypeof.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");exports.default=function(type){switch(type){case"string":return(0,_index.stringTypeAnnotation)();case"number":return(0,_index.numberTypeAnnotation)();case"undefined":return(0,_index.voidTypeAnnotation)();case"boolean":return(0,_index.booleanTypeAnnotation)();case"function":return(0,_index.genericTypeAnnotation)((0,_index.identifier)("Function"));case"object":return(0,_index.genericTypeAnnotation)((0,_index.identifier)("Object"));case"symbol":return(0,_index.genericTypeAnnotation)((0,_index.identifier)("Symbol"));case"bigint":return(0,_index.anyTypeAnnotation)()}throw new Error("Invalid typeof value: "+type)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.anyTypeAnnotation=function(){return{type:"AnyTypeAnnotation"}},exports.argumentPlaceholder=function(){return{type:"ArgumentPlaceholder"}},exports.arrayExpression=function(elements=[]){const node={type:"ArrayExpression",elements},defs=NODE_FIELDS.ArrayExpression;return validate(defs.elements,node,"elements",elements,1),node},exports.arrayPattern=function(elements){const node={type:"ArrayPattern",elements},defs=NODE_FIELDS.ArrayPattern;return validate(defs.elements,node,"elements",elements,1),node},exports.arrayTypeAnnotation=function(elementType){const node={type:"ArrayTypeAnnotation",elementType},defs=NODE_FIELDS.ArrayTypeAnnotation;return validate(defs.elementType,node,"elementType",elementType,1),node},exports.arrowFunctionExpression=function(params,body,async=!1){const node={type:"ArrowFunctionExpression",params,body,async,expression:null},defs=NODE_FIELDS.ArrowFunctionExpression;return validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.async,node,"async",async),node},exports.assignmentExpression=function(operator,left,right){const node={type:"AssignmentExpression",operator,left,right},defs=NODE_FIELDS.AssignmentExpression;return validate(defs.operator,node,"operator",operator),validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.assignmentPattern=function(left,right){const node={type:"AssignmentPattern",left,right},defs=NODE_FIELDS.AssignmentPattern;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.awaitExpression=function(argument){const node={type:"AwaitExpression",argument},defs=NODE_FIELDS.AwaitExpression;return validate(defs.argument,node,"argument",argument,1),node},exports.bigIntLiteral=function(value){const node={type:"BigIntLiteral",value},defs=NODE_FIELDS.BigIntLiteral;return validate(defs.value,node,"value",value),node},exports.binaryExpression=function(operator,left,right){const node={type:"BinaryExpression",operator,left,right},defs=NODE_FIELDS.BinaryExpression;return validate(defs.operator,node,"operator",operator),validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.bindExpression=function(object,callee){const node={type:"BindExpression",object,callee},defs=NODE_FIELDS.BindExpression;return validate(defs.object,node,"object",object,1),validate(defs.callee,node,"callee",callee,1),node},exports.blockStatement=function(body,directives=[]){const node={type:"BlockStatement",body,directives},defs=NODE_FIELDS.BlockStatement;return validate(defs.body,node,"body",body,1),validate(defs.directives,node,"directives",directives,1),node},exports.booleanLiteral=function(value){const node={type:"BooleanLiteral",value},defs=NODE_FIELDS.BooleanLiteral;return validate(defs.value,node,"value",value),node},exports.booleanLiteralTypeAnnotation=function(value){const node={type:"BooleanLiteralTypeAnnotation",value},defs=NODE_FIELDS.BooleanLiteralTypeAnnotation;return validate(defs.value,node,"value",value),node},exports.booleanTypeAnnotation=function(){return{type:"BooleanTypeAnnotation"}},exports.breakStatement=function(label=null){const node={type:"BreakStatement",label},defs=NODE_FIELDS.BreakStatement;return validate(defs.label,node,"label",label,1),node},exports.callExpression=function(callee,_arguments){const node={type:"CallExpression",callee,arguments:_arguments},defs=NODE_FIELDS.CallExpression;return validate(defs.callee,node,"callee",callee,1),validate(defs.arguments,node,"arguments",_arguments,1),node},exports.catchClause=function(param=null,body){const node={type:"CatchClause",param,body},defs=NODE_FIELDS.CatchClause;return validate(defs.param,node,"param",param,1),validate(defs.body,node,"body",body,1),node},exports.classAccessorProperty=function(key,value=null,typeAnnotation=null,decorators=null,computed=!1,_static=!1){const node={type:"ClassAccessorProperty",key,value,typeAnnotation,decorators,computed,static:_static},defs=NODE_FIELDS.ClassAccessorProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.decorators,node,"decorators",decorators,1),validate(defs.computed,node,"computed",computed),validate(defs.static,node,"static",_static),node},exports.classBody=function(body){const node={type:"ClassBody",body},defs=NODE_FIELDS.ClassBody;return validate(defs.body,node,"body",body,1),node},exports.classDeclaration=function(id=null,superClass=null,body,decorators=null){const node={type:"ClassDeclaration",id,superClass,body,decorators},defs=NODE_FIELDS.ClassDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.superClass,node,"superClass",superClass,1),validate(defs.body,node,"body",body,1),validate(defs.decorators,node,"decorators",decorators,1),node},exports.classExpression=function(id=null,superClass=null,body,decorators=null){const node={type:"ClassExpression",id,superClass,body,decorators},defs=NODE_FIELDS.ClassExpression;return validate(defs.id,node,"id",id,1),validate(defs.superClass,node,"superClass",superClass,1),validate(defs.body,node,"body",body,1),validate(defs.decorators,node,"decorators",decorators,1),node},exports.classImplements=function(id,typeParameters=null){const node={type:"ClassImplements",id,typeParameters},defs=NODE_FIELDS.ClassImplements;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.classMethod=function(kind="method",key,params,body,computed=!1,_static=!1,generator=!1,async=!1){const node={type:"ClassMethod",kind,key,params,body,computed,static:_static,generator,async},defs=NODE_FIELDS.ClassMethod;return validate(defs.kind,node,"kind",kind),validate(defs.key,node,"key",key,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.computed,node,"computed",computed),validate(defs.static,node,"static",_static),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.classPrivateMethod=function(kind="method",key,params,body,_static=!1){const node={type:"ClassPrivateMethod",kind,key,params,body,static:_static},defs=NODE_FIELDS.ClassPrivateMethod;return validate(defs.kind,node,"kind",kind),validate(defs.key,node,"key",key,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.static,node,"static",_static),node},exports.classPrivateProperty=function(key,value=null,decorators=null,_static=!1){const node={type:"ClassPrivateProperty",key,value,decorators,static:_static},defs=NODE_FIELDS.ClassPrivateProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.decorators,node,"decorators",decorators,1),validate(defs.static,node,"static",_static),node},exports.classProperty=function(key,value=null,typeAnnotation=null,decorators=null,computed=!1,_static=!1){const node={type:"ClassProperty",key,value,typeAnnotation,decorators,computed,static:_static},defs=NODE_FIELDS.ClassProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.decorators,node,"decorators",decorators,1),validate(defs.computed,node,"computed",computed),validate(defs.static,node,"static",_static),node},exports.conditionalExpression=function(test,consequent,alternate){const node={type:"ConditionalExpression",test,consequent,alternate},defs=NODE_FIELDS.ConditionalExpression;return validate(defs.test,node,"test",test,1),validate(defs.consequent,node,"consequent",consequent,1),validate(defs.alternate,node,"alternate",alternate,1),node},exports.continueStatement=function(label=null){const node={type:"ContinueStatement",label},defs=NODE_FIELDS.ContinueStatement;return validate(defs.label,node,"label",label,1),node},exports.debuggerStatement=function(){return{type:"DebuggerStatement"}},exports.decimalLiteral=function(value){const node={type:"DecimalLiteral",value},defs=NODE_FIELDS.DecimalLiteral;return validate(defs.value,node,"value",value),node},exports.declareClass=function(id,typeParameters=null,_extends=null,body){const node={type:"DeclareClass",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.DeclareClass;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.declareExportAllDeclaration=function(source,attributes=null){const node={type:"DeclareExportAllDeclaration",source,attributes},defs=NODE_FIELDS.DeclareExportAllDeclaration;return validate(defs.source,node,"source",source,1),validate(defs.attributes,node,"attributes",attributes,1),node},exports.declareExportDeclaration=function(declaration=null,specifiers=null,source=null,attributes=null){const node={type:"DeclareExportDeclaration",declaration,specifiers,source,attributes},defs=NODE_FIELDS.DeclareExportDeclaration;return validate(defs.declaration,node,"declaration",declaration,1),validate(defs.specifiers,node,"specifiers",specifiers,1),validate(defs.source,node,"source",source,1),validate(defs.attributes,node,"attributes",attributes,1),node},exports.declareFunction=function(id){const node={type:"DeclareFunction",id},defs=NODE_FIELDS.DeclareFunction;return validate(defs.id,node,"id",id,1),node},exports.declareInterface=function(id,typeParameters=null,_extends=null,body){const node={type:"DeclareInterface",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.DeclareInterface;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.declareModule=function(id,body,kind=null){const node={type:"DeclareModule",id,body,kind},defs=NODE_FIELDS.DeclareModule;return validate(defs.id,node,"id",id,1),validate(defs.body,node,"body",body,1),validate(defs.kind,node,"kind",kind),node},exports.declareModuleExports=function(typeAnnotation){const node={type:"DeclareModuleExports",typeAnnotation},defs=NODE_FIELDS.DeclareModuleExports;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.declareOpaqueType=function(id,typeParameters=null,supertype=null){const node={type:"DeclareOpaqueType",id,typeParameters,supertype},defs=NODE_FIELDS.DeclareOpaqueType;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.supertype,node,"supertype",supertype,1),node},exports.declareTypeAlias=function(id,typeParameters=null,right){const node={type:"DeclareTypeAlias",id,typeParameters,right},defs=NODE_FIELDS.DeclareTypeAlias;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.right,node,"right",right,1),node},exports.declareVariable=function(id){const node={type:"DeclareVariable",id},defs=NODE_FIELDS.DeclareVariable;return validate(defs.id,node,"id",id,1),node},exports.declaredPredicate=function(value){const node={type:"DeclaredPredicate",value},defs=NODE_FIELDS.DeclaredPredicate;return validate(defs.value,node,"value",value,1),node},exports.decorator=function(expression){const node={type:"Decorator",expression},defs=NODE_FIELDS.Decorator;return validate(defs.expression,node,"expression",expression,1),node},exports.directive=function(value){const node={type:"Directive",value},defs=NODE_FIELDS.Directive;return validate(defs.value,node,"value",value,1),node},exports.directiveLiteral=function(value){const node={type:"DirectiveLiteral",value},defs=NODE_FIELDS.DirectiveLiteral;return validate(defs.value,node,"value",value),node},exports.doExpression=function(body,async=!1){const node={type:"DoExpression",body,async},defs=NODE_FIELDS.DoExpression;return validate(defs.body,node,"body",body,1),validate(defs.async,node,"async",async),node},exports.doWhileStatement=function(test,body){const node={type:"DoWhileStatement",test,body},defs=NODE_FIELDS.DoWhileStatement;return validate(defs.test,node,"test",test,1),validate(defs.body,node,"body",body,1),node},exports.emptyStatement=function(){return{type:"EmptyStatement"}},exports.emptyTypeAnnotation=function(){return{type:"EmptyTypeAnnotation"}},exports.enumBooleanBody=function(members){const node={type:"EnumBooleanBody",members,explicitType:null,hasUnknownMembers:null},defs=NODE_FIELDS.EnumBooleanBody;return validate(defs.members,node,"members",members,1),node},exports.enumBooleanMember=function(id){const node={type:"EnumBooleanMember",id,init:null},defs=NODE_FIELDS.EnumBooleanMember;return validate(defs.id,node,"id",id,1),node},exports.enumDeclaration=function(id,body){const node={type:"EnumDeclaration",id,body},defs=NODE_FIELDS.EnumDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.body,node,"body",body,1),node},exports.enumDefaultedMember=function(id){const node={type:"EnumDefaultedMember",id},defs=NODE_FIELDS.EnumDefaultedMember;return validate(defs.id,node,"id",id,1),node},exports.enumNumberBody=function(members){const node={type:"EnumNumberBody",members,explicitType:null,hasUnknownMembers:null},defs=NODE_FIELDS.EnumNumberBody;return validate(defs.members,node,"members",members,1),node},exports.enumNumberMember=function(id,init){const node={type:"EnumNumberMember",id,init},defs=NODE_FIELDS.EnumNumberMember;return validate(defs.id,node,"id",id,1),validate(defs.init,node,"init",init,1),node},exports.enumStringBody=function(members){const node={type:"EnumStringBody",members,explicitType:null,hasUnknownMembers:null},defs=NODE_FIELDS.EnumStringBody;return validate(defs.members,node,"members",members,1),node},exports.enumStringMember=function(id,init){const node={type:"EnumStringMember",id,init},defs=NODE_FIELDS.EnumStringMember;return validate(defs.id,node,"id",id,1),validate(defs.init,node,"init",init,1),node},exports.enumSymbolBody=function(members){const node={type:"EnumSymbolBody",members,hasUnknownMembers:null},defs=NODE_FIELDS.EnumSymbolBody;return validate(defs.members,node,"members",members,1),node},exports.existsTypeAnnotation=function(){return{type:"ExistsTypeAnnotation"}},exports.exportAllDeclaration=function(source){const node={type:"ExportAllDeclaration",source},defs=NODE_FIELDS.ExportAllDeclaration;return validate(defs.source,node,"source",source,1),node},exports.exportDefaultDeclaration=function(declaration){const node={type:"ExportDefaultDeclaration",declaration},defs=NODE_FIELDS.ExportDefaultDeclaration;return validate(defs.declaration,node,"declaration",declaration,1),node},exports.exportDefaultSpecifier=function(exported){const node={type:"ExportDefaultSpecifier",exported},defs=NODE_FIELDS.ExportDefaultSpecifier;return validate(defs.exported,node,"exported",exported,1),node},exports.exportNamedDeclaration=function(declaration=null,specifiers=[],source=null){const node={type:"ExportNamedDeclaration",declaration,specifiers,source},defs=NODE_FIELDS.ExportNamedDeclaration;return validate(defs.declaration,node,"declaration",declaration,1),validate(defs.specifiers,node,"specifiers",specifiers,1),validate(defs.source,node,"source",source,1),node},exports.exportNamespaceSpecifier=function(exported){const node={type:"ExportNamespaceSpecifier",exported},defs=NODE_FIELDS.ExportNamespaceSpecifier;return validate(defs.exported,node,"exported",exported,1),node},exports.exportSpecifier=function(local,exported){const node={type:"ExportSpecifier",local,exported},defs=NODE_FIELDS.ExportSpecifier;return validate(defs.local,node,"local",local,1),validate(defs.exported,node,"exported",exported,1),node},exports.expressionStatement=function(expression){const node={type:"ExpressionStatement",expression},defs=NODE_FIELDS.ExpressionStatement;return validate(defs.expression,node,"expression",expression,1),node},exports.file=function(program,comments=null,tokens=null){const node={type:"File",program,comments,tokens},defs=NODE_FIELDS.File;return validate(defs.program,node,"program",program,1),validate(defs.comments,node,"comments",comments,1),validate(defs.tokens,node,"tokens",tokens),node},exports.forInStatement=function(left,right,body){const node={type:"ForInStatement",left,right,body},defs=NODE_FIELDS.ForInStatement;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),validate(defs.body,node,"body",body,1),node},exports.forOfStatement=function(left,right,body,_await=!1){const node={type:"ForOfStatement",left,right,body,await:_await},defs=NODE_FIELDS.ForOfStatement;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),validate(defs.body,node,"body",body,1),validate(defs.await,node,"await",_await),node},exports.forStatement=function(init=null,test=null,update=null,body){const node={type:"ForStatement",init,test,update,body},defs=NODE_FIELDS.ForStatement;return validate(defs.init,node,"init",init,1),validate(defs.test,node,"test",test,1),validate(defs.update,node,"update",update,1),validate(defs.body,node,"body",body,1),node},exports.functionDeclaration=function(id=null,params,body,generator=!1,async=!1){const node={type:"FunctionDeclaration",id,params,body,generator,async},defs=NODE_FIELDS.FunctionDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.functionExpression=function(id=null,params,body,generator=!1,async=!1){const node={type:"FunctionExpression",id,params,body,generator,async},defs=NODE_FIELDS.FunctionExpression;return validate(defs.id,node,"id",id,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.functionTypeAnnotation=function(typeParameters=null,params,rest=null,returnType){const node={type:"FunctionTypeAnnotation",typeParameters,params,rest,returnType},defs=NODE_FIELDS.FunctionTypeAnnotation;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.params,node,"params",params,1),validate(defs.rest,node,"rest",rest,1),validate(defs.returnType,node,"returnType",returnType,1),node},exports.functionTypeParam=function(name=null,typeAnnotation){const node={type:"FunctionTypeParam",name,typeAnnotation},defs=NODE_FIELDS.FunctionTypeParam;return validate(defs.name,node,"name",name,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.genericTypeAnnotation=function(id,typeParameters=null){const node={type:"GenericTypeAnnotation",id,typeParameters},defs=NODE_FIELDS.GenericTypeAnnotation;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.identifier=function(name){const node={type:"Identifier",name},defs=NODE_FIELDS.Identifier;return validate(defs.name,node,"name",name),node},exports.ifStatement=function(test,consequent,alternate=null){const node={type:"IfStatement",test,consequent,alternate},defs=NODE_FIELDS.IfStatement;return validate(defs.test,node,"test",test,1),validate(defs.consequent,node,"consequent",consequent,1),validate(defs.alternate,node,"alternate",alternate,1),node},exports.import=function(){return{type:"Import"}},exports.importAttribute=function(key,value){const node={type:"ImportAttribute",key,value},defs=NODE_FIELDS.ImportAttribute;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),node},exports.importDeclaration=function(specifiers,source){const node={type:"ImportDeclaration",specifiers,source},defs=NODE_FIELDS.ImportDeclaration;return validate(defs.specifiers,node,"specifiers",specifiers,1),validate(defs.source,node,"source",source,1),node},exports.importDefaultSpecifier=function(local){const node={type:"ImportDefaultSpecifier",local},defs=NODE_FIELDS.ImportDefaultSpecifier;return validate(defs.local,node,"local",local,1),node},exports.importExpression=function(source,options=null){const node={type:"ImportExpression",source,options},defs=NODE_FIELDS.ImportExpression;return validate(defs.source,node,"source",source,1),validate(defs.options,node,"options",options,1),node},exports.importNamespaceSpecifier=function(local){const node={type:"ImportNamespaceSpecifier",local},defs=NODE_FIELDS.ImportNamespaceSpecifier;return validate(defs.local,node,"local",local,1),node},exports.importSpecifier=function(local,imported){const node={type:"ImportSpecifier",local,imported},defs=NODE_FIELDS.ImportSpecifier;return validate(defs.local,node,"local",local,1),validate(defs.imported,node,"imported",imported,1),node},exports.indexedAccessType=function(objectType,indexType){const node={type:"IndexedAccessType",objectType,indexType},defs=NODE_FIELDS.IndexedAccessType;return validate(defs.objectType,node,"objectType",objectType,1),validate(defs.indexType,node,"indexType",indexType,1),node},exports.inferredPredicate=function(){return{type:"InferredPredicate"}},exports.interfaceDeclaration=function(id,typeParameters=null,_extends=null,body){const node={type:"InterfaceDeclaration",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.InterfaceDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.interfaceExtends=function(id,typeParameters=null){const node={type:"InterfaceExtends",id,typeParameters},defs=NODE_FIELDS.InterfaceExtends;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.interfaceTypeAnnotation=function(_extends=null,body){const node={type:"InterfaceTypeAnnotation",extends:_extends,body},defs=NODE_FIELDS.InterfaceTypeAnnotation;return validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.interpreterDirective=function(value){const node={type:"InterpreterDirective",value},defs=NODE_FIELDS.InterpreterDirective;return validate(defs.value,node,"value",value),node},exports.intersectionTypeAnnotation=function(types){const node={type:"IntersectionTypeAnnotation",types},defs=NODE_FIELDS.IntersectionTypeAnnotation;return validate(defs.types,node,"types",types,1),node},exports.jSXAttribute=exports.jsxAttribute=function(name,value=null){const node={type:"JSXAttribute",name,value},defs=NODE_FIELDS.JSXAttribute;return validate(defs.name,node,"name",name,1),validate(defs.value,node,"value",value,1),node},exports.jSXClosingElement=exports.jsxClosingElement=function(name){const node={type:"JSXClosingElement",name},defs=NODE_FIELDS.JSXClosingElement;return validate(defs.name,node,"name",name,1),node},exports.jSXClosingFragment=exports.jsxClosingFragment=function(){return{type:"JSXClosingFragment"}},exports.jSXElement=exports.jsxElement=function(openingElement,closingElement=null,children,selfClosing=null){const node={type:"JSXElement",openingElement,closingElement,children,selfClosing},defs=NODE_FIELDS.JSXElement;return validate(defs.openingElement,node,"openingElement",openingElement,1),validate(defs.closingElement,node,"closingElement",closingElement,1),validate(defs.children,node,"children",children,1),validate(defs.selfClosing,node,"selfClosing",selfClosing),node},exports.jSXEmptyExpression=exports.jsxEmptyExpression=function(){return{type:"JSXEmptyExpression"}},exports.jSXExpressionContainer=exports.jsxExpressionContainer=function(expression){const node={type:"JSXExpressionContainer",expression},defs=NODE_FIELDS.JSXExpressionContainer;return validate(defs.expression,node,"expression",expression,1),node},exports.jSXFragment=exports.jsxFragment=function(openingFragment,closingFragment,children){const node={type:"JSXFragment",openingFragment,closingFragment,children},defs=NODE_FIELDS.JSXFragment;return validate(defs.openingFragment,node,"openingFragment",openingFragment,1),validate(defs.closingFragment,node,"closingFragment",closingFragment,1),validate(defs.children,node,"children",children,1),node},exports.jSXIdentifier=exports.jsxIdentifier=function(name){const node={type:"JSXIdentifier",name},defs=NODE_FIELDS.JSXIdentifier;return validate(defs.name,node,"name",name),node},exports.jSXMemberExpression=exports.jsxMemberExpression=function(object,property){const node={type:"JSXMemberExpression",object,property},defs=NODE_FIELDS.JSXMemberExpression;return validate(defs.object,node,"object",object,1),validate(defs.property,node,"property",property,1),node},exports.jSXNamespacedName=exports.jsxNamespacedName=function(namespace,name){const node={type:"JSXNamespacedName",namespace,name},defs=NODE_FIELDS.JSXNamespacedName;return validate(defs.namespace,node,"namespace",namespace,1),validate(defs.name,node,"name",name,1),node},exports.jSXOpeningElement=exports.jsxOpeningElement=function(name,attributes,selfClosing=!1){const node={type:"JSXOpeningElement",name,attributes,selfClosing},defs=NODE_FIELDS.JSXOpeningElement;return validate(defs.name,node,"name",name,1),validate(defs.attributes,node,"attributes",attributes,1),validate(defs.selfClosing,node,"selfClosing",selfClosing),node},exports.jSXOpeningFragment=exports.jsxOpeningFragment=function(){return{type:"JSXOpeningFragment"}},exports.jSXSpreadAttribute=exports.jsxSpreadAttribute=function(argument){const node={type:"JSXSpreadAttribute",argument},defs=NODE_FIELDS.JSXSpreadAttribute;return validate(defs.argument,node,"argument",argument,1),node},exports.jSXSpreadChild=exports.jsxSpreadChild=function(expression){const node={type:"JSXSpreadChild",expression},defs=NODE_FIELDS.JSXSpreadChild;return validate(defs.expression,node,"expression",expression,1),node},exports.jSXText=exports.jsxText=function(value){const node={type:"JSXText",value},defs=NODE_FIELDS.JSXText;return validate(defs.value,node,"value",value),node},exports.labeledStatement=function(label,body){const node={type:"LabeledStatement",label,body},defs=NODE_FIELDS.LabeledStatement;return validate(defs.label,node,"label",label,1),validate(defs.body,node,"body",body,1),node},exports.logicalExpression=function(operator,left,right){const node={type:"LogicalExpression",operator,left,right},defs=NODE_FIELDS.LogicalExpression;return validate(defs.operator,node,"operator",operator),validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.memberExpression=function(object,property,computed=!1,optional=null){const node={type:"MemberExpression",object,property,computed,optional},defs=NODE_FIELDS.MemberExpression;return validate(defs.object,node,"object",object,1),validate(defs.property,node,"property",property,1),validate(defs.computed,node,"computed",computed),validate(defs.optional,node,"optional",optional),node},exports.metaProperty=function(meta,property){const node={type:"MetaProperty",meta,property},defs=NODE_FIELDS.MetaProperty;return validate(defs.meta,node,"meta",meta,1),validate(defs.property,node,"property",property,1),node},exports.mixedTypeAnnotation=function(){return{type:"MixedTypeAnnotation"}},exports.moduleExpression=function(body){const node={type:"ModuleExpression",body},defs=NODE_FIELDS.ModuleExpression;return validate(defs.body,node,"body",body,1),node},exports.newExpression=function(callee,_arguments){const node={type:"NewExpression",callee,arguments:_arguments},defs=NODE_FIELDS.NewExpression;return validate(defs.callee,node,"callee",callee,1),validate(defs.arguments,node,"arguments",_arguments,1),node},exports.noop=function(){return{type:"Noop"}},exports.nullLiteral=function(){return{type:"NullLiteral"}},exports.nullLiteralTypeAnnotation=function(){return{type:"NullLiteralTypeAnnotation"}},exports.nullableTypeAnnotation=function(typeAnnotation){const node={type:"NullableTypeAnnotation",typeAnnotation},defs=NODE_FIELDS.NullableTypeAnnotation;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.numberLiteral=function(value){return(0,_deprecationWarning.default)("NumberLiteral","NumericLiteral","The node type "),numericLiteral(value)},exports.numberLiteralTypeAnnotation=function(value){const node={type:"NumberLiteralTypeAnnotation",value},defs=NODE_FIELDS.NumberLiteralTypeAnnotation;return validate(defs.value,node,"value",value),node},exports.numberTypeAnnotation=function(){return{type:"NumberTypeAnnotation"}},exports.numericLiteral=numericLiteral,exports.objectExpression=function(properties){const node={type:"ObjectExpression",properties},defs=NODE_FIELDS.ObjectExpression;return validate(defs.properties,node,"properties",properties,1),node},exports.objectMethod=function(kind="method",key,params,body,computed=!1,generator=!1,async=!1){const node={type:"ObjectMethod",kind,key,params,body,computed,generator,async},defs=NODE_FIELDS.ObjectMethod;return validate(defs.kind,node,"kind",kind),validate(defs.key,node,"key",key,1),validate(defs.params,node,"params",params,1),validate(defs.body,node,"body",body,1),validate(defs.computed,node,"computed",computed),validate(defs.generator,node,"generator",generator),validate(defs.async,node,"async",async),node},exports.objectPattern=function(properties){const node={type:"ObjectPattern",properties},defs=NODE_FIELDS.ObjectPattern;return validate(defs.properties,node,"properties",properties,1),node},exports.objectProperty=function(key,value,computed=!1,shorthand=!1,decorators=null){const node={type:"ObjectProperty",key,value,computed,shorthand,decorators},defs=NODE_FIELDS.ObjectProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.computed,node,"computed",computed),validate(defs.shorthand,node,"shorthand",shorthand),validate(defs.decorators,node,"decorators",decorators,1),node},exports.objectTypeAnnotation=function(properties,indexers=[],callProperties=[],internalSlots=[],exact=!1){const node={type:"ObjectTypeAnnotation",properties,indexers,callProperties,internalSlots,exact},defs=NODE_FIELDS.ObjectTypeAnnotation;return validate(defs.properties,node,"properties",properties,1),validate(defs.indexers,node,"indexers",indexers,1),validate(defs.callProperties,node,"callProperties",callProperties,1),validate(defs.internalSlots,node,"internalSlots",internalSlots,1),validate(defs.exact,node,"exact",exact),node},exports.objectTypeCallProperty=function(value){const node={type:"ObjectTypeCallProperty",value,static:null},defs=NODE_FIELDS.ObjectTypeCallProperty;return validate(defs.value,node,"value",value,1),node},exports.objectTypeIndexer=function(id=null,key,value,variance=null){const node={type:"ObjectTypeIndexer",id,key,value,variance,static:null},defs=NODE_FIELDS.ObjectTypeIndexer;return validate(defs.id,node,"id",id,1),validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.variance,node,"variance",variance,1),node},exports.objectTypeInternalSlot=function(id,value,optional,_static,method){const node={type:"ObjectTypeInternalSlot",id,value,optional,static:_static,method},defs=NODE_FIELDS.ObjectTypeInternalSlot;return validate(defs.id,node,"id",id,1),validate(defs.value,node,"value",value,1),validate(defs.optional,node,"optional",optional),validate(defs.static,node,"static",_static),validate(defs.method,node,"method",method),node},exports.objectTypeProperty=function(key,value,variance=null){const node={type:"ObjectTypeProperty",key,value,variance,kind:null,method:null,optional:null,proto:null,static:null},defs=NODE_FIELDS.ObjectTypeProperty;return validate(defs.key,node,"key",key,1),validate(defs.value,node,"value",value,1),validate(defs.variance,node,"variance",variance,1),node},exports.objectTypeSpreadProperty=function(argument){const node={type:"ObjectTypeSpreadProperty",argument},defs=NODE_FIELDS.ObjectTypeSpreadProperty;return validate(defs.argument,node,"argument",argument,1),node},exports.opaqueType=function(id,typeParameters=null,supertype=null,impltype){const node={type:"OpaqueType",id,typeParameters,supertype,impltype},defs=NODE_FIELDS.OpaqueType;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.supertype,node,"supertype",supertype,1),validate(defs.impltype,node,"impltype",impltype,1),node},exports.optionalCallExpression=function(callee,_arguments,optional){const node={type:"OptionalCallExpression",callee,arguments:_arguments,optional},defs=NODE_FIELDS.OptionalCallExpression;return validate(defs.callee,node,"callee",callee,1),validate(defs.arguments,node,"arguments",_arguments,1),validate(defs.optional,node,"optional",optional),node},exports.optionalIndexedAccessType=function(objectType,indexType){const node={type:"OptionalIndexedAccessType",objectType,indexType,optional:null},defs=NODE_FIELDS.OptionalIndexedAccessType;return validate(defs.objectType,node,"objectType",objectType,1),validate(defs.indexType,node,"indexType",indexType,1),node},exports.optionalMemberExpression=function(object,property,computed=!1,optional){const node={type:"OptionalMemberExpression",object,property,computed,optional},defs=NODE_FIELDS.OptionalMemberExpression;return validate(defs.object,node,"object",object,1),validate(defs.property,node,"property",property,1),validate(defs.computed,node,"computed",computed),validate(defs.optional,node,"optional",optional),node},exports.parenthesizedExpression=function(expression){const node={type:"ParenthesizedExpression",expression},defs=NODE_FIELDS.ParenthesizedExpression;return validate(defs.expression,node,"expression",expression,1),node},exports.pipelineBareFunction=function(callee){const node={type:"PipelineBareFunction",callee},defs=NODE_FIELDS.PipelineBareFunction;return validate(defs.callee,node,"callee",callee,1),node},exports.pipelinePrimaryTopicReference=function(){return{type:"PipelinePrimaryTopicReference"}},exports.pipelineTopicExpression=function(expression){const node={type:"PipelineTopicExpression",expression},defs=NODE_FIELDS.PipelineTopicExpression;return validate(defs.expression,node,"expression",expression,1),node},exports.placeholder=function(expectedNode,name){const node={type:"Placeholder",expectedNode,name},defs=NODE_FIELDS.Placeholder;return validate(defs.expectedNode,node,"expectedNode",expectedNode),validate(defs.name,node,"name",name,1),node},exports.privateName=function(id){const node={type:"PrivateName",id},defs=NODE_FIELDS.PrivateName;return validate(defs.id,node,"id",id,1),node},exports.program=function(body,directives=[],sourceType="script",interpreter=null){const node={type:"Program",body,directives,sourceType,interpreter},defs=NODE_FIELDS.Program;return validate(defs.body,node,"body",body,1),validate(defs.directives,node,"directives",directives,1),validate(defs.sourceType,node,"sourceType",sourceType),validate(defs.interpreter,node,"interpreter",interpreter,1),node},exports.qualifiedTypeIdentifier=function(id,qualification){const node={type:"QualifiedTypeIdentifier",id,qualification},defs=NODE_FIELDS.QualifiedTypeIdentifier;return validate(defs.id,node,"id",id,1),validate(defs.qualification,node,"qualification",qualification,1),node},exports.recordExpression=function(properties){const node={type:"RecordExpression",properties},defs=NODE_FIELDS.RecordExpression;return validate(defs.properties,node,"properties",properties,1),node},exports.regExpLiteral=regExpLiteral,exports.regexLiteral=function(pattern,flags=""){return(0,_deprecationWarning.default)("RegexLiteral","RegExpLiteral","The node type "),regExpLiteral(pattern,flags)},exports.restElement=restElement,exports.restProperty=function(argument){return(0,_deprecationWarning.default)("RestProperty","RestElement","The node type "),restElement(argument)},exports.returnStatement=function(argument=null){const node={type:"ReturnStatement",argument},defs=NODE_FIELDS.ReturnStatement;return validate(defs.argument,node,"argument",argument,1),node},exports.sequenceExpression=function(expressions){const node={type:"SequenceExpression",expressions},defs=NODE_FIELDS.SequenceExpression;return validate(defs.expressions,node,"expressions",expressions,1),node},exports.spreadElement=spreadElement,exports.spreadProperty=function(argument){return(0,_deprecationWarning.default)("SpreadProperty","SpreadElement","The node type "),spreadElement(argument)},exports.staticBlock=function(body){const node={type:"StaticBlock",body},defs=NODE_FIELDS.StaticBlock;return validate(defs.body,node,"body",body,1),node},exports.stringLiteral=function(value){const node={type:"StringLiteral",value},defs=NODE_FIELDS.StringLiteral;return validate(defs.value,node,"value",value),node},exports.stringLiteralTypeAnnotation=function(value){const node={type:"StringLiteralTypeAnnotation",value},defs=NODE_FIELDS.StringLiteralTypeAnnotation;return validate(defs.value,node,"value",value),node},exports.stringTypeAnnotation=function(){return{type:"StringTypeAnnotation"}},exports.super=function(){return{type:"Super"}},exports.switchCase=function(test=null,consequent){const node={type:"SwitchCase",test,consequent},defs=NODE_FIELDS.SwitchCase;return validate(defs.test,node,"test",test,1),validate(defs.consequent,node,"consequent",consequent,1),node},exports.switchStatement=function(discriminant,cases){const node={type:"SwitchStatement",discriminant,cases},defs=NODE_FIELDS.SwitchStatement;return validate(defs.discriminant,node,"discriminant",discriminant,1),validate(defs.cases,node,"cases",cases,1),node},exports.symbolTypeAnnotation=function(){return{type:"SymbolTypeAnnotation"}},exports.taggedTemplateExpression=function(tag,quasi){const node={type:"TaggedTemplateExpression",tag,quasi},defs=NODE_FIELDS.TaggedTemplateExpression;return validate(defs.tag,node,"tag",tag,1),validate(defs.quasi,node,"quasi",quasi,1),node},exports.templateElement=function(value,tail=!1){const node={type:"TemplateElement",value,tail},defs=NODE_FIELDS.TemplateElement;return validate(defs.value,node,"value",value),validate(defs.tail,node,"tail",tail),node},exports.templateLiteral=function(quasis,expressions){const node={type:"TemplateLiteral",quasis,expressions},defs=NODE_FIELDS.TemplateLiteral;return validate(defs.quasis,node,"quasis",quasis,1),validate(defs.expressions,node,"expressions",expressions,1),node},exports.thisExpression=function(){return{type:"ThisExpression"}},exports.thisTypeAnnotation=function(){return{type:"ThisTypeAnnotation"}},exports.throwStatement=function(argument){const node={type:"ThrowStatement",argument},defs=NODE_FIELDS.ThrowStatement;return validate(defs.argument,node,"argument",argument,1),node},exports.topicReference=function(){return{type:"TopicReference"}},exports.tryStatement=function(block,handler=null,finalizer=null){const node={type:"TryStatement",block,handler,finalizer},defs=NODE_FIELDS.TryStatement;return validate(defs.block,node,"block",block,1),validate(defs.handler,node,"handler",handler,1),validate(defs.finalizer,node,"finalizer",finalizer,1),node},exports.tSAnyKeyword=exports.tsAnyKeyword=function(){return{type:"TSAnyKeyword"}},exports.tSArrayType=exports.tsArrayType=function(elementType){const node={type:"TSArrayType",elementType},defs=NODE_FIELDS.TSArrayType;return validate(defs.elementType,node,"elementType",elementType,1),node},exports.tSAsExpression=exports.tsAsExpression=function(expression,typeAnnotation){const node={type:"TSAsExpression",expression,typeAnnotation},defs=NODE_FIELDS.TSAsExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSBigIntKeyword=exports.tsBigIntKeyword=function(){return{type:"TSBigIntKeyword"}},exports.tSBooleanKeyword=exports.tsBooleanKeyword=function(){return{type:"TSBooleanKeyword"}},exports.tSCallSignatureDeclaration=exports.tsCallSignatureDeclaration=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSCallSignatureDeclaration",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSCallSignatureDeclaration;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSConditionalType=exports.tsConditionalType=function(checkType,extendsType,trueType,falseType){const node={type:"TSConditionalType",checkType,extendsType,trueType,falseType},defs=NODE_FIELDS.TSConditionalType;return validate(defs.checkType,node,"checkType",checkType,1),validate(defs.extendsType,node,"extendsType",extendsType,1),validate(defs.trueType,node,"trueType",trueType,1),validate(defs.falseType,node,"falseType",falseType,1),node},exports.tSConstructSignatureDeclaration=exports.tsConstructSignatureDeclaration=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSConstructSignatureDeclaration",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSConstructSignatureDeclaration;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSConstructorType=exports.tsConstructorType=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSConstructorType",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSConstructorType;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSDeclareFunction=exports.tsDeclareFunction=function(id=null,typeParameters=null,params,returnType=null){const node={type:"TSDeclareFunction",id,typeParameters,params,returnType},defs=NODE_FIELDS.TSDeclareFunction;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.params,node,"params",params,1),validate(defs.returnType,node,"returnType",returnType,1),node},exports.tSDeclareMethod=exports.tsDeclareMethod=function(decorators=null,key,typeParameters=null,params,returnType=null){const node={type:"TSDeclareMethod",decorators,key,typeParameters,params,returnType},defs=NODE_FIELDS.TSDeclareMethod;return validate(defs.decorators,node,"decorators",decorators,1),validate(defs.key,node,"key",key,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.params,node,"params",params,1),validate(defs.returnType,node,"returnType",returnType,1),node},exports.tSEnumDeclaration=exports.tsEnumDeclaration=function(id,members){const node={type:"TSEnumDeclaration",id,members},defs=NODE_FIELDS.TSEnumDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.members,node,"members",members,1),node},exports.tSEnumMember=exports.tsEnumMember=function(id,initializer=null){const node={type:"TSEnumMember",id,initializer},defs=NODE_FIELDS.TSEnumMember;return validate(defs.id,node,"id",id,1),validate(defs.initializer,node,"initializer",initializer,1),node},exports.tSExportAssignment=exports.tsExportAssignment=function(expression){const node={type:"TSExportAssignment",expression},defs=NODE_FIELDS.TSExportAssignment;return validate(defs.expression,node,"expression",expression,1),node},exports.tSExpressionWithTypeArguments=exports.tsExpressionWithTypeArguments=function(expression,typeParameters=null){const node={type:"TSExpressionWithTypeArguments",expression,typeParameters},defs=NODE_FIELDS.TSExpressionWithTypeArguments;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSExternalModuleReference=exports.tsExternalModuleReference=function(expression){const node={type:"TSExternalModuleReference",expression},defs=NODE_FIELDS.TSExternalModuleReference;return validate(defs.expression,node,"expression",expression,1),node},exports.tSFunctionType=exports.tsFunctionType=function(typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSFunctionType",typeParameters,parameters,typeAnnotation},defs=NODE_FIELDS.TSFunctionType;return validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSImportEqualsDeclaration=exports.tsImportEqualsDeclaration=function(id,moduleReference){const node={type:"TSImportEqualsDeclaration",id,moduleReference,isExport:null},defs=NODE_FIELDS.TSImportEqualsDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.moduleReference,node,"moduleReference",moduleReference,1),node},exports.tSImportType=exports.tsImportType=function(argument,qualifier=null,typeParameters=null){const node={type:"TSImportType",argument,qualifier,typeParameters},defs=NODE_FIELDS.TSImportType;return validate(defs.argument,node,"argument",argument,1),validate(defs.qualifier,node,"qualifier",qualifier,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSIndexSignature=exports.tsIndexSignature=function(parameters,typeAnnotation=null){const node={type:"TSIndexSignature",parameters,typeAnnotation},defs=NODE_FIELDS.TSIndexSignature;return validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSIndexedAccessType=exports.tsIndexedAccessType=function(objectType,indexType){const node={type:"TSIndexedAccessType",objectType,indexType},defs=NODE_FIELDS.TSIndexedAccessType;return validate(defs.objectType,node,"objectType",objectType,1),validate(defs.indexType,node,"indexType",indexType,1),node},exports.tSInferType=exports.tsInferType=function(typeParameter){const node={type:"TSInferType",typeParameter},defs=NODE_FIELDS.TSInferType;return validate(defs.typeParameter,node,"typeParameter",typeParameter,1),node},exports.tSInstantiationExpression=exports.tsInstantiationExpression=function(expression,typeParameters=null){const node={type:"TSInstantiationExpression",expression,typeParameters},defs=NODE_FIELDS.TSInstantiationExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSInterfaceBody=exports.tsInterfaceBody=function(body){const node={type:"TSInterfaceBody",body},defs=NODE_FIELDS.TSInterfaceBody;return validate(defs.body,node,"body",body,1),node},exports.tSInterfaceDeclaration=exports.tsInterfaceDeclaration=function(id,typeParameters=null,_extends=null,body){const node={type:"TSInterfaceDeclaration",id,typeParameters,extends:_extends,body},defs=NODE_FIELDS.TSInterfaceDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.extends,node,"extends",_extends,1),validate(defs.body,node,"body",body,1),node},exports.tSIntersectionType=exports.tsIntersectionType=function(types){const node={type:"TSIntersectionType",types},defs=NODE_FIELDS.TSIntersectionType;return validate(defs.types,node,"types",types,1),node},exports.tSIntrinsicKeyword=exports.tsIntrinsicKeyword=function(){return{type:"TSIntrinsicKeyword"}},exports.tSLiteralType=exports.tsLiteralType=function(literal){const node={type:"TSLiteralType",literal},defs=NODE_FIELDS.TSLiteralType;return validate(defs.literal,node,"literal",literal,1),node},exports.tSMappedType=exports.tsMappedType=function(typeParameter,typeAnnotation=null,nameType=null){const node={type:"TSMappedType",typeParameter,typeAnnotation,nameType},defs=NODE_FIELDS.TSMappedType;return validate(defs.typeParameter,node,"typeParameter",typeParameter,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.nameType,node,"nameType",nameType,1),node},exports.tSMethodSignature=exports.tsMethodSignature=function(key,typeParameters=null,parameters,typeAnnotation=null){const node={type:"TSMethodSignature",key,typeParameters,parameters,typeAnnotation,kind:null},defs=NODE_FIELDS.TSMethodSignature;return validate(defs.key,node,"key",key,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.parameters,node,"parameters",parameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSModuleBlock=exports.tsModuleBlock=function(body){const node={type:"TSModuleBlock",body},defs=NODE_FIELDS.TSModuleBlock;return validate(defs.body,node,"body",body,1),node},exports.tSModuleDeclaration=exports.tsModuleDeclaration=function(id,body){const node={type:"TSModuleDeclaration",id,body,kind:null},defs=NODE_FIELDS.TSModuleDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.body,node,"body",body,1),node},exports.tSNamedTupleMember=exports.tsNamedTupleMember=function(label,elementType,optional=!1){const node={type:"TSNamedTupleMember",label,elementType,optional},defs=NODE_FIELDS.TSNamedTupleMember;return validate(defs.label,node,"label",label,1),validate(defs.elementType,node,"elementType",elementType,1),validate(defs.optional,node,"optional",optional),node},exports.tSNamespaceExportDeclaration=exports.tsNamespaceExportDeclaration=function(id){const node={type:"TSNamespaceExportDeclaration",id},defs=NODE_FIELDS.TSNamespaceExportDeclaration;return validate(defs.id,node,"id",id,1),node},exports.tSNeverKeyword=exports.tsNeverKeyword=function(){return{type:"TSNeverKeyword"}},exports.tSNonNullExpression=exports.tsNonNullExpression=function(expression){const node={type:"TSNonNullExpression",expression},defs=NODE_FIELDS.TSNonNullExpression;return validate(defs.expression,node,"expression",expression,1),node},exports.tSNullKeyword=exports.tsNullKeyword=function(){return{type:"TSNullKeyword"}},exports.tSNumberKeyword=exports.tsNumberKeyword=function(){return{type:"TSNumberKeyword"}},exports.tSObjectKeyword=exports.tsObjectKeyword=function(){return{type:"TSObjectKeyword"}},exports.tSOptionalType=exports.tsOptionalType=function(typeAnnotation){const node={type:"TSOptionalType",typeAnnotation},defs=NODE_FIELDS.TSOptionalType;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSParameterProperty=exports.tsParameterProperty=function(parameter){const node={type:"TSParameterProperty",parameter},defs=NODE_FIELDS.TSParameterProperty;return validate(defs.parameter,node,"parameter",parameter,1),node},exports.tSParenthesizedType=exports.tsParenthesizedType=function(typeAnnotation){const node={type:"TSParenthesizedType",typeAnnotation},defs=NODE_FIELDS.TSParenthesizedType;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSPropertySignature=exports.tsPropertySignature=function(key,typeAnnotation=null){const node={type:"TSPropertySignature",key,typeAnnotation,kind:null},defs=NODE_FIELDS.TSPropertySignature;return validate(defs.key,node,"key",key,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSQualifiedName=exports.tsQualifiedName=function(left,right){const node={type:"TSQualifiedName",left,right},defs=NODE_FIELDS.TSQualifiedName;return validate(defs.left,node,"left",left,1),validate(defs.right,node,"right",right,1),node},exports.tSRestType=exports.tsRestType=function(typeAnnotation){const node={type:"TSRestType",typeAnnotation},defs=NODE_FIELDS.TSRestType;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSSatisfiesExpression=exports.tsSatisfiesExpression=function(expression,typeAnnotation){const node={type:"TSSatisfiesExpression",expression,typeAnnotation},defs=NODE_FIELDS.TSSatisfiesExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSStringKeyword=exports.tsStringKeyword=function(){return{type:"TSStringKeyword"}},exports.tSSymbolKeyword=exports.tsSymbolKeyword=function(){return{type:"TSSymbolKeyword"}},exports.tSThisType=exports.tsThisType=function(){return{type:"TSThisType"}},exports.tSTupleType=exports.tsTupleType=function(elementTypes){const node={type:"TSTupleType",elementTypes},defs=NODE_FIELDS.TSTupleType;return validate(defs.elementTypes,node,"elementTypes",elementTypes,1),node},exports.tSTypeAliasDeclaration=exports.tsTypeAliasDeclaration=function(id,typeParameters=null,typeAnnotation){const node={type:"TSTypeAliasDeclaration",id,typeParameters,typeAnnotation},defs=NODE_FIELDS.TSTypeAliasDeclaration;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSTypeAnnotation=exports.tsTypeAnnotation=function(typeAnnotation){const node={type:"TSTypeAnnotation",typeAnnotation},defs=NODE_FIELDS.TSTypeAnnotation;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSTypeAssertion=exports.tsTypeAssertion=function(typeAnnotation,expression){const node={type:"TSTypeAssertion",typeAnnotation,expression},defs=NODE_FIELDS.TSTypeAssertion;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.expression,node,"expression",expression,1),node},exports.tSTypeLiteral=exports.tsTypeLiteral=function(members){const node={type:"TSTypeLiteral",members},defs=NODE_FIELDS.TSTypeLiteral;return validate(defs.members,node,"members",members,1),node},exports.tSTypeOperator=exports.tsTypeOperator=function(typeAnnotation){const node={type:"TSTypeOperator",typeAnnotation,operator:null},defs=NODE_FIELDS.TSTypeOperator;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.tSTypeParameter=exports.tsTypeParameter=function(constraint=null,_default=null,name){const node={type:"TSTypeParameter",constraint,default:_default,name},defs=NODE_FIELDS.TSTypeParameter;return validate(defs.constraint,node,"constraint",constraint,1),validate(defs.default,node,"default",_default,1),validate(defs.name,node,"name",name),node},exports.tSTypeParameterDeclaration=exports.tsTypeParameterDeclaration=function(params){const node={type:"TSTypeParameterDeclaration",params},defs=NODE_FIELDS.TSTypeParameterDeclaration;return validate(defs.params,node,"params",params,1),node},exports.tSTypeParameterInstantiation=exports.tsTypeParameterInstantiation=function(params){const node={type:"TSTypeParameterInstantiation",params},defs=NODE_FIELDS.TSTypeParameterInstantiation;return validate(defs.params,node,"params",params,1),node},exports.tSTypePredicate=exports.tsTypePredicate=function(parameterName,typeAnnotation=null,asserts=null){const node={type:"TSTypePredicate",parameterName,typeAnnotation,asserts},defs=NODE_FIELDS.TSTypePredicate;return validate(defs.parameterName,node,"parameterName",parameterName,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),validate(defs.asserts,node,"asserts",asserts),node},exports.tSTypeQuery=exports.tsTypeQuery=function(exprName,typeParameters=null){const node={type:"TSTypeQuery",exprName,typeParameters},defs=NODE_FIELDS.TSTypeQuery;return validate(defs.exprName,node,"exprName",exprName,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSTypeReference=exports.tsTypeReference=function(typeName,typeParameters=null){const node={type:"TSTypeReference",typeName,typeParameters},defs=NODE_FIELDS.TSTypeReference;return validate(defs.typeName,node,"typeName",typeName,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),node},exports.tSUndefinedKeyword=exports.tsUndefinedKeyword=function(){return{type:"TSUndefinedKeyword"}},exports.tSUnionType=exports.tsUnionType=function(types){const node={type:"TSUnionType",types},defs=NODE_FIELDS.TSUnionType;return validate(defs.types,node,"types",types,1),node},exports.tSUnknownKeyword=exports.tsUnknownKeyword=function(){return{type:"TSUnknownKeyword"}},exports.tSVoidKeyword=exports.tsVoidKeyword=function(){return{type:"TSVoidKeyword"}},exports.tupleExpression=function(elements=[]){const node={type:"TupleExpression",elements},defs=NODE_FIELDS.TupleExpression;return validate(defs.elements,node,"elements",elements,1),node},exports.tupleTypeAnnotation=function(types){const node={type:"TupleTypeAnnotation",types},defs=NODE_FIELDS.TupleTypeAnnotation;return validate(defs.types,node,"types",types,1),node},exports.typeAlias=function(id,typeParameters=null,right){const node={type:"TypeAlias",id,typeParameters,right},defs=NODE_FIELDS.TypeAlias;return validate(defs.id,node,"id",id,1),validate(defs.typeParameters,node,"typeParameters",typeParameters,1),validate(defs.right,node,"right",right,1),node},exports.typeAnnotation=function(typeAnnotation){const node={type:"TypeAnnotation",typeAnnotation},defs=NODE_FIELDS.TypeAnnotation;return validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.typeCastExpression=function(expression,typeAnnotation){const node={type:"TypeCastExpression",expression,typeAnnotation},defs=NODE_FIELDS.TypeCastExpression;return validate(defs.expression,node,"expression",expression,1),validate(defs.typeAnnotation,node,"typeAnnotation",typeAnnotation,1),node},exports.typeParameter=function(bound=null,_default=null,variance=null){const node={type:"TypeParameter",bound,default:_default,variance,name:null},defs=NODE_FIELDS.TypeParameter;return validate(defs.bound,node,"bound",bound,1),validate(defs.default,node,"default",_default,1),validate(defs.variance,node,"variance",variance,1),node},exports.typeParameterDeclaration=function(params){const node={type:"TypeParameterDeclaration",params},defs=NODE_FIELDS.TypeParameterDeclaration;return validate(defs.params,node,"params",params,1),node},exports.typeParameterInstantiation=function(params){const node={type:"TypeParameterInstantiation",params},defs=NODE_FIELDS.TypeParameterInstantiation;return validate(defs.params,node,"params",params,1),node},exports.typeofTypeAnnotation=function(argument){const node={type:"TypeofTypeAnnotation",argument},defs=NODE_FIELDS.TypeofTypeAnnotation;return validate(defs.argument,node,"argument",argument,1),node},exports.unaryExpression=function(operator,argument,prefix=!0){const node={type:"UnaryExpression",operator,argument,prefix},defs=NODE_FIELDS.UnaryExpression;return validate(defs.operator,node,"operator",operator),validate(defs.argument,node,"argument",argument,1),validate(defs.prefix,node,"prefix",prefix),node},exports.unionTypeAnnotation=function(types){const node={type:"UnionTypeAnnotation",types},defs=NODE_FIELDS.UnionTypeAnnotation;return validate(defs.types,node,"types",types,1),node},exports.updateExpression=function(operator,argument,prefix=!1){const node={type:"UpdateExpression",operator,argument,prefix},defs=NODE_FIELDS.UpdateExpression;return validate(defs.operator,node,"operator",operator),validate(defs.argument,node,"argument",argument,1),validate(defs.prefix,node,"prefix",prefix),node},exports.v8IntrinsicIdentifier=function(name){const node={type:"V8IntrinsicIdentifier",name},defs=NODE_FIELDS.V8IntrinsicIdentifier;return validate(defs.name,node,"name",name),node},exports.variableDeclaration=function(kind,declarations){const node={type:"VariableDeclaration",kind,declarations},defs=NODE_FIELDS.VariableDeclaration;return validate(defs.kind,node,"kind",kind),validate(defs.declarations,node,"declarations",declarations,1),node},exports.variableDeclarator=function(id,init=null){const node={type:"VariableDeclarator",id,init},defs=NODE_FIELDS.VariableDeclarator;return validate(defs.id,node,"id",id,1),validate(defs.init,node,"init",init,1),node},exports.variance=function(kind){const node={type:"Variance",kind},defs=NODE_FIELDS.Variance;return validate(defs.kind,node,"kind",kind),node},exports.voidTypeAnnotation=function(){return{type:"VoidTypeAnnotation"}},exports.whileStatement=function(test,body){const node={type:"WhileStatement",test,body},defs=NODE_FIELDS.WhileStatement;return validate(defs.test,node,"test",test,1),validate(defs.body,node,"body",body,1),node},exports.withStatement=function(object,body){const node={type:"WithStatement",object,body},defs=NODE_FIELDS.WithStatement;return validate(defs.object,node,"object",object,1),validate(defs.body,node,"body",body,1),node},exports.yieldExpression=function(argument=null,delegate=!1){const node={type:"YieldExpression",argument,delegate},defs=NODE_FIELDS.YieldExpression;return validate(defs.argument,node,"argument",argument,1),validate(defs.delegate,node,"delegate",delegate),node};var _validate=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js"),_deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js"),utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const{validateInternal:validate}=_validate,{NODE_FIELDS}=utils;function numericLiteral(value){const node={type:"NumericLiteral",value},defs=NODE_FIELDS.NumericLiteral;return validate(defs.value,node,"value",value),node}function regExpLiteral(pattern,flags=""){const node={type:"RegExpLiteral",pattern,flags},defs=NODE_FIELDS.RegExpLiteral;return validate(defs.pattern,node,"pattern",pattern),validate(defs.flags,node,"flags",flags),node}function restElement(argument){const node={type:"RestElement",argument},defs=NODE_FIELDS.RestElement;return validate(defs.argument,node,"argument",argument,1),node}function spreadElement(argument){const node={type:"SpreadElement",argument},defs=NODE_FIELDS.SpreadElement;return validate(defs.argument,node,"argument",argument,1),node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/uppercase.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AnyTypeAnnotation",{enumerable:!0,get:function(){return _index.anyTypeAnnotation}}),Object.defineProperty(exports,"ArgumentPlaceholder",{enumerable:!0,get:function(){return _index.argumentPlaceholder}}),Object.defineProperty(exports,"ArrayExpression",{enumerable:!0,get:function(){return _index.arrayExpression}}),Object.defineProperty(exports,"ArrayPattern",{enumerable:!0,get:function(){return _index.arrayPattern}}),Object.defineProperty(exports,"ArrayTypeAnnotation",{enumerable:!0,get:function(){return _index.arrayTypeAnnotation}}),Object.defineProperty(exports,"ArrowFunctionExpression",{enumerable:!0,get:function(){return _index.arrowFunctionExpression}}),Object.defineProperty(exports,"AssignmentExpression",{enumerable:!0,get:function(){return _index.assignmentExpression}}),Object.defineProperty(exports,"AssignmentPattern",{enumerable:!0,get:function(){return _index.assignmentPattern}}),Object.defineProperty(exports,"AwaitExpression",{enumerable:!0,get:function(){return _index.awaitExpression}}),Object.defineProperty(exports,"BigIntLiteral",{enumerable:!0,get:function(){return _index.bigIntLiteral}}),Object.defineProperty(exports,"BinaryExpression",{enumerable:!0,get:function(){return _index.binaryExpression}}),Object.defineProperty(exports,"BindExpression",{enumerable:!0,get:function(){return _index.bindExpression}}),Object.defineProperty(exports,"BlockStatement",{enumerable:!0,get:function(){return _index.blockStatement}}),Object.defineProperty(exports,"BooleanLiteral",{enumerable:!0,get:function(){return _index.booleanLiteral}}),Object.defineProperty(exports,"BooleanLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.booleanLiteralTypeAnnotation}}),Object.defineProperty(exports,"BooleanTypeAnnotation",{enumerable:!0,get:function(){return _index.booleanTypeAnnotation}}),Object.defineProperty(exports,"BreakStatement",{enumerable:!0,get:function(){return _index.breakStatement}}),Object.defineProperty(exports,"CallExpression",{enumerable:!0,get:function(){return _index.callExpression}}),Object.defineProperty(exports,"CatchClause",{enumerable:!0,get:function(){return _index.catchClause}}),Object.defineProperty(exports,"ClassAccessorProperty",{enumerable:!0,get:function(){return _index.classAccessorProperty}}),Object.defineProperty(exports,"ClassBody",{enumerable:!0,get:function(){return _index.classBody}}),Object.defineProperty(exports,"ClassDeclaration",{enumerable:!0,get:function(){return _index.classDeclaration}}),Object.defineProperty(exports,"ClassExpression",{enumerable:!0,get:function(){return _index.classExpression}}),Object.defineProperty(exports,"ClassImplements",{enumerable:!0,get:function(){return _index.classImplements}}),Object.defineProperty(exports,"ClassMethod",{enumerable:!0,get:function(){return _index.classMethod}}),Object.defineProperty(exports,"ClassPrivateMethod",{enumerable:!0,get:function(){return _index.classPrivateMethod}}),Object.defineProperty(exports,"ClassPrivateProperty",{enumerable:!0,get:function(){return _index.classPrivateProperty}}),Object.defineProperty(exports,"ClassProperty",{enumerable:!0,get:function(){return _index.classProperty}}),Object.defineProperty(exports,"ConditionalExpression",{enumerable:!0,get:function(){return _index.conditionalExpression}}),Object.defineProperty(exports,"ContinueStatement",{enumerable:!0,get:function(){return _index.continueStatement}}),Object.defineProperty(exports,"DebuggerStatement",{enumerable:!0,get:function(){return _index.debuggerStatement}}),Object.defineProperty(exports,"DecimalLiteral",{enumerable:!0,get:function(){return _index.decimalLiteral}}),Object.defineProperty(exports,"DeclareClass",{enumerable:!0,get:function(){return _index.declareClass}}),Object.defineProperty(exports,"DeclareExportAllDeclaration",{enumerable:!0,get:function(){return _index.declareExportAllDeclaration}}),Object.defineProperty(exports,"DeclareExportDeclaration",{enumerable:!0,get:function(){return _index.declareExportDeclaration}}),Object.defineProperty(exports,"DeclareFunction",{enumerable:!0,get:function(){return _index.declareFunction}}),Object.defineProperty(exports,"DeclareInterface",{enumerable:!0,get:function(){return _index.declareInterface}}),Object.defineProperty(exports,"DeclareModule",{enumerable:!0,get:function(){return _index.declareModule}}),Object.defineProperty(exports,"DeclareModuleExports",{enumerable:!0,get:function(){return _index.declareModuleExports}}),Object.defineProperty(exports,"DeclareOpaqueType",{enumerable:!0,get:function(){return _index.declareOpaqueType}}),Object.defineProperty(exports,"DeclareTypeAlias",{enumerable:!0,get:function(){return _index.declareTypeAlias}}),Object.defineProperty(exports,"DeclareVariable",{enumerable:!0,get:function(){return _index.declareVariable}}),Object.defineProperty(exports,"DeclaredPredicate",{enumerable:!0,get:function(){return _index.declaredPredicate}}),Object.defineProperty(exports,"Decorator",{enumerable:!0,get:function(){return _index.decorator}}),Object.defineProperty(exports,"Directive",{enumerable:!0,get:function(){return _index.directive}}),Object.defineProperty(exports,"DirectiveLiteral",{enumerable:!0,get:function(){return _index.directiveLiteral}}),Object.defineProperty(exports,"DoExpression",{enumerable:!0,get:function(){return _index.doExpression}}),Object.defineProperty(exports,"DoWhileStatement",{enumerable:!0,get:function(){return _index.doWhileStatement}}),Object.defineProperty(exports,"EmptyStatement",{enumerable:!0,get:function(){return _index.emptyStatement}}),Object.defineProperty(exports,"EmptyTypeAnnotation",{enumerable:!0,get:function(){return _index.emptyTypeAnnotation}}),Object.defineProperty(exports,"EnumBooleanBody",{enumerable:!0,get:function(){return _index.enumBooleanBody}}),Object.defineProperty(exports,"EnumBooleanMember",{enumerable:!0,get:function(){return _index.enumBooleanMember}}),Object.defineProperty(exports,"EnumDeclaration",{enumerable:!0,get:function(){return _index.enumDeclaration}}),Object.defineProperty(exports,"EnumDefaultedMember",{enumerable:!0,get:function(){return _index.enumDefaultedMember}}),Object.defineProperty(exports,"EnumNumberBody",{enumerable:!0,get:function(){return _index.enumNumberBody}}),Object.defineProperty(exports,"EnumNumberMember",{enumerable:!0,get:function(){return _index.enumNumberMember}}),Object.defineProperty(exports,"EnumStringBody",{enumerable:!0,get:function(){return _index.enumStringBody}}),Object.defineProperty(exports,"EnumStringMember",{enumerable:!0,get:function(){return _index.enumStringMember}}),Object.defineProperty(exports,"EnumSymbolBody",{enumerable:!0,get:function(){return _index.enumSymbolBody}}),Object.defineProperty(exports,"ExistsTypeAnnotation",{enumerable:!0,get:function(){return _index.existsTypeAnnotation}}),Object.defineProperty(exports,"ExportAllDeclaration",{enumerable:!0,get:function(){return _index.exportAllDeclaration}}),Object.defineProperty(exports,"ExportDefaultDeclaration",{enumerable:!0,get:function(){return _index.exportDefaultDeclaration}}),Object.defineProperty(exports,"ExportDefaultSpecifier",{enumerable:!0,get:function(){return _index.exportDefaultSpecifier}}),Object.defineProperty(exports,"ExportNamedDeclaration",{enumerable:!0,get:function(){return _index.exportNamedDeclaration}}),Object.defineProperty(exports,"ExportNamespaceSpecifier",{enumerable:!0,get:function(){return _index.exportNamespaceSpecifier}}),Object.defineProperty(exports,"ExportSpecifier",{enumerable:!0,get:function(){return _index.exportSpecifier}}),Object.defineProperty(exports,"ExpressionStatement",{enumerable:!0,get:function(){return _index.expressionStatement}}),Object.defineProperty(exports,"File",{enumerable:!0,get:function(){return _index.file}}),Object.defineProperty(exports,"ForInStatement",{enumerable:!0,get:function(){return _index.forInStatement}}),Object.defineProperty(exports,"ForOfStatement",{enumerable:!0,get:function(){return _index.forOfStatement}}),Object.defineProperty(exports,"ForStatement",{enumerable:!0,get:function(){return _index.forStatement}}),Object.defineProperty(exports,"FunctionDeclaration",{enumerable:!0,get:function(){return _index.functionDeclaration}}),Object.defineProperty(exports,"FunctionExpression",{enumerable:!0,get:function(){return _index.functionExpression}}),Object.defineProperty(exports,"FunctionTypeAnnotation",{enumerable:!0,get:function(){return _index.functionTypeAnnotation}}),Object.defineProperty(exports,"FunctionTypeParam",{enumerable:!0,get:function(){return _index.functionTypeParam}}),Object.defineProperty(exports,"GenericTypeAnnotation",{enumerable:!0,get:function(){return _index.genericTypeAnnotation}}),Object.defineProperty(exports,"Identifier",{enumerable:!0,get:function(){return _index.identifier}}),Object.defineProperty(exports,"IfStatement",{enumerable:!0,get:function(){return _index.ifStatement}}),Object.defineProperty(exports,"Import",{enumerable:!0,get:function(){return _index.import}}),Object.defineProperty(exports,"ImportAttribute",{enumerable:!0,get:function(){return _index.importAttribute}}),Object.defineProperty(exports,"ImportDeclaration",{enumerable:!0,get:function(){return _index.importDeclaration}}),Object.defineProperty(exports,"ImportDefaultSpecifier",{enumerable:!0,get:function(){return _index.importDefaultSpecifier}}),Object.defineProperty(exports,"ImportExpression",{enumerable:!0,get:function(){return _index.importExpression}}),Object.defineProperty(exports,"ImportNamespaceSpecifier",{enumerable:!0,get:function(){return _index.importNamespaceSpecifier}}),Object.defineProperty(exports,"ImportSpecifier",{enumerable:!0,get:function(){return _index.importSpecifier}}),Object.defineProperty(exports,"IndexedAccessType",{enumerable:!0,get:function(){return _index.indexedAccessType}}),Object.defineProperty(exports,"InferredPredicate",{enumerable:!0,get:function(){return _index.inferredPredicate}}),Object.defineProperty(exports,"InterfaceDeclaration",{enumerable:!0,get:function(){return _index.interfaceDeclaration}}),Object.defineProperty(exports,"InterfaceExtends",{enumerable:!0,get:function(){return _index.interfaceExtends}}),Object.defineProperty(exports,"InterfaceTypeAnnotation",{enumerable:!0,get:function(){return _index.interfaceTypeAnnotation}}),Object.defineProperty(exports,"InterpreterDirective",{enumerable:!0,get:function(){return _index.interpreterDirective}}),Object.defineProperty(exports,"IntersectionTypeAnnotation",{enumerable:!0,get:function(){return _index.intersectionTypeAnnotation}}),Object.defineProperty(exports,"JSXAttribute",{enumerable:!0,get:function(){return _index.jsxAttribute}}),Object.defineProperty(exports,"JSXClosingElement",{enumerable:!0,get:function(){return _index.jsxClosingElement}}),Object.defineProperty(exports,"JSXClosingFragment",{enumerable:!0,get:function(){return _index.jsxClosingFragment}}),Object.defineProperty(exports,"JSXElement",{enumerable:!0,get:function(){return _index.jsxElement}}),Object.defineProperty(exports,"JSXEmptyExpression",{enumerable:!0,get:function(){return _index.jsxEmptyExpression}}),Object.defineProperty(exports,"JSXExpressionContainer",{enumerable:!0,get:function(){return _index.jsxExpressionContainer}}),Object.defineProperty(exports,"JSXFragment",{enumerable:!0,get:function(){return _index.jsxFragment}}),Object.defineProperty(exports,"JSXIdentifier",{enumerable:!0,get:function(){return _index.jsxIdentifier}}),Object.defineProperty(exports,"JSXMemberExpression",{enumerable:!0,get:function(){return _index.jsxMemberExpression}}),Object.defineProperty(exports,"JSXNamespacedName",{enumerable:!0,get:function(){return _index.jsxNamespacedName}}),Object.defineProperty(exports,"JSXOpeningElement",{enumerable:!0,get:function(){return _index.jsxOpeningElement}}),Object.defineProperty(exports,"JSXOpeningFragment",{enumerable:!0,get:function(){return _index.jsxOpeningFragment}}),Object.defineProperty(exports,"JSXSpreadAttribute",{enumerable:!0,get:function(){return _index.jsxSpreadAttribute}}),Object.defineProperty(exports,"JSXSpreadChild",{enumerable:!0,get:function(){return _index.jsxSpreadChild}}),Object.defineProperty(exports,"JSXText",{enumerable:!0,get:function(){return _index.jsxText}}),Object.defineProperty(exports,"LabeledStatement",{enumerable:!0,get:function(){return _index.labeledStatement}}),Object.defineProperty(exports,"LogicalExpression",{enumerable:!0,get:function(){return _index.logicalExpression}}),Object.defineProperty(exports,"MemberExpression",{enumerable:!0,get:function(){return _index.memberExpression}}),Object.defineProperty(exports,"MetaProperty",{enumerable:!0,get:function(){return _index.metaProperty}}),Object.defineProperty(exports,"MixedTypeAnnotation",{enumerable:!0,get:function(){return _index.mixedTypeAnnotation}}),Object.defineProperty(exports,"ModuleExpression",{enumerable:!0,get:function(){return _index.moduleExpression}}),Object.defineProperty(exports,"NewExpression",{enumerable:!0,get:function(){return _index.newExpression}}),Object.defineProperty(exports,"Noop",{enumerable:!0,get:function(){return _index.noop}}),Object.defineProperty(exports,"NullLiteral",{enumerable:!0,get:function(){return _index.nullLiteral}}),Object.defineProperty(exports,"NullLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.nullLiteralTypeAnnotation}}),Object.defineProperty(exports,"NullableTypeAnnotation",{enumerable:!0,get:function(){return _index.nullableTypeAnnotation}}),Object.defineProperty(exports,"NumberLiteral",{enumerable:!0,get:function(){return _index.numberLiteral}}),Object.defineProperty(exports,"NumberLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.numberLiteralTypeAnnotation}}),Object.defineProperty(exports,"NumberTypeAnnotation",{enumerable:!0,get:function(){return _index.numberTypeAnnotation}}),Object.defineProperty(exports,"NumericLiteral",{enumerable:!0,get:function(){return _index.numericLiteral}}),Object.defineProperty(exports,"ObjectExpression",{enumerable:!0,get:function(){return _index.objectExpression}}),Object.defineProperty(exports,"ObjectMethod",{enumerable:!0,get:function(){return _index.objectMethod}}),Object.defineProperty(exports,"ObjectPattern",{enumerable:!0,get:function(){return _index.objectPattern}}),Object.defineProperty(exports,"ObjectProperty",{enumerable:!0,get:function(){return _index.objectProperty}}),Object.defineProperty(exports,"ObjectTypeAnnotation",{enumerable:!0,get:function(){return _index.objectTypeAnnotation}}),Object.defineProperty(exports,"ObjectTypeCallProperty",{enumerable:!0,get:function(){return _index.objectTypeCallProperty}}),Object.defineProperty(exports,"ObjectTypeIndexer",{enumerable:!0,get:function(){return _index.objectTypeIndexer}}),Object.defineProperty(exports,"ObjectTypeInternalSlot",{enumerable:!0,get:function(){return _index.objectTypeInternalSlot}}),Object.defineProperty(exports,"ObjectTypeProperty",{enumerable:!0,get:function(){return _index.objectTypeProperty}}),Object.defineProperty(exports,"ObjectTypeSpreadProperty",{enumerable:!0,get:function(){return _index.objectTypeSpreadProperty}}),Object.defineProperty(exports,"OpaqueType",{enumerable:!0,get:function(){return _index.opaqueType}}),Object.defineProperty(exports,"OptionalCallExpression",{enumerable:!0,get:function(){return _index.optionalCallExpression}}),Object.defineProperty(exports,"OptionalIndexedAccessType",{enumerable:!0,get:function(){return _index.optionalIndexedAccessType}}),Object.defineProperty(exports,"OptionalMemberExpression",{enumerable:!0,get:function(){return _index.optionalMemberExpression}}),Object.defineProperty(exports,"ParenthesizedExpression",{enumerable:!0,get:function(){return _index.parenthesizedExpression}}),Object.defineProperty(exports,"PipelineBareFunction",{enumerable:!0,get:function(){return _index.pipelineBareFunction}}),Object.defineProperty(exports,"PipelinePrimaryTopicReference",{enumerable:!0,get:function(){return _index.pipelinePrimaryTopicReference}}),Object.defineProperty(exports,"PipelineTopicExpression",{enumerable:!0,get:function(){return _index.pipelineTopicExpression}}),Object.defineProperty(exports,"Placeholder",{enumerable:!0,get:function(){return _index.placeholder}}),Object.defineProperty(exports,"PrivateName",{enumerable:!0,get:function(){return _index.privateName}}),Object.defineProperty(exports,"Program",{enumerable:!0,get:function(){return _index.program}}),Object.defineProperty(exports,"QualifiedTypeIdentifier",{enumerable:!0,get:function(){return _index.qualifiedTypeIdentifier}}),Object.defineProperty(exports,"RecordExpression",{enumerable:!0,get:function(){return _index.recordExpression}}),Object.defineProperty(exports,"RegExpLiteral",{enumerable:!0,get:function(){return _index.regExpLiteral}}),Object.defineProperty(exports,"RegexLiteral",{enumerable:!0,get:function(){return _index.regexLiteral}}),Object.defineProperty(exports,"RestElement",{enumerable:!0,get:function(){return _index.restElement}}),Object.defineProperty(exports,"RestProperty",{enumerable:!0,get:function(){return _index.restProperty}}),Object.defineProperty(exports,"ReturnStatement",{enumerable:!0,get:function(){return _index.returnStatement}}),Object.defineProperty(exports,"SequenceExpression",{enumerable:!0,get:function(){return _index.sequenceExpression}}),Object.defineProperty(exports,"SpreadElement",{enumerable:!0,get:function(){return _index.spreadElement}}),Object.defineProperty(exports,"SpreadProperty",{enumerable:!0,get:function(){return _index.spreadProperty}}),Object.defineProperty(exports,"StaticBlock",{enumerable:!0,get:function(){return _index.staticBlock}}),Object.defineProperty(exports,"StringLiteral",{enumerable:!0,get:function(){return _index.stringLiteral}}),Object.defineProperty(exports,"StringLiteralTypeAnnotation",{enumerable:!0,get:function(){return _index.stringLiteralTypeAnnotation}}),Object.defineProperty(exports,"StringTypeAnnotation",{enumerable:!0,get:function(){return _index.stringTypeAnnotation}}),Object.defineProperty(exports,"Super",{enumerable:!0,get:function(){return _index.super}}),Object.defineProperty(exports,"SwitchCase",{enumerable:!0,get:function(){return _index.switchCase}}),Object.defineProperty(exports,"SwitchStatement",{enumerable:!0,get:function(){return _index.switchStatement}}),Object.defineProperty(exports,"SymbolTypeAnnotation",{enumerable:!0,get:function(){return _index.symbolTypeAnnotation}}),Object.defineProperty(exports,"TSAnyKeyword",{enumerable:!0,get:function(){return _index.tsAnyKeyword}}),Object.defineProperty(exports,"TSArrayType",{enumerable:!0,get:function(){return _index.tsArrayType}}),Object.defineProperty(exports,"TSAsExpression",{enumerable:!0,get:function(){return _index.tsAsExpression}}),Object.defineProperty(exports,"TSBigIntKeyword",{enumerable:!0,get:function(){return _index.tsBigIntKeyword}}),Object.defineProperty(exports,"TSBooleanKeyword",{enumerable:!0,get:function(){return _index.tsBooleanKeyword}}),Object.defineProperty(exports,"TSCallSignatureDeclaration",{enumerable:!0,get:function(){return _index.tsCallSignatureDeclaration}}),Object.defineProperty(exports,"TSConditionalType",{enumerable:!0,get:function(){return _index.tsConditionalType}}),Object.defineProperty(exports,"TSConstructSignatureDeclaration",{enumerable:!0,get:function(){return _index.tsConstructSignatureDeclaration}}),Object.defineProperty(exports,"TSConstructorType",{enumerable:!0,get:function(){return _index.tsConstructorType}}),Object.defineProperty(exports,"TSDeclareFunction",{enumerable:!0,get:function(){return _index.tsDeclareFunction}}),Object.defineProperty(exports,"TSDeclareMethod",{enumerable:!0,get:function(){return _index.tsDeclareMethod}}),Object.defineProperty(exports,"TSEnumDeclaration",{enumerable:!0,get:function(){return _index.tsEnumDeclaration}}),Object.defineProperty(exports,"TSEnumMember",{enumerable:!0,get:function(){return _index.tsEnumMember}}),Object.defineProperty(exports,"TSExportAssignment",{enumerable:!0,get:function(){return _index.tsExportAssignment}}),Object.defineProperty(exports,"TSExpressionWithTypeArguments",{enumerable:!0,get:function(){return _index.tsExpressionWithTypeArguments}}),Object.defineProperty(exports,"TSExternalModuleReference",{enumerable:!0,get:function(){return _index.tsExternalModuleReference}}),Object.defineProperty(exports,"TSFunctionType",{enumerable:!0,get:function(){return _index.tsFunctionType}}),Object.defineProperty(exports,"TSImportEqualsDeclaration",{enumerable:!0,get:function(){return _index.tsImportEqualsDeclaration}}),Object.defineProperty(exports,"TSImportType",{enumerable:!0,get:function(){return _index.tsImportType}}),Object.defineProperty(exports,"TSIndexSignature",{enumerable:!0,get:function(){return _index.tsIndexSignature}}),Object.defineProperty(exports,"TSIndexedAccessType",{enumerable:!0,get:function(){return _index.tsIndexedAccessType}}),Object.defineProperty(exports,"TSInferType",{enumerable:!0,get:function(){return _index.tsInferType}}),Object.defineProperty(exports,"TSInstantiationExpression",{enumerable:!0,get:function(){return _index.tsInstantiationExpression}}),Object.defineProperty(exports,"TSInterfaceBody",{enumerable:!0,get:function(){return _index.tsInterfaceBody}}),Object.defineProperty(exports,"TSInterfaceDeclaration",{enumerable:!0,get:function(){return _index.tsInterfaceDeclaration}}),Object.defineProperty(exports,"TSIntersectionType",{enumerable:!0,get:function(){return _index.tsIntersectionType}}),Object.defineProperty(exports,"TSIntrinsicKeyword",{enumerable:!0,get:function(){return _index.tsIntrinsicKeyword}}),Object.defineProperty(exports,"TSLiteralType",{enumerable:!0,get:function(){return _index.tsLiteralType}}),Object.defineProperty(exports,"TSMappedType",{enumerable:!0,get:function(){return _index.tsMappedType}}),Object.defineProperty(exports,"TSMethodSignature",{enumerable:!0,get:function(){return _index.tsMethodSignature}}),Object.defineProperty(exports,"TSModuleBlock",{enumerable:!0,get:function(){return _index.tsModuleBlock}}),Object.defineProperty(exports,"TSModuleDeclaration",{enumerable:!0,get:function(){return _index.tsModuleDeclaration}}),Object.defineProperty(exports,"TSNamedTupleMember",{enumerable:!0,get:function(){return _index.tsNamedTupleMember}}),Object.defineProperty(exports,"TSNamespaceExportDeclaration",{enumerable:!0,get:function(){return _index.tsNamespaceExportDeclaration}}),Object.defineProperty(exports,"TSNeverKeyword",{enumerable:!0,get:function(){return _index.tsNeverKeyword}}),Object.defineProperty(exports,"TSNonNullExpression",{enumerable:!0,get:function(){return _index.tsNonNullExpression}}),Object.defineProperty(exports,"TSNullKeyword",{enumerable:!0,get:function(){return _index.tsNullKeyword}}),Object.defineProperty(exports,"TSNumberKeyword",{enumerable:!0,get:function(){return _index.tsNumberKeyword}}),Object.defineProperty(exports,"TSObjectKeyword",{enumerable:!0,get:function(){return _index.tsObjectKeyword}}),Object.defineProperty(exports,"TSOptionalType",{enumerable:!0,get:function(){return _index.tsOptionalType}}),Object.defineProperty(exports,"TSParameterProperty",{enumerable:!0,get:function(){return _index.tsParameterProperty}}),Object.defineProperty(exports,"TSParenthesizedType",{enumerable:!0,get:function(){return _index.tsParenthesizedType}}),Object.defineProperty(exports,"TSPropertySignature",{enumerable:!0,get:function(){return _index.tsPropertySignature}}),Object.defineProperty(exports,"TSQualifiedName",{enumerable:!0,get:function(){return _index.tsQualifiedName}}),Object.defineProperty(exports,"TSRestType",{enumerable:!0,get:function(){return _index.tsRestType}}),Object.defineProperty(exports,"TSSatisfiesExpression",{enumerable:!0,get:function(){return _index.tsSatisfiesExpression}}),Object.defineProperty(exports,"TSStringKeyword",{enumerable:!0,get:function(){return _index.tsStringKeyword}}),Object.defineProperty(exports,"TSSymbolKeyword",{enumerable:!0,get:function(){return _index.tsSymbolKeyword}}),Object.defineProperty(exports,"TSThisType",{enumerable:!0,get:function(){return _index.tsThisType}}),Object.defineProperty(exports,"TSTupleType",{enumerable:!0,get:function(){return _index.tsTupleType}}),Object.defineProperty(exports,"TSTypeAliasDeclaration",{enumerable:!0,get:function(){return _index.tsTypeAliasDeclaration}}),Object.defineProperty(exports,"TSTypeAnnotation",{enumerable:!0,get:function(){return _index.tsTypeAnnotation}}),Object.defineProperty(exports,"TSTypeAssertion",{enumerable:!0,get:function(){return _index.tsTypeAssertion}}),Object.defineProperty(exports,"TSTypeLiteral",{enumerable:!0,get:function(){return _index.tsTypeLiteral}}),Object.defineProperty(exports,"TSTypeOperator",{enumerable:!0,get:function(){return _index.tsTypeOperator}}),Object.defineProperty(exports,"TSTypeParameter",{enumerable:!0,get:function(){return _index.tsTypeParameter}}),Object.defineProperty(exports,"TSTypeParameterDeclaration",{enumerable:!0,get:function(){return _index.tsTypeParameterDeclaration}}),Object.defineProperty(exports,"TSTypeParameterInstantiation",{enumerable:!0,get:function(){return _index.tsTypeParameterInstantiation}}),Object.defineProperty(exports,"TSTypePredicate",{enumerable:!0,get:function(){return _index.tsTypePredicate}}),Object.defineProperty(exports,"TSTypeQuery",{enumerable:!0,get:function(){return _index.tsTypeQuery}}),Object.defineProperty(exports,"TSTypeReference",{enumerable:!0,get:function(){return _index.tsTypeReference}}),Object.defineProperty(exports,"TSUndefinedKeyword",{enumerable:!0,get:function(){return _index.tsUndefinedKeyword}}),Object.defineProperty(exports,"TSUnionType",{enumerable:!0,get:function(){return _index.tsUnionType}}),Object.defineProperty(exports,"TSUnknownKeyword",{enumerable:!0,get:function(){return _index.tsUnknownKeyword}}),Object.defineProperty(exports,"TSVoidKeyword",{enumerable:!0,get:function(){return _index.tsVoidKeyword}}),Object.defineProperty(exports,"TaggedTemplateExpression",{enumerable:!0,get:function(){return _index.taggedTemplateExpression}}),Object.defineProperty(exports,"TemplateElement",{enumerable:!0,get:function(){return _index.templateElement}}),Object.defineProperty(exports,"TemplateLiteral",{enumerable:!0,get:function(){return _index.templateLiteral}}),Object.defineProperty(exports,"ThisExpression",{enumerable:!0,get:function(){return _index.thisExpression}}),Object.defineProperty(exports,"ThisTypeAnnotation",{enumerable:!0,get:function(){return _index.thisTypeAnnotation}}),Object.defineProperty(exports,"ThrowStatement",{enumerable:!0,get:function(){return _index.throwStatement}}),Object.defineProperty(exports,"TopicReference",{enumerable:!0,get:function(){return _index.topicReference}}),Object.defineProperty(exports,"TryStatement",{enumerable:!0,get:function(){return _index.tryStatement}}),Object.defineProperty(exports,"TupleExpression",{enumerable:!0,get:function(){return _index.tupleExpression}}),Object.defineProperty(exports,"TupleTypeAnnotation",{enumerable:!0,get:function(){return _index.tupleTypeAnnotation}}),Object.defineProperty(exports,"TypeAlias",{enumerable:!0,get:function(){return _index.typeAlias}}),Object.defineProperty(exports,"TypeAnnotation",{enumerable:!0,get:function(){return _index.typeAnnotation}}),Object.defineProperty(exports,"TypeCastExpression",{enumerable:!0,get:function(){return _index.typeCastExpression}}),Object.defineProperty(exports,"TypeParameter",{enumerable:!0,get:function(){return _index.typeParameter}}),Object.defineProperty(exports,"TypeParameterDeclaration",{enumerable:!0,get:function(){return _index.typeParameterDeclaration}}),Object.defineProperty(exports,"TypeParameterInstantiation",{enumerable:!0,get:function(){return _index.typeParameterInstantiation}}),Object.defineProperty(exports,"TypeofTypeAnnotation",{enumerable:!0,get:function(){return _index.typeofTypeAnnotation}}),Object.defineProperty(exports,"UnaryExpression",{enumerable:!0,get:function(){return _index.unaryExpression}}),Object.defineProperty(exports,"UnionTypeAnnotation",{enumerable:!0,get:function(){return _index.unionTypeAnnotation}}),Object.defineProperty(exports,"UpdateExpression",{enumerable:!0,get:function(){return _index.updateExpression}}),Object.defineProperty(exports,"V8IntrinsicIdentifier",{enumerable:!0,get:function(){return _index.v8IntrinsicIdentifier}}),Object.defineProperty(exports,"VariableDeclaration",{enumerable:!0,get:function(){return _index.variableDeclaration}}),Object.defineProperty(exports,"VariableDeclarator",{enumerable:!0,get:function(){return _index.variableDeclarator}}),Object.defineProperty(exports,"Variance",{enumerable:!0,get:function(){return _index.variance}}),Object.defineProperty(exports,"VoidTypeAnnotation",{enumerable:!0,get:function(){return _index.voidTypeAnnotation}}),Object.defineProperty(exports,"WhileStatement",{enumerable:!0,get:function(){return _index.whileStatement}}),Object.defineProperty(exports,"WithStatement",{enumerable:!0,get:function(){return _index.withStatement}}),Object.defineProperty(exports,"YieldExpression",{enumerable:!0,get:function(){return _index.yieldExpression}});var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/productions.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildUndefinedNode=function(){return(0,_index.unaryExpression)("void",(0,_index.numericLiteral)(0),!0)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/react/buildChildren.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){const elements=[];for(let i=0;i<node.children.length;i++){let child=node.children[i];(0,_index.isJSXText)(child)?(0,_cleanJSXElementLiteralChild.default)(child,elements):((0,_index.isJSXExpressionContainer)(child)&&(child=child.expression),(0,_index.isJSXEmptyExpression)(child)||elements.push(child))}return elements};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_cleanJSXElementLiteralChild=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/react/cleanJSXElementLiteralChild.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/typescript/createTSUnionType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(typeAnnotations){const types=typeAnnotations.map((type=>(0,_index2.isTSTypeAnnotation)(type)?type.typeAnnotation:type)),flattened=(0,_removeTypeDuplicates.default)(types);return 1===flattened.length?flattened[0]:(0,_index.tsUnionType)(flattened)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_removeTypeDuplicates=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/typescript/removeTypeDuplicates.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/clone.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node,!1)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeep.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeepWithoutLoc.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node,!0,!0)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,deep=!0,withoutLoc=!1){return cloneNodeInternal(node,deep,withoutLoc,new Map)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");const{hasOwn}={hasOwn:Function.call.bind(Object.prototype.hasOwnProperty)};function cloneIfNode(obj,deep,withoutLoc,commentsCache){return obj&&"string"==typeof obj.type?cloneNodeInternal(obj,deep,withoutLoc,commentsCache):obj}function cloneIfNodeOrArray(obj,deep,withoutLoc,commentsCache){return Array.isArray(obj)?obj.map((node=>cloneIfNode(node,deep,withoutLoc,commentsCache))):cloneIfNode(obj,deep,withoutLoc,commentsCache)}function cloneNodeInternal(node,deep=!0,withoutLoc=!1,commentsCache){if(!node)return node;const{type}=node,newNode={type:node.type};if((0,_index2.isIdentifier)(node))newNode.name=node.name,hasOwn(node,"optional")&&"boolean"==typeof node.optional&&(newNode.optional=node.optional),hasOwn(node,"typeAnnotation")&&(newNode.typeAnnotation=deep?cloneIfNodeOrArray(node.typeAnnotation,!0,withoutLoc,commentsCache):node.typeAnnotation),hasOwn(node,"decorators")&&(newNode.decorators=deep?cloneIfNodeOrArray(node.decorators,!0,withoutLoc,commentsCache):node.decorators);else{if(!hasOwn(_index.NODE_FIELDS,type))throw new Error(`Unknown node type: "${type}"`);for(const field of Object.keys(_index.NODE_FIELDS[type]))hasOwn(node,field)&&(newNode[field]=deep?(0,_index2.isFile)(node)&&"comments"===field?maybeCloneComments(node.comments,deep,withoutLoc,commentsCache):cloneIfNodeOrArray(node[field],!0,withoutLoc,commentsCache):node[field])}return hasOwn(node,"loc")&&(newNode.loc=withoutLoc?null:node.loc),hasOwn(node,"leadingComments")&&(newNode.leadingComments=maybeCloneComments(node.leadingComments,deep,withoutLoc,commentsCache)),hasOwn(node,"innerComments")&&(newNode.innerComments=maybeCloneComments(node.innerComments,deep,withoutLoc,commentsCache)),hasOwn(node,"trailingComments")&&(newNode.trailingComments=maybeCloneComments(node.trailingComments,deep,withoutLoc,commentsCache)),hasOwn(node,"extra")&&(newNode.extra=Object.assign({},node.extra)),newNode}function maybeCloneComments(comments,deep,withoutLoc,commentsCache){return comments&&deep?comments.map((comment=>{const cache=commentsCache.get(comment);if(cache)return cache;const{type,value,loc}=comment,ret={type,value,loc};return withoutLoc&&(ret.loc=null),commentsCache.set(comment,ret),ret})):comments}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneWithoutLoc.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_cloneNode.default)(node,!1,!0)};var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComment.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,type,content,line){return(0,_addComments.default)(node,type,[{type:line?"CommentLine":"CommentBlock",value:content}])};var _addComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComments.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComments.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,type,comments){if(!comments||!node)return node;const key=`${type}Comments`;node[key]?"leading"===type?node[key]=comments.concat(node[key]):node[key].push(...comments):node[key]=comments;return node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritInnerComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){(0,_inherit.default)("innerComments",child,parent)};var _inherit=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritLeadingComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){(0,_inherit.default)("leadingComments",child,parent)};var _inherit=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritTrailingComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){(0,_inherit.default)("trailingComments",child,parent)};var _inherit=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritsComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){return(0,_inheritTrailingComments.default)(child,parent),(0,_inheritLeadingComments.default)(child,parent),(0,_inheritInnerComments.default)(child,parent),child};var _inheritTrailingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritTrailingComments.js"),_inheritLeadingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritLeadingComments.js"),_inheritInnerComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritInnerComments.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/removeComments.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return _index.COMMENT_KEYS.forEach((key=>{node[key]=null})),node};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WHILE_TYPES=exports.USERWHITESPACABLE_TYPES=exports.UNARYLIKE_TYPES=exports.TYPESCRIPT_TYPES=exports.TSTYPE_TYPES=exports.TSTYPEELEMENT_TYPES=exports.TSENTITYNAME_TYPES=exports.TSBASETYPE_TYPES=exports.TERMINATORLESS_TYPES=exports.STATEMENT_TYPES=exports.STANDARDIZED_TYPES=exports.SCOPABLE_TYPES=exports.PUREISH_TYPES=exports.PROPERTY_TYPES=exports.PRIVATE_TYPES=exports.PATTERN_TYPES=exports.PATTERNLIKE_TYPES=exports.OBJECTMEMBER_TYPES=exports.MODULESPECIFIER_TYPES=exports.MODULEDECLARATION_TYPES=exports.MISCELLANEOUS_TYPES=exports.METHOD_TYPES=exports.LVAL_TYPES=exports.LOOP_TYPES=exports.LITERAL_TYPES=exports.JSX_TYPES=exports.IMPORTOREXPORTDECLARATION_TYPES=exports.IMMUTABLE_TYPES=exports.FUNCTION_TYPES=exports.FUNCTIONPARENT_TYPES=exports.FOR_TYPES=exports.FORXSTATEMENT_TYPES=exports.FLOW_TYPES=exports.FLOWTYPE_TYPES=exports.FLOWPREDICATE_TYPES=exports.FLOWDECLARATION_TYPES=exports.FLOWBASEANNOTATION_TYPES=exports.EXPRESSION_TYPES=exports.EXPRESSIONWRAPPER_TYPES=exports.EXPORTDECLARATION_TYPES=exports.ENUMMEMBER_TYPES=exports.ENUMBODY_TYPES=exports.DECLARATION_TYPES=exports.CONDITIONAL_TYPES=exports.COMPLETIONSTATEMENT_TYPES=exports.CLASS_TYPES=exports.BLOCK_TYPES=exports.BLOCKPARENT_TYPES=exports.BINARY_TYPES=exports.ACCESSOR_TYPES=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");exports.STANDARDIZED_TYPES=_index.FLIPPED_ALIAS_KEYS.Standardized,exports.EXPRESSION_TYPES=_index.FLIPPED_ALIAS_KEYS.Expression,exports.BINARY_TYPES=_index.FLIPPED_ALIAS_KEYS.Binary,exports.SCOPABLE_TYPES=_index.FLIPPED_ALIAS_KEYS.Scopable,exports.BLOCKPARENT_TYPES=_index.FLIPPED_ALIAS_KEYS.BlockParent,exports.BLOCK_TYPES=_index.FLIPPED_ALIAS_KEYS.Block,exports.STATEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.Statement,exports.TERMINATORLESS_TYPES=_index.FLIPPED_ALIAS_KEYS.Terminatorless,exports.COMPLETIONSTATEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.CompletionStatement,exports.CONDITIONAL_TYPES=_index.FLIPPED_ALIAS_KEYS.Conditional,exports.LOOP_TYPES=_index.FLIPPED_ALIAS_KEYS.Loop,exports.WHILE_TYPES=_index.FLIPPED_ALIAS_KEYS.While,exports.EXPRESSIONWRAPPER_TYPES=_index.FLIPPED_ALIAS_KEYS.ExpressionWrapper,exports.FOR_TYPES=_index.FLIPPED_ALIAS_KEYS.For,exports.FORXSTATEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.ForXStatement,exports.FUNCTION_TYPES=_index.FLIPPED_ALIAS_KEYS.Function,exports.FUNCTIONPARENT_TYPES=_index.FLIPPED_ALIAS_KEYS.FunctionParent,exports.PUREISH_TYPES=_index.FLIPPED_ALIAS_KEYS.Pureish,exports.DECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.Declaration,exports.PATTERNLIKE_TYPES=_index.FLIPPED_ALIAS_KEYS.PatternLike,exports.LVAL_TYPES=_index.FLIPPED_ALIAS_KEYS.LVal,exports.TSENTITYNAME_TYPES=_index.FLIPPED_ALIAS_KEYS.TSEntityName,exports.LITERAL_TYPES=_index.FLIPPED_ALIAS_KEYS.Literal,exports.IMMUTABLE_TYPES=_index.FLIPPED_ALIAS_KEYS.Immutable,exports.USERWHITESPACABLE_TYPES=_index.FLIPPED_ALIAS_KEYS.UserWhitespacable,exports.METHOD_TYPES=_index.FLIPPED_ALIAS_KEYS.Method,exports.OBJECTMEMBER_TYPES=_index.FLIPPED_ALIAS_KEYS.ObjectMember,exports.PROPERTY_TYPES=_index.FLIPPED_ALIAS_KEYS.Property,exports.UNARYLIKE_TYPES=_index.FLIPPED_ALIAS_KEYS.UnaryLike,exports.PATTERN_TYPES=_index.FLIPPED_ALIAS_KEYS.Pattern,exports.CLASS_TYPES=_index.FLIPPED_ALIAS_KEYS.Class;const IMPORTOREXPORTDECLARATION_TYPES=exports.IMPORTOREXPORTDECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.ImportOrExportDeclaration;exports.EXPORTDECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.ExportDeclaration,exports.MODULESPECIFIER_TYPES=_index.FLIPPED_ALIAS_KEYS.ModuleSpecifier,exports.ACCESSOR_TYPES=_index.FLIPPED_ALIAS_KEYS.Accessor,exports.PRIVATE_TYPES=_index.FLIPPED_ALIAS_KEYS.Private,exports.FLOW_TYPES=_index.FLIPPED_ALIAS_KEYS.Flow,exports.FLOWTYPE_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowType,exports.FLOWBASEANNOTATION_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowBaseAnnotation,exports.FLOWDECLARATION_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowDeclaration,exports.FLOWPREDICATE_TYPES=_index.FLIPPED_ALIAS_KEYS.FlowPredicate,exports.ENUMBODY_TYPES=_index.FLIPPED_ALIAS_KEYS.EnumBody,exports.ENUMMEMBER_TYPES=_index.FLIPPED_ALIAS_KEYS.EnumMember,exports.JSX_TYPES=_index.FLIPPED_ALIAS_KEYS.JSX,exports.MISCELLANEOUS_TYPES=_index.FLIPPED_ALIAS_KEYS.Miscellaneous,exports.TYPESCRIPT_TYPES=_index.FLIPPED_ALIAS_KEYS.TypeScript,exports.TSTYPEELEMENT_TYPES=_index.FLIPPED_ALIAS_KEYS.TSTypeElement,exports.TSTYPE_TYPES=_index.FLIPPED_ALIAS_KEYS.TSType,exports.TSBASETYPE_TYPES=_index.FLIPPED_ALIAS_KEYS.TSBaseType,exports.MODULEDECLARATION_TYPES=IMPORTOREXPORTDECLARATION_TYPES},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UPDATE_OPERATORS=exports.UNARY_OPERATORS=exports.STRING_UNARY_OPERATORS=exports.STATEMENT_OR_BLOCK_KEYS=exports.NUMBER_UNARY_OPERATORS=exports.NUMBER_BINARY_OPERATORS=exports.NOT_LOCAL_BINDING=exports.LOGICAL_OPERATORS=exports.INHERIT_KEYS=exports.FOR_INIT_KEYS=exports.FLATTENABLE_KEYS=exports.EQUALITY_BINARY_OPERATORS=exports.COMPARISON_BINARY_OPERATORS=exports.COMMENT_KEYS=exports.BOOLEAN_UNARY_OPERATORS=exports.BOOLEAN_NUMBER_BINARY_OPERATORS=exports.BOOLEAN_BINARY_OPERATORS=exports.BLOCK_SCOPED_SYMBOL=exports.BINARY_OPERATORS=exports.ASSIGNMENT_OPERATORS=void 0;exports.STATEMENT_OR_BLOCK_KEYS=["consequent","body","alternate"],exports.FLATTENABLE_KEYS=["body","expressions"],exports.FOR_INIT_KEYS=["left","init"],exports.COMMENT_KEYS=["leadingComments","trailingComments","innerComments"];const LOGICAL_OPERATORS=exports.LOGICAL_OPERATORS=["||","&&","??"],BOOLEAN_NUMBER_BINARY_OPERATORS=(exports.UPDATE_OPERATORS=["++","--"],exports.BOOLEAN_NUMBER_BINARY_OPERATORS=[">","<",">=","<="]),EQUALITY_BINARY_OPERATORS=exports.EQUALITY_BINARY_OPERATORS=["==","===","!=","!=="],COMPARISON_BINARY_OPERATORS=exports.COMPARISON_BINARY_OPERATORS=[...EQUALITY_BINARY_OPERATORS,"in","instanceof"],BOOLEAN_BINARY_OPERATORS=exports.BOOLEAN_BINARY_OPERATORS=[...COMPARISON_BINARY_OPERATORS,...BOOLEAN_NUMBER_BINARY_OPERATORS],NUMBER_BINARY_OPERATORS=exports.NUMBER_BINARY_OPERATORS=["-","/","%","*","**","&","|",">>",">>>","<<","^"],BOOLEAN_UNARY_OPERATORS=(exports.BINARY_OPERATORS=["+",...NUMBER_BINARY_OPERATORS,...BOOLEAN_BINARY_OPERATORS,"|>"],exports.ASSIGNMENT_OPERATORS=["=","+=",...NUMBER_BINARY_OPERATORS.map((op=>op+"=")),...LOGICAL_OPERATORS.map((op=>op+"="))],exports.BOOLEAN_UNARY_OPERATORS=["delete","!"]),NUMBER_UNARY_OPERATORS=exports.NUMBER_UNARY_OPERATORS=["+","-","~"],STRING_UNARY_OPERATORS=exports.STRING_UNARY_OPERATORS=["typeof"];exports.UNARY_OPERATORS=["void","throw",...BOOLEAN_UNARY_OPERATORS,...NUMBER_UNARY_OPERATORS,...STRING_UNARY_OPERATORS],exports.INHERIT_KEYS={optional:["typeAnnotation","typeParameters","returnType"],force:["start","loc","end"]},exports.BLOCK_SCOPED_SYMBOL=Symbol.for("var used to be block scoped"),exports.NOT_LOCAL_BINDING=Symbol.for("should not be considered a local binding")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/ensureBlock.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,key="body"){const result=(0,_toBlock.default)(node[key],node);return node[key]=result,result};var _toBlock=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBlock.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/gatherSequenceExpressions.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function gatherSequenceExpressions(nodes,declars){const exprs=[];let ensureLastUndefined=!0;for(const node of nodes)if((0,_index.isEmptyStatement)(node)||(ensureLastUndefined=!1),(0,_index.isExpression)(node))exprs.push(node);else if((0,_index.isExpressionStatement)(node))exprs.push(node.expression);else if((0,_index.isVariableDeclaration)(node)){if("var"!==node.kind)return;for(const declar of node.declarations){const bindings=(0,_getBindingIdentifiers.default)(declar);for(const key of Object.keys(bindings))declars.push({kind:node.kind,id:(0,_cloneNode.default)(bindings[key])});declar.init&&exprs.push((0,_index2.assignmentExpression)("=",declar.id,declar.init))}ensureLastUndefined=!0}else if((0,_index.isIfStatement)(node)){const consequent=node.consequent?gatherSequenceExpressions([node.consequent],declars):(0,_productions.buildUndefinedNode)(),alternate=node.alternate?gatherSequenceExpressions([node.alternate],declars):(0,_productions.buildUndefinedNode)();if(!consequent||!alternate)return;exprs.push((0,_index2.conditionalExpression)(node.test,consequent,alternate))}else if((0,_index.isBlockStatement)(node)){const body=gatherSequenceExpressions(node.body,declars);if(!body)return;exprs.push(body)}else{if(!(0,_index.isEmptyStatement)(node))return;0===nodes.indexOf(node)&&(ensureLastUndefined=!0)}ensureLastUndefined&&exprs.push((0,_productions.buildUndefinedNode)());return 1===exprs.length?exprs[0]:(0,_index2.sequenceExpression)(exprs)};var _getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_productions=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/productions.js"),_cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBindingIdentifierName.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(name){"eval"!==(name=(0,_toIdentifier.default)(name))&&"arguments"!==name||(name="_"+name);return name};var _toIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toIdentifier.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBlock.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent){if((0,_index.isBlockStatement)(node))return node;let blockNodes=[];(0,_index.isEmptyStatement)(node)?blockNodes=[]:((0,_index.isStatement)(node)||(node=(0,_index.isFunction)(parent)?(0,_index2.returnStatement)(node):(0,_index2.expressionStatement)(node)),blockNodes=[node]);return(0,_index2.blockStatement)(blockNodes)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toComputedKey.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,key=node.key||node.property){!node.computed&&(0,_index.isIdentifier)(key)&&(key=(0,_index2.stringLiteral)(key.name));return key};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");exports.default=function(node){(0,_index.isExpressionStatement)(node)&&(node=node.expression);if((0,_index.isExpression)(node))return node;(0,_index.isClass)(node)?node.type="ClassExpression":(0,_index.isFunction)(node)&&(node.type="FunctionExpression");if(!(0,_index.isExpression)(node))throw new Error(`cannot turn ${node.type} to an expression`);return node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toIdentifier.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(input){input+="";let name="";for(const c of input)name+=(0,_helperValidatorIdentifier.isIdentifierChar)(c.codePointAt(0))?c:"-";name=name.replace(/^[-0-9]+/,""),name=name.replace(/[-\s]+(.)?/g,(function(match,c){return c?c.toUpperCase():""})),(0,_isValidIdentifier.default)(name)||(name=`_${name}`);return name||"_"};var _isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_helperValidatorIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-identifier@7.25.9/node_modules/@babel/helper-validator-identifier/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toKeyAlias.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=toKeyAlias;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js"),_removePropertiesDeep=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removePropertiesDeep.js");function toKeyAlias(node,key=node.key){let alias;return"method"===node.kind?toKeyAlias.increment()+"":(alias=(0,_index.isIdentifier)(key)?key.name:(0,_index.isStringLiteral)(key)?JSON.stringify(key.value):JSON.stringify((0,_removePropertiesDeep.default)((0,_cloneNode.default)(key))),node.computed&&(alias=`[${alias}]`),node.static&&(alias=`static:${alias}`),alias)}toKeyAlias.uid=0,toKeyAlias.increment=function(){return toKeyAlias.uid>=Number.MAX_SAFE_INTEGER?toKeyAlias.uid=0:toKeyAlias.uid++}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toSequenceExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";exports.default=function(nodes,scope){if(null==nodes||!nodes.length)return;const declars=[],result=(0,_gatherSequenceExpressions.default)(nodes,declars);if(!result)return;for(const declar of declars)scope.push(declar);return result};var _gatherSequenceExpressions=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/gatherSequenceExpressions.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toStatement.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");exports.default=function(node,ignore){if((0,_index.isStatement)(node))return node;let newType,mustHaveId=!1;if((0,_index.isClass)(node))mustHaveId=!0,newType="ClassDeclaration";else if((0,_index.isFunction)(node))mustHaveId=!0,newType="FunctionDeclaration";else if((0,_index.isAssignmentExpression)(node))return(0,_index2.expressionStatement)(node);mustHaveId&&!node.id&&(newType=!1);if(!newType){if(ignore)return!1;throw new Error(`cannot turn ${node.type} to a statement`)}return node.type=newType,node}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/valueToNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");exports.default=function valueToNode(value){if(void 0===value)return(0,_index.identifier)("undefined");if(!0===value||!1===value)return(0,_index.booleanLiteral)(value);if(null===value)return(0,_index.nullLiteral)();if("string"==typeof value)return(0,_index.stringLiteral)(value);if("number"==typeof value){let result;if(Number.isFinite(value))result=(0,_index.numericLiteral)(Math.abs(value));else{let numerator;numerator=Number.isNaN(value)?(0,_index.numericLiteral)(0):(0,_index.numericLiteral)(1),result=(0,_index.binaryExpression)("/",numerator,(0,_index.numericLiteral)(0))}return(value<0||Object.is(value,-0))&&(result=(0,_index.unaryExpression)("-",result)),result}if(function(value){return"[object RegExp]"===objectToString(value)}(value)){const pattern=value.source,flags=/\/([a-z]*)$/.exec(value.toString())[1];return(0,_index.regExpLiteral)(pattern,flags)}if(Array.isArray(value))return(0,_index.arrayExpression)(value.map(valueToNode));if(function(value){if("object"!=typeof value||null===value||"[object Object]"!==Object.prototype.toString.call(value))return!1;const proto=Object.getPrototypeOf(value);return null===proto||null===Object.getPrototypeOf(proto)}(value)){const props=[];for(const key of Object.keys(value)){let nodeKey;nodeKey=(0,_isValidIdentifier.default)(key)?(0,_index.identifier)(key):(0,_index.stringLiteral)(key),props.push((0,_index.objectProperty)(nodeKey,valueToNode(value[key])))}return(0,_index.objectExpression)(props)}throw new Error("don't know how to turn this value into a node")};const objectToString=Function.call.bind(Object.prototype.toString)},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.patternLikeCommon=exports.importAttributes=exports.functionTypeAnnotationCommon=exports.functionDeclarationCommon=exports.functionCommon=exports.classMethodOrPropertyCommon=exports.classMethodOrDeclareMethodCommon=void 0;var _is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_helperValidatorIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-identifier@7.25.9/node_modules/@babel/helper-validator-identifier/lib/index.js"),_helperStringParser=__webpack_require__("./node_modules/.pnpm/@babel+helper-string-parser@7.25.9/node_modules/@babel/helper-string-parser/lib/index.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js"),_utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const defineType=(0,_utils.defineAliasedType)("Standardized");defineType("ArrayExpression",{fields:{elements:{validate:(0,_utils.arrayOf)((0,_utils.assertNodeOrValueType)("null","Expression","SpreadElement")),default:process.env.BABEL_TYPES_8_BREAKING?void 0:[]}},visitor:["elements"],aliases:["Expression"]}),defineType("AssignmentExpression",{fields:{operator:{validate:process.env.BABEL_TYPES_8_BREAKING?Object.assign(function(){const identifier=(0,_utils.assertOneOf)(..._index.ASSIGNMENT_OPERATORS),pattern=(0,_utils.assertOneOf)("=");return function(node,key,val){((0,_is.default)("Pattern",node.left)?pattern:identifier)(node,key,val)}}(),{type:"string"}):(0,_utils.assertValueType)("string")},left:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","MemberExpression","OptionalMemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"):(0,_utils.assertNodeType)("LVal","OptionalMemberExpression")},right:{validate:(0,_utils.assertNodeType)("Expression")}},builder:["operator","left","right"],visitor:["left","right"],aliases:["Expression"]}),defineType("BinaryExpression",{builder:["operator","left","right"],fields:{operator:{validate:(0,_utils.assertOneOf)(..._index.BINARY_OPERATORS)},left:{validate:function(){const expression=(0,_utils.assertNodeType)("Expression"),inOp=(0,_utils.assertNodeType)("Expression","PrivateName");return Object.assign((function(node,key,val){("in"===node.operator?inOp:expression)(node,key,val)}),{oneOfNodeTypes:["Expression","PrivateName"]})}()},right:{validate:(0,_utils.assertNodeType)("Expression")}},visitor:["left","right"],aliases:["Binary","Expression"]}),defineType("InterpreterDirective",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}}}),defineType("Directive",{visitor:["value"],fields:{value:{validate:(0,_utils.assertNodeType)("DirectiveLiteral")}}}),defineType("DirectiveLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}}}),defineType("BlockStatement",{builder:["body","directives"],visitor:["directives","body"],fields:{directives:{validate:(0,_utils.arrayOfType)("Directive"),default:[]},body:(0,_utils.validateArrayOfType)("Statement")},aliases:["Scopable","BlockParent","Block","Statement"]}),defineType("BreakStatement",{visitor:["label"],fields:{label:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0}},aliases:["Statement","Terminatorless","CompletionStatement"]}),defineType("CallExpression",{visitor:["callee","arguments","typeParameters","typeArguments"],builder:["callee","arguments"],aliases:["Expression"],fields:Object.assign({callee:{validate:(0,_utils.assertNodeType)("Expression","Super","V8IntrinsicIdentifier")},arguments:(0,_utils.validateArrayOfType)("Expression","SpreadElement","ArgumentPlaceholder")},process.env.BABEL_TYPES_8_BREAKING?{}:{optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}},{typeArguments:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TSTypeParameterInstantiation"),optional:!0}})}),defineType("CatchClause",{visitor:["param","body"],fields:{param:{validate:(0,_utils.assertNodeType)("Identifier","ArrayPattern","ObjectPattern"),optional:!0},body:{validate:(0,_utils.assertNodeType)("BlockStatement")}},aliases:["Scopable","BlockParent"]}),defineType("ConditionalExpression",{visitor:["test","consequent","alternate"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},consequent:{validate:(0,_utils.assertNodeType)("Expression")},alternate:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Expression","Conditional"]}),defineType("ContinueStatement",{visitor:["label"],fields:{label:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0}},aliases:["Statement","Terminatorless","CompletionStatement"]}),defineType("DebuggerStatement",{aliases:["Statement"]}),defineType("DoWhileStatement",{builder:["test","body"],visitor:["body","test"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}},aliases:["Statement","BlockParent","Loop","While","Scopable"]}),defineType("EmptyStatement",{aliases:["Statement"]}),defineType("ExpressionStatement",{visitor:["expression"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Statement","ExpressionWrapper"]}),defineType("File",{builder:["program","comments","tokens"],visitor:["program"],fields:{program:{validate:(0,_utils.assertNodeType)("Program")},comments:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertEach)((0,_utils.assertNodeType)("CommentBlock","CommentLine")):Object.assign((()=>{}),{each:{oneOfNodeTypes:["CommentBlock","CommentLine"]}}),optional:!0},tokens:{validate:(0,_utils.assertEach)(Object.assign((()=>{}),{type:"any"})),optional:!0}}}),defineType("ForInStatement",{visitor:["left","right","body"],aliases:["Scopable","Statement","For","BlockParent","Loop","ForXStatement"],fields:{left:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("VariableDeclaration","Identifier","MemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"):(0,_utils.assertNodeType)("VariableDeclaration","LVal")},right:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("ForStatement",{visitor:["init","test","update","body"],aliases:["Scopable","Statement","For","BlockParent","Loop"],fields:{init:{validate:(0,_utils.assertNodeType)("VariableDeclaration","Expression"),optional:!0},test:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},update:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},body:{validate:(0,_utils.assertNodeType)("Statement")}}});const functionCommon=()=>({params:(0,_utils.validateArrayOfType)("Identifier","Pattern","RestElement"),generator:{default:!1},async:{default:!1}});exports.functionCommon=functionCommon;const functionTypeAnnotationCommon=()=>({returnType:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterDeclaration","TSTypeParameterDeclaration","Noop"),optional:!0}});exports.functionTypeAnnotationCommon=functionTypeAnnotationCommon;const functionDeclarationCommon=()=>Object.assign({},functionCommon(),{declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0}});exports.functionDeclarationCommon=functionDeclarationCommon,defineType("FunctionDeclaration",{builder:["id","params","body","generator","async"],visitor:["id","typeParameters","params","returnType","body"],fields:Object.assign({},functionDeclarationCommon(),functionTypeAnnotationCommon(),{body:{validate:(0,_utils.assertNodeType)("BlockStatement")},predicate:{validate:(0,_utils.assertNodeType)("DeclaredPredicate","InferredPredicate"),optional:!0}}),aliases:["Scopable","Function","BlockParent","FunctionParent","Statement","Pureish","Declaration"],validate:process.env.BABEL_TYPES_8_BREAKING?function(){const identifier=(0,_utils.assertNodeType)("Identifier");return function(parent,key,node){(0,_is.default)("ExportDefaultDeclaration",parent)||identifier(node,"id",node.id)}}():void 0}),defineType("FunctionExpression",{inherits:"FunctionDeclaration",aliases:["Scopable","Function","BlockParent","FunctionParent","Expression","Pureish"],fields:Object.assign({},functionCommon(),functionTypeAnnotationCommon(),{id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0},body:{validate:(0,_utils.assertNodeType)("BlockStatement")},predicate:{validate:(0,_utils.assertNodeType)("DeclaredPredicate","InferredPredicate"),optional:!0}})});const patternLikeCommon=()=>({typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}});exports.patternLikeCommon=patternLikeCommon,defineType("Identifier",{builder:["name"],visitor:["typeAnnotation","decorators"],aliases:["Expression","PatternLike","LVal","TSEntityName"],fields:Object.assign({},patternLikeCommon(),{name:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("string"),Object.assign((function(node,key,val){if(!(0,_isValidIdentifier.default)(val,!1))throw new TypeError(`"${val}" is not a valid identifier name`)}),{type:"string"})):(0,_utils.assertValueType)("string")}}),validate:process.env.BABEL_TYPES_8_BREAKING?function(parent,key,node){const match=/\.(\w+)$/.exec(key);if(!match)return;const[,parentKey]=match,nonComp={computed:!1};if("property"===parentKey){if((0,_is.default)("MemberExpression",parent,nonComp))return;if((0,_is.default)("OptionalMemberExpression",parent,nonComp))return}else if("key"===parentKey){if((0,_is.default)("Property",parent,nonComp))return;if((0,_is.default)("Method",parent,nonComp))return}else if("exported"===parentKey){if((0,_is.default)("ExportSpecifier",parent))return}else if("imported"===parentKey){if((0,_is.default)("ImportSpecifier",parent,{imported:node}))return}else if("meta"===parentKey&&(0,_is.default)("MetaProperty",parent,{meta:node}))return;if(((0,_helperValidatorIdentifier.isKeyword)(node.name)||(0,_helperValidatorIdentifier.isReservedWord)(node.name,!1))&&"this"!==node.name)throw new TypeError(`"${node.name}" is not a valid identifier`)}:void 0}),defineType("IfStatement",{visitor:["test","consequent","alternate"],aliases:["Statement","Conditional"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},consequent:{validate:(0,_utils.assertNodeType)("Statement")},alternate:{optional:!0,validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("LabeledStatement",{visitor:["label","body"],aliases:["Statement"],fields:{label:{validate:(0,_utils.assertNodeType)("Identifier")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("StringLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("NumericLiteral",{builder:["value"],deprecatedAlias:"NumberLiteral",fields:{value:{validate:(0,_utils.chain)((0,_utils.assertValueType)("number"),Object.assign((function(node,key,val){if(1/val<0||!Number.isFinite(val)){new Error(`NumericLiterals must be non-negative finite numbers. You can use t.valueToNode(${val}) instead.`)}}),{type:"number"}))}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("NullLiteral",{aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("BooleanLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("boolean")}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("RegExpLiteral",{builder:["pattern","flags"],deprecatedAlias:"RegexLiteral",aliases:["Expression","Pureish","Literal"],fields:{pattern:{validate:(0,_utils.assertValueType)("string")},flags:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("string"),Object.assign((function(node,key,val){const invalid=/[^gimsuy]/.exec(val);if(invalid)throw new TypeError(`"${invalid[0]}" is not a valid RegExp flag`)}),{type:"string"})):(0,_utils.assertValueType)("string"),default:""}}}),defineType("LogicalExpression",{builder:["operator","left","right"],visitor:["left","right"],aliases:["Binary","Expression"],fields:{operator:{validate:(0,_utils.assertOneOf)(..._index.LOGICAL_OPERATORS)},left:{validate:(0,_utils.assertNodeType)("Expression")},right:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("MemberExpression",{builder:["object","property","computed",...process.env.BABEL_TYPES_8_BREAKING?[]:["optional"]],visitor:["object","property"],aliases:["Expression","LVal"],fields:Object.assign({object:{validate:(0,_utils.assertNodeType)("Expression","Super")},property:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier","PrivateName"),computed=(0,_utils.assertNodeType)("Expression"),validator=function(node,key,val){(node.computed?computed:normal)(node,key,val)};return validator.oneOfNodeTypes=["Expression","Identifier","PrivateName"],validator}()},computed:{default:!1}},process.env.BABEL_TYPES_8_BREAKING?{}:{optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}})}),defineType("NewExpression",{inherits:"CallExpression"}),defineType("Program",{visitor:["directives","body"],builder:["body","directives","sourceType","interpreter"],fields:{sourceType:{validate:(0,_utils.assertOneOf)("script","module"),default:"script"},interpreter:{validate:(0,_utils.assertNodeType)("InterpreterDirective"),default:null,optional:!0},directives:{validate:(0,_utils.arrayOfType)("Directive"),default:[]},body:(0,_utils.validateArrayOfType)("Statement")},aliases:["Scopable","BlockParent","Block"]}),defineType("ObjectExpression",{visitor:["properties"],aliases:["Expression"],fields:{properties:(0,_utils.validateArrayOfType)("ObjectMethod","ObjectProperty","SpreadElement")}}),defineType("ObjectMethod",{builder:["kind","key","params","body","computed","generator","async"],visitor:["decorators","key","typeParameters","params","returnType","body"],fields:Object.assign({},functionCommon(),functionTypeAnnotationCommon(),{kind:Object.assign({validate:(0,_utils.assertOneOf)("method","get","set")},process.env.BABEL_TYPES_8_BREAKING?{}:{default:"method"}),computed:{default:!1},key:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral"),computed=(0,_utils.assertNodeType)("Expression"),validator=function(node,key,val){(node.computed?computed:normal)(node,key,val)};return validator.oneOfNodeTypes=["Expression","Identifier","StringLiteral","NumericLiteral","BigIntLiteral"],validator}()},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},body:{validate:(0,_utils.assertNodeType)("BlockStatement")}}),aliases:["UserWhitespacable","Function","Scopable","BlockParent","FunctionParent","Method","ObjectMember"]}),defineType("ObjectProperty",{builder:["key","value","computed","shorthand",...process.env.BABEL_TYPES_8_BREAKING?[]:["decorators"]],fields:{computed:{default:!1},key:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","DecimalLiteral","PrivateName"),computed=(0,_utils.assertNodeType)("Expression");return Object.assign((function(node,key,val){(node.computed?computed:normal)(node,key,val)}),{oneOfNodeTypes:["Expression","Identifier","StringLiteral","NumericLiteral","BigIntLiteral","DecimalLiteral","PrivateName"]})}()},value:{validate:(0,_utils.assertNodeType)("Expression","PatternLike")},shorthand:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),Object.assign((function(node,key,shorthand){if(shorthand){if(node.computed)throw new TypeError("Property shorthand of ObjectProperty cannot be true if computed is true");if(!(0,_is.default)("Identifier",node.key))throw new TypeError("Property shorthand of ObjectProperty cannot be true if key is not an Identifier")}}),{type:"boolean"})):(0,_utils.assertValueType)("boolean"),default:!1},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}},visitor:["key","value","decorators"],aliases:["UserWhitespacable","Property","ObjectMember"],validate:process.env.BABEL_TYPES_8_BREAKING?function(){const pattern=(0,_utils.assertNodeType)("Identifier","Pattern","TSAsExpression","TSSatisfiesExpression","TSNonNullExpression","TSTypeAssertion"),expression=(0,_utils.assertNodeType)("Expression");return function(parent,key,node){((0,_is.default)("ObjectPattern",parent)?pattern:expression)(node,"value",node.value)}}():void 0}),defineType("RestElement",{visitor:["argument","typeAnnotation"],builder:["argument"],aliases:["LVal","PatternLike"],deprecatedAlias:"RestProperty",fields:Object.assign({},patternLikeCommon(),{argument:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","ArrayPattern","ObjectPattern","MemberExpression","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"):(0,_utils.assertNodeType)("LVal")}}),validate:process.env.BABEL_TYPES_8_BREAKING?function(parent,key){const match=/(\w+)\[(\d+)\]/.exec(key);if(!match)throw new Error("Internal Babel error: malformed key.");const[,listKey,index]=match;if(parent[listKey].length>+index+1)throw new TypeError(`RestElement must be last element of ${listKey}`)}:void 0}),defineType("ReturnStatement",{visitor:["argument"],aliases:["Statement","Terminatorless","CompletionStatement"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0}}}),defineType("SequenceExpression",{visitor:["expressions"],fields:{expressions:(0,_utils.validateArrayOfType)("Expression")},aliases:["Expression"]}),defineType("ParenthesizedExpression",{visitor:["expression"],aliases:["Expression","ExpressionWrapper"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("SwitchCase",{visitor:["test","consequent"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},consequent:(0,_utils.validateArrayOfType)("Statement")}}),defineType("SwitchStatement",{visitor:["discriminant","cases"],aliases:["Statement","BlockParent","Scopable"],fields:{discriminant:{validate:(0,_utils.assertNodeType)("Expression")},cases:(0,_utils.validateArrayOfType)("SwitchCase")}}),defineType("ThisExpression",{aliases:["Expression"]}),defineType("ThrowStatement",{visitor:["argument"],aliases:["Statement","Terminatorless","CompletionStatement"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("TryStatement",{visitor:["block","handler","finalizer"],aliases:["Statement"],fields:{block:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertNodeType)("BlockStatement"),Object.assign((function(node){if(!node.handler&&!node.finalizer)throw new TypeError("TryStatement expects either a handler or finalizer, or both")}),{oneOfNodeTypes:["BlockStatement"]})):(0,_utils.assertNodeType)("BlockStatement")},handler:{optional:!0,validate:(0,_utils.assertNodeType)("CatchClause")},finalizer:{optional:!0,validate:(0,_utils.assertNodeType)("BlockStatement")}}}),defineType("UnaryExpression",{builder:["operator","argument","prefix"],fields:{prefix:{default:!0},argument:{validate:(0,_utils.assertNodeType)("Expression")},operator:{validate:(0,_utils.assertOneOf)(..._index.UNARY_OPERATORS)}},visitor:["argument"],aliases:["UnaryLike","Expression"]}),defineType("UpdateExpression",{builder:["operator","argument","prefix"],fields:{prefix:{default:!1},argument:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","MemberExpression"):(0,_utils.assertNodeType)("Expression")},operator:{validate:(0,_utils.assertOneOf)(..._index.UPDATE_OPERATORS)}},visitor:["argument"],aliases:["Expression"]}),defineType("VariableDeclaration",{builder:["kind","declarations"],visitor:["declarations"],aliases:["Statement","Declaration"],fields:{declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},kind:{validate:(0,_utils.assertOneOf)("var","let","const","using","await using")},declarations:(0,_utils.validateArrayOfType)("VariableDeclarator")},validate:process.env.BABEL_TYPES_8_BREAKING?(()=>{const withoutInit=(0,_utils.assertNodeType)("Identifier");return function(parent,key,node){if((0,_is.default)("ForXStatement",parent,{left:node})){if(1!==node.declarations.length)throw new TypeError(`Exactly one VariableDeclarator is required in the VariableDeclaration of a ${parent.type}`)}else node.declarations.forEach((decl=>{decl.init||withoutInit(decl,"id",decl.id)}))}})():void 0}),defineType("VariableDeclarator",{visitor:["id","init"],fields:{id:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.assertNodeType)("Identifier","ArrayPattern","ObjectPattern"):(0,_utils.assertNodeType)("LVal")},definite:{optional:!0,validate:(0,_utils.assertValueType)("boolean")},init:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("WhileStatement",{visitor:["test","body"],aliases:["Statement","BlockParent","Loop","While","Scopable"],fields:{test:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("WithStatement",{visitor:["object","body"],aliases:["Statement"],fields:{object:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")}}}),defineType("AssignmentPattern",{visitor:["left","right","decorators"],builder:["left","right"],aliases:["Pattern","PatternLike","LVal"],fields:Object.assign({},patternLikeCommon(),{left:{validate:(0,_utils.assertNodeType)("Identifier","ObjectPattern","ArrayPattern","MemberExpression","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression")},right:{validate:(0,_utils.assertNodeType)("Expression")},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}})}),defineType("ArrayPattern",{visitor:["elements","typeAnnotation"],builder:["elements"],aliases:["Pattern","PatternLike","LVal"],fields:Object.assign({},patternLikeCommon(),{elements:{validate:(0,_utils.chain)((0,_utils.assertValueType)("array"),(0,_utils.assertEach)((0,_utils.assertNodeOrValueType)("null","PatternLike","LVal")))}})}),defineType("ArrowFunctionExpression",{builder:["params","body","async"],visitor:["typeParameters","params","returnType","body"],aliases:["Scopable","Function","BlockParent","FunctionParent","Expression","Pureish"],fields:Object.assign({},functionCommon(),functionTypeAnnotationCommon(),{expression:{validate:(0,_utils.assertValueType)("boolean")},body:{validate:(0,_utils.assertNodeType)("BlockStatement","Expression")},predicate:{validate:(0,_utils.assertNodeType)("DeclaredPredicate","InferredPredicate"),optional:!0}})}),defineType("ClassBody",{visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("ClassMethod","ClassPrivateMethod","ClassProperty","ClassPrivateProperty","ClassAccessorProperty","TSDeclareMethod","TSIndexSignature","StaticBlock")}}),defineType("ClassExpression",{builder:["id","superClass","body","decorators"],visitor:["decorators","id","typeParameters","superClass","superTypeParameters","mixins","implements","body"],aliases:["Scopable","Class","Expression"],fields:{id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterDeclaration","TSTypeParameterDeclaration","Noop"),optional:!0},body:{validate:(0,_utils.assertNodeType)("ClassBody")},superClass:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")},superTypeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0},implements:{validate:(0,_utils.arrayOfType)("TSExpressionWithTypeArguments","ClassImplements"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},mixins:{validate:(0,_utils.assertNodeType)("InterfaceExtends"),optional:!0}}}),defineType("ClassDeclaration",{inherits:"ClassExpression",aliases:["Scopable","Class","Statement","Declaration"],fields:{id:{validate:(0,_utils.assertNodeType)("Identifier"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterDeclaration","TSTypeParameterDeclaration","Noop"),optional:!0},body:{validate:(0,_utils.assertNodeType)("ClassBody")},superClass:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")},superTypeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0},implements:{validate:(0,_utils.arrayOfType)("TSExpressionWithTypeArguments","ClassImplements"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},mixins:{validate:(0,_utils.assertNodeType)("InterfaceExtends"),optional:!0},declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},abstract:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}},validate:process.env.BABEL_TYPES_8_BREAKING?function(){const identifier=(0,_utils.assertNodeType)("Identifier");return function(parent,key,node){(0,_is.default)("ExportDefaultDeclaration",parent)||identifier(node,"id",node.id)}}():void 0});const importAttributes=exports.importAttributes={attributes:{optional:!0,validate:(0,_utils.arrayOfType)("ImportAttribute")},assertions:{deprecated:!0,optional:!0,validate:(0,_utils.arrayOfType)("ImportAttribute")}};defineType("ExportAllDeclaration",{builder:["source"],visitor:["source","attributes","assertions"],aliases:["Statement","Declaration","ImportOrExportDeclaration","ExportDeclaration"],fields:Object.assign({source:{validate:(0,_utils.assertNodeType)("StringLiteral")},exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("type","value"))},importAttributes)}),defineType("ExportDefaultDeclaration",{visitor:["declaration"],aliases:["Statement","Declaration","ImportOrExportDeclaration","ExportDeclaration"],fields:{declaration:(0,_utils.validateType)("TSDeclareFunction","FunctionDeclaration","ClassDeclaration","Expression"),exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("value"))}}),defineType("ExportNamedDeclaration",{builder:["declaration","specifiers","source"],visitor:process.env?["declaration","specifiers","source","attributes"]:["declaration","specifiers","source","attributes","assertions"],aliases:["Statement","Declaration","ImportOrExportDeclaration","ExportDeclaration"],fields:Object.assign({declaration:{optional:!0,validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertNodeType)("Declaration"),Object.assign((function(node,key,val){if(val&&node.specifiers.length)throw new TypeError("Only declaration or specifiers is allowed on ExportNamedDeclaration");if(val&&node.source)throw new TypeError("Cannot export a declaration from a source")}),{oneOfNodeTypes:["Declaration"]})):(0,_utils.assertNodeType)("Declaration")}},importAttributes,{specifiers:{default:[],validate:(0,_utils.arrayOf)(function(){const sourced=(0,_utils.assertNodeType)("ExportSpecifier","ExportDefaultSpecifier","ExportNamespaceSpecifier"),sourceless=(0,_utils.assertNodeType)("ExportSpecifier");return process.env.BABEL_TYPES_8_BREAKING?Object.assign((function(node,key,val){(node.source?sourced:sourceless)(node,key,val)}),{oneOfNodeTypes:["ExportSpecifier","ExportDefaultSpecifier","ExportNamespaceSpecifier"]}):sourced}())},source:{validate:(0,_utils.assertNodeType)("StringLiteral"),optional:!0},exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("type","value"))})}),defineType("ExportSpecifier",{visitor:["local","exported"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")},exported:{validate:(0,_utils.assertNodeType)("Identifier","StringLiteral")},exportKind:{validate:(0,_utils.assertOneOf)("type","value"),optional:!0}}}),defineType("ForOfStatement",{visitor:["left","right","body"],builder:["left","right","body","await"],aliases:["Scopable","Statement","For","BlockParent","Loop","ForXStatement"],fields:{left:{validate:function(){if(!process.env.BABEL_TYPES_8_BREAKING)return(0,_utils.assertNodeType)("VariableDeclaration","LVal");const declaration=(0,_utils.assertNodeType)("VariableDeclaration"),lval=(0,_utils.assertNodeType)("Identifier","MemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression");return Object.assign((function(node,key,val){(0,_is.default)("VariableDeclaration",val)?declaration(node,key,val):lval(node,key,val)}),{oneOfNodeTypes:["VariableDeclaration","Identifier","MemberExpression","ArrayPattern","ObjectPattern","TSAsExpression","TSSatisfiesExpression","TSTypeAssertion","TSNonNullExpression"]})}()},right:{validate:(0,_utils.assertNodeType)("Expression")},body:{validate:(0,_utils.assertNodeType)("Statement")},await:{default:!1}}}),defineType("ImportDeclaration",{builder:["specifiers","source"],visitor:["specifiers","source","attributes","assertions"],aliases:["Statement","Declaration","ImportOrExportDeclaration"],fields:Object.assign({},importAttributes,{module:{optional:!0,validate:(0,_utils.assertValueType)("boolean")},phase:{default:null,validate:(0,_utils.assertOneOf)("source","defer")},specifiers:(0,_utils.validateArrayOfType)("ImportSpecifier","ImportDefaultSpecifier","ImportNamespaceSpecifier"),source:{validate:(0,_utils.assertNodeType)("StringLiteral")},importKind:{validate:(0,_utils.assertOneOf)("type","typeof","value"),optional:!0}})}),defineType("ImportDefaultSpecifier",{visitor:["local"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("ImportNamespaceSpecifier",{visitor:["local"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("ImportSpecifier",{visitor:["imported","local"],builder:["local","imported"],aliases:["ModuleSpecifier"],fields:{local:{validate:(0,_utils.assertNodeType)("Identifier")},imported:{validate:(0,_utils.assertNodeType)("Identifier","StringLiteral")},importKind:{validate:(0,_utils.assertOneOf)("type","typeof","value"),optional:!0}}}),defineType("ImportExpression",{visitor:["source","options"],aliases:["Expression"],fields:{phase:{default:null,validate:(0,_utils.assertOneOf)("source","defer")},source:{validate:(0,_utils.assertNodeType)("Expression")},options:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0}}}),defineType("MetaProperty",{visitor:["meta","property"],aliases:["Expression"],fields:{meta:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertNodeType)("Identifier"),Object.assign((function(node,key,val){let property;switch(val.name){case"function":property="sent";break;case"new":property="target";break;case"import":property="meta"}if(!(0,_is.default)("Identifier",node.property,{name:property}))throw new TypeError("Unrecognised MetaProperty")}),{oneOfNodeTypes:["Identifier"]})):(0,_utils.assertNodeType)("Identifier")},property:{validate:(0,_utils.assertNodeType)("Identifier")}}});const classMethodOrPropertyCommon=()=>({abstract:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},accessibility:{validate:(0,_utils.assertOneOf)("public","private","protected"),optional:!0},static:{default:!1},override:{default:!1},computed:{default:!1},optional:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},key:{validate:(0,_utils.chain)(function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral"),computed=(0,_utils.assertNodeType)("Expression");return function(node,key,val){(node.computed?computed:normal)(node,key,val)}}(),(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","Expression"))}});exports.classMethodOrPropertyCommon=classMethodOrPropertyCommon;const classMethodOrDeclareMethodCommon=()=>Object.assign({},functionCommon(),classMethodOrPropertyCommon(),{params:(0,_utils.validateArrayOfType)("Identifier","Pattern","RestElement","TSParameterProperty"),kind:{validate:(0,_utils.assertOneOf)("get","set","method","constructor"),default:"method"},access:{validate:(0,_utils.chain)((0,_utils.assertValueType)("string"),(0,_utils.assertOneOf)("public","private","protected")),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}});exports.classMethodOrDeclareMethodCommon=classMethodOrDeclareMethodCommon,defineType("ClassMethod",{aliases:["Function","Scopable","BlockParent","FunctionParent","Method"],builder:["kind","key","params","body","computed","static","generator","async"],visitor:["decorators","key","typeParameters","params","returnType","body"],fields:Object.assign({},classMethodOrDeclareMethodCommon(),functionTypeAnnotationCommon(),{body:{validate:(0,_utils.assertNodeType)("BlockStatement")}})}),defineType("ObjectPattern",{visitor:["properties","typeAnnotation","decorators"],builder:["properties"],aliases:["Pattern","PatternLike","LVal"],fields:Object.assign({},patternLikeCommon(),{properties:(0,_utils.validateArrayOfType)("RestElement","ObjectProperty")})}),defineType("SpreadElement",{visitor:["argument"],aliases:["UnaryLike"],deprecatedAlias:"SpreadProperty",fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("Super",{aliases:["Expression"]}),defineType("TaggedTemplateExpression",{visitor:["tag","typeParameters","quasi"],builder:["tag","quasi"],aliases:["Expression"],fields:{tag:{validate:(0,_utils.assertNodeType)("Expression")},quasi:{validate:(0,_utils.assertNodeType)("TemplateLiteral")},typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0}}}),defineType("TemplateElement",{builder:["value","tail"],fields:{value:{validate:(0,_utils.chain)((0,_utils.assertShape)({raw:{validate:(0,_utils.assertValueType)("string")},cooked:{validate:(0,_utils.assertValueType)("string"),optional:!0}}),(function(node){const raw=node.value.raw;let unterminatedCalled=!1;const error=()=>{throw new Error("Internal @babel/types error.")},{str,firstInvalidLoc}=(0,_helperStringParser.readStringContents)("template",raw,0,0,0,{unterminated(){unterminatedCalled=!0},strictNumericEscape:error,invalidEscapeSequence:error,numericSeparatorInEscapeSequence:error,unexpectedNumericSeparator:error,invalidDigit:error,invalidCodePoint:error});if(!unterminatedCalled)throw new Error("Invalid raw");node.value.cooked=firstInvalidLoc?null:str}))},tail:{default:!1}}}),defineType("TemplateLiteral",{visitor:["quasis","expressions"],aliases:["Expression","Literal"],fields:{quasis:(0,_utils.validateArrayOfType)("TemplateElement"),expressions:{validate:(0,_utils.chain)((0,_utils.assertValueType)("array"),(0,_utils.assertEach)((0,_utils.assertNodeType)("Expression","TSType")),(function(node,key,val){if(node.quasis.length!==val.length+1)throw new TypeError(`Number of ${node.type} quasis should be exactly one more than the number of expressions.\nExpected ${val.length+1} quasis but got ${node.quasis.length}`)}))}}}),defineType("YieldExpression",{builder:["argument","delegate"],visitor:["argument"],aliases:["Expression","Terminatorless"],fields:{delegate:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),Object.assign((function(node,key,val){if(val&&!node.argument)throw new TypeError("Property delegate of YieldExpression cannot be true if there is no argument")}),{type:"boolean"})):(0,_utils.assertValueType)("boolean"),default:!1},argument:{optional:!0,validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("AwaitExpression",{builder:["argument"],visitor:["argument"],aliases:["Expression","Terminatorless"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("Import",{aliases:["Expression"]}),defineType("BigIntLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}},aliases:["Expression","Pureish","Literal","Immutable"]}),defineType("ExportNamespaceSpecifier",{visitor:["exported"],aliases:["ModuleSpecifier"],fields:{exported:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("OptionalMemberExpression",{builder:["object","property","computed","optional"],visitor:["object","property"],aliases:["Expression"],fields:{object:{validate:(0,_utils.assertNodeType)("Expression")},property:{validate:function(){const normal=(0,_utils.assertNodeType)("Identifier"),computed=(0,_utils.assertNodeType)("Expression");return Object.assign((function(node,key,val){(node.computed?computed:normal)(node,key,val)}),{oneOfNodeTypes:["Expression","Identifier"]})}()},computed:{default:!1},optional:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),(0,_utils.assertOptionalChainStart)()):(0,_utils.assertValueType)("boolean")}}}),defineType("OptionalCallExpression",{visitor:["callee","arguments","typeParameters","typeArguments"],builder:["callee","arguments","optional"],aliases:["Expression"],fields:{callee:{validate:(0,_utils.assertNodeType)("Expression")},arguments:(0,_utils.validateArrayOfType)("Expression","SpreadElement","ArgumentPlaceholder"),optional:{validate:process.env.BABEL_TYPES_8_BREAKING?(0,_utils.chain)((0,_utils.assertValueType)("boolean"),(0,_utils.assertOptionalChainStart)()):(0,_utils.assertValueType)("boolean")},typeArguments:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TSTypeParameterInstantiation"),optional:!0}}}),defineType("ClassProperty",{visitor:["decorators","key","typeAnnotation","value"],builder:["key","value","typeAnnotation","decorators","computed","static"],aliases:["Property"],fields:Object.assign({},classMethodOrPropertyCommon(),{value:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},definite:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},variance:{validate:(0,_utils.assertNodeType)("Variance"),optional:!0}})}),defineType("ClassAccessorProperty",{visitor:["decorators","key","typeAnnotation","value"],builder:["key","value","typeAnnotation","decorators","computed","static"],aliases:["Property","Accessor"],fields:Object.assign({},classMethodOrPropertyCommon(),{key:{validate:(0,_utils.chain)(function(){const normal=(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","PrivateName"),computed=(0,_utils.assertNodeType)("Expression");return function(node,key,val){(node.computed?computed:normal)(node,key,val)}}(),(0,_utils.assertNodeType)("Identifier","StringLiteral","NumericLiteral","BigIntLiteral","Expression","PrivateName"))},value:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},definite:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},declare:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},variance:{validate:(0,_utils.assertNodeType)("Variance"),optional:!0}})}),defineType("ClassPrivateProperty",{visitor:["decorators","key","typeAnnotation","value"],builder:["key","value","decorators","static"],aliases:["Property","Private"],fields:{key:{validate:(0,_utils.assertNodeType)("PrivateName")},value:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0},typeAnnotation:{validate:(0,_utils.assertNodeType)("TypeAnnotation","TSTypeAnnotation","Noop"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0},static:{validate:(0,_utils.assertValueType)("boolean"),default:!1},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},definite:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},variance:{validate:(0,_utils.assertNodeType)("Variance"),optional:!0}}}),defineType("ClassPrivateMethod",{builder:["kind","key","params","body","static"],visitor:["decorators","key","typeParameters","params","returnType","body"],aliases:["Function","Scopable","BlockParent","FunctionParent","Method","Private"],fields:Object.assign({},classMethodOrDeclareMethodCommon(),functionTypeAnnotationCommon(),{kind:{validate:(0,_utils.assertOneOf)("get","set","method"),default:"method"},key:{validate:(0,_utils.assertNodeType)("PrivateName")},body:{validate:(0,_utils.assertNodeType)("BlockStatement")}})}),defineType("PrivateName",{visitor:["id"],aliases:["Private"],fields:{id:{validate:(0,_utils.assertNodeType)("Identifier")}}}),defineType("StaticBlock",{visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("Statement")},aliases:["Scopable","BlockParent","FunctionParent"]})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/deprecated-aliases.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEPRECATED_ALIASES=void 0;exports.DEPRECATED_ALIASES={ModuleDeclaration:"ImportOrExportDeclaration"}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/experimental.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");(0,_utils.default)("ArgumentPlaceholder",{}),(0,_utils.default)("BindExpression",{visitor:["object","callee"],aliases:["Expression"],fields:process.env.BABEL_TYPES_8_BREAKING?{object:{validate:(0,_utils.assertNodeType)("Expression")},callee:{validate:(0,_utils.assertNodeType)("Expression")}}:{object:{validate:Object.assign((()=>{}),{oneOfNodeTypes:["Expression"]})},callee:{validate:Object.assign((()=>{}),{oneOfNodeTypes:["Expression"]})}}}),(0,_utils.default)("ImportAttribute",{visitor:["key","value"],fields:{key:{validate:(0,_utils.assertNodeType)("Identifier","StringLiteral")},value:{validate:(0,_utils.assertNodeType)("StringLiteral")}}}),(0,_utils.default)("Decorator",{visitor:["expression"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}}}),(0,_utils.default)("DoExpression",{visitor:["body"],builder:["body","async"],aliases:["Expression"],fields:{body:{validate:(0,_utils.assertNodeType)("BlockStatement")},async:{validate:(0,_utils.assertValueType)("boolean"),default:!1}}}),(0,_utils.default)("ExportDefaultSpecifier",{visitor:["exported"],aliases:["ModuleSpecifier"],fields:{exported:{validate:(0,_utils.assertNodeType)("Identifier")}}}),(0,_utils.default)("RecordExpression",{visitor:["properties"],aliases:["Expression"],fields:{properties:(0,_utils.validateArrayOfType)("ObjectProperty","SpreadElement")}}),(0,_utils.default)("TupleExpression",{fields:{elements:{validate:(0,_utils.arrayOfType)("Expression","SpreadElement"),default:[]}},visitor:["elements"],aliases:["Expression"]}),(0,_utils.default)("DecimalLiteral",{builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}},aliases:["Expression","Pureish","Literal","Immutable"]}),(0,_utils.default)("ModuleExpression",{visitor:["body"],fields:{body:{validate:(0,_utils.assertNodeType)("Program")}},aliases:["Expression"]}),(0,_utils.default)("TopicReference",{aliases:["Expression"]}),(0,_utils.default)("PipelineTopicExpression",{builder:["expression"],visitor:["expression"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Expression"]}),(0,_utils.default)("PipelineBareFunction",{builder:["callee"],visitor:["callee"],fields:{callee:{validate:(0,_utils.assertNodeType)("Expression")}},aliases:["Expression"]}),(0,_utils.default)("PipelinePrimaryTopicReference",{aliases:["Expression"]})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/flow.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _core=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js"),_utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const defineType=(0,_utils.defineAliasedType)("Flow"),defineInterfaceishType=name=>{const isDeclareClass="DeclareClass"===name;defineType(name,{builder:["id","typeParameters","extends","body"],visitor:["id","typeParameters","extends",...isDeclareClass?["mixins","implements"]:[],"body"],aliases:["FlowDeclaration","Statement","Declaration"],fields:Object.assign({id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),extends:(0,_utils.validateOptional)((0,_utils.arrayOfType)("InterfaceExtends"))},isDeclareClass?{mixins:(0,_utils.validateOptional)((0,_utils.arrayOfType)("InterfaceExtends")),implements:(0,_utils.validateOptional)((0,_utils.arrayOfType)("ClassImplements"))}:{},{body:(0,_utils.validateType)("ObjectTypeAnnotation")})})};defineType("AnyTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ArrayTypeAnnotation",{visitor:["elementType"],aliases:["FlowType"],fields:{elementType:(0,_utils.validateType)("FlowType")}}),defineType("BooleanTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("BooleanLiteralTypeAnnotation",{builder:["value"],aliases:["FlowType"],fields:{value:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("NullLiteralTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ClassImplements",{visitor:["id","typeParameters"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterInstantiation")}}),defineInterfaceishType("DeclareClass"),defineType("DeclareFunction",{visitor:["id"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),predicate:(0,_utils.validateOptionalType)("DeclaredPredicate")}}),defineInterfaceishType("DeclareInterface"),defineType("DeclareModule",{builder:["id","body","kind"],visitor:["id","body"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier","StringLiteral"),body:(0,_utils.validateType)("BlockStatement"),kind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("CommonJS","ES"))}}),defineType("DeclareModuleExports",{visitor:["typeAnnotation"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{typeAnnotation:(0,_utils.validateType)("TypeAnnotation")}}),defineType("DeclareTypeAlias",{visitor:["id","typeParameters","right"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),right:(0,_utils.validateType)("FlowType")}}),defineType("DeclareOpaqueType",{visitor:["id","typeParameters","supertype"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),supertype:(0,_utils.validateOptionalType)("FlowType"),impltype:(0,_utils.validateOptionalType)("FlowType")}}),defineType("DeclareVariable",{visitor:["id"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier")}}),defineType("DeclareExportDeclaration",{visitor:["declaration","specifiers","source","attributes"],aliases:["FlowDeclaration","Statement","Declaration"],fields:Object.assign({declaration:(0,_utils.validateOptionalType)("Flow"),specifiers:(0,_utils.validateOptional)((0,_utils.arrayOfType)("ExportSpecifier","ExportNamespaceSpecifier")),source:(0,_utils.validateOptionalType)("StringLiteral"),default:(0,_utils.validateOptional)((0,_utils.assertValueType)("boolean"))},_core.importAttributes)}),defineType("DeclareExportAllDeclaration",{visitor:["source","attributes"],aliases:["FlowDeclaration","Statement","Declaration"],fields:Object.assign({source:(0,_utils.validateType)("StringLiteral"),exportKind:(0,_utils.validateOptional)((0,_utils.assertOneOf)("type","value"))},_core.importAttributes)}),defineType("DeclaredPredicate",{visitor:["value"],aliases:["FlowPredicate"],fields:{value:(0,_utils.validateType)("Flow")}}),defineType("ExistsTypeAnnotation",{aliases:["FlowType"]}),defineType("FunctionTypeAnnotation",{visitor:["typeParameters","params","rest","returnType"],aliases:["FlowType"],fields:{typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),params:(0,_utils.validateArrayOfType)("FunctionTypeParam"),rest:(0,_utils.validateOptionalType)("FunctionTypeParam"),this:(0,_utils.validateOptionalType)("FunctionTypeParam"),returnType:(0,_utils.validateType)("FlowType")}}),defineType("FunctionTypeParam",{visitor:["name","typeAnnotation"],fields:{name:(0,_utils.validateOptionalType)("Identifier"),typeAnnotation:(0,_utils.validateType)("FlowType"),optional:(0,_utils.validateOptional)((0,_utils.assertValueType)("boolean"))}}),defineType("GenericTypeAnnotation",{visitor:["id","typeParameters"],aliases:["FlowType"],fields:{id:(0,_utils.validateType)("Identifier","QualifiedTypeIdentifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterInstantiation")}}),defineType("InferredPredicate",{aliases:["FlowPredicate"]}),defineType("InterfaceExtends",{visitor:["id","typeParameters"],fields:{id:(0,_utils.validateType)("Identifier","QualifiedTypeIdentifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterInstantiation")}}),defineInterfaceishType("InterfaceDeclaration"),defineType("InterfaceTypeAnnotation",{visitor:["extends","body"],aliases:["FlowType"],fields:{extends:(0,_utils.validateOptional)((0,_utils.arrayOfType)("InterfaceExtends")),body:(0,_utils.validateType)("ObjectTypeAnnotation")}}),defineType("IntersectionTypeAnnotation",{visitor:["types"],aliases:["FlowType"],fields:{types:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("MixedTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("EmptyTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("NullableTypeAnnotation",{visitor:["typeAnnotation"],aliases:["FlowType"],fields:{typeAnnotation:(0,_utils.validateType)("FlowType")}}),defineType("NumberLiteralTypeAnnotation",{builder:["value"],aliases:["FlowType"],fields:{value:(0,_utils.validate)((0,_utils.assertValueType)("number"))}}),defineType("NumberTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ObjectTypeAnnotation",{visitor:["properties","indexers","callProperties","internalSlots"],aliases:["FlowType"],builder:["properties","indexers","callProperties","internalSlots","exact"],fields:{properties:(0,_utils.validate)((0,_utils.arrayOfType)("ObjectTypeProperty","ObjectTypeSpreadProperty")),indexers:{validate:(0,_utils.arrayOfType)("ObjectTypeIndexer"),optional:!0,default:[]},callProperties:{validate:(0,_utils.arrayOfType)("ObjectTypeCallProperty"),optional:!0,default:[]},internalSlots:{validate:(0,_utils.arrayOfType)("ObjectTypeInternalSlot"),optional:!0,default:[]},exact:{validate:(0,_utils.assertValueType)("boolean"),default:!1},inexact:(0,_utils.validateOptional)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeInternalSlot",{visitor:["id","value"],builder:["id","value","optional","static","method"],aliases:["UserWhitespacable"],fields:{id:(0,_utils.validateType)("Identifier"),value:(0,_utils.validateType)("FlowType"),optional:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),method:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeCallProperty",{visitor:["value"],aliases:["UserWhitespacable"],fields:{value:(0,_utils.validateType)("FlowType"),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeIndexer",{visitor:["variance","id","key","value"],builder:["id","key","value","variance"],aliases:["UserWhitespacable"],fields:{id:(0,_utils.validateOptionalType)("Identifier"),key:(0,_utils.validateType)("FlowType"),value:(0,_utils.validateType)("FlowType"),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),variance:(0,_utils.validateOptionalType)("Variance")}}),defineType("ObjectTypeProperty",{visitor:["key","value","variance"],aliases:["UserWhitespacable"],fields:{key:(0,_utils.validateType)("Identifier","StringLiteral"),value:(0,_utils.validateType)("FlowType"),kind:(0,_utils.validate)((0,_utils.assertOneOf)("init","get","set")),static:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),proto:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),optional:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),variance:(0,_utils.validateOptionalType)("Variance"),method:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("ObjectTypeSpreadProperty",{visitor:["argument"],aliases:["UserWhitespacable"],fields:{argument:(0,_utils.validateType)("FlowType")}}),defineType("OpaqueType",{visitor:["id","typeParameters","supertype","impltype"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),supertype:(0,_utils.validateOptionalType)("FlowType"),impltype:(0,_utils.validateType)("FlowType")}}),defineType("QualifiedTypeIdentifier",{visitor:["qualification","id"],builder:["id","qualification"],fields:{id:(0,_utils.validateType)("Identifier"),qualification:(0,_utils.validateType)("Identifier","QualifiedTypeIdentifier")}}),defineType("StringLiteralTypeAnnotation",{builder:["value"],aliases:["FlowType"],fields:{value:(0,_utils.validate)((0,_utils.assertValueType)("string"))}}),defineType("StringTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("SymbolTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("ThisTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("TupleTypeAnnotation",{visitor:["types"],aliases:["FlowType"],fields:{types:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("TypeofTypeAnnotation",{visitor:["argument"],aliases:["FlowType"],fields:{argument:(0,_utils.validateType)("FlowType")}}),defineType("TypeAlias",{visitor:["id","typeParameters","right"],aliases:["FlowDeclaration","Statement","Declaration"],fields:{id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TypeParameterDeclaration"),right:(0,_utils.validateType)("FlowType")}}),defineType("TypeAnnotation",{visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("FlowType")}}),defineType("TypeCastExpression",{visitor:["expression","typeAnnotation"],aliases:["ExpressionWrapper","Expression"],fields:{expression:(0,_utils.validateType)("Expression"),typeAnnotation:(0,_utils.validateType)("TypeAnnotation")}}),defineType("TypeParameter",{visitor:["bound","default","variance"],fields:{name:(0,_utils.validate)((0,_utils.assertValueType)("string")),bound:(0,_utils.validateOptionalType)("TypeAnnotation"),default:(0,_utils.validateOptionalType)("FlowType"),variance:(0,_utils.validateOptionalType)("Variance")}}),defineType("TypeParameterDeclaration",{visitor:["params"],fields:{params:(0,_utils.validate)((0,_utils.arrayOfType)("TypeParameter"))}}),defineType("TypeParameterInstantiation",{visitor:["params"],fields:{params:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("UnionTypeAnnotation",{visitor:["types"],aliases:["FlowType"],fields:{types:(0,_utils.validate)((0,_utils.arrayOfType)("FlowType"))}}),defineType("Variance",{builder:["kind"],fields:{kind:(0,_utils.validate)((0,_utils.assertOneOf)("minus","plus"))}}),defineType("VoidTypeAnnotation",{aliases:["FlowType","FlowBaseAnnotation"]}),defineType("EnumDeclaration",{aliases:["Statement","Declaration"],visitor:["id","body"],fields:{id:(0,_utils.validateType)("Identifier"),body:(0,_utils.validateType)("EnumBooleanBody","EnumNumberBody","EnumStringBody","EnumSymbolBody")}}),defineType("EnumBooleanBody",{aliases:["EnumBody"],visitor:["members"],fields:{explicitType:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),members:(0,_utils.validateArrayOfType)("EnumBooleanMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumNumberBody",{aliases:["EnumBody"],visitor:["members"],fields:{explicitType:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),members:(0,_utils.validateArrayOfType)("EnumNumberMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumStringBody",{aliases:["EnumBody"],visitor:["members"],fields:{explicitType:(0,_utils.validate)((0,_utils.assertValueType)("boolean")),members:(0,_utils.validateArrayOfType)("EnumStringMember","EnumDefaultedMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumSymbolBody",{aliases:["EnumBody"],visitor:["members"],fields:{members:(0,_utils.validateArrayOfType)("EnumDefaultedMember"),hasUnknownMembers:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}}),defineType("EnumBooleanMember",{aliases:["EnumMember"],visitor:["id"],fields:{id:(0,_utils.validateType)("Identifier"),init:(0,_utils.validateType)("BooleanLiteral")}}),defineType("EnumNumberMember",{aliases:["EnumMember"],visitor:["id","init"],fields:{id:(0,_utils.validateType)("Identifier"),init:(0,_utils.validateType)("NumericLiteral")}}),defineType("EnumStringMember",{aliases:["EnumMember"],visitor:["id","init"],fields:{id:(0,_utils.validateType)("Identifier"),init:(0,_utils.validateType)("StringLiteral")}}),defineType("EnumDefaultedMember",{aliases:["EnumMember"],visitor:["id"],fields:{id:(0,_utils.validateType)("Identifier")}}),defineType("IndexedAccessType",{visitor:["objectType","indexType"],aliases:["FlowType"],fields:{objectType:(0,_utils.validateType)("FlowType"),indexType:(0,_utils.validateType)("FlowType")}}),defineType("OptionalIndexedAccessType",{visitor:["objectType","indexType"],aliases:["FlowType"],fields:{objectType:(0,_utils.validateType)("FlowType"),indexType:(0,_utils.validateType)("FlowType"),optional:(0,_utils.validate)((0,_utils.assertValueType)("boolean"))}})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ALIAS_KEYS",{enumerable:!0,get:function(){return _utils.ALIAS_KEYS}}),Object.defineProperty(exports,"BUILDER_KEYS",{enumerable:!0,get:function(){return _utils.BUILDER_KEYS}}),Object.defineProperty(exports,"DEPRECATED_ALIASES",{enumerable:!0,get:function(){return _deprecatedAliases.DEPRECATED_ALIASES}}),Object.defineProperty(exports,"DEPRECATED_KEYS",{enumerable:!0,get:function(){return _utils.DEPRECATED_KEYS}}),Object.defineProperty(exports,"FLIPPED_ALIAS_KEYS",{enumerable:!0,get:function(){return _utils.FLIPPED_ALIAS_KEYS}}),Object.defineProperty(exports,"NODE_FIELDS",{enumerable:!0,get:function(){return _utils.NODE_FIELDS}}),Object.defineProperty(exports,"NODE_PARENT_VALIDATIONS",{enumerable:!0,get:function(){return _utils.NODE_PARENT_VALIDATIONS}}),Object.defineProperty(exports,"PLACEHOLDERS",{enumerable:!0,get:function(){return _placeholders.PLACEHOLDERS}}),Object.defineProperty(exports,"PLACEHOLDERS_ALIAS",{enumerable:!0,get:function(){return _placeholders.PLACEHOLDERS_ALIAS}}),Object.defineProperty(exports,"PLACEHOLDERS_FLIPPED_ALIAS",{enumerable:!0,get:function(){return _placeholders.PLACEHOLDERS_FLIPPED_ALIAS}}),exports.TYPES=void 0,Object.defineProperty(exports,"VISITOR_KEYS",{enumerable:!0,get:function(){return _utils.VISITOR_KEYS}}),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/flow.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/jsx.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/misc.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/experimental.js"),__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/typescript.js");var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js"),_placeholders=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/placeholders.js"),_deprecatedAliases=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/deprecated-aliases.js");Object.keys(_deprecatedAliases.DEPRECATED_ALIASES).forEach((deprecatedAlias=>{_utils.FLIPPED_ALIAS_KEYS[deprecatedAlias]=_utils.FLIPPED_ALIAS_KEYS[_deprecatedAliases.DEPRECATED_ALIASES[deprecatedAlias]]}));exports.TYPES=[].concat(Object.keys(_utils.VISITOR_KEYS),Object.keys(_utils.FLIPPED_ALIAS_KEYS),Object.keys(_utils.DEPRECATED_KEYS))},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/jsx.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const defineType=(0,_utils.defineAliasedType)("JSX");defineType("JSXAttribute",{visitor:["name","value"],aliases:["Immutable"],fields:{name:{validate:(0,_utils.assertNodeType)("JSXIdentifier","JSXNamespacedName")},value:{optional:!0,validate:(0,_utils.assertNodeType)("JSXElement","JSXFragment","StringLiteral","JSXExpressionContainer")}}}),defineType("JSXClosingElement",{visitor:["name"],aliases:["Immutable"],fields:{name:{validate:(0,_utils.assertNodeType)("JSXIdentifier","JSXMemberExpression","JSXNamespacedName")}}}),defineType("JSXElement",{builder:["openingElement","closingElement","children","selfClosing"],visitor:["openingElement","children","closingElement"],aliases:["Immutable","Expression"],fields:Object.assign({openingElement:{validate:(0,_utils.assertNodeType)("JSXOpeningElement")},closingElement:{optional:!0,validate:(0,_utils.assertNodeType)("JSXClosingElement")},children:(0,_utils.validateArrayOfType)("JSXText","JSXExpressionContainer","JSXSpreadChild","JSXElement","JSXFragment")},{selfClosing:{validate:(0,_utils.assertValueType)("boolean"),optional:!0}})}),defineType("JSXEmptyExpression",{}),defineType("JSXExpressionContainer",{visitor:["expression"],aliases:["Immutable"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression","JSXEmptyExpression")}}}),defineType("JSXSpreadChild",{visitor:["expression"],aliases:["Immutable"],fields:{expression:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("JSXIdentifier",{builder:["name"],fields:{name:{validate:(0,_utils.assertValueType)("string")}}}),defineType("JSXMemberExpression",{visitor:["object","property"],fields:{object:{validate:(0,_utils.assertNodeType)("JSXMemberExpression","JSXIdentifier")},property:{validate:(0,_utils.assertNodeType)("JSXIdentifier")}}}),defineType("JSXNamespacedName",{visitor:["namespace","name"],fields:{namespace:{validate:(0,_utils.assertNodeType)("JSXIdentifier")},name:{validate:(0,_utils.assertNodeType)("JSXIdentifier")}}}),defineType("JSXOpeningElement",{builder:["name","attributes","selfClosing"],visitor:["name","attributes"],aliases:["Immutable"],fields:{name:{validate:(0,_utils.assertNodeType)("JSXIdentifier","JSXMemberExpression","JSXNamespacedName")},selfClosing:{default:!1},attributes:(0,_utils.validateArrayOfType)("JSXAttribute","JSXSpreadAttribute"),typeParameters:{validate:(0,_utils.assertNodeType)("TypeParameterInstantiation","TSTypeParameterInstantiation"),optional:!0}}}),defineType("JSXSpreadAttribute",{visitor:["argument"],fields:{argument:{validate:(0,_utils.assertNodeType)("Expression")}}}),defineType("JSXText",{aliases:["Immutable"],builder:["value"],fields:{value:{validate:(0,_utils.assertValueType)("string")}}}),defineType("JSXFragment",{builder:["openingFragment","closingFragment","children"],visitor:["openingFragment","children","closingFragment"],aliases:["Immutable","Expression"],fields:{openingFragment:{validate:(0,_utils.assertNodeType)("JSXOpeningFragment")},closingFragment:{validate:(0,_utils.assertNodeType)("JSXClosingFragment")},children:(0,_utils.validateArrayOfType)("JSXText","JSXExpressionContainer","JSXSpreadChild","JSXElement","JSXFragment")}}),defineType("JSXOpeningFragment",{aliases:["Immutable"]}),defineType("JSXClosingFragment",{aliases:["Immutable"]})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/misc.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js"),_placeholders=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/placeholders.js"),_core=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js");const defineType=(0,_utils.defineAliasedType)("Miscellaneous");defineType("Noop",{visitor:[]}),defineType("Placeholder",{visitor:[],builder:["expectedNode","name"],fields:Object.assign({name:{validate:(0,_utils.assertNodeType)("Identifier")},expectedNode:{validate:(0,_utils.assertOneOf)(..._placeholders.PLACEHOLDERS)}},(0,_core.patternLikeCommon)())}),defineType("V8IntrinsicIdentifier",{builder:["name"],fields:{name:{validate:(0,_utils.assertValueType)("string")}}})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/placeholders.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PLACEHOLDERS_FLIPPED_ALIAS=exports.PLACEHOLDERS_ALIAS=exports.PLACEHOLDERS=void 0;var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js");const PLACEHOLDERS=exports.PLACEHOLDERS=["Identifier","StringLiteral","Expression","Statement","Declaration","BlockStatement","ClassBody","Pattern"],PLACEHOLDERS_ALIAS=exports.PLACEHOLDERS_ALIAS={Declaration:["Statement"],Pattern:["PatternLike","LVal"]};for(const type of PLACEHOLDERS){const alias=_utils.ALIAS_KEYS[type];null!=alias&&alias.length&&(PLACEHOLDERS_ALIAS[type]=alias)}const PLACEHOLDERS_FLIPPED_ALIAS=exports.PLACEHOLDERS_FLIPPED_ALIAS={};Object.keys(PLACEHOLDERS_ALIAS).forEach((type=>{PLACEHOLDERS_ALIAS[type].forEach((alias=>{hasOwnProperty.call(PLACEHOLDERS_FLIPPED_ALIAS,alias)||(PLACEHOLDERS_FLIPPED_ALIAS[alias]=[]),PLACEHOLDERS_FLIPPED_ALIAS[alias].push(type)}))}))},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/typescript.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var _utils=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js"),_core=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/core.js"),_is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js");const defineType=(0,_utils.defineAliasedType)("TypeScript"),bool=(0,_utils.assertValueType)("boolean"),tSFunctionTypeAnnotationCommon=()=>({returnType:{validate:(0,_utils.assertNodeType)("TSTypeAnnotation","Noop"),optional:!0},typeParameters:{validate:(0,_utils.assertNodeType)("TSTypeParameterDeclaration","Noop"),optional:!0}});defineType("TSParameterProperty",{aliases:["LVal"],visitor:["parameter"],fields:{accessibility:{validate:(0,_utils.assertOneOf)("public","private","protected"),optional:!0},readonly:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},parameter:{validate:(0,_utils.assertNodeType)("Identifier","AssignmentPattern")},override:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},decorators:{validate:(0,_utils.arrayOfType)("Decorator"),optional:!0}}}),defineType("TSDeclareFunction",{aliases:["Statement","Declaration"],visitor:["id","typeParameters","params","returnType"],fields:Object.assign({},(0,_core.functionDeclarationCommon)(),tSFunctionTypeAnnotationCommon())}),defineType("TSDeclareMethod",{visitor:["decorators","key","typeParameters","params","returnType"],fields:Object.assign({},(0,_core.classMethodOrDeclareMethodCommon)(),tSFunctionTypeAnnotationCommon())}),defineType("TSQualifiedName",{aliases:["TSEntityName"],visitor:["left","right"],fields:{left:(0,_utils.validateType)("TSEntityName"),right:(0,_utils.validateType)("Identifier")}});const signatureDeclarationCommon=()=>({typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterDeclaration"),parameters:(0,_utils.validateArrayOfType)("ArrayPattern","Identifier","ObjectPattern","RestElement"),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation")}),callConstructSignatureDeclaration={aliases:["TSTypeElement"],visitor:["typeParameters","parameters","typeAnnotation"],fields:signatureDeclarationCommon()};defineType("TSCallSignatureDeclaration",callConstructSignatureDeclaration),defineType("TSConstructSignatureDeclaration",callConstructSignatureDeclaration);const namedTypeElementCommon=()=>({key:(0,_utils.validateType)("Expression"),computed:{default:!1},optional:(0,_utils.validateOptional)(bool)});defineType("TSPropertySignature",{aliases:["TSTypeElement"],visitor:["key","typeAnnotation"],fields:Object.assign({},namedTypeElementCommon(),{readonly:(0,_utils.validateOptional)(bool),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation"),kind:{validate:(0,_utils.assertOneOf)("get","set")}})}),defineType("TSMethodSignature",{aliases:["TSTypeElement"],visitor:["key","typeParameters","parameters","typeAnnotation"],fields:Object.assign({},signatureDeclarationCommon(),namedTypeElementCommon(),{kind:{validate:(0,_utils.assertOneOf)("method","get","set")}})}),defineType("TSIndexSignature",{aliases:["TSTypeElement"],visitor:["parameters","typeAnnotation"],fields:{readonly:(0,_utils.validateOptional)(bool),static:(0,_utils.validateOptional)(bool),parameters:(0,_utils.validateArrayOfType)("Identifier"),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation")}});const tsKeywordTypes=["TSAnyKeyword","TSBooleanKeyword","TSBigIntKeyword","TSIntrinsicKeyword","TSNeverKeyword","TSNullKeyword","TSNumberKeyword","TSObjectKeyword","TSStringKeyword","TSSymbolKeyword","TSUndefinedKeyword","TSUnknownKeyword","TSVoidKeyword"];for(const type of tsKeywordTypes)defineType(type,{aliases:["TSType","TSBaseType"],visitor:[],fields:{}});defineType("TSThisType",{aliases:["TSType","TSBaseType"],visitor:[],fields:{}});const fnOrCtrBase={aliases:["TSType"],visitor:["typeParameters","parameters","typeAnnotation"]};defineType("TSFunctionType",Object.assign({},fnOrCtrBase,{fields:signatureDeclarationCommon()})),defineType("TSConstructorType",Object.assign({},fnOrCtrBase,{fields:Object.assign({},signatureDeclarationCommon(),{abstract:(0,_utils.validateOptional)(bool)})})),defineType("TSTypeReference",{aliases:["TSType"],visitor:["typeName","typeParameters"],fields:{typeName:(0,_utils.validateType)("TSEntityName"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}}),defineType("TSTypePredicate",{aliases:["TSType"],visitor:["parameterName","typeAnnotation"],builder:["parameterName","typeAnnotation","asserts"],fields:{parameterName:(0,_utils.validateType)("Identifier","TSThisType"),typeAnnotation:(0,_utils.validateOptionalType)("TSTypeAnnotation"),asserts:(0,_utils.validateOptional)(bool)}}),defineType("TSTypeQuery",{aliases:["TSType"],visitor:["exprName","typeParameters"],fields:{exprName:(0,_utils.validateType)("TSEntityName","TSImportType"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}}),defineType("TSTypeLiteral",{aliases:["TSType"],visitor:["members"],fields:{members:(0,_utils.validateArrayOfType)("TSTypeElement")}}),defineType("TSArrayType",{aliases:["TSType"],visitor:["elementType"],fields:{elementType:(0,_utils.validateType)("TSType")}}),defineType("TSTupleType",{aliases:["TSType"],visitor:["elementTypes"],fields:{elementTypes:(0,_utils.validateArrayOfType)("TSType","TSNamedTupleMember")}}),defineType("TSOptionalType",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSRestType",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSNamedTupleMember",{visitor:["label","elementType"],builder:["label","elementType","optional"],fields:{label:(0,_utils.validateType)("Identifier"),optional:{validate:bool,default:!1},elementType:(0,_utils.validateType)("TSType")}});const unionOrIntersection={aliases:["TSType"],visitor:["types"],fields:{types:(0,_utils.validateArrayOfType)("TSType")}};defineType("TSUnionType",unionOrIntersection),defineType("TSIntersectionType",unionOrIntersection),defineType("TSConditionalType",{aliases:["TSType"],visitor:["checkType","extendsType","trueType","falseType"],fields:{checkType:(0,_utils.validateType)("TSType"),extendsType:(0,_utils.validateType)("TSType"),trueType:(0,_utils.validateType)("TSType"),falseType:(0,_utils.validateType)("TSType")}}),defineType("TSInferType",{aliases:["TSType"],visitor:["typeParameter"],fields:{typeParameter:(0,_utils.validateType)("TSTypeParameter")}}),defineType("TSParenthesizedType",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSTypeOperator",{aliases:["TSType"],visitor:["typeAnnotation"],fields:{operator:(0,_utils.validate)((0,_utils.assertValueType)("string")),typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSIndexedAccessType",{aliases:["TSType"],visitor:["objectType","indexType"],fields:{objectType:(0,_utils.validateType)("TSType"),indexType:(0,_utils.validateType)("TSType")}}),defineType("TSMappedType",{aliases:["TSType"],visitor:["typeParameter","nameType","typeAnnotation"],builder:["typeParameter","typeAnnotation","nameType"],fields:Object.assign({},{typeParameter:(0,_utils.validateType)("TSTypeParameter")},{readonly:(0,_utils.validateOptional)((0,_utils.assertOneOf)(!0,!1,"+","-")),optional:(0,_utils.validateOptional)((0,_utils.assertOneOf)(!0,!1,"+","-")),typeAnnotation:(0,_utils.validateOptionalType)("TSType"),nameType:(0,_utils.validateOptionalType)("TSType")})}),defineType("TSLiteralType",{aliases:["TSType","TSBaseType"],visitor:["literal"],fields:{literal:{validate:function(){const unaryExpression=(0,_utils.assertNodeType)("NumericLiteral","BigIntLiteral"),unaryOperator=(0,_utils.assertOneOf)("-"),literal=(0,_utils.assertNodeType)("NumericLiteral","StringLiteral","BooleanLiteral","BigIntLiteral","TemplateLiteral");function validator(parent,key,node){(0,_is.default)("UnaryExpression",node)?(unaryOperator(node,"operator",node.operator),unaryExpression(node,"argument",node.argument)):literal(parent,key,node)}return validator.oneOfNodeTypes=["NumericLiteral","StringLiteral","BooleanLiteral","BigIntLiteral","TemplateLiteral","UnaryExpression"],validator}()}}});defineType("TSExpressionWithTypeArguments",{aliases:["TSType"],visitor:["expression","typeParameters"],fields:{expression:(0,_utils.validateType)("TSEntityName"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}}),defineType("TSInterfaceDeclaration",{aliases:["Statement","Declaration"],visitor:["id","typeParameters","extends","body"],fields:{declare:(0,_utils.validateOptional)(bool),id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterDeclaration"),extends:(0,_utils.validateOptional)((0,_utils.arrayOfType)("TSExpressionWithTypeArguments")),body:(0,_utils.validateType)("TSInterfaceBody")}}),defineType("TSInterfaceBody",{visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("TSTypeElement")}}),defineType("TSTypeAliasDeclaration",{aliases:["Statement","Declaration"],visitor:["id","typeParameters","typeAnnotation"],fields:{declare:(0,_utils.validateOptional)(bool),id:(0,_utils.validateType)("Identifier"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterDeclaration"),typeAnnotation:(0,_utils.validateType)("TSType")}}),defineType("TSInstantiationExpression",{aliases:["Expression"],visitor:["expression","typeParameters"],fields:{expression:(0,_utils.validateType)("Expression"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation")}});const TSTypeExpression={aliases:["Expression","LVal","PatternLike"],visitor:["expression","typeAnnotation"],fields:{expression:(0,_utils.validateType)("Expression"),typeAnnotation:(0,_utils.validateType)("TSType")}};defineType("TSAsExpression",TSTypeExpression),defineType("TSSatisfiesExpression",TSTypeExpression),defineType("TSTypeAssertion",{aliases:["Expression","LVal","PatternLike"],visitor:["typeAnnotation","expression"],fields:{typeAnnotation:(0,_utils.validateType)("TSType"),expression:(0,_utils.validateType)("Expression")}}),defineType("TSEnumDeclaration",{aliases:["Statement","Declaration"],visitor:["id","members"],fields:{declare:(0,_utils.validateOptional)(bool),const:(0,_utils.validateOptional)(bool),id:(0,_utils.validateType)("Identifier"),members:(0,_utils.validateArrayOfType)("TSEnumMember"),initializer:(0,_utils.validateOptionalType)("Expression")}}),defineType("TSEnumMember",{visitor:["id","initializer"],fields:{id:(0,_utils.validateType)("Identifier","StringLiteral"),initializer:(0,_utils.validateOptionalType)("Expression")}}),defineType("TSModuleDeclaration",{aliases:["Statement","Declaration"],visitor:["id","body"],fields:Object.assign({kind:{validate:(0,_utils.assertOneOf)("global","module","namespace")},declare:(0,_utils.validateOptional)(bool)},{global:(0,_utils.validateOptional)(bool)},{id:(0,_utils.validateType)("Identifier","StringLiteral"),body:(0,_utils.validateType)("TSModuleBlock","TSModuleDeclaration")})}),defineType("TSModuleBlock",{aliases:["Scopable","Block","BlockParent","FunctionParent"],visitor:["body"],fields:{body:(0,_utils.validateArrayOfType)("Statement")}}),defineType("TSImportType",{aliases:["TSType"],visitor:["argument","qualifier","typeParameters"],fields:{argument:(0,_utils.validateType)("StringLiteral"),qualifier:(0,_utils.validateOptionalType)("TSEntityName"),typeParameters:(0,_utils.validateOptionalType)("TSTypeParameterInstantiation"),options:{validate:(0,_utils.assertNodeType)("Expression"),optional:!0}}}),defineType("TSImportEqualsDeclaration",{aliases:["Statement"],visitor:["id","moduleReference"],fields:{isExport:(0,_utils.validate)(bool),id:(0,_utils.validateType)("Identifier"),moduleReference:(0,_utils.validateType)("TSEntityName","TSExternalModuleReference"),importKind:{validate:(0,_utils.assertOneOf)("type","value"),optional:!0}}}),defineType("TSExternalModuleReference",{visitor:["expression"],fields:{expression:(0,_utils.validateType)("StringLiteral")}}),defineType("TSNonNullExpression",{aliases:["Expression","LVal","PatternLike"],visitor:["expression"],fields:{expression:(0,_utils.validateType)("Expression")}}),defineType("TSExportAssignment",{aliases:["Statement"],visitor:["expression"],fields:{expression:(0,_utils.validateType)("Expression")}}),defineType("TSNamespaceExportDeclaration",{aliases:["Statement"],visitor:["id"],fields:{id:(0,_utils.validateType)("Identifier")}}),defineType("TSTypeAnnotation",{visitor:["typeAnnotation"],fields:{typeAnnotation:{validate:(0,_utils.assertNodeType)("TSType")}}}),defineType("TSTypeParameterInstantiation",{visitor:["params"],fields:{params:(0,_utils.validateArrayOfType)("TSType")}}),defineType("TSTypeParameterDeclaration",{visitor:["params"],fields:{params:(0,_utils.validateArrayOfType)("TSTypeParameter")}}),defineType("TSTypeParameter",{builder:["constraint","default","name"],visitor:["constraint","default"],fields:{name:{validate:(0,_utils.assertValueType)("string")},in:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},out:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},const:{validate:(0,_utils.assertValueType)("boolean"),optional:!0},constraint:{validate:(0,_utils.assertNodeType)("TSType"),optional:!0},default:{validate:(0,_utils.assertNodeType)("TSType"),optional:!0}}})},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/utils.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VISITOR_KEYS=exports.NODE_PARENT_VALIDATIONS=exports.NODE_FIELDS=exports.FLIPPED_ALIAS_KEYS=exports.DEPRECATED_KEYS=exports.BUILDER_KEYS=exports.ALIAS_KEYS=void 0,exports.arrayOf=arrayOf,exports.arrayOfType=arrayOfType,exports.assertEach=assertEach,exports.assertNodeOrValueType=function(...types){function validate(node,key,val){for(const type of types)if(getType(val)===type||(0,_is.default)(type,val))return void(0,_validate.validateChild)(node,key,val);throw new TypeError(`Property ${key} of ${node.type} expected node to be of a type ${JSON.stringify(types)} but instead got ${JSON.stringify(null==val?void 0:val.type)}`)}return validate.oneOfNodeOrValueTypes=types,validate},exports.assertNodeType=assertNodeType,exports.assertOneOf=function(...values){function validate(node,key,val){if(!values.includes(val))throw new TypeError(`Property ${key} expected value to be one of ${JSON.stringify(values)} but got ${JSON.stringify(val)}`)}return validate.oneOf=values,validate},exports.assertOptionalChainStart=function(){return function(node){var _current;let current=node;for(;node;){const{type}=current;if("OptionalCallExpression"!==type){if("OptionalMemberExpression"!==type)break;if(current.optional)return;current=current.object}else{if(current.optional)return;current=current.callee}}throw new TypeError(`Non-optional ${node.type} must chain from an optional OptionalMemberExpression or OptionalCallExpression. Found chain from ${null==(_current=current)?void 0:_current.type}`)}},exports.assertShape=function(shape){function validate(node,key,val){const errors=[];for(const property of Object.keys(shape))try{(0,_validate.validateField)(node,property,val[property],shape[property])}catch(error){if(error instanceof TypeError){errors.push(error.message);continue}throw error}if(errors.length)throw new TypeError(`Property ${key} of ${node.type} expected to have the following:\n${errors.join("\n")}`)}return validate.shapeOf=shape,validate},exports.assertValueType=assertValueType,exports.chain=chain,exports.default=defineType,exports.defineAliasedType=function(...aliases){return(type,opts={})=>{let defined=opts.aliases;var _store$opts$inherits$;defined||(opts.inherits&&(defined=null==(_store$opts$inherits$=store[opts.inherits].aliases)?void 0:_store$opts$inherits$.slice()),null!=defined||(defined=[]),opts.aliases=defined);const additional=aliases.filter((a=>!defined.includes(a)));defined.unshift(...additional),defineType(type,opts)}},exports.validate=validate,exports.validateArrayOfType=function(...typeNames){return validate(arrayOfType(...typeNames))},exports.validateOptional=function(validate){return{validate,optional:!0}},exports.validateOptionalType=function(...typeNames){return{validate:assertNodeType(...typeNames),optional:!0}},exports.validateType=function(...typeNames){return validate(assertNodeType(...typeNames))};var _is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_validate=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js");const VISITOR_KEYS=exports.VISITOR_KEYS={},ALIAS_KEYS=exports.ALIAS_KEYS={},FLIPPED_ALIAS_KEYS=exports.FLIPPED_ALIAS_KEYS={},NODE_FIELDS=exports.NODE_FIELDS={},BUILDER_KEYS=exports.BUILDER_KEYS={},DEPRECATED_KEYS=exports.DEPRECATED_KEYS={},NODE_PARENT_VALIDATIONS=exports.NODE_PARENT_VALIDATIONS={};function getType(val){return Array.isArray(val)?"array":null===val?"null":typeof val}function validate(validate){return{validate}}function arrayOf(elementType){return chain(assertValueType("array"),assertEach(elementType))}function arrayOfType(...typeNames){return arrayOf(assertNodeType(...typeNames))}function assertEach(callback){const childValidator=process.env.BABEL_TYPES_8_BREAKING?_validate.validateChild:()=>{};function validator(node,key,val){if(Array.isArray(val))for(let i=0;i<val.length;i++){const subkey=`${key}[${i}]`,v=val[i];callback(node,subkey,v),childValidator(node,subkey,v)}}return validator.each=callback,validator}function assertNodeType(...types){function validate(node,key,val){for(const type of types)if((0,_is.default)(type,val))return void(0,_validate.validateChild)(node,key,val);throw new TypeError(`Property ${key} of ${node.type} expected node to be of a type ${JSON.stringify(types)} but instead got ${JSON.stringify(null==val?void 0:val.type)}`)}return validate.oneOfNodeTypes=types,validate}function assertValueType(type){function validate(node,key,val){if(!(getType(val)===type))throw new TypeError(`Property ${key} expected type of ${type} but got ${getType(val)}`)}return validate.type=type,validate}function chain(...fns){function validate(...args){for(const fn of fns)fn(...args)}if(validate.chainOf=fns,fns.length>=2&&"type"in fns[0]&&"array"===fns[0].type&&!("each"in fns[1]))throw new Error('An assertValueType("array") validator can only be followed by an assertEach(...) validator.');return validate}const validTypeOpts=new Set(["aliases","builder","deprecatedAlias","fields","inherits","visitor","validate"]),validFieldKeys=new Set(["default","optional","deprecated","validate"]),store={};function defineType(type,opts={}){const inherits=opts.inherits&&store[opts.inherits]||{};let fields=opts.fields;if(!fields&&(fields={},inherits.fields)){const keys=Object.getOwnPropertyNames(inherits.fields);for(const key of keys){const field=inherits.fields[key],def=field.default;if(Array.isArray(def)?def.length>0:def&&"object"==typeof def)throw new Error("field defaults can only be primitives or empty arrays currently");fields[key]={default:Array.isArray(def)?[]:def,optional:field.optional,deprecated:field.deprecated,validate:field.validate}}}const visitor=opts.visitor||inherits.visitor||[],aliases=opts.aliases||inherits.aliases||[],builder=opts.builder||inherits.builder||opts.visitor||[];for(const k of Object.keys(opts))if(!validTypeOpts.has(k))throw new Error(`Unknown type option "${k}" on ${type}`);opts.deprecatedAlias&&(DEPRECATED_KEYS[opts.deprecatedAlias]=type);for(const key of visitor.concat(builder))fields[key]=fields[key]||{};for(const key of Object.keys(fields)){const field=fields[key];void 0===field.default||builder.includes(key)||(field.optional=!0),void 0===field.default?field.default=null:field.validate||null==field.default||(field.validate=assertValueType(getType(field.default)));for(const k of Object.keys(field))if(!validFieldKeys.has(k))throw new Error(`Unknown field key "${k}" on ${type}.${key}`)}VISITOR_KEYS[type]=opts.visitor=visitor,BUILDER_KEYS[type]=opts.builder=builder,NODE_FIELDS[type]=opts.fields=fields,ALIAS_KEYS[type]=opts.aliases=aliases,aliases.forEach((alias=>{FLIPPED_ALIAS_KEYS[alias]=FLIPPED_ALIAS_KEYS[alias]||[],FLIPPED_ALIAS_KEYS[alias].push(type)})),opts.validate&&(NODE_PARENT_VALIDATIONS[type]=opts.validate),store[type]=opts}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _exportNames={react:!0,assertNode:!0,createTypeAnnotationBasedOnTypeof:!0,createUnionTypeAnnotation:!0,createFlowUnionType:!0,createTSUnionType:!0,cloneNode:!0,clone:!0,cloneDeep:!0,cloneDeepWithoutLoc:!0,cloneWithoutLoc:!0,addComment:!0,addComments:!0,inheritInnerComments:!0,inheritLeadingComments:!0,inheritsComments:!0,inheritTrailingComments:!0,removeComments:!0,ensureBlock:!0,toBindingIdentifierName:!0,toBlock:!0,toComputedKey:!0,toExpression:!0,toIdentifier:!0,toKeyAlias:!0,toStatement:!0,valueToNode:!0,appendToMemberExpression:!0,inherits:!0,prependToMemberExpression:!0,removeProperties:!0,removePropertiesDeep:!0,removeTypeDuplicates:!0,getAssignmentIdentifiers:!0,getBindingIdentifiers:!0,getOuterBindingIdentifiers:!0,getFunctionName:!0,traverse:!0,traverseFast:!0,shallowEqual:!0,is:!0,isBinding:!0,isBlockScoped:!0,isImmutable:!0,isLet:!0,isNode:!0,isNodesEquivalent:!0,isPlaceholderType:!0,isReferenced:!0,isScope:!0,isSpecifierDefault:!0,isType:!0,isValidES3Identifier:!0,isValidIdentifier:!0,isVar:!0,matchesPattern:!0,validate:!0,buildMatchMemberExpression:!0,__internal__deprecationWarning:!0};Object.defineProperty(exports,"__internal__deprecationWarning",{enumerable:!0,get:function(){return _deprecationWarning.default}}),Object.defineProperty(exports,"addComment",{enumerable:!0,get:function(){return _addComment.default}}),Object.defineProperty(exports,"addComments",{enumerable:!0,get:function(){return _addComments.default}}),Object.defineProperty(exports,"appendToMemberExpression",{enumerable:!0,get:function(){return _appendToMemberExpression.default}}),Object.defineProperty(exports,"assertNode",{enumerable:!0,get:function(){return _assertNode.default}}),Object.defineProperty(exports,"buildMatchMemberExpression",{enumerable:!0,get:function(){return _buildMatchMemberExpression.default}}),Object.defineProperty(exports,"clone",{enumerable:!0,get:function(){return _clone.default}}),Object.defineProperty(exports,"cloneDeep",{enumerable:!0,get:function(){return _cloneDeep.default}}),Object.defineProperty(exports,"cloneDeepWithoutLoc",{enumerable:!0,get:function(){return _cloneDeepWithoutLoc.default}}),Object.defineProperty(exports,"cloneNode",{enumerable:!0,get:function(){return _cloneNode.default}}),Object.defineProperty(exports,"cloneWithoutLoc",{enumerable:!0,get:function(){return _cloneWithoutLoc.default}}),Object.defineProperty(exports,"createFlowUnionType",{enumerable:!0,get:function(){return _createFlowUnionType.default}}),Object.defineProperty(exports,"createTSUnionType",{enumerable:!0,get:function(){return _createTSUnionType.default}}),Object.defineProperty(exports,"createTypeAnnotationBasedOnTypeof",{enumerable:!0,get:function(){return _createTypeAnnotationBasedOnTypeof.default}}),Object.defineProperty(exports,"createUnionTypeAnnotation",{enumerable:!0,get:function(){return _createFlowUnionType.default}}),Object.defineProperty(exports,"ensureBlock",{enumerable:!0,get:function(){return _ensureBlock.default}}),Object.defineProperty(exports,"getAssignmentIdentifiers",{enumerable:!0,get:function(){return _getAssignmentIdentifiers.default}}),Object.defineProperty(exports,"getBindingIdentifiers",{enumerable:!0,get:function(){return _getBindingIdentifiers.default}}),Object.defineProperty(exports,"getFunctionName",{enumerable:!0,get:function(){return _getFunctionName.default}}),Object.defineProperty(exports,"getOuterBindingIdentifiers",{enumerable:!0,get:function(){return _getOuterBindingIdentifiers.default}}),Object.defineProperty(exports,"inheritInnerComments",{enumerable:!0,get:function(){return _inheritInnerComments.default}}),Object.defineProperty(exports,"inheritLeadingComments",{enumerable:!0,get:function(){return _inheritLeadingComments.default}}),Object.defineProperty(exports,"inheritTrailingComments",{enumerable:!0,get:function(){return _inheritTrailingComments.default}}),Object.defineProperty(exports,"inherits",{enumerable:!0,get:function(){return _inherits.default}}),Object.defineProperty(exports,"inheritsComments",{enumerable:!0,get:function(){return _inheritsComments.default}}),Object.defineProperty(exports,"is",{enumerable:!0,get:function(){return _is.default}}),Object.defineProperty(exports,"isBinding",{enumerable:!0,get:function(){return _isBinding.default}}),Object.defineProperty(exports,"isBlockScoped",{enumerable:!0,get:function(){return _isBlockScoped.default}}),Object.defineProperty(exports,"isImmutable",{enumerable:!0,get:function(){return _isImmutable.default}}),Object.defineProperty(exports,"isLet",{enumerable:!0,get:function(){return _isLet.default}}),Object.defineProperty(exports,"isNode",{enumerable:!0,get:function(){return _isNode.default}}),Object.defineProperty(exports,"isNodesEquivalent",{enumerable:!0,get:function(){return _isNodesEquivalent.default}}),Object.defineProperty(exports,"isPlaceholderType",{enumerable:!0,get:function(){return _isPlaceholderType.default}}),Object.defineProperty(exports,"isReferenced",{enumerable:!0,get:function(){return _isReferenced.default}}),Object.defineProperty(exports,"isScope",{enumerable:!0,get:function(){return _isScope.default}}),Object.defineProperty(exports,"isSpecifierDefault",{enumerable:!0,get:function(){return _isSpecifierDefault.default}}),Object.defineProperty(exports,"isType",{enumerable:!0,get:function(){return _isType.default}}),Object.defineProperty(exports,"isValidES3Identifier",{enumerable:!0,get:function(){return _isValidES3Identifier.default}}),Object.defineProperty(exports,"isValidIdentifier",{enumerable:!0,get:function(){return _isValidIdentifier.default}}),Object.defineProperty(exports,"isVar",{enumerable:!0,get:function(){return _isVar.default}}),Object.defineProperty(exports,"matchesPattern",{enumerable:!0,get:function(){return _matchesPattern.default}}),Object.defineProperty(exports,"prependToMemberExpression",{enumerable:!0,get:function(){return _prependToMemberExpression.default}}),exports.react=void 0,Object.defineProperty(exports,"removeComments",{enumerable:!0,get:function(){return _removeComments.default}}),Object.defineProperty(exports,"removeProperties",{enumerable:!0,get:function(){return _removeProperties.default}}),Object.defineProperty(exports,"removePropertiesDeep",{enumerable:!0,get:function(){return _removePropertiesDeep.default}}),Object.defineProperty(exports,"removeTypeDuplicates",{enumerable:!0,get:function(){return _removeTypeDuplicates.default}}),Object.defineProperty(exports,"shallowEqual",{enumerable:!0,get:function(){return _shallowEqual.default}}),Object.defineProperty(exports,"toBindingIdentifierName",{enumerable:!0,get:function(){return _toBindingIdentifierName.default}}),Object.defineProperty(exports,"toBlock",{enumerable:!0,get:function(){return _toBlock.default}}),Object.defineProperty(exports,"toComputedKey",{enumerable:!0,get:function(){return _toComputedKey.default}}),Object.defineProperty(exports,"toExpression",{enumerable:!0,get:function(){return _toExpression.default}}),Object.defineProperty(exports,"toIdentifier",{enumerable:!0,get:function(){return _toIdentifier.default}}),Object.defineProperty(exports,"toKeyAlias",{enumerable:!0,get:function(){return _toKeyAlias.default}}),Object.defineProperty(exports,"toStatement",{enumerable:!0,get:function(){return _toStatement.default}}),Object.defineProperty(exports,"traverse",{enumerable:!0,get:function(){return _traverse.default}}),Object.defineProperty(exports,"traverseFast",{enumerable:!0,get:function(){return _traverseFast.default}}),Object.defineProperty(exports,"validate",{enumerable:!0,get:function(){return _validate.default}}),Object.defineProperty(exports,"valueToNode",{enumerable:!0,get:function(){return _valueToNode.default}});var _isReactComponent=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isReactComponent.js"),_isCompatTag=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isCompatTag.js"),_buildChildren=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/react/buildChildren.js"),_assertNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/assertNode.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/asserts/generated/index.js");Object.keys(_index).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index[key]}}))}));var _createTypeAnnotationBasedOnTypeof=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createTypeAnnotationBasedOnTypeof.js"),_createFlowUnionType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/flow/createFlowUnionType.js"),_createTSUnionType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/typescript/createTSUnionType.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js");Object.keys(_index2).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index2[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index2[key]}}))}));var _uppercase=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/uppercase.js");Object.keys(_uppercase).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_uppercase[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _uppercase[key]}}))}));var _productions=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/productions.js");Object.keys(_productions).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_productions[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _productions[key]}}))}));var _cloneNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneNode.js"),_clone=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/clone.js"),_cloneDeep=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeep.js"),_cloneDeepWithoutLoc=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneDeepWithoutLoc.js"),_cloneWithoutLoc=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/clone/cloneWithoutLoc.js"),_addComment=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComment.js"),_addComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/addComments.js"),_inheritInnerComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritInnerComments.js"),_inheritLeadingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritLeadingComments.js"),_inheritsComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritsComments.js"),_inheritTrailingComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritTrailingComments.js"),_removeComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/removeComments.js"),_index3=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/generated/index.js");Object.keys(_index3).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index3[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index3[key]}}))}));var _index4=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js");Object.keys(_index4).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index4[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index4[key]}}))}));var _ensureBlock=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/ensureBlock.js"),_toBindingIdentifierName=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBindingIdentifierName.js"),_toBlock=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toBlock.js"),_toComputedKey=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toComputedKey.js"),_toExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toExpression.js"),_toIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toIdentifier.js"),_toKeyAlias=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toKeyAlias.js"),_toStatement=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toStatement.js"),_valueToNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/valueToNode.js"),_index5=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");Object.keys(_index5).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index5[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index5[key]}}))}));var _appendToMemberExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/appendToMemberExpression.js"),_inherits=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/inherits.js"),_prependToMemberExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/prependToMemberExpression.js"),_removeProperties=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removeProperties.js"),_removePropertiesDeep=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removePropertiesDeep.js"),_removeTypeDuplicates=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/flow/removeTypeDuplicates.js"),_getAssignmentIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getAssignmentIdentifiers.js"),_getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js"),_getOuterBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getOuterBindingIdentifiers.js"),_getFunctionName=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getFunctionName.js"),_traverse=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverse.js");Object.keys(_traverse).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_traverse[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _traverse[key]}}))}));var _traverseFast=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverseFast.js"),_shallowEqual=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js"),_is=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js"),_isBinding=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBinding.js"),_isBlockScoped=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBlockScoped.js"),_isImmutable=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isImmutable.js"),_isLet=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isLet.js"),_isNode=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNode.js"),_isNodesEquivalent=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNodesEquivalent.js"),_isPlaceholderType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isPlaceholderType.js"),_isReferenced=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isReferenced.js"),_isScope=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isScope.js"),_isSpecifierDefault=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isSpecifierDefault.js"),_isType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js"),_isValidES3Identifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidES3Identifier.js"),_isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js"),_isVar=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isVar.js"),_matchesPattern=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/matchesPattern.js"),_validate=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js"),_buildMatchMemberExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/buildMatchMemberExpression.js"),_index6=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");Object.keys(_index6).forEach((function(key){"default"!==key&&"__esModule"!==key&&(Object.prototype.hasOwnProperty.call(_exportNames,key)||key in exports&&exports[key]===_index6[key]||Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _index6[key]}}))}));var _deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js");exports.react={isReactComponent:_isReactComponent.default,isCompatTag:_isCompatTag.default,buildChildren:_buildChildren.default};exports.toSequenceExpression=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/converters/toSequenceExpression.js").default,process.env.BABEL_TYPES_8_BREAKING&&console.warn("BABEL_TYPES_8_BREAKING is not supported anymore. Use the latest Babel 8.0.0 pre-release instead!")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/appendToMemberExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(member,append,computed=!1){return member.object=(0,_index.memberExpression)(member.object,member.property,member.computed),member.property=append,member.computed=!!computed,member};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/flow/removeTypeDuplicates.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function removeTypeDuplicates(nodesIn){const nodes=Array.from(nodesIn),generics=new Map,bases=new Map,typeGroups=new Set,types=[];for(let i=0;i<nodes.length;i++){const node=nodes[i];if(node&&!types.includes(node)){if((0,_index.isAnyTypeAnnotation)(node))return[node];if((0,_index.isFlowBaseAnnotation)(node))bases.set(node.type,node);else if((0,_index.isUnionTypeAnnotation)(node))typeGroups.has(node.types)||(nodes.push(...node.types),typeGroups.add(node.types));else if((0,_index.isGenericTypeAnnotation)(node)){const name=getQualifiedName(node.id);if(generics.has(name)){let existing=generics.get(name);existing.typeParameters?node.typeParameters&&(existing.typeParameters.params.push(...node.typeParameters.params),existing.typeParameters.params=removeTypeDuplicates(existing.typeParameters.params)):existing=node.typeParameters}else generics.set(name,node)}else types.push(node)}}for(const[,baseType]of bases)types.push(baseType);for(const[,genericName]of generics)types.push(genericName);return types};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getQualifiedName(node){return(0,_index.isIdentifier)(node)?node.name:`${node.id.name}.${getQualifiedName(node.qualification)}`}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/inherits.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,parent){if(!child||!parent)return child;for(const key of _index.INHERIT_KEYS.optional)null==child[key]&&(child[key]=parent[key]);for(const key of Object.keys(parent))"_"===key[0]&&"__clone"!==key&&(child[key]=parent[key]);for(const key of _index.INHERIT_KEYS.force)child[key]=parent[key];return(0,_inheritsComments.default)(child,parent),child};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js"),_inheritsComments=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/comments/inheritsComments.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/prependToMemberExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(member,prepend){if((0,_index2.isSuper)(member.object))throw new Error("Cannot prepend node to super property access (`super.foo`).");return member.object=(0,_index.memberExpression)(prepend,member.object),member};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removeProperties.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,opts={}){const map=opts.preserveComments?CLEAR_KEYS:CLEAR_KEYS_PLUS_COMMENTS;for(const key of map)null!=node[key]&&(node[key]=void 0);for(const key of Object.keys(node))"_"===key[0]&&null!=node[key]&&(node[key]=void 0);const symbols=Object.getOwnPropertySymbols(node);for(const sym of symbols)node[sym]=null};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js");const CLEAR_KEYS=["tokens","start","end","loc","raw","rawValue"],CLEAR_KEYS_PLUS_COMMENTS=[..._index.COMMENT_KEYS,"comments",...CLEAR_KEYS]},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removePropertiesDeep.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(tree,opts){return(0,_traverseFast.default)(tree,_removeProperties.default,opts),tree};var _traverseFast=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverseFast.js"),_removeProperties=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/removeProperties.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/modifications/typescript/removeTypeDuplicates.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function removeTypeDuplicates(nodesIn){const nodes=Array.from(nodesIn),generics=new Map,bases=new Map,typeGroups=new Set,types=[];for(let i=0;i<nodes.length;i++){const node=nodes[i];if(node&&!types.includes(node)){if((0,_index.isTSAnyKeyword)(node))return[node];if((0,_index.isTSBaseType)(node))bases.set(node.type,node);else if((0,_index.isTSUnionType)(node))typeGroups.has(node.types)||(nodes.push(...node.types),typeGroups.add(node.types));else if((0,_index.isTSTypeReference)(node)&&node.typeParameters){const name=getQualifiedName(node.typeName);if(generics.has(name)){let existing=generics.get(name);existing.typeParameters?node.typeParameters&&(existing.typeParameters.params.push(...node.typeParameters.params),existing.typeParameters.params=removeTypeDuplicates(existing.typeParameters.params)):existing=node.typeParameters}else generics.set(name,node)}else types.push(node)}}for(const[,baseType]of bases)types.push(baseType);for(const[,genericName]of generics)types.push(genericName);return types};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getQualifiedName(node){return(0,_index.isIdentifier)(node)?node.name:`${node.right.name}.${getQualifiedName(node.left)}`}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getAssignmentIdentifiers.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){const search=[].concat(node),ids=Object.create(null);for(;search.length;){const id=search.pop();if(id)switch(id.type){case"ArrayPattern":search.push(...id.elements);break;case"AssignmentExpression":case"AssignmentPattern":case"ForInStatement":case"ForOfStatement":search.push(id.left);break;case"ObjectPattern":search.push(...id.properties);break;case"ObjectProperty":search.push(id.value);break;case"RestElement":case"UpdateExpression":search.push(id.argument);break;case"UnaryExpression":"delete"===id.operator&&search.push(id.argument);break;case"Identifier":ids[id.name]=id}}return ids}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=getBindingIdentifiers;var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getBindingIdentifiers(node,duplicates,outerOnly,newBindingsOnly){const search=[].concat(node),ids=Object.create(null);for(;search.length;){const id=search.shift();if(!id)continue;if(newBindingsOnly&&((0,_index.isAssignmentExpression)(id)||(0,_index.isUnaryExpression)(id)||(0,_index.isUpdateExpression)(id)))continue;if((0,_index.isIdentifier)(id)){if(duplicates){(ids[id.name]=ids[id.name]||[]).push(id)}else ids[id.name]=id;continue}if((0,_index.isExportDeclaration)(id)&&!(0,_index.isExportAllDeclaration)(id)){(0,_index.isDeclaration)(id.declaration)&&search.push(id.declaration);continue}if(outerOnly){if((0,_index.isFunctionDeclaration)(id)){search.push(id.id);continue}if((0,_index.isFunctionExpression)(id))continue}const keys=getBindingIdentifiers.keys[id.type];if(keys)for(let i=0;i<keys.length;i++){const nodes=id[keys[i]];nodes&&(Array.isArray(nodes)?search.push(...nodes):search.push(nodes))}}return ids}getBindingIdentifiers.keys={DeclareClass:["id"],DeclareFunction:["id"],DeclareModule:["id"],DeclareVariable:["id"],DeclareInterface:["id"],DeclareTypeAlias:["id"],DeclareOpaqueType:["id"],InterfaceDeclaration:["id"],TypeAlias:["id"],OpaqueType:["id"],CatchClause:["param"],LabeledStatement:["label"],UnaryExpression:["argument"],AssignmentExpression:["left"],ImportSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportDefaultSpecifier:["local"],ImportDeclaration:["specifiers"],ExportSpecifier:["exported"],ExportNamespaceSpecifier:["exported"],ExportDefaultSpecifier:["exported"],FunctionDeclaration:["id","params"],FunctionExpression:["id","params"],ArrowFunctionExpression:["params"],ObjectMethod:["params"],ClassMethod:["params"],ClassPrivateMethod:["params"],ForInStatement:["left"],ForOfStatement:["left"],ClassDeclaration:["id"],ClassExpression:["id"],RestElement:["argument"],UpdateExpression:["argument"],ObjectProperty:["value"],AssignmentPattern:["left"],ArrayPattern:["elements"],ObjectPattern:["properties"],VariableDeclaration:["declarations"],VariableDeclarator:["id"]}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getFunctionName.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent){if("id"in node&&node.id)return{name:node.id.name,originalNode:node.id};let id,prefix="";(0,_index.isObjectProperty)(parent,{value:node})?id=getObjectMemberKey(parent):(0,_index.isObjectMethod)(node)||(0,_index.isClassMethod)(node)?(id=getObjectMemberKey(node),"get"===node.kind?prefix="get ":"set"===node.kind&&(prefix="set ")):(0,_index.isVariableDeclarator)(parent,{init:node})?id=parent.id:(0,_index.isAssignmentExpression)(parent,{operator:"=",right:node})&&(id=parent.left);if(!id)return null;const name=(0,_index.isLiteral)(id)?function(id){if((0,_index.isNullLiteral)(id))return"null";if((0,_index.isRegExpLiteral)(id))return`/${id.pattern}/${id.flags}`;if((0,_index.isTemplateLiteral)(id))return id.quasis.map((quasi=>quasi.value.raw)).join("");if(void 0!==id.value)return String(id.value);return null}(id):(0,_index.isIdentifier)(id)?id.name:(0,_index.isPrivateName)(id)?id.id.name:null;return null==name?null:{name:prefix+name,originalNode:id}};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js");function getObjectMemberKey(node){if(!node.computed||(0,_index.isLiteral)(node.key))return node.key}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getOuterBindingIdentifiers.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js");exports.default=function(node,duplicates){return(0,_getBindingIdentifiers.default)(node,duplicates,!0)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverse.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,handlers,state){"function"==typeof handlers&&(handlers={enter:handlers});const{enter,exit}=handlers;traverseSimpleImpl(node,enter,exit,state,[])};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");function traverseSimpleImpl(node,enter,exit,state,ancestors){const keys=_index.VISITOR_KEYS[node.type];if(keys){enter&&enter(node,ancestors,state);for(const key of keys){const subNode=node[key];if(Array.isArray(subNode))for(let i=0;i<subNode.length;i++){const child=subNode[i];child&&(ancestors.push({node,key,index:i}),traverseSimpleImpl(child,enter,exit,state,ancestors),ancestors.pop())}else subNode&&(ancestors.push({node,key}),traverseSimpleImpl(subNode,enter,exit,state,ancestors),ancestors.pop())}exit&&exit(node,ancestors,state)}}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/traverse/traverseFast.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function traverseFast(node,enter,opts){if(!node)return;const keys=_index.VISITOR_KEYS[node.type];if(!keys)return;enter(node,opts=opts||{});for(const key of keys){const subNode=node[key];if(Array.isArray(subNode))for(const node of subNode)traverseFast(node,enter,opts);else traverseFast(subNode,enter,opts)}};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(oldName,newName,prefix=""){if(warnings.has(oldName))return;warnings.add(oldName);const{internal,trace}=function(skip,length){const{stackTraceLimit,prepareStackTrace}=Error;let stackTrace;if(Error.stackTraceLimit=1+skip+length,Error.prepareStackTrace=function(err,stack){stackTrace=stack},(new Error).stack,Error.stackTraceLimit=stackTraceLimit,Error.prepareStackTrace=prepareStackTrace,!stackTrace)return{internal:!1,trace:""};const shortStackTrace=stackTrace.slice(1+skip,1+skip+length);return{internal:/[\\/]@babel[\\/]/.test(shortStackTrace[1].getFileName()),trace:shortStackTrace.map((frame=>`    at ${frame}`)).join("\n")}}(1,2);if(internal)return;console.warn(`${prefix}\`${oldName}\` has been deprecated, please migrate to \`${newName}\`\n${trace}`)};const warnings=new Set},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/inherit.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(key,child,parent){child&&parent&&(child[key]=Array.from(new Set([].concat(child[key],parent[key]).filter(Boolean))))}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/react/cleanJSXElementLiteralChild.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(child,args){const lines=child.value.split(/\r\n|\n|\r/);let lastNonEmptyLine=0;for(let i=0;i<lines.length;i++)/[^ \t]/.exec(lines[i])&&(lastNonEmptyLine=i);let str="";for(let i=0;i<lines.length;i++){const line=lines[i],isFirstLine=0===i,isLastLine=i===lines.length-1,isLastNonEmptyLine=i===lastNonEmptyLine;let trimmedLine=line.replace(/\t/g," ");isFirstLine||(trimmedLine=trimmedLine.replace(/^ +/,"")),isLastLine||(trimmedLine=trimmedLine.replace(/ +$/,"")),trimmedLine&&(isLastNonEmptyLine||(trimmedLine+=" "),str+=trimmedLine)}str&&args.push((0,_index2.inherits)((0,_index.stringLiteral)(str),child))};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/builders/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(actual,expected){const keys=Object.keys(expected);for(const key of keys)if(actual[key]!==expected[key])return!1;return!0}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/buildMatchMemberExpression.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(match,allowPartial){const parts=match.split(".");return member=>(0,_matchesPattern.default)(member,parts,allowPartial)};var _matchesPattern=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/matchesPattern.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isAccessor=function(node,opts){if(!node)return!1;if("ClassAccessorProperty"!==node.type)return!1;return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isAnyTypeAnnotation=function(node,opts){return!!node&&("AnyTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArgumentPlaceholder=function(node,opts){return!!node&&("ArgumentPlaceholder"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrayExpression=function(node,opts){return!!node&&("ArrayExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrayPattern=function(node,opts){return!!node&&("ArrayPattern"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrayTypeAnnotation=function(node,opts){return!!node&&("ArrayTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isArrowFunctionExpression=function(node,opts){return!!node&&("ArrowFunctionExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isAssignmentExpression=function(node,opts){return!!node&&("AssignmentExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isAssignmentPattern=function(node,opts){return!!node&&("AssignmentPattern"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isAwaitExpression=function(node,opts){return!!node&&("AwaitExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBigIntLiteral=function(node,opts){return!!node&&("BigIntLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBinary=function(node,opts){if(!node)return!1;switch(node.type){case"BinaryExpression":case"LogicalExpression":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isBinaryExpression=function(node,opts){return!!node&&("BinaryExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBindExpression=function(node,opts){return!!node&&("BindExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBlock=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"Program":case"TSModuleBlock":break;case"Placeholder":if("BlockStatement"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isBlockParent=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"FunctionExpression":case"Program":case"ObjectMethod":case"SwitchStatement":case"WhileStatement":case"ArrowFunctionExpression":case"ForOfStatement":case"ClassMethod":case"ClassPrivateMethod":case"StaticBlock":case"TSModuleBlock":break;case"Placeholder":if("BlockStatement"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isBlockStatement=function(node,opts){return!!node&&("BlockStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBooleanLiteral=function(node,opts){return!!node&&("BooleanLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBooleanLiteralTypeAnnotation=function(node,opts){return!!node&&("BooleanLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBooleanTypeAnnotation=function(node,opts){return!!node&&("BooleanTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isBreakStatement=function(node,opts){return!!node&&("BreakStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isCallExpression=function(node,opts){return!!node&&("CallExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isCatchClause=function(node,opts){return!!node&&("CatchClause"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClass=function(node,opts){if(!node)return!1;switch(node.type){case"ClassExpression":case"ClassDeclaration":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isClassAccessorProperty=function(node,opts){return!!node&&("ClassAccessorProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassBody=function(node,opts){return!!node&&("ClassBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassDeclaration=function(node,opts){return!!node&&("ClassDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassExpression=function(node,opts){return!!node&&("ClassExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassImplements=function(node,opts){return!!node&&("ClassImplements"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassMethod=function(node,opts){return!!node&&("ClassMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassPrivateMethod=function(node,opts){return!!node&&("ClassPrivateMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassPrivateProperty=function(node,opts){return!!node&&("ClassPrivateProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isClassProperty=function(node,opts){return!!node&&("ClassProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isCompletionStatement=function(node,opts){if(!node)return!1;switch(node.type){case"BreakStatement":case"ContinueStatement":case"ReturnStatement":case"ThrowStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isConditional=function(node,opts){if(!node)return!1;switch(node.type){case"ConditionalExpression":case"IfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isConditionalExpression=function(node,opts){return!!node&&("ConditionalExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isContinueStatement=function(node,opts){return!!node&&("ContinueStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDebuggerStatement=function(node,opts){return!!node&&("DebuggerStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDecimalLiteral=function(node,opts){return!!node&&("DecimalLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclaration=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"VariableDeclaration":case"ClassDeclaration":case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ImportDeclaration":case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"InterfaceDeclaration":case"OpaqueType":case"TypeAlias":case"EnumDeclaration":case"TSDeclareFunction":case"TSInterfaceDeclaration":case"TSTypeAliasDeclaration":case"TSEnumDeclaration":case"TSModuleDeclaration":break;case"Placeholder":if("Declaration"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isDeclareClass=function(node,opts){return!!node&&("DeclareClass"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareExportAllDeclaration=function(node,opts){return!!node&&("DeclareExportAllDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareExportDeclaration=function(node,opts){return!!node&&("DeclareExportDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareFunction=function(node,opts){return!!node&&("DeclareFunction"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareInterface=function(node,opts){return!!node&&("DeclareInterface"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareModule=function(node,opts){return!!node&&("DeclareModule"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareModuleExports=function(node,opts){return!!node&&("DeclareModuleExports"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareOpaqueType=function(node,opts){return!!node&&("DeclareOpaqueType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareTypeAlias=function(node,opts){return!!node&&("DeclareTypeAlias"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclareVariable=function(node,opts){return!!node&&("DeclareVariable"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDeclaredPredicate=function(node,opts){return!!node&&("DeclaredPredicate"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDecorator=function(node,opts){return!!node&&("Decorator"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDirective=function(node,opts){return!!node&&("Directive"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDirectiveLiteral=function(node,opts){return!!node&&("DirectiveLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDoExpression=function(node,opts){return!!node&&("DoExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isDoWhileStatement=function(node,opts){return!!node&&("DoWhileStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEmptyStatement=function(node,opts){return!!node&&("EmptyStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEmptyTypeAnnotation=function(node,opts){return!!node&&("EmptyTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumBody=function(node,opts){if(!node)return!1;switch(node.type){case"EnumBooleanBody":case"EnumNumberBody":case"EnumStringBody":case"EnumSymbolBody":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isEnumBooleanBody=function(node,opts){return!!node&&("EnumBooleanBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumBooleanMember=function(node,opts){return!!node&&("EnumBooleanMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumDeclaration=function(node,opts){return!!node&&("EnumDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumDefaultedMember=function(node,opts){return!!node&&("EnumDefaultedMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumMember=function(node,opts){if(!node)return!1;switch(node.type){case"EnumBooleanMember":case"EnumNumberMember":case"EnumStringMember":case"EnumDefaultedMember":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isEnumNumberBody=function(node,opts){return!!node&&("EnumNumberBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumNumberMember=function(node,opts){return!!node&&("EnumNumberMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumStringBody=function(node,opts){return!!node&&("EnumStringBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumStringMember=function(node,opts){return!!node&&("EnumStringMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isEnumSymbolBody=function(node,opts){return!!node&&("EnumSymbolBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExistsTypeAnnotation=function(node,opts){return!!node&&("ExistsTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportAllDeclaration=function(node,opts){return!!node&&("ExportAllDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportDeclaration=function(node,opts){if(!node)return!1;switch(node.type){case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isExportDefaultDeclaration=function(node,opts){return!!node&&("ExportDefaultDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportDefaultSpecifier=function(node,opts){return!!node&&("ExportDefaultSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportNamedDeclaration=function(node,opts){return!!node&&("ExportNamedDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportNamespaceSpecifier=function(node,opts){return!!node&&("ExportNamespaceSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExportSpecifier=function(node,opts){return!!node&&("ExportSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExpression=function(node,opts){if(!node)return!1;switch(node.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ParenthesizedExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":case"ArrowFunctionExpression":case"ClassExpression":case"ImportExpression":case"MetaProperty":case"Super":case"TaggedTemplateExpression":case"TemplateLiteral":case"YieldExpression":case"AwaitExpression":case"Import":case"BigIntLiteral":case"OptionalMemberExpression":case"OptionalCallExpression":case"TypeCastExpression":case"JSXElement":case"JSXFragment":case"BindExpression":case"DoExpression":case"RecordExpression":case"TupleExpression":case"DecimalLiteral":case"ModuleExpression":case"TopicReference":case"PipelineTopicExpression":case"PipelineBareFunction":case"PipelinePrimaryTopicReference":case"TSInstantiationExpression":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":break;case"Placeholder":switch(node.expectedNode){case"Expression":case"Identifier":case"StringLiteral":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isExpressionStatement=function(node,opts){return!!node&&("ExpressionStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isExpressionWrapper=function(node,opts){if(!node)return!1;switch(node.type){case"ExpressionStatement":case"ParenthesizedExpression":case"TypeCastExpression":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFile=function(node,opts){return!!node&&("File"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFlow=function(node,opts){if(!node)return!1;switch(node.type){case"AnyTypeAnnotation":case"ArrayTypeAnnotation":case"BooleanTypeAnnotation":case"BooleanLiteralTypeAnnotation":case"NullLiteralTypeAnnotation":case"ClassImplements":case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"DeclaredPredicate":case"ExistsTypeAnnotation":case"FunctionTypeAnnotation":case"FunctionTypeParam":case"GenericTypeAnnotation":case"InferredPredicate":case"InterfaceExtends":case"InterfaceDeclaration":case"InterfaceTypeAnnotation":case"IntersectionTypeAnnotation":case"MixedTypeAnnotation":case"EmptyTypeAnnotation":case"NullableTypeAnnotation":case"NumberLiteralTypeAnnotation":case"NumberTypeAnnotation":case"ObjectTypeAnnotation":case"ObjectTypeInternalSlot":case"ObjectTypeCallProperty":case"ObjectTypeIndexer":case"ObjectTypeProperty":case"ObjectTypeSpreadProperty":case"OpaqueType":case"QualifiedTypeIdentifier":case"StringLiteralTypeAnnotation":case"StringTypeAnnotation":case"SymbolTypeAnnotation":case"ThisTypeAnnotation":case"TupleTypeAnnotation":case"TypeofTypeAnnotation":case"TypeAlias":case"TypeAnnotation":case"TypeCastExpression":case"TypeParameter":case"TypeParameterDeclaration":case"TypeParameterInstantiation":case"UnionTypeAnnotation":case"Variance":case"VoidTypeAnnotation":case"EnumDeclaration":case"EnumBooleanBody":case"EnumNumberBody":case"EnumStringBody":case"EnumSymbolBody":case"EnumBooleanMember":case"EnumNumberMember":case"EnumStringMember":case"EnumDefaultedMember":case"IndexedAccessType":case"OptionalIndexedAccessType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowBaseAnnotation=function(node,opts){if(!node)return!1;switch(node.type){case"AnyTypeAnnotation":case"BooleanTypeAnnotation":case"NullLiteralTypeAnnotation":case"MixedTypeAnnotation":case"EmptyTypeAnnotation":case"NumberTypeAnnotation":case"StringTypeAnnotation":case"SymbolTypeAnnotation":case"ThisTypeAnnotation":case"VoidTypeAnnotation":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowDeclaration=function(node,opts){if(!node)return!1;switch(node.type){case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"InterfaceDeclaration":case"OpaqueType":case"TypeAlias":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowPredicate=function(node,opts){if(!node)return!1;switch(node.type){case"DeclaredPredicate":case"InferredPredicate":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFlowType=function(node,opts){if(!node)return!1;switch(node.type){case"AnyTypeAnnotation":case"ArrayTypeAnnotation":case"BooleanTypeAnnotation":case"BooleanLiteralTypeAnnotation":case"NullLiteralTypeAnnotation":case"ExistsTypeAnnotation":case"FunctionTypeAnnotation":case"GenericTypeAnnotation":case"InterfaceTypeAnnotation":case"IntersectionTypeAnnotation":case"MixedTypeAnnotation":case"EmptyTypeAnnotation":case"NullableTypeAnnotation":case"NumberLiteralTypeAnnotation":case"NumberTypeAnnotation":case"ObjectTypeAnnotation":case"StringLiteralTypeAnnotation":case"StringTypeAnnotation":case"SymbolTypeAnnotation":case"ThisTypeAnnotation":case"TupleTypeAnnotation":case"TypeofTypeAnnotation":case"UnionTypeAnnotation":case"VoidTypeAnnotation":case"IndexedAccessType":case"OptionalIndexedAccessType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFor=function(node,opts){if(!node)return!1;switch(node.type){case"ForInStatement":case"ForStatement":case"ForOfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isForInStatement=function(node,opts){return!!node&&("ForInStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isForOfStatement=function(node,opts){return!!node&&("ForOfStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isForStatement=function(node,opts){return!!node&&("ForStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isForXStatement=function(node,opts){if(!node)return!1;switch(node.type){case"ForInStatement":case"ForOfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFunction=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"FunctionExpression":case"ObjectMethod":case"ArrowFunctionExpression":case"ClassMethod":case"ClassPrivateMethod":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFunctionDeclaration=function(node,opts){return!!node&&("FunctionDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFunctionExpression=function(node,opts){return!!node&&("FunctionExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFunctionParent=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"FunctionExpression":case"ObjectMethod":case"ArrowFunctionExpression":case"ClassMethod":case"ClassPrivateMethod":case"StaticBlock":case"TSModuleBlock":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isFunctionTypeAnnotation=function(node,opts){return!!node&&("FunctionTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isFunctionTypeParam=function(node,opts){return!!node&&("FunctionTypeParam"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isGenericTypeAnnotation=function(node,opts){return!!node&&("GenericTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIdentifier=function(node,opts){return!!node&&("Identifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIfStatement=function(node,opts){return!!node&&("IfStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImmutable=function(node,opts){if(!node)return!1;switch(node.type){case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"BigIntLiteral":case"JSXAttribute":case"JSXClosingElement":case"JSXElement":case"JSXExpressionContainer":case"JSXSpreadChild":case"JSXOpeningElement":case"JSXText":case"JSXFragment":case"JSXOpeningFragment":case"JSXClosingFragment":case"DecimalLiteral":break;case"Placeholder":if("StringLiteral"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isImport=function(node,opts){return!!node&&("Import"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportAttribute=function(node,opts){return!!node&&("ImportAttribute"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportDeclaration=function(node,opts){return!!node&&("ImportDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportDefaultSpecifier=function(node,opts){return!!node&&("ImportDefaultSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportExpression=function(node,opts){return!!node&&("ImportExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportNamespaceSpecifier=function(node,opts){return!!node&&("ImportNamespaceSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isImportOrExportDeclaration=isImportOrExportDeclaration,exports.isImportSpecifier=function(node,opts){return!!node&&("ImportSpecifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIndexedAccessType=function(node,opts){return!!node&&("IndexedAccessType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInferredPredicate=function(node,opts){return!!node&&("InferredPredicate"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterfaceDeclaration=function(node,opts){return!!node&&("InterfaceDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterfaceExtends=function(node,opts){return!!node&&("InterfaceExtends"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterfaceTypeAnnotation=function(node,opts){return!!node&&("InterfaceTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isInterpreterDirective=function(node,opts){return!!node&&("InterpreterDirective"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isIntersectionTypeAnnotation=function(node,opts){return!!node&&("IntersectionTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSX=function(node,opts){if(!node)return!1;switch(node.type){case"JSXAttribute":case"JSXClosingElement":case"JSXElement":case"JSXEmptyExpression":case"JSXExpressionContainer":case"JSXSpreadChild":case"JSXIdentifier":case"JSXMemberExpression":case"JSXNamespacedName":case"JSXOpeningElement":case"JSXSpreadAttribute":case"JSXText":case"JSXFragment":case"JSXOpeningFragment":case"JSXClosingFragment":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isJSXAttribute=function(node,opts){return!!node&&("JSXAttribute"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXClosingElement=function(node,opts){return!!node&&("JSXClosingElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXClosingFragment=function(node,opts){return!!node&&("JSXClosingFragment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXElement=function(node,opts){return!!node&&("JSXElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXEmptyExpression=function(node,opts){return!!node&&("JSXEmptyExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXExpressionContainer=function(node,opts){return!!node&&("JSXExpressionContainer"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXFragment=function(node,opts){return!!node&&("JSXFragment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXIdentifier=function(node,opts){return!!node&&("JSXIdentifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXMemberExpression=function(node,opts){return!!node&&("JSXMemberExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXNamespacedName=function(node,opts){return!!node&&("JSXNamespacedName"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXOpeningElement=function(node,opts){return!!node&&("JSXOpeningElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXOpeningFragment=function(node,opts){return!!node&&("JSXOpeningFragment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXSpreadAttribute=function(node,opts){return!!node&&("JSXSpreadAttribute"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXSpreadChild=function(node,opts){return!!node&&("JSXSpreadChild"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isJSXText=function(node,opts){return!!node&&("JSXText"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isLVal=function(node,opts){if(!node)return!1;switch(node.type){case"Identifier":case"MemberExpression":case"RestElement":case"AssignmentPattern":case"ArrayPattern":case"ObjectPattern":case"TSParameterProperty":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":break;case"Placeholder":switch(node.expectedNode){case"Pattern":case"Identifier":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isLabeledStatement=function(node,opts){return!!node&&("LabeledStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isLiteral=function(node,opts){if(!node)return!1;switch(node.type){case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"TemplateLiteral":case"BigIntLiteral":case"DecimalLiteral":break;case"Placeholder":if("StringLiteral"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isLogicalExpression=function(node,opts){return!!node&&("LogicalExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isLoop=function(node,opts){if(!node)return!1;switch(node.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":case"ForOfStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isMemberExpression=function(node,opts){return!!node&&("MemberExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isMetaProperty=function(node,opts){return!!node&&("MetaProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isMethod=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectMethod":case"ClassMethod":case"ClassPrivateMethod":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isMiscellaneous=function(node,opts){if(!node)return!1;switch(node.type){case"Noop":case"Placeholder":case"V8IntrinsicIdentifier":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isMixedTypeAnnotation=function(node,opts){return!!node&&("MixedTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isModuleDeclaration=function(node,opts){return(0,_deprecationWarning.default)("isModuleDeclaration","isImportOrExportDeclaration"),isImportOrExportDeclaration(node,opts)},exports.isModuleExpression=function(node,opts){return!!node&&("ModuleExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isModuleSpecifier=function(node,opts){if(!node)return!1;switch(node.type){case"ExportSpecifier":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"ImportSpecifier":case"ExportNamespaceSpecifier":case"ExportDefaultSpecifier":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isNewExpression=function(node,opts){return!!node&&("NewExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNoop=function(node,opts){return!!node&&("Noop"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNullLiteral=function(node,opts){return!!node&&("NullLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNullLiteralTypeAnnotation=function(node,opts){return!!node&&("NullLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNullableTypeAnnotation=function(node,opts){return!!node&&("NullableTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumberLiteral=function(node,opts){return(0,_deprecationWarning.default)("isNumberLiteral","isNumericLiteral"),!!node&&("NumberLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumberLiteralTypeAnnotation=function(node,opts){return!!node&&("NumberLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumberTypeAnnotation=function(node,opts){return!!node&&("NumberTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isNumericLiteral=function(node,opts){return!!node&&("NumericLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectExpression=function(node,opts){return!!node&&("ObjectExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectMember=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectMethod":case"ObjectProperty":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isObjectMethod=function(node,opts){return!!node&&("ObjectMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectPattern=function(node,opts){return!!node&&("ObjectPattern"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectProperty=function(node,opts){return!!node&&("ObjectProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeAnnotation=function(node,opts){return!!node&&("ObjectTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeCallProperty=function(node,opts){return!!node&&("ObjectTypeCallProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeIndexer=function(node,opts){return!!node&&("ObjectTypeIndexer"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeInternalSlot=function(node,opts){return!!node&&("ObjectTypeInternalSlot"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeProperty=function(node,opts){return!!node&&("ObjectTypeProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isObjectTypeSpreadProperty=function(node,opts){return!!node&&("ObjectTypeSpreadProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOpaqueType=function(node,opts){return!!node&&("OpaqueType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOptionalCallExpression=function(node,opts){return!!node&&("OptionalCallExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOptionalIndexedAccessType=function(node,opts){return!!node&&("OptionalIndexedAccessType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isOptionalMemberExpression=function(node,opts){return!!node&&("OptionalMemberExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isParenthesizedExpression=function(node,opts){return!!node&&("ParenthesizedExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPattern=function(node,opts){if(!node)return!1;switch(node.type){case"AssignmentPattern":case"ArrayPattern":case"ObjectPattern":break;case"Placeholder":if("Pattern"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPatternLike=function(node,opts){if(!node)return!1;switch(node.type){case"Identifier":case"RestElement":case"AssignmentPattern":case"ArrayPattern":case"ObjectPattern":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":break;case"Placeholder":switch(node.expectedNode){case"Pattern":case"Identifier":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPipelineBareFunction=function(node,opts){return!!node&&("PipelineBareFunction"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPipelinePrimaryTopicReference=function(node,opts){return!!node&&("PipelinePrimaryTopicReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPipelineTopicExpression=function(node,opts){return!!node&&("PipelineTopicExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPlaceholder=function(node,opts){return!!node&&("Placeholder"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isPrivate=function(node,opts){if(!node)return!1;switch(node.type){case"ClassPrivateProperty":case"ClassPrivateMethod":case"PrivateName":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPrivateName=function(node,opts){return!!node&&("PrivateName"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isProgram=function(node,opts){return!!node&&("Program"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isProperty=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectProperty":case"ClassProperty":case"ClassAccessorProperty":case"ClassPrivateProperty":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isPureish=function(node,opts){if(!node)return!1;switch(node.type){case"FunctionDeclaration":case"FunctionExpression":case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"ArrowFunctionExpression":case"BigIntLiteral":case"DecimalLiteral":break;case"Placeholder":if("StringLiteral"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isQualifiedTypeIdentifier=function(node,opts){return!!node&&("QualifiedTypeIdentifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRecordExpression=function(node,opts){return!!node&&("RecordExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRegExpLiteral=function(node,opts){return!!node&&("RegExpLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRegexLiteral=function(node,opts){return(0,_deprecationWarning.default)("isRegexLiteral","isRegExpLiteral"),!!node&&("RegexLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRestElement=function(node,opts){return!!node&&("RestElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isRestProperty=function(node,opts){return(0,_deprecationWarning.default)("isRestProperty","isRestElement"),!!node&&("RestProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isReturnStatement=function(node,opts){return!!node&&("ReturnStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isScopable=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"CatchClause":case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"FunctionExpression":case"Program":case"ObjectMethod":case"SwitchStatement":case"WhileStatement":case"ArrowFunctionExpression":case"ClassExpression":case"ClassDeclaration":case"ForOfStatement":case"ClassMethod":case"ClassPrivateMethod":case"StaticBlock":case"TSModuleBlock":break;case"Placeholder":if("BlockStatement"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isSequenceExpression=function(node,opts){return!!node&&("SequenceExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSpreadElement=function(node,opts){return!!node&&("SpreadElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSpreadProperty=function(node,opts){return(0,_deprecationWarning.default)("isSpreadProperty","isSpreadElement"),!!node&&("SpreadProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStandardized=function(node,opts){if(!node)return!1;switch(node.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"InterpreterDirective":case"Directive":case"DirectiveLiteral":case"BlockStatement":case"BreakStatement":case"CallExpression":case"CatchClause":case"ConditionalExpression":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"File":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"FunctionExpression":case"Identifier":case"IfStatement":case"LabeledStatement":case"StringLiteral":case"NumericLiteral":case"NullLiteral":case"BooleanLiteral":case"RegExpLiteral":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"Program":case"ObjectExpression":case"ObjectMethod":case"ObjectProperty":case"RestElement":case"ReturnStatement":case"SequenceExpression":case"ParenthesizedExpression":case"SwitchCase":case"SwitchStatement":case"ThisExpression":case"ThrowStatement":case"TryStatement":case"UnaryExpression":case"UpdateExpression":case"VariableDeclaration":case"VariableDeclarator":case"WhileStatement":case"WithStatement":case"AssignmentPattern":case"ArrayPattern":case"ArrowFunctionExpression":case"ClassBody":case"ClassExpression":case"ClassDeclaration":case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ExportSpecifier":case"ForOfStatement":case"ImportDeclaration":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"ImportSpecifier":case"ImportExpression":case"MetaProperty":case"ClassMethod":case"ObjectPattern":case"SpreadElement":case"Super":case"TaggedTemplateExpression":case"TemplateElement":case"TemplateLiteral":case"YieldExpression":case"AwaitExpression":case"Import":case"BigIntLiteral":case"ExportNamespaceSpecifier":case"OptionalMemberExpression":case"OptionalCallExpression":case"ClassProperty":case"ClassAccessorProperty":case"ClassPrivateProperty":case"ClassPrivateMethod":case"PrivateName":case"StaticBlock":break;case"Placeholder":switch(node.expectedNode){case"Identifier":case"StringLiteral":case"BlockStatement":case"ClassBody":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isStatement=function(node,opts){if(!node)return!1;switch(node.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"FunctionDeclaration":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":case"ClassDeclaration":case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ForOfStatement":case"ImportDeclaration":case"DeclareClass":case"DeclareFunction":case"DeclareInterface":case"DeclareModule":case"DeclareModuleExports":case"DeclareTypeAlias":case"DeclareOpaqueType":case"DeclareVariable":case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":case"InterfaceDeclaration":case"OpaqueType":case"TypeAlias":case"EnumDeclaration":case"TSDeclareFunction":case"TSInterfaceDeclaration":case"TSTypeAliasDeclaration":case"TSEnumDeclaration":case"TSModuleDeclaration":case"TSImportEqualsDeclaration":case"TSExportAssignment":case"TSNamespaceExportDeclaration":break;case"Placeholder":switch(node.expectedNode){case"Statement":case"Declaration":case"BlockStatement":break;default:return!1}break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isStaticBlock=function(node,opts){return!!node&&("StaticBlock"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStringLiteral=function(node,opts){return!!node&&("StringLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStringLiteralTypeAnnotation=function(node,opts){return!!node&&("StringLiteralTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isStringTypeAnnotation=function(node,opts){return!!node&&("StringTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSuper=function(node,opts){return!!node&&("Super"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSwitchCase=function(node,opts){return!!node&&("SwitchCase"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSwitchStatement=function(node,opts){return!!node&&("SwitchStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isSymbolTypeAnnotation=function(node,opts){return!!node&&("SymbolTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSAnyKeyword=function(node,opts){return!!node&&("TSAnyKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSArrayType=function(node,opts){return!!node&&("TSArrayType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSAsExpression=function(node,opts){return!!node&&("TSAsExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSBaseType=function(node,opts){if(!node)return!1;switch(node.type){case"TSAnyKeyword":case"TSBooleanKeyword":case"TSBigIntKeyword":case"TSIntrinsicKeyword":case"TSNeverKeyword":case"TSNullKeyword":case"TSNumberKeyword":case"TSObjectKeyword":case"TSStringKeyword":case"TSSymbolKeyword":case"TSUndefinedKeyword":case"TSUnknownKeyword":case"TSVoidKeyword":case"TSThisType":case"TSLiteralType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSBigIntKeyword=function(node,opts){return!!node&&("TSBigIntKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSBooleanKeyword=function(node,opts){return!!node&&("TSBooleanKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSCallSignatureDeclaration=function(node,opts){return!!node&&("TSCallSignatureDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSConditionalType=function(node,opts){return!!node&&("TSConditionalType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSConstructSignatureDeclaration=function(node,opts){return!!node&&("TSConstructSignatureDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSConstructorType=function(node,opts){return!!node&&("TSConstructorType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSDeclareFunction=function(node,opts){return!!node&&("TSDeclareFunction"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSDeclareMethod=function(node,opts){return!!node&&("TSDeclareMethod"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSEntityName=function(node,opts){if(!node)return!1;switch(node.type){case"Identifier":case"TSQualifiedName":break;case"Placeholder":if("Identifier"===node.expectedNode)break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSEnumDeclaration=function(node,opts){return!!node&&("TSEnumDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSEnumMember=function(node,opts){return!!node&&("TSEnumMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSExportAssignment=function(node,opts){return!!node&&("TSExportAssignment"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSExpressionWithTypeArguments=function(node,opts){return!!node&&("TSExpressionWithTypeArguments"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSExternalModuleReference=function(node,opts){return!!node&&("TSExternalModuleReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSFunctionType=function(node,opts){return!!node&&("TSFunctionType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSImportEqualsDeclaration=function(node,opts){return!!node&&("TSImportEqualsDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSImportType=function(node,opts){return!!node&&("TSImportType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIndexSignature=function(node,opts){return!!node&&("TSIndexSignature"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIndexedAccessType=function(node,opts){return!!node&&("TSIndexedAccessType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInferType=function(node,opts){return!!node&&("TSInferType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInstantiationExpression=function(node,opts){return!!node&&("TSInstantiationExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInterfaceBody=function(node,opts){return!!node&&("TSInterfaceBody"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSInterfaceDeclaration=function(node,opts){return!!node&&("TSInterfaceDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIntersectionType=function(node,opts){return!!node&&("TSIntersectionType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSIntrinsicKeyword=function(node,opts){return!!node&&("TSIntrinsicKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSLiteralType=function(node,opts){return!!node&&("TSLiteralType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSMappedType=function(node,opts){return!!node&&("TSMappedType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSMethodSignature=function(node,opts){return!!node&&("TSMethodSignature"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSModuleBlock=function(node,opts){return!!node&&("TSModuleBlock"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSModuleDeclaration=function(node,opts){return!!node&&("TSModuleDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNamedTupleMember=function(node,opts){return!!node&&("TSNamedTupleMember"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNamespaceExportDeclaration=function(node,opts){return!!node&&("TSNamespaceExportDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNeverKeyword=function(node,opts){return!!node&&("TSNeverKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNonNullExpression=function(node,opts){return!!node&&("TSNonNullExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNullKeyword=function(node,opts){return!!node&&("TSNullKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSNumberKeyword=function(node,opts){return!!node&&("TSNumberKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSObjectKeyword=function(node,opts){return!!node&&("TSObjectKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSOptionalType=function(node,opts){return!!node&&("TSOptionalType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSParameterProperty=function(node,opts){return!!node&&("TSParameterProperty"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSParenthesizedType=function(node,opts){return!!node&&("TSParenthesizedType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSPropertySignature=function(node,opts){return!!node&&("TSPropertySignature"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSQualifiedName=function(node,opts){return!!node&&("TSQualifiedName"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSRestType=function(node,opts){return!!node&&("TSRestType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSSatisfiesExpression=function(node,opts){return!!node&&("TSSatisfiesExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSStringKeyword=function(node,opts){return!!node&&("TSStringKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSSymbolKeyword=function(node,opts){return!!node&&("TSSymbolKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSThisType=function(node,opts){return!!node&&("TSThisType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTupleType=function(node,opts){return!!node&&("TSTupleType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSType=function(node,opts){if(!node)return!1;switch(node.type){case"TSAnyKeyword":case"TSBooleanKeyword":case"TSBigIntKeyword":case"TSIntrinsicKeyword":case"TSNeverKeyword":case"TSNullKeyword":case"TSNumberKeyword":case"TSObjectKeyword":case"TSStringKeyword":case"TSSymbolKeyword":case"TSUndefinedKeyword":case"TSUnknownKeyword":case"TSVoidKeyword":case"TSThisType":case"TSFunctionType":case"TSConstructorType":case"TSTypeReference":case"TSTypePredicate":case"TSTypeQuery":case"TSTypeLiteral":case"TSArrayType":case"TSTupleType":case"TSOptionalType":case"TSRestType":case"TSUnionType":case"TSIntersectionType":case"TSConditionalType":case"TSInferType":case"TSParenthesizedType":case"TSTypeOperator":case"TSIndexedAccessType":case"TSMappedType":case"TSLiteralType":case"TSExpressionWithTypeArguments":case"TSImportType":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSTypeAliasDeclaration=function(node,opts){return!!node&&("TSTypeAliasDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeAnnotation=function(node,opts){return!!node&&("TSTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeAssertion=function(node,opts){return!!node&&("TSTypeAssertion"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeElement=function(node,opts){if(!node)return!1;switch(node.type){case"TSCallSignatureDeclaration":case"TSConstructSignatureDeclaration":case"TSPropertySignature":case"TSMethodSignature":case"TSIndexSignature":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTSTypeLiteral=function(node,opts){return!!node&&("TSTypeLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeOperator=function(node,opts){return!!node&&("TSTypeOperator"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeParameter=function(node,opts){return!!node&&("TSTypeParameter"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeParameterDeclaration=function(node,opts){return!!node&&("TSTypeParameterDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeParameterInstantiation=function(node,opts){return!!node&&("TSTypeParameterInstantiation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypePredicate=function(node,opts){return!!node&&("TSTypePredicate"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeQuery=function(node,opts){return!!node&&("TSTypeQuery"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSTypeReference=function(node,opts){return!!node&&("TSTypeReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSUndefinedKeyword=function(node,opts){return!!node&&("TSUndefinedKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSUnionType=function(node,opts){return!!node&&("TSUnionType"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSUnknownKeyword=function(node,opts){return!!node&&("TSUnknownKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTSVoidKeyword=function(node,opts){return!!node&&("TSVoidKeyword"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTaggedTemplateExpression=function(node,opts){return!!node&&("TaggedTemplateExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTemplateElement=function(node,opts){return!!node&&("TemplateElement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTemplateLiteral=function(node,opts){return!!node&&("TemplateLiteral"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTerminatorless=function(node,opts){if(!node)return!1;switch(node.type){case"BreakStatement":case"ContinueStatement":case"ReturnStatement":case"ThrowStatement":case"YieldExpression":case"AwaitExpression":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isThisExpression=function(node,opts){return!!node&&("ThisExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isThisTypeAnnotation=function(node,opts){return!!node&&("ThisTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isThrowStatement=function(node,opts){return!!node&&("ThrowStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTopicReference=function(node,opts){return!!node&&("TopicReference"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTryStatement=function(node,opts){return!!node&&("TryStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTupleExpression=function(node,opts){return!!node&&("TupleExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTupleTypeAnnotation=function(node,opts){return!!node&&("TupleTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeAlias=function(node,opts){return!!node&&("TypeAlias"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeAnnotation=function(node,opts){return!!node&&("TypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeCastExpression=function(node,opts){return!!node&&("TypeCastExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeParameter=function(node,opts){return!!node&&("TypeParameter"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeParameterDeclaration=function(node,opts){return!!node&&("TypeParameterDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeParameterInstantiation=function(node,opts){return!!node&&("TypeParameterInstantiation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isTypeScript=function(node,opts){if(!node)return!1;switch(node.type){case"TSParameterProperty":case"TSDeclareFunction":case"TSDeclareMethod":case"TSQualifiedName":case"TSCallSignatureDeclaration":case"TSConstructSignatureDeclaration":case"TSPropertySignature":case"TSMethodSignature":case"TSIndexSignature":case"TSAnyKeyword":case"TSBooleanKeyword":case"TSBigIntKeyword":case"TSIntrinsicKeyword":case"TSNeverKeyword":case"TSNullKeyword":case"TSNumberKeyword":case"TSObjectKeyword":case"TSStringKeyword":case"TSSymbolKeyword":case"TSUndefinedKeyword":case"TSUnknownKeyword":case"TSVoidKeyword":case"TSThisType":case"TSFunctionType":case"TSConstructorType":case"TSTypeReference":case"TSTypePredicate":case"TSTypeQuery":case"TSTypeLiteral":case"TSArrayType":case"TSTupleType":case"TSOptionalType":case"TSRestType":case"TSNamedTupleMember":case"TSUnionType":case"TSIntersectionType":case"TSConditionalType":case"TSInferType":case"TSParenthesizedType":case"TSTypeOperator":case"TSIndexedAccessType":case"TSMappedType":case"TSLiteralType":case"TSExpressionWithTypeArguments":case"TSInterfaceDeclaration":case"TSInterfaceBody":case"TSTypeAliasDeclaration":case"TSInstantiationExpression":case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSEnumDeclaration":case"TSEnumMember":case"TSModuleDeclaration":case"TSModuleBlock":case"TSImportType":case"TSImportEqualsDeclaration":case"TSExternalModuleReference":case"TSNonNullExpression":case"TSExportAssignment":case"TSNamespaceExportDeclaration":case"TSTypeAnnotation":case"TSTypeParameterInstantiation":case"TSTypeParameterDeclaration":case"TSTypeParameter":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isTypeofTypeAnnotation=function(node,opts){return!!node&&("TypeofTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUnaryExpression=function(node,opts){return!!node&&("UnaryExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUnaryLike=function(node,opts){if(!node)return!1;switch(node.type){case"UnaryExpression":case"SpreadElement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isUnionTypeAnnotation=function(node,opts){return!!node&&("UnionTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUpdateExpression=function(node,opts){return!!node&&("UpdateExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isUserWhitespacable=function(node,opts){if(!node)return!1;switch(node.type){case"ObjectMethod":case"ObjectProperty":case"ObjectTypeInternalSlot":case"ObjectTypeCallProperty":case"ObjectTypeIndexer":case"ObjectTypeProperty":case"ObjectTypeSpreadProperty":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isV8IntrinsicIdentifier=function(node,opts){return!!node&&("V8IntrinsicIdentifier"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVariableDeclaration=function(node,opts){return!!node&&("VariableDeclaration"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVariableDeclarator=function(node,opts){return!!node&&("VariableDeclarator"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVariance=function(node,opts){return!!node&&("Variance"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isVoidTypeAnnotation=function(node,opts){return!!node&&("VoidTypeAnnotation"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isWhile=function(node,opts){if(!node)return!1;switch(node.type){case"DoWhileStatement":case"WhileStatement":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)},exports.isWhileStatement=function(node,opts){return!!node&&("WhileStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isWithStatement=function(node,opts){return!!node&&("WithStatement"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))},exports.isYieldExpression=function(node,opts){return!!node&&("YieldExpression"===node.type&&(null==opts||(0,_shallowEqual.default)(node,opts)))};var _shallowEqual=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js"),_deprecationWarning=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/deprecationWarning.js");function isImportOrExportDeclaration(node,opts){if(!node)return!1;switch(node.type){case"ExportAllDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":case"ImportDeclaration":break;default:return!1}return null==opts||(0,_shallowEqual.default)(node,opts)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/is.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(type,node,opts){if(!node)return!1;if(!(0,_isType.default)(node.type,type))return!opts&&"Placeholder"===node.type&&type in _index.FLIPPED_ALIAS_KEYS&&(0,_isPlaceholderType.default)(node.expectedNode,type);return void 0===opts||(0,_shallowEqual.default)(node,opts)};var _shallowEqual=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/utils/shallowEqual.js"),_isType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js"),_isPlaceholderType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isPlaceholderType.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBinding.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent,grandparent){if(grandparent&&"Identifier"===node.type&&"ObjectProperty"===parent.type&&"ObjectExpression"===grandparent.type)return!1;const keys=_getBindingIdentifiers.default.keys[parent.type];if(keys)for(let i=0;i<keys.length;i++){const val=parent[keys[i]];if(Array.isArray(val)){if(val.includes(node))return!0}else if(val===node)return!0}return!1};var _getBindingIdentifiers=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/retrievers/getBindingIdentifiers.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isBlockScoped.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_index.isFunctionDeclaration)(node)||(0,_index.isClassDeclaration)(node)||(0,_isLet.default)(node)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_isLet=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isLet.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isImmutable.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){if((0,_isType.default)(node.type,"Immutable"))return!0;if((0,_index.isIdentifier)(node))return"undefined"===node.name;return!1};var _isType=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js"),_index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isLet.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_index.isVariableDeclaration)(node)&&("var"!==node.kind||node[_index2.BLOCK_SCOPED_SYMBOL])};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNode.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return!(!node||!_index.VISITOR_KEYS[node.type])};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isNodesEquivalent.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function isNodesEquivalent(a,b){if("object"!=typeof a||"object"!=typeof b||null==a||null==b)return a===b;if(a.type!==b.type)return!1;const fields=Object.keys(_index.NODE_FIELDS[a.type]||a.type),visitorKeys=_index.VISITOR_KEYS[a.type];for(const field of fields){const val_a=a[field],val_b=b[field];if(typeof val_a!=typeof val_b)return!1;if(null!=val_a||null!=val_b){if(null==val_a||null==val_b)return!1;if(Array.isArray(val_a)){if(!Array.isArray(val_b))return!1;if(val_a.length!==val_b.length)return!1;for(let i=0;i<val_a.length;i++)if(!isNodesEquivalent(val_a[i],val_b[i]))return!1}else if("object"!=typeof val_a||null!=visitorKeys&&visitorKeys.includes(field)){if(!isNodesEquivalent(val_a,val_b))return!1}else for(const key of Object.keys(val_a))if(val_a[key]!==val_b[key])return!1}}return!0};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isPlaceholderType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(placeholderType,targetType){if(placeholderType===targetType)return!0;const aliases=_index.PLACEHOLDERS_ALIAS[placeholderType];if(aliases)for(const alias of aliases)if(targetType===alias)return!0;return!1};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isReferenced.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent,grandparent){switch(parent.type){case"MemberExpression":case"OptionalMemberExpression":return parent.property===node?!!parent.computed:parent.object===node;case"JSXMemberExpression":return parent.object===node;case"VariableDeclarator":return parent.init===node;case"ArrowFunctionExpression":return parent.body===node;case"PrivateName":case"LabeledStatement":case"CatchClause":case"RestElement":case"BreakStatement":case"ContinueStatement":case"FunctionDeclaration":case"FunctionExpression":case"ExportNamespaceSpecifier":case"ExportDefaultSpecifier":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"ImportSpecifier":case"ImportAttribute":case"JSXAttribute":case"ObjectPattern":case"ArrayPattern":case"MetaProperty":return!1;case"ClassMethod":case"ClassPrivateMethod":case"ObjectMethod":return parent.key===node&&!!parent.computed;case"ObjectProperty":return parent.key===node?!!parent.computed:!grandparent||"ObjectPattern"!==grandparent.type;case"ClassProperty":case"ClassAccessorProperty":case"TSPropertySignature":return parent.key!==node||!!parent.computed;case"ClassPrivateProperty":case"ObjectTypeProperty":return parent.key!==node;case"ClassDeclaration":case"ClassExpression":return parent.superClass===node;case"AssignmentExpression":case"AssignmentPattern":return parent.right===node;case"ExportSpecifier":return(null==grandparent||!grandparent.source)&&parent.local===node;case"TSEnumMember":return parent.id!==node}return!0}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isScope.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,parent){if((0,_index.isBlockStatement)(node)&&((0,_index.isFunction)(parent)||(0,_index.isCatchClause)(parent)))return!1;if((0,_index.isPattern)(node)&&((0,_index.isFunction)(parent)||(0,_index.isCatchClause)(parent)))return!0;return(0,_index.isScopable)(node)};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isSpecifierDefault.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(specifier){return(0,_index.isImportDefaultSpecifier)(specifier)||(0,_index.isIdentifier)(specifier.imported||specifier.exported,{name:"default"})};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isType.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(nodeType,targetType){if(nodeType===targetType)return!0;if(null==nodeType)return!1;if(_index.ALIAS_KEYS[targetType])return!1;const aliases=_index.FLIPPED_ALIAS_KEYS[targetType];if(aliases){if(aliases[0]===nodeType)return!0;for(const alias of aliases)if(nodeType===alias)return!0}return!1};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidES3Identifier.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(name){return(0,_isValidIdentifier.default)(name)&&!RESERVED_WORDS_ES3_ONLY.has(name)};var _isValidIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js");const RESERVED_WORDS_ES3_ONLY=new Set(["abstract","boolean","byte","char","double","enum","final","float","goto","implements","int","interface","long","native","package","private","protected","public","short","static","synchronized","throws","transient","volatile"])},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isValidIdentifier.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(name,reserved=!0){if("string"!=typeof name)return!1;if(reserved&&((0,_helperValidatorIdentifier.isKeyword)(name)||(0,_helperValidatorIdentifier.isStrictReservedWord)(name,!0)))return!1;return(0,_helperValidatorIdentifier.isIdentifierName)(name)};var _helperValidatorIdentifier=__webpack_require__("./node_modules/.pnpm/@babel+helper-validator-identifier@7.25.9/node_modules/@babel/helper-validator-identifier/lib/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/isVar.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node){return(0,_index.isVariableDeclaration)(node,{kind:"var"})&&!node[_index2.BLOCK_SCOPED_SYMBOL]};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js"),_index2=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/constants/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/matchesPattern.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(member,match,allowPartial){if(!(0,_index.isMemberExpression)(member))return!1;const parts=Array.isArray(match)?match:match.split("."),nodes=[];let node;for(node=member;(0,_index.isMemberExpression)(node);node=node.object)nodes.push(node.property);if(nodes.push(node),nodes.length<parts.length)return!1;if(!allowPartial&&nodes.length>parts.length)return!1;for(let i=0,j=nodes.length-1;i<parts.length;i++,j--){const node=nodes[j];let value;if((0,_index.isIdentifier)(node))value=node.name;else if((0,_index.isStringLiteral)(node))value=node.value;else{if(!(0,_index.isThisExpression)(node))return!1;value="this"}if(parts[i]!==value)return!1}return!0};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/generated/index.js")},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isCompatTag.js":(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(tagName){return!!tagName&&/^[a-z]/.test(tagName)}},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/react/isReactComponent.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const isReactComponent=(0,__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/buildMatchMemberExpression.js").default)("React.Component");exports.default=isReactComponent},"./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/validators/validate.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,key,val){if(!node)return;const fields=_index.NODE_FIELDS[node.type];if(!fields)return;const field=fields[key];validateField(node,key,val,field),validateChild(node,key,val)},exports.validateChild=validateChild,exports.validateField=validateField,exports.validateInternal=function(field,node,key,val,maybeNode){if(null==field||!field.validate)return;if(field.optional&&null==val)return;if(field.validate(node,key,val),maybeNode){var _NODE_PARENT_VALIDATI;const type=val.type;if(null==type)return;null==(_NODE_PARENT_VALIDATI=_index.NODE_PARENT_VALIDATIONS[type])||_NODE_PARENT_VALIDATI.call(_index.NODE_PARENT_VALIDATIONS,node,key,val)}};var _index=__webpack_require__("./node_modules/.pnpm/@babel+types@7.26.3/node_modules/@babel/types/lib/definitions/index.js");function validateField(node,key,val,field){null!=field&&field.validate&&(field.optional&&null==val||field.validate(node,key,val))}function validateChild(node,key,val){var _NODE_PARENT_VALIDATI2;const type=null==val?void 0:val.type;null!=type&&(null==(_NODE_PARENT_VALIDATI2=_index.NODE_PARENT_VALIDATIONS[type])||_NODE_PARENT_VALIDATI2.call(_index.NODE_PARENT_VALIDATIONS,node,key,val))}},"./node_modules/.pnpm/json5@2.2.3/node_modules/json5/dist/index.mjs":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var unicode={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},util={isSpaceSeparator:c=>"string"==typeof c&&unicode.Space_Separator.test(c),isIdStartChar:c=>"string"==typeof c&&(c>="a"&&c<="z"||c>="A"&&c<="Z"||"$"===c||"_"===c||unicode.ID_Start.test(c)),isIdContinueChar:c=>"string"==typeof c&&(c>="a"&&c<="z"||c>="A"&&c<="Z"||c>="0"&&c<="9"||"$"===c||"_"===c||"‌"===c||"‍"===c||unicode.ID_Continue.test(c)),isDigit:c=>"string"==typeof c&&/[0-9]/.test(c),isHexDigit:c=>"string"==typeof c&&/[0-9A-Fa-f]/.test(c)};let source,parseState,stack,pos,line,column,token,key,root;function internalize(holder,name,reviver){const value=holder[name];if(null!=value&&"object"==typeof value)if(Array.isArray(value))for(let i=0;i<value.length;i++){const key=String(i),replacement=internalize(value,key,reviver);void 0===replacement?delete value[key]:Object.defineProperty(value,key,{value:replacement,writable:!0,enumerable:!0,configurable:!0})}else for(const key in value){const replacement=internalize(value,key,reviver);void 0===replacement?delete value[key]:Object.defineProperty(value,key,{value:replacement,writable:!0,enumerable:!0,configurable:!0})}return reviver.call(holder,name,value)}let lexState,buffer,doubleQuote,sign,c;function lex(){for(lexState="default",buffer="",doubleQuote=!1,sign=1;;){c=peek();const token=lexStates[lexState]();if(token)return token}}function peek(){if(source[pos])return String.fromCodePoint(source.codePointAt(pos))}function read(){const c=peek();return"\n"===c?(line++,column=0):c?column+=c.length:column++,c&&(pos+=c.length),c}const lexStates={default(){switch(c){case"\t":case"\v":case"\f":case" ":case" ":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void read();case"/":return read(),void(lexState="comment");case void 0:return read(),newToken("eof")}if(!util.isSpaceSeparator(c))return lexStates[parseState]();read()},comment(){switch(c){case"*":return read(),void(lexState="multiLineComment");case"/":return read(),void(lexState="singleLineComment")}throw invalidChar(read())},multiLineComment(){switch(c){case"*":return read(),void(lexState="multiLineCommentAsterisk");case void 0:throw invalidChar(read())}read()},multiLineCommentAsterisk(){switch(c){case"*":return void read();case"/":return read(),void(lexState="default");case void 0:throw invalidChar(read())}read(),lexState="multiLineComment"},singleLineComment(){switch(c){case"\n":case"\r":case"\u2028":case"\u2029":return read(),void(lexState="default");case void 0:return read(),newToken("eof")}read()},value(){switch(c){case"{":case"[":return newToken("punctuator",read());case"n":return read(),literal("ull"),newToken("null",null);case"t":return read(),literal("rue"),newToken("boolean",!0);case"f":return read(),literal("alse"),newToken("boolean",!1);case"-":case"+":return"-"===read()&&(sign=-1),void(lexState="sign");case".":return buffer=read(),void(lexState="decimalPointLeading");case"0":return buffer=read(),void(lexState="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return buffer=read(),void(lexState="decimalInteger");case"I":return read(),literal("nfinity"),newToken("numeric",1/0);case"N":return read(),literal("aN"),newToken("numeric",NaN);case'"':case"'":return doubleQuote='"'===read(),buffer="",void(lexState="string")}throw invalidChar(read())},identifierNameStartEscape(){if("u"!==c)throw invalidChar(read());read();const u=unicodeEscape();switch(u){case"$":case"_":break;default:if(!util.isIdStartChar(u))throw invalidIdentifier()}buffer+=u,lexState="identifierName"},identifierName(){switch(c){case"$":case"_":case"‌":case"‍":return void(buffer+=read());case"\\":return read(),void(lexState="identifierNameEscape")}if(!util.isIdContinueChar(c))return newToken("identifier",buffer);buffer+=read()},identifierNameEscape(){if("u"!==c)throw invalidChar(read());read();const u=unicodeEscape();switch(u){case"$":case"_":case"‌":case"‍":break;default:if(!util.isIdContinueChar(u))throw invalidIdentifier()}buffer+=u,lexState="identifierName"},sign(){switch(c){case".":return buffer=read(),void(lexState="decimalPointLeading");case"0":return buffer=read(),void(lexState="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return buffer=read(),void(lexState="decimalInteger");case"I":return read(),literal("nfinity"),newToken("numeric",sign*(1/0));case"N":return read(),literal("aN"),newToken("numeric",NaN)}throw invalidChar(read())},zero(){switch(c){case".":return buffer+=read(),void(lexState="decimalPoint");case"e":case"E":return buffer+=read(),void(lexState="decimalExponent");case"x":case"X":return buffer+=read(),void(lexState="hexadecimal")}return newToken("numeric",0*sign)},decimalInteger(){switch(c){case".":return buffer+=read(),void(lexState="decimalPoint");case"e":case"E":return buffer+=read(),void(lexState="decimalExponent")}if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},decimalPointLeading(){if(util.isDigit(c))return buffer+=read(),void(lexState="decimalFraction");throw invalidChar(read())},decimalPoint(){switch(c){case"e":case"E":return buffer+=read(),void(lexState="decimalExponent")}return util.isDigit(c)?(buffer+=read(),void(lexState="decimalFraction")):newToken("numeric",sign*Number(buffer))},decimalFraction(){switch(c){case"e":case"E":return buffer+=read(),void(lexState="decimalExponent")}if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},decimalExponent(){switch(c){case"+":case"-":return buffer+=read(),void(lexState="decimalExponentSign")}if(util.isDigit(c))return buffer+=read(),void(lexState="decimalExponentInteger");throw invalidChar(read())},decimalExponentSign(){if(util.isDigit(c))return buffer+=read(),void(lexState="decimalExponentInteger");throw invalidChar(read())},decimalExponentInteger(){if(!util.isDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},hexadecimal(){if(util.isHexDigit(c))return buffer+=read(),void(lexState="hexadecimalInteger");throw invalidChar(read())},hexadecimalInteger(){if(!util.isHexDigit(c))return newToken("numeric",sign*Number(buffer));buffer+=read()},string(){switch(c){case"\\":return read(),void(buffer+=function(){switch(peek()){case"b":return read(),"\b";case"f":return read(),"\f";case"n":return read(),"\n";case"r":return read(),"\r";case"t":return read(),"\t";case"v":return read(),"\v";case"0":if(read(),util.isDigit(peek()))throw invalidChar(read());return"\0";case"x":return read(),function(){let buffer="",c=peek();if(!util.isHexDigit(c))throw invalidChar(read());if(buffer+=read(),c=peek(),!util.isHexDigit(c))throw invalidChar(read());return buffer+=read(),String.fromCodePoint(parseInt(buffer,16))}();case"u":return read(),unicodeEscape();case"\n":case"\u2028":case"\u2029":return read(),"";case"\r":return read(),"\n"===peek()&&read(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw invalidChar(read())}return read()}());case'"':return doubleQuote?(read(),newToken("string",buffer)):void(buffer+=read());case"'":return doubleQuote?void(buffer+=read()):(read(),newToken("string",buffer));case"\n":case"\r":throw invalidChar(read());case"\u2028":case"\u2029":!function(c){console.warn(`JSON5: '${formatChar(c)}' in strings is not valid ECMAScript; consider escaping`)}(c);break;case void 0:throw invalidChar(read())}buffer+=read()},start(){switch(c){case"{":case"[":return newToken("punctuator",read())}lexState="value"},beforePropertyName(){switch(c){case"$":case"_":return buffer=read(),void(lexState="identifierName");case"\\":return read(),void(lexState="identifierNameStartEscape");case"}":return newToken("punctuator",read());case'"':case"'":return doubleQuote='"'===read(),void(lexState="string")}if(util.isIdStartChar(c))return buffer+=read(),void(lexState="identifierName");throw invalidChar(read())},afterPropertyName(){if(":"===c)return newToken("punctuator",read());throw invalidChar(read())},beforePropertyValue(){lexState="value"},afterPropertyValue(){switch(c){case",":case"}":return newToken("punctuator",read())}throw invalidChar(read())},beforeArrayValue(){if("]"===c)return newToken("punctuator",read());lexState="value"},afterArrayValue(){switch(c){case",":case"]":return newToken("punctuator",read())}throw invalidChar(read())},end(){throw invalidChar(read())}};function newToken(type,value){return{type,value,line,column}}function literal(s){for(const c of s){if(peek()!==c)throw invalidChar(read());read()}}function unicodeEscape(){let buffer="",count=4;for(;count-- >0;){const c=peek();if(!util.isHexDigit(c))throw invalidChar(read());buffer+=read()}return String.fromCodePoint(parseInt(buffer,16))}const parseStates={start(){if("eof"===token.type)throw invalidEOF();push()},beforePropertyName(){switch(token.type){case"identifier":case"string":return key=token.value,void(parseState="afterPropertyName");case"punctuator":return void pop();case"eof":throw invalidEOF()}},afterPropertyName(){if("eof"===token.type)throw invalidEOF();parseState="beforePropertyValue"},beforePropertyValue(){if("eof"===token.type)throw invalidEOF();push()},beforeArrayValue(){if("eof"===token.type)throw invalidEOF();"punctuator"!==token.type||"]"!==token.value?push():pop()},afterPropertyValue(){if("eof"===token.type)throw invalidEOF();switch(token.value){case",":return void(parseState="beforePropertyName");case"}":pop()}},afterArrayValue(){if("eof"===token.type)throw invalidEOF();switch(token.value){case",":return void(parseState="beforeArrayValue");case"]":pop()}},end(){}};function push(){let value;switch(token.type){case"punctuator":switch(token.value){case"{":value={};break;case"[":value=[]}break;case"null":case"boolean":case"numeric":case"string":value=token.value}if(void 0===root)root=value;else{const parent=stack[stack.length-1];Array.isArray(parent)?parent.push(value):Object.defineProperty(parent,key,{value,writable:!0,enumerable:!0,configurable:!0})}if(null!==value&&"object"==typeof value)stack.push(value),parseState=Array.isArray(value)?"beforeArrayValue":"beforePropertyName";else{const current=stack[stack.length-1];parseState=null==current?"end":Array.isArray(current)?"afterArrayValue":"afterPropertyValue"}}function pop(){stack.pop();const current=stack[stack.length-1];parseState=null==current?"end":Array.isArray(current)?"afterArrayValue":"afterPropertyValue"}function invalidChar(c){return syntaxError(void 0===c?`JSON5: invalid end of input at ${line}:${column}`:`JSON5: invalid character '${formatChar(c)}' at ${line}:${column}`)}function invalidEOF(){return syntaxError(`JSON5: invalid end of input at ${line}:${column}`)}function invalidIdentifier(){return column-=5,syntaxError(`JSON5: invalid identifier character at ${line}:${column}`)}function formatChar(c){const replacements={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(replacements[c])return replacements[c];if(c<" "){const hexString=c.charCodeAt(0).toString(16);return"\\x"+("00"+hexString).substring(hexString.length)}return c}function syntaxError(message){const err=new SyntaxError(message);return err.lineNumber=line,err.columnNumber=column,err}const JSON5={parse:function(text,reviver){source=String(text),parseState="start",stack=[],pos=0,line=1,column=0,token=void 0,key=void 0,root=void 0;do{token=lex(),parseStates[parseState]()}while("eof"!==token.type);return"function"==typeof reviver?internalize({"":root},"",reviver):root},stringify:function(value,replacer,space){const stack=[];let propertyList,replacerFunc,quote,indent="",gap="";if(null==replacer||"object"!=typeof replacer||Array.isArray(replacer)||(space=replacer.space,quote=replacer.quote,replacer=replacer.replacer),"function"==typeof replacer)replacerFunc=replacer;else if(Array.isArray(replacer)){propertyList=[];for(const v of replacer){let item;"string"==typeof v?item=v:("number"==typeof v||v instanceof String||v instanceof Number)&&(item=String(v)),void 0!==item&&propertyList.indexOf(item)<0&&propertyList.push(item)}}return space instanceof Number?space=Number(space):space instanceof String&&(space=String(space)),"number"==typeof space?space>0&&(space=Math.min(10,Math.floor(space)),gap="          ".substr(0,space)):"string"==typeof space&&(gap=space.substr(0,10)),serializeProperty("",{"":value});function serializeProperty(key,holder){let value=holder[key];switch(null!=value&&("function"==typeof value.toJSON5?value=value.toJSON5(key):"function"==typeof value.toJSON&&(value=value.toJSON(key))),replacerFunc&&(value=replacerFunc.call(holder,key,value)),value instanceof Number?value=Number(value):value instanceof String?value=String(value):value instanceof Boolean&&(value=value.valueOf()),value){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof value?quoteString(value):"number"==typeof value?String(value):"object"==typeof value?Array.isArray(value)?function(value){if(stack.indexOf(value)>=0)throw TypeError("Converting circular structure to JSON5");stack.push(value);let stepback=indent;indent+=gap;let final,partial=[];for(let i=0;i<value.length;i++){const propertyString=serializeProperty(String(i),value);partial.push(void 0!==propertyString?propertyString:"null")}if(0===partial.length)final="[]";else if(""===gap){final="["+partial.join(",")+"]"}else{let separator=",\n"+indent,properties=partial.join(separator);final="[\n"+indent+properties+",\n"+stepback+"]"}return stack.pop(),indent=stepback,final}(value):function(value){if(stack.indexOf(value)>=0)throw TypeError("Converting circular structure to JSON5");stack.push(value);let stepback=indent;indent+=gap;let final,keys=propertyList||Object.keys(value),partial=[];for(const key of keys){const propertyString=serializeProperty(key,value);if(void 0!==propertyString){let member=serializeKey(key)+":";""!==gap&&(member+=" "),member+=propertyString,partial.push(member)}}if(0===partial.length)final="{}";else{let properties;if(""===gap)properties=partial.join(","),final="{"+properties+"}";else{let separator=",\n"+indent;properties=partial.join(separator),final="{\n"+indent+properties+",\n"+stepback+"}"}}return stack.pop(),indent=stepback,final}(value):void 0}function quoteString(value){const quotes={"'":.1,'"':.2},replacements={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};let product="";for(let i=0;i<value.length;i++){const c=value[i];switch(c){case"'":case'"':quotes[c]++,product+=c;continue;case"\0":if(util.isDigit(value[i+1])){product+="\\x00";continue}}if(replacements[c])product+=replacements[c];else if(c<" "){let hexString=c.charCodeAt(0).toString(16);product+="\\x"+("00"+hexString).substring(hexString.length)}else product+=c}const quoteChar=quote||Object.keys(quotes).reduce(((a,b)=>quotes[a]<quotes[b]?a:b));return product=product.replace(new RegExp(quoteChar,"g"),replacements[quoteChar]),quoteChar+product+quoteChar}function serializeKey(key){if(0===key.length)return quoteString(key);const firstChar=String.fromCodePoint(key.codePointAt(0));if(!util.isIdStartChar(firstChar))return quoteString(key);for(let i=firstChar.length;i<key.length;i++)if(!util.isIdContinueChar(String.fromCodePoint(key.codePointAt(i))))return quoteString(key);return key}}};const __WEBPACK_DEFAULT_EXPORT__=JSON5},"./node_modules/.pnpm/@babel+preset-typescript@7.26.0_@babel+core@7.26.0/node_modules/@babel/preset-typescript/package.json":module=>{"use strict";module.exports=JSON.parse('{"name":"@babel/preset-typescript","version":"7.26.0","description":"Babel preset for TypeScript.","repository":{"type":"git","url":"https://github.com/babel/babel.git","directory":"packages/babel-preset-typescript"},"license":"MIT","publishConfig":{"access":"public"},"main":"./lib/index.js","keywords":["babel-preset","typescript"],"dependencies":{"@babel/helper-plugin-utils":"^7.25.9","@babel/helper-validator-option":"^7.25.9","@babel/plugin-syntax-jsx":"^7.25.9","@babel/plugin-transform-modules-commonjs":"^7.25.9","@babel/plugin-transform-typescript":"^7.25.9"},"peerDependencies":{"@babel/core":"^7.0.0-0"},"devDependencies":{"@babel/core":"^7.26.0","@babel/helper-plugin-test-runner":"^7.25.9"},"homepage":"https://babel.dev/docs/en/next/babel-preset-typescript","bugs":"https://github.com/babel/babel/issues?utf8=%E2%9C%93&q=is%3Aissue+label%3A%22area%3A%20typescript%22+is%3Aopen","engines":{"node":">=6.9.0"},"author":"The Babel Team (https://babel.dev/team)","type":"commonjs"}')},"./node_modules/.pnpm/globals@11.12.0/node_modules/globals/globals.json":module=>{"use strict";module.exports=JSON.parse('{"builtin":{"Array":false,"ArrayBuffer":false,"Atomics":false,"BigInt":false,"BigInt64Array":false,"BigUint64Array":false,"Boolean":false,"constructor":false,"DataView":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Float32Array":false,"Float64Array":false,"Function":false,"globalThis":false,"hasOwnProperty":false,"Infinity":false,"Int16Array":false,"Int32Array":false,"Int8Array":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Map":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"Promise":false,"propertyIsEnumerable":false,"Proxy":false,"RangeError":false,"ReferenceError":false,"Reflect":false,"RegExp":false,"Set":false,"SharedArrayBuffer":false,"String":false,"Symbol":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"Uint16Array":false,"Uint32Array":false,"Uint8Array":false,"Uint8ClampedArray":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false,"WeakMap":false,"WeakSet":false},"es5":{"Array":false,"Boolean":false,"constructor":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Function":false,"hasOwnProperty":false,"Infinity":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"propertyIsEnumerable":false,"RangeError":false,"ReferenceError":false,"RegExp":false,"String":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false},"es2015":{"Array":false,"ArrayBuffer":false,"Boolean":false,"constructor":false,"DataView":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Float32Array":false,"Float64Array":false,"Function":false,"hasOwnProperty":false,"Infinity":false,"Int16Array":false,"Int32Array":false,"Int8Array":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Map":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"Promise":false,"propertyIsEnumerable":false,"Proxy":false,"RangeError":false,"ReferenceError":false,"Reflect":false,"RegExp":false,"Set":false,"String":false,"Symbol":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"Uint16Array":false,"Uint32Array":false,"Uint8Array":false,"Uint8ClampedArray":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false,"WeakMap":false,"WeakSet":false},"es2017":{"Array":false,"ArrayBuffer":false,"Atomics":false,"Boolean":false,"constructor":false,"DataView":false,"Date":false,"decodeURI":false,"decodeURIComponent":false,"encodeURI":false,"encodeURIComponent":false,"Error":false,"escape":false,"eval":false,"EvalError":false,"Float32Array":false,"Float64Array":false,"Function":false,"hasOwnProperty":false,"Infinity":false,"Int16Array":false,"Int32Array":false,"Int8Array":false,"isFinite":false,"isNaN":false,"isPrototypeOf":false,"JSON":false,"Map":false,"Math":false,"NaN":false,"Number":false,"Object":false,"parseFloat":false,"parseInt":false,"Promise":false,"propertyIsEnumerable":false,"Proxy":false,"RangeError":false,"ReferenceError":false,"Reflect":false,"RegExp":false,"Set":false,"SharedArrayBuffer":false,"String":false,"Symbol":false,"SyntaxError":false,"toLocaleString":false,"toString":false,"TypeError":false,"Uint16Array":false,"Uint32Array":false,"Uint8Array":false,"Uint8ClampedArray":false,"undefined":false,"unescape":false,"URIError":false,"valueOf":false,"WeakMap":false,"WeakSet":false},"browser":{"AbortController":false,"AbortSignal":false,"addEventListener":false,"alert":false,"AnalyserNode":false,"Animation":false,"AnimationEffectReadOnly":false,"AnimationEffectTiming":false,"AnimationEffectTimingReadOnly":false,"AnimationEvent":false,"AnimationPlaybackEvent":false,"AnimationTimeline":false,"applicationCache":false,"ApplicationCache":false,"ApplicationCacheErrorEvent":false,"atob":false,"Attr":false,"Audio":false,"AudioBuffer":false,"AudioBufferSourceNode":false,"AudioContext":false,"AudioDestinationNode":false,"AudioListener":false,"AudioNode":false,"AudioParam":false,"AudioProcessingEvent":false,"AudioScheduledSourceNode":false,"AudioWorkletGlobalScope ":false,"AudioWorkletNode":false,"AudioWorkletProcessor":false,"BarProp":false,"BaseAudioContext":false,"BatteryManager":false,"BeforeUnloadEvent":false,"BiquadFilterNode":false,"Blob":false,"BlobEvent":false,"blur":false,"BroadcastChannel":false,"btoa":false,"BudgetService":false,"ByteLengthQueuingStrategy":false,"Cache":false,"caches":false,"CacheStorage":false,"cancelAnimationFrame":false,"cancelIdleCallback":false,"CanvasCaptureMediaStreamTrack":false,"CanvasGradient":false,"CanvasPattern":false,"CanvasRenderingContext2D":false,"ChannelMergerNode":false,"ChannelSplitterNode":false,"CharacterData":false,"clearInterval":false,"clearTimeout":false,"clientInformation":false,"ClipboardEvent":false,"close":false,"closed":false,"CloseEvent":false,"Comment":false,"CompositionEvent":false,"confirm":false,"console":false,"ConstantSourceNode":false,"ConvolverNode":false,"CountQueuingStrategy":false,"createImageBitmap":false,"Credential":false,"CredentialsContainer":false,"crypto":false,"Crypto":false,"CryptoKey":false,"CSS":false,"CSSConditionRule":false,"CSSFontFaceRule":false,"CSSGroupingRule":false,"CSSImportRule":false,"CSSKeyframeRule":false,"CSSKeyframesRule":false,"CSSMediaRule":false,"CSSNamespaceRule":false,"CSSPageRule":false,"CSSRule":false,"CSSRuleList":false,"CSSStyleDeclaration":false,"CSSStyleRule":false,"CSSStyleSheet":false,"CSSSupportsRule":false,"CustomElementRegistry":false,"customElements":false,"CustomEvent":false,"DataTransfer":false,"DataTransferItem":false,"DataTransferItemList":false,"defaultstatus":false,"defaultStatus":false,"DelayNode":false,"DeviceMotionEvent":false,"DeviceOrientationEvent":false,"devicePixelRatio":false,"dispatchEvent":false,"document":false,"Document":false,"DocumentFragment":false,"DocumentType":false,"DOMError":false,"DOMException":false,"DOMImplementation":false,"DOMMatrix":false,"DOMMatrixReadOnly":false,"DOMParser":false,"DOMPoint":false,"DOMPointReadOnly":false,"DOMQuad":false,"DOMRect":false,"DOMRectReadOnly":false,"DOMStringList":false,"DOMStringMap":false,"DOMTokenList":false,"DragEvent":false,"DynamicsCompressorNode":false,"Element":false,"ErrorEvent":false,"event":false,"Event":false,"EventSource":false,"EventTarget":false,"external":false,"fetch":false,"File":false,"FileList":false,"FileReader":false,"find":false,"focus":false,"FocusEvent":false,"FontFace":false,"FontFaceSetLoadEvent":false,"FormData":false,"frameElement":false,"frames":false,"GainNode":false,"Gamepad":false,"GamepadButton":false,"GamepadEvent":false,"getComputedStyle":false,"getSelection":false,"HashChangeEvent":false,"Headers":false,"history":false,"History":false,"HTMLAllCollection":false,"HTMLAnchorElement":false,"HTMLAreaElement":false,"HTMLAudioElement":false,"HTMLBaseElement":false,"HTMLBodyElement":false,"HTMLBRElement":false,"HTMLButtonElement":false,"HTMLCanvasElement":false,"HTMLCollection":false,"HTMLContentElement":false,"HTMLDataElement":false,"HTMLDataListElement":false,"HTMLDetailsElement":false,"HTMLDialogElement":false,"HTMLDirectoryElement":false,"HTMLDivElement":false,"HTMLDListElement":false,"HTMLDocument":false,"HTMLElement":false,"HTMLEmbedElement":false,"HTMLFieldSetElement":false,"HTMLFontElement":false,"HTMLFormControlsCollection":false,"HTMLFormElement":false,"HTMLFrameElement":false,"HTMLFrameSetElement":false,"HTMLHeadElement":false,"HTMLHeadingElement":false,"HTMLHRElement":false,"HTMLHtmlElement":false,"HTMLIFrameElement":false,"HTMLImageElement":false,"HTMLInputElement":false,"HTMLLabelElement":false,"HTMLLegendElement":false,"HTMLLIElement":false,"HTMLLinkElement":false,"HTMLMapElement":false,"HTMLMarqueeElement":false,"HTMLMediaElement":false,"HTMLMenuElement":false,"HTMLMetaElement":false,"HTMLMeterElement":false,"HTMLModElement":false,"HTMLObjectElement":false,"HTMLOListElement":false,"HTMLOptGroupElement":false,"HTMLOptionElement":false,"HTMLOptionsCollection":false,"HTMLOutputElement":false,"HTMLParagraphElement":false,"HTMLParamElement":false,"HTMLPictureElement":false,"HTMLPreElement":false,"HTMLProgressElement":false,"HTMLQuoteElement":false,"HTMLScriptElement":false,"HTMLSelectElement":false,"HTMLShadowElement":false,"HTMLSlotElement":false,"HTMLSourceElement":false,"HTMLSpanElement":false,"HTMLStyleElement":false,"HTMLTableCaptionElement":false,"HTMLTableCellElement":false,"HTMLTableColElement":false,"HTMLTableElement":false,"HTMLTableRowElement":false,"HTMLTableSectionElement":false,"HTMLTemplateElement":false,"HTMLTextAreaElement":false,"HTMLTimeElement":false,"HTMLTitleElement":false,"HTMLTrackElement":false,"HTMLUListElement":false,"HTMLUnknownElement":false,"HTMLVideoElement":false,"IDBCursor":false,"IDBCursorWithValue":false,"IDBDatabase":false,"IDBFactory":false,"IDBIndex":false,"IDBKeyRange":false,"IDBObjectStore":false,"IDBOpenDBRequest":false,"IDBRequest":false,"IDBTransaction":false,"IDBVersionChangeEvent":false,"IdleDeadline":false,"IIRFilterNode":false,"Image":false,"ImageBitmap":false,"ImageBitmapRenderingContext":false,"ImageCapture":false,"ImageData":false,"indexedDB":false,"innerHeight":false,"innerWidth":false,"InputEvent":false,"IntersectionObserver":false,"IntersectionObserverEntry":false,"Intl":false,"isSecureContext":false,"KeyboardEvent":false,"KeyframeEffect":false,"KeyframeEffectReadOnly":false,"length":false,"localStorage":false,"location":true,"Location":false,"locationbar":false,"matchMedia":false,"MediaDeviceInfo":false,"MediaDevices":false,"MediaElementAudioSourceNode":false,"MediaEncryptedEvent":false,"MediaError":false,"MediaKeyMessageEvent":false,"MediaKeySession":false,"MediaKeyStatusMap":false,"MediaKeySystemAccess":false,"MediaList":false,"MediaQueryList":false,"MediaQueryListEvent":false,"MediaRecorder":false,"MediaSettingsRange":false,"MediaSource":false,"MediaStream":false,"MediaStreamAudioDestinationNode":false,"MediaStreamAudioSourceNode":false,"MediaStreamEvent":false,"MediaStreamTrack":false,"MediaStreamTrackEvent":false,"menubar":false,"MessageChannel":false,"MessageEvent":false,"MessagePort":false,"MIDIAccess":false,"MIDIConnectionEvent":false,"MIDIInput":false,"MIDIInputMap":false,"MIDIMessageEvent":false,"MIDIOutput":false,"MIDIOutputMap":false,"MIDIPort":false,"MimeType":false,"MimeTypeArray":false,"MouseEvent":false,"moveBy":false,"moveTo":false,"MutationEvent":false,"MutationObserver":false,"MutationRecord":false,"name":false,"NamedNodeMap":false,"NavigationPreloadManager":false,"navigator":false,"Navigator":false,"NetworkInformation":false,"Node":false,"NodeFilter":false,"NodeIterator":false,"NodeList":false,"Notification":false,"OfflineAudioCompletionEvent":false,"OfflineAudioContext":false,"offscreenBuffering":false,"OffscreenCanvas":true,"onabort":true,"onafterprint":true,"onanimationend":true,"onanimationiteration":true,"onanimationstart":true,"onappinstalled":true,"onauxclick":true,"onbeforeinstallprompt":true,"onbeforeprint":true,"onbeforeunload":true,"onblur":true,"oncancel":true,"oncanplay":true,"oncanplaythrough":true,"onchange":true,"onclick":true,"onclose":true,"oncontextmenu":true,"oncuechange":true,"ondblclick":true,"ondevicemotion":true,"ondeviceorientation":true,"ondeviceorientationabsolute":true,"ondrag":true,"ondragend":true,"ondragenter":true,"ondragleave":true,"ondragover":true,"ondragstart":true,"ondrop":true,"ondurationchange":true,"onemptied":true,"onended":true,"onerror":true,"onfocus":true,"ongotpointercapture":true,"onhashchange":true,"oninput":true,"oninvalid":true,"onkeydown":true,"onkeypress":true,"onkeyup":true,"onlanguagechange":true,"onload":true,"onloadeddata":true,"onloadedmetadata":true,"onloadstart":true,"onlostpointercapture":true,"onmessage":true,"onmessageerror":true,"onmousedown":true,"onmouseenter":true,"onmouseleave":true,"onmousemove":true,"onmouseout":true,"onmouseover":true,"onmouseup":true,"onmousewheel":true,"onoffline":true,"ononline":true,"onpagehide":true,"onpageshow":true,"onpause":true,"onplay":true,"onplaying":true,"onpointercancel":true,"onpointerdown":true,"onpointerenter":true,"onpointerleave":true,"onpointermove":true,"onpointerout":true,"onpointerover":true,"onpointerup":true,"onpopstate":true,"onprogress":true,"onratechange":true,"onrejectionhandled":true,"onreset":true,"onresize":true,"onscroll":true,"onsearch":true,"onseeked":true,"onseeking":true,"onselect":true,"onstalled":true,"onstorage":true,"onsubmit":true,"onsuspend":true,"ontimeupdate":true,"ontoggle":true,"ontransitionend":true,"onunhandledrejection":true,"onunload":true,"onvolumechange":true,"onwaiting":true,"onwheel":true,"open":false,"openDatabase":false,"opener":false,"Option":false,"origin":false,"OscillatorNode":false,"outerHeight":false,"outerWidth":false,"PageTransitionEvent":false,"pageXOffset":false,"pageYOffset":false,"PannerNode":false,"parent":false,"Path2D":false,"PaymentAddress":false,"PaymentRequest":false,"PaymentRequestUpdateEvent":false,"PaymentResponse":false,"performance":false,"Performance":false,"PerformanceEntry":false,"PerformanceLongTaskTiming":false,"PerformanceMark":false,"PerformanceMeasure":false,"PerformanceNavigation":false,"PerformanceNavigationTiming":false,"PerformanceObserver":false,"PerformanceObserverEntryList":false,"PerformancePaintTiming":false,"PerformanceResourceTiming":false,"PerformanceTiming":false,"PeriodicWave":false,"Permissions":false,"PermissionStatus":false,"personalbar":false,"PhotoCapabilities":false,"Plugin":false,"PluginArray":false,"PointerEvent":false,"PopStateEvent":false,"postMessage":false,"Presentation":false,"PresentationAvailability":false,"PresentationConnection":false,"PresentationConnectionAvailableEvent":false,"PresentationConnectionCloseEvent":false,"PresentationConnectionList":false,"PresentationReceiver":false,"PresentationRequest":false,"print":false,"ProcessingInstruction":false,"ProgressEvent":false,"PromiseRejectionEvent":false,"prompt":false,"PushManager":false,"PushSubscription":false,"PushSubscriptionOptions":false,"queueMicrotask":false,"RadioNodeList":false,"Range":false,"ReadableStream":false,"registerProcessor":false,"RemotePlayback":false,"removeEventListener":false,"Request":false,"requestAnimationFrame":false,"requestIdleCallback":false,"resizeBy":false,"ResizeObserver":false,"ResizeObserverEntry":false,"resizeTo":false,"Response":false,"RTCCertificate":false,"RTCDataChannel":false,"RTCDataChannelEvent":false,"RTCDtlsTransport":false,"RTCIceCandidate":false,"RTCIceGatherer":false,"RTCIceTransport":false,"RTCPeerConnection":false,"RTCPeerConnectionIceEvent":false,"RTCRtpContributingSource":false,"RTCRtpReceiver":false,"RTCRtpSender":false,"RTCSctpTransport":false,"RTCSessionDescription":false,"RTCStatsReport":false,"RTCTrackEvent":false,"screen":false,"Screen":false,"screenLeft":false,"ScreenOrientation":false,"screenTop":false,"screenX":false,"screenY":false,"ScriptProcessorNode":false,"scroll":false,"scrollbars":false,"scrollBy":false,"scrollTo":false,"scrollX":false,"scrollY":false,"SecurityPolicyViolationEvent":false,"Selection":false,"self":false,"ServiceWorker":false,"ServiceWorkerContainer":false,"ServiceWorkerRegistration":false,"sessionStorage":false,"setInterval":false,"setTimeout":false,"ShadowRoot":false,"SharedWorker":false,"SourceBuffer":false,"SourceBufferList":false,"speechSynthesis":false,"SpeechSynthesisEvent":false,"SpeechSynthesisUtterance":false,"StaticRange":false,"status":false,"statusbar":false,"StereoPannerNode":false,"stop":false,"Storage":false,"StorageEvent":false,"StorageManager":false,"styleMedia":false,"StyleSheet":false,"StyleSheetList":false,"SubtleCrypto":false,"SVGAElement":false,"SVGAngle":false,"SVGAnimatedAngle":false,"SVGAnimatedBoolean":false,"SVGAnimatedEnumeration":false,"SVGAnimatedInteger":false,"SVGAnimatedLength":false,"SVGAnimatedLengthList":false,"SVGAnimatedNumber":false,"SVGAnimatedNumberList":false,"SVGAnimatedPreserveAspectRatio":false,"SVGAnimatedRect":false,"SVGAnimatedString":false,"SVGAnimatedTransformList":false,"SVGAnimateElement":false,"SVGAnimateMotionElement":false,"SVGAnimateTransformElement":false,"SVGAnimationElement":false,"SVGCircleElement":false,"SVGClipPathElement":false,"SVGComponentTransferFunctionElement":false,"SVGDefsElement":false,"SVGDescElement":false,"SVGDiscardElement":false,"SVGElement":false,"SVGEllipseElement":false,"SVGFEBlendElement":false,"SVGFEColorMatrixElement":false,"SVGFEComponentTransferElement":false,"SVGFECompositeElement":false,"SVGFEConvolveMatrixElement":false,"SVGFEDiffuseLightingElement":false,"SVGFEDisplacementMapElement":false,"SVGFEDistantLightElement":false,"SVGFEDropShadowElement":false,"SVGFEFloodElement":false,"SVGFEFuncAElement":false,"SVGFEFuncBElement":false,"SVGFEFuncGElement":false,"SVGFEFuncRElement":false,"SVGFEGaussianBlurElement":false,"SVGFEImageElement":false,"SVGFEMergeElement":false,"SVGFEMergeNodeElement":false,"SVGFEMorphologyElement":false,"SVGFEOffsetElement":false,"SVGFEPointLightElement":false,"SVGFESpecularLightingElement":false,"SVGFESpotLightElement":false,"SVGFETileElement":false,"SVGFETurbulenceElement":false,"SVGFilterElement":false,"SVGForeignObjectElement":false,"SVGGElement":false,"SVGGeometryElement":false,"SVGGradientElement":false,"SVGGraphicsElement":false,"SVGImageElement":false,"SVGLength":false,"SVGLengthList":false,"SVGLinearGradientElement":false,"SVGLineElement":false,"SVGMarkerElement":false,"SVGMaskElement":false,"SVGMatrix":false,"SVGMetadataElement":false,"SVGMPathElement":false,"SVGNumber":false,"SVGNumberList":false,"SVGPathElement":false,"SVGPatternElement":false,"SVGPoint":false,"SVGPointList":false,"SVGPolygonElement":false,"SVGPolylineElement":false,"SVGPreserveAspectRatio":false,"SVGRadialGradientElement":false,"SVGRect":false,"SVGRectElement":false,"SVGScriptElement":false,"SVGSetElement":false,"SVGStopElement":false,"SVGStringList":false,"SVGStyleElement":false,"SVGSVGElement":false,"SVGSwitchElement":false,"SVGSymbolElement":false,"SVGTextContentElement":false,"SVGTextElement":false,"SVGTextPathElement":false,"SVGTextPositioningElement":false,"SVGTitleElement":false,"SVGTransform":false,"SVGTransformList":false,"SVGTSpanElement":false,"SVGUnitTypes":false,"SVGUseElement":false,"SVGViewElement":false,"TaskAttributionTiming":false,"Text":false,"TextDecoder":false,"TextEncoder":false,"TextEvent":false,"TextMetrics":false,"TextTrack":false,"TextTrackCue":false,"TextTrackCueList":false,"TextTrackList":false,"TimeRanges":false,"toolbar":false,"top":false,"Touch":false,"TouchEvent":false,"TouchList":false,"TrackEvent":false,"TransitionEvent":false,"TreeWalker":false,"UIEvent":false,"URL":false,"URLSearchParams":false,"ValidityState":false,"visualViewport":false,"VisualViewport":false,"VTTCue":false,"WaveShaperNode":false,"WebAssembly":false,"WebGL2RenderingContext":false,"WebGLActiveInfo":false,"WebGLBuffer":false,"WebGLContextEvent":false,"WebGLFramebuffer":false,"WebGLProgram":false,"WebGLQuery":false,"WebGLRenderbuffer":false,"WebGLRenderingContext":false,"WebGLSampler":false,"WebGLShader":false,"WebGLShaderPrecisionFormat":false,"WebGLSync":false,"WebGLTexture":false,"WebGLTransformFeedback":false,"WebGLUniformLocation":false,"WebGLVertexArrayObject":false,"WebSocket":false,"WheelEvent":false,"window":false,"Window":false,"Worker":false,"WritableStream":false,"XMLDocument":false,"XMLHttpRequest":false,"XMLHttpRequestEventTarget":false,"XMLHttpRequestUpload":false,"XMLSerializer":false,"XPathEvaluator":false,"XPathExpression":false,"XPathResult":false,"XSLTProcessor":false},"worker":{"addEventListener":false,"applicationCache":false,"atob":false,"Blob":false,"BroadcastChannel":false,"btoa":false,"Cache":false,"caches":false,"clearInterval":false,"clearTimeout":false,"close":true,"console":false,"fetch":false,"FileReaderSync":false,"FormData":false,"Headers":false,"IDBCursor":false,"IDBCursorWithValue":false,"IDBDatabase":false,"IDBFactory":false,"IDBIndex":false,"IDBKeyRange":false,"IDBObjectStore":false,"IDBOpenDBRequest":false,"IDBRequest":false,"IDBTransaction":false,"IDBVersionChangeEvent":false,"ImageData":false,"importScripts":true,"indexedDB":false,"location":false,"MessageChannel":false,"MessagePort":false,"name":false,"navigator":false,"Notification":false,"onclose":true,"onconnect":true,"onerror":true,"onlanguagechange":true,"onmessage":true,"onoffline":true,"ononline":true,"onrejectionhandled":true,"onunhandledrejection":true,"performance":false,"Performance":false,"PerformanceEntry":false,"PerformanceMark":false,"PerformanceMeasure":false,"PerformanceNavigation":false,"PerformanceResourceTiming":false,"PerformanceTiming":false,"postMessage":true,"Promise":false,"queueMicrotask":false,"removeEventListener":false,"Request":false,"Response":false,"self":true,"ServiceWorkerRegistration":false,"setInterval":false,"setTimeout":false,"TextDecoder":false,"TextEncoder":false,"URL":false,"URLSearchParams":false,"WebSocket":false,"Worker":false,"WorkerGlobalScope":false,"XMLHttpRequest":false},"node":{"__dirname":false,"__filename":false,"Buffer":false,"clearImmediate":false,"clearInterval":false,"clearTimeout":false,"console":false,"exports":true,"global":false,"Intl":false,"module":false,"process":false,"queueMicrotask":false,"require":false,"setImmediate":false,"setInterval":false,"setTimeout":false,"TextDecoder":false,"TextEncoder":false,"URL":false,"URLSearchParams":false},"commonjs":{"exports":true,"global":false,"module":false,"require":false},"amd":{"define":false,"require":false},"mocha":{"after":false,"afterEach":false,"before":false,"beforeEach":false,"context":false,"describe":false,"it":false,"mocha":false,"run":false,"setup":false,"specify":false,"suite":false,"suiteSetup":false,"suiteTeardown":false,"teardown":false,"test":false,"xcontext":false,"xdescribe":false,"xit":false,"xspecify":false},"jasmine":{"afterAll":false,"afterEach":false,"beforeAll":false,"beforeEach":false,"describe":false,"expect":false,"fail":false,"fdescribe":false,"fit":false,"it":false,"jasmine":false,"pending":false,"runs":false,"spyOn":false,"spyOnProperty":false,"waits":false,"waitsFor":false,"xdescribe":false,"xit":false},"jest":{"afterAll":false,"afterEach":false,"beforeAll":false,"beforeEach":false,"describe":false,"expect":false,"fdescribe":false,"fit":false,"it":false,"jest":false,"pit":false,"require":false,"test":false,"xdescribe":false,"xit":false,"xtest":false},"qunit":{"asyncTest":false,"deepEqual":false,"equal":false,"expect":false,"module":false,"notDeepEqual":false,"notEqual":false,"notOk":false,"notPropEqual":false,"notStrictEqual":false,"ok":false,"propEqual":false,"QUnit":false,"raises":false,"start":false,"stop":false,"strictEqual":false,"test":false,"throws":false},"phantomjs":{"console":true,"exports":true,"phantom":true,"require":true,"WebPage":true},"couch":{"emit":false,"exports":false,"getRow":false,"log":false,"module":false,"provides":false,"require":false,"respond":false,"send":false,"start":false,"sum":false},"rhino":{"defineClass":false,"deserialize":false,"gc":false,"help":false,"importClass":false,"importPackage":false,"java":false,"load":false,"loadClass":false,"Packages":false,"print":false,"quit":false,"readFile":false,"readUrl":false,"runCommand":false,"seal":false,"serialize":false,"spawn":false,"sync":false,"toint32":false,"version":false},"nashorn":{"__DIR__":false,"__FILE__":false,"__LINE__":false,"com":false,"edu":false,"exit":false,"java":false,"Java":false,"javafx":false,"JavaImporter":false,"javax":false,"JSAdapter":false,"load":false,"loadWithNewGlobal":false,"org":false,"Packages":false,"print":false,"quit":false},"wsh":{"ActiveXObject":true,"Enumerator":true,"GetObject":true,"ScriptEngine":true,"ScriptEngineBuildVersion":true,"ScriptEngineMajorVersion":true,"ScriptEngineMinorVersion":true,"VBArray":true,"WScript":true,"WSH":true,"XDomainRequest":true},"jquery":{"$":false,"jQuery":false},"yui":{"YAHOO":false,"YAHOO_config":false,"YUI":false,"YUI_config":false},"shelljs":{"cat":false,"cd":false,"chmod":false,"config":false,"cp":false,"dirs":false,"echo":false,"env":false,"error":false,"exec":false,"exit":false,"find":false,"grep":false,"ln":false,"ls":false,"mkdir":false,"mv":false,"popd":false,"pushd":false,"pwd":false,"rm":false,"sed":false,"set":false,"target":false,"tempdir":false,"test":false,"touch":false,"which":false},"prototypejs":{"$":false,"$$":false,"$A":false,"$break":false,"$continue":false,"$F":false,"$H":false,"$R":false,"$w":false,"Abstract":false,"Ajax":false,"Autocompleter":false,"Builder":false,"Class":false,"Control":false,"Draggable":false,"Draggables":false,"Droppables":false,"Effect":false,"Element":false,"Enumerable":false,"Event":false,"Field":false,"Form":false,"Hash":false,"Insertion":false,"ObjectRange":false,"PeriodicalExecuter":false,"Position":false,"Prototype":false,"Scriptaculous":false,"Selector":false,"Sortable":false,"SortableObserver":false,"Sound":false,"Template":false,"Toggle":false,"Try":false},"meteor":{"_":false,"$":false,"Accounts":false,"AccountsClient":false,"AccountsCommon":false,"AccountsServer":false,"App":false,"Assets":false,"Blaze":false,"check":false,"Cordova":false,"DDP":false,"DDPRateLimiter":false,"DDPServer":false,"Deps":false,"EJSON":false,"Email":false,"HTTP":false,"Log":false,"Match":false,"Meteor":false,"Mongo":false,"MongoInternals":false,"Npm":false,"Package":false,"Plugin":false,"process":false,"Random":false,"ReactiveDict":false,"ReactiveVar":false,"Router":false,"ServiceConfiguration":false,"Session":false,"share":false,"Spacebars":false,"Template":false,"Tinytest":false,"Tracker":false,"UI":false,"Utils":false,"WebApp":false,"WebAppInternals":false},"mongo":{"_isWindows":false,"_rand":false,"BulkWriteResult":false,"cat":false,"cd":false,"connect":false,"db":false,"getHostName":false,"getMemInfo":false,"hostname":false,"ISODate":false,"listFiles":false,"load":false,"ls":false,"md5sumFile":false,"mkdir":false,"Mongo":false,"NumberInt":false,"NumberLong":false,"ObjectId":false,"PlanCache":false,"print":false,"printjson":false,"pwd":false,"quit":false,"removeFile":false,"rs":false,"sh":false,"UUID":false,"version":false,"WriteResult":false},"applescript":{"$":false,"Application":false,"Automation":false,"console":false,"delay":false,"Library":false,"ObjC":false,"ObjectSpecifier":false,"Path":false,"Progress":false,"Ref":false},"serviceworker":{"addEventListener":false,"applicationCache":false,"atob":false,"Blob":false,"BroadcastChannel":false,"btoa":false,"Cache":false,"caches":false,"CacheStorage":false,"clearInterval":false,"clearTimeout":false,"Client":false,"clients":false,"Clients":false,"close":true,"console":false,"ExtendableEvent":false,"ExtendableMessageEvent":false,"fetch":false,"FetchEvent":false,"FileReaderSync":false,"FormData":false,"Headers":false,"IDBCursor":false,"IDBCursorWithValue":false,"IDBDatabase":false,"IDBFactory":false,"IDBIndex":false,"IDBKeyRange":false,"IDBObjectStore":false,"IDBOpenDBRequest":false,"IDBRequest":false,"IDBTransaction":false,"IDBVersionChangeEvent":false,"ImageData":false,"importScripts":false,"indexedDB":false,"location":false,"MessageChannel":false,"MessagePort":false,"name":false,"navigator":false,"Notification":false,"onclose":true,"onconnect":true,"onerror":true,"onfetch":true,"oninstall":true,"onlanguagechange":true,"onmessage":true,"onmessageerror":true,"onnotificationclick":true,"onnotificationclose":true,"onoffline":true,"ononline":true,"onpush":true,"onpushsubscriptionchange":true,"onrejectionhandled":true,"onsync":true,"onunhandledrejection":true,"performance":false,"Performance":false,"PerformanceEntry":false,"PerformanceMark":false,"PerformanceMeasure":false,"PerformanceNavigation":false,"PerformanceResourceTiming":false,"PerformanceTiming":false,"postMessage":true,"Promise":false,"queueMicrotask":false,"registration":false,"removeEventListener":false,"Request":false,"Response":false,"self":false,"ServiceWorker":false,"ServiceWorkerContainer":false,"ServiceWorkerGlobalScope":false,"ServiceWorkerMessageEvent":false,"ServiceWorkerRegistration":false,"setInterval":false,"setTimeout":false,"skipWaiting":false,"TextDecoder":false,"TextEncoder":false,"URL":false,"URLSearchParams":false,"WebSocket":false,"WindowClient":false,"Worker":false,"WorkerGlobalScope":false,"XMLHttpRequest":false},"atomtest":{"advanceClock":false,"fakeClearInterval":false,"fakeClearTimeout":false,"fakeSetInterval":false,"fakeSetTimeout":false,"resetTimeouts":false,"waitsForPromise":false},"embertest":{"andThen":false,"click":false,"currentPath":false,"currentRouteName":false,"currentURL":false,"fillIn":false,"find":false,"findAll":false,"findWithAssert":false,"keyEvent":false,"pauseTest":false,"resumeTest":false,"triggerEvent":false,"visit":false,"wait":false},"protractor":{"$":false,"$$":false,"browser":false,"by":false,"By":false,"DartObject":false,"element":false,"protractor":false},"shared-node-browser":{"clearInterval":false,"clearTimeout":false,"console":false,"setInterval":false,"setTimeout":false,"URL":false,"URLSearchParams":false},"webextensions":{"browser":false,"chrome":false,"opr":false},"greasemonkey":{"cloneInto":false,"createObjectIn":false,"exportFunction":false,"GM":false,"GM_addStyle":false,"GM_deleteValue":false,"GM_getResourceText":false,"GM_getResourceURL":false,"GM_getValue":false,"GM_info":false,"GM_listValues":false,"GM_log":false,"GM_openInTab":false,"GM_registerMenuCommand":false,"GM_setClipboard":false,"GM_setValue":false,"GM_xmlhttpRequest":false,"unsafeWindow":false},"devtools":{"$":false,"$_":false,"$$":false,"$0":false,"$1":false,"$2":false,"$3":false,"$4":false,"$x":false,"chrome":false,"clear":false,"copy":false,"debug":false,"dir":false,"dirxml":false,"getEventListeners":false,"inspect":false,"keys":false,"monitor":false,"monitorEvents":false,"profile":false,"profileEnd":false,"queryObjects":false,"table":false,"undebug":false,"unmonitor":false,"unmonitorEvents":false,"values":false}}')}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>transform});var lib=__webpack_require__("./node_modules/.pnpm/@babel+core@7.26.0/node_modules/@babel/core/lib/index.js"),external_url_=__webpack_require__("url"),template_lib=__webpack_require__("./node_modules/.pnpm/@babel+template@7.25.9/node_modules/@babel/template/lib/index.js");function TransformImportMetaPlugin(_ctx,opts){return{name:"transform-import-meta",visitor:{Program(path){const metas=[];if(path.traverse({MemberExpression(memberExpPath){const{node}=memberExpPath;"MetaProperty"===node.object.type&&"import"===node.object.meta.name&&"meta"===node.object.property.name&&"Identifier"===node.property.type&&"url"===node.property.name&&metas.push(memberExpPath)}}),0!==metas.length)for(const meta of metas)meta.replaceWith(template_lib.smart.ast`${opts.filename?JSON.stringify((0,external_url_.pathToFileURL)(opts.filename)):"require('url').pathToFileURL(__filename).toString()"}`)}}}}function importMetaEnvPlugin({template,types}){return{name:"@import-meta-env/babel",visitor:{Identifier(path){if(!types.isIdentifier(path))return;if(!types.isMemberExpression(path.parentPath)&&!types.isOptionalMemberExpression(path.parentPath))return;if(!types.isMemberExpression(path.parentPath.node))return;const parentNode=path.parentPath.node;if(!types.isMetaProperty(parentNode.object))return;const parentNodeObjMeta=parentNode.object;"import"===parentNodeObjMeta.meta.name&&"meta"===parentNodeObjMeta.property.name&&"env"===parentNode.property.name&&path.parentPath.replaceWith(template.expression.ast("process.env"))}}}}function transform(opts){var _a,_b,_c,_d,_e,_f;const _opts=Object.assign(Object.assign({babelrc:!1,configFile:!1,compact:!1,retainLines:"boolean"!=typeof opts.retainLines||opts.retainLines,filename:"",cwd:"/"},opts.babel),{plugins:[[__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-modules-commonjs@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-modules-commonjs/lib/index.js"),{allowTopLevelThis:!0}],[__webpack_require__("./node_modules/.pnpm/babel-plugin-dynamic-import-node@2.3.3/node_modules/babel-plugin-dynamic-import-node/lib/index.js"),{noInterop:!0}],[TransformImportMetaPlugin,{filename:opts.filename}],[__webpack_require__("./node_modules/.pnpm/@babel+plugin-syntax-class-properties@7.12.13_@babel+core@7.26.0/node_modules/@babel/plugin-syntax-class-properties/lib/index.js")],[__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-export-namespace-from@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-transform-export-namespace-from/lib/index.js")],[importMetaEnvPlugin]]});opts.ts&&(_opts.plugins.push([__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-typescript@7.26.3_@babel+core@7.26.0/node_modules/@babel/plugin-transform-typescript/lib/index.js"),{allowDeclareFields:!0}]),_opts.plugins.unshift([__webpack_require__("./node_modules/.pnpm/babel-plugin-transform-typescript-metadata@0.3.2_@babel+core@7.26.0_@babel+traverse@7.26.4/node_modules/babel-plugin-transform-typescript-metadata/lib/plugin.js")],[__webpack_require__("./node_modules/.pnpm/@babel+plugin-proposal-decorators@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-proposal-decorators/lib/index.js"),{legacy:!0}]),_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/babel-plugin-parameter-decorator@1.0.16/node_modules/babel-plugin-parameter-decorator/lib/index.js")),_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/@babel+plugin-syntax-import-assertions@7.26.0_@babel+core@7.26.0/node_modules/@babel/plugin-syntax-import-assertions/lib/index.js"))),opts.legacy&&(_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-nullish-coalescing-operator@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-transform-nullish-coalescing-operator/lib/index.js")),_opts.plugins.push(__webpack_require__("./node_modules/.pnpm/@babel+plugin-transform-optional-chaining@7.25.9_@babel+core@7.26.0/node_modules/@babel/plugin-transform-optional-chaining/lib/index.js"))),opts.babel&&Array.isArray(opts.babel.plugins)&&(null===(_a=_opts.plugins)||void 0===_a||_a.push(...opts.babel.plugins));try{return{code:(null===(_b=(0,lib.transformSync)(opts.source,_opts))||void 0===_b?void 0:_b.code)||""}}catch(error){return{error,code:"exports.__JITI_ERROR__ = "+JSON.stringify({filename:opts.filename,line:(null===(_c=error.loc)||void 0===_c?void 0:_c.line)||0,column:(null===(_d=error.loc)||void 0===_d?void 0:_d.column)||0,code:null===(_e=error.code)||void 0===_e?void 0:_e.replace("BABEL_","").replace("PARSE_ERROR","ParseError"),message:null===(_f=error.message)||void 0===_f?void 0:_f.replace("/: ","").replace(/\(.+\)\s*$/,"")})}}}})(),module.exports=__webpack_exports__.default})();
./node_modules/.pnpm/supports-preserve-symlinks-flag@1.0.0/node_modules/supports-preserve-symlinks-flag/index.js:	process.allowedNodeEnvironmentFlags && process.allowedNodeEnvironmentFlags.has('--preserve-symlinks')
./node_modules/.pnpm/jackspeak@3.4.3/node_modules/jackspeak/dist/esm/index.js:     * Environment values always take precedence over any other value, except
./node_modules/.pnpm/jackspeak@3.4.3/node_modules/jackspeak/dist/esm/index.d.ts:     * Environment object to read/write. Defaults `process.env`.
./node_modules/.pnpm/jackspeak@3.4.3/node_modules/jackspeak/dist/esm/index.d.ts:     * Environment values always take precedence over any other value, except
./node_modules/.pnpm/jackspeak@3.4.3/node_modules/jackspeak/dist/commonjs/index.js:     * Environment values always take precedence over any other value, except
./node_modules/.pnpm/jackspeak@3.4.3/node_modules/jackspeak/dist/commonjs/index.d.ts:     * Environment object to read/write. Defaults `process.env`.
./node_modules/.pnpm/jackspeak@3.4.3/node_modules/jackspeak/dist/commonjs/index.d.ts:     * Environment values always take precedence over any other value, except
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  if (!system.getEnvironmentVariable) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return system.getEnvironmentVariable(`${envVar}_${level.toUpperCase()}`);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      getEnvironmentVariable(name) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:if (sys && sys.getEnvironmentVariable) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    /^development$/i.test(sys.getEnvironmentVariable("NODE_ENV")) ? 1 /* Normal */ : 0 /* None */
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  Language_and_Environment: diag(6254, 3 /* Message */, "Language_and_Environment_6254", "Language and Environment"),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  Environment_Settings: diag(6285, 3 /* Message */, "Environment_Settings_6285", "Environment Settings"),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:function nodeStartsNewLexicalEnvironment(node) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    mergeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function mergeLexicalEnvironment(statements, declarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  emitHeader(Diagnostics.Environment_Settings);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:          return !nodeStartsNewLexicalEnvironment(node) && !isPartOfTypeNode(node) && !!forEachChild(node, traverse);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return findAncestor(node, (n) => !n || nodeStartsNewLexicalEnvironment(n) ? "quit" : isIterationStatement(
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:function visitLexicalEnvironment(statements, visitor, context, start, ensureUseStrict, nodesVisitor = visitNodes2) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  return factory.mergeLexicalEnvironment(statements, context.endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    context.setLexicalEnvironmentFlags(1 /* InParameters */, true);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (context.getLexicalEnvironmentFlags() & 2 /* VariablesHoistedInParameters */ && getEmitScriptTarget(context.getCompilerOptions()) >= 2 /* ES2015 */) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    context.setLexicalEnvironmentFlags(1 /* InParameters */, false);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  context.suspendLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  context.resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  const declarations = context.endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const statements = factory.mergeLexicalEnvironment(block.statements, declarations);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    context.suspendLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      visitLexicalEnvironment(node.statements, visitor, context)
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:function walkUpLexicalEnvironments(env, cb) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:function newPrivateEnvironment(data) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  return walkUpLexicalEnvironments(env, (env2) => getPrivateIdentifier(env2.privateEnv, name));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      visitLexicalEnvironment(
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      insertStatementsAfterStandardPrologue(statements, context.endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    statements = factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  const lexicalEnvironmentMap = /* @__PURE__ */ new Map();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironment = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const lex = getClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (shouldTransformInitializersUsingSet && !isStatic(node) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) && lexicalEnvironment.data.facts & 16 /* WillHoistInitializersToConstructor */) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return shouldTransformAutoAccessors === -1 /* True */ || shouldTransformAutoAccessors === 3 /* Maybe */ && !!(lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) && !!(lexicalEnvironment.data.facts & 16 /* WillHoistInitializersToConstructor */);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node) && isIdentifier(node.name) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      } else if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(operand) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node.expression) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.classConstructor)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        lexicalEnvironment.data.classConstructor,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node.tag) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.classConstructor)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        lexicalEnvironment.data.classConstructor,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (lexicalEnvironment) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentMap.set(getOriginalNode(node), lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      statements = factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      } else if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node.left) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const facts = ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.facts) || 0 /* None */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      getClassLexicalEnvironment().superClassReference = temp;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function visitInNewClassLexicalEnvironment(node, visitor2) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        getPrivateIdentifierEnvironment().data.className = name;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:            getPrivateIdentifierEnvironment().data.className = node.emitNode.assignedName.textSourceNode;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:            getPrivateIdentifierEnvironment().data.className = prefixName;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        getPrivateIdentifierEnvironment().data.weakSetName = createHoistedVariableForClass(
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      getClassLexicalEnvironment().facts = facts;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    Debug.assert(lexicalEnvironment === savedLexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return visitInNewClassLexicalEnvironment(node, visitClassDeclarationInNewClassLexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function visitClassDeclarationInNewClassLexicalEnvironment(node, facts) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        getClassLexicalEnvironment().classConstructor = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        getClassLexicalEnvironment().classConstructor = factory2.cloneNode(temp);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      getClassLexicalEnvironment().classThis = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const alias = getClassLexicalEnvironment().classConstructor;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return visitInNewClassLexicalEnvironment(node, visitClassExpressionInNewClassLexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function visitClassExpressionInNewClassLexicalEnvironment(node, facts) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        return getClassLexicalEnvironment().classConstructor = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      getClassLexicalEnvironment().classConstructor = factory2.cloneNode(temp2);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      getClassLexicalEnvironment().classThis = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (shouldTransformThisInStaticInitializers && currentClassElement && isClassStaticBlockDeclaration(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      const { classThis, classConstructor } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:            addPrivateIdentifierToEnvironment(member, member.name, addPrivateIdentifierClassElementToEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:            const privateEnv = getPrivateIdentifierEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:              addPrivateIdentifierToEnvironment(member, storageName, addPrivateIdentifierPropertyDeclarationToEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:              const privateEnv = getPrivateIdentifierEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const { weakSetName } = getPrivateIdentifierEnvironment().data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (!(lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) || !(lexicalEnvironment.data.facts & 16 /* WillHoistInitializersToConstructor */)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    statements = factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (transformed && hasStaticModifier(property) && ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.facts)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentMap.set(getOriginalNode(property), lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const { weakSetName } = getPrivateIdentifierEnvironment().data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function startClassLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironment = { previous: lexicalEnvironment, data: void 0 };
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function endClassLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironment = lexicalEnvironment == null ? void 0 : lexicalEnvironment.previous;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function getClassLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    Debug.assert(lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return lexicalEnvironment.data ?? (lexicalEnvironment.data = {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      // privateIdentifierEnvironment: undefined,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function getPrivateIdentifierEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    Debug.assert(lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return lexicalEnvironment.privateEnv ?? (lexicalEnvironment.privateEnv = newPrivateEnvironment({
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function addPrivateIdentifierClassElementToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      addPrivateIdentifierAutoAccessorPropertyDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      addPrivateIdentifierPropertyDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      addPrivateIdentifierMethodDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      addPrivateIdentifierGetAccessorDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      addPrivateIdentifierSetAccessorDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function addPrivateIdentifierPropertyDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, _previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function addPrivateIdentifierMethodDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, _previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function addPrivateIdentifierGetAccessorDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function addPrivateIdentifierSetAccessorDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function addPrivateIdentifierAutoAccessorPropertyDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, _previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function addPrivateIdentifierToEnvironment(node, name, addDeclaration) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const lex = getClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const privateEnv = getPrivateIdentifierEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const { className } = getPrivateIdentifierEnvironment().data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const info = accessPrivateIdentifier(lexicalEnvironment, name);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    } else if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const lex = lexicalEnvironmentMap.get(original);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironment = lex;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironment = savedLexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        lexicalEnvironment = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        lexicalEnvironment = savedLexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        lexicalEnvironment = lexicalEnvironment == null ? void 0 : lexicalEnvironment.previous;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        lexicalEnvironment = savedLexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (enabledSubstitutions & 2 /* ClassStaticThisOrSuperReference */ && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) && !noSubstitution.has(node)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      const { facts, classConstructor, classThis } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const lexicalEnvironment = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return factory2.createImmediatelyInvokedArrowFunction(factory2.mergeLexicalEnvironment(classDefinitionStatements, lexicalEnvironment));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const declarations = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    asyncBody = factory2.updateBlock(asyncBody, factory2.mergeLexicalEnvironment(asyncBody.statements, endLexicalEnvironment()));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        result = factory2.updateBlock(block, factory2.mergeLexicalEnvironment(block.statements, [createCaptureArgumentsStatement()]));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    asyncBody = factory2.updateBlock(asyncBody, factory2.mergeLexicalEnvironment(asyncBody.statements, appendObjectRestAssignmentsIfNeeded(endLexicalEnvironment(), node)));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const leadingStatements = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      addRange(topLevelStatements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    factory2.mergeLexicalEnvironment(prologue, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    factory2.mergeLexicalEnvironment(prologue, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    factory2.mergeLexicalEnvironment(prologue, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    const lexicalEnvironment = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements, lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements2, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentVariableDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentFunctionDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentStatements;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentFlags = 0 /* None */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentVariableDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentFunctionDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentStatementsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentFlagsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentStackOffset = 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  let lexicalEnvironmentSuspended = false;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    suspendLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    setLexicalEnvironmentFlags,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    getLexicalEnvironmentFlags,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (!lexicalEnvironmentVariableDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentVariableDeclarations = [decl];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentVariableDeclarations.push(decl);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (lexicalEnvironmentFlags & 1 /* InParameters */) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentFlags |= 2 /* VariablesHoistedInParameters */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (!lexicalEnvironmentFunctionDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentFunctionDeclarations = [func];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentFunctionDeclarations.push(func);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (!lexicalEnvironmentStatements) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentStatements = [node];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentStatements.push(node);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function startLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    Debug.assert(!lexicalEnvironmentSuspended, "Lexical environment is suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentVariableDeclarationsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentVariableDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentFunctionDeclarationsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentFunctionDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentStatementsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentStatements;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentFlagsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentFlags;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentStackOffset++;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentVariableDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentFunctionDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentStatements = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentFlags = 0 /* None */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function suspendLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    Debug.assert(!lexicalEnvironmentSuspended, "Lexical environment is already suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentSuspended = true;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function resumeLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    Debug.assert(lexicalEnvironmentSuspended, "Lexical environment is not suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentSuspended = false;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function endLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    Debug.assert(!lexicalEnvironmentSuspended, "Lexical environment is suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (lexicalEnvironmentVariableDeclarations || lexicalEnvironmentFunctionDeclarations || lexicalEnvironmentStatements) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      if (lexicalEnvironmentFunctionDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:        statements = [...lexicalEnvironmentFunctionDeclarations];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      if (lexicalEnvironmentVariableDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:          factory2.createVariableDeclarationList(lexicalEnvironmentVariableDeclarations)
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      if (lexicalEnvironmentStatements) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:          statements = [...lexicalEnvironmentStatements];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:          statements = [...statements, ...lexicalEnvironmentStatements];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentStackOffset--;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentVariableDeclarations = lexicalEnvironmentVariableDeclarationsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentFunctionDeclarations = lexicalEnvironmentFunctionDeclarationsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentStatements = lexicalEnvironmentStatementsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentFlags = lexicalEnvironmentFlagsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    if (lexicalEnvironmentStackOffset === 0) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentVariableDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentFunctionDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentStatementsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentFlagsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function setLexicalEnvironmentFlags(flags, value) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    lexicalEnvironmentFlags = value ? lexicalEnvironmentFlags | flags : lexicalEnvironmentFlags & ~flags;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  function getLexicalEnvironmentFlags() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    return lexicalEnvironmentFlags;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentVariableDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentVariableDeclarationsStack = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentFunctionDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:      lexicalEnvironmentFunctionDeclarationsStack = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  startLexicalEnvironment: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  resumeLexicalEnvironment: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  suspendLexicalEnvironment: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  endLexicalEnvironment: returnUndefined,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  setLexicalEnvironmentFlags: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  getLexicalEnvironmentFlags: () => 0,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    getEnvironmentVariable: (name) => system.getEnvironmentVariable ? system.getEnvironmentVariable(name) : "",
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    getEnvironmentVariable: maybeBind(host, host.getEnvironmentVariable) || (() => ""),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:    getEnvironmentVariable: maybeBind(system, system.getEnvironmentVariable),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  return !!sys2.writeOutputIsTTY && sys2.writeOutputIsTTY() && !sys2.getEnvironmentVariable("NO_COLOR");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  const isWindows = sys2.getEnvironmentVariable("OS") && sys2.getEnvironmentVariable("OS").toLowerCase().includes("windows");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  const isWindowsTerminal = sys2.getEnvironmentVariable("WT_SESSION");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  const isVSCode = sys2.getEnvironmentVariable("TERM_PROGRAM") && sys2.getEnvironmentVariable("TERM_PROGRAM") === "vscode";
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:  const supportsRicherColors = sys2.getEnvironmentVariable("COLORTERM") === "truecolor" || sys2.getEnvironmentVariable("TERM") === "xterm-256color";
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsc.js:if (sys.tryEnableSourceMapsForHost && /^development$/i.test(sys.getEnvironmentVariable("NODE_ENV"))) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsserver.js:function parseLoggingEnvironmentString(logEnvStr) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsserver.js:    const envLogOptions = parseLoggingEnvironmentString(process.env.TSS_LOG);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/_tsserver.js:  if (typescript_exports.sys.tryEnableSourceMapsForHost && /^development$/i.test(typescript_exports.sys.getEnvironmentVariable("NODE_ENV"))) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  LexicalEnvironmentFlags: () => LexicalEnvironmentFlags,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  newPrivateEnvironment: () => newPrivateEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  nodeStartsNewLexicalEnvironment: () => nodeStartsNewLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  visitLexicalEnvironment: () => visitLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:var LexicalEnvironmentFlags = /* @__PURE__ */ ((LexicalEnvironmentFlags2) => {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  LexicalEnvironmentFlags2[LexicalEnvironmentFlags2["None"] = 0] = "None";
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  LexicalEnvironmentFlags2[LexicalEnvironmentFlags2["InParameters"] = 1] = "InParameters";
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  LexicalEnvironmentFlags2[LexicalEnvironmentFlags2["VariablesHoistedInParameters"] = 2] = "VariablesHoistedInParameters";
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  return LexicalEnvironmentFlags2;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:})(LexicalEnvironmentFlags || {});
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  if (!system.getEnvironmentVariable) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return system.getEnvironmentVariable(`${envVar}_${level.toUpperCase()}`);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      getEnvironmentVariable(name) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:if (sys && sys.getEnvironmentVariable) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    /^development$/i.test(sys.getEnvironmentVariable("NODE_ENV")) ? 1 /* Normal */ : 0 /* None */
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  Language_and_Environment: diag(6254, 3 /* Message */, "Language_and_Environment_6254", "Language and Environment"),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  Environment_Settings: diag(6285, 3 /* Message */, "Environment_Settings_6285", "Environment Settings"),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:function nodeStartsNewLexicalEnvironment(node) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    mergeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function mergeLexicalEnvironment(statements, declarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    category: Diagnostics.Language_and_Environment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  emitHeader(Diagnostics.Environment_Settings);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:          return !nodeStartsNewLexicalEnvironment(node) && !isPartOfTypeNode(node) && !!forEachChild(node, traverse);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return findAncestor(node, (n) => !n || nodeStartsNewLexicalEnvironment(n) ? "quit" : isIterationStatement(
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:function visitLexicalEnvironment(statements, visitor, context, start, ensureUseStrict, nodesVisitor = visitNodes2) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  return factory.mergeLexicalEnvironment(statements, context.endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    context.setLexicalEnvironmentFlags(1 /* InParameters */, true);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (context.getLexicalEnvironmentFlags() & 2 /* VariablesHoistedInParameters */ && getEmitScriptTarget(context.getCompilerOptions()) >= 2 /* ES2015 */) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    context.setLexicalEnvironmentFlags(1 /* InParameters */, false);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  context.suspendLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  context.resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  const declarations = context.endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const statements = factory.mergeLexicalEnvironment(block.statements, declarations);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    context.suspendLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      visitLexicalEnvironment(node.statements, visitor, context)
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:function walkUpLexicalEnvironments(env, cb) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:function newPrivateEnvironment(data) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  return walkUpLexicalEnvironments(env, (env2) => getPrivateIdentifier(env2.privateEnv, name));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      visitLexicalEnvironment(
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      context.startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      insertStatementsAfterStandardPrologue(statements, context.endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    statements = factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  const lexicalEnvironmentMap = /* @__PURE__ */ new Map();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironment = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const lex = getClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (shouldTransformInitializersUsingSet && !isStatic(node) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) && lexicalEnvironment.data.facts & 16 /* WillHoistInitializersToConstructor */) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return shouldTransformAutoAccessors === -1 /* True */ || shouldTransformAutoAccessors === 3 /* Maybe */ && !!(lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) && !!(lexicalEnvironment.data.facts & 16 /* WillHoistInitializersToConstructor */);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node) && isIdentifier(node.name) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      } else if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(operand) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node.expression) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.classConstructor)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        lexicalEnvironment.data.classConstructor,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node.tag) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.classConstructor)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        lexicalEnvironment.data.classConstructor,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (lexicalEnvironment) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentMap.set(getOriginalNode(node), lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      statements = factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      } else if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node.left) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const facts = ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.facts) || 0 /* None */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      getClassLexicalEnvironment().superClassReference = temp;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function visitInNewClassLexicalEnvironment(node, visitor2) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        getPrivateIdentifierEnvironment().data.className = name;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:            getPrivateIdentifierEnvironment().data.className = node.emitNode.assignedName.textSourceNode;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:            getPrivateIdentifierEnvironment().data.className = prefixName;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        getPrivateIdentifierEnvironment().data.weakSetName = createHoistedVariableForClass(
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      getClassLexicalEnvironment().facts = facts;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    Debug.assert(lexicalEnvironment === savedLexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return visitInNewClassLexicalEnvironment(node, visitClassDeclarationInNewClassLexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function visitClassDeclarationInNewClassLexicalEnvironment(node, facts) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        getClassLexicalEnvironment().classConstructor = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        getClassLexicalEnvironment().classConstructor = factory2.cloneNode(temp);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      getClassLexicalEnvironment().classThis = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const alias = getClassLexicalEnvironment().classConstructor;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return visitInNewClassLexicalEnvironment(node, visitClassExpressionInNewClassLexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function visitClassExpressionInNewClassLexicalEnvironment(node, facts) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        return getClassLexicalEnvironment().classConstructor = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      getClassLexicalEnvironment().classConstructor = factory2.cloneNode(temp2);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      getClassLexicalEnvironment().classThis = node.emitNode.classThis;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (shouldTransformThisInStaticInitializers && currentClassElement && isClassStaticBlockDeclaration(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      const { classThis, classConstructor } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:            addPrivateIdentifierToEnvironment(member, member.name, addPrivateIdentifierClassElementToEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:            const privateEnv = getPrivateIdentifierEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:              addPrivateIdentifierToEnvironment(member, storageName, addPrivateIdentifierPropertyDeclarationToEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:              const privateEnv = getPrivateIdentifierEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const { weakSetName } = getPrivateIdentifierEnvironment().data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (!(lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) || !(lexicalEnvironment.data.facts & 16 /* WillHoistInitializersToConstructor */)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    statements = factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (transformed && hasStaticModifier(property) && ((_a = lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) == null ? void 0 : _a.facts)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentMap.set(getOriginalNode(property), lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const { weakSetName } = getPrivateIdentifierEnvironment().data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function startClassLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironment = { previous: lexicalEnvironment, data: void 0 };
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function endClassLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironment = lexicalEnvironment == null ? void 0 : lexicalEnvironment.previous;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function getClassLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    Debug.assert(lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return lexicalEnvironment.data ?? (lexicalEnvironment.data = {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      // privateIdentifierEnvironment: undefined,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function getPrivateIdentifierEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    Debug.assert(lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return lexicalEnvironment.privateEnv ?? (lexicalEnvironment.privateEnv = newPrivateEnvironment({
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function addPrivateIdentifierClassElementToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      addPrivateIdentifierAutoAccessorPropertyDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      addPrivateIdentifierPropertyDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      addPrivateIdentifierMethodDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      addPrivateIdentifierGetAccessorDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      addPrivateIdentifierSetAccessorDeclarationToEnvironment(node, name, lex, privateEnv, isStatic2, isValid, previousInfo);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function addPrivateIdentifierPropertyDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, _previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function addPrivateIdentifierMethodDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, _previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function addPrivateIdentifierGetAccessorDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function addPrivateIdentifierSetAccessorDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function addPrivateIdentifierAutoAccessorPropertyDeclarationToEnvironment(_node, name, lex, privateEnv, isStatic2, isValid, _previousInfo) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function addPrivateIdentifierToEnvironment(node, name, addDeclaration) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const lex = getClassLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const privateEnv = getPrivateIdentifierEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const { className } = getPrivateIdentifierEnvironment().data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const info = accessPrivateIdentifier(lexicalEnvironment, name);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    } else if (shouldTransformSuperInStaticInitializers && currentClassElement && isSuperProperty(node) && isStaticPropertyDeclarationOrClassStaticBlock(currentClassElement) && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      const { classConstructor, superClassReference, facts } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const lex = lexicalEnvironmentMap.get(original);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironment = lex;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironment = savedLexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        lexicalEnvironment = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        lexicalEnvironment = savedLexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        const savedLexicalEnvironment = lexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        lexicalEnvironment = lexicalEnvironment == null ? void 0 : lexicalEnvironment.previous;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        lexicalEnvironment = savedLexicalEnvironment;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (enabledSubstitutions & 2 /* ClassStaticThisOrSuperReference */ && (lexicalEnvironment == null ? void 0 : lexicalEnvironment.data) && !noSubstitution.has(node)) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      const { facts, classConstructor, classThis } = lexicalEnvironment.data;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const lexicalEnvironment = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return factory2.createImmediatelyInvokedArrowFunction(factory2.mergeLexicalEnvironment(classDefinitionStatements, lexicalEnvironment));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const declarations = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    asyncBody = factory2.updateBlock(asyncBody, factory2.mergeLexicalEnvironment(asyncBody.statements, endLexicalEnvironment()));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        result = factory2.updateBlock(block, factory2.mergeLexicalEnvironment(block.statements, [createCaptureArgumentsStatement()]));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    asyncBody = factory2.updateBlock(asyncBody, factory2.mergeLexicalEnvironment(asyncBody.statements, appendObjectRestAssignmentsIfNeeded(endLexicalEnvironment(), node)));
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const leadingStatements = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      addRange(topLevelStatements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    factory2.mergeLexicalEnvironment(prologue, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    factory2.mergeLexicalEnvironment(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    factory2.mergeLexicalEnvironment(prologue, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    factory2.mergeLexicalEnvironment(prologue, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    const lexicalEnvironment = endLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements, lexicalEnvironment);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements2, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment();
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    insertStatementsAfterStandardPrologue(statements, endLexicalEnvironment());
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentVariableDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentFunctionDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentStatements;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentFlags = 0 /* None */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentVariableDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentFunctionDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentStatementsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentFlagsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentStackOffset = 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  let lexicalEnvironmentSuspended = false;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    startLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    suspendLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    resumeLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    endLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    setLexicalEnvironmentFlags,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    getLexicalEnvironmentFlags,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (!lexicalEnvironmentVariableDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentVariableDeclarations = [decl];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentVariableDeclarations.push(decl);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (lexicalEnvironmentFlags & 1 /* InParameters */) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentFlags |= 2 /* VariablesHoistedInParameters */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (!lexicalEnvironmentFunctionDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentFunctionDeclarations = [func];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentFunctionDeclarations.push(func);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (!lexicalEnvironmentStatements) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentStatements = [node];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentStatements.push(node);
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function startLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    Debug.assert(!lexicalEnvironmentSuspended, "Lexical environment is suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentVariableDeclarationsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentVariableDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentFunctionDeclarationsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentFunctionDeclarations;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentStatementsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentStatements;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentFlagsStack[lexicalEnvironmentStackOffset] = lexicalEnvironmentFlags;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentStackOffset++;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentVariableDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentFunctionDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentStatements = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentFlags = 0 /* None */;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function suspendLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    Debug.assert(!lexicalEnvironmentSuspended, "Lexical environment is already suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentSuspended = true;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function resumeLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    Debug.assert(lexicalEnvironmentSuspended, "Lexical environment is not suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentSuspended = false;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function endLexicalEnvironment() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    Debug.assert(!lexicalEnvironmentSuspended, "Lexical environment is suspended.");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (lexicalEnvironmentVariableDeclarations || lexicalEnvironmentFunctionDeclarations || lexicalEnvironmentStatements) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      if (lexicalEnvironmentFunctionDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:        statements = [...lexicalEnvironmentFunctionDeclarations];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      if (lexicalEnvironmentVariableDeclarations) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:          factory2.createVariableDeclarationList(lexicalEnvironmentVariableDeclarations)
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      if (lexicalEnvironmentStatements) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:          statements = [...lexicalEnvironmentStatements];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:          statements = [...statements, ...lexicalEnvironmentStatements];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentStackOffset--;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentVariableDeclarations = lexicalEnvironmentVariableDeclarationsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentFunctionDeclarations = lexicalEnvironmentFunctionDeclarationsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentStatements = lexicalEnvironmentStatementsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentFlags = lexicalEnvironmentFlagsStack[lexicalEnvironmentStackOffset];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    if (lexicalEnvironmentStackOffset === 0) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentVariableDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentFunctionDeclarationsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentStatementsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentFlagsStack = [];
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function setLexicalEnvironmentFlags(flags, value) {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    lexicalEnvironmentFlags = value ? lexicalEnvironmentFlags | flags : lexicalEnvironmentFlags & ~flags;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  function getLexicalEnvironmentFlags() {
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    return lexicalEnvironmentFlags;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentVariableDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentVariableDeclarationsStack = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentFunctionDeclarations = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:      lexicalEnvironmentFunctionDeclarationsStack = void 0;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  startLexicalEnvironment: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  resumeLexicalEnvironment: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  suspendLexicalEnvironment: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  endLexicalEnvironment: returnUndefined,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  setLexicalEnvironmentFlags: noop,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  getLexicalEnvironmentFlags: () => 0,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    getEnvironmentVariable: (name) => system.getEnvironmentVariable ? system.getEnvironmentVariable(name) : "",
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    getEnvironmentVariable: maybeBind(host, host.getEnvironmentVariable) || (() => ""),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:    getEnvironmentVariable: maybeBind(system, system.getEnvironmentVariable),
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  return !!sys2.writeOutputIsTTY && sys2.writeOutputIsTTY() && !sys2.getEnvironmentVariable("NO_COLOR");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  const isWindows = sys2.getEnvironmentVariable("OS") && sys2.getEnvironmentVariable("OS").toLowerCase().includes("windows");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  const isWindowsTerminal = sys2.getEnvironmentVariable("WT_SESSION");
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  const isVSCode = sys2.getEnvironmentVariable("TERM_PROGRAM") && sys2.getEnvironmentVariable("TERM_PROGRAM") === "vscode";
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  const supportsRicherColors = sys2.getEnvironmentVariable("COLORTERM") === "truecolor" || sys2.getEnvironmentVariable("TERM") === "xterm-256color";
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  LexicalEnvironmentFlags: () => LexicalEnvironmentFlags,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  newPrivateEnvironment: () => newPrivateEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  nodeStartsNewLexicalEnvironment: () => nodeStartsNewLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  visitLexicalEnvironment: () => visitLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  LexicalEnvironmentFlags,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  newPrivateEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  nodeStartsNewLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.js:  visitLexicalEnvironment,
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.d.ts:        getEnvironmentVariable?(name: string): string | undefined;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.d.ts:        startLexicalEnvironment(): void;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.d.ts:        suspendLexicalEnvironment(): void;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.d.ts:        resumeLexicalEnvironment(): void;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.d.ts:        endLexicalEnvironment(): Statement[] | undefined;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.d.ts:    function visitLexicalEnvironment(statements: NodeArray<Statement>, visitor: Visitor, context: TransformationContext, start?: number, ensureUseStrict?: boolean, nodesVisitor?: NodesVisitor): NodeArray<Statement>;
./node_modules/.pnpm/typescript@5.9.2/node_modules/typescript/lib/typescript.d.ts:        getEnvironmentVariable?(name: string): string | undefined;
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/Config.d.ts:    interface EnvironmentConfig {
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/Config.d.ts:    export type EnvironmentConfig = SharedConfig.EnvironmentConfig;
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/Config.d.ts:        env?: EnvironmentConfig;
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/Linter.d.ts:    type EnvironmentConfig = SharedConfig.EnvironmentConfig;
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/Linter.d.ts:    interface Environment {
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/Linter.d.ts:        environments?: Record<string, Environment>;
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/RuleTester.d.ts:     * Environments for the test case.
./node_modules/.pnpm/@typescript-eslint+utils@8.43.0_eslint@9.35.0_typescript@5.9.2/node_modules/@typescript-eslint/utils/dist/ts-eslint/RuleTester.d.ts:    readonly env?: Readonly<Linter.EnvironmentConfig>;
./node_modules/.pnpm/vite@5.4.20_@types+node@22.18.3/node_modules/vite/dist/node/index.d.ts:     * Environment files directory. Can be an absolute path, or a path relative from
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/web/index.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Html.cjs.js"),r=require("./CycleRaycast.cjs.js"),s=require("./useCursor.cjs.js"),o=require("./Loader.cjs.js"),t=require("./ScrollControls.cjs.js"),i=require("./PresentationControls.cjs.js"),a=require("./KeyboardControls.cjs.js"),c=require("./Select.cjs.js"),u=require("./View.cjs.js"),n=require("./pivotControls/index.cjs.js"),p=require("./ScreenVideoTexture.cjs.js"),j=require("./WebcamVideoTexture.cjs.js"),l=require("./FaceControls.cjs.js"),x=require("./DragControls.cjs.js"),d=require("./FaceLandmarker.cjs.js"),q=require("./Facemesh.cjs.js"),m=require("../core/Billboard.cjs.js"),C=require("../core/ScreenSpace.cjs.js"),h=require("../core/ScreenSizer.cjs.js"),S=require("../core/QuadraticBezierLine.cjs.js"),M=require("../core/CubicBezierLine.cjs.js"),T=require("../core/CatmullRomLine.cjs.js"),b=require("../core/Line.cjs.js"),P=require("../core/PositionalAudio.cjs.js"),f=require("../core/Text.cjs.js"),g=require("../core/Text3D.cjs.js"),v=require("../core/Effects.cjs.js"),F=require("../core/GradientTexture.cjs.js"),B=require("../core/Image.cjs.js"),A=require("../core/Edges.cjs.js"),L=require("../core/Outlines.cjs.js"),D=require("../core/Trail.cjs.js"),y=require("../core/Sampler.cjs.js"),k=require("../core/ComputedAttribute.cjs.js"),E=require("../core/Clone.cjs.js"),G=require("../core/MarchingCubes.cjs.js"),R=require("../core/Decal.cjs.js"),w=require("../core/Svg.cjs.js"),z=require("../core/Gltf.cjs.js"),I=require("../core/AsciiRenderer.cjs.js"),O=require("../core/Splat.cjs.js"),V=require("../core/OrthographicCamera.cjs.js"),H=require("../core/PerspectiveCamera.cjs.js"),K=require("../core/CubeCamera.cjs.js"),W=require("../core/DeviceOrientationControls.cjs.js"),Q=require("../core/FlyControls.cjs.js"),N=require("../core/MapControls.cjs.js"),U=require("../core/OrbitControls.cjs.js"),X=require("../core/TrackballControls.cjs.js"),_=require("../core/ArcballControls.cjs.js"),J=require("../core/TransformControls.cjs.js"),Y=require("../core/PointerLockControls.cjs.js"),Z=require("../core/FirstPersonControls.cjs.js"),$=require("../core/CameraControls.cjs.js"),ee=require("camera-controls"),re=require("../core/MotionPathControls.cjs.js"),se=require("../core/GizmoHelper.cjs.js"),oe=require("../core/GizmoViewcube.cjs.js"),te=require("../core/GizmoViewport.cjs.js"),ie=require("../core/Grid.cjs.js"),ae=require("../core/CubeTexture.cjs.js"),ce=require("../core/Fbx.cjs.js"),ue=require("../core/Ktx2.cjs.js"),ne=require("../core/Progress.cjs.js"),pe=require("../core/Texture.cjs.js"),je=require("../core/VideoTexture.cjs.js"),le=require("../core/useFont.cjs.js"),xe=require("../core/useSpriteLoader.cjs.js"),de=require("../core/Helper.cjs.js"),qe=require("../core/Stats.cjs.js"),me=require("../core/StatsGl.cjs.js"),Ce=require("../core/useDepthBuffer.cjs.js"),he=require("../core/useAspect.cjs.js"),Se=require("../core/useCamera.cjs.js"),Me=require("../core/DetectGPU.cjs.js"),Te=require("../core/Bvh.cjs.js"),be=require("../core/useContextBridge.cjs.js"),Pe=require("../core/useAnimations.cjs.js"),fe=require("../core/Fbo.cjs.js"),ge=require("../core/useIntersect.cjs.js"),ve=require("../core/useBoxProjectedEnv.cjs.js"),Fe=require("../core/BBAnchor.cjs.js"),Be=require("../core/TrailTexture.cjs.js"),Ae=require("../core/Example.cjs.js"),Le=require("../core/SpriteAnimator.cjs.js"),De=require("../core/CurveModifier.cjs.js"),ye=require("../core/MeshDistortMaterial.cjs.js"),ke=require("../core/MeshWobbleMaterial.cjs.js"),Ee=require("../core/MeshReflectorMaterial.cjs.js"),Ge=require("../core/MeshRefractionMaterial.cjs.js"),Re=require("../core/MeshTransmissionMaterial.cjs.js"),we=require("../core/MeshDiscardMaterial.cjs.js"),ze=require("../core/MultiMaterial.cjs.js"),Ie=require("../core/PointMaterial.cjs.js"),Oe=require("../core/shaderMaterial.cjs.js"),Ve=require("../core/softShadows.cjs.js"),He=require("../core/shapes.cjs.js"),Ke=require("../core/RoundedBox.cjs.js"),We=require("../core/ScreenQuad.cjs.js"),Qe=require("../core/Center.cjs.js"),Ne=require("../core/Resize.cjs.js"),Ue=require("../core/Bounds.cjs.js"),Xe=require("../core/CameraShake.cjs.js"),_e=require("../core/Float.cjs.js"),Je=require("../core/Stage.cjs.js"),Ye=require("../core/Backdrop.cjs.js"),Ze=require("../core/Shadow.cjs.js"),$e=require("../core/Caustics.cjs.js"),er=require("../core/ContactShadows.cjs.js"),rr=require("../core/AccumulativeShadows.cjs.js"),sr=require("../core/SpotLight.cjs.js"),or=require("../core/Environment.cjs.js"),tr=require("../core/Lightformer.cjs.js"),ir=require("../core/Sky.cjs.js"),ar=require("../core/Stars.cjs.js"),cr=require("../core/Cloud.cjs.js"),ur=require("../core/Sparkles.cjs.js"),nr=require("../core/useEnvironment.cjs.js"),pr=require("../core/MatcapTexture.cjs.js"),jr=require("../core/NormalTexture.cjs.js"),lr=require("../core/Wireframe.cjs.js"),xr=require("../core/ShadowAlpha.cjs.js"),dr=require("../core/Points.cjs.js"),qr=require("../core/Instances.cjs.js"),mr=require("../core/Segments.cjs.js"),Cr=require("../core/Detailed.cjs.js"),hr=require("../core/Preload.cjs.js"),Sr=require("../core/BakeShadows.cjs.js"),Mr=require("../core/meshBounds.cjs.js"),Tr=require("../core/AdaptiveDpr.cjs.js"),br=require("../core/AdaptiveEvents.cjs.js"),Pr=require("../core/PerformanceMonitor.cjs.js"),fr=require("../core/RenderTexture.cjs.js"),gr=require("../core/RenderCubeTexture.cjs.js"),vr=require("../core/Mask.cjs.js"),Fr=require("../core/Hud.cjs.js"),Br=require("../core/Fisheye.cjs.js"),Ar=require("../core/MeshPortalMaterial.cjs.js"),Lr=require("../core/calculateScaleFactor.cjs.js");function Dr(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("@babel/runtime/helpers/extends"),require("react"),require("react-dom/client"),require("three"),require("@react-three/fiber"),require("zustand"),require("maath"),require("@use-gesture/react"),require("zustand/middleware"),require("three-stdlib"),require("zustand/shallow"),require("tunnel-rat"),require("./pivotControls/AxisArrow.cjs.js"),require("./pivotControls/context.cjs.js"),require("./pivotControls/AxisRotator.cjs.js"),require("./pivotControls/PlaneSlider.cjs.js"),require("./pivotControls/ScalingSphere.cjs.js"),require("suspend-react"),require("hls.js"),require("troika-three-text"),require("../helpers/constants.cjs.js"),require("meshline"),require("stats.js"),require("../helpers/useEffectfulState.cjs.js"),require("stats-gl"),require("detect-gpu"),require("three-mesh-bvh"),require("../helpers/deprecated.cjs.js"),require("../materials/BlurPass.cjs.js"),require("../materials/ConvolutionMaterial.cjs.js"),require("../materials/MeshReflectorMaterial.cjs.js"),require("../materials/MeshRefractionMaterial.cjs.js"),require("../materials/DiscardMaterial.cjs.js"),require("@monogrid/gainmap-js"),require("../helpers/environment-assets.cjs.js"),require("../materials/SpotLightMaterial.cjs.js"),require("../materials/WireframeMaterial.cjs.js");var yr=Dr(ee);exports.Html=e.Html,exports.CycleRaycast=r.CycleRaycast,exports.useCursor=s.useCursor,exports.Loader=o.Loader,exports.Scroll=t.Scroll,exports.ScrollControls=t.ScrollControls,exports.useScroll=t.useScroll,exports.PresentationControls=i.PresentationControls,exports.KeyboardControls=a.KeyboardControls,exports.useKeyboardControls=a.useKeyboardControls,exports.Select=c.Select,exports.useSelect=c.useSelect,exports.View=u.View,exports.PivotControls=n.PivotControls,exports.ScreenVideoTexture=p.ScreenVideoTexture,exports.WebcamVideoTexture=j.WebcamVideoTexture,exports.FaceControls=l.FaceControls,exports.useFaceControls=l.useFaceControls,exports.DragControls=x.DragControls,exports.FaceLandmarker=d.FaceLandmarker,exports.FaceLandmarkerDefaults=d.FaceLandmarkerDefaults,exports.useFaceLandmarker=d.useFaceLandmarker,exports.Facemesh=q.Facemesh,exports.FacemeshDatas=q.FacemeshDatas,exports.FacemeshEye=q.FacemeshEye,exports.FacemeshEyeDefaults=q.FacemeshEyeDefaults,exports.Billboard=m.Billboard,exports.ScreenSpace=C.ScreenSpace,exports.ScreenSizer=h.ScreenSizer,exports.QuadraticBezierLine=S.QuadraticBezierLine,exports.CubicBezierLine=M.CubicBezierLine,exports.CatmullRomLine=T.CatmullRomLine,exports.Line=b.Line,exports.PositionalAudio=P.PositionalAudio,exports.Text=f.Text,exports.Text3D=g.Text3D,exports.Effects=v.Effects,exports.isWebGL2Available=v.isWebGL2Available,exports.GradientTexture=F.GradientTexture,exports.GradientType=F.GradientType,exports.Image=B.Image,exports.Edges=A.Edges,exports.Outlines=L.Outlines,exports.Trail=D.Trail,exports.useTrail=D.useTrail,exports.Sampler=y.Sampler,exports.useSurfaceSampler=y.useSurfaceSampler,exports.ComputedAttribute=k.ComputedAttribute,exports.Clone=E.Clone,exports.MarchingCube=G.MarchingCube,exports.MarchingCubes=G.MarchingCubes,exports.MarchingPlane=G.MarchingPlane,exports.Decal=R.Decal,exports.Svg=w.Svg,exports.Gltf=z.Gltf,exports.useGLTF=z.useGLTF,exports.AsciiRenderer=I.AsciiRenderer,exports.Splat=O.Splat,exports.OrthographicCamera=V.OrthographicCamera,exports.PerspectiveCamera=H.PerspectiveCamera,exports.CubeCamera=K.CubeCamera,exports.useCubeCamera=K.useCubeCamera,exports.DeviceOrientationControls=W.DeviceOrientationControls,exports.FlyControls=Q.FlyControls,exports.MapControls=N.MapControls,exports.OrbitControls=U.OrbitControls,exports.TrackballControls=X.TrackballControls,exports.ArcballControls=_.ArcballControls,exports.TransformControls=J.TransformControls,exports.PointerLockControls=Y.PointerLockControls,exports.FirstPersonControls=Z.FirstPersonControls,exports.CameraControls=$.CameraControls,Object.defineProperty(exports,"CameraControlsImpl",{enumerable:!0,get:function(){return yr.default}}),exports.MotionPathControls=re.MotionPathControls,exports.useMotion=re.useMotion,exports.GizmoHelper=se.GizmoHelper,exports.useGizmoContext=se.useGizmoContext,exports.GizmoViewcube=oe.GizmoViewcube,exports.GizmoViewport=te.GizmoViewport,exports.Grid=ie.Grid,exports.CubeTexture=ae.CubeTexture,exports.useCubeTexture=ae.useCubeTexture,exports.Fbx=ce.Fbx,exports.useFBX=ce.useFBX,exports.Ktx2=ue.Ktx2,exports.useKTX2=ue.useKTX2,exports.Progress=ne.Progress,exports.useProgress=ne.useProgress,exports.IsObject=pe.IsObject,exports.Texture=pe.Texture,exports.useTexture=pe.useTexture,exports.VideoTexture=je.VideoTexture,exports.useVideoTexture=je.useVideoTexture,exports.useFont=le.useFont,exports.checkIfFrameIsEmpty=xe.checkIfFrameIsEmpty,exports.getFirstFrame=xe.getFirstFrame,exports.useSpriteLoader=xe.useSpriteLoader,exports.Helper=de.Helper,exports.useHelper=de.useHelper,exports.Stats=qe.Stats,exports.StatsGl=me.StatsGl,exports.useDepthBuffer=Ce.useDepthBuffer,exports.useAspect=he.useAspect,exports.useCamera=Se.useCamera,exports.DetectGPU=Me.DetectGPU,exports.useDetectGPU=Me.useDetectGPU,exports.Bvh=Te.Bvh,exports.useBVH=Te.useBVH,exports.useContextBridge=be.useContextBridge,exports.useAnimations=Pe.useAnimations,exports.Fbo=fe.Fbo,exports.useFBO=fe.useFBO,exports.useIntersect=ge.useIntersect,exports.useBoxProjectedEnv=ve.useBoxProjectedEnv,exports.BBAnchor=Fe.BBAnchor,exports.TrailTexture=Be.TrailTexture,exports.useTrailTexture=Be.useTrailTexture,exports.Example=Ae.Example,exports.SpriteAnimator=Le.SpriteAnimator,exports.useSpriteAnimator=Le.useSpriteAnimator,exports.CurveModifier=De.CurveModifier,exports.MeshDistortMaterial=ye.MeshDistortMaterial,exports.MeshWobbleMaterial=ke.MeshWobbleMaterial,exports.MeshReflectorMaterial=Ee.MeshReflectorMaterial,exports.MeshRefractionMaterial=Ge.MeshRefractionMaterial,exports.MeshTransmissionMaterial=Re.MeshTransmissionMaterial,exports.MeshDiscardMaterial=we.MeshDiscardMaterial,exports.MultiMaterial=ze.MultiMaterial,exports.PointMaterial=Ie.PointMaterial,exports.PointMaterialImpl=Ie.PointMaterialImpl,exports.shaderMaterial=Oe.shaderMaterial,exports.SoftShadows=Ve.SoftShadows,exports.Box=He.Box,exports.Capsule=He.Capsule,exports.Circle=He.Circle,exports.Cone=He.Cone,exports.Cylinder=He.Cylinder,exports.Dodecahedron=He.Dodecahedron,exports.Extrude=He.Extrude,exports.Icosahedron=He.Icosahedron,exports.Lathe=He.Lathe,exports.Octahedron=He.Octahedron,exports.Plane=He.Plane,exports.Polyhedron=He.Polyhedron,exports.Ring=He.Ring,exports.Shape=He.Shape,exports.Sphere=He.Sphere,exports.Tetrahedron=He.Tetrahedron,exports.Torus=He.Torus,exports.TorusKnot=He.TorusKnot,exports.Tube=He.Tube,exports.RoundedBox=Ke.RoundedBox,exports.RoundedBoxGeometry=Ke.RoundedBoxGeometry,exports.ScreenQuad=We.ScreenQuad,exports.Center=Qe.Center,exports.Resize=Ne.Resize,exports.Bounds=Ue.Bounds,exports.useBounds=Ue.useBounds,exports.CameraShake=Xe.CameraShake,exports.Float=_e.Float,exports.Stage=Je.Stage,exports.Backdrop=Ye.Backdrop,exports.Shadow=Ze.Shadow,exports.Caustics=$e.Caustics,exports.ContactShadows=er.ContactShadows,exports.AccumulativeShadows=rr.AccumulativeShadows,exports.RandomizedLight=rr.RandomizedLight,exports.accumulativeContext=rr.accumulativeContext,exports.SpotLight=sr.SpotLight,exports.SpotLightShadow=sr.SpotLightShadow,exports.Environment=or.Environment,exports.EnvironmentCube=or.EnvironmentCube,exports.EnvironmentMap=or.EnvironmentMap,exports.EnvironmentPortal=or.EnvironmentPortal,exports.Lightformer=tr.Lightformer,exports.Sky=ir.Sky,exports.calcPosFromAngles=ir.calcPosFromAngles,exports.Stars=ar.Stars,exports.Cloud=cr.Cloud,exports.CloudInstance=cr.CloudInstance,exports.Clouds=cr.Clouds,exports.Sparkles=ur.Sparkles,exports.useEnvironment=nr.useEnvironment,exports.MatcapTexture=pr.MatcapTexture,exports.useMatcapTexture=pr.useMatcapTexture,exports.NormalTexture=jr.NormalTexture,exports.useNormalTexture=jr.useNormalTexture,exports.Wireframe=lr.Wireframe,exports.ShadowAlpha=xr.ShadowAlpha,exports.Point=dr.Point,exports.Points=dr.Points,exports.PointsBuffer=dr.PointsBuffer,exports.PositionPoint=dr.PositionPoint,exports.Instance=qr.Instance,exports.InstancedAttribute=qr.InstancedAttribute,exports.Instances=qr.Instances,exports.Merged=qr.Merged,exports.PositionMesh=qr.PositionMesh,exports.createInstances=qr.createInstances,exports.Segment=mr.Segment,exports.SegmentObject=mr.SegmentObject,exports.Segments=mr.Segments,exports.Detailed=Cr.Detailed,exports.Preload=hr.Preload,exports.BakeShadows=Sr.BakeShadows,exports.meshBounds=Mr.meshBounds,exports.AdaptiveDpr=Tr.AdaptiveDpr,exports.AdaptiveEvents=br.AdaptiveEvents,exports.PerformanceMonitor=Pr.PerformanceMonitor,exports.usePerformanceMonitor=Pr.usePerformanceMonitor,exports.RenderTexture=fr.RenderTexture,exports.RenderCubeTexture=gr.RenderCubeTexture,exports.Mask=vr.Mask,exports.useMask=vr.useMask,exports.Hud=Fr.Hud,exports.Fisheye=Br.Fisheye,exports.MeshPortalMaterial=Ar.MeshPortalMaterial,exports.calculateScaleFactor=Lr.calculateScaleFactor;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/web/index.js:export { Environment, EnvironmentCube, EnvironmentMap, EnvironmentPortal } from '../core/Environment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/web/index.js:export { useEnvironment } from '../core/useEnvironment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),n=require("react"),t=require("@react-three/fiber"),r=require("three"),o=require("three-stdlib"),u=require("./useEnvironment.cjs.js");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}})),n.default=e,Object.freeze(n)}require("@monogrid/gainmap-js"),require("../helpers/environment-assets.cjs.js");var s=a(e),c=i(n);function l(e,n,r,o,u={}){var a,i,s,c;u={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...u};const l=(e=>{return(n=e).current&&n.current.isScene?e.current:e;var n})(n||r),d=l.background,m=l.environment,g={backgroundBlurriness:l.backgroundBlurriness,backgroundIntensity:l.backgroundIntensity,backgroundRotation:null!==(a=null==(i=l.backgroundRotation)||null==i.clone?void 0:i.clone())&&void 0!==a?a:[0,0,0],environmentIntensity:l.environmentIntensity,environmentRotation:null!==(s=null==(c=l.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==s?s:[0,0,0]};return"only"!==e&&(l.environment=o),e&&(l.background=o),t.applyProps(l,u),()=>{"only"!==e&&(l.environment=m),e&&(l.background=d),t.applyProps(l,g)}}function d({scene:e,background:n=!1,map:r,...o}){const u=t.useThree((e=>e.scene));return c.useLayoutEffect((()=>{if(r)return l(n,e,u,r,o)})),null}function m({background:e=!1,scene:n,blur:r,backgroundBlurriness:o,backgroundIntensity:a,backgroundRotation:i,environmentIntensity:s,environmentRotation:d,...m}){const g=u.useEnvironment(m),b=t.useThree((e=>e.scene));return c.useLayoutEffect((()=>l(e,n,b,g,{backgroundBlurriness:null!=r?r:o,backgroundIntensity:a,backgroundRotation:i,environmentIntensity:s,environmentRotation:d}))),c.useEffect((()=>()=>{g.dispose()}),[g]),null}function g({children:e,near:n=.1,far:o=1e3,resolution:u=256,frames:a=1,map:i,background:s=!1,blur:g,backgroundBlurriness:b,backgroundIntensity:f,backgroundRotation:v,environmentIntensity:p,environmentRotation:k,scene:E,files:y,path:h,preset:I,extensions:R}){const j=t.useThree((e=>e.gl)),x=t.useThree((e=>e.scene)),P=c.useRef(null),[C]=c.useState((()=>new r.Scene)),q=c.useMemo((()=>{const e=new r.WebGLCubeRenderTarget(u);return e.texture.type=r.HalfFloatType,e}),[u]);c.useEffect((()=>()=>{q.dispose()}),[q]),c.useLayoutEffect((()=>{if(1===a){const e=j.autoClear;j.autoClear=!0,P.current.update(j,C),j.autoClear=e}return l(s,E,x,q.texture,{backgroundBlurriness:null!=g?g:b,backgroundIntensity:f,backgroundRotation:v,environmentIntensity:p,environmentRotation:k})}),[e,C,q.texture,E,x,s,a,j]);let B=1;return t.useFrame((()=>{if(a===1/0||B<a){const e=j.autoClear;j.autoClear=!0,P.current.update(j,C),j.autoClear=e,B++}})),c.createElement(c.Fragment,null,t.createPortal(c.createElement(c.Fragment,null,e,c.createElement("cubeCamera",{ref:P,args:[n,o,q]}),y||I?c.createElement(m,{background:!0,files:y,preset:I,path:h,extensions:R}):i?c.createElement(d,{background:!0,map:i,extensions:R}):null),C))}function b(e){var n,r,a,i;const l=u.useEnvironment(e),m=e.map||l;c.useMemo((()=>t.extend({GroundProjectedEnvImpl:o.GroundProjectedEnv})),[]),c.useEffect((()=>()=>{l.dispose()}),[l]);const g=c.useMemo((()=>[m]),[m]),b=null==(n=e.ground)?void 0:n.height,f=null==(r=e.ground)?void 0:r.radius,v=null!==(a=null==(i=e.ground)?void 0:i.scale)&&void 0!==a?a:1e3;return c.createElement(c.Fragment,null,c.createElement(d,s.default({},e,{map:m})),c.createElement("groundProjectedEnvImpl",{args:g,scale:v,height:b,radius:f}))}exports.Environment=function(e){return e.ground?c.createElement(b,e):e.map?c.createElement(d,e):e.children?c.createElement(g,e):c.createElement(m,e)},exports.EnvironmentCube=m,exports.EnvironmentMap=d,exports.EnvironmentPortal=g;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:import { useEnvironment } from './useEnvironment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:function EnvironmentMap({
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:function EnvironmentCube({
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:  const texture = useEnvironment(rest);
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:function EnvironmentPortal({
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:  }), files || preset ? /*#__PURE__*/React.createElement(EnvironmentCube, {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:  }) : map ? /*#__PURE__*/React.createElement(EnvironmentMap, {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:function EnvironmentGround(props) {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:  const textureDefault = useEnvironment(props);
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(EnvironmentMap, _extends({}, props, {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:function Environment(props) {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:  return props.ground ? /*#__PURE__*/React.createElement(EnvironmentGround, props) : props.map ? /*#__PURE__*/React.createElement(EnvironmentMap, props) : props.children ? /*#__PURE__*/React.createElement(EnvironmentPortal, props) : /*#__PURE__*/React.createElement(EnvironmentCube, props);
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js:export { Environment, EnvironmentCube, EnvironmentMap, EnvironmentPortal };
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/index.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Billboard.cjs.js"),r=require("./ScreenSpace.cjs.js"),s=require("./ScreenSizer.cjs.js"),t=require("./QuadraticBezierLine.cjs.js"),o=require("./CubicBezierLine.cjs.js"),i=require("./CatmullRomLine.cjs.js"),a=require("./Line.cjs.js"),u=require("./PositionalAudio.cjs.js"),n=require("./Text.cjs.js"),c=require("./Text3D.cjs.js"),p=require("./Effects.cjs.js"),j=require("./GradientTexture.cjs.js"),x=require("./Image.cjs.js"),l=require("./Edges.cjs.js"),d=require("./Outlines.cjs.js"),q=require("./Trail.cjs.js"),m=require("./Sampler.cjs.js"),h=require("./ComputedAttribute.cjs.js"),C=require("./Clone.cjs.js"),M=require("./MarchingCubes.cjs.js"),S=require("./Decal.cjs.js"),T=require("./Svg.cjs.js"),b=require("./Gltf.cjs.js"),P=require("./AsciiRenderer.cjs.js"),f=require("./Splat.cjs.js"),g=require("./OrthographicCamera.cjs.js"),B=require("./PerspectiveCamera.cjs.js"),v=require("./CubeCamera.cjs.js"),A=require("./DeviceOrientationControls.cjs.js"),F=require("./FlyControls.cjs.js"),G=require("./MapControls.cjs.js"),L=require("./OrbitControls.cjs.js"),D=require("./TrackballControls.cjs.js"),E=require("./ArcballControls.cjs.js"),R=require("./TransformControls.cjs.js"),k=require("./PointerLockControls.cjs.js"),I=require("./FirstPersonControls.cjs.js"),w=require("./CameraControls.cjs.js"),z=require("./MotionPathControls.cjs.js"),y=require("./GizmoHelper.cjs.js"),O=require("./GizmoViewcube.cjs.js"),H=require("./GizmoViewport.cjs.js"),V=require("./Grid.cjs.js"),W=require("./CubeTexture.cjs.js"),K=require("./Fbx.cjs.js"),Q=require("./Ktx2.cjs.js"),N=require("./Progress.cjs.js"),U=require("./Texture.cjs.js"),X=require("./VideoTexture.cjs.js"),_=require("./useFont.cjs.js"),J=require("./useSpriteLoader.cjs.js"),Y=require("./Helper.cjs.js"),Z=require("./Stats.cjs.js"),$=require("./StatsGl.cjs.js"),ee=require("./useDepthBuffer.cjs.js"),re=require("./useAspect.cjs.js"),se=require("./useCamera.cjs.js"),te=require("./DetectGPU.cjs.js"),oe=require("./Bvh.cjs.js"),ie=require("./useContextBridge.cjs.js"),ae=require("./useAnimations.cjs.js"),ue=require("./Fbo.cjs.js"),ne=require("./useIntersect.cjs.js"),ce=require("./useBoxProjectedEnv.cjs.js"),pe=require("./BBAnchor.cjs.js"),je=require("./TrailTexture.cjs.js"),xe=require("./Example.cjs.js"),le=require("./SpriteAnimator.cjs.js"),de=require("./CurveModifier.cjs.js"),qe=require("./MeshDistortMaterial.cjs.js"),me=require("./MeshWobbleMaterial.cjs.js"),he=require("./MeshReflectorMaterial.cjs.js"),Ce=require("./MeshRefractionMaterial.cjs.js"),Me=require("./MeshTransmissionMaterial.cjs.js"),Se=require("./MeshDiscardMaterial.cjs.js"),Te=require("./MultiMaterial.cjs.js"),be=require("./PointMaterial.cjs.js"),Pe=require("./shaderMaterial.cjs.js"),fe=require("./softShadows.cjs.js"),ge=require("./shapes.cjs.js"),Be=require("./RoundedBox.cjs.js"),ve=require("./ScreenQuad.cjs.js"),Ae=require("./Center.cjs.js"),Fe=require("./Resize.cjs.js"),Ge=require("./Bounds.cjs.js"),Le=require("./CameraShake.cjs.js"),De=require("./Float.cjs.js"),Ee=require("./Stage.cjs.js"),Re=require("./Backdrop.cjs.js"),ke=require("./Shadow.cjs.js"),Ie=require("./Caustics.cjs.js"),we=require("./ContactShadows.cjs.js"),ze=require("./AccumulativeShadows.cjs.js"),ye=require("./SpotLight.cjs.js"),Oe=require("./Environment.cjs.js"),He=require("./Lightformer.cjs.js"),Ve=require("./Sky.cjs.js"),We=require("./Stars.cjs.js"),Ke=require("./Cloud.cjs.js"),Qe=require("./Sparkles.cjs.js"),Ne=require("./useEnvironment.cjs.js"),Ue=require("./MatcapTexture.cjs.js"),Xe=require("./NormalTexture.cjs.js"),_e=require("./Wireframe.cjs.js"),Je=require("./ShadowAlpha.cjs.js"),Ye=require("./Points.cjs.js"),Ze=require("./Instances.cjs.js"),$e=require("./Segments.cjs.js"),er=require("./Detailed.cjs.js"),rr=require("./Preload.cjs.js"),sr=require("./BakeShadows.cjs.js"),tr=require("./meshBounds.cjs.js"),or=require("./AdaptiveDpr.cjs.js"),ir=require("./AdaptiveEvents.cjs.js"),ar=require("./PerformanceMonitor.cjs.js"),ur=require("./RenderTexture.cjs.js"),nr=require("./RenderCubeTexture.cjs.js"),cr=require("./Mask.cjs.js"),pr=require("./Hud.cjs.js"),jr=require("./Fisheye.cjs.js"),xr=require("./MeshPortalMaterial.cjs.js"),lr=require("./calculateScaleFactor.cjs.js"),dr=require("camera-controls");function qr(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("@babel/runtime/helpers/extends"),require("react"),require("three"),require("@react-three/fiber"),require("three-stdlib"),require("troika-three-text"),require("suspend-react"),require("../helpers/constants.cjs.js"),require("meshline"),require("maath"),require("zustand"),require("hls.js"),require("stats.js"),require("../helpers/useEffectfulState.cjs.js"),require("stats-gl"),require("detect-gpu"),require("three-mesh-bvh"),require("../helpers/deprecated.cjs.js"),require("../materials/BlurPass.cjs.js"),require("../materials/ConvolutionMaterial.cjs.js"),require("../materials/MeshReflectorMaterial.cjs.js"),require("../materials/MeshRefractionMaterial.cjs.js"),require("../materials/DiscardMaterial.cjs.js"),require("@monogrid/gainmap-js"),require("../helpers/environment-assets.cjs.js"),require("../materials/SpotLightMaterial.cjs.js"),require("../materials/WireframeMaterial.cjs.js");var mr=qr(dr);exports.Billboard=e.Billboard,exports.ScreenSpace=r.ScreenSpace,exports.ScreenSizer=s.ScreenSizer,exports.QuadraticBezierLine=t.QuadraticBezierLine,exports.CubicBezierLine=o.CubicBezierLine,exports.CatmullRomLine=i.CatmullRomLine,exports.Line=a.Line,exports.PositionalAudio=u.PositionalAudio,exports.Text=n.Text,exports.Text3D=c.Text3D,exports.Effects=p.Effects,exports.isWebGL2Available=p.isWebGL2Available,exports.GradientTexture=j.GradientTexture,exports.GradientType=j.GradientType,exports.Image=x.Image,exports.Edges=l.Edges,exports.Outlines=d.Outlines,exports.Trail=q.Trail,exports.useTrail=q.useTrail,exports.Sampler=m.Sampler,exports.useSurfaceSampler=m.useSurfaceSampler,exports.ComputedAttribute=h.ComputedAttribute,exports.Clone=C.Clone,exports.MarchingCube=M.MarchingCube,exports.MarchingCubes=M.MarchingCubes,exports.MarchingPlane=M.MarchingPlane,exports.Decal=S.Decal,exports.Svg=T.Svg,exports.Gltf=b.Gltf,exports.useGLTF=b.useGLTF,exports.AsciiRenderer=P.AsciiRenderer,exports.Splat=f.Splat,exports.OrthographicCamera=g.OrthographicCamera,exports.PerspectiveCamera=B.PerspectiveCamera,exports.CubeCamera=v.CubeCamera,exports.useCubeCamera=v.useCubeCamera,exports.DeviceOrientationControls=A.DeviceOrientationControls,exports.FlyControls=F.FlyControls,exports.MapControls=G.MapControls,exports.OrbitControls=L.OrbitControls,exports.TrackballControls=D.TrackballControls,exports.ArcballControls=E.ArcballControls,exports.TransformControls=R.TransformControls,exports.PointerLockControls=k.PointerLockControls,exports.FirstPersonControls=I.FirstPersonControls,exports.CameraControls=w.CameraControls,exports.MotionPathControls=z.MotionPathControls,exports.useMotion=z.useMotion,exports.GizmoHelper=y.GizmoHelper,exports.useGizmoContext=y.useGizmoContext,exports.GizmoViewcube=O.GizmoViewcube,exports.GizmoViewport=H.GizmoViewport,exports.Grid=V.Grid,exports.CubeTexture=W.CubeTexture,exports.useCubeTexture=W.useCubeTexture,exports.Fbx=K.Fbx,exports.useFBX=K.useFBX,exports.Ktx2=Q.Ktx2,exports.useKTX2=Q.useKTX2,exports.Progress=N.Progress,exports.useProgress=N.useProgress,exports.IsObject=U.IsObject,exports.Texture=U.Texture,exports.useTexture=U.useTexture,exports.VideoTexture=X.VideoTexture,exports.useVideoTexture=X.useVideoTexture,exports.useFont=_.useFont,exports.checkIfFrameIsEmpty=J.checkIfFrameIsEmpty,exports.getFirstFrame=J.getFirstFrame,exports.useSpriteLoader=J.useSpriteLoader,exports.Helper=Y.Helper,exports.useHelper=Y.useHelper,exports.Stats=Z.Stats,exports.StatsGl=$.StatsGl,exports.useDepthBuffer=ee.useDepthBuffer,exports.useAspect=re.useAspect,exports.useCamera=se.useCamera,exports.DetectGPU=te.DetectGPU,exports.useDetectGPU=te.useDetectGPU,exports.Bvh=oe.Bvh,exports.useBVH=oe.useBVH,exports.useContextBridge=ie.useContextBridge,exports.useAnimations=ae.useAnimations,exports.Fbo=ue.Fbo,exports.useFBO=ue.useFBO,exports.useIntersect=ne.useIntersect,exports.useBoxProjectedEnv=ce.useBoxProjectedEnv,exports.BBAnchor=pe.BBAnchor,exports.TrailTexture=je.TrailTexture,exports.useTrailTexture=je.useTrailTexture,exports.Example=xe.Example,exports.SpriteAnimator=le.SpriteAnimator,exports.useSpriteAnimator=le.useSpriteAnimator,exports.CurveModifier=de.CurveModifier,exports.MeshDistortMaterial=qe.MeshDistortMaterial,exports.MeshWobbleMaterial=me.MeshWobbleMaterial,exports.MeshReflectorMaterial=he.MeshReflectorMaterial,exports.MeshRefractionMaterial=Ce.MeshRefractionMaterial,exports.MeshTransmissionMaterial=Me.MeshTransmissionMaterial,exports.MeshDiscardMaterial=Se.MeshDiscardMaterial,exports.MultiMaterial=Te.MultiMaterial,exports.PointMaterial=be.PointMaterial,exports.PointMaterialImpl=be.PointMaterialImpl,exports.shaderMaterial=Pe.shaderMaterial,exports.SoftShadows=fe.SoftShadows,exports.Box=ge.Box,exports.Capsule=ge.Capsule,exports.Circle=ge.Circle,exports.Cone=ge.Cone,exports.Cylinder=ge.Cylinder,exports.Dodecahedron=ge.Dodecahedron,exports.Extrude=ge.Extrude,exports.Icosahedron=ge.Icosahedron,exports.Lathe=ge.Lathe,exports.Octahedron=ge.Octahedron,exports.Plane=ge.Plane,exports.Polyhedron=ge.Polyhedron,exports.Ring=ge.Ring,exports.Shape=ge.Shape,exports.Sphere=ge.Sphere,exports.Tetrahedron=ge.Tetrahedron,exports.Torus=ge.Torus,exports.TorusKnot=ge.TorusKnot,exports.Tube=ge.Tube,exports.RoundedBox=Be.RoundedBox,exports.RoundedBoxGeometry=Be.RoundedBoxGeometry,exports.ScreenQuad=ve.ScreenQuad,exports.Center=Ae.Center,exports.Resize=Fe.Resize,exports.Bounds=Ge.Bounds,exports.useBounds=Ge.useBounds,exports.CameraShake=Le.CameraShake,exports.Float=De.Float,exports.Stage=Ee.Stage,exports.Backdrop=Re.Backdrop,exports.Shadow=ke.Shadow,exports.Caustics=Ie.Caustics,exports.ContactShadows=we.ContactShadows,exports.AccumulativeShadows=ze.AccumulativeShadows,exports.RandomizedLight=ze.RandomizedLight,exports.accumulativeContext=ze.accumulativeContext,exports.SpotLight=ye.SpotLight,exports.SpotLightShadow=ye.SpotLightShadow,exports.Environment=Oe.Environment,exports.EnvironmentCube=Oe.EnvironmentCube,exports.EnvironmentMap=Oe.EnvironmentMap,exports.EnvironmentPortal=Oe.EnvironmentPortal,exports.Lightformer=He.Lightformer,exports.Sky=Ve.Sky,exports.calcPosFromAngles=Ve.calcPosFromAngles,exports.Stars=We.Stars,exports.Cloud=Ke.Cloud,exports.CloudInstance=Ke.CloudInstance,exports.Clouds=Ke.Clouds,exports.Sparkles=Qe.Sparkles,exports.useEnvironment=Ne.useEnvironment,exports.MatcapTexture=Ue.MatcapTexture,exports.useMatcapTexture=Ue.useMatcapTexture,exports.NormalTexture=Xe.NormalTexture,exports.useNormalTexture=Xe.useNormalTexture,exports.Wireframe=_e.Wireframe,exports.ShadowAlpha=Je.ShadowAlpha,exports.Point=Ye.Point,exports.Points=Ye.Points,exports.PointsBuffer=Ye.PointsBuffer,exports.PositionPoint=Ye.PositionPoint,exports.Instance=Ze.Instance,exports.InstancedAttribute=Ze.InstancedAttribute,exports.Instances=Ze.Instances,exports.Merged=Ze.Merged,exports.PositionMesh=Ze.PositionMesh,exports.createInstances=Ze.createInstances,exports.Segment=$e.Segment,exports.SegmentObject=$e.SegmentObject,exports.Segments=$e.Segments,exports.Detailed=er.Detailed,exports.Preload=rr.Preload,exports.BakeShadows=sr.BakeShadows,exports.meshBounds=tr.meshBounds,exports.AdaptiveDpr=or.AdaptiveDpr,exports.AdaptiveEvents=ir.AdaptiveEvents,exports.PerformanceMonitor=ar.PerformanceMonitor,exports.usePerformanceMonitor=ar.usePerformanceMonitor,exports.RenderTexture=ur.RenderTexture,exports.RenderCubeTexture=nr.RenderCubeTexture,exports.Mask=cr.Mask,exports.useMask=cr.useMask,exports.Hud=pr.Hud,exports.Fisheye=jr.Fisheye,exports.MeshPortalMaterial=xr.MeshPortalMaterial,exports.calculateScaleFactor=lr.calculateScaleFactor,Object.defineProperty(exports,"CameraControlsImpl",{enumerable:!0,get:function(){return mr.default}});
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/index.js:export { Environment, EnvironmentCube, EnvironmentMap, EnvironmentPortal } from './Environment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/index.js:export { useEnvironment } from './useEnvironment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/MeshTransmissionMaterial.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("@babel/runtime/helpers/extends"),e=require("three"),t=require("react"),a=require("@react-three/fiber"),r=require("./Fbo.cjs.js"),o=require("../materials/DiscardMaterial.cjs.js");function i(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}function s(n){if(n&&n.__esModule)return n;var e=Object.create(null);return n&&Object.keys(n).forEach((function(t){if("default"!==t){var a=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,a.get?a:{enumerable:!0,get:function(){return n[t]}})}})),e.default=n,Object.freeze(e)}require("./shaderMaterial.cjs.js");var l=i(n),c=s(e),m=s(t);class u extends c.MeshPhysicalMaterial{constructor(n=6,e=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new c.Color("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=t=>{t.uniforms={...t.uniforms,...this.uniforms},this.anisotropy>0&&(t.defines.USE_ANISOTROPY=""),e?t.defines.USE_SAMPLER="":t.defines.USE_TRANSMISSION="",t.fragmentShader="\n      uniform float chromaticAberration;         \n      uniform float anisotropicBlur;      \n      uniform float time;\n      uniform float distortion;\n      uniform float distortionScale;\n      uniform float temporalDistortion;\n      uniform sampler2D buffer;\n\n      vec3 random3(vec3 c) {\n        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n        vec3 r;\n        r.z = fract(512.0*j);\n        j *= .125;\n        r.x = fract(512.0*j);\n        j *= .125;\n        r.y = fract(512.0*j);\n        return r-0.5;\n      }\n\n      uint hash( uint x ) {\n        x += ( x << 10u );\n        x ^= ( x >>  6u );\n        x += ( x <<  3u );\n        x ^= ( x >> 11u );\n        x += ( x << 15u );\n        return x;\n      }\n\n      // Compound versions of the hashing algorithm I whipped together.\n      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }\n      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }\n      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }\n\n      // Construct a float with half-open range [0:1] using low 23 bits.\n      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.\n      float floatConstruct( uint m ) {\n        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask\n        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32\n        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)\n        m |= ieeeOne;                          // Add fractional part to 1.0\n        float  f = uintBitsToFloat( m );       // Range [1:2]\n        return f - 1.0;                        // Range [0:1]\n      }\n\n      // Pseudo-random value in half-open range [0:1].\n      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }\n      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float rand(float seed) {\n        float result = randomBase(vec3(gl_FragCoord.xy, seed));\n        return result;\n      }\n\n      const float F3 =  0.3333333;\n      const float G3 =  0.1666667;\n\n      float snoise(vec3 p) {\n        vec3 s = floor(p + dot(p, vec3(F3)));\n        vec3 x = p - s + dot(s, vec3(G3));\n        vec3 e = step(vec3(0.0), x - x.yzx);\n        vec3 i1 = e*(1.0 - e.zxy);\n        vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n        vec3 x1 = x - i1 + G3;\n        vec3 x2 = x - i2 + 2.0*G3;\n        vec3 x3 = x - 1.0 + 3.0*G3;\n        vec4 w, d;\n        w.x = dot(x, x);\n        w.y = dot(x1, x1);\n        w.z = dot(x2, x2);\n        w.w = dot(x3, x3);\n        w = max(0.6 - w, 0.0);\n        d.x = dot(random3(s), x);\n        d.y = dot(random3(s + i1), x1);\n        d.z = dot(random3(s + i2), x2);\n        d.w = dot(random3(s + 1.0), x3);\n        w *= w;\n        w *= w;\n        d *= w;\n        return dot(d, vec4(52.0));\n      }\n\n      float snoiseFractal(vec3 m) {\n        return 0.5333333* snoise(m)\n              +0.2666667* snoise(2.0*m)\n              +0.1333333* snoise(4.0*m)\n              +0.0666667* snoise(8.0*m);\n      }\n"+t.fragmentShader,t.fragmentShader=t.fragmentShader.replace("#include <transmission_pars_fragment>","\n        #ifdef USE_TRANSMISSION\n          // Transmission code is based on glTF-Sampler-Viewer\n          // https://github.com/KhronosGroup/glTF-Sample-Viewer\n          uniform float _transmission;\n          uniform float thickness;\n          uniform float attenuationDistance;\n          uniform vec3 attenuationColor;\n          #ifdef USE_TRANSMISSIONMAP\n            uniform sampler2D transmissionMap;\n          #endif\n          #ifdef USE_THICKNESSMAP\n            uniform sampler2D thicknessMap;\n          #endif\n          uniform vec2 transmissionSamplerSize;\n          uniform sampler2D transmissionSamplerMap;\n          uniform mat4 modelMatrix;\n          uniform mat4 projectionMatrix;\n          varying vec3 vWorldPosition;\n          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n            // Direction of refracted light.\n            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n            // Compute rotation-independant scaling of the model matrix.\n            vec3 modelScale;\n            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n            // The thickness is specified in local space.\n            return normalize( refractionVector ) * thickness * modelScale;\n          }\n          float applyIorToRoughness( const in float roughness, const in float ior ) {\n            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n            // an IOR of 1.5 results in the default amount of microfacet refraction.\n            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n          }\n          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            \n            #ifdef USE_SAMPLER\n              #ifdef texture2DLodEXT\n                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #else\n                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #endif\n            #else\n              return texture2D(buffer, fragCoord.xy);\n            #endif\n          }\n          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n            if ( isinf( attenuationDistance ) ) {\n              // Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.\n              return radiance;\n            } else {\n              // Compute light attenuation using Beer's law.\n              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law\n              return transmittance * radiance;\n            }\n          }\n          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n            const in vec3 attenuationColor, const in float attenuationDistance ) {\n            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n            vec3 refractedRayExit = position + transmissionRay;\n            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n            vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n            refractionCoords += 1.0;\n            refractionCoords /= 2.0;\n            // Sample framebuffer to get pixel the refracted ray hits.\n            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n            // Get the specular component.\n            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n          }\n        #endif\n"),t.fragmentShader=t.fragmentShader.replace("#include <transmission_fragment>",`  \n        // Improve the refraction to use the world pos\n        material.transmission = _transmission;\n        material.transmissionAlpha = 1.0;\n        material.thickness = thickness;\n        material.attenuationDistance = attenuationDistance;\n        material.attenuationColor = attenuationColor;\n        #ifdef USE_TRANSMISSIONMAP\n          material.transmission *= texture2D( transmissionMap, vUv ).r;\n        #endif\n        #ifdef USE_THICKNESSMAP\n          material.thickness *= texture2D( thicknessMap, vUv ).g;\n        #endif\n        \n        vec3 pos = vWorldPosition;\n        float runningSeed = 0.0;\n        vec3 v = normalize( cameraPosition - pos );\n        vec3 n = inverseTransformDirection( normal, viewMatrix );\n        vec3 transmission = vec3(0.0);\n        float transmissionR, transmissionB, transmissionG;\n        float randomCoords = rand(runningSeed++);\n        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);\n        vec3 distortionNormal = vec3(0.0);\n        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;\n        if (distortion > 0.0) {\n          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));\n        }\n        for (float i = 0.0; i < ${n}.0; i ++) {\n          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);\n          transmissionR = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(${n}),\n            material.attenuationColor, material.attenuationDistance\n          ).r;\n          transmissionG = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(${n})) , material.thickness + thickness_smear * (i + randomCoords) / float(${n}),\n            material.attenuationColor, material.attenuationDistance\n          ).g;\n          transmissionB = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(${n})), material.thickness + thickness_smear * (i + randomCoords) / float(${n}),\n            material.attenuationColor, material.attenuationDistance\n          ).b;\n          transmission.r += transmissionR;\n          transmission.g += transmissionG;\n          transmission.b += transmissionB;\n        }\n        transmission /= ${n}.0;\n        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n`)},Object.keys(this.uniforms).forEach((n=>Object.defineProperty(this,n,{get:()=>this.uniforms[n].value,set:e=>this.uniforms[n].value=e})))}}const f=m.forwardRef((({buffer:n,transmissionSampler:e=!1,backside:t=!1,side:i=c.FrontSide,transmission:s=1,thickness:f=0,backsideThickness:d=0,backsideEnvMapIntensity:v=1,samples:h=10,resolution:p,backsideResolution:x,background:g,anisotropy:S,anisotropicBlur:M,...b},C)=>{a.extend({MeshTransmissionMaterial:u});const y=m.useRef(null),[w]=m.useState((()=>new o.DiscardMaterial)),k=r.useFBO(x||p),D=r.useFBO(p);let R,T,F,j;return a.useFrame((n=>{var a;(y.current.time=n.clock.elapsedTime,y.current.buffer!==D.texture||e)||(j=null==(a=y.current.__r3f.parent)?void 0:a.object,j&&(F=n.gl.toneMapping,R=n.scene.background,T=y.current.envMapIntensity,n.gl.toneMapping=c.NoToneMapping,g&&(n.scene.background=g),j.material=w,t&&(n.gl.setRenderTarget(k),n.gl.render(n.scene,n.camera),j.material=y.current,j.material.buffer=k.texture,j.material.thickness=d,j.material.side=c.BackSide,j.material.envMapIntensity=v),n.gl.setRenderTarget(D),n.gl.render(n.scene,n.camera),j.material=y.current,j.material.thickness=f,j.material.side=i,j.material.buffer=D.texture,j.material.envMapIntensity=T,n.scene.background=R,n.gl.setRenderTarget(null),n.gl.toneMapping=F))})),m.useImperativeHandle(C,(()=>y.current),[]),m.createElement("meshTransmissionMaterial",l.default({args:[h,e],ref:y},b,{buffer:n||D.texture,_transmission:s,anisotropicBlur:null!=M?M:S,transmission:e?s:0,thickness:f,side:i}))}));exports.MeshTransmissionMaterial=f;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/MeshTransmissionMaterial.js:            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Stage.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("react"),i=require("./Environment.cjs.js"),n=require("./ContactShadows.cjs.js"),r=require("./Center.cjs.js"),a=require("./AccumulativeShadows.cjs.js"),s=require("./Bounds.cjs.js");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function u(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}require("@react-three/fiber"),require("three"),require("three-stdlib"),require("./useEnvironment.cjs.js"),require("@monogrid/gainmap-js"),require("../helpers/environment-assets.cjs.js"),require("./shaderMaterial.cjs.js"),require("../materials/DiscardMaterial.cjs.js"),require("../helpers/constants.cjs.js");var o=l(e),c=u(t);const d={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function m({radius:e,adjustCamera:t}){const i=s.useBounds();return c.useEffect((()=>{t&&i.refresh().clip().fit()}),[e,t]),null}exports.Stage=function({children:e,center:t,adjustCamera:l=!0,intensity:u=.5,shadows:f="contact",environment:p="city",preset:h="rembrandt",...j}){var v,b,g,y,E,q,w,C;const S="string"==typeof h?d[h]:h,[{radius:O,height:z},B]=c.useState({radius:0,width:0,height:0,depth:0}),M=null!==(v=null==f?void 0:f.bias)&&void 0!==v?v:-1e-4,L=null!==(b=null==f?void 0:f.normalBias)&&void 0!==b?b:0,_=null!==(g=null==f?void 0:f.size)&&void 0!==g?g:1024,x=null!==(y=null==f?void 0:f.offset)&&void 0!==y?y:0,P="contact"===f||"contact"===(null==f?void 0:f.type),k="accumulative"===f||"accumulative"===(null==f?void 0:f.type),A={..."object"==typeof f?f:{}},D=p?"string"==typeof p?{preset:p}:p:null,F=c.useCallback((e=>{const{width:i,height:n,depth:r,boundingSphere:a}=e;B({radius:a.radius,width:i,height:n,depth:r}),null!=t&&t.onCentered&&t.onCentered(e)}),[]);return c.createElement(c.Fragment,null,c.createElement("ambientLight",{intensity:u/3}),c.createElement("spotLight",{penumbra:1,position:[S.main[0]*O,S.main[1]*O,S.main[2]*O],intensity:2*u,castShadow:!!f,"shadow-bias":M,"shadow-normalBias":L,"shadow-mapSize":_}),c.createElement("pointLight",{position:[S.fill[0]*O,S.fill[1]*O,S.fill[2]*O],intensity:u}),c.createElement(s.Bounds,o.default({fit:!!l,clip:!!l,margin:Number(l),observe:!0},j),c.createElement(m,{radius:O,adjustCamera:l}),c.createElement(r.Center,o.default({},t,{position:[0,x/2,0],onCentered:F}),e)),c.createElement("group",{position:[0,-z/2-x/2,0]},P&&c.createElement(n.ContactShadows,o.default({scale:4*O,far:O,blur:2},A)),k&&c.createElement(a.AccumulativeShadows,o.default({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:4*O},A),c.createElement(a.RandomizedLight,{amount:null!==(E=A.amount)&&void 0!==E?E:8,radius:null!==(q=A.radius)&&void 0!==q?q:O,ambient:null!==(w=A.ambient)&&void 0!==w?w:.5,intensity:null!==(C=A.intensity)&&void 0!==C?C:1,position:[S.main[0]*O,S.main[1]*O,S.main[2]*O],size:4*O,bias:-M,mapSize:_}))),p&&c.createElement(i.Environment,D))};
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Stage.js:import { Environment } from './Environment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Stage.js:  }))), environment && /*#__PURE__*/React.createElement(Environment, environmentProps));
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@react-three/fiber"),t=require("three"),n=require("three-stdlib"),r=require("@monogrid/gainmap-js"),s=require("../helpers/environment-assets.cjs.js"),o=require("react");const i="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",p=e=>Array.isArray(e),a=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function l({files:n=a,path:r="",preset:l,colorSpace:c,extensions:u}={}){l&&(d(l),n=s.presetsObj[l],r=i);const h=p(n),{extension:f,isCubemap:j}=g(n),m=b(f);if(!m)throw new Error("useEnvironment: Unrecognized file extension: "+n);const x=e.useThree((e=>e.gl));o.useLayoutEffect((()=>{"webp"!==f&&"jpg"!==f&&"jpeg"!==f||x.domElement.addEventListener("webglcontextlost",(function(){e.useLoader.clear(m,h?[n]:n)}),{once:!0})}),[n,x.domElement]);const w=e.useLoader(m,h?[n]:n,(e=>{"webp"!==f&&"jpg"!==f&&"jpeg"!==f||e.setRenderer(x),null==e.setPath||e.setPath(r),u&&u(e)}));let E=h?w[0]:w;var v;"jpg"!==f&&"jpeg"!==f&&"webp"!==f||(E=null==(v=E.renderTarget)?void 0:v.texture);return E.mapping=j?t.CubeReflectionMapping:t.EquirectangularReflectionMapping,E.colorSpace=null!=c?c:j?"srgb":"srgb-linear",E}const c={files:a,path:"",preset:void 0,extensions:void 0};l.preload=t=>{const n={...c,...t};let{files:r,path:o=""}=n;const{preset:a,extensions:l}=n;a&&(d(a),r=s.presetsObj[a],o=i);const{extension:u}=g(r);if("webp"===u||"jpg"===u||"jpeg"===u)throw new Error("useEnvironment: Preloading gainmaps is not supported");const h=b(u);if(!h)throw new Error("useEnvironment: Unrecognized file extension: "+r);e.useLoader.preload(h,p(r)?[r]:r,(e=>{null==e.setPath||e.setPath(o),l&&l(e)}))};const u={files:a,preset:void 0};function d(e){if(!(e in s.presetsObj))throw new Error("Preset must be one of: "+Object.keys(s.presetsObj).join(", "))}function g(e){var t;const n=p(e)&&6===e.length,r=p(e)&&3===e.length&&e.some((e=>e.endsWith("json"))),s=p(e)?e[0]:e;return{extension:n?"cube":r?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":null==(t=s.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:n,isGainmap:r}}function b(e){return"cube"===e?t.CubeTextureLoader:"hdr"===e?n.RGBELoader:"exr"===e?n.EXRLoader:"jpg"===e||"jpeg"===e?r.HDRJPGLoader:"webp"===e?r.GainMapLoader:null}l.clear=t=>{const n={...u,...t};let{files:r}=n;const{preset:o}=n;o&&(d(o),r=s.presetsObj[o]);const{extension:i}=g(r),a=b(i);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+r);e.useLoader.clear(a,p(r)?[r]:r)},exports.useEnvironment=l;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:function useEnvironment({
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:  if (!loader) throw new Error('useEnvironment: Unrecognized file extension: ' + files);
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:useEnvironment.preload = preloadOptions => {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:    throw new Error('useEnvironment: Preloading gainmaps is not supported');
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:  if (!loader) throw new Error('useEnvironment: Unrecognized file extension: ' + files);
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:useEnvironment.clear = clearOptions => {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:  if (!loader) throw new Error('useEnvironment: Unrecognized file extension: ' + files);
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js:export { useEnvironment };
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:import { EnvironmentLoaderProps } from './useEnvironment';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:export type EnvironmentProps = {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:} & EnvironmentLoaderProps;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:export declare function EnvironmentMap({ scene, background, map, ...config }: EnvironmentProps): null;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:export declare function EnvironmentCube({ background, scene, blur, backgroundBlurriness, backgroundIntensity, backgroundRotation, environmentIntensity, environmentRotation, ...rest }: EnvironmentProps): null;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:export declare function EnvironmentPortal({ children, near, far, resolution, frames, map, background, blur, backgroundBlurriness, backgroundIntensity, backgroundRotation, environmentIntensity, environmentRotation, scene, files, path, preset, extensions, }: EnvironmentProps): React.JSX.Element;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.d.ts:export declare function Environment(props: EnvironmentProps): React.JSX.Element;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/index.d.ts:export * from './Environment';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/index.d.ts:export * from './useEnvironment';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Stage.d.ts:import { EnvironmentProps } from './Environment';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Stage.d.ts:    environment?: PresetsType | Partial<EnvironmentProps> | null;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:export type EnvironmentLoaderProps = {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:export declare function useEnvironment({ files, path, preset, colorSpace, extensions, }?: Partial<EnvironmentLoaderProps>): Texture | CubeTexture;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:export declare namespace useEnvironment {
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:    var preload: (preloadOptions?: EnvironmentLoaderPreloadOptions) => void;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:    var clear: (clearOptions?: EnvironmentLoaderClearOptions) => void;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:type EnvironmentLoaderPreloadOptions = Omit<EnvironmentLoaderProps, 'encoding'>;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.d.ts:type EnvironmentLoaderClearOptions = Pick<EnvironmentLoaderProps, 'files' | 'preset'>;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/native/index.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../core/Billboard.cjs.js"),r=require("../core/ScreenSpace.cjs.js"),s=require("../core/ScreenSizer.cjs.js"),o=require("../core/QuadraticBezierLine.cjs.js"),t=require("../core/CubicBezierLine.cjs.js"),i=require("../core/CatmullRomLine.cjs.js"),a=require("../core/Line.cjs.js"),c=require("../core/PositionalAudio.cjs.js"),u=require("../core/Text.cjs.js"),n=require("../core/Text3D.cjs.js"),p=require("../core/Effects.cjs.js"),j=require("../core/GradientTexture.cjs.js"),x=require("../core/Image.cjs.js"),l=require("../core/Edges.cjs.js"),d=require("../core/Outlines.cjs.js"),q=require("../core/Trail.cjs.js"),m=require("../core/Sampler.cjs.js"),h=require("../core/ComputedAttribute.cjs.js"),C=require("../core/Clone.cjs.js"),M=require("../core/MarchingCubes.cjs.js"),S=require("../core/Decal.cjs.js"),T=require("../core/Svg.cjs.js"),b=require("../core/Gltf.cjs.js"),P=require("../core/AsciiRenderer.cjs.js"),f=require("../core/Splat.cjs.js"),g=require("../core/OrthographicCamera.cjs.js"),B=require("../core/PerspectiveCamera.cjs.js"),v=require("../core/CubeCamera.cjs.js"),A=require("../core/DeviceOrientationControls.cjs.js"),F=require("../core/FlyControls.cjs.js"),G=require("../core/MapControls.cjs.js"),L=require("../core/OrbitControls.cjs.js"),D=require("../core/TrackballControls.cjs.js"),E=require("../core/ArcballControls.cjs.js"),R=require("../core/TransformControls.cjs.js"),k=require("../core/PointerLockControls.cjs.js"),I=require("../core/FirstPersonControls.cjs.js"),w=require("../core/CameraControls.cjs.js"),z=require("camera-controls"),y=require("../core/MotionPathControls.cjs.js"),O=require("../core/GizmoHelper.cjs.js"),H=require("../core/GizmoViewcube.cjs.js"),V=require("../core/GizmoViewport.cjs.js"),W=require("../core/Grid.cjs.js"),K=require("../core/CubeTexture.cjs.js"),Q=require("../core/Fbx.cjs.js"),N=require("../core/Ktx2.cjs.js"),U=require("../core/Progress.cjs.js"),X=require("../core/Texture.cjs.js"),_=require("../core/VideoTexture.cjs.js"),J=require("../core/useFont.cjs.js"),Y=require("../core/useSpriteLoader.cjs.js"),Z=require("../core/Helper.cjs.js"),$=require("../core/Stats.cjs.js"),ee=require("../core/StatsGl.cjs.js"),re=require("../core/useDepthBuffer.cjs.js"),se=require("../core/useAspect.cjs.js"),oe=require("../core/useCamera.cjs.js"),te=require("../core/DetectGPU.cjs.js"),ie=require("../core/Bvh.cjs.js"),ae=require("../core/useContextBridge.cjs.js"),ce=require("../core/useAnimations.cjs.js"),ue=require("../core/Fbo.cjs.js"),ne=require("../core/useIntersect.cjs.js"),pe=require("../core/useBoxProjectedEnv.cjs.js"),je=require("../core/BBAnchor.cjs.js"),xe=require("../core/TrailTexture.cjs.js"),le=require("../core/Example.cjs.js"),de=require("../core/SpriteAnimator.cjs.js"),qe=require("../core/CurveModifier.cjs.js"),me=require("../core/MeshDistortMaterial.cjs.js"),he=require("../core/MeshWobbleMaterial.cjs.js"),Ce=require("../core/MeshReflectorMaterial.cjs.js"),Me=require("../core/MeshRefractionMaterial.cjs.js"),Se=require("../core/MeshTransmissionMaterial.cjs.js"),Te=require("../core/MeshDiscardMaterial.cjs.js"),be=require("../core/MultiMaterial.cjs.js"),Pe=require("../core/PointMaterial.cjs.js"),fe=require("../core/shaderMaterial.cjs.js"),ge=require("../core/softShadows.cjs.js"),Be=require("../core/shapes.cjs.js"),ve=require("../core/RoundedBox.cjs.js"),Ae=require("../core/ScreenQuad.cjs.js"),Fe=require("../core/Center.cjs.js"),Ge=require("../core/Resize.cjs.js"),Le=require("../core/Bounds.cjs.js"),De=require("../core/CameraShake.cjs.js"),Ee=require("../core/Float.cjs.js"),Re=require("../core/Stage.cjs.js"),ke=require("../core/Backdrop.cjs.js"),Ie=require("../core/Shadow.cjs.js"),we=require("../core/Caustics.cjs.js"),ze=require("../core/ContactShadows.cjs.js"),ye=require("../core/AccumulativeShadows.cjs.js"),Oe=require("../core/SpotLight.cjs.js"),He=require("../core/Environment.cjs.js"),Ve=require("../core/Lightformer.cjs.js"),We=require("../core/Sky.cjs.js"),Ke=require("../core/Stars.cjs.js"),Qe=require("../core/Cloud.cjs.js"),Ne=require("../core/Sparkles.cjs.js"),Ue=require("../core/useEnvironment.cjs.js"),Xe=require("../core/MatcapTexture.cjs.js"),_e=require("../core/NormalTexture.cjs.js"),Je=require("../core/Wireframe.cjs.js"),Ye=require("../core/ShadowAlpha.cjs.js"),Ze=require("../core/Points.cjs.js"),$e=require("../core/Instances.cjs.js"),er=require("../core/Segments.cjs.js"),rr=require("../core/Detailed.cjs.js"),sr=require("../core/Preload.cjs.js"),or=require("../core/BakeShadows.cjs.js"),tr=require("../core/meshBounds.cjs.js"),ir=require("../core/AdaptiveDpr.cjs.js"),ar=require("../core/AdaptiveEvents.cjs.js"),cr=require("../core/PerformanceMonitor.cjs.js"),ur=require("../core/RenderTexture.cjs.js"),nr=require("../core/RenderCubeTexture.cjs.js"),pr=require("../core/Mask.cjs.js"),jr=require("../core/Hud.cjs.js"),xr=require("../core/Fisheye.cjs.js"),lr=require("../core/MeshPortalMaterial.cjs.js"),dr=require("../core/calculateScaleFactor.cjs.js");function qr(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("@babel/runtime/helpers/extends"),require("react"),require("three"),require("@react-three/fiber"),require("three-stdlib"),require("troika-three-text"),require("suspend-react"),require("../helpers/constants.cjs.js"),require("meshline"),require("maath"),require("zustand"),require("hls.js"),require("stats.js"),require("../helpers/useEffectfulState.cjs.js"),require("stats-gl"),require("detect-gpu"),require("three-mesh-bvh"),require("../helpers/deprecated.cjs.js"),require("../materials/BlurPass.cjs.js"),require("../materials/ConvolutionMaterial.cjs.js"),require("../materials/MeshReflectorMaterial.cjs.js"),require("../materials/MeshRefractionMaterial.cjs.js"),require("../materials/DiscardMaterial.cjs.js"),require("@monogrid/gainmap-js"),require("../helpers/environment-assets.cjs.js"),require("../materials/SpotLightMaterial.cjs.js"),require("../materials/WireframeMaterial.cjs.js");var mr=qr(z);exports.Billboard=e.Billboard,exports.ScreenSpace=r.ScreenSpace,exports.ScreenSizer=s.ScreenSizer,exports.QuadraticBezierLine=o.QuadraticBezierLine,exports.CubicBezierLine=t.CubicBezierLine,exports.CatmullRomLine=i.CatmullRomLine,exports.Line=a.Line,exports.PositionalAudio=c.PositionalAudio,exports.Text=u.Text,exports.Text3D=n.Text3D,exports.Effects=p.Effects,exports.isWebGL2Available=p.isWebGL2Available,exports.GradientTexture=j.GradientTexture,exports.GradientType=j.GradientType,exports.Image=x.Image,exports.Edges=l.Edges,exports.Outlines=d.Outlines,exports.Trail=q.Trail,exports.useTrail=q.useTrail,exports.Sampler=m.Sampler,exports.useSurfaceSampler=m.useSurfaceSampler,exports.ComputedAttribute=h.ComputedAttribute,exports.Clone=C.Clone,exports.MarchingCube=M.MarchingCube,exports.MarchingCubes=M.MarchingCubes,exports.MarchingPlane=M.MarchingPlane,exports.Decal=S.Decal,exports.Svg=T.Svg,exports.Gltf=b.Gltf,exports.useGLTF=b.useGLTF,exports.AsciiRenderer=P.AsciiRenderer,exports.Splat=f.Splat,exports.OrthographicCamera=g.OrthographicCamera,exports.PerspectiveCamera=B.PerspectiveCamera,exports.CubeCamera=v.CubeCamera,exports.useCubeCamera=v.useCubeCamera,exports.DeviceOrientationControls=A.DeviceOrientationControls,exports.FlyControls=F.FlyControls,exports.MapControls=G.MapControls,exports.OrbitControls=L.OrbitControls,exports.TrackballControls=D.TrackballControls,exports.ArcballControls=E.ArcballControls,exports.TransformControls=R.TransformControls,exports.PointerLockControls=k.PointerLockControls,exports.FirstPersonControls=I.FirstPersonControls,exports.CameraControls=w.CameraControls,Object.defineProperty(exports,"CameraControlsImpl",{enumerable:!0,get:function(){return mr.default}}),exports.MotionPathControls=y.MotionPathControls,exports.useMotion=y.useMotion,exports.GizmoHelper=O.GizmoHelper,exports.useGizmoContext=O.useGizmoContext,exports.GizmoViewcube=H.GizmoViewcube,exports.GizmoViewport=V.GizmoViewport,exports.Grid=W.Grid,exports.CubeTexture=K.CubeTexture,exports.useCubeTexture=K.useCubeTexture,exports.Fbx=Q.Fbx,exports.useFBX=Q.useFBX,exports.Ktx2=N.Ktx2,exports.useKTX2=N.useKTX2,exports.Progress=U.Progress,exports.useProgress=U.useProgress,exports.IsObject=X.IsObject,exports.Texture=X.Texture,exports.useTexture=X.useTexture,exports.VideoTexture=_.VideoTexture,exports.useVideoTexture=_.useVideoTexture,exports.useFont=J.useFont,exports.checkIfFrameIsEmpty=Y.checkIfFrameIsEmpty,exports.getFirstFrame=Y.getFirstFrame,exports.useSpriteLoader=Y.useSpriteLoader,exports.Helper=Z.Helper,exports.useHelper=Z.useHelper,exports.Stats=$.Stats,exports.StatsGl=ee.StatsGl,exports.useDepthBuffer=re.useDepthBuffer,exports.useAspect=se.useAspect,exports.useCamera=oe.useCamera,exports.DetectGPU=te.DetectGPU,exports.useDetectGPU=te.useDetectGPU,exports.Bvh=ie.Bvh,exports.useBVH=ie.useBVH,exports.useContextBridge=ae.useContextBridge,exports.useAnimations=ce.useAnimations,exports.Fbo=ue.Fbo,exports.useFBO=ue.useFBO,exports.useIntersect=ne.useIntersect,exports.useBoxProjectedEnv=pe.useBoxProjectedEnv,exports.BBAnchor=je.BBAnchor,exports.TrailTexture=xe.TrailTexture,exports.useTrailTexture=xe.useTrailTexture,exports.Example=le.Example,exports.SpriteAnimator=de.SpriteAnimator,exports.useSpriteAnimator=de.useSpriteAnimator,exports.CurveModifier=qe.CurveModifier,exports.MeshDistortMaterial=me.MeshDistortMaterial,exports.MeshWobbleMaterial=he.MeshWobbleMaterial,exports.MeshReflectorMaterial=Ce.MeshReflectorMaterial,exports.MeshRefractionMaterial=Me.MeshRefractionMaterial,exports.MeshTransmissionMaterial=Se.MeshTransmissionMaterial,exports.MeshDiscardMaterial=Te.MeshDiscardMaterial,exports.MultiMaterial=be.MultiMaterial,exports.PointMaterial=Pe.PointMaterial,exports.PointMaterialImpl=Pe.PointMaterialImpl,exports.shaderMaterial=fe.shaderMaterial,exports.SoftShadows=ge.SoftShadows,exports.Box=Be.Box,exports.Capsule=Be.Capsule,exports.Circle=Be.Circle,exports.Cone=Be.Cone,exports.Cylinder=Be.Cylinder,exports.Dodecahedron=Be.Dodecahedron,exports.Extrude=Be.Extrude,exports.Icosahedron=Be.Icosahedron,exports.Lathe=Be.Lathe,exports.Octahedron=Be.Octahedron,exports.Plane=Be.Plane,exports.Polyhedron=Be.Polyhedron,exports.Ring=Be.Ring,exports.Shape=Be.Shape,exports.Sphere=Be.Sphere,exports.Tetrahedron=Be.Tetrahedron,exports.Torus=Be.Torus,exports.TorusKnot=Be.TorusKnot,exports.Tube=Be.Tube,exports.RoundedBox=ve.RoundedBox,exports.RoundedBoxGeometry=ve.RoundedBoxGeometry,exports.ScreenQuad=Ae.ScreenQuad,exports.Center=Fe.Center,exports.Resize=Ge.Resize,exports.Bounds=Le.Bounds,exports.useBounds=Le.useBounds,exports.CameraShake=De.CameraShake,exports.Float=Ee.Float,exports.Stage=Re.Stage,exports.Backdrop=ke.Backdrop,exports.Shadow=Ie.Shadow,exports.Caustics=we.Caustics,exports.ContactShadows=ze.ContactShadows,exports.AccumulativeShadows=ye.AccumulativeShadows,exports.RandomizedLight=ye.RandomizedLight,exports.accumulativeContext=ye.accumulativeContext,exports.SpotLight=Oe.SpotLight,exports.SpotLightShadow=Oe.SpotLightShadow,exports.Environment=He.Environment,exports.EnvironmentCube=He.EnvironmentCube,exports.EnvironmentMap=He.EnvironmentMap,exports.EnvironmentPortal=He.EnvironmentPortal,exports.Lightformer=Ve.Lightformer,exports.Sky=We.Sky,exports.calcPosFromAngles=We.calcPosFromAngles,exports.Stars=Ke.Stars,exports.Cloud=Qe.Cloud,exports.CloudInstance=Qe.CloudInstance,exports.Clouds=Qe.Clouds,exports.Sparkles=Ne.Sparkles,exports.useEnvironment=Ue.useEnvironment,exports.MatcapTexture=Xe.MatcapTexture,exports.useMatcapTexture=Xe.useMatcapTexture,exports.NormalTexture=_e.NormalTexture,exports.useNormalTexture=_e.useNormalTexture,exports.Wireframe=Je.Wireframe,exports.ShadowAlpha=Ye.ShadowAlpha,exports.Point=Ze.Point,exports.Points=Ze.Points,exports.PointsBuffer=Ze.PointsBuffer,exports.PositionPoint=Ze.PositionPoint,exports.Instance=$e.Instance,exports.InstancedAttribute=$e.InstancedAttribute,exports.Instances=$e.Instances,exports.Merged=$e.Merged,exports.PositionMesh=$e.PositionMesh,exports.createInstances=$e.createInstances,exports.Segment=er.Segment,exports.SegmentObject=er.SegmentObject,exports.Segments=er.Segments,exports.Detailed=rr.Detailed,exports.Preload=sr.Preload,exports.BakeShadows=or.BakeShadows,exports.meshBounds=tr.meshBounds,exports.AdaptiveDpr=ir.AdaptiveDpr,exports.AdaptiveEvents=ar.AdaptiveEvents,exports.PerformanceMonitor=cr.PerformanceMonitor,exports.usePerformanceMonitor=cr.usePerformanceMonitor,exports.RenderTexture=ur.RenderTexture,exports.RenderCubeTexture=nr.RenderCubeTexture,exports.Mask=pr.Mask,exports.useMask=pr.useMask,exports.Hud=jr.Hud,exports.Fisheye=xr.Fisheye,exports.MeshPortalMaterial=lr.MeshPortalMaterial,exports.calculateScaleFactor=dr.calculateScaleFactor;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/native/index.js:export { Environment, EnvironmentCube, EnvironmentMap, EnvironmentPortal } from '../core/Environment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/native/index.js:export { useEnvironment } from '../core/useEnvironment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/index.cjs.js:"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("react"),r=require("react-dom/client"),n=require("three"),a=require("@react-three/fiber"),o=require("zustand"),i=require("@use-gesture/react"),s=require("maath"),l=require("zustand/middleware"),c=require("three-stdlib"),u=require("zustand/shallow"),d=require("troika-three-text"),m=require("suspend-react"),f=require("meshline"),p=require("camera-controls"),h=require("hls.js"),x=require("stats.js"),y=require("stats-gl"),v=require("detect-gpu"),g=require("three-mesh-bvh"),w=require("@monogrid/gainmap-js"),z=require("tunnel-rat");function b(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function E(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var M=b(e),S=E(t),C=E(r),T=E(n),P=b(p),R=b(x),D=b(y),F=b(z);const k=new n.Vector3,_=new n.Vector3,A=new n.Vector3,L=new n.Vector2;function I(e,t,r){const n=k.setFromMatrixPosition(e.matrixWorld);n.project(t);const a=r.width/2,o=r.height/2;return[n.x*a+a,-n.y*o+o]}const B=e=>Math.abs(e)<1e-10?0:e;function U(e,t,r=""){let n="matrix3d(";for(let r=0;16!==r;r++)n+=B(t[r]*e.elements[r])+(15!==r?",":")");return r+n}const V=(O=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>U(e,O));var O;const N=(e,t)=>{return U(e,[1/(r=t),1/r,1/r,1,-1/r,-1/r,-1/r,-1,1/r,1/r,1/r,1,1,1,1,1],"translate(-50%,-50%)");var r};const j=S.forwardRef((({children:e,eps:t=.001,style:r,className:o,prepend:i,center:s,fullscreen:l,portal:c,distanceFactor:u,sprite:d=!1,transform:m=!1,occlude:f,onOcclude:p,castShadow:h,receiveShadow:x,material:y,geometry:v,zIndexRange:g=[16777271,0],calculatePosition:w=I,as:z="div",wrapperClass:b,pointerEvents:E="auto",...T},P)=>{const{gl:R,camera:D,scene:F,size:U,raycaster:O,events:j,viewport:W}=a.useThree(),[G]=S.useState((()=>document.createElement(z))),H=S.useRef(null),$=S.useRef(null),q=S.useRef(0),X=S.useRef([0,0]),Z=S.useRef(null),Y=S.useRef(null),Q=(null==c?void 0:c.current)||j.connected||R.domElement.parentNode,K=S.useRef(null),J=S.useRef(!1),ee=S.useMemo((()=>f&&"blending"!==f||Array.isArray(f)&&f.length&&function(e){return e&&"object"==typeof e&&"current"in e}(f[0])),[f]);S.useLayoutEffect((()=>{const e=R.domElement;f&&"blending"===f?(e.style.zIndex=`${Math.floor(g[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)}),[f]),S.useLayoutEffect((()=>{if($.current){const e=H.current=C.createRoot(G);if(F.updateMatrixWorld(),m)G.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=w($.current,D,U);G.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return Q&&(i?Q.prepend(G):Q.appendChild(G)),()=>{Q&&Q.removeChild(G),e.unmount()}}}),[Q,m]),S.useLayoutEffect((()=>{b&&(G.className=b)}),[b]);const te=S.useMemo((()=>m?{position:"absolute",top:0,left:0,width:U.width,height:U.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...l&&{top:-U.height/2,left:-U.width/2,width:U.width,height:U.height},...r}),[r,s,l,U,m]),re=S.useMemo((()=>({position:"absolute",pointerEvents:E})),[E]);S.useLayoutEffect((()=>{var t,n;(J.current=!1,m)?null==(t=H.current)||t.render(S.createElement("div",{ref:Z,style:te},S.createElement("div",{ref:Y,style:re},S.createElement("div",{ref:P,className:o,style:r,children:e})))):null==(n=H.current)||n.render(S.createElement("div",{ref:P,style:te,className:o,children:e}))}));const ne=S.useRef(!0);a.useFrame((e=>{if($.current){D.updateMatrixWorld(),$.current.updateWorldMatrix(!0,!1);const e=m?X.current:w($.current,D,U);if(m||Math.abs(q.current-D.zoom)>t||Math.abs(X.current[0]-e[0])>t||Math.abs(X.current[1]-e[1])>t){const t=function(e,t){const r=k.setFromMatrixPosition(e.matrixWorld),n=_.setFromMatrixPosition(t.matrixWorld),a=r.sub(n),o=t.getWorldDirection(A);return a.angleTo(o)>Math.PI/2}($.current,D);let r=!1;ee&&(Array.isArray(f)?r=f.map((e=>e.current)):"blending"!==f&&(r=[F]));const a=ne.current;if(r){const e=function(e,t,r,n){const a=k.setFromMatrixPosition(e.matrixWorld),o=a.clone();o.project(t),L.set(o.x,o.y),r.setFromCamera(L,t);const i=r.intersectObjects(n,!0);if(i.length){const e=i[0].distance;return a.distanceTo(r.ray.origin)<e}return!0}($.current,D,O,r);ne.current=e&&!t}else ne.current=!t;a!==ne.current&&(p?p(!ne.current):G.style.display=ne.current?"block":"none");const o=Math.floor(g[0]/2),i=f?ee?[g[0],o]:[o-1,0]:g;if(G.style.zIndex=`${function(e,t,r){if(t instanceof n.PerspectiveCamera||t instanceof n.OrthographicCamera){const n=k.setFromMatrixPosition(e.matrixWorld),a=_.setFromMatrixPosition(t.matrixWorld),o=n.distanceTo(a),i=(r[1]-r[0])/(t.far-t.near),s=r[1]-i*t.far;return Math.round(i*o+s)}}($.current,D,i)}`,m){const[e,t]=[U.width/2,U.height/2],r=D.projectionMatrix.elements[5]*t,{isOrthographicCamera:n,top:a,left:o,bottom:i,right:s}=D,l=V(D.matrixWorldInverse),c=n?`scale(${r})translate(${B(-(s+o)/2)}px,${B((a+i)/2)}px)`:`translateZ(${r}px)`;let m=$.current.matrixWorld;d&&(m=D.matrixWorldInverse.clone().transpose().copyPosition(m).scale($.current.scale),m.elements[3]=m.elements[7]=m.elements[11]=0,m.elements[15]=1),G.style.width=U.width+"px",G.style.height=U.height+"px",G.style.perspective=n?"":`${r}px`,Z.current&&Y.current&&(Z.current.style.transform=`${c}${l}translate(${e}px,${t}px)`,Y.current.style.transform=N(m,1/((u||10)/400)))}else{const t=void 0===u?1:function(e,t){if(t instanceof n.OrthographicCamera)return t.zoom;if(t instanceof n.PerspectiveCamera){const r=k.setFromMatrixPosition(e.matrixWorld),n=_.setFromMatrixPosition(t.matrixWorld),a=t.fov*Math.PI/180,o=r.distanceTo(n);return 1/(2*Math.tan(a/2)*o)}return 1}($.current,D)*u;G.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}X.current=e,q.current=D.zoom}}if(!ee&&K.current&&!J.current)if(m){if(Z.current){const e=Z.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=D;if(t||v)T.scale&&(Array.isArray(T.scale)?T.scale instanceof n.Vector3?K.current.scale.copy(T.scale.clone().divideScalar(1)):K.current.scale.set(1/T.scale[0],1/T.scale[1],1/T.scale[2]):K.current.scale.setScalar(1/T.scale));else{const t=(u||10)/400,r=e.clientWidth*t,n=e.clientHeight*t;K.current.scale.set(r,n,1)}J.current=!0}}}else{const t=G.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/W.factor,r=t.clientWidth*e,n=t.clientHeight*e;K.current.scale.set(r,n,1),J.current=!0}K.current.lookAt(e.camera.position)}}));const ae=S.useMemo((()=>({vertexShader:m?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[m]);return S.createElement("group",M.default({},T,{ref:$}),f&&!ee&&S.createElement("mesh",{castShadow:h,receiveShadow:x,ref:K},v||S.createElement("planeGeometry",null),y||S.createElement("shaderMaterial",{side:n.DoubleSide,vertexShader:ae.vertexShader,fragmentShader:ae.fragmentShader})))}));let W=0;const G=o.create((e=>(n.DefaultLoadingManager.onStart=(t,r,n)=>{e({active:!0,item:t,loaded:r,total:n,progress:(r-W)/(n-W)*100})},n.DefaultLoadingManager.onLoad=()=>{e({active:!1})},n.DefaultLoadingManager.onError=t=>e((e=>({errors:[...e.errors,t]}))),n.DefaultLoadingManager.onProgress=(t,r,n)=>{r===n&&(W=n),e({active:!0,item:t,loaded:r,total:n,progress:(r-W)/(n-W)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})));const H=e=>`Loading ${e.toFixed(2)}%`;const $={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}},q=S.createContext(null);function X(){return S.useContext(q)}const Z=S.forwardRef((({children:e},t)=>{const r=S.useRef(null);S.useImperativeHandle(t,(()=>r.current),[]);const n=X(),{width:o,height:i}=a.useThree((e=>e.viewport));return a.useFrame((()=>{r.current.position.x=n.horizontal?-o*(n.pages-1)*n.offset:0,r.current.position.y=n.horizontal?0:i*(n.pages-1)*n.offset})),S.createElement("group",{ref:r},e)})),Y=S.forwardRef((({children:e,style:t,...r},n)=>{const o=X(),i=S.useRef(null);S.useImperativeHandle(n,(()=>i.current),[]);const{width:s,height:l}=a.useThree((e=>e.size)),c=S.useContext(a.context),u=S.useMemo((()=>C.createRoot(o.fixed)),[o.fixed]);return a.useFrame((()=>{o.delta>o.eps&&(i.current.style.transform=`translate3d(${o.horizontal?-s*(o.pages-1)*o.offset:0}px,${o.horizontal?0:l*(o.pages-1)*-o.offset}px,0)`)})),u.render(S.createElement("div",M.default({ref:i,style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},r),S.createElement(q.Provider,{value:o},S.createElement(a.context.Provider,{value:c},e)))),null})),Q=S.forwardRef((({html:e,...t},r)=>{const n=e?Y:Z;return S.createElement(n,M.default({ref:r},t))}));const K=S.createContext(null);const J=S.createContext([]);const ee=S.forwardRef((function({children:e,follow:t=!0,lockX:r=!1,lockY:o=!1,lockZ:i=!1,...s},l){const c=S.useRef(null),u=S.useRef(null),d=new n.Quaternion;return a.useFrame((({camera:e})=>{if(!t||!u.current)return;const n=c.current.rotation.clone();u.current.updateMatrix(),u.current.updateWorldMatrix(!1,!1),u.current.getWorldQuaternion(d),e.getWorldQuaternion(c.current.quaternion).premultiply(d.invert()),r&&(c.current.rotation.x=n.x),o&&(c.current.rotation.y=n.y),i&&(c.current.rotation.z=n.z)})),S.useImperativeHandle(l,(()=>u.current),[]),S.createElement("group",M.default({ref:u},s),S.createElement("group",{ref:c},e))})),te=S.forwardRef((({children:e,depth:t=-1,...r},n)=>{const o=S.useRef(null);return S.useImperativeHandle(n,(()=>o.current),[]),a.useFrame((({camera:e})=>{o.current.quaternion.copy(e.quaternion),o.current.position.copy(e.position)})),S.createElement("group",M.default({ref:o},r),S.createElement("group",{"position-z":-t},e))})),re=new T.Vector3,ne=new T.Vector3,ae=new T.Vector3,oe=(e,t,r,n=1)=>{const a=re.set(e.x/r.width*2-1,-e.y/r.height*2+1,n);return a.unproject(t),a},ie=(e,t,r,n)=>{const a=((e,t,r)=>{const n=r.width/2,a=r.height/2;t.updateMatrixWorld(!1);const o=e.project(t);return o.x=o.x*n+n,o.y=-o.y*a+a,o})(ae.copy(e),r,n);let o=0;for(let i=0;i<2;++i){const s=ne.copy(a).setComponent(i,a.getComponent(i)+t),l=oe(s,r,n,s.z);o=Math.max(o,e.distanceTo(l))}return o},se=new n.Vector3,le=t.forwardRef((({scale:e=1,...r},n)=>{const o=t.useRef(null);return S.useImperativeHandle(n,(()=>o.current),[]),a.useFrame((t=>{const r=o.current;if(!r)return;const n=ie(r.getWorldPosition(se),e,t.camera,t.size);r.scale.setScalar(n*e)})),S.createElement("object3D",M.default({ref:o},r))})),ce=S.forwardRef((function({points:e,color:t=16777215,vertexColors:r,linewidth:o,lineWidth:i,segments:s,dashed:l,...u},d){var m,f;const p=a.useThree((e=>e.size)),h=S.useMemo((()=>s?new c.LineSegments2:new c.Line2),[s]),[x]=S.useState((()=>new c.LineMaterial)),y=4===(null==r||null==(m=r[0])?void 0:m.length)?4:3,v=S.useMemo((()=>{const a=s?new c.LineSegmentsGeometry:new c.LineGeometry,o=e.map((e=>{const t=Array.isArray(e);return e instanceof n.Vector3||e instanceof n.Vector4?[e.x,e.y,e.z]:e instanceof n.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}));if(a.setPositions(o.flat()),r){t=16777215;const e=r.map((e=>e instanceof n.Color?e.toArray():e));a.setColors(e.flat(),y)}return a}),[e,s,r,y]);return S.useLayoutEffect((()=>{h.computeLineDistances()}),[e,h]),S.useLayoutEffect((()=>{l?x.defines.USE_DASH="":delete x.defines.USE_DASH,x.needsUpdate=!0}),[l,x]),S.useEffect((()=>()=>{v.dispose(),x.dispose()}),[v]),S.createElement("primitive",M.default({object:h,ref:d},u),S.createElement("primitive",{object:v,attach:"geometry"}),S.createElement("primitive",M.default({object:x,attach:"material",color:t,vertexColors:Boolean(r),resolution:[p.width,p.height],linewidth:null!==(f=null!=o?o:i)&&void 0!==f?f:1,dashed:l,transparent:4===y},u)))})),ue=new n.Vector3,de=S.forwardRef((function({start:e=[0,0,0],end:t=[0,0,0],mid:r,segments:a=20,...o},i){const s=S.useRef(null);S.useImperativeHandle(i,(()=>s.current));const[l]=S.useState((()=>new n.QuadraticBezierCurve3(void 0,void 0,void 0))),c=S.useCallback(((e,t,r,a=20)=>(e instanceof n.Vector3?l.v0.copy(e):l.v0.set(...e),t instanceof n.Vector3?l.v2.copy(t):l.v2.set(...t),r instanceof n.Vector3?l.v1.copy(r):Array.isArray(r)?l.v1.set(...r):l.v1.copy(l.v0.clone().add(l.v2.clone().sub(l.v0)).add(ue.set(0,l.v0.y-l.v2.y,0))),l.getPoints(a))),[]);S.useLayoutEffect((()=>{s.current.setPoints=(e,t,r)=>{const n=c(e,t,r);s.current.geometry&&s.current.geometry.setPositions(n.map((e=>e.toArray())).flat())}}),[]);const u=S.useMemo((()=>c(e,t,r,a)),[e,t,r,a]);return S.createElement(ce,M.default({ref:s,points:u},o))})),me=S.forwardRef((function({start:e,end:t,midA:r,midB:a,segments:o=20,...i},s){const l=S.useMemo((()=>{const i=e instanceof n.Vector3?e:new n.Vector3(...e),s=t instanceof n.Vector3?t:new n.Vector3(...t),l=r instanceof n.Vector3?r:new n.Vector3(...r),c=a instanceof n.Vector3?a:new n.Vector3(...a);return new n.CubicBezierCurve3(i,l,c,s).getPoints(o)}),[e,t,r,a,o]);return S.createElement(ce,M.default({ref:s,points:l},i))})),fe=S.forwardRef((function({points:e,closed:t=!1,curveType:r="centripetal",tension:a=.5,segments:o=20,vertexColors:i,...s},l){const c=S.useMemo((()=>{const o=e.map((e=>e instanceof n.Vector3?e:new n.Vector3(...e)));return new n.CatmullRomCurve3(o,t,r,a)}),[e,t,r,a]),u=S.useMemo((()=>c.getPoints(o)),[c,o]),d=S.useMemo((()=>{if(!i||i.length<2)return;if(i.length===o+1)return i;const e=i.map((e=>e instanceof n.Color?e:new n.Color(...e)));t&&e.push(e[0].clone());const r=[e[0]],a=o/(e.length-1);for(let t=1;t<o;t++){const n=t%a/a,o=Math.floor(t/a);r.push(e[o].clone().lerp(e[o+1],n))}return r.push(e[e.length-1]),r}),[i,o]);return S.createElement(ce,M.default({ref:l,points:u,vertexColors:d},s))})),pe=S.forwardRef((({url:e,distance:t=1,loop:r=!0,autoplay:o,...i},s)=>{const l=S.useRef(null);S.useImperativeHandle(s,(()=>l.current),[]);const c=a.useThree((({camera:e})=>e)),[u]=S.useState((()=>new n.AudioListener)),d=a.useLoader(n.AudioLoader,e);return S.useEffect((()=>{const e=l.current;e&&(e.setBuffer(d),e.setRefDistance(t),e.setLoop(r),o&&!e.isPlaying&&e.play())}),[d,c,t,r]),S.useEffect((()=>{const e=l.current;return c.add(u),()=>{c.remove(u),e&&(e.isPlaying&&e.stop(),e.source&&e.source._connected&&e.disconnect())}}),[]),S.createElement("positionalAudio",M.default({ref:l,args:[u]},i))})),he=S.forwardRef((({sdfGlyphSize:e=64,anchorX:t="center",anchorY:r="middle",font:n,fontSize:o=1,children:i,characters:s,onSync:l,...c},u)=>{const f=a.useThree((({invalidate:e})=>e)),[p]=S.useState((()=>new d.Text)),[h,x]=S.useMemo((()=>{const e=[];let t="";return S.Children.forEach(i,(r=>{"string"==typeof r||"number"==typeof r?t+=r:e.push(r)})),[e,t]}),[i]);return m.suspend((()=>new Promise((e=>d.preloadFont({font:n,characters:s},e)))),["troika-text",n,s]),S.useLayoutEffect((()=>{p.sync((()=>{f(),l&&l(p)}))})),S.useEffect((()=>()=>p.dispose()),[p]),S.createElement("primitive",M.default({object:p,ref:u,font:n,text:x,anchorX:t,anchorY:r,fontSize:o,sdfGlyphSize:e},c),h)}));let xe=null;async function ye(e){const t=await async function(e){return"string"==typeof e?await(await fetch(e)).json():e}(e);return r=t,xe||(xe=new c.FontLoader),xe.parse(r);var r}function ve(e){return m.suspend(ye,[e])}ve.preload=e=>m.preload(ye,[e]),ve.clear=e=>m.clear([e]);const ge=["string","number"],we=S.forwardRef((({font:e,letterSpacing:r=0,lineHeight:n=1,size:o=1,height:i=.2,bevelThickness:s=.1,bevelSize:l=.01,bevelEnabled:u=!1,bevelOffset:d=0,bevelSegments:m=4,curveSegments:f=8,smooth:p,children:h,...x},y)=>{S.useMemo((()=>a.extend({RenamedTextGeometry:c.TextGeometry})),[]);const v=S.useRef(null),g=ve(e),w=t.useMemo((()=>({font:g,size:o,height:i,bevelThickness:s,bevelSize:l,bevelEnabled:u,bevelSegments:m,bevelOffset:d,curveSegments:f,letterSpacing:r,lineHeight:n})),[g,o,i,s,l,u,m,d,f,r,n]),[z,...b]=t.useMemo((()=>(e=>{let t="";const r=[];return S.Children.forEach(e,(e=>{ge.includes(typeof e)?t+=e+"":r.push(e)})),[t,...r]})(h)),[h]),E=S.useMemo((()=>[z,w]),[z,w]);return S.useLayoutEffect((()=>{p&&(v.current.geometry=c.mergeVertices(v.current.geometry,p),v.current.geometry.computeVertexNormals())}),[E,p]),S.useImperativeHandle(y,(()=>v.current),[]),S.createElement("mesh",M.default({},x,{ref:v}),S.createElement("renamedTextGeometry",{args:E}),b)})),ze=S.forwardRef((({children:e,multisamping:t=8,renderIndex:r=1,disableRender:o,disableGamma:i,disableRenderPass:s,depthBuffer:l=!0,stencilBuffer:u=!1,anisotropy:d=1,colorSpace:m,type:f,...p},h)=>{S.useMemo((()=>a.extend({EffectComposer:c.EffectComposer,RenderPass:c.RenderPass,ShaderPass:c.ShaderPass})),[]);const x=S.useRef(null);S.useImperativeHandle(h,(()=>x.current),[]);const{scene:y,camera:v,gl:g,size:w,viewport:z}=a.useThree(),[b]=S.useState((()=>{const e=new n.WebGLRenderTarget(w.width,w.height,{type:f||n.HalfFloatType,format:n.RGBAFormat,depthBuffer:l,stencilBuffer:u,anisotropy:d});return f===n.UnsignedByteType&&null!=m&&(e.texture.colorSpace=m),e.samples=t,e}));S.useEffect((()=>{var e,t;null==(e=x.current)||e.setSize(w.width,w.height),null==(t=x.current)||t.setPixelRatio(z.dpr)}),[g,w,z.dpr]),a.useFrame((()=>{var e;o||null==(e=x.current)||e.render()}),r);const E=[];return s||E.push(S.createElement("renderPass",{key:"renderpass",attach:`passes-${E.length}`,args:[y,v]})),i||E.push(S.createElement("shaderPass",{attach:`passes-${E.length}`,key:"gammapass",args:[c.GammaCorrectionShader]})),S.Children.forEach(e,(e=>{e&&E.push(S.cloneElement(e,{key:E.length,attach:`passes-${E.length}`}))})),S.createElement("effectComposer",M.default({ref:x,args:[g,b]},p),E)}));let be=function(e){return e.Linear="linear",e.Radial="radial",e}({});function Ee(e,t,r,n){var a;return(a=class extends T.ShaderMaterial{constructor(a){super({vertexShader:t,fragmentShader:r,...a});for(const t in e)this.uniforms[t]=new T.Uniform(e[t]),Object.defineProperty(this,t,{get(){return this.uniforms[t].value},set(e){this.uniforms[t].value=e}});this.uniforms=T.UniformsUtils.clone(this.uniforms),null==n||n(this)}}).key=T.MathUtils.generateUUID(),a}const Me=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function Se(e,r){const o=a.useThree((e=>e.gl)),i=a.useLoader(n.TextureLoader,Me(e)?Object.values(e):e);t.useLayoutEffect((()=>{null==r||r(i)}),[r]),t.useEffect((()=>{if("initTexture"in o){let e=[];Array.isArray(i)?e=i:i instanceof n.Texture?e=[i]:Me(i)&&(e=Object.values(i)),e.forEach((e=>{e instanceof n.Texture&&o.initTexture(e)}))}}),[o,i]);const s=t.useMemo((()=>{if(Me(e)){const t={};let r=0;for(const n in e)t[n]=i[r++];return t}return i}),[e,i]);return s}Se.preload=e=>a.useLoader.preload(n.TextureLoader,e),Se.clear=e=>a.useLoader.clear(n.TextureLoader,e);const Ce=(()=>parseInt(n.REVISION.replace(/\D+/g,"")))(),Te=Ee({color:new T.Color("white"),scale:new T.Vector2(1,1),imageBounds:new T.Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},"\n  varying vec2 vUv;\n  varying vec2 vPos;\n  void main() {\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n    vUv = uv;\n    vPos = position.xy;\n  }\n",`\n  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n  varying vec2 vUv;\n  varying vec2 vPos;\n  uniform vec2 scale;\n  uniform vec2 imageBounds;\n  uniform float resolution;\n  uniform vec3 color;\n  uniform sampler2D map;\n  uniform float radius;\n  uniform float zoom;\n  uniform float grayscale;\n  uniform float opacity;\n  const vec3 luma = vec3(.299, 0.587, 0.114);\n  vec4 toGrayscale(vec4 color, float intensity) {\n    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n  }\n  vec2 aspect(vec2 size) {\n    return size / min(size.x, size.y);\n  }\n  \n  const float PI = 3.14159265;\n    \n  // from https://iquilezles.org/articles/distfunctions\n  float udRoundBox( vec2 p, vec2 b, float r ) {\n    return length(max(abs(p)-b+r,0.0))-r;\n  }\n\n  void main() {\n    vec2 s = aspect(scale);\n    vec2 i = aspect(imageBounds);\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 uv = vUv * s / new + offset;\n    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n\n    vec2 res = vec2(scale * resolution);\n    vec2 halfRes = 0.5 * res;\n    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n\t  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n    \n    #include <tonemapping_fragment>\n    #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n  }\n`),Pe=S.forwardRef((({children:e,color:t,segments:r=1,scale:n=1,zoom:o=1,grayscale:i=0,opacity:s=1,radius:l=0,texture:c,toneMapped:u,transparent:d,side:m,...f},p)=>{a.extend({ImageMaterial:Te});const h=S.useRef(null),x=a.useThree((e=>e.size)),y=Array.isArray(n)?[n[0],n[1]]:[n,n],v=[c.image.width,c.image.height],g=Math.max(x.width,x.height);return S.useImperativeHandle(p,(()=>h.current),[]),S.useLayoutEffect((()=>{h.current.geometry.parameters&&h.current.material.scale.set(y[0]*h.current.geometry.parameters.width,y[1]*h.current.geometry.parameters.height)}),[y[0],y[1]]),S.createElement("mesh",M.default({ref:h,scale:Array.isArray(n)?[...n,1]:n},f),S.createElement("planeGeometry",{args:[1,1,r,r]}),S.createElement("imageMaterial",{color:t,map:c,zoom:o,grayscale:i,opacity:s,scale:y,imageBounds:v,resolution:g,radius:l,toneMapped:u,transparent:d,side:m,key:Te.key}),e)})),Re=S.forwardRef((({url:e,...t},r)=>{const n=Se(e);return S.createElement(Pe,M.default({},t,{texture:n,ref:r}))})),De=S.forwardRef((({url:e,...t},r)=>S.createElement(Pe,M.default({},t,{ref:r})))),Fe=S.forwardRef(((e,t)=>{if(e.url)return S.createElement(Re,M.default({},e,{ref:t}));if(e.texture)return S.createElement(De,M.default({},e,{ref:t}));throw new Error("<Image /> requires a url or texture")})),ke=S.forwardRef((({threshold:e=15,geometry:t,...r},n)=>{const a=S.useRef(null);S.useImperativeHandle(n,(()=>a.current),[]);const o=S.useMemo((()=>[0,0,0,1,0,0]),[]),i=S.useRef(null),s=S.useRef(null);return S.useLayoutEffect((()=>{const r=a.current.parent,n=null!=t?t:null==r?void 0:r.geometry;if(!n)return;if(i.current===n&&s.current===e)return;i.current=n,s.current=e;const o=new T.EdgesGeometry(n,e).attributes.position.array;a.current.geometry.setPositions(o),a.current.geometry.attributes.instanceStart.needsUpdate=!0,a.current.geometry.attributes.instanceEnd.needsUpdate=!0,a.current.computeLineDistances()})),S.createElement(ce,M.default({segments:!0,points:o,ref:a,raycast:()=>null},r))})),_e=Ee({screenspace:!1,color:new T.Color("black"),opacity:1,thickness:.05,size:new T.Vector2},"#include <common>\n   #include <morphtarget_pars_vertex>\n   #include <skinning_pars_vertex>\n   #include <clipping_planes_pars_vertex>\n   uniform float thickness;\n   uniform bool screenspace;\n   uniform vec2 size;\n   void main() {\n     #if defined (USE_SKINNING)\n\t     #include <beginnormal_vertex>\n       #include <morphnormal_vertex>\n       #include <skinbase_vertex>\n       #include <skinnormal_vertex>\n       #include <defaultnormal_vertex>\n     #endif\n     #include <begin_vertex>\n\t   #include <morphtarget_vertex>\n\t   #include <skinning_vertex>\n     #include <project_vertex>\n     #include <clipping_planes_vertex>\n     vec4 tNormal = vec4(normal, 0.0);\n     vec4 tPosition = vec4(transformed, 1.0);\n     #ifdef USE_INSTANCING\n       tNormal = instanceMatrix * tNormal;\n       tPosition = instanceMatrix * tPosition;\n     #endif\n     if (screenspace) {\n       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;\n       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); \n     } else {\n       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;\n       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;\n       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;\n       clipPosition.xy += offset;\n       gl_Position = clipPosition;\n     }\n   }",`uniform vec3 color;\n   uniform float opacity;\n   #include <clipping_planes_pars_fragment>\n   void main(){\n     #include <clipping_planes_fragment>\n     gl_FragColor = vec4(color, opacity);\n     #include <tonemapping_fragment>\n     #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`);const Ae={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},Le=(e,t=1)=>(e.set(e.subarray(t)),e.fill(-1/0,-t),e);function Ie(e,t){const{length:r,local:o,decay:i,interval:s,stride:l}={...Ae,...t},c=S.useRef(null),[u]=S.useState((()=>new n.Vector3));S.useLayoutEffect((()=>{e&&(c.current=Float32Array.from({length:10*r*3},((t,r)=>e.position.getComponent(r%3))))}),[r,e]);const d=S.useRef(new n.Vector3),m=S.useRef(0);return a.useFrame((()=>{if(e&&c.current){if(0===m.current){let t;o?t=e.position:(e.getWorldPosition(u),t=u);const r=1*i;for(let e=0;e<r;e++)t.distanceTo(d.current)<l||(Le(c.current,3),c.current.set(t.toArray(),c.current.length-3));d.current.copy(t)}m.current++,m.current=m.current%s}})),c}const Be=S.forwardRef(((e,t)=>{const{children:r}=e,{width:o,length:i,decay:s,local:l,stride:c,interval:u}={...Ae,...e},{color:d="hotpink",attenuation:m,target:p}=e,h=a.useThree((e=>e.size)),x=a.useThree((e=>e.scene)),y=S.useRef(null),[v,g]=S.useState(null),w=Ie(v,{length:i,decay:s,local:l,stride:c,interval:u});S.useEffect((()=>{const e=(null==p?void 0:p.current)||y.current.children.find((e=>e instanceof n.Object3D));e&&g(e)}),[w,p]);const z=S.useMemo((()=>new f.MeshLineGeometry),[]),b=S.useMemo((()=>{var e,t;const a=new f.MeshLineMaterial({lineWidth:.1*o,color:d,sizeAttenuation:1,resolution:new n.Vector2(h.width,h.height)});let i;if(r)if(Array.isArray(r))i=r.find((e=>{const t=e;return"string"==typeof t.type&&"meshLineMaterial"===t.type}));else{const e=r;"string"==typeof e.type&&"meshLineMaterial"===e.type&&(i=e)}return"object"==typeof(null==(e=i)?void 0:e.props)&&null!==(null==(t=i)?void 0:t.props)&&a.setValues(i.props),a}),[o,d,h,r]);return S.useEffect((()=>{b.uniforms.resolution.value.set(h.width,h.height)}),[h]),a.useFrame((()=>{w.current&&z.setPoints(w.current,m)})),S.createElement("group",null,a.createPortal(S.createElement("mesh",{ref:t,geometry:z,material:b}),x),S.createElement("group",{ref:y},r))}));function Ue(e,t=16,r,a,o){const[i,s]=S.useState((()=>{const e=Array.from({length:t},(()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])).flat();return new n.InstancedBufferAttribute(Float32Array.from(e),16)}));return S.useLayoutEffect((()=>{if(void 0===e.current)return;const l=new c.MeshSurfaceSampler(e.current);a&&l.setWeightAttribute(a),l.build();const u=new n.Vector3,d=new n.Vector3,m=new n.Color,f=new n.Object3D;e.current.updateMatrixWorld(!0);for(let n=0;n<t;n++)l.sample(u,d,m),"function"==typeof r?r({dummy:f,sampledMesh:e.current,position:u,normal:d,color:m},n):f.position.copy(u),f.updateMatrix(),null!=o&&o.current&&o.current.setMatrixAt(n,f.matrix),f.matrix.toArray(i.array,16*n);null!=o&&o.current&&(o.current.instanceMatrix.needsUpdate=!0),i.needsUpdate=!0,s(new n.InstancedBufferAttribute(i.array,i.itemSize).copy(i))}),[e,o,a,t,r]),i}const Ve=S.forwardRef((({isChild:e=!1,object:t,children:r,deep:n,castShadow:a,receiveShadow:o,inject:i,keys:s,...l},u)=>{const d={keys:s,deep:n,inject:i,castShadow:a,receiveShadow:o};if(t=S.useMemo((()=>{if(!1===e&&!Array.isArray(t)){let e=!1;if(t.traverse((t=>{t.isSkinnedMesh&&(e=!0)})),e)return c.SkeletonUtils.clone(t)}return t}),[t,e]),Array.isArray(t))return S.createElement("group",M.default({},l,{ref:u}),t.map((e=>S.createElement(Ve,M.default({key:e.uuid,object:e},d)))),r);const{children:m,...f}=function(e,{keys:t=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:r,inject:n,castShadow:a,receiveShadow:o}){let i={};for(const r of t)i[r]=e[r];return r&&(i.geometry&&"materialsOnly"!==r&&(i.geometry=i.geometry.clone()),i.material&&"geometriesOnly"!==r&&(i.material=i.material.clone())),n&&(i="function"==typeof n?{...i,children:n(e)}:S.isValidElement(n)?{...i,children:n}:{...i,...n}),e instanceof T.Mesh&&(a&&(i.castShadow=!0),o&&(i.receiveShadow=!0)),i}(t,d),p=t.type[0].toLowerCase()+t.type.slice(1);return S.createElement(p,M.default({},f,l,{ref:u}),t.children.map((e=>"Bone"===e.type?S.createElement("primitive",M.default({key:e.uuid,object:e},d)):S.createElement(Ve,M.default({key:e.uuid,object:e},d,{isChild:!0})))),r,m)})),Oe=S.createContext(null),Ne=S.forwardRef((({resolution:e=28,maxPolyCount:t=1e4,enableUvs:r=!1,enableColors:n=!1,children:o,...i},s)=>{const l=S.useRef(null);S.useImperativeHandle(s,(()=>l.current),[]);const u=S.useMemo((()=>new c.MarchingCubes(e,null,r,n,t)),[e,t,r,n]),d=S.useMemo((()=>({getParent:()=>l})),[]);return a.useFrame((()=>{u.update(),u.reset()}),-1),S.createElement(S.Fragment,null,S.createElement("primitive",M.default({object:u,ref:l},i),S.createElement(Oe.Provider,{value:d},o)))})),je=S.forwardRef((({strength:e=.5,subtract:t=12,color:r,...n},o)=>{const{getParent:i}=S.useContext(Oe),s=S.useMemo((()=>i()),[i]),l=S.useRef(null);S.useImperativeHandle(o,(()=>l.current),[]);const c=new T.Vector3;return a.useFrame((n=>{s.current&&l.current&&(l.current.getWorldPosition(c),s.current.addBall(.5+.5*c.x,.5+.5*c.y,.5+.5*c.z,e,t,r))})),S.createElement("group",M.default({ref:l},n))})),We=S.forwardRef((({planeType:e="x",strength:t=.5,subtract:r=12,...n},o)=>{const{getParent:i}=S.useContext(Oe),s=S.useMemo((()=>i()),[i]),l=S.useRef(null);S.useImperativeHandle(o,(()=>l.current),[]);const c=S.useMemo((()=>"x"===e?"addPlaneX":"y"===e?"addPlaneY":"addPlaneZ"),[e]);return a.useFrame((()=>{s.current&&l.current&&s.current[c](t,r)})),S.createElement("group",M.default({ref:l},n))}));function Ge(e=[0,0,0]){return function(e){return Array.isArray(e)}(e)?e:e instanceof T.Vector3||e instanceof T.Euler?[e.x,e.y,e.z]:[e,e,e]}const He=S.forwardRef((function({debug:e,depthTest:t=!1,polygonOffsetFactor:r=-10,map:n,mesh:o,children:i,position:s,rotation:l,scale:u,...d},m){const f=S.useRef(null);S.useImperativeHandle(m,(()=>f.current));const p=S.useRef(null),h=S.useRef({position:new T.Vector3,rotation:new T.Euler,scale:new T.Vector3(1,1,1)});return S.useLayoutEffect((()=>{const e=(null==o?void 0:o.current)||f.current.parent,t=f.current;if(!(e instanceof T.Mesh))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');if(e){a.applyProps(h.current,{position:s,scale:u});const r=e.matrixWorld.clone();if(e.matrixWorld.identity(),l&&"number"!=typeof l)a.applyProps(h.current,{rotation:l});else{const t=new T.Object3D;t.position.copy(h.current.position);const r=e.geometry.attributes.position.array;void 0===e.geometry.attributes.normal&&e.geometry.computeVertexNormals();const n=e.geometry.attributes.normal.array;let o=1/0,i=new T.Vector3;const s=t.position.x,c=t.position.y,u=t.position.z,d=r.length;let m=-1;for(let e=0;e<d;e+=3){const t=r[e]-s,n=r[e+1]-c,a=r[e+2]-u,i=t*t+n*n+a*a;i<o&&(o=i,m=e)}i.fromArray(n,m),t.lookAt(t.position.clone().add(i)),t.rotateZ(Math.PI),t.rotateY(Math.PI),"number"==typeof l&&t.rotateZ(l),a.applyProps(h.current,{rotation:t.rotation})}return p.current&&a.applyProps(p.current,h.current),t.geometry=new c.DecalGeometry(e,h.current.position,h.current.rotation,h.current.scale),e.matrixWorld=r,()=>{t.geometry.dispose()}}}),[o,...Ge(s),...Ge(u),...Ge(l)]),S.useLayoutEffect((()=>{p.current&&p.current.traverse((e=>e.raycast=()=>null))}),[e]),S.createElement("mesh",M.default({ref:f,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":r,"material-depthTest":t,"material-map":n},d),i,e&&S.createElement("mesh",{ref:p},S.createElement("boxGeometry",null),S.createElement("meshNormalMaterial",{wireframe:!0}),S.createElement("axesHelper",null)))})),$e=t.forwardRef((function({src:e,skipFill:r,skipStrokes:o,fillMaterial:i,strokeMaterial:s,fillMeshProps:l,strokeMeshProps:u,...d},m){const f=a.useLoader(c.SVGLoader,e.startsWith("<svg")?`data:image/svg+xml;utf8,${e}`:e),p=t.useMemo((()=>o?[]:f.paths.map((e=>{var t;return void 0===(null==(t=e.userData)?void 0:t.style.stroke)||"none"===e.userData.style.stroke?null:e.subPaths.map((t=>c.SVGLoader.pointsToStroke(t.getPoints(),e.userData.style)))}))),[f,o]);t.useEffect((()=>()=>p.forEach((e=>e&&e.map((e=>e.dispose()))))),[p]);let h=0;return S.createElement("object3D",M.default({ref:m},d),S.createElement("object3D",{scale:[1,-1,1]},f.paths.map(((e,a)=>{var d,m;return S.createElement(t.Fragment,{key:a},!r&&void 0!==(null==(d=e.userData)?void 0:d.style.fill)&&"none"!==e.userData.style.fill&&c.SVGLoader.createShapes(e).map(((t,r)=>S.createElement("mesh",M.default({key:r},l,{renderOrder:h++}),S.createElement("shapeGeometry",{args:[t]}),S.createElement("meshBasicMaterial",M.default({color:e.userData.style.fill,opacity:e.userData.style.fillOpacity,transparent:!0,side:n.DoubleSide,depthWrite:!1},i))))),!o&&void 0!==(null==(m=e.userData)?void 0:m.style.stroke)&&"none"!==e.userData.style.stroke&&e.subPaths.map(((t,r)=>S.createElement("mesh",M.default({key:r,geometry:p[a][r]},u,{renderOrder:h++}),S.createElement("meshBasicMaterial",M.default({color:e.userData.style.stroke,opacity:e.userData.style.strokeOpacity,transparent:!0,side:n.DoubleSide,depthWrite:!1},s))))))}))))}));let qe=null,Xe="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Ze(e=!0,t=!0,r){return n=>{r&&r(n),e&&(qe||(qe=new c.DRACOLoader),qe.setDecoderPath("string"==typeof e?e:Xe),n.setDRACOLoader(qe)),t&&n.setMeshoptDecoder("function"==typeof c.MeshoptDecoder?c.MeshoptDecoder():c.MeshoptDecoder)}}const Ye=(e,t,r,n)=>a.useLoader(c.GLTFLoader,e,Ze(t,r,n));Ye.preload=(e,t,r,n)=>a.useLoader.preload(c.GLTFLoader,e,Ze(t,r,n)),Ye.clear=e=>a.useLoader.clear(c.GLTFLoader,e),Ye.setDecoderPath=e=>{Xe=e};const Qe=S.forwardRef((({src:e,useDraco:t,useMeshOpt:r,extendLoader:n,...a},o)=>{const{scene:i}=Ye(e,t,r,n);return S.createElement(Ve,M.default({ref:o},a,{object:i}))}));const Ke=Ee({alphaTest:0,viewport:new T.Vector2(1980,1080),focal:1e3,centerAndScaleTexture:null,covAndColorTexture:null},"\n    precision highp sampler2D;\n    precision highp usampler2D;\n    out vec4 vColor;\n    out vec3 vPosition;\n    uniform vec2 resolution;\n    uniform vec2 viewport;\n    uniform float focal;\n    attribute uint splatIndex;\n    uniform sampler2D centerAndScaleTexture;\n    uniform usampler2D covAndColorTexture;    \n\n    vec2 unpackInt16(in uint value) {\n      int v = int(value);\n      int v0 = v >> 16;\n      int v1 = (v & 0xFFFF);\n      if((v & 0x8000) != 0)\n        v1 |= 0xFFFF0000;\n      return vec2(float(v1), float(v0));\n    }\n\n    void main () {\n      ivec2 texSize = textureSize(centerAndScaleTexture, 0);\n      ivec2 texPos = ivec2(splatIndex%uint(texSize.x), splatIndex/uint(texSize.x));\n      vec4 centerAndScaleData = texelFetch(centerAndScaleTexture, texPos, 0);\n      vec4 center = vec4(centerAndScaleData.xyz, 1);\n      vec4 camspace = modelViewMatrix * center;\n      vec4 pos2d = projectionMatrix * camspace;\n\n      float bounds = 1.2 * pos2d.w;\n      if (pos2d.z < -pos2d.w || pos2d.x < -bounds || pos2d.x > bounds\n        || pos2d.y < -bounds || pos2d.y > bounds) {\n        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);\n        return;\n      }\n\n      uvec4 covAndColorData = texelFetch(covAndColorTexture, texPos, 0);\n      vec2 cov3D_M11_M12 = unpackInt16(covAndColorData.x) * centerAndScaleData.w;\n      vec2 cov3D_M13_M22 = unpackInt16(covAndColorData.y) * centerAndScaleData.w;\n      vec2 cov3D_M23_M33 = unpackInt16(covAndColorData.z) * centerAndScaleData.w;\n      mat3 Vrk = mat3(\n        cov3D_M11_M12.x, cov3D_M11_M12.y, cov3D_M13_M22.x,\n        cov3D_M11_M12.y, cov3D_M13_M22.y, cov3D_M23_M33.x,\n        cov3D_M13_M22.x, cov3D_M23_M33.x, cov3D_M23_M33.y\n      );\n\n      mat3 J = mat3(\n        focal / camspace.z, 0., -(focal * camspace.x) / (camspace.z * camspace.z),\n        0., focal / camspace.z, -(focal * camspace.y) / (camspace.z * camspace.z),\n        0., 0., 0.\n      );\n\n      mat3 W = transpose(mat3(modelViewMatrix));\n      mat3 T = W * J;\n      mat3 cov = transpose(T) * Vrk * T;\n      vec2 vCenter = vec2(pos2d) / pos2d.w;\n      float diagonal1 = cov[0][0] + 0.3;\n      float offDiagonal = cov[0][1];\n      float diagonal2 = cov[1][1] + 0.3;\n      float mid = 0.5 * (diagonal1 + diagonal2);\n      float radius = length(vec2((diagonal1 - diagonal2) / 2.0, offDiagonal));\n      float lambda1 = mid + radius;\n      float lambda2 = max(mid - radius, 0.1);\n      vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));\n      vec2 v1 = min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector;\n      vec2 v2 = min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x);\n      uint colorUint = covAndColorData.w;\n      vColor = vec4(\n        float(colorUint & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(8)) & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(16)) & uint(0xFF)) / 255.0,\n        float(colorUint >> uint(24)) / 255.0\n      );\n      vPosition = position;\n\n      gl_Position = vec4(\n        vCenter \n          + position.x * v2 / viewport * 2.0 \n          + position.y * v1 / viewport * 2.0, pos2d.z / pos2d.w, 1.0);\n    }\n    ",`\n    #include <alphatest_pars_fragment>\n    #include <alphahash_pars_fragment>\n    in vec4 vColor;\n    in vec3 vPosition;\n    void main () {\n      float A = -dot(vPosition.xy, vPosition.xy);\n      if (A < -4.0) discard;\n      float B = exp(A) * vColor.a;\n      vec4 diffuseColor = vec4(vColor.rgb, B);\n      #include <alphatest_fragment>\n      #include <alphahash_fragment>\n      gl_FragColor = diffuseColor;\n      #include <tonemapping_fragment>\n      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n    }\n  `);function Je(e){let t=null,r=0;e.onmessage=n=>{if("push"==n.data.method){0===r&&(t=new Float32Array(n.data.length));const e=new Float32Array(n.data.matrices);t.set(e,r),r+=e.length}else if("sort"==n.data.method&&null!==t){const r=function(e,r=!1){const n=t.length/16;let a=-1/0,o=1/0;const i=new Float32Array(n),s=new Int32Array(i.buffer),l=new Int32Array(n);let c=0;for(let s=0;s<n;s++){const n=e[0]*t[16*s+12]+e[1]*t[16*s+13]+e[2]*t[16*s+14]+e[3];(r||n<0&&t[16*s+15]>-1e-4*n)&&(i[c]=n,l[c]=s,c++,n>a&&(a=n),n<o&&(o=n))}const u=65535/(a-o),d=new Uint32Array(65536);for(let e=0;e<c;e++)s[e]=(i[e]-o)*u|0,d[s[e]]++;const m=new Uint32Array(65536);for(let e=1;e<65536;e++)m[e]=m[e-1]+d[e-1];const f=new Uint32Array(c);for(let e=0;e<c;e++)f[m[s[e]]++]=l[e];return f}(new Float32Array(n.data.view),n.data.hashed);e.postMessage({indices:r,key:n.data.key},[r.buffer])}}}class et extends T.Loader{constructor(...e){super(...e),this.gl=null,this.chunkSize=25e3}load(e,t,r,n){const a={gl:this.gl,url:this.manager.resolveURL(e),worker:new Worker(URL.createObjectURL(new Blob(["(",Je.toString(),")(self)"],{type:"application/javascript"}))),manager:this.manager,update:(e,t,r)=>function(e,t,r,n){if(e.updateMatrixWorld(),t.gl.getCurrentViewport(r.viewport),r.material.viewport.x=r.viewport.z,r.material.viewport.y=r.viewport.w,r.material.focal=r.viewport.w/2*Math.abs(e.projectionMatrix.elements[5]),r.ready){if(n&&r.sorted)return;r.ready=!1;const e=new Float32Array([r.modelViewMatrix.elements[2],-r.modelViewMatrix.elements[6],r.modelViewMatrix.elements[10],r.modelViewMatrix.elements[14]]);t.worker.postMessage({method:"sort",src:t.url,key:r.uuid,view:e.buffer,hashed:n},[e.buffer]),n&&t.loaded&&(r.sorted=!0)}}(t,a,e,r),connect:e=>function(e,t){e.loading||async function(e){e.loading=!0;let t=0,r=0;const n=[];let a=0;const o=0!==e.totalDownloadBytes;for(;;)try{const{value:i,done:s}=await e.stream.read();if(s)break;if(t+=i.length,null!=e.totalDownloadBytes){const r=t/e.totalDownloadBytes*100;if(e.onProgress&&r-a>1){const n=new ProgressEvent("progress",{lengthComputable:o,loaded:t,total:e.totalDownloadBytes});e.onProgress(n),a=r}}n.push(i);const l=t-r;if(null!=e.totalDownloadBytes&&l>e.rowLength*e.chunkSize){let t=Math.floor(l/e.rowLength);const a=new Uint8Array(l);let i=0;for(const e of n)a.set(e,i),i+=e.length;if(n.length=0,l>t*e.rowLength){const r=new Uint8Array(l-t*e.rowLength);r.set(a.subarray(l-r.length,l),0),n.push(r)}const s=new Uint8Array(t*e.rowLength);s.set(a.subarray(0,s.byteLength),0);const c=tt(e,s.buffer,t);if(e.worker.postMessage({method:"push",src:e.url,length:16*e.numVertices,matrices:c.buffer},[c.buffer]),r+=t*e.rowLength,e.onProgress){const t=new ProgressEvent("progress",{lengthComputable:o,loaded:e.totalDownloadBytes,total:e.totalDownloadBytes});e.onProgress(t)}}}catch(e){console.error(e);break}if(t-r>0){let t=new Uint8Array(n.reduce(((e,t)=>e+t.length),0)),r=0;for(const e of n)t.set(e,r),r+=e.length;let a=Math.floor(t.byteLength/e.rowLength);const o=tt(e,t.buffer,a);e.worker.postMessage({method:"push",src:e.url,length:16*a,matrices:o.buffer},[o.buffer])}e.loaded=!0,e.manager.itemEnd(e.url)}(e);t.ready=!1,t.pm=new T.Matrix4,t.vm1=new T.Matrix4,t.vm2=new T.Matrix4,t.viewport=new T.Vector4;let r=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight);const n=new T.InstancedBufferAttribute(r,1,!1);n.setUsage(T.DynamicDrawUsage);const a=t.geometry=new T.InstancedBufferGeometry,o=new Float32Array(18),i=new T.BufferAttribute(o,3);function s(e){if(t&&e.data.key===t.uuid){let r=new Uint32Array(e.data.indices);a.attributes.splatIndex.set(r),a.attributes.splatIndex.needsUpdate=!0,a.instanceCount=r.length,t.ready=!0}}async function l(){for(;;){const t=e.gl.properties.get(e.centerAndScaleTexture),r=e.gl.properties.get(e.covAndColorTexture);if(null!=t&&t.__webglTexture&&null!=r&&r.__webglTexture&&e.loadedVertexCount>0)break;await new Promise((e=>setTimeout(e,10)))}t.ready=!0}return a.setAttribute("position",i),i.setXYZ(2,-2,2,0),i.setXYZ(1,2,2,0),i.setXYZ(0,-2,-2,0),i.setXYZ(5,-2,-2,0),i.setXYZ(4,2,2,0),i.setXYZ(3,2,-2,0),i.needsUpdate=!0,a.setAttribute("splatIndex",n),a.instanceCount=1,e.worker.addEventListener("message",s),l(),()=>e.worker.removeEventListener("message",s)}(a,e),loading:!1,loaded:!1,loadedVertexCount:0,chunkSize:this.chunkSize,totalDownloadBytes:0,numVertices:0,rowLength:32,maxVertexes:0,bufferTextureWidth:0,bufferTextureHeight:0,stream:null,centerAndScaleData:null,covAndColorData:null,covAndColorTexture:null,centerAndScaleTexture:null,onProgress:r};(async function(e){e.manager.itemStart(e.url);const t=await fetch(e.url);if(null===t.body)throw"Failed to fetch file";let r=t.headers.get("Content-Length");const n=r?parseInt(r):void 0;if(null==n)throw"Failed to get content length";e.stream=t.body.getReader(),e.totalDownloadBytes=n,e.numVertices=Math.floor(e.totalDownloadBytes/e.rowLength);const a=e.gl.getContext();let o=a.getParameter(a.MAX_TEXTURE_SIZE);e.maxVertexes=o*o,e.numVertices>e.maxVertexes&&(e.numVertices=e.maxVertexes);return e.bufferTextureWidth=o,e.bufferTextureHeight=Math.floor((e.numVertices-1)/o)+1,e.centerAndScaleData=new Float32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.covAndColorData=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.centerAndScaleTexture=new T.DataTexture(e.centerAndScaleData,e.bufferTextureWidth,e.bufferTextureHeight,T.RGBAFormat,T.FloatType),e.centerAndScaleTexture.needsUpdate=!0,e.covAndColorTexture=new T.DataTexture(e.covAndColorData,e.bufferTextureWidth,e.bufferTextureHeight,T.RGBAIntegerFormat,T.UnsignedIntType),e.covAndColorTexture.internalFormat="RGBA32UI",e.covAndColorTexture.needsUpdate=!0,e})(a).then(t).catch((e=>{null==n||n(e),a.manager.itemError(a.url)}))}}function tt(e,t,r){const n=e.gl.getContext();if(e.loadedVertexCount+r>e.maxVertexes&&(r=e.maxVertexes-e.loadedVertexCount),r<=0)throw"Failed to parse file";const a=new Uint8Array(t),o=new Float32Array(t),i=new Float32Array(16*r),s=new Uint8Array(e.covAndColorData.buffer),l=new Int16Array(e.covAndColorData.buffer);for(let t=0;t<r;t++){const r=new T.Quaternion(-(a[32*t+28+1]-128)/128,(a[32*t+28+2]-128)/128,(a[32*t+28+3]-128)/128,-(a[32*t+28+0]-128)/128);r.invert();const n=new T.Vector3(o[8*t+0],o[8*t+1],-o[8*t+2]),c=new T.Vector3(o[8*t+3+0],o[8*t+3+1],o[8*t+3+2]),u=new T.Matrix4;u.makeRotationFromQuaternion(r),u.transpose(),u.scale(c);const d=u.clone();u.transpose(),u.premultiply(d),u.setPosition(n);const m=[0,1,2,5,6,10];let f=0;for(let e=0;e<m.length;e++)Math.abs(u.elements[m[e]])>f&&(f=Math.abs(u.elements[m[e]]));let p=4*e.loadedVertexCount+4*t;e.centerAndScaleData[p+0]=n.x,e.centerAndScaleData[p+1]=-n.y,e.centerAndScaleData[p+2]=n.z,e.centerAndScaleData[p+3]=f/32767,p=8*e.loadedVertexCount+4*t*2;for(let e=0;e<m.length;e++)l[p+e]=32767*u.elements[m[e]]/f;p=16*e.loadedVertexCount+4*(4*t+3);const h=new T.Color(a[32*t+24+0]/255,a[32*t+24+1]/255,a[32*t+24+2]/255);h.convertSRGBToLinear(),s[p+0]=255*h.r,s[p+1]=255*h.g,s[p+2]=255*h.b,s[p+3]=a[32*t+24+3],u.elements[15]=Math.max(c.x,c.y,c.z)*a[32*t+24+3]/255;for(let e=0;e<16;e++)i[16*t+e]=u.elements[e]}for(;r>0;){let t=0,a=0;const o=e.loadedVertexCount%e.bufferTextureWidth,i=Math.floor(e.loadedVertexCount/e.bufferTextureWidth);e.loadedVertexCount%e.bufferTextureWidth!=0?(t=Math.min(e.bufferTextureWidth,o+r)-o,a=1):Math.floor(r/e.bufferTextureWidth)>0?(t=e.bufferTextureWidth,a=Math.floor(r/e.bufferTextureWidth)):(t=r%e.bufferTextureWidth,a=1);const s=e.gl.properties.get(e.centerAndScaleTexture);n.bindTexture(n.TEXTURE_2D,s.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,o,i,t,a,n.RGBA,n.FLOAT,e.centerAndScaleData,4*e.loadedVertexCount);const l=e.gl.properties.get(e.covAndColorTexture);n.bindTexture(n.TEXTURE_2D,l.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,o,i,t,a,n.RGBA_INTEGER,n.UNSIGNED_INT,e.covAndColorData,4*e.loadedVertexCount),e.gl.resetState(),e.loadedVertexCount+=t*a,r-=t*a}return i}function rt(e,t,r){const n=a.useThree((e=>e.size)),o=a.useThree((e=>e.viewport)),i="number"==typeof e?e:n.width*o.dpr,s="number"==typeof t?t:n.height*o.dpr,l=("number"==typeof e?r:e)||{},{samples:c=0,depth:u,...d}=l,m=null!=u?u:l.depthBuffer,f=S.useMemo((()=>{const e=new T.WebGLRenderTarget(i,s,{minFilter:T.LinearFilter,magFilter:T.LinearFilter,type:T.HalfFloatType,...d});return m&&(e.depthTexture=new T.DepthTexture(i,s,T.FloatType)),e.samples=c,e}),[]);return S.useLayoutEffect((()=>{f.setSize(i,s),c&&(f.samples=c)}),[c,f,i,s]),S.useEffect((()=>()=>f.dispose()),[]),f}const nt=t.forwardRef((({children:e,width:r,height:n,...a},o)=>{const i=rt(r,n,a);return t.useImperativeHandle(o,(()=>i),[i]),S.createElement(S.Fragment,null,null==e?void 0:e(i))})),at=S.forwardRef((({envMap:e,resolution:t=256,frames:r=1/0,children:n,makeDefault:o,...i},s)=>{const l=a.useThree((({set:e})=>e)),c=a.useThree((({camera:e})=>e)),u=a.useThree((({size:e})=>e)),d=S.useRef(null);S.useImperativeHandle(s,(()=>d.current),[]);const m=S.useRef(null),f=rt(t);S.useLayoutEffect((()=>{i.manual||d.current.updateProjectionMatrix()}),[u,i]),S.useLayoutEffect((()=>{d.current.updateProjectionMatrix()})),S.useLayoutEffect((()=>{if(o){const e=c;return l((()=>({camera:d.current}))),()=>l((()=>({camera:e})))}}),[d,o,l]);let p=0,h=null;const x="function"==typeof n;return a.useFrame((t=>{x&&(r===1/0||p<r)&&(m.current.visible=!1,t.gl.setRenderTarget(f),h=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,d.current),t.scene.background=h,t.gl.setRenderTarget(null),m.current.visible=!0,p++)})),S.createElement(S.Fragment,null,S.createElement("orthographicCamera",M.default({left:u.width/-2,right:u.width/2,top:u.height/2,bottom:u.height/-2,ref:d},i),!x&&n),S.createElement("group",{ref:m},x&&n(f.texture)))})),ot=S.forwardRef((({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:n,children:o,...i},s)=>{const l=a.useThree((({set:e})=>e)),c=a.useThree((({camera:e})=>e)),u=a.useThree((({size:e})=>e)),d=S.useRef(null);S.useImperativeHandle(s,(()=>d.current),[]);const m=S.useRef(null),f=rt(t);S.useLayoutEffect((()=>{i.manual||(d.current.aspect=u.width/u.height)}),[u,i]),S.useLayoutEffect((()=>{d.current.updateProjectionMatrix()}));let p=0,h=null;const x="function"==typeof o;return a.useFrame((t=>{x&&(r===1/0||p<r)&&(m.current.visible=!1,t.gl.setRenderTarget(f),h=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,d.current),t.scene.background=h,t.gl.setRenderTarget(null),m.current.visible=!0,p++)})),S.useLayoutEffect((()=>{if(n){const e=c;return l((()=>({camera:d.current}))),()=>l((()=>({camera:e})))}}),[d,n,l]),S.createElement(S.Fragment,null,S.createElement("perspectiveCamera",M.default({ref:d},i),!x&&o),S.createElement("group",{ref:m},x&&o(f.texture)))}));function it({resolution:e=256,near:r=.1,far:o=1e3,envMap:i,fog:s}={}){const l=a.useThree((({gl:e})=>e)),c=a.useThree((({scene:e})=>e)),u=t.useMemo((()=>{const t=new n.WebGLCubeRenderTarget(e);return t.texture.type=n.HalfFloatType,t}),[e]);t.useEffect((()=>()=>{u.dispose()}),[u]);const d=t.useMemo((()=>new T.CubeCamera(r,o,u)),[r,o,u]);let m,f;const p=S.useCallback((()=>{m=c.fog,f=c.background,c.background=i||f,c.fog=s||m,d.update(l,c),c.fog=m,c.background=f}),[l,c,d]);return{fbo:u,camera:d,update:p}}const st=S.forwardRef(((e,t)=>{const{camera:r,onChange:n,makeDefault:o,...i}=e,s=a.useThree((e=>e.camera)),l=a.useThree((e=>e.invalidate)),u=a.useThree((e=>e.get)),d=a.useThree((e=>e.set)),m=r||s,f=S.useMemo((()=>new c.DeviceOrientationControls(m)),[m]);return S.useEffect((()=>{const e=e=>{l(),n&&n(e)};return null==f||null==f.addEventListener||f.addEventListener("change",e),()=>null==f||null==f.removeEventListener?void 0:f.removeEventListener("change",e)}),[n,f,l]),a.useFrame((()=>null==f?void 0:f.update()),-1),S.useEffect((()=>{const e=f;return null==e||e.connect(),()=>null==e?void 0:e.dispose()}),[f]),S.useEffect((()=>{if(o){const e=u().controls;return d({controls:f}),()=>d({controls:e})}}),[o,f]),f?S.createElement("primitive",M.default({ref:t,object:f},i)):null})),lt=S.forwardRef((({domElement:e,...t},r)=>{const{onChange:n,makeDefault:o,...i}=t,s=a.useThree((e=>e.invalidate)),l=a.useThree((e=>e.camera)),u=a.useThree((e=>e.gl)),d=a.useThree((e=>e.events)),m=a.useThree((e=>e.get)),f=a.useThree((e=>e.set)),p=e||d.connected||u.domElement,h=S.useMemo((()=>new c.FlyControls(l)),[l]);return S.useEffect((()=>(h.connect(p),()=>{h.dispose()})),[p,h,s]),S.useEffect((()=>{const e=e=>{s(),n&&n(e)};return null==h.addEventListener||h.addEventListener("change",e),()=>null==h.removeEventListener?void 0:h.removeEventListener("change",e)}),[n,s]),S.useEffect((()=>{if(o){const e=m().controls;return f({controls:h}),()=>f({controls:e})}}),[o,h]),a.useFrame(((e,t)=>h.update(t))),S.createElement("primitive",M.default({ref:r,object:h,args:[l,p]},i))})),ct=S.forwardRef(((e={enableDamping:!0},t)=>{const{domElement:r,camera:n,makeDefault:o,onChange:i,onStart:s,onEnd:l,...u}=e,d=a.useThree((e=>e.invalidate)),m=a.useThree((e=>e.camera)),f=a.useThree((e=>e.gl)),p=a.useThree((e=>e.events)),h=a.useThree((e=>e.set)),x=a.useThree((e=>e.get)),y=r||p.connected||f.domElement,v=n||m,g=S.useMemo((()=>new c.MapControls(v)),[v]);return S.useEffect((()=>{g.connect(y);const e=e=>{d(),i&&i(e)};return g.addEventListener("change",e),s&&g.addEventListener("start",s),l&&g.addEventListener("end",l),()=>{g.dispose(),g.removeEventListener("change",e),s&&g.removeEventListener("start",s),l&&g.removeEventListener("end",l)}}),[i,s,l,g,d,y]),S.useEffect((()=>{if(o){const e=x().controls;return h({controls:g}),()=>h({controls:e})}}),[o,g]),a.useFrame((()=>g.update()),-1),S.createElement("primitive",M.default({ref:t,object:g,enableDamping:!0},u))})),ut=S.forwardRef((({makeDefault:e,camera:t,regress:r,domElement:n,enableDamping:o=!0,keyEvents:i=!1,onChange:s,onStart:l,onEnd:u,...d},m)=>{const f=a.useThree((e=>e.invalidate)),p=a.useThree((e=>e.camera)),h=a.useThree((e=>e.gl)),x=a.useThree((e=>e.events)),y=a.useThree((e=>e.setEvents)),v=a.useThree((e=>e.set)),g=a.useThree((e=>e.get)),w=a.useThree((e=>e.performance)),z=t||p,b=n||x.connected||h.domElement,E=S.useMemo((()=>new c.OrbitControls(z)),[z]);return a.useFrame((()=>{E.enabled&&E.update()}),-1),S.useEffect((()=>(i&&E.connect(!0===i?b:i),E.connect(b),()=>{E.dispose()})),[i,b,r,E,f]),S.useEffect((()=>{const e=e=>{f(),r&&w.regress(),s&&s(e)},t=e=>{l&&l(e)},n=e=>{u&&u(e)};return E.addEventListener("change",e),E.addEventListener("start",t),E.addEventListener("end",n),()=>{E.removeEventListener("start",t),E.removeEventListener("end",n),E.removeEventListener("change",e)}}),[s,l,u,E,f,y]),S.useEffect((()=>{if(e){const e=g().controls;return v({controls:E}),()=>v({controls:e})}}),[e,E]),S.createElement("primitive",M.default({ref:m,object:E,enableDamping:o},d))})),dt=S.forwardRef((({makeDefault:e,camera:t,domElement:r,regress:n,onChange:o,onStart:i,onEnd:s,...l},u)=>{const{invalidate:d,camera:m,gl:f,events:p,set:h,get:x,performance:y,viewport:v}=a.useThree(),g=t||m,w=r||p.connected||f.domElement,z=S.useMemo((()=>new c.TrackballControls(g)),[g]);return a.useFrame((()=>{z.enabled&&z.update()}),-1),S.useEffect((()=>(z.connect(w),()=>{z.dispose()})),[w,n,z,d]),S.useEffect((()=>{const e=e=>{d(),n&&y.regress(),o&&o(e)};return z.addEventListener("change",e),i&&z.addEventListener("start",i),s&&z.addEventListener("end",s),()=>{i&&z.removeEventListener("start",i),s&&z.removeEventListener("end",s),z.removeEventListener("change",e)}}),[o,i,s,z,d]),S.useEffect((()=>{z.handleResize()}),[v]),S.useEffect((()=>{if(e){const e=x().controls;return h({controls:z}),()=>h({controls:e})}}),[e,z]),S.createElement("primitive",M.default({ref:u,object:z},l))})),mt=t.forwardRef((({camera:e,makeDefault:r,regress:n,domElement:o,onChange:i,onStart:s,onEnd:l,...u},d)=>{const m=a.useThree((e=>e.invalidate)),f=a.useThree((e=>e.camera)),p=a.useThree((e=>e.gl)),h=a.useThree((e=>e.events)),x=a.useThree((e=>e.set)),y=a.useThree((e=>e.get)),v=a.useThree((e=>e.performance)),g=e||f,w=o||h.connected||p.domElement,z=t.useMemo((()=>new c.ArcballControls(g)),[g]);return a.useFrame((()=>{z.enabled&&z.update()}),-1),t.useEffect((()=>(z.connect(w),()=>{z.dispose()})),[w,n,z,m]),t.useEffect((()=>{const e=e=>{m(),n&&v.regress(),i&&i(e)};return z.addEventListener("change",e),s&&z.addEventListener("start",s),l&&z.addEventListener("end",l),()=>{z.removeEventListener("change",e),s&&z.removeEventListener("start",s),l&&z.removeEventListener("end",l)}}),[i,s,l]),t.useEffect((()=>{if(r){const e=y().controls;return x({controls:z}),()=>x({controls:e})}}),[r,z]),S.createElement("primitive",M.default({ref:d,object:z},u))})),ft=S.forwardRef((({children:e,domElement:t,onChange:r,onMouseDown:n,onMouseUp:o,onObjectChange:i,object:s,makeDefault:l,camera:u,enabled:d,axis:m,mode:f,translationSnap:p,rotationSnap:h,scaleSnap:x,space:y,size:v,showX:g,showY:w,showZ:z,...b},E)=>{const C=a.useThree((e=>e.controls)),P=a.useThree((e=>e.gl)),R=a.useThree((e=>e.events)),D=a.useThree((e=>e.camera)),F=a.useThree((e=>e.invalidate)),k=a.useThree((e=>e.get)),_=a.useThree((e=>e.set)),A=u||D,L=t||R.connected||P.domElement,I=S.useMemo((()=>new c.TransformControls(A,L)),[A,L]),B=S.useRef(null);S.useLayoutEffect((()=>(s?I.attach(s instanceof T.Object3D?s:s.current):B.current instanceof T.Object3D&&I.attach(B.current),()=>{I.detach()})),[s,e,I]),S.useEffect((()=>{if(C){const e=e=>C.enabled=!e.value;return I.addEventListener("dragging-changed",e),()=>I.removeEventListener("dragging-changed",e)}}),[I,C]);const U=S.useRef(void 0),V=S.useRef(void 0),O=S.useRef(void 0),N=S.useRef(void 0);return S.useLayoutEffect((()=>{U.current=r}),[r]),S.useLayoutEffect((()=>{V.current=n}),[n]),S.useLayoutEffect((()=>{O.current=o}),[o]),S.useLayoutEffect((()=>{N.current=i}),[i]),S.useEffect((()=>{const e=e=>{F(),null==U.current||U.current(e)},t=e=>null==V.current?void 0:V.current(e),r=e=>null==O.current?void 0:O.current(e),n=e=>null==N.current?void 0:N.current(e);return I.addEventListener("change",e),I.addEventListener("mouseDown",t),I.addEventListener("mouseUp",r),I.addEventListener("objectChange",n),()=>{I.removeEventListener("change",e),I.removeEventListener("mouseDown",t),I.removeEventListener("mouseUp",r),I.removeEventListener("objectChange",n)}}),[F,I]),S.useEffect((()=>{if(l){const e=k().controls;return _({controls:I}),()=>_({controls:e})}}),[l,I]),S.createElement(S.Fragment,null,S.createElement("primitive",{ref:E,object:I,enabled:d,axis:m,mode:f,translationSnap:p,rotationSnap:h,scaleSnap:x,space:y,size:v,showX:g,showY:w,showZ:z}),S.createElement("group",M.default({ref:B},b),e))})),pt=S.forwardRef((({domElement:e,selector:t,onChange:r,onLock:n,onUnlock:o,enabled:i=!0,makeDefault:s,...l},u)=>{const{camera:d,...m}=l,f=a.useThree((e=>e.setEvents)),p=a.useThree((e=>e.gl)),h=a.useThree((e=>e.camera)),x=a.useThree((e=>e.invalidate)),y=a.useThree((e=>e.events)),v=a.useThree((e=>e.get)),g=a.useThree((e=>e.set)),w=d||h,z=e||y.connected||p.domElement,b=S.useMemo((()=>new c.PointerLockControls(w)),[w]);return S.useEffect((()=>{if(i){b.connect(z);const e=v().events.compute;return f({compute(e,t){const r=t.size.width/2,n=t.size.height/2;t.pointer.set(r/t.size.width*2-1,-n/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{b.disconnect(),f({compute:e})}}}),[i,b]),S.useEffect((()=>{const e=e=>{x(),r&&r(e)};b.addEventListener("change",e),n&&b.addEventListener("lock",n),o&&b.addEventListener("unlock",o);const a=()=>b.lock(),i=t?Array.from(document.querySelectorAll(t)):[document];return i.forEach((e=>e&&e.addEventListener("click",a))),()=>{b.removeEventListener("change",e),n&&b.removeEventListener("lock",n),o&&b.removeEventListener("unlock",o),i.forEach((e=>e?e.removeEventListener("click",a):void 0))}}),[r,n,o,t,b,x]),S.useEffect((()=>{if(s){const e=v().controls;return g({controls:b}),()=>g({controls:e})}}),[s,b]),S.createElement("primitive",M.default({ref:u,object:b},m))})),ht=S.forwardRef((({domElement:e,makeDefault:t,...r},n)=>{const o=a.useThree((e=>e.camera)),i=a.useThree((e=>e.gl)),s=a.useThree((e=>e.events)),l=a.useThree((e=>e.get)),u=a.useThree((e=>e.set)),d=e||s.connected||i.domElement,[m]=S.useState((()=>new c.FirstPersonControls(o,d)));return S.useEffect((()=>{if(t){const e=l().controls;return u({controls:m}),()=>u({controls:e})}}),[t,m]),a.useFrame(((e,t)=>{m.update(t)}),-1),m?S.createElement("primitive",M.default({ref:n,object:m},r)):null})),xt=t.forwardRef(((e,r)=>{const{impl:o,camera:i,domElement:s,makeDefault:l,onControlStart:c,onControl:u,onControlEnd:d,onTransitionStart:m,onUpdate:f,onWake:p,onRest:h,onSleep:x,onStart:y,onEnd:v,onChange:g,regress:w,...z}=e,b=null!=o?o:P.default;t.useMemo((()=>{const e={Box3:n.Box3,MathUtils:{clamp:n.MathUtils.clamp},Matrix4:n.Matrix4,Quaternion:n.Quaternion,Raycaster:n.Raycaster,Sphere:n.Sphere,Spherical:n.Spherical,Vector2:n.Vector2,Vector3:n.Vector3,Vector4:n.Vector4};b.install({THREE:e}),a.extend({CameraControlsImpl:b})}),[b]);const E=a.useThree((e=>e.camera)),C=a.useThree((e=>e.gl)),T=a.useThree((e=>e.invalidate)),R=a.useThree((e=>e.events)),D=a.useThree((e=>e.setEvents)),F=a.useThree((e=>e.set)),k=a.useThree((e=>e.get)),_=a.useThree((e=>e.performance)),A=i||E,L=s||R.connected||C.domElement,I=t.useMemo((()=>new b(A)),[b,A]);return a.useFrame(((e,t)=>{I.update(t)}),-1),t.useEffect((()=>(I.connect(L),()=>{I.disconnect()})),[L,I]),t.useEffect((()=>{function e(){T(),w&&_.regress()}const t=t=>{e(),null==c||c(t),null==y||y(t)},r=t=>{e(),null==u||u(t),null==g||g(t)},n=e=>{null==d||d(e),null==v||v(e)},a=t=>{e(),null==m||m(t),null==g||g(t)},o=t=>{e(),null==f||f(t),null==g||g(t)},i=t=>{e(),null==p||p(t),null==g||g(t)},s=e=>{null==h||h(e)},l=e=>{null==x||x(e)};return I.addEventListener("controlstart",t),I.addEventListener("control",r),I.addEventListener("controlend",n),I.addEventListener("transitionstart",a),I.addEventListener("update",o),I.addEventListener("wake",i),I.addEventListener("rest",s),I.addEventListener("sleep",l),()=>{I.removeEventListener("controlstart",t),I.removeEventListener("control",r),I.removeEventListener("controlend",n),I.removeEventListener("transitionstart",a),I.removeEventListener("update",o),I.removeEventListener("wake",i),I.removeEventListener("rest",s),I.removeEventListener("sleep",l)}}),[I,T,D,w,_,c,u,d,m,f,p,h,x,g,y,v]),t.useEffect((()=>{if(l){const e=k().controls;return F({controls:I}),()=>F({controls:e})}}),[l,I]),S.createElement("primitive",M.default({ref:r,object:I},z))})),yt=S.createContext(null);function vt(){const e=S.useContext(yt);if(!e)throw new Error("useMotion hook must be used in a MotionPathControls component.");return e}function gt({points:e=50,color:t="black"}){const{path:r}=vt(),[n,a]=S.useState([]),o=S.useMemo((()=>new T.MeshBasicMaterial({color:t})),[t]),i=S.useMemo((()=>new T.SphereGeometry(.025,16,16)),[]),s=S.useRef([]);return S.useEffect((()=>{r.curves!==s.current&&(a(r.getPoints(e)),s.current=r.curves)})),n.map(((e,t)=>S.createElement("mesh",{key:t,material:o,geometry:i,position:[e.x,e.y,e.z]})))}const wt=S.forwardRef((({children:e,curves:t=[],debug:r=!1,debugColor:n="black",object:o,focus:i,loop:l=!0,offset:c,smooth:u=!1,eps:d=1e-5,damping:m=.1,focusDamping:f=.1,maxSpeed:p=1/0,...h},x)=>{const{camera:y}=a.useThree(),v=S.useRef(null),g=S.useRef(null!=c?c:0),w=S.useMemo((()=>new T.CurvePath),[]),z=S.useMemo((()=>({focus:i,object:(null==o?void 0:o.current)instanceof T.Object3D?o:{current:y},path:w,current:g.current,offset:g.current,point:new T.Vector3,tangent:new T.Vector3,next:new T.Vector3})),[i,o]),b=a.useInstanceHandle(v);S.useLayoutEffect((()=>{const e=b.current;w.curves=[];const r=t.length>0?t:e.children.map((e=>e.object));for(let e=0;e<r.length;e++)w.add(r[e]);if(u){const e=w.getPoints("number"==typeof u?u:1),t=new T.CatmullRomCurve3(e);w.curves=[t]}w.updateArcLengths()})),S.useImperativeHandle(x,(()=>Object.assign(v.current,{motion:z})),[z]),S.useLayoutEffect((()=>{g.current=s.misc.repeat(g.current,1)}),[c]);const E=S.useMemo((()=>new T.Vector3),[]);return a.useFrame(((e,t)=>{const r=z.offset;if(s.easing.damp(g,"current",void 0!==c?c:z.current,m,t,p,void 0,d),z.offset=l?s.misc.repeat(g.current,1):s.misc.clamp(g.current,0,1),w.getCurveLengths().length>0){w.getPointAt(z.offset,z.point),w.getTangentAt(z.offset,z.tangent).normalize(),w.getPointAt(s.misc.repeat(g.current-(r-z.offset),1),z.next);const e=(null==o?void 0:o.current)instanceof T.Object3D?o.current:y;e.position.copy(z.point),i&&s.easing.dampLookAt(e,(e=>(null==e?void 0:e.current)instanceof T.Object3D)(i)?i.current.getWorldPosition(E):i,f,t,p,void 0,d)}})),S.createElement("group",M.default({ref:v},h),S.createElement(yt.Provider,{value:z},e,r&&S.createElement(gt,{color:n})))}));function zt({defaultScene:e,defaultCamera:t,renderPriority:r=1}){const{gl:n,scene:o,camera:i}=a.useThree();let s;return a.useFrame((()=>{s=n.autoClear,1===r&&(n.autoClear=!0,n.render(e,t)),n.autoClear=!1,n.clearDepth(),n.render(o,i),n.autoClear=s}),r),S.createElement("group",{onPointerOver:()=>null})}function bt({children:e,renderPriority:t=1}){const{scene:r,camera:n}=a.useThree(),[o]=S.useState((()=>new T.Scene));return S.createElement(S.Fragment,null,a.createPortal(S.createElement(S.Fragment,null,e,S.createElement(zt,{defaultScene:r,defaultCamera:n,renderPriority:t})),o,{events:{priority:t+1}}))}const Et=S.createContext({}),Mt=()=>S.useContext(Et),St=2*Math.PI,Ct=new n.Object3D,Tt=new n.Matrix4,[Pt,Rt]=[new n.Quaternion,new n.Quaternion],Dt=new n.Vector3,Ft=new n.Vector3,kt=e=>"getTarget"in e,_t="#f0f0f0",At="#999",Lt="black",It="black",Bt=["Right","Left","Top","Bottom","Front","Back"],Ut=e=>new n.Vector3(...e).multiplyScalar(.38),Vt=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(Ut),Ot=[.25,.25,.25],Nt=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(Ut),jt=Nt.map((e=>e.toArray().map((e=>0==e?.5:.25)))),Wt=({hover:e,index:t,font:r="20px Inter var, Arial, sans-serif",faces:o=Bt,color:i=_t,hoverColor:s=At,textColor:l=Lt,strokeColor:c=It,opacity:u=1})=>{const d=a.useThree((e=>e.gl)),m=S.useMemo((()=>{const e=document.createElement("canvas");e.width=128,e.height=128;const a=e.getContext("2d");return a.fillStyle=i,a.fillRect(0,0,e.width,e.height),a.strokeStyle=c,a.strokeRect(0,0,e.width,e.height),a.font=r,a.textAlign="center",a.fillStyle=l,a.fillText(o[t].toUpperCase(),64,76),new n.CanvasTexture(e)}),[t,o,r,i,l,c]);return S.createElement("meshBasicMaterial",{map:m,"map-anisotropy":d.capabilities.getMaxAnisotropy()||1,attach:`material-${t}`,color:e?s:"white",transparent:!0,opacity:u})},Gt=e=>{const{tweenCamera:t}=Mt(),[r,n]=S.useState(null);return S.createElement("mesh",{onPointerOut:e=>{e.stopPropagation(),n(null)},onPointerMove:e=>{e.stopPropagation(),n(Math.floor(e.faceIndex/2))},onClick:e.onClick||(e=>{e.stopPropagation(),t(e.face.normal)})},[...Array(6)].map(((t,n)=>S.createElement(Wt,M.default({key:n,index:n,hover:r===n},e)))),S.createElement("boxGeometry",null))},Ht=({onClick:e,dimensions:t,position:r,hoverColor:n=At})=>{const{tweenCamera:a}=Mt(),[o,i]=S.useState(!1);return S.createElement("mesh",{scale:1.01,position:r,onPointerOver:e=>{e.stopPropagation(),i(!0)},onPointerOut:e=>{e.stopPropagation(),i(!1)},onClick:e||(e=>{e.stopPropagation(),a(r)})},S.createElement("meshBasicMaterial",{color:o?n:"white",transparent:!0,opacity:.6,visible:o}),S.createElement("boxGeometry",{args:t}))};function $t({scale:e=[.8,.05,.05],color:t,rotation:r}){return S.createElement("group",{rotation:r},S.createElement("mesh",{position:[.4,0,0]},S.createElement("boxGeometry",{args:e}),S.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function qt({onClick:e,font:t,disabled:r,arcStyle:o,label:i,labelColor:s,axisHeadScale:l=1,...c}){const u=a.useThree((e=>e.gl)),d=S.useMemo((()=>{const e=document.createElement("canvas");e.width=64,e.height=64;const r=e.getContext("2d");return r.beginPath(),r.arc(32,32,16,0,2*Math.PI),r.closePath(),r.fillStyle=o,r.fill(),i&&(r.font=t,r.textAlign="center",r.fillStyle=s,r.fillText(i,32,41)),new n.CanvasTexture(e)}),[o,i,s,t]),[m,f]=S.useState(!1),p=(i?1:.75)*(m?1.2:1)*l;return S.createElement("sprite",M.default({scale:p,onPointerOver:r?void 0:e=>{e.stopPropagation(),f(!0)},onPointerOut:r?void 0:e||(e=>{e.stopPropagation(),f(!1)})},c),S.createElement("spriteMaterial",{map:d,"map-anisotropy":u.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:i?1:.75,toneMapped:!1}))}const Xt=Ee({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new T.Color,sectionColor:new T.Color,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new T.Vector3,worldPlanePosition:new T.Vector3},"\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform vec3 worldPlanePosition;\n    uniform float fadeDistance;\n    uniform bool infiniteGrid;\n    uniform bool followCamera;\n\n    void main() {\n      localPosition = position.xzy;\n      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;\n      \n      worldPosition = modelMatrix * vec4(localPosition, 1.0);\n      if (followCamera) {\n        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);\n        localPosition = (inverse(modelMatrix) * worldPosition).xyz;\n      }\n\n      gl_Position = projectionMatrix * viewMatrix * worldPosition;\n    }\n  ",`\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform float cellSize;\n    uniform float sectionSize;\n    uniform vec3 cellColor;\n    uniform vec3 sectionColor;\n    uniform float fadeDistance;\n    uniform float fadeStrength;\n    uniform float fadeFrom;\n    uniform float cellThickness;\n    uniform float sectionThickness;\n\n    float getGrid(float size, float thickness) {\n      vec2 r = localPosition.xz / size;\n      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n      float line = min(grid.x, grid.y) + 1.0 - thickness;\n      return 1.0 - min(line, 1.0);\n    }\n\n    void main() {\n      float g1 = getGrid(cellSize, cellThickness);\n      float g2 = getGrid(sectionSize, sectionThickness);\n\n      vec3 from = worldCamProjPosition*vec3(fadeFrom);\n      float dist = distance(from, worldPosition.xyz);\n      float d = 1.0 - min(dist / fadeDistance, 1.0);\n      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));\n\n      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));\n      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);\n      if (gl_FragColor.a <= 0.0) discard;\n\n      #include <tonemapping_fragment>\n      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n    }\n  `),Zt=S.forwardRef((({args:e,cellColor:t="#000000",sectionColor:r="#2080ff",cellSize:n=.5,sectionSize:o=1,followCamera:i=!1,infiniteGrid:s=!1,fadeDistance:l=100,fadeStrength:c=1,fadeFrom:u=1,cellThickness:d=.5,sectionThickness:m=1,side:f=T.BackSide,...p},h)=>{a.extend({GridMaterial:Xt});const x=S.useRef(null);S.useImperativeHandle(h,(()=>x.current),[]);const y=new T.Plane,v=new T.Vector3(0,1,0),g=new T.Vector3(0,0,0);a.useFrame((e=>{y.setFromNormalAndCoplanarPoint(v,g).applyMatrix4(x.current.matrixWorld);const t=x.current.material,r=t.uniforms.worldCamProjPosition,n=t.uniforms.worldPlanePosition;y.projectPoint(e.camera.position,r.value),n.value.set(0,0,0).applyMatrix4(x.current.matrixWorld)}));const w={cellSize:n,sectionSize:o,cellColor:t,sectionColor:r,cellThickness:d,sectionThickness:m},z={fadeDistance:l,fadeStrength:c,fadeFrom:u,infiniteGrid:s,followCamera:i};return S.createElement("mesh",M.default({ref:x,frustumCulled:!1},p),S.createElement("gridMaterial",M.default({transparent:!0,"extensions-derivatives":!0,side:f},w,z)),S.createElement("planeGeometry",{args:e}))}));function Yt(e,{path:t}){const[r]=a.useLoader(n.CubeTextureLoader,[e],(e=>e.setPath(t)));return r}function Qt(e){return a.useLoader(c.FBXLoader,e)}Yt.preload=(e,{path:t})=>a.useLoader.preload(n.CubeTextureLoader,[e],(e=>e.setPath(t))),Qt.preload=e=>a.useLoader.preload(c.FBXLoader,e),Qt.clear=e=>a.useLoader.clear(c.FBXLoader,e);const Kt="https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master";function Jt(e,r=`${Kt}/basis/`){const n=a.useThree((e=>e.gl)),o=a.useLoader(c.KTX2Loader,Me(e)?Object.values(e):e,(e=>{e.detectSupport(n),e.setTranscoderPath(r)}));if(t.useEffect((()=>{(Array.isArray(o)?o:[o]).forEach(n.initTexture)}),[n,o]),Me(e)){const t=Object.keys(e),r={};return t.forEach((e=>Object.assign(r,{[e]:o[t.indexOf(e)]}))),r}return o}Jt.preload=(e,t=`${Kt}/basis/`)=>a.useLoader.preload(c.KTX2Loader,e,(e=>{e.setTranscoderPath(t)})),Jt.clear=e=>a.useLoader.clear(c.KTX2Loader,e);const er=((e,t)=>"undefined"!=typeof window&&"function"==typeof(null==(e=window.document)?void 0:e.createElement)&&"string"==typeof(null==(t=window.navigator)?void 0:t.userAgent))();let tr=null;function rr(e,{unsuspend:r="loadedmetadata",start:n=!0,hls:o={},crossOrigin:i="anonymous",muted:s=!0,loop:l=!0,playsInline:c=!0,onVideoFrame:u,...d}={}){const f=a.useThree((e=>e.gl)),p=t.useRef(null),x=m.suspend((()=>new Promise((async t=>{let n,a;"string"==typeof e?n=e:a=e;const u=Object.assign(document.createElement("video"),{src:n,srcObject:a,crossOrigin:i,loop:l,muted:s,playsInline:c,...d});if(n&&er&&n.endsWith(".m3u8")){const e=p.current=await async function(...e){var t;null!==(t=tr)&&void 0!==t||(tr=await Promise.resolve().then((function(){return E(require("hls.js"))})));const r=tr.default;return r.isSupported()?new r(...e):null}(o);e&&(e.on(h.Events.MEDIA_ATTACHED,(()=>{e.loadSource(n)})),e.attachMedia(u))}const m=new T.VideoTexture(u);m.colorSpace=f.outputColorSpace,u.addEventListener(r,(()=>t(m)))}))),[e]),y=x.source.data;return ar(y,u),t.useEffect((()=>(n&&x.image.play(),()=>{p.current&&(p.current.destroy(),p.current=null)})),[x,n]),x}const nr=t.forwardRef((({children:e,src:r,...n},a)=>{const o=rr(r,n);return t.useEffect((()=>()=>{o.dispose()}),[o]),t.useImperativeHandle(a,(()=>o),[o]),S.createElement(S.Fragment,null,null==e?void 0:e(o))})),ar=(e,r)=>{t.useEffect((()=>{if(!r)return;if(!e.requestVideoFrameCallback)return;let t;const n=(...a)=>{r(...a),t=e.requestVideoFrameCallback(n)};return e.requestVideoFrameCallback(n),()=>e.cancelVideoFrameCallback(t)}),[e,r])},or=(e,t)=>{if(Array.isArray(e))return e[0];return e[null!=t?t:Object.keys(e)[0]][0]},ir=e=>{for(let t=3;t<e.length;t+=4)if(0!==e[t])return!1;return!0};function sr(e,r,o,i,s,l){const c=S.useRef(a.useThree((e=>e.viewport))),u=S.useRef(null),d=S.useRef(0),m=S.useRef(e),f=S.useRef(r),p=S.useRef(o),[h,x]=t.useState(null),[y,v]=S.useState(new T.Texture),g=S.useMemo((()=>new T.TextureLoader),[]),[w,z]=t.useState(null),b=S.useCallback(((e,t,r)=>{const n=t*(c.current.aspect>e/t?c.current.width/e:c.current.height/t),a=e*(c.current.aspect>e/t?c.current.width/e:c.current.height/t)*r,o=n*r;let i=Math.min(1,a),s=Math.min(1,o);return a>1&&(i=1,s=o/a*1),new T.Vector3(i,s,1)}),[]),E=S.useCallback(((e,t)=>{if(e.image){const r=document.createElement("canvas"),n=r.getContext("2d",l);if(!n)throw new Error("Failed to get 2d context");r.width=e.image.width,r.height=e.image.height,n.drawImage(e.image,0,0);const a=e.image.width,o=e.image.height,i=Math.round(Math.sqrt(t*(a/o))),s=Math.round(t/i),c=a/i,u=o/s,d=[];for(let e=0;e<s;e++)for(let r=0;r<i;r++){if(e*i+r>=t){d.push({row:e,col:r});continue}const a=n.getImageData(r*c,e*u,c,u).data;ir(a)&&d.push({row:e,col:r})}return{rows:s,columns:i,frameWidth:c,frameHeight:u,emptyFrames:d}}return{rows:0,columns:0,frameWidth:0,frameHeight:0,emptyFrames:[]}}),[l]),M=S.useCallback((e=>{const t=e=>{let t=null;for(const r of e){const{w:e,h:n}=r.frame,a=e*n;(!t||a>t.area)&&(t={w:e,h:n,area:a})}return e.map((e=>{const{w:r,h:n}=e.frame,a=r*n,o=t?a===t.area?1:Math.sqrt(a/t.area):1;return{...e,scaleRatio:o}}))};if(Array.isArray(e))return t(e);{const r={};for(const n in e)r[n]=t(e[n]);return r}}),[]),C=S.useCallback((()=>{const e={},t=u.current,r=p.current;if(t){if(r&&Array.isArray(t.frames)){for(let n=0;n<r.length;n++){e[r[n]]=[];for(const a of t.frames){const t=a.frame,o=a.sourceSize.w,i=a.sourceSize.h;"string"==typeof a.filename&&-1!==a.filename.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({...a,frame:t,sourceSize:{w:o,h:i}})}}for(const t in e){const r=M(e[t]);Array.isArray(r)&&(e[t]=r)}return e}if(r&&"object"==typeof t.frames){for(let n=0;n<r.length;n++){e[r[n]]=[];for(const a in t.frames){const o=t.frames[a],i=o.frame,s=o.sourceSize.w,l=o.sourceSize.h;"string"==typeof a&&-1!==a.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({...o,frame:i,sourceSize:{w:s,h:l}})}}for(const t in e){const r=M(e[t]);Array.isArray(r)&&(e[t]=r)}return e}{let e=[];return null!=t&&t.frames&&(e=Array.isArray(t.frames)?t.frames.map((e=>({...e,x:e.frame.x,y:e.frame.y,w:e.frame.w,h:e.frame.h}))):Object.values(t.frames).flat().map((e=>({...e,x:e.frame.x,y:e.frame.y,w:e.frame.w,h:e.frame.h})))),M(e)}}return[]}),[M,u]),P=S.useCallback(((e,t)=>{let r=new T.Vector3(1,1,1);if(null===e){if(t&&i){const e=t.image.width,n=t.image.height;d.current=i;const{rows:a,columns:o,frameWidth:s,frameHeight:l,emptyFrames:c}=E(t,i),m={frames:[],meta:{version:"1.0",size:{w:e,h:n},rows:a,columns:o,frameWidth:s,frameHeight:l,scale:"1"}};for(let e=0;e<a;e++)for(let t=0;t<o;t++){(null!=c?c:[]).some((r=>r.row===e&&r.col===t))||Array.isArray(m.frames)&&m.frames.push({frame:{x:t*s,y:e*l,w:s,h:l},scaleRatio:1,rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:s,h:l},sourceSize:{w:s,h:l}})}r=b(s,l,.1),u.current=m}u.current&&u.current.frames&&(u.current.frames=M(u.current.frames))}else if(t){u.current=e,u.current.frames=C(),d.current=Array.isArray(e.frames)?e.frames.length:Object.keys(e.frames).length;const{w:t,h:n}=or(e.frames).sourceSize;r=b(t,n,.1)}x(u.current),"encoding"in t?t.encoding=3001:"colorSpace"in t&&(t.colorSpace=T.SRGBColorSpace),v(t),z({spriteTexture:t,spriteData:u.current,aspect:r})}),[E,i,C,b,M]),R=S.useCallback(((e,t,r)=>{const n=fetch(e).then((e=>e.json())),a=new Promise((e=>{g.load(t,e)}));Promise.all([n,a]).then((e=>{r(e[0],e[1])}))}),[g]),D=S.useCallback((e=>{if(!e&&!m.current)throw new Error("Either textureUrl or input must be provided");const t=null!=e?e:m.current;if(!t)throw new Error("A valid texture URL must be provided");g.load(t,(e=>P(null,e)))}),[g,P]),F=S.useCallback(((e,t)=>{t&&e?R(t,e,P):D(e)}),[R,D,P]);return S.useLayoutEffect((()=>{f.current&&m.current?R(f.current,m.current,P):m.current&&D();const e=m.current;return()=>{e&&a.useLoader.clear(n.TextureLoader,e)}}),[R,D,P]),S.useLayoutEffect((()=>{null==s||s(y,null!=h?h:null)}),[y,h,s]),{spriteObj:w,loadJsonAndTexture:F}}function lr(e,t,...r){const n=S.useRef(null),o=a.useThree((e=>e.scene));return S.useLayoutEffect((()=>{let a;if(e&&null!=e&&e.current&&t&&(n.current=a=new t(e.current,...r)),a)return a.traverse((e=>e.raycast=()=>null)),o.add(a),()=>{n.current=void 0,o.remove(a),null==a.dispose||a.dispose()}}),[o,t,e,...r]),a.useFrame((()=>{var e;null==(e=n.current)||null==e.update||e.update()})),n}sr.preload=e=>a.useLoader.preload(n.TextureLoader,e),sr.clear=e=>a.useLoader.clear(n.TextureLoader,e);function cr(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}const ur=S.forwardRef((function({className:e,parent:t,id:r,clearStatsGlStyle:n,...o},i){const s=a.useThree((e=>e.gl)),l=S.useMemo((()=>{const e=new D.default({...o});return e.init(s),e}),[s]);return S.useImperativeHandle(i,(()=>l.domElement),[l]),S.useEffect((()=>{if(l){const o=t&&t.current||document.body;null==o||o.appendChild(l.domElement),l.domElement.querySelectorAll("canvas").forEach((e=>{e.style.removeProperty("position")})),r&&(l.domElement.id=r),n&&l.domElement.removeAttribute("style"),l.domElement.removeAttribute("style");const i=(null!=e?e:"").split(" ").filter((e=>e));i.length&&l.domElement.classList.add(...i);const s=a.addAfterEffect((()=>l.update()));return()=>{i.length&&l.domElement.classList.remove(...i),null==o||o.removeChild(l.domElement),s()}}}),[t,l,e,r,n]),null}));const dr=e=>m.suspend((()=>v.getGPUTier(e)),["useDetectGPU"]);const mr=e=>e.isMesh;const fr=S.forwardRef((({enabled:e=!0,firstHitOnly:t=!1,children:r,strategy:o=g.SAH,verbose:i=!1,setBoundingBox:s=!0,maxDepth:l=40,maxLeafTris:c=10,indirect:u=!1,...d},m)=>{const f=S.useRef(null),p=a.useThree((e=>e.raycaster));return S.useImperativeHandle(m,(()=>f.current),[]),S.useEffect((()=>{if(e){const e={strategy:o,verbose:i,setBoundingBox:s,maxDepth:l,maxLeafTris:c,indirect:u},r=f.current;return p.firstHitOnly=t,r.traverse((t=>{mr(t)&&!t.geometry.boundsTree&&t.raycast===n.Mesh.prototype.raycast&&(t.raycast=g.acceleratedRaycast,t.geometry.computeBoundsTree=g.computeBoundsTree,t.geometry.disposeBoundsTree=g.disposeBoundsTree,t.geometry.computeBoundsTree(e))})),()=>{delete p.firstHitOnly,r.traverse((e=>{mr(e)&&e.geometry.boundsTree&&(e.geometry.disposeBoundsTree(),e.raycast=n.Mesh.prototype.raycast)}))}}}),[]),S.createElement("group",M.default({ref:f},d),r)}));function pr(e){const t=S.useRef(null),r=S.useRef(!1),n=S.useRef(!1),o=S.useRef(e);return S.useLayoutEffect((()=>{o.current=e}),[e]),S.useEffect((()=>{const e=t.current;if(e){const t=a.addEffect((()=>(r.current=!1,!0))),i=e.onBeforeRender;e.onBeforeRender=()=>r.current=!0;const s=a.addAfterEffect((()=>(r.current!==n.current&&(null==o.current||o.current(n.current=r.current)),!0)));return()=>{e.onBeforeRender=i,t(),s()}}}),[]),t}const hr=new T.Box3,xr=new T.Vector3;const yr=e=>Math.sqrt(1-Math.pow(e-1,2));class vr{constructor({size:e=256,maxAge:t=750,radius:r=.3,intensity:n=.2,interpolate:a=0,smoothing:o=0,minForce:i=.3,blend:s="screen",ease:l=yr}={}){this.size=e,this.maxAge=t,this.radius=r,this.intensity=n,this.ease=l,this.interpolate=a,this.smoothing=o,this.minForce=i,this.blend=s,this.trail=[],this.force=0,this.initTexture()}initTexture(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=this.size;const e=this.canvas.getContext("2d");if(null===e)throw new Error("2D not available");this.ctx=e,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.texture=new n.Texture(this.canvas),this.canvas.id="touchTexture",this.canvas.style.width=this.canvas.style.height=`${this.canvas.width}px`}update(e){this.clear(),this.trail.forEach(((t,r)=>{t.age+=1e3*e,t.age>this.maxAge&&this.trail.splice(r,1)})),this.trail.length||(this.force=0),this.trail.forEach((e=>{this.drawTouch(e)})),this.texture.needsUpdate=!0}clear(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}addTouch(e){const t=this.trail[this.trail.length-1];if(t){const r=t.x-e.x,n=t.y-e.y,a=r*r+n*n,o=Math.max(this.minForce,Math.min(1e4*a,1));if(this.force=function(e,t,r=.9){return t*r+e*(1-r)}(o,this.force,this.smoothing),this.interpolate){const e=Math.ceil(a/Math.pow(.5*this.radius/this.interpolate,2));if(e>1)for(let a=1;a<e;a++)this.trail.push({x:t.x-r/e*a,y:t.y-n/e*a,age:0,force:o})}}this.trail.push({x:e.x,y:e.y,age:0,force:this.force})}drawTouch(e){const t={x:e.x*this.size,y:(1-e.y)*this.size};let r=1;r=e.age<.3*this.maxAge?this.ease(e.age/(.3*this.maxAge)):this.ease(1-(e.age-.3*this.maxAge)/(.7*this.maxAge)),r*=e.force,this.ctx.globalCompositeOperation=this.blend;const n=this.size*this.radius*r,a=this.ctx.createRadialGradient(t.x,t.y,Math.max(0,.25*n),t.x,t.y,Math.max(0,n));a.addColorStop(0,`rgba(255, 255, 255, ${this.intensity})`),a.addColorStop(1,"rgba(0, 0, 0, 0.0)"),this.ctx.beginPath(),this.ctx.fillStyle=a,this.ctx.arc(t.x,t.y,Math.max(0,n),0,2*Math.PI),this.ctx.fill()}}function gr(e={}){const{size:r,maxAge:n,radius:o,intensity:i,interpolate:s,smoothing:l,minForce:c,blend:u,ease:d}=e,m=t.useMemo((()=>new vr(e)),[r,n,o,i,s,l,c,u,d]);a.useFrame(((e,t)=>{m.update(t)}));const f=t.useCallback((e=>m.addTouch(e.uv)),[m]);return[m.texture,f]}const wr=S.forwardRef((function({children:e,object:t,disable:r,disableX:a,disableY:o,disableZ:i,left:s,right:l,top:c,bottom:u,front:d,back:m,onCentered:f,precise:p=!0,cacheKey:h=0,...x},y){const v=S.useRef(null),g=S.useRef(null),w=S.useRef(null),[z]=S.useState((()=>new n.Box3)),[b]=S.useState((()=>new n.Vector3)),[E]=S.useState((()=>new n.Sphere));return S.useLayoutEffect((()=>{g.current.matrixWorld.identity(),z.setFromObject(null!=t?t:w.current,p);const e=z.max.x-z.min.x,n=z.max.y-z.min.y,h=z.max.z-z.min.z;z.getCenter(b),z.getBoundingSphere(E);const x=c?n/2:u?-n/2:0,y=s?-e/2:l?e/2:0,M=d?h/2:m?-h/2:0;g.current.position.set(r||a?0:-b.x+y,r||o?0:-b.y+x,r||i?0:-b.z+M),null==f||f({parent:v.current.parent,container:v.current,width:e,height:n,depth:h,boundingBox:z,boundingSphere:E,center:b,verticalAlignment:x,horizontalAlignment:y,depthAlignment:M})}),[h,f,c,s,d,r,a,o,i,t,p,l,u,m,z,b,E]),S.useImperativeHandle(y,(()=>v.current),[]),S.createElement("group",M.default({ref:v},x),S.createElement("group",{ref:g},S.createElement("group",{ref:w},e)))})),zr=S.forwardRef((({font:e,color:t="#cbcbcb",bevelSize:r=.04,debug:n=!1,children:a,...o},i)=>{const[s,l]=S.useState(0),c=S.useCallback(((e=1)=>l(s+e)),[s]),u=S.useCallback(((e=1)=>l(s-e)),[s]),d=S.useMemo((()=>({incr:c,decr:u})),[c,u]);return S.useImperativeHandle(i,(()=>d),[d]),S.createElement("group",o,S.createElement(S.Suspense,{fallback:null},S.createElement(wr,{top:!0,cacheKey:JSON.stringify({counter:s,font:e})},S.createElement(we,{bevelEnabled:!0,bevelSize:r,font:e},n?S.createElement("meshNormalMaterial",{wireframe:!0}):S.createElement("meshStandardMaterial",{color:t}),s))),a)})),br=(e,t)=>{e.updateRanges[0]=t};const Er=new T.Matrix4,Mr=new T.Matrix4,Sr=[],Cr=new T.Mesh;class Tr extends T.Group{constructor(){super(),this.color=new T.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){const r=this.instance.current;if(!r)return;if(!r.geometry||!r.material)return;Cr.geometry=r.geometry;const n=r.matrixWorld,a=r.userData.instances.indexOf(this.instanceKey);if(!(-1===a||a>r.count)){r.getMatrixAt(a,Er),Mr.multiplyMatrices(n,Er),Cr.matrixWorld=Mr,r.material instanceof T.Material?Cr.material.side=r.material.side:Cr.material.side=r.material[0].side,Cr.raycast(e,Sr);for(let e=0,r=Sr.length;e<r;e++){const r=Sr[e];r.instanceId=a,r.object=this,t.push(r)}Sr.length=0}}}const Pr=S.createContext(null),Rr=new T.Matrix4,Dr=new T.Matrix4,Fr=new T.Matrix4,kr=new T.Vector3,_r=new T.Quaternion,Ar=new T.Vector3,Lr=S.forwardRef((({context:e,children:t,...r},n)=>{S.useMemo((()=>a.extend({PositionMesh:Tr})),[]);const o=S.useRef(null);S.useImperativeHandle(n,(()=>o.current),[]);const{subscribe:i,getParent:s}=S.useContext(e||Pr);return S.useLayoutEffect((()=>i(o)),[]),S.createElement("positionMesh",M.default({instance:s(),instanceKey:o,ref:o},r),t)})),Ir=S.forwardRef((({context:e,children:t,range:r,limit:n=1e3,frames:o=1/0,...i},s)=>{const[{localContext:l,instance:c}]=S.useState((()=>{const e=S.createContext(null);return{localContext:e,instance:S.forwardRef(((t,r)=>S.createElement(Lr,M.default({context:e},t,{ref:r}))))}})),u=S.useRef(null);S.useImperativeHandle(s,(()=>u.current),[]);const[d,m]=S.useState([]),[[f,p]]=S.useState((()=>{const e=new Float32Array(16*n);for(let t=0;t<n;t++)Fr.identity().toArray(e,16*t);return[e,new Float32Array([...new Array(3*n)].map((()=>1)))]}));S.useEffect((()=>{u.current.instanceMatrix.needsUpdate=!0}));let h=0,x=0;const y=S.useRef([]);S.useLayoutEffect((()=>{y.current=Object.entries(u.current.geometry.attributes).filter((([e,t])=>t.isInstancedBufferAttribute))})),a.useFrame((()=>{if(o===1/0||h<o){u.current.updateMatrix(),u.current.updateMatrixWorld(),Rr.copy(u.current.matrixWorld).invert(),x=Math.min(n,void 0!==r?r:n,d.length),u.current.count=x,br(u.current.instanceMatrix,{start:0,count:16*x}),br(u.current.instanceColor,{start:0,count:3*x});for(let e=0;e<d.length;e++){const t=d[e].current;t.matrixWorld.decompose(kr,_r,Ar),Dr.compose(kr,_r,Ar).premultiply(Rr),Dr.toArray(f,16*e),u.current.instanceMatrix.needsUpdate=!0,t.color.toArray(p,3*e),u.current.instanceColor.needsUpdate=!0}h++}}));const v=S.useMemo((()=>({getParent:()=>u,subscribe:e=>(m((t=>[...t,e])),()=>m((t=>t.filter((t=>t.current!==e.current)))))})),[]);return S.createElement("instancedMesh",M.default({userData:{instances:d,limit:n,frames:o},matrixAutoUpdate:!1,ref:u,args:[null,null,0],raycast:()=>null},i),S.createElement("instancedBufferAttribute",{attach:"instanceMatrix",args:[f,16],usage:T.DynamicDrawUsage}),S.createElement("instancedBufferAttribute",{attach:"instanceColor",args:[p,3],usage:T.DynamicDrawUsage}),"function"==typeof t?S.createElement(l.Provider,{value:v},t(c)):e?S.createElement(e.Provider,{value:v},t):S.createElement(Pr.Provider,{value:v},t))})),Br=S.forwardRef((function({meshes:e,children:t,...r},n){const a=Array.isArray(e);if(!a)for(const t of Object.keys(e))e[t].isMesh||delete e[t];const o=(a?e:Object.values(e)).map((({geometry:e,material:t})=>S.createElement(Ir,M.default({key:e.uuid,geometry:e,material:t},r))));return S.createElement("group",{ref:n},Ur((r=>a?t(...r):t(Object.keys(e).filter((t=>e[t].isMesh)).reduce(((e,t,n)=>({...e,[t]:r[n]})),{}))),o))}));function Ur(e,t,r=[]){if(!t[0])return e(r);function n(n){return Ur(e,t.slice(1),r.concat([n]))}return"function"==typeof t[0]?t[0]({results:r,render:n}):S.cloneElement(t[0],{children:n})}const Vr=S.forwardRef((({name:e,defaultValue:t,normalized:r,usage:n=T.DynamicDrawUsage},o)=>{const i=S.useRef(null);S.useImperativeHandle(o,(()=>i.current),[]),S.useLayoutEffect((()=>{const r=i.current.__r3f.parent.object;r.geometry.attributes[e]=i.current;const n=Array.isArray(t)?t:[t],a=Array.from({length:r.userData.limit},(()=>n)).flat();return i.current.array=new Float32Array(a),i.current.itemSize=n.length,i.current.count=a.length/i.current.itemSize,()=>{delete r.geometry.attributes[e]}}),[e]);let s=0;return a.useFrame((()=>{const t=i.current.__r3f.parent.object;if(t.userData.frames===1/0||s<t.userData.frames){for(let r=0;r<t.userData.instances.length;r++){const n=t.userData.instances[r].current[e];void 0!==n&&(i.current.set(Array.isArray(n)?n:"function"==typeof n.toArray?n.toArray():[n],r*i.current.itemSize),i.current.needsUpdate=!0)}s++}})),S.createElement("instancedBufferAttribute",{ref:i,usage:n,normalized:r})})),Or=S.createContext(null);const Nr=new T.PlaneGeometry(1,1),jr=S.forwardRef((({startFrame:e=0,endFrame:t,fps:r=30,frameName:n="",textureDataURL:o,textureImageURL:i,loop:s=!1,numberOfFrames:l=1,autoPlay:c=!0,animationNames:u,onStart:d,onEnd:m,onLoopEnd:f,onFrame:p,play:h,pause:x=!1,flipX:y=!1,alphaTest:v=0,children:g,asSprite:w=!1,offset:z,playBackwards:b=!1,resetOnEnd:E=!1,maxItems:C=1,instanceItems:P=[[0,0,0]],spriteDataset:R,canvasRenderingContext2DSettings:D,roundFramePosition:F=!1,meshProps:k={},..._},A)=>{const L=S.useRef(new T.Group),I=S.useRef(null),B=S.useRef(null),U=S.useRef(null),V=S.useRef(window.performance.now()),O=S.useRef(e),N=S.useRef(n),j=r>0?1e3/r:0,[W,G]=S.useState(new T.Texture),H=S.useRef(0),[$,q]=S.useState(new T.Vector3(1,1,1)),X=y?-1:1,Z=S.useRef(x),Y=S.useRef(z),Q=S.useRef(!1),{spriteObj:K,loadJsonAndTexture:J}=sr(null,null,u,l,void 0,D),te=S.useRef(n),re=S.useCallback(((e,t)=>{if(null===t)l&&(H.current=l,b&&(O.current=l-1),I.current=t);else{var r,n;I.current=t,I.current&&Array.isArray(I.current.frames)?H.current=I.current.frames.length:I.current&&"object"==typeof I.current&&te.current?H.current=I.current.frames[te.current].length:H.current=0,b&&(O.current=H.current-1);const{w:a,h:o}=or(null!==(r=null==(n=I.current)?void 0:n.frames)&&void 0!==r?r:[],te.current).sourceSize,i=oe(a,o);q(i),B.current&&(B.current.map=e)}G(e)}),[l,b]),ne=S.useCallback((()=>{if(!I.current)return;const{meta:{size:e},frames:t}=I.current,{w:r,h:a}=Array.isArray(t)?t[0].sourceSize:n&&t[n]?t[n][0].sourceSize:{w:0,h:0};B.current&&B.current.map&&(B.current.map.wrapS=B.current.map.wrapT=T.RepeatWrapping,B.current.map.center.set(0,0),B.current.map.repeat.set(1*X/(e.w/r),1/(e.h/a)));const o=1/((e.h-1)/a);B.current&&B.current.map&&(B.current.map.offset.x=0,B.current.map.offset.y=1-o),d&&d({currentFrameName:null!=n?n:"",currentFrame:O.current})}),[X,n,d]),ae=S.useMemo((()=>({current:Y.current,offset:Y.current,imageUrl:i,hasEnded:!1,ref:A})),[i,A]);S.useImperativeHandle(A,(()=>L.current),[]),S.useLayoutEffect((()=>{Y.current=z}),[z]);const oe=(e,t)=>{var r;const n=new T.Vector3,a=t/e;return n.set(1,a,1),null==(r=U.current)||r.scale.copy(n),n};S.useEffect((()=>{var e;R?re(null==R||null==(e=R.spriteTexture)?void 0:e.clone(),R.spriteData):i&&o&&J(i,o)}),[J,R,o,i,re]),S.useEffect((()=>{var e;K&&re(null==K||null==(e=K.spriteTexture)?void 0:e.clone(),null==K?void 0:K.spriteData)}),[K,re]),S.useEffect((()=>{var e;(ae.hasEnded=!1,I.current&&!0===b)?O.current=(null!==(e=I.current.frames.length)&&void 0!==e?e:0)-1:O.current=0}),[b,ae]),S.useLayoutEffect((()=>{ne()}),[W,y,ne]),S.useEffect((()=>{c&&(Z.current=!1)}),[c]),S.useLayoutEffect((()=>{if(N.current!==n&&n&&(O.current=0,N.current=n,ae.hasEnded=!1,j<=0&&(O.current=t||e||0),I.current)){const{w:e,h:t}=or(I.current.frames,n).sourceSize,r=oe(e,t);q(r)}}),[n,j,ae,t,e]);const ie=(e,t,r,n)=>{var a=void 0===z?ae.current:z;const o=O.current;let i=0,s=0;oe(e,t);const l=F?Math.round((r.w-1)/e):(r.w-1)/e,c=F?Math.round((r.h-1)/t):(r.h-1)/t;if(!n[o])return;const{frame:{x:u,y:d},sourceSize:{w:m,h:f}}=n[o],p=1/l,h=1/c;if(B.current&&B.current.map&&(i=X>0?p*(u/m):p*(u/m)-B.current.map.repeat.x,s=Math.abs(1-h)-h*(d/f),B.current.map.offset.x=i,B.current.map.offset.y=s),null!=a){let e=Math.floor(a*n.length);e=Math.max(0,Math.min(e,n.length-1)),isNaN(e)&&(e=0),O.current=e}else b?O.current-=1:O.current+=1};return a.useFrame(((r,a)=>{var o,i;null!=(o=I.current)&&o.frames&&null!=(i=B.current)&&i.map&&(Z.current||ae.hasEnded||!c&&!h||((()=>{if(null===(r=I.current)||!("meta"in r)||!("frames"in r))return;var r;const{meta:{size:a},frames:o}=I.current,{w:i,h:l}=or(o,n).sourceSize,c=Array.isArray(o)?o:n?o[n]:[],u=t||c.length-1;var p=void 0===z?ae.current:z;if(j<=0)return O.current=t||e||0,void ie(i,l,a,c);const h=window.performance.now(),x=h-V.current;if(!(x<=j)){var y=b?O.current<0:O.current>u,v=b?O.current===u:0===O.current,g=b?O.current<0:O.current>=u;if(y){if(O.current=s&&null!=e?e:0,b&&(O.current=u),s?null==f||f({currentFrameName:null!=n?n:"",currentFrame:O.current}):(null==m||m({currentFrameName:null!=n?n:"",currentFrame:O.current}),ae.hasEnded=!E,E&&(Z.current=!0)),!s)return}else v&&(null==d||d({currentFrameName:null!=n?n:"",currentFrame:O.current}));void 0!==p&&g?!1===Q.current&&(null==m||m({currentFrameName:null!=n?n:"",currentFrame:O.current}),Q.current=!0):Q.current=!1,x<=j||(V.current=h-x%j,ie(i,l,a,c))}})(),null==p||p({currentFrameName:N.current,currentFrame:O.current})))})),S.createElement("group",M.default({},_,{ref:L,scale:function(e=new T.Vector3(1,1,1),t=1){return"number"==typeof t?e.multiplyScalar(t):Array.isArray(t)?e.multiply(new T.Vector3(...t)):t instanceof T.Vector3?e.multiply(t):void 0}($,_.scale)}),S.createElement(Or.Provider,{value:ae},w&&S.createElement(ee,null,S.createElement("mesh",M.default({ref:U,scale:1,geometry:Nr},k),S.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:T.DoubleSide,ref:B,map:W,transparent:!0,alphaTest:null!=v?v:0}))),!w&&S.createElement(Ir,M.default({geometry:Nr,limit:null!=C?C:1},k),S.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:T.DoubleSide,ref:B,map:W,transparent:!0,alphaTest:null!=v?v:0}),(null!=P?P:[0]).map(((e,t)=>S.createElement(Lr,M.default({key:t,ref:1===(null==P?void 0:P.length)?U:null,position:e,scale:1},k))))),g))})),Wr=S.forwardRef((({children:e,curve:t},r)=>{const[n]=S.useState((()=>new T.Scene)),[o,i]=S.useState(),s=S.useRef(null);return S.useLayoutEffect((()=>{s.current=new c.Flow(n.children[0]),i(s.current.object3D)}),[e]),S.useEffect((()=>{var e;t&&(null==(e=s.current)||e.updateCurve(0,t))}),[t]),S.useImperativeHandle(r,(()=>s.current)),S.createElement(S.Fragment,null,a.createPortal(e,n),o&&S.createElement("primitive",{object:o}))}));class Gr extends n.MeshPhysicalMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader=`\n      uniform float time;\n      uniform float radius;\n      uniform float distort;\n      #define GLSLIFY 1\nvec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}\n      ${e.vertexShader}\n    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        float updateTime = time / 50.0;\n        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));\n        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));\n        ")}get time(){return this._time.value}set time(e){this._time.value=e}get distort(){return this._distort.value}set distort(e){this._distort.value=e}get radius(){return this._radius.value}set radius(e){this._radius.value=e}}const Hr=S.forwardRef((({speed:e=1,...t},r)=>{const[n]=S.useState((()=>new Gr));return a.useFrame((t=>n&&(n.time=t.clock.elapsedTime*e))),S.createElement("primitive",M.default({object:n,ref:r,attach:"material"},t))}));class $r extends n.MeshStandardMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader=`\n      uniform float time;\n      uniform float factor;\n      ${e.vertexShader}\n    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n        float c = cos( theta );\n        float s = sin( theta );\n        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n        vec3 transformed = vec3( position ) * m;\n        vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const qr=S.forwardRef((({speed:e=1,...t},r)=>{const[n]=S.useState((()=>new $r));return a.useFrame((t=>n&&(n.time=t.clock.elapsedTime*e))),S.createElement("primitive",M.default({object:n,ref:r,attach:"material"},t))}));class Xr extends T.ShaderMaterial{constructor(e=new T.Vector2){super({uniforms:{inputBuffer:new T.Uniform(null),depthBuffer:new T.Uniform(null),resolution:new T.Uniform(new T.Vector2),texelSize:new T.Uniform(new T.Vector2),halfTexelSize:new T.Uniform(new T.Vector2),kernel:new T.Uniform(0),scale:new T.Uniform(1),cameraNear:new T.Uniform(0),cameraFar:new T.Uniform(1),minDepthThreshold:new T.Uniform(0),maxDepthThreshold:new T.Uniform(1),depthScale:new T.Uniform(0),depthToBlurRatioBias:new T.Uniform(.25)},fragmentShader:`#include <common>\n        #include <dithering_pars_fragment>      \n        uniform sampler2D inputBuffer;\n        uniform sampler2D depthBuffer;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          float depthFactor = 0.0;\n          \n          #ifdef USE_DEPTH\n            vec4 depth = texture2D(depthBuffer, vUv);\n            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n            depthFactor *= depthScale;\n            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));\n          #endif\n          \n          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));\n          gl_FragColor = sum * 0.25 ;\n\n          #include <dithering_fragment>\n          #include <tonemapping_fragment>\n          #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n        }`,vertexShader:"uniform vec2 texelSize;\n        uniform vec2 halfTexelSize;\n        uniform float kernel;\n        uniform float scale;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          vec2 uv = position.xy * 0.5 + 0.5;\n          vUv = uv;\n\n          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;\n          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\n          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\n          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\n          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\n\n          gl_Position = vec4(position.xy, 1.0, 1.0);\n        }",blending:T.NoBlending,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class Zr{constructor({gl:e,resolution:t,width:r=500,height:a=500,minDepthThreshold:o=0,maxDepthThreshold:i=1,depthScale:s=0,depthToBlurRatioBias:l=.25}){this.renderToScreen=!1,this.renderTargetA=new n.WebGLRenderTarget(t,t,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,stencilBuffer:!1,depthBuffer:!1,type:n.HalfFloatType}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new Xr,this.convolutionMaterial.setTexelSize(1/r,1/a),this.convolutionMaterial.setResolution(new n.Vector2(r,a)),this.scene=new n.Scene,this.camera=new n.Camera,this.convolutionMaterial.uniforms.minDepthThreshold.value=o,this.convolutionMaterial.uniforms.maxDepthThreshold.value=i,this.convolutionMaterial.uniforms.depthScale.value=s,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=l,this.convolutionMaterial.defines.USE_DEPTH=s>0;const c=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),u=new Float32Array([0,0,2,0,0,2]),d=new n.BufferGeometry;d.setAttribute("position",new n.BufferAttribute(c,3)),d.setAttribute("uv",new n.BufferAttribute(u,2)),this.screen=new n.Mesh(d,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,r){const n=this.scene,a=this.camera,o=this.renderTargetA,i=this.renderTargetB;let s=this.convolutionMaterial,l=s.uniforms;l.depthBuffer.value=t.depthTexture;const c=s.kernel;let u,d,m,f=t;for(d=0,m=c.length-1;d<m;++d)u=1&d?i:o,l.kernel.value=c[d],l.inputBuffer.value=f.texture,e.setRenderTarget(u),e.render(n,a),f=u;l.kernel.value=c[d],l.inputBuffer.value=f.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(n,a)}}class Yr extends n.MeshStandardMaterial{constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}onBeforeCompile(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`\n        uniform mat4 textureMatrix;\n        varying vec4 my_vUv;\n      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n        my_vUv = textureMatrix * vec4( position, 1.0 );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"),e.fragmentShader=`\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDiffuseBlur;\n        uniform sampler2D tDepth;\n        uniform sampler2D distortionMap;\n        uniform float distortion;\n        uniform float cameraNear;\n\t\t\t  uniform float cameraFar;\n        uniform bool hasBlur;\n        uniform float mixBlur;\n        uniform float mirror;\n        uniform float mixStrength;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float mixContrast;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec4 my_vUv;\n        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>","#include <emissivemap_fragment>\n\n      float distortionFactor = 0.0;\n      #ifdef USE_DISTORTION\n        distortionFactor = texture2D(distortionMap, vUv).r * distortion;\n      #endif\n\n      vec4 new_vUv = my_vUv;\n      new_vUv.x += distortionFactor;\n      new_vUv.y += distortionFactor;\n\n      vec4 base = texture2DProj(tDiffuse, new_vUv);\n      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);\n\n      vec4 merge = base;\n\n      #ifdef USE_NORMALMAP\n        vec2 normal_uv = vec2(0.0);\n        vec4 normalColor = texture2D(normalMap, vUv * normalScale);\n        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\n        vec3 coord = new_vUv.xyz / new_vUv.w;\n        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;\n        vec4 base_normal = texture2D(tDiffuse, normal_uv);\n        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);\n        merge = base_normal;\n        blur = blur_normal;\n      #endif\n\n      float depthFactor = 0.0001;\n      float blurFactor = 0.0;\n\n      #ifdef USE_DEPTH\n        vec4 depth = texture2DProj(tDepth, new_vUv);\n        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n        depthFactor *= depthScale;\n        depthFactor = max(0.0001, min(1.0, depthFactor));\n\n        #ifdef USE_BLUR\n          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);\n          merge = merge * min(1.0, depthFactor + 0.5);\n        #else\n          merge = merge * depthFactor;\n        #endif\n\n      #endif\n\n      float reflectorRoughnessFactor = roughness;\n      #ifdef USE_ROUGHNESSMAP\n        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );\n        reflectorRoughnessFactor *= reflectorTexelRoughness.g;\n      #endif\n\n      #ifdef USE_BLUR\n        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);\n        merge = mix(merge, blur, blurFactor);\n      #endif\n\n      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);\n      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;\n      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;\n      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;\n\n      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);\n      ")}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}}const Qr=S.forwardRef((({mixBlur:e=0,mixStrength:t=1,resolution:r=256,blur:o=[0,0],minDepthThreshold:i=.9,maxDepthThreshold:s=1,depthScale:l=0,depthToBlurRatioBias:c=.25,mirror:u=0,distortion:d=1,mixContrast:m=1,distortionMap:f,reflectorOffset:p=0,...h},x)=>{a.extend({MeshReflectorMaterialImpl:Yr});const y=a.useThree((({gl:e})=>e)),v=a.useThree((({camera:e})=>e)),g=a.useThree((({scene:e})=>e)),w=(o=Array.isArray(o)?o:[o,o])[0]+o[1]>0,z=o[0],b=o[1],E=S.useRef(null);S.useImperativeHandle(x,(()=>E.current),[]);const[C]=S.useState((()=>new n.Plane)),[T]=S.useState((()=>new n.Vector3)),[P]=S.useState((()=>new n.Vector3)),[R]=S.useState((()=>new n.Vector3)),[D]=S.useState((()=>new n.Matrix4)),[F]=S.useState((()=>new n.Vector3(0,0,-1))),[k]=S.useState((()=>new n.Vector4)),[_]=S.useState((()=>new n.Vector3)),[A]=S.useState((()=>new n.Vector3)),[L]=S.useState((()=>new n.Vector4)),[I]=S.useState((()=>new n.Matrix4)),[B]=S.useState((()=>new n.PerspectiveCamera)),U=S.useCallback((()=>{var e;const t=E.current.parent||(null==(e=E.current)||null==(e=e.__r3f.parent)?void 0:e.object);if(!t)return;if(P.setFromMatrixPosition(t.matrixWorld),R.setFromMatrixPosition(v.matrixWorld),D.extractRotation(t.matrixWorld),T.set(0,0,1),T.applyMatrix4(D),P.addScaledVector(T,p),_.subVectors(P,R),_.dot(T)>0)return;_.reflect(T).negate(),_.add(P),D.extractRotation(v.matrixWorld),F.set(0,0,-1),F.applyMatrix4(D),F.add(R),A.subVectors(P,F),A.reflect(T).negate(),A.add(P),B.position.copy(_),B.up.set(0,1,0),B.up.applyMatrix4(D),B.up.reflect(T),B.lookAt(A),B.far=v.far,B.updateMatrixWorld(),B.projectionMatrix.copy(v.projectionMatrix),I.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),I.multiply(B.projectionMatrix),I.multiply(B.matrixWorldInverse),I.multiply(t.matrixWorld),C.setFromNormalAndCoplanarPoint(T,P),C.applyMatrix4(B.matrixWorldInverse),k.set(C.normal.x,C.normal.y,C.normal.z,C.constant);const r=B.projectionMatrix;L.x=(Math.sign(k.x)+r.elements[8])/r.elements[0],L.y=(Math.sign(k.y)+r.elements[9])/r.elements[5],L.z=-1,L.w=(1+r.elements[10])/r.elements[14],k.multiplyScalar(2/k.dot(L)),r.elements[2]=k.x,r.elements[6]=k.y,r.elements[10]=k.z+1,r.elements[14]=k.w}),[v,p]),[V,O,N,j]=S.useMemo((()=>{const a={minFilter:n.LinearFilter,magFilter:n.LinearFilter,type:n.HalfFloatType},o=new n.WebGLRenderTarget(r,r,a);o.depthBuffer=!0,o.depthTexture=new n.DepthTexture(r,r),o.depthTexture.format=n.DepthFormat,o.depthTexture.type=n.UnsignedShortType;const p=new n.WebGLRenderTarget(r,r,a);return[o,p,new Zr({gl:y,resolution:r,width:z,height:b,minDepthThreshold:i,maxDepthThreshold:s,depthScale:l,depthToBlurRatioBias:c}),{mirror:u,textureMatrix:I,mixBlur:e,tDiffuse:o.texture,tDepth:o.depthTexture,tDiffuseBlur:p.texture,hasBlur:w,mixStrength:t,minDepthThreshold:i,maxDepthThreshold:s,depthScale:l,depthToBlurRatioBias:c,distortion:d,distortionMap:f,mixContrast:m,"defines-USE_BLUR":w?"":void 0,"defines-USE_DEPTH":l>0?"":void 0,"defines-USE_DISTORTION":f?"":void 0}]}),[y,z,b,I,r,u,w,e,t,i,s,l,c,d,f,m]);return a.useFrame((()=>{var e;const t=E.current.parent||(null==(e=E.current)||null==(e=e.__r3f.parent)?void 0:e.object);if(!t)return;t.visible=!1;const r=y.xr.enabled,n=y.shadowMap.autoUpdate;U(),y.xr.enabled=!1,y.shadowMap.autoUpdate=!1,y.setRenderTarget(V),y.state.buffers.depth.setMask(!0),y.autoClear||y.clear(),y.render(g,B),w&&N.render(y,V,O),y.xr.enabled=r,y.shadowMap.autoUpdate=n,t.visible=!0,y.setRenderTarget(null)})),S.createElement("meshReflectorMaterialImpl",M.default({attach:"material",key:"key"+j["defines-USE_BLUR"]+j["defines-USE_DEPTH"]+j["defines-USE_DISTORTION"],ref:E},j,h))})),Kr=Ee({envMap:null,bounces:3,ior:2.4,correctMips:!0,aberrationStrength:.01,fresnel:0,bvh:new g.MeshBVHUniformStruct,color:new T.Color("white"),opacity:1,resolution:new T.Vector2,viewMatrixInverse:new T.Matrix4,projectionMatrixInverse:new T.Matrix4},"\n  uniform mat4 viewMatrixInverse;\n\n  varying vec3 vWorldPosition;\n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #include <color_pars_vertex>\n\n  void main() {\n    #include <color_vertex>\n\n    vec4 transformedNormal = vec4(normal, 0.0);\n    vec4 transformedPosition = vec4(position, 1.0);\n    #ifdef USE_INSTANCING\n      transformedNormal = instanceMatrix * transformedNormal;\n      transformedPosition = instanceMatrix * transformedPosition;\n    #endif\n\n    #ifdef USE_INSTANCING\n      vModelMatrixInverse = inverse(modelMatrix * instanceMatrix);\n    #else\n      vModelMatrixInverse = inverse(modelMatrix);\n    #endif\n\n    vWorldPosition = (modelMatrix * transformedPosition).xyz;\n    vNormal = normalize((viewMatrixInverse * vec4(normalMatrix * transformedNormal.xyz, 0.0)).xyz);\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * transformedPosition;\n  }",`\n  #define ENVMAP_TYPE_CUBE_UV\n  precision highp isampler2D;\n  precision highp usampler2D;\n  varying vec3 vWorldPosition;\n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #include <color_pars_fragment>\n\n  #ifdef ENVMAP_TYPE_CUBEM\n    uniform samplerCube envMap;\n  #else\n    uniform sampler2D envMap;\n  #endif\n\n  uniform float bounces;\n  ${g.shaderStructs}\n  ${g.shaderIntersectFunction}\n  uniform BVH bvh;\n  uniform float ior;\n  uniform bool correctMips;\n  uniform vec2 resolution;\n  uniform float fresnel;\n  uniform mat4 modelMatrix;\n  uniform mat4 projectionMatrixInverse;\n  uniform mat4 viewMatrixInverse;\n  uniform float aberrationStrength;\n  uniform vec3 color;\n  uniform float opacity;\n\n  float fresnelFunc(vec3 viewDirection, vec3 worldNormal) {\n    return pow( 1.0 + dot( viewDirection, worldNormal), 10.0 );\n  }\n\n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 normal, float ior, mat4 modelMatrixInverse) {\n    vec3 rayOrigin = ro;\n    vec3 rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = vWorldPosition + rayDirection * 0.001;\n    rayOrigin = (modelMatrixInverse * vec4(rayOrigin, 1.0)).xyz;\n    rayDirection = normalize((modelMatrixInverse * vec4(rayDirection, 0.0)).xyz);\n    for(float i = 0.0; i < bounces; i++) {\n      uvec4 faceIndices = uvec4( 0u );\n      vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );\n      vec3 barycoord = vec3( 0.0 );\n      float side = 1.0;\n      float dist = 0.0;\n      bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );\n      vec3 hitPos = rayOrigin + rayDirection * max(dist - 0.001, 0.0);\n      vec3 tempDir = refract(rayDirection, faceNormal, ior);\n      if (length(tempDir) != 0.0) {\n        rayDirection = tempDir;\n        break;\n      }\n      rayDirection = reflect(rayDirection, faceNormal);\n      rayOrigin = hitPos + rayDirection * 0.01;\n    }\n    rayDirection = normalize((modelMatrix * vec4(rayDirection, 0.0)).xyz);\n    return rayDirection;\n  }\n\n  #include <common>\n  #include <cube_uv_reflection_fragment>\n\n  #ifdef ENVMAP_TYPE_CUBEM\n    vec4 textureGradient(samplerCube envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      return textureGrad(envMap, rayDirection, dFdx(correctMips ? directionCamPerfect: rayDirection), dFdy(correctMips ? directionCamPerfect: rayDirection));\n    }\n  #else\n    vec4 textureGradient(sampler2D envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      vec2 uvv = equirectUv( rayDirection );\n      vec2 smoothUv = equirectUv( directionCamPerfect );\n      return textureGrad(envMap, uvv, dFdx(correctMips ? smoothUv : uvv), dFdy(correctMips ? smoothUv : uvv));\n    }\n  #endif\n\n  void main() {\n    vec2 uv = gl_FragCoord.xy / resolution;\n    vec3 directionCamPerfect = (projectionMatrixInverse * vec4(uv * 2.0 - 1.0, 0.0, 1.0)).xyz;\n    directionCamPerfect = (viewMatrixInverse * vec4(directionCamPerfect, 0.0)).xyz;\n    directionCamPerfect = normalize(directionCamPerfect);\n    vec3 normal = vNormal;\n    vec3 rayOrigin = cameraPosition;\n    vec3 rayDirection = normalize(vWorldPosition - cameraPosition);\n\n    vec4 diffuseColor = vec4(color, opacity);\n    #include <color_fragment>\n\n    #ifdef CHROMATIC_ABERRATIONS\n      vec3 rayDirectionG = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      #ifdef FAST_CHROMA\n        vec3 rayDirectionR = normalize(rayDirectionG + 1.0 * vec3(aberrationStrength / 2.0));\n        vec3 rayDirectionB = normalize(rayDirectionG - 1.0 * vec3(aberrationStrength / 2.0));\n      #else\n        vec3 rayDirectionR = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 - aberrationStrength), 1.0), vModelMatrixInverse);\n        vec3 rayDirectionB = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 + aberrationStrength), 1.0), vModelMatrixInverse);\n      #endif\n      float finalColorR = textureGradient(envMap, rayDirectionR, directionCamPerfect).r;\n      float finalColorG = textureGradient(envMap, rayDirectionG, directionCamPerfect).g;\n      float finalColorB = textureGradient(envMap, rayDirectionB, directionCamPerfect).b;\n      diffuseColor.rgb *= vec3(finalColorR, finalColorG, finalColorB);\n    #else\n      rayDirection = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      diffuseColor.rgb *= textureGradient(envMap, rayDirection, directionCamPerfect).rgb;\n    #endif\n\n    vec3 viewDirection = normalize(vWorldPosition - cameraPosition);\n    float nFresnel = fresnelFunc(viewDirection, normal) * fresnel;\n    gl_FragColor = vec4(mix(diffuseColor.rgb, vec3(1.0), nFresnel), diffuseColor.a);\n\n    #include <tonemapping_fragment>\n    #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n  }`);const Jr=Ee({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class en extends T.MeshPhysicalMaterial{constructor(e=6,t=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new T.Color("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=r=>{r.uniforms={...r.uniforms,...this.uniforms},this.anisotropy>0&&(r.defines.USE_ANISOTROPY=""),t?r.defines.USE_SAMPLER="":r.defines.USE_TRANSMISSION="",r.fragmentShader="\n      uniform float chromaticAberration;         \n      uniform float anisotropicBlur;      \n      uniform float time;\n      uniform float distortion;\n      uniform float distortionScale;\n      uniform float temporalDistortion;\n      uniform sampler2D buffer;\n\n      vec3 random3(vec3 c) {\n        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n        vec3 r;\n        r.z = fract(512.0*j);\n        j *= .125;\n        r.x = fract(512.0*j);\n        j *= .125;\n        r.y = fract(512.0*j);\n        return r-0.5;\n      }\n\n      uint hash( uint x ) {\n        x += ( x << 10u );\n        x ^= ( x >>  6u );\n        x += ( x <<  3u );\n        x ^= ( x >> 11u );\n        x += ( x << 15u );\n        return x;\n      }\n\n      // Compound versions of the hashing algorithm I whipped together.\n      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }\n      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }\n      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }\n\n      // Construct a float with half-open range [0:1] using low 23 bits.\n      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.\n      float floatConstruct( uint m ) {\n        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask\n        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32\n        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)\n        m |= ieeeOne;                          // Add fractional part to 1.0\n        float  f = uintBitsToFloat( m );       // Range [1:2]\n        return f - 1.0;                        // Range [0:1]\n      }\n\n      // Pseudo-random value in half-open range [0:1].\n      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }\n      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float rand(float seed) {\n        float result = randomBase(vec3(gl_FragCoord.xy, seed));\n        return result;\n      }\n\n      const float F3 =  0.3333333;\n      const float G3 =  0.1666667;\n\n      float snoise(vec3 p) {\n        vec3 s = floor(p + dot(p, vec3(F3)));\n        vec3 x = p - s + dot(s, vec3(G3));\n        vec3 e = step(vec3(0.0), x - x.yzx);\n        vec3 i1 = e*(1.0 - e.zxy);\n        vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n        vec3 x1 = x - i1 + G3;\n        vec3 x2 = x - i2 + 2.0*G3;\n        vec3 x3 = x - 1.0 + 3.0*G3;\n        vec4 w, d;\n        w.x = dot(x, x);\n        w.y = dot(x1, x1);\n        w.z = dot(x2, x2);\n        w.w = dot(x3, x3);\n        w = max(0.6 - w, 0.0);\n        d.x = dot(random3(s), x);\n        d.y = dot(random3(s + i1), x1);\n        d.z = dot(random3(s + i2), x2);\n        d.w = dot(random3(s + 1.0), x3);\n        w *= w;\n        w *= w;\n        d *= w;\n        return dot(d, vec4(52.0));\n      }\n\n      float snoiseFractal(vec3 m) {\n        return 0.5333333* snoise(m)\n              +0.2666667* snoise(2.0*m)\n              +0.1333333* snoise(4.0*m)\n              +0.0666667* snoise(8.0*m);\n      }\n"+r.fragmentShader,r.fragmentShader=r.fragmentShader.replace("#include <transmission_pars_fragment>","\n        #ifdef USE_TRANSMISSION\n          // Transmission code is based on glTF-Sampler-Viewer\n          // https://github.com/KhronosGroup/glTF-Sample-Viewer\n          uniform float _transmission;\n          uniform float thickness;\n          uniform float attenuationDistance;\n          uniform vec3 attenuationColor;\n          #ifdef USE_TRANSMISSIONMAP\n            uniform sampler2D transmissionMap;\n          #endif\n          #ifdef USE_THICKNESSMAP\n            uniform sampler2D thicknessMap;\n          #endif\n          uniform vec2 transmissionSamplerSize;\n          uniform sampler2D transmissionSamplerMap;\n          uniform mat4 modelMatrix;\n          uniform mat4 projectionMatrix;\n          varying vec3 vWorldPosition;\n          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n            // Direction of refracted light.\n            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n            // Compute rotation-independant scaling of the model matrix.\n            vec3 modelScale;\n            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n            // The thickness is specified in local space.\n            return normalize( refractionVector ) * thickness * modelScale;\n          }\n          float applyIorToRoughness( const in float roughness, const in float ior ) {\n            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n            // an IOR of 1.5 results in the default amount of microfacet refraction.\n            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n          }\n          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            \n            #ifdef USE_SAMPLER\n              #ifdef texture2DLodEXT\n                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #else\n                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #endif\n            #else\n              return texture2D(buffer, fragCoord.xy);\n            #endif\n          }\n          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n            if ( isinf( attenuationDistance ) ) {\n              // Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.\n              return radiance;\n            } else {\n              // Compute light attenuation using Beer's law.\n              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law\n              return transmittance * radiance;\n            }\n          }\n          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n            const in vec3 attenuationColor, const in float attenuationDistance ) {\n            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n            vec3 refractedRayExit = position + transmissionRay;\n            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n            vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n            refractionCoords += 1.0;\n            refractionCoords /= 2.0;\n            // Sample framebuffer to get pixel the refracted ray hits.\n            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n            // Get the specular component.\n            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n          }\n        #endif\n"),r.fragmentShader=r.fragmentShader.replace("#include <transmission_fragment>",`  \n        // Improve the refraction to use the world pos\n        material.transmission = _transmission;\n        material.transmissionAlpha = 1.0;\n        material.thickness = thickness;\n        material.attenuationDistance = attenuationDistance;\n        material.attenuationColor = attenuationColor;\n        #ifdef USE_TRANSMISSIONMAP\n          material.transmission *= texture2D( transmissionMap, vUv ).r;\n        #endif\n        #ifdef USE_THICKNESSMAP\n          material.thickness *= texture2D( thicknessMap, vUv ).g;\n        #endif\n        \n        vec3 pos = vWorldPosition;\n        float runningSeed = 0.0;\n        vec3 v = normalize( cameraPosition - pos );\n        vec3 n = inverseTransformDirection( normal, viewMatrix );\n        vec3 transmission = vec3(0.0);\n        float transmissionR, transmissionB, transmissionG;\n        float randomCoords = rand(runningSeed++);\n        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);\n        vec3 distortionNormal = vec3(0.0);\n        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;\n        if (distortion > 0.0) {\n          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));\n        }\n        for (float i = 0.0; i < ${e}.0; i ++) {\n          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);\n          transmissionR = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).r;\n          transmissionG = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(${e})) , material.thickness + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).g;\n          transmissionB = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(${e})), material.thickness + thickness_smear * (i + randomCoords) / float(${e}),\n            material.attenuationColor, material.attenuationDistance\n          ).b;\n          transmission.r += transmissionR;\n          transmission.g += transmissionG;\n          transmission.b += transmissionB;\n        }\n        transmission /= ${e}.0;\n        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n`)},Object.keys(this.uniforms).forEach((e=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t})))}}const tn=S.forwardRef((({buffer:e,transmissionSampler:t=!1,backside:r=!1,side:n=T.FrontSide,transmission:o=1,thickness:i=0,backsideThickness:s=0,backsideEnvMapIntensity:l=1,samples:c=10,resolution:u,backsideResolution:d,background:m,anisotropy:f,anisotropicBlur:p,...h},x)=>{a.extend({MeshTransmissionMaterial:en});const y=S.useRef(null),[v]=S.useState((()=>new Jr)),g=rt(d||u),w=rt(u);let z,b,E,C;return a.useFrame((e=>{var a;(y.current.time=e.clock.elapsedTime,y.current.buffer!==w.texture||t)||(C=null==(a=y.current.__r3f.parent)?void 0:a.object,C&&(E=e.gl.toneMapping,z=e.scene.background,b=y.current.envMapIntensity,e.gl.toneMapping=T.NoToneMapping,m&&(e.scene.background=m),C.material=v,r&&(e.gl.setRenderTarget(g),e.gl.render(e.scene,e.camera),C.material=y.current,C.material.buffer=g.texture,C.material.thickness=s,C.material.side=T.BackSide,C.material.envMapIntensity=l),e.gl.setRenderTarget(w),e.gl.render(e.scene,e.camera),C.material=y.current,C.material.thickness=i,C.material.side=n,C.material.buffer=w.texture,C.material.envMapIntensity=b,e.scene.background=z,e.gl.setRenderTarget(null),e.gl.toneMapping=E))})),S.useImperativeHandle(x,(()=>y.current),[]),S.createElement("meshTransmissionMaterial",M.default({args:[c,t],ref:y},h,{buffer:e||w.texture,_transmission:o,anisotropicBlur:null!=p?p:f,transmission:t?o:0,thickness:i,side:n}))})),rn=S.forwardRef(((e,t)=>(a.extend({DiscardMaterialImpl:Jr}),S.createElement("discardMaterialImpl",M.default({ref:t},e)))));const nn=Ce>=154?"opaque_fragment":"output_fragment";class an extends T.PointsMaterial{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{const{isWebGL2:r}=t.capabilities;e.fragmentShader=e.fragmentShader.replace(`#include <${nn}>`,`\n        ${r?`#include <${nn}>`:`#extension GL_OES_standard_derivatives : enable\n#include <${nn}>`}\n      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n      float r = dot(cxy, cxy);\n      float delta = fwidth(r);     \n      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );\n      #include <tonemapping_fragment>\n      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n      `)}}}const on=S.forwardRef(((e,t)=>{const[r]=S.useState((()=>new an(null)));return S.createElement("primitive",M.default({},e,{object:r,ref:t,attach:"material"}))}));function sn(e,t,r){t.traverse((t=>{t.material&&(e.properties.remove(t.material),null==t.material.dispose||t.material.dispose())})),e.info.programs.length=0,e.compile(t,r)}function ln(e,t){const r=e+"Geometry";return S.forwardRef((({args:e,children:n,...a},o)=>{const i=S.useRef(null);return S.useImperativeHandle(o,(()=>i.current)),S.useLayoutEffect((()=>{null==t||t(i.current)})),S.createElement("mesh",M.default({ref:i},a),S.createElement(r,{attach:"geometry",args:e}),n)}))}const cn=ln("box"),un=ln("circle"),dn=ln("cone"),mn=ln("cylinder"),fn=ln("sphere"),pn=ln("plane"),hn=ln("tube"),xn=ln("torus"),yn=ln("torusKnot"),vn=ln("tetrahedron"),gn=ln("ring"),wn=ln("polyhedron"),zn=ln("icosahedron"),bn=ln("octahedron"),En=ln("dodecahedron"),Mn=ln("extrude"),Sn=ln("lathe"),Cn=ln("capsule"),Tn=ln("shape",(({geometry:e})=>{const t=e.attributes.position,r=(new T.Box3).setFromBufferAttribute(t),n=new T.Vector3;r.getSize(n);const a=[];let o=0,i=0,s=0,l=0;for(let e=0;e<t.count;e++)o=t.getX(e),i=t.getY(e),s=(o-r.min.x)/n.x,l=(i-r.min.y)/n.y,a.push(s,l);e.setAttribute("uv",new T.Float32BufferAttribute(a,2))})),Pn=1e-5;const Rn=S.forwardRef((function({args:[e=1,t=1,r=1]=[],radius:n=.05,steps:a=1,smoothness:o=4,bevelSegments:i=4,creaseAngle:s=.4,children:l,...c},u){return S.createElement("mesh",M.default({ref:u},c),S.createElement(Dn,{args:[e,t,r],radius:n,steps:a,smoothness:o,bevelSegments:i,creaseAngle:s}),l)})),Dn=S.forwardRef((function({args:[e=1,t=1,r=1]=[],radius:a=.05,steps:o=1,smoothness:i=4,bevelSegments:s=4,creaseAngle:l=.4,...u},d){const m=S.useMemo((()=>function(e,t,r){const a=new n.Shape,o=r-Pn;return a.absarc(Pn,Pn,Pn,-Math.PI/2,-Math.PI,!0),a.absarc(Pn,t-2*o,Pn,Math.PI,Math.PI/2,!0),a.absarc(e-2*o,t-2*o,Pn,Math.PI/2,0,!0),a.absarc(e-2*o,Pn,Pn,0,-Math.PI/2,!0),a}(e,t,a)),[e,t,a]),f=S.useMemo((()=>({depth:r-2*a,bevelEnabled:!0,bevelSegments:2*s,steps:o,bevelSize:a-Pn,bevelThickness:a,curveSegments:i})),[r,a,i,s,o]),p=S.useRef(null);return S.useLayoutEffect((()=>{p.current&&(p.current.center(),c.toCreasedNormals(p.current,l))}),[m,f,l]),S.useImperativeHandle(d,(()=>p.current)),S.createElement("extrudeGeometry",M.default({ref:p,args:[m,f]},u))}));function Fn(){const e=new T.BufferGeometry,t=new Float32Array([-1,-1,3,-1,-1,3]);return e.boundingSphere=new T.Sphere,e.boundingSphere.set(new T.Vector3,1/0),e.setAttribute("position",new T.BufferAttribute(t,2)),e}const kn=S.forwardRef((function({children:e,...t},r){const n=S.useMemo(Fn,[]);return S.createElement("mesh",M.default({ref:r,geometry:n,frustumCulled:!1},t),e)})),_n=S.forwardRef((({children:e,width:t,height:r,depth:n,box3:a,precise:o=!0,...i},s)=>{const l=S.useRef(null),c=S.useRef(null),u=S.useRef(null);return S.useLayoutEffect((()=>{c.current.matrixWorld.identity();let e=a||(new T.Box3).setFromObject(u.current,o);const i=e.max.x-e.min.x,s=e.max.y-e.min.y,l=e.max.z-e.min.z;let d=Math.max(i,s,l);t&&(d=i),r&&(d=s),n&&(d=l),c.current.scale.setScalar(1/d)}),[t,r,n,a,o]),S.useImperativeHandle(s,(()=>l.current),[]),S.createElement("group",M.default({ref:l},i),S.createElement("group",{ref:c},S.createElement("group",{ref:u},e)))}));var An=function(e){return e[e.NONE=0]="NONE",e[e.START=1]="START",e[e.ACTIVE=2]="ACTIVE",e}(An||{});const Ln=e=>e&&e.isOrthographicCamera,In=e=>1-Math.exp(-5*e)+.007*e,Bn=S.createContext(null);function Un({children:e,maxDuration:t=1,margin:r=1.2,observe:n,fit:o,clip:i,interpolateFunc:s=In,onFit:l}){const c=S.useRef(null),{camera:u,size:d,invalidate:m}=a.useThree(),f=a.useThree((e=>e.controls)),p=S.useRef(l);p.current=l;const h=S.useRef({camPos:new T.Vector3,camRot:new T.Quaternion,camZoom:1}),x=S.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),y=S.useRef(An.NONE),v=S.useRef(0),[g]=S.useState((()=>new T.Box3)),w=S.useMemo((()=>{function e(){const e=g.getSize(new T.Vector3),t=g.getCenter(new T.Vector3),n=Math.max(e.x,e.y,e.z),a=Ln(u)?4*n:n/(2*Math.atan(Math.PI*u.fov/360)),o=Ln(u)?4*n:a/u.aspect,i=r*Math.max(a,o);return{box:g,size:e,center:t,distance:i}}return{getSize:e,refresh(e){if((t=e)&&t.isBox3)g.copy(e);else{const t=e||c.current;if(!t)return this;t.updateWorldMatrix(!0,!0),g.setFromObject(t)}var t;if(g.isEmpty()){const e=u.position.length()||10;g.setFromCenterAndSize(new T.Vector3,new T.Vector3(e,e,e))}return h.current.camPos.copy(u.position),h.current.camRot.copy(u.quaternion),Ln(u)&&(h.current.camZoom=u.zoom),x.current.camPos=void 0,x.current.camRot=void 0,x.current.camZoom=void 0,x.current.camUp=void 0,x.current.target=void 0,this},reset(){const{center:t,distance:r}=e(),n=u.position.clone().sub(t).normalize();x.current.camPos=t.clone().addScaledVector(n,r),x.current.target=t.clone();const a=(new T.Matrix4).lookAt(x.current.camPos,x.current.target,u.up);return x.current.camRot=(new T.Quaternion).setFromRotationMatrix(a),y.current=An.START,v.current=0,this},moveTo(e){return x.current.camPos=Array.isArray(e)?new T.Vector3(...e):e.clone(),y.current=An.START,v.current=0,this},lookAt({target:e,up:t}){x.current.target=Array.isArray(e)?new T.Vector3(...e):e.clone(),x.current.camUp=t?Array.isArray(t)?new T.Vector3(...t):t.clone():u.up.clone();const r=(new T.Matrix4).lookAt(x.current.camPos||u.position,x.current.target,x.current.camUp);return x.current.camRot=(new T.Quaternion).setFromRotationMatrix(r),y.current=An.START,v.current=0,this},to({position:e,target:t}){return this.moveTo(e).lookAt({target:t})},fit(){if(!Ln(u))return this.reset();let e=0,t=0;const n=[new T.Vector3(g.min.x,g.min.y,g.min.z),new T.Vector3(g.min.x,g.max.y,g.min.z),new T.Vector3(g.min.x,g.min.y,g.max.z),new T.Vector3(g.min.x,g.max.y,g.max.z),new T.Vector3(g.max.x,g.max.y,g.max.z),new T.Vector3(g.max.x,g.max.y,g.min.z),new T.Vector3(g.max.x,g.min.y,g.max.z),new T.Vector3(g.max.x,g.min.y,g.min.z)],a=x.current.camPos||u.position,o=x.current.target||(null==f?void 0:f.target),i=x.current.camUp||u.up,s=o?(new T.Matrix4).lookAt(a,o,i).setPosition(a).invert():u.matrixWorldInverse;for(const r of n)r.applyMatrix4(s),e=Math.max(e,Math.abs(r.y)),t=Math.max(t,Math.abs(r.x));e*=2,t*=2;const l=(u.top-u.bottom)/e,c=(u.right-u.left)/t;return x.current.camZoom=Math.min(l,c)/r,y.current=An.START,v.current=0,p.current&&p.current(this.getSize()),this},clip(){const{distance:t}=e();return u.near=t/100,u.far=100*t,u.updateProjectionMatrix(),f&&(f.maxDistance=10*t,f.update()),m(),this}}}),[g,u,f,r,m]);S.useLayoutEffect((()=>{if(f){const e=()=>{if(f&&x.current.target&&y.current!==An.NONE){const e=(new T.Vector3).setFromMatrixColumn(u.matrix,2),t=h.current.camPos.distanceTo(f.target),r=(x.current.camPos||h.current.camPos).distanceTo(x.current.target),n=(1-v.current)*t+v.current*r;f.target.copy(u.position).addScaledVector(e,-n),f.update()}y.current=An.NONE};return f.addEventListener("start",e),()=>f.removeEventListener("start",e)}}),[f]);const z=S.useRef(0);return S.useLayoutEffect((()=>{(n||0==z.current++)&&(w.refresh(),o&&w.reset().fit(),i&&w.clip())}),[d,i,o,n,u,f]),a.useFrame(((e,r)=>{if(y.current===An.START)y.current=An.ACTIVE,m();else if(y.current===An.ACTIVE){if(v.current+=r/t,v.current>=1)x.current.camPos&&u.position.copy(x.current.camPos),x.current.camRot&&u.quaternion.copy(x.current.camRot),x.current.camUp&&u.up.copy(x.current.camUp),x.current.camZoom&&Ln(u)&&(u.zoom=x.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix(),f&&x.current.target&&(f.target.copy(x.current.target),f.update()),y.current=An.NONE;else{const e=s(v.current);x.current.camPos&&u.position.lerpVectors(h.current.camPos,x.current.camPos,e),x.current.camRot&&u.quaternion.slerpQuaternions(h.current.camRot,x.current.camRot,e),x.current.camUp&&u.up.set(0,1,0).applyQuaternion(u.quaternion),x.current.camZoom&&Ln(u)&&(u.zoom=(1-e)*h.current.camZoom+e*x.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix()}m()}})),S.createElement("group",{ref:c},S.createElement(Bn.Provider,{value:w},e))}function Vn(){return S.useContext(Bn)}const On=S.forwardRef((({intensity:e=1,decay:t,decayRate:r=.65,maxYaw:n=.1,maxPitch:o=.1,maxRoll:i=.1,yawFrequency:s=.1,pitchFrequency:l=.1,rollFrequency:u=.1},d)=>{const m=a.useThree((e=>e.camera)),f=a.useThree((e=>e.controls)),p=S.useRef(e),h=S.useRef(m.rotation.clone()),[x]=S.useState((()=>new c.SimplexNoise)),[y]=S.useState((()=>new c.SimplexNoise)),[v]=S.useState((()=>new c.SimplexNoise)),g=()=>{(p.current<0||p.current>1)&&(p.current=p.current<0?0:1)};return S.useImperativeHandle(d,(()=>({getIntensity:()=>p.current,setIntensity:e=>{p.current=e,g()}})),[]),S.useEffect((()=>{if(f){const e=()=>{h.current=m.rotation.clone()};return f.addEventListener("change",e),e(),()=>{f.removeEventListener("change",e)}}}),[m,f]),a.useFrame(((e,a)=>{const c=Math.pow(p.current,2),d=n*c*x.noise(e.clock.elapsedTime*s,1),f=o*c*y.noise(e.clock.elapsedTime*l,1),w=i*c*v.noise(e.clock.elapsedTime*u,1);m.rotation.set(h.current.x+f,h.current.y+d,h.current.z+w),t&&p.current>0&&(p.current-=r*a,g())})),null})),Nn=S.forwardRef((({children:e,enabled:t=!0,speed:r=1,rotationIntensity:n=1,floatIntensity:o=1,floatingRange:i=[-.1,.1],autoInvalidate:s=!1,...l},c)=>{const u=S.useRef(null);S.useImperativeHandle(c,(()=>u.current),[]);const d=S.useRef(1e4*Math.random());return a.useFrame((e=>{var a,l;if(!t||0===r)return;s&&e.invalidate();const c=d.current+e.clock.elapsedTime;u.current.rotation.x=Math.cos(c/4*r)/8*n,u.current.rotation.y=Math.sin(c/4*r)/8*n,u.current.rotation.z=Math.sin(c/4*r)/20*n;let m=Math.sin(c/4*r)/10;m=T.MathUtils.mapLinear(m,-.1,.1,null!==(a=null==i?void 0:i[0])&&void 0!==a?a:-.1,null!==(l=null==i?void 0:i[1])&&void 0!==l?l:.1),u.current.position.y=m*o,u.current.updateMatrix()})),S.createElement("group",l,S.createElement("group",{ref:u,matrixAutoUpdate:!1},e))})),jn={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},Wn="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Gn=e=>Array.isArray(e),Hn=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function $n({files:e=Hn,path:r="",preset:o,colorSpace:i,extensions:s}={}){o&&(Zn(o),e=jn[o],r=Wn);const l=Gn(e),{extension:c,isCubemap:u}=Yn(e),d=Qn(c);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+e);const m=a.useThree((e=>e.gl));t.useLayoutEffect((()=>{"webp"!==c&&"jpg"!==c&&"jpeg"!==c||m.domElement.addEventListener("webglcontextlost",(function(){a.useLoader.clear(d,l?[e]:e)}),{once:!0})}),[e,m.domElement]);const f=a.useLoader(d,l?[e]:e,(e=>{"webp"!==c&&"jpg"!==c&&"jpeg"!==c||e.setRenderer(m),null==e.setPath||e.setPath(r),s&&s(e)}));let p=l?f[0]:f;var h;"jpg"!==c&&"jpeg"!==c&&"webp"!==c||(p=null==(h=p.renderTarget)?void 0:h.texture);return p.mapping=u?n.CubeReflectionMapping:n.EquirectangularReflectionMapping,p.colorSpace=null!=i?i:u?"srgb":"srgb-linear",p}const qn={files:Hn,path:"",preset:void 0,extensions:void 0};$n.preload=e=>{const t={...qn,...e};let{files:r,path:n=""}=t;const{preset:o,extensions:i}=t;o&&(Zn(o),r=jn[o],n=Wn);const{extension:s}=Yn(r);if("webp"===s||"jpg"===s||"jpeg"===s)throw new Error("useEnvironment: Preloading gainmaps is not supported");const l=Qn(s);if(!l)throw new Error("useEnvironment: Unrecognized file extension: "+r);a.useLoader.preload(l,Gn(r)?[r]:r,(e=>{null==e.setPath||e.setPath(n),i&&i(e)}))};const Xn={files:Hn,preset:void 0};function Zn(e){if(!(e in jn))throw new Error("Preset must be one of: "+Object.keys(jn).join(", "))}function Yn(e){var t;const r=Gn(e)&&6===e.length,n=Gn(e)&&3===e.length&&e.some((e=>e.endsWith("json"))),a=Gn(e)?e[0]:e;return{extension:r?"cube":n?"webp":a.startsWith("data:application/exr")?"exr":a.startsWith("data:application/hdr")?"hdr":a.startsWith("data:image/jpeg")?"jpg":null==(t=a.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:r,isGainmap:n}}function Qn(e){return"cube"===e?n.CubeTextureLoader:"hdr"===e?c.RGBELoader:"exr"===e?c.EXRLoader:"jpg"===e||"jpeg"===e?w.HDRJPGLoader:"webp"===e?w.GainMapLoader:null}$n.clear=e=>{const t={...Xn,...e};let{files:r}=t;const{preset:n}=t;n&&(Zn(n),r=jn[n]);const{extension:o}=Yn(r),i=Qn(o);if(!i)throw new Error("useEnvironment: Unrecognized file extension: "+r);a.useLoader.clear(i,Gn(r)?[r]:r)};function Kn(e,t,r,n,o={}){var i,s,l,c;o={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...o};const u=(e=>{return(t=e).current&&t.current.isScene?e.current:e;var t})(t||r),d=u.background,m=u.environment,f={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:null!==(i=null==(s=u.backgroundRotation)||null==s.clone?void 0:s.clone())&&void 0!==i?i:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:null!==(l=null==(c=u.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==l?l:[0,0,0]};return"only"!==e&&(u.environment=n),e&&(u.background=n),a.applyProps(u,o),()=>{"only"!==e&&(u.environment=m),e&&(u.background=d),a.applyProps(u,f)}}function Jn({scene:e,background:t=!1,map:r,...n}){const o=a.useThree((e=>e.scene));return S.useLayoutEffect((()=>{if(r)return Kn(t,e,o,r,n)})),null}function ea({background:e=!1,scene:t,blur:r,backgroundBlurriness:n,backgroundIntensity:o,backgroundRotation:i,environmentIntensity:s,environmentRotation:l,...c}){const u=$n(c),d=a.useThree((e=>e.scene));return S.useLayoutEffect((()=>Kn(e,t,d,u,{backgroundBlurriness:null!=r?r:n,backgroundIntensity:o,backgroundRotation:i,environmentIntensity:s,environmentRotation:l}))),S.useEffect((()=>()=>{u.dispose()}),[u]),null}function ta({children:e,near:t=.1,far:r=1e3,resolution:o=256,frames:i=1,map:s,background:l=!1,blur:c,backgroundBlurriness:u,backgroundIntensity:d,backgroundRotation:m,environmentIntensity:f,environmentRotation:p,scene:h,files:x,path:y,preset:v,extensions:g}){const w=a.useThree((e=>e.gl)),z=a.useThree((e=>e.scene)),b=S.useRef(null),[E]=S.useState((()=>new n.Scene)),M=S.useMemo((()=>{const e=new n.WebGLCubeRenderTarget(o);return e.texture.type=n.HalfFloatType,e}),[o]);S.useEffect((()=>()=>{M.dispose()}),[M]),S.useLayoutEffect((()=>{if(1===i){const e=w.autoClear;w.autoClear=!0,b.current.update(w,E),w.autoClear=e}return Kn(l,h,z,M.texture,{backgroundBlurriness:null!=c?c:u,backgroundIntensity:d,backgroundRotation:m,environmentIntensity:f,environmentRotation:p})}),[e,E,M.texture,h,z,l,i,w]);let C=1;return a.useFrame((()=>{if(i===1/0||C<i){const e=w.autoClear;w.autoClear=!0,b.current.update(w,E),w.autoClear=e,C++}})),S.createElement(S.Fragment,null,a.createPortal(S.createElement(S.Fragment,null,e,S.createElement("cubeCamera",{ref:b,args:[t,r,M]}),x||v?S.createElement(ea,{background:!0,files:x,preset:v,path:y,extensions:g}):s?S.createElement(Jn,{background:!0,map:s,extensions:g}):null),E))}function ra(e){var t,r,n,o;const i=$n(e),s=e.map||i;S.useMemo((()=>a.extend({GroundProjectedEnvImpl:c.GroundProjectedEnv})),[]),S.useEffect((()=>()=>{i.dispose()}),[i]);const l=S.useMemo((()=>[s]),[s]),u=null==(t=e.ground)?void 0:t.height,d=null==(r=e.ground)?void 0:r.radius,m=null!==(n=null==(o=e.ground)?void 0:o.scale)&&void 0!==n?n:1e3;return S.createElement(S.Fragment,null,S.createElement(Jn,M.default({},e,{map:s})),S.createElement("groundProjectedEnvImpl",{args:l,scale:m,height:u,radius:d}))}function na(e){return e.ground?S.createElement(ra,e):e.map?S.createElement(Jn,e):e.children?S.createElement(ta,e):S.createElement(ea,e)}const aa=S.forwardRef((({scale:e=10,frames:t=1/0,opacity:r=1,width:n=1,height:o=1,blur:i=1,near:s=0,far:l=10,resolution:u=512,smooth:d=!0,color:m="#000000",depthWrite:f=!1,renderOrder:p,...h},x)=>{const y=S.useRef(null),v=a.useThree((e=>e.scene)),g=a.useThree((e=>e.gl)),w=S.useRef(null);n*=Array.isArray(e)?e[0]:e||1,o*=Array.isArray(e)?e[1]:e||1;const[z,b,E,C,P,R,D]=S.useMemo((()=>{const e=new T.WebGLRenderTarget(u,u),t=new T.WebGLRenderTarget(u,u);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;const r=new T.PlaneGeometry(n,o).rotateX(Math.PI/2),a=new T.Mesh(r),i=new T.MeshDepthMaterial;i.depthTest=i.depthWrite=!1,i.onBeforeCompile=e=>{e.uniforms={...e.uniforms,ucolor:{value:new T.Color(m)}},e.fragmentShader=e.fragmentShader.replace("void main() {","uniform vec3 ucolor;\n           void main() {\n          "),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const s=new T.ShaderMaterial(c.HorizontalBlurShader),l=new T.ShaderMaterial(c.VerticalBlurShader);return l.depthTest=s.depthTest=!1,[e,r,i,a,s,l,t]}),[u,n,o,e,m]),F=e=>{C.visible=!0,C.material=P,P.uniforms.tDiffuse.value=z.texture,P.uniforms.h.value=1*e/256,g.setRenderTarget(D),g.render(C,w.current),C.material=R,R.uniforms.tDiffuse.value=D.texture,R.uniforms.v.value=1*e/256,g.setRenderTarget(z),g.render(C,w.current),C.visible=!1};let k,_,A=0;return a.useFrame((()=>{w.current&&(t===1/0||A<t)&&(A++,k=v.background,_=v.overrideMaterial,y.current.visible=!1,v.background=null,v.overrideMaterial=E,g.setRenderTarget(z),g.render(v,w.current),F(i),d&&F(.4*i),g.setRenderTarget(null),y.current.visible=!0,v.overrideMaterial=_,v.background=k)})),S.useImperativeHandle(x,(()=>y.current),[]),S.createElement("group",M.default({"rotation-x":Math.PI/2},h,{ref:y}),S.createElement("mesh",{renderOrder:p,geometry:b,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},S.createElement("meshBasicMaterial",{transparent:!0,map:z.texture,opacity:r,depthWrite:f})),S.createElement("orthographicCamera",{ref:w,args:[-n/2,n/2,o/2,-o/2,s,l]}))}));const oa=S.createContext(null),ia=Ee({color:new T.Color,blend:2,alphaTest:.75,opacity:0,map:null},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vUv = uv;\n   }",`varying vec2 vUv;\n   uniform sampler2D map;\n   uniform vec3 color;\n   uniform float opacity;\n   uniform float alphaTest;\n   uniform float blend;\n   void main() {\n     vec4 sampledDiffuseColor = texture2D(map, vUv);\n     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);\n     #include <tonemapping_fragment>\n     #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),sa=S.forwardRef((({children:e,temporal:t,frames:r=40,limit:n=1/0,blend:o=20,scale:i=10,opacity:s=1,alphaTest:l=.75,color:c="black",colorBlend:u=2,resolution:d=1024,toneMapped:m=!0,...f},p)=>{a.extend({SoftShadowMaterial:ia});const h=a.useThree((e=>e.gl)),x=a.useThree((e=>e.scene)),y=a.useThree((e=>e.camera)),v=a.useThree((e=>e.invalidate)),g=S.useRef(null),w=S.useRef(null),[z]=S.useState((()=>new ca(h,x,d)));S.useLayoutEffect((()=>{z.configure(g.current)}),[]);const b=S.useMemo((()=>({lights:new Map,temporal:!!t,frames:Math.max(2,r),blend:Math.max(2,r===1/0?o:r),count:0,getMesh:()=>g.current,reset:()=>{z.clear();const e=g.current.material;e.opacity=0,e.alphaTest=0,b.count=0},update:(e=1)=>{const t=g.current.material;b.temporal?(t.opacity=Math.min(s,t.opacity+s/b.blend),t.alphaTest=Math.min(l,t.alphaTest+l/b.blend)):(t.opacity=s,t.alphaTest=l),w.current.visible=!0,z.prepare();for(let t=0;t<e;t++)b.lights.forEach((e=>e.update())),z.update(y,b.blend);w.current.visible=!1,z.finish()}})),[z,y,x,t,r,o,s,l]);return S.useLayoutEffect((()=>{b.reset(),b.temporal||b.frames===1/0||b.update(b.blend)})),S.useImperativeHandle(p,(()=>b),[b]),a.useFrame((()=>{(b.temporal||b.frames===1/0)&&b.count<b.frames&&b.count<n&&(v(),b.update(),b.count++)})),S.createElement("group",f,S.createElement("group",{traverse:()=>null,ref:w},S.createElement(oa.Provider,{value:b},e)),S.createElement("mesh",{receiveShadow:!0,ref:g,scale:i,rotation:[-Math.PI/2,0,0]},S.createElement("planeGeometry",null),S.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:m,color:c,blend:u,map:z.progressiveLightMap2.texture})))})),la=S.forwardRef((({castShadow:e=!0,bias:t=.001,mapSize:r=512,size:n=5,near:a=.5,far:o=500,frames:i=1,position:s=[0,0,0],radius:l=1,amount:c=8,intensity:u=(Ce>=155?Math.PI:1),ambient:d=.5,...m},f)=>{const p=S.useRef(null),h=new T.Vector3(...s).length(),x=S.useContext(oa),y=S.useCallback((()=>{let e;if(p.current)for(let t=0;t<p.current.children.length;t++)if(e=p.current.children[t],Math.random()>d)e.position.set(s[0]+T.MathUtils.randFloatSpread(l),s[1]+T.MathUtils.randFloatSpread(l),s[2]+T.MathUtils.randFloatSpread(l));else{let t=Math.acos(2*Math.random()-1)-Math.PI/2,r=2*Math.PI*Math.random();e.position.set(Math.cos(t)*Math.cos(r)*h,Math.abs(Math.cos(t)*Math.sin(r)*h),Math.sin(t)*h)}}),[l,d,h,...s]),v=S.useMemo((()=>({update:y})),[y]);return S.useImperativeHandle(f,(()=>v),[v]),S.useLayoutEffect((()=>{var e;const t=p.current;return x&&(null==(e=x.lights)||e.set(t.uuid,v)),()=>{var e;null==x||null==(e=x.lights)||e.delete(t.uuid)}}),[x,v]),S.createElement("group",M.default({ref:p},m),Array.from({length:c},((i,s)=>S.createElement("directionalLight",{key:s,castShadow:e,"shadow-bias":t,"shadow-mapSize":[r,r],intensity:u/c},S.createElement("orthographicCamera",{attach:"shadow-camera",args:[-n,n,n,-n,a,o]})))))}));class ca{constructor(e,t,r=1024){this.renderer=e,this.res=r,this.scene=t,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new T.Color,this.clearAlpha=0;const n={type:T.HalfFloatType,magFilter:T.NearestFilter,minFilter:T.NearestFilter};this.progressiveLightMap1=new T.WebGLRenderTarget(this.res,this.res,n),this.progressiveLightMap2=new T.WebGLRenderTarget(this.res,this.res,n),this.discardMat=new Jr,this.targetMat=new T.MeshLambertMaterial({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=e=>{e.vertexShader="varying vec2 vUv;\n"+e.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const t=e.fragmentShader.indexOf("void main() {");e.fragmentShader="varying vec2 vUv;\n"+e.fragmentShader.slice(0,t)+"uniform sampler2D previousShadowMap;\n\tuniform float averagingWindow;\n"+e.fragmentShader.slice(t-1,-1)+"\nvec3 texelOld = texture2D(previousShadowMap, vUv).rgb;\n        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);\n      }",e.uniforms.previousShadowMap=this.previousShadowMap,e.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse((e=>{!function(e){return!!e.geometry}(e)?function(e){return e.isLight}(e)&&this.lights.push({object:e,intensity:e.intensity}):this.meshes.push({object:e,material:e.material})}))}prepare(){this.lights.forEach((e=>e.object.intensity=0)),this.meshes.forEach((e=>e.object.material=this.discardMat))}finish(){this.lights.forEach((e=>e.object.intensity=e.intensity)),this.meshes.forEach((e=>e.object.material=e.material))}configure(e){this.object=e}update(e,t=100){if(!this.object)return;this.averagingWindow.value=t,this.object.material=this.targetMat;const r=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,n=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,a=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(r),this.previousShadowMap.value=n.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=a}}const ua={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function da({radius:e,adjustCamera:t}){const r=Vn();return S.useEffect((()=>{t&&r.refresh().clip().fit()}),[e,t]),null}const ma=e=>0===e?0:Math.pow(2,10*e-10);const fa=S.forwardRef((({fog:e=!1,renderOrder:t,depthWrite:r=!1,colorStop:a=0,color:o="black",opacity:i=.5,...s},l)=>{const c=S.useMemo((()=>{const e=document.createElement("canvas");e.width=128,e.height=128;const t=e.getContext("2d"),r=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return r.addColorStop(a,new n.Color(o).getStyle()),r.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height),e}),[o,a]);return S.createElement("mesh",M.default({renderOrder:t,ref:l,"rotation-x":-Math.PI/2},s),S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,opacity:i,fog:e,depthWrite:r,side:n.DoubleSide},S.createElement("canvasTexture",{attach:"map",args:[c]})))}));function pa(e=T.FrontSide){const t={value:new T.Matrix4};return Object.assign(new T.MeshNormalMaterial({side:e}),{viewMatrix:t,onBeforeCompile:e=>{e.uniforms.viewMatrix=t,e.fragmentShader="vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n           return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n         }\n"+e.fragmentShader.replace("#include <normal_fragment_maps>","#include <normal_fragment_maps>\n           normal = inverseTransformDirection( normal, viewMatrix );\n")}})}const ha=Ee({causticsTexture:null,causticsTextureB:null,color:new T.Color,lightProjMatrix:new T.Matrix4,lightViewMatrix:new T.Matrix4},"varying vec3 vWorldPosition;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vec4 worldPosition = modelMatrix * vec4(position, 1.);\n     vWorldPosition = worldPosition.xyz;\n   }",`varying vec3 vWorldPosition;\n  uniform vec3 color;\n  uniform sampler2D causticsTexture;\n  uniform sampler2D causticsTextureB;\n  uniform mat4 lightProjMatrix;\n  uniform mat4 lightViewMatrix;\n   void main() {\n    // Apply caustics\n    vec4 lightSpacePos = lightProjMatrix * lightViewMatrix * vec4(vWorldPosition, 1.0);\n    lightSpacePos.xyz /= lightSpacePos.w;\n    lightSpacePos.xyz = lightSpacePos.xyz * 0.5 + 0.5;\n    vec3 front = texture2D(causticsTexture, lightSpacePos.xy).rgb;\n    vec3 back = texture2D(causticsTextureB, lightSpacePos.xy).rgb;\n    gl_FragColor = vec4((front + back) * color, 1.0);\n    #include <tonemapping_fragment>\n    #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),xa=Ee({cameraMatrixWorld:new T.Matrix4,cameraProjectionMatrixInv:new T.Matrix4,normalTexture:null,depthTexture:null,lightDir:new T.Vector3(0,1,0),lightPlaneNormal:new T.Vector3(0,1,0),lightPlaneConstant:0,near:.1,far:100,modelMatrix:new T.Matrix4,worldRadius:1/40,ior:1.1,bounces:0,resolution:1024,size:10,intensity:.5},"\n  varying vec2 vUv;\n  void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }","\n  uniform mat4 cameraMatrixWorld;\n  uniform mat4 cameraProjectionMatrixInv;\n  uniform vec3 lightDir;\n  uniform vec3 lightPlaneNormal;\n  uniform float lightPlaneConstant;\n  uniform float near;\n  uniform float far;\n  uniform float time;\n  uniform float worldRadius;\n  uniform float resolution;\n  uniform float size;\n  uniform float intensity;\n  uniform float ior;\n  precision highp isampler2D;\n  precision highp usampler2D;\n  uniform sampler2D normalTexture;\n  uniform sampler2D depthTexture;\n  uniform float bounces;\n  varying vec2 vUv;\n  vec3 WorldPosFromDepth(float depth, vec2 coord) {\n    float z = depth * 2.0 - 1.0;\n    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n    vec4 viewSpacePosition = cameraProjectionMatrixInv * clipSpacePosition;\n    // Perspective division\n    viewSpacePosition /= viewSpacePosition.w;\n    vec4 worldSpacePosition = cameraMatrixWorld * viewSpacePosition;\n    return worldSpacePosition.xyz;\n  }\n  float sdPlane( vec3 p, vec3 n, float h ) {\n    // n must be normalized\n    return dot(p,n) + h;\n  }\n  float planeIntersect( vec3 ro, vec3 rd, vec4 p ) {\n    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);\n  }\n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 pos, vec3 normal, float ior, out vec3 rayOrigin, out vec3 rayDirection) {\n    rayOrigin = ro;\n    rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = pos + rayDirection * 0.1;\n    return rayDirection;\n  }\n  void main() {\n    // Each sample consists of random offset in the x and y direction\n    float caustic = 0.0;\n    float causticTexelSize = (1.0 / resolution) * size * 2.0;\n    float texelsNeeded = worldRadius / causticTexelSize;\n    float sampleRadius = texelsNeeded / resolution;\n    float sum = 0.0;\n    if (texture2D(depthTexture, vUv).x == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec2 offset1 = vec2(-0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset2 = vec2(-0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset3 = vec2(0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset4 = vec2(0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 uv1 = vUv + offset1 * sampleRadius;\n    vec2 uv2 = vUv + offset2 * sampleRadius;\n    vec2 uv3 = vUv + offset3 * sampleRadius;\n    vec2 uv4 = vUv + offset4 * sampleRadius;\n    vec3 normal1 = texture2D(normalTexture, uv1, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal2 = texture2D(normalTexture, uv2, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal3 = texture2D(normalTexture, uv3, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal4 = texture2D(normalTexture, uv4, -10.0).rgb * 2.0 - 1.0;\n    float depth1 = texture2D(depthTexture, uv1, -10.0).x;\n    float depth2 = texture2D(depthTexture, uv2, -10.0).x;\n    float depth3 = texture2D(depthTexture, uv3, -10.0).x;\n    float depth4 = texture2D(depthTexture, uv4, -10.0).x;\n    // Sanity check the depths\n    if (depth1 == 1.0 || depth2 == 1.0 || depth3 == 1.0 || depth4 == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec3 pos1 = WorldPosFromDepth(depth1, uv1);\n    vec3 pos2 = WorldPosFromDepth(depth2, uv2);\n    vec3 pos3 = WorldPosFromDepth(depth3, uv3);\n    vec3 pos4 = WorldPosFromDepth(depth4, uv4);\n    vec3 originPos1 = WorldPosFromDepth(0.0, uv1);\n    vec3 originPos2 = WorldPosFromDepth(0.0, uv2);\n    vec3 originPos3 = WorldPosFromDepth(0.0, uv3);\n    vec3 originPos4 = WorldPosFromDepth(0.0, uv4);\n    vec3 endPos1, endPos2, endPos3, endPos4;\n    vec3 endDir1, endDir2, endDir3, endDir4;\n    totalInternalReflection(originPos1, lightDir, pos1, normal1, ior, endPos1, endDir1);\n    totalInternalReflection(originPos2, lightDir, pos2, normal2, ior, endPos2, endDir2);\n    totalInternalReflection(originPos3, lightDir, pos3, normal3, ior, endPos3, endDir3);\n    totalInternalReflection(originPos4, lightDir, pos4, normal4, ior, endPos4, endDir4);\n    float lightPosArea = length(cross(originPos2 - originPos1, originPos3 - originPos1)) + length(cross(originPos3 - originPos1, originPos4 - originPos1));\n    float t1 = planeIntersect(endPos1, endDir1, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t2 = planeIntersect(endPos2, endDir2, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t3 = planeIntersect(endPos3, endDir3, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t4 = planeIntersect(endPos4, endDir4, vec4(lightPlaneNormal, lightPlaneConstant));\n    vec3 finalPos1 = endPos1 + endDir1 * t1;\n    vec3 finalPos2 = endPos2 + endDir2 * t2;\n    vec3 finalPos3 = endPos3 + endDir3 * t3;\n    vec3 finalPos4 = endPos4 + endDir4 * t4;\n    float finalArea = length(cross(finalPos2 - finalPos1, finalPos3 - finalPos1)) + length(cross(finalPos3 - finalPos1, finalPos4 - finalPos1));\n    caustic += intensity * (lightPosArea / finalArea);\n    // Calculate the area of the triangle in light spaces\n    gl_FragColor = vec4(vec3(max(caustic, 0.0)), 1.0);\n  }"),ya={depth:!0,minFilter:T.LinearFilter,magFilter:T.LinearFilter,type:T.UnsignedByteType},va={minFilter:T.LinearMipmapLinearFilter,magFilter:T.LinearFilter,type:T.FloatType,generateMipmaps:!0},ga=S.forwardRef((({debug:e,children:t,frames:r=1,ior:n=1.1,color:o="white",causticsOnly:i=!1,backside:s=!1,backsideIOR:l=1.1,worldRadius:u=.3125,intensity:d=.05,resolution:m=2024,lightSource:f=[5,5,5],...p},h)=>{a.extend({CausticsProjectionMaterial:ha});const x=S.useRef(null),y=S.useRef(null),v=S.useRef(null),g=S.useRef(null),w=a.useThree((e=>e.gl)),z=lr(e&&y,T.CameraHelper),b=rt(m,m,ya),E=rt(m,m,ya),C=rt(m,m,va),P=rt(m,m,va),[R]=S.useState((()=>pa())),[D]=S.useState((()=>pa(T.BackSide))),[F]=S.useState((()=>new xa)),[k]=S.useState((()=>new c.FullScreenQuad(F)));S.useLayoutEffect((()=>{x.current.updateWorldMatrix(!1,!0)}));let _=0;const A=new T.Vector3,L=new T.Frustum,I=new T.Matrix4,B=new T.Plane,U=new T.Vector3,V=new T.Vector3,O=new T.Box3,N=new T.Vector3,j=[],W=[],G=[],H=[],$=new T.Vector3;for(let e=0;e<8;e++)j.push(new T.Vector3),W.push(new T.Vector3),G.push(new T.Vector3),H.push(new T.Vector3);return a.useFrame((()=>{if(r===1/0||_++<r){var t,a;Array.isArray(f)?U.fromArray(f).normalize():U.copy(x.current.worldToLocal(f.current.getWorldPosition(A)).normalize()),V.copy(U).multiplyScalar(-1),null==(t=v.current.parent)||t.matrixWorld.identity(),O.setFromObject(v.current,!0),j[0].set(O.min.x,O.min.y,O.min.z),j[1].set(O.min.x,O.min.y,O.max.z),j[2].set(O.min.x,O.max.y,O.min.z),j[3].set(O.min.x,O.max.y,O.max.z),j[4].set(O.max.x,O.min.y,O.min.z),j[5].set(O.max.x,O.min.y,O.max.z),j[6].set(O.max.x,O.max.y,O.min.z),j[7].set(O.max.x,O.max.y,O.max.z);for(let e=0;e<8;e++)W[e].copy(j[e]);O.getCenter(N),j.map((e=>e.sub(N)));const r=B.set(V,0);j.map(((e,t)=>r.projectPoint(e,G[t])));const o=G.reduce(((e,t)=>e.add(t)),A.set(0,0,0)).divideScalar(G.length),c=G.map((e=>e.distanceTo(o))).reduce(((e,t)=>Math.max(e,t))),p=j.map((e=>e.dot(U))).reduce(((e,t)=>Math.max(e,t)));y.current.position.copy($.copy(U).multiplyScalar(p).add(N)),y.current.lookAt(v.current.localToWorld(N));const h=I.lookAt(y.current.position,N,A.set(0,1,0));y.current.left=-c,y.current.right=c,y.current.top=c,y.current.bottom=-c;const M=A.set(0,c,0).applyMatrix4(h),S=(y.current.position.y+M.y)/U.y;y.current.near=.1,y.current.far=S,y.current.updateProjectionMatrix(),y.current.updateMatrixWorld();const T=W.map(((e,t)=>e.add(H[t].copy(U).multiplyScalar(-e.y/U.y)))),_=T.reduce(((e,t)=>e.add(t)),A.set(0,0,0)).divideScalar(T.length),q=2*T.map((e=>Math.hypot(e.x-_.x,e.z-_.z))).reduce(((e,t)=>Math.max(e,t)));g.current.scale.setScalar(q),g.current.position.copy(_),e&&(null==(a=z.current)||a.update()),D.viewMatrix.value=R.viewMatrix.value=y.current.matrixWorldInverse;const X=L.setFromProjectionMatrix(I.multiplyMatrices(y.current.projectionMatrix,y.current.matrixWorldInverse)).planes[4];F.cameraMatrixWorld=y.current.matrixWorld,F.cameraProjectionMatrixInv=y.current.projectionMatrixInverse,F.lightDir=V,F.lightPlaneNormal=X.normal,F.lightPlaneConstant=X.constant,F.near=y.current.near,F.far=y.current.far,F.resolution=m,F.size=c,F.intensity=d,F.worldRadius=u,v.current.visible=!0,w.setRenderTarget(b),w.clear(),v.current.overrideMaterial=R,w.render(v.current,y.current),w.setRenderTarget(E),w.clear(),s&&(v.current.overrideMaterial=D,w.render(v.current,y.current)),v.current.overrideMaterial=null,F.ior=n,g.current.material.lightProjMatrix=y.current.projectionMatrix,g.current.material.lightViewMatrix=y.current.matrixWorldInverse,F.normalTexture=b.texture,F.depthTexture=b.depthTexture,w.setRenderTarget(C),w.clear(),k.render(w),F.ior=l,F.normalTexture=E.texture,F.depthTexture=E.depthTexture,w.setRenderTarget(P),w.clear(),s&&k.render(w),w.setRenderTarget(null),i&&(v.current.visible=!1)}})),S.useImperativeHandle(h,(()=>x.current),[]),S.createElement("group",M.default({ref:x},p),S.createElement("scene",{ref:v},S.createElement("orthographicCamera",{ref:y,up:[0,1,0]}),t),S.createElement("mesh",{renderOrder:2,ref:g,"rotation-x":-Math.PI/2},S.createElement("planeGeometry",null),S.createElement("causticsProjectionMaterial",{transparent:!0,color:o,causticsTexture:C.texture,causticsTextureB:P.texture,blending:T.CustomBlending,blendSrc:T.OneFactor,blendDst:T.SrcAlphaFactor,depthWrite:!1}),e&&S.createElement(ke,null,S.createElement("lineBasicMaterial",{color:"#ffff00",toneMapped:!1}))))}));class wa extends T.ShaderMaterial{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new T.Vector3(0,0,0)},lightColor:{value:new T.Color("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new T.Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:"\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n        uniform vec3 spotPosition;\n        uniform float attenuation;\n\n        #include <common>\n        #include <logdepthbuf_pars_vertex>\n\n        void main() {\n          // compute intensity\n          vNormal = normalize(normalMatrix * normal);\n          vec4 worldPosition = modelMatrix * vec4(position, 1);\n          vec4 viewPosition = viewMatrix * worldPosition;\n          vViewZ = viewPosition.z;\n\n          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);\n\n          gl_Position = projectionMatrix * viewPosition;\n\n          #include <logdepthbuf_vertex>\n        }\n      ",fragmentShader:`\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n\n        uniform vec3 lightColor;\n        uniform float anglePower;\n        uniform sampler2D depth;\n        uniform vec2 resolution;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float opacity;\n\n        #include <packing>\n        #include <logdepthbuf_pars_fragment>\n\n        float readDepth(sampler2D depthSampler, vec2 uv) {\n          float fragCoordZ = texture(depthSampler, uv).r;\n\n          // https://github.com/mrdoob/three.js/issues/23072\n          #ifdef USE_LOGDEPTHBUF\n            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));\n          #else\n            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n          #endif\n\n          return viewZ;\n        }\n\n        void main() {\n          #include <logdepthbuf_fragment>\n\n          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));\n          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);\n          float intensity = vIntensity * angleIntensity;\n\n          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry\n          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;\n          if (isSoft) {\n            vec2 uv = gl_FragCoord.xy / resolution;\n            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));\n          }\n\n          gl_FragColor = vec4(lightColor, intensity * opacity);\n\n          #include <tonemapping_fragment>\n          #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}}function za({opacity:e=1,radiusTop:t,radiusBottom:r,depthBuffer:o,color:i="white",distance:s=5,angle:l=.15,attenuation:c=5,anglePower:u=5}){const d=S.useRef(null),m=a.useThree((e=>e.size)),f=a.useThree((e=>e.camera)),p=a.useThree((e=>e.viewport.dpr)),[h]=S.useState((()=>new wa)),[x]=S.useState((()=>new n.Vector3));t=void 0===t?.1:t,r=void 0===r?7*l:r,a.useFrame((()=>{h.uniforms.spotPosition.value.copy(d.current.getWorldPosition(x)),d.current.lookAt(d.current.parent.target.getWorldPosition(x))}));const y=S.useMemo((()=>{const e=new n.CylinderGeometry(t,r,s,128,64,!0);return e.applyMatrix4((new n.Matrix4).makeTranslation(0,-s/2,0)),e.applyMatrix4((new n.Matrix4).makeRotationX(-Math.PI/2)),e}),[s,t,r]);return S.createElement(S.Fragment,null,S.createElement("mesh",{ref:d,geometry:y,raycast:()=>null},S.createElement("primitive",{object:h,attach:"material","uniforms-opacity-value":e,"uniforms-lightColor-value":i,"uniforms-attenuation-value":c,"uniforms-anglePower-value":u,"uniforms-depth-value":o,"uniforms-cameraNear-value":f.near,"uniforms-cameraFar-value":f.far,"uniforms-resolution-value":o?[m.width*p,m.height*p]:[0,0]})))}function ba(e,t,r,o,i){const[[s,l]]=S.useState((()=>[new n.Vector3,new n.Vector3]));S.useLayoutEffect((()=>{if(!(null==(t=e.current)?void 0:t.isSpotLight))throw new Error("SpotlightShadow must be a child of a SpotLight");var t;e.current.shadow.mapSize.set(r,o),e.current.shadow.needsUpdate=!0}),[e,r,o]),a.useFrame((()=>{if(!e.current)return;const r=e.current.position,n=e.current.target.position;l.copy(n).sub(r);var a=l.length();l.normalize().multiplyScalar(a*i),s.copy(r).add(l),t.current.position.copy(s),t.current.lookAt(e.current.target.position)}))}function Ea({distance:e=.4,alphaTest:t=.5,map:r,shader:o="#define GLSLIFY 1\nvarying vec2 vUv;uniform sampler2D uShadowMap;uniform float uTime;void main(){vec3 color=texture2D(uShadowMap,vUv).xyz;gl_FragColor=vec4(color,1.);}",width:i=512,height:s=512,scale:l=1,children:u,...d}){const m=S.useRef(null),f=d.spotlightRef,p=d.debug;ba(f,m,i,s,e);const h=S.useMemo((()=>new n.WebGLRenderTarget(i,s,{format:n.RGBAFormat,stencilBuffer:!1})),[i,s]),x=S.useRef({uShadowMap:{value:r},uTime:{value:0}});S.useEffect((()=>{x.current.uShadowMap.value=r}),[r]);const y=S.useMemo((()=>new c.FullScreenQuad(new n.ShaderMaterial({uniforms:x.current,vertexShader:"\n          varying vec2 vUv;\n\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n          ",fragmentShader:o}))),[o]);return S.useEffect((()=>()=>{y.material.dispose(),y.dispose()}),[y]),S.useEffect((()=>()=>h.dispose()),[h]),a.useFrame((({gl:e},t)=>{x.current.uTime.value+=t,e.setRenderTarget(h),y.render(e),e.setRenderTarget(null)})),S.createElement(S.Fragment,null,S.createElement("mesh",{ref:m,scale:l,castShadow:!0},S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,side:n.DoubleSide,alphaTest:t,alphaMap:h.texture,"alphaMap-wrapS":n.RepeatWrapping,"alphaMap-wrapT":n.RepeatWrapping,opacity:p?1:0},u)))}function Ma({distance:e=.4,alphaTest:t=.5,map:r,width:a=512,height:o=512,scale:i,children:s,...l}){const c=S.useRef(null),u=l.spotlightRef,d=l.debug;return ba(u,c,a,o,e),S.createElement(S.Fragment,null,S.createElement("mesh",{ref:c,scale:i,castShadow:!0},S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,side:n.DoubleSide,alphaTest:t,alphaMap:r,"alphaMap-wrapS":n.RepeatWrapping,"alphaMap-wrapT":n.RepeatWrapping,opacity:d?1:0},s)))}const Sa=S.forwardRef((({opacity:e=1,radiusTop:t,radiusBottom:r,depthBuffer:n,color:a="white",distance:o=5,angle:i=.15,attenuation:s=5,anglePower:l=5,volumetric:c=!0,debug:u=!1,children:d,...m},f)=>{const p=S.useRef(null);return S.useImperativeHandle(f,(()=>p.current),[]),S.createElement("group",null,u&&p.current&&S.createElement("spotLightHelper",{args:[p.current]}),S.createElement("spotLight",M.default({ref:p,angle:i,color:a,distance:o,castShadow:!0},m),c&&S.createElement(za,{debug:u,opacity:e,radiusTop:t,radiusBottom:r,depthBuffer:n,color:a,distance:o,angle:i,attenuation:s,anglePower:l})),d&&S.cloneElement(d,{spotlightRef:p,debug:u}))})),Ca=S.forwardRef((({light:e,args:t,map:r,toneMapped:n=!1,color:o="white",form:i="rect",intensity:s=1,scale:l=1,target:c=[0,0,0],children:u,...d},m)=>{const f=S.useRef(null);return S.useImperativeHandle(m,(()=>f.current),[]),S.useLayoutEffect((()=>{u||d.material||(a.applyProps(f.current.material,{color:o}),f.current.material.color.multiplyScalar(s))}),[o,s,u,d.material]),S.useLayoutEffect((()=>{d.rotation||f.current.quaternion.identity(),c&&!d.rotation&&("boolean"==typeof c?f.current.lookAt(0,0,0):f.current.lookAt(Array.isArray(c)?new T.Vector3(...c):c))}),[c,d.rotation]),l=Array.isArray(l)&&2===l.length?[l[0],l[1],1]:l,S.createElement("mesh",M.default({ref:f,scale:l},d),"circle"===i?S.createElement("ringGeometry",{args:t||[0,.5,64]}):"ring"===i?S.createElement("ringGeometry",{args:t||[.25,.5,64]}):"rect"===i||"plane"===i?S.createElement("planeGeometry",{args:t||[1,1]}):"box"===i?S.createElement("boxGeometry",{args:t||[1,1,1]}):S.createElement(i,{args:t}),u||S.createElement("meshBasicMaterial",{toneMapped:n,map:r,side:T.DoubleSide}),e&&S.createElement("pointLight",M.default({castShadow:!0},e)))}));function Ta(e,t,r=new n.Vector3){const a=Math.PI*(e-.5),o=2*Math.PI*(t-.5);return r.x=Math.cos(o),r.y=Math.sin(a),r.z=Math.sin(o),r}const Pa=S.forwardRef((({inclination:e=.6,azimuth:t=.1,distance:r=1e3,mieCoefficient:a=.005,mieDirectionalG:o=.8,rayleigh:i=.5,turbidity:s=10,sunPosition:l=Ta(e,t),...u},d)=>{const m=S.useMemo((()=>(new n.Vector3).setScalar(r)),[r]),[f]=S.useState((()=>new c.Sky));return S.createElement("primitive",M.default({object:f,ref:d,"material-uniforms-mieCoefficient-value":a,"material-uniforms-mieDirectionalG-value":o,"material-uniforms-rayleigh-value":i,"material-uniforms-sunPosition-value":l,"material-uniforms-turbidity-value":s,scale:m},u))}));class Ra extends n.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:`\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n\n        #include <tonemapping_fragment>\n\t      #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n      }`})}}const Da=e=>(new n.Vector3).setFromSpherical(new n.Spherical(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),Fa=S.forwardRef((({radius:e=100,depth:t=50,count:r=5e3,saturation:o=0,factor:i=4,fade:s=!1,speed:l=1},c)=>{const u=S.useRef(null),[d,m,f]=S.useMemo((()=>{const a=[],s=[],l=Array.from({length:r},(()=>(.5+.5*Math.random())*i)),c=new n.Color;let u=e+t;const d=t/r;for(let e=0;e<r;e++)u-=d*Math.random(),a.push(...Da(u).toArray()),c.setHSL(e/r,o,.9),s.push(c.r,c.g,c.b);return[new Float32Array(a),new Float32Array(s),new Float32Array(l)]}),[r,t,i,e,o]);a.useFrame((e=>u.current&&(u.current.uniforms.time.value=e.clock.elapsedTime*l)));const[p]=S.useState((()=>new Ra));return S.createElement("points",{ref:c},S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[d,3]}),S.createElement("bufferAttribute",{attach:"attributes-color",args:[m,3]}),S.createElement("bufferAttribute",{attach:"attributes-size",args:[f,1]})),S.createElement("primitive",{ref:u,object:p,attach:"material",blending:n.AdditiveBlending,"uniforms-fade-value":s,depthWrite:!1,transparent:!0,vertexColors:!0}))})),ka=new n.Matrix4,_a=new n.Vector3,Aa=new n.Quaternion,La=new n.Vector3,Ia=new n.Quaternion,Ba=new n.Vector3,Ua=S.createContext(null),Va=S.forwardRef((({children:e,material:t=n.MeshLambertMaterial,texture:r="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",range:o,limit:i=200,frustumCulled:s,...l},c)=>{var u,d;const m=S.useMemo((()=>class extends t{constructor(){super();const e=parseInt(n.REVISION.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=t=>{t.vertexShader="attribute float cloudOpacity;\n               varying float vOpacity;\n              "+t.vertexShader.replace("#include <fog_vertex>","#include <fog_vertex>\n                 vOpacity = cloudOpacity;\n                "),t.fragmentShader="varying float vOpacity;\n              "+t.fragmentShader.replace(`#include <${e}>`,`#include <${e}>\n                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);\n                `)}}}),[t]);a.extend({CloudMaterial:m});const f=S.useRef(null),p=S.useRef([]),h=S.useMemo((()=>new Float32Array(Array.from({length:i},(()=>1)))),[i]),x=S.useMemo((()=>new Float32Array(Array.from({length:i},(()=>[1,1,1])).flat())),[i]),y=Se(r);let v,g=0,w=0;const z=new n.Quaternion,b=new n.Vector3(0,0,1),E=new n.Vector3;a.useFrame(((e,t)=>{for(g=e.clock.elapsedTime,ka.copy(f.current.matrixWorld).invert(),e.camera.matrixWorld.decompose(La,Ia,Ba),w=0;w<p.current.length;w++)v=p.current[w],v.ref.current.matrixWorld.decompose(_a,Aa,Ba),_a.add(E.copy(v.position).applyQuaternion(Aa).multiply(Ba)),Aa.copy(Ia).multiply(z.setFromAxisAngle(b,v.rotation+=t*v.rotationFactor)),Ba.multiplyScalar(v.volume+(1+Math.sin(g*v.density*v.speed))/2*v.growth),v.matrix.compose(_a,Aa,Ba).premultiply(ka),v.dist=_a.distanceTo(La);for(p.current.sort(((e,t)=>t.dist-e.dist)),w=0;w<p.current.length;w++)v=p.current[w],h[w]=v.opacity*(v.dist<v.fade-1?v.dist/v.fade:1),f.current.setMatrixAt(w,v.matrix),f.current.setColorAt(w,v.color);f.current.geometry.attributes.cloudOpacity.needsUpdate=!0,f.current.instanceMatrix.needsUpdate=!0,f.current.instanceColor&&(f.current.instanceColor.needsUpdate=!0)})),S.useLayoutEffect((()=>{const e=Math.min(i,void 0!==o?o:i,p.current.length);f.current.count=e,br(f.current.instanceMatrix,{start:0,count:16*e}),f.current.instanceColor&&br(f.current.instanceColor,{start:0,count:3*e}),br(f.current.geometry.attributes.cloudOpacity,{start:0,count:e})}));let C=[null!==(u=y.image.width)&&void 0!==u?u:1,null!==(d=y.image.height)&&void 0!==d?d:1];const T=Math.max(C[0],C[1]);return C=[C[0]/T,C[1]/T],S.createElement("group",M.default({ref:c},l),S.createElement(Ua.Provider,{value:p},e,S.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:f,args:[null,null,i],frustumCulled:s},S.createElement("instancedBufferAttribute",{usage:n.DynamicDrawUsage,attach:"instanceColor",args:[x,3]}),S.createElement("planeGeometry",{args:[...C]},S.createElement("instancedBufferAttribute",{usage:n.DynamicDrawUsage,attach:"attributes-cloudOpacity",args:[h,1]})),S.createElement("cloudMaterial",{key:t.name,map:y,transparent:!0,depthWrite:!1}))))})),Oa=S.forwardRef((({opacity:e=1,speed:t=0,bounds:r=[5,1,1],segments:o=20,color:i="#ffffff",fade:s=10,volume:l=6,smallestVolume:c=.25,distribute:u=null,growth:d=4,concentrate:m="inside",seed:f=Math.random(),...p},h)=>{function x(){const e=1e4*Math.sin(f++);return e-Math.floor(e)}const y=S.useContext(Ua),v=S.useRef(null),g=S.useId(),w=S.useMemo((()=>[...new Array(o)].map(((e,t)=>({segments:o,bounds:new n.Vector3(1,1,1),position:new n.Vector3,uuid:g,index:t,ref:v,dist:0,matrix:new n.Matrix4,color:new n.Color,rotation:t*(Math.PI/o)})))),[o,g]);return S.useLayoutEffect((()=>{w.forEach(((n,f)=>{a.applyProps(n,{volume:l,color:i,speed:t,growth:d,opacity:e,fade:s,bounds:r,density:Math.max(.5,x()),rotationFactor:Math.max(.2,.5*x())*t});const p=null==u?void 0:u(n,f);var h;(p||o>1)&&n.position.copy(n.bounds).multiply(null!==(h=null==p?void 0:p.point)&&void 0!==h?h:{x:2*x()-1,y:2*x()-1,z:2*x()-1});const y=Math.abs(n.position.x),v=Math.abs(n.position.y),g=Math.abs(n.position.z),w=Math.max(y,v,g);n.length=1,y===w&&(n.length-=y/n.bounds.x),v===w&&(n.length-=v/n.bounds.y),g===w&&(n.length-=g/n.bounds.z),n.volume=(void 0!==(null==p?void 0:p.volume)?p.volume:Math.max(Math.max(0,c),"random"===m?x():"inside"===m?n.length:1-n.length))*l}))}),[m,r,s,i,e,d,l,f,o,t]),S.useLayoutEffect((()=>{const e=w;return y.current=[...y.current,...e],()=>{y.current=y.current.filter((e=>e.uuid!==g))}}),[w]),S.useImperativeHandle(h,(()=>v.current),[]),S.createElement("group",M.default({ref:v},p))})),Na=S.forwardRef(((e,t)=>S.useContext(Ua)?S.createElement(Oa,M.default({ref:t},e)):S.createElement(Va,null,S.createElement(Oa,M.default({ref:t},e)))));class ja extends T.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},pixelRatio:{value:1}},vertexShader:"\n        uniform float pixelRatio;\n        uniform float time;\n        attribute float size;  \n        attribute float speed;  \n        attribute float opacity;\n        attribute vec3 noise;\n        attribute vec3 color;\n        varying vec3 vColor;\n        varying float vOpacity;\n\n        void main() {\n          vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n          modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;\n          modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;\n          modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;\n          vec4 viewPosition = viewMatrix * modelPosition;\n          vec4 projectionPostion = projectionMatrix * viewPosition;\n          gl_Position = projectionPostion;\n          gl_PointSize = size * 25. * pixelRatio;\n          gl_PointSize *= (1.0 / - viewPosition.z);\n          vColor = color;\n          vOpacity = opacity;\n        }\n      ",fragmentShader:`\n        varying vec3 vColor;\n        varying float vOpacity;\n        void main() {\n          float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n          float strength = 0.05 / distanceToCenter - 0.1;\n          gl_FragColor = vec4(vColor, strength * vOpacity);\n          #include <tonemapping_fragment>\n          #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n      `})}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}get pixelRatio(){return this.uniforms.pixelRatio.value}set pixelRatio(e){this.uniforms.pixelRatio.value=e}}const Wa=e=>e&&e.constructor===Float32Array,Ga=e=>e instanceof T.Vector2||e instanceof T.Vector3||e instanceof T.Vector4,Ha=e=>Array.isArray(e)?e:Ga(e)?e.toArray():[e,e,e];function $a(e,t,r){return S.useMemo((()=>{if(void 0!==t){if(Wa(t))return t;if(t instanceof T.Color){const r=Array.from({length:3*e},(()=>(e=>[e.r,e.g,e.b])(t))).flat();return Float32Array.from(r)}if(Ga(t)||Array.isArray(t)){const r=Array.from({length:3*e},(()=>Ha(t))).flat();return Float32Array.from(r)}return Float32Array.from({length:e},(()=>t))}return Float32Array.from({length:e},r)}),[t])}const qa=S.forwardRef((({noise:e=1,count:t=100,speed:r=1,opacity:n=1,scale:o=1,size:i,color:s,children:l,...c},u)=>{S.useMemo((()=>a.extend({SparklesImplMaterial:ja})),[]);const d=S.useRef(null),m=a.useThree((e=>e.viewport.dpr)),f=Ha(o),p=S.useMemo((()=>Float32Array.from(Array.from({length:t},(()=>f.map(T.MathUtils.randFloatSpread))).flat())),[t,...f]),h=$a(t,i,Math.random),x=$a(t,n),y=$a(t,r),v=$a(3*t,e),g=$a(void 0===s?3*t:t,Wa(s)?s:new T.Color(s),(()=>1));return a.useFrame((e=>{d.current&&d.current.material&&(d.current.material.time=e.clock.elapsedTime)})),S.useImperativeHandle(u,(()=>d.current),[]),S.createElement("points",M.default({key:`particle-${t}-${JSON.stringify(o)}`},c,{ref:d}),S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[p,3]}),S.createElement("bufferAttribute",{attach:"attributes-size",args:[h,1]}),S.createElement("bufferAttribute",{attach:"attributes-opacity",args:[x,1]}),S.createElement("bufferAttribute",{attach:"attributes-speed",args:[y,1]}),S.createElement("bufferAttribute",{attach:"attributes-color",args:[g,3]}),S.createElement("bufferAttribute",{attach:"attributes-noise",args:[v,3]})),l||S.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:m,depthWrite:!1}))}));function Xa(e=0,t=1024,r){const n=m.suspend((()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/matcaps.json").then((e=>e.json()))),["matcapList"]),a=n[0],o=S.useMemo((()=>Object.keys(n).length),[]),i=`${S.useMemo((()=>"string"==typeof e?e:"number"==typeof e?n[e]:null),[e])||a}${function(e){switch(e){case 64:return"-64px";case 128:return"-128px";case 256:return"-256px";case 512:return"-512px";default:return""}}(t)}.png`,s=`https://rawcdn.githack.com/emmelleppi/matcaps/9b36ccaaf0a24881a39062d05566c9e92be4aa0d/${t}/${i}`;return[Se(s,r),s,o]}function Za(e=0,t={},r){const{repeat:a=[1,1],anisotropy:o=1,offset:i=[0,0]}=t,s=m.suspend((()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/normals/normals.json").then((e=>e.json()))),["normalsList"]),l=S.useMemo((()=>Object.keys(s).length),[]),c=s[0],u=`https://rawcdn.githack.com/pmndrs/drei-assets/7a3104997e1576f83472829815b00880d88b32fb/normals/${s[e]||c}`,d=Se(u,r);return S.useLayoutEffect((()=>{d&&(d.wrapS=d.wrapT=n.RepeatWrapping,d.repeat=new n.Vector2(a[0],a[1]),d.offset=new n.Vector2(i[0],i[1]),d.anisotropy=o)}),[d,o,a,i]),[d,u,l]}const Ya={uniforms:{strokeOpacity:1,fillOpacity:.25,fillMix:0,thickness:.05,colorBackfaces:!1,dashInvert:!0,dash:!1,dashRepeats:4,dashLength:.5,squeeze:!1,squeezeMin:.2,squeezeMax:1,stroke:new T.Color("#ff0000"),backfaceStroke:new T.Color("#0000ff"),fill:new T.Color("#00ff00")},vertex:"\n\t  attribute vec3 barycentric;\n\t\n\t\tvarying vec3 v_edges_Barycentric;\n\t\tvarying vec3 v_edges_Position;\n\n\t\tvoid initWireframe() {\n\t\t\tv_edges_Barycentric = barycentric;\n\t\t\tv_edges_Position = position.xyz;\n\t\t}\n\t  ",fragment:"\n\t\t#ifndef PI\n\t  \t#define PI 3.1415926535897932384626433832795\n\t\t#endif\n  \n\t  varying vec3 v_edges_Barycentric;\n\t  varying vec3 v_edges_Position;\n  \n\t  uniform float strokeOpacity;\n\t  uniform float fillOpacity;\n\t  uniform float fillMix;\n\t  uniform float thickness;\n\t  uniform bool colorBackfaces;\n  \n\t  // Dash\n\t  uniform bool dashInvert;\n\t  uniform bool dash;\n\t  uniform bool dashOnly;\n\t  uniform float dashRepeats;\n\t  uniform float dashLength;\n  \n\t  // Squeeze\n\t  uniform bool squeeze;\n\t  uniform float squeezeMin;\n\t  uniform float squeezeMax;\n  \n\t  // Colors\n\t  uniform vec3 stroke;\n\t  uniform vec3 backfaceStroke;\n\t  uniform vec3 fill;\n  \n\t  // This is like\n\t  float wireframe_aastep(float threshold, float dist) {\n\t\t  float afwidth = fwidth(dist) * 0.5;\n\t\t  return smoothstep(threshold - afwidth, threshold + afwidth, dist);\n\t  }\n  \n\t  float wireframe_map(float value, float min1, float max1, float min2, float max2) {\n\t\t  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n\t  }\n  \n\t  float getWireframe() {\n\t\t\tvec3 barycentric = v_edges_Barycentric;\n\t\t\n\t\t\t// Distance from center of each triangle to its edges.\n\t\t\tfloat d = min(min(barycentric.x, barycentric.y), barycentric.z);\n\n\t\t\t// for dashed rendering, we can use this to get the 0 .. 1 value of the line length\n\t\t\tfloat positionAlong = max(barycentric.x, barycentric.y);\n\t\t\tif (barycentric.y < barycentric.x && barycentric.y < barycentric.z) {\n\t\t\t\tpositionAlong = 1.0 - positionAlong;\n\t\t\t}\n\n\t\t\t// the thickness of the stroke\n\t\t\tfloat computedThickness = wireframe_map(thickness, 0.0, 1.0, 0.0, 0.34);\n\n\t\t\t// if we want to shrink the thickness toward the center of the line segment\n\t\t\tif (squeeze) {\n\t\t\t\tcomputedThickness *= mix(squeezeMin, squeezeMax, (1.0 - sin(positionAlong * PI)));\n\t\t\t}\n\n\t\t\t// Create dash pattern\n\t\t\tif (dash) {\n\t\t\t\t// here we offset the stroke position depending on whether it\n\t\t\t\t// should overlap or not\n\t\t\t\tfloat offset = 1.0 / dashRepeats * dashLength / 2.0;\n\t\t\t\tif (!dashInvert) {\n\t\t\t\t\toffset += 1.0 / dashRepeats / 2.0;\n\t\t\t\t}\n\n\t\t\t\t// if we should animate the dash or not\n\t\t\t\t// if (dashAnimate) {\n\t\t\t\t// \toffset += time * 0.22;\n\t\t\t\t// }\n\n\t\t\t\t// create the repeating dash pattern\n\t\t\t\tfloat pattern = fract((positionAlong + offset) * dashRepeats);\n\t\t\t\tcomputedThickness *= 1.0 - wireframe_aastep(dashLength, pattern);\n\t\t\t}\n\n\t\t\t// compute the anti-aliased stroke edge  \n\t\t\tfloat edge = 1.0 - wireframe_aastep(computedThickness, d);\n\n\t\t\treturn edge;\n\t  }\n\t  "},Qa=Ee(Ya.uniforms,Ya.vertex+"\n  \tvoid main() {\n\t\tinitWireframe();\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t}\n  ",Ya.fragment+"\n  void main () {\n\t\t// Compute color\n\n\t\tfloat edge = getWireframe();\n\t\tvec4 colorStroke = vec4(stroke, edge);\n\n\t\t#ifdef FLIP_SIDED\n\t\t\tcolorStroke.rgb = backfaceStroke;\n\t\t#endif\n    \n\t\tvec4 colorFill = vec4(fill, fillOpacity);\n\t\tvec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n\t\tgl_FragColor = outColor;\n\t}\n  ");function Ka(e){return void 0!==(null==e?void 0:e.current)}function Ja(e){return"WireframeGeometry"===e.type}function eo(e){const t=null!=(r=e)&&r.current?e.current:e;var r;if(function(e){return!(null==e||!e.isBufferGeometry)}(t))return t;{if(Ja(t))throw new Error("Wireframe: WireframeGeometry is not supported.");const e=t.parent;if(function(e){return!(null==e||!e.geometry)}(e)){if(Ja(e.geometry))throw new Error("Wireframe: WireframeGeometry is not supported.");return e.geometry}}}function to(e,t){if(e.index){console.warn("Wireframe: Requires non-indexed geometry, converting to non-indexed geometry.");const t=e.toNonIndexed();e.copy(t),e.setIndex(null)}const r=function(e,t){const r=e.getAttribute("position").count,n=[];for(let e=0;e<r;e++){const r=t?1:0;e%2==0?n.push(0,0,1,0,1,0,1,0,r):n.push(0,1,0,0,0,1,1,0,r)}return new T.BufferAttribute(Float32Array.from(n),3)}(e,t);e.setAttribute("barycentric",r)}function ro({geometry:e,simplify:t=!1,...r}){a.extend({MeshWireframeMaterial:Qa});const[n,o]=S.useState(null);S.useLayoutEffect((()=>{const r=eo(e);if(!r)throw new Error("Wireframe: geometry prop must be a BufferGeometry or a ref to a BufferGeometry.");to(r,t),Ka(e)&&o(r)}),[t,e]);const i=Ka(e)?n:e;return S.createElement(S.Fragment,null,i&&S.createElement("mesh",{geometry:i},S.createElement("meshWireframeMaterial",M.default({attach:"material",transparent:!0,side:T.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4},r,{extensions:{derivatives:!0,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1}}))))}function no({simplify:e=!1,...t}){const r=S.useRef(null),n=S.useMemo((()=>function(){const e={};for(const t in Ya.uniforms)e[t]={value:Ya.uniforms[t]};return e}()),[Ya.uniforms]);return function(e,t){S.useEffect((()=>{var r;e.fillOpacity.value=null!==(r=t.fillOpacity)&&void 0!==r?r:e.fillOpacity.value}),[t.fillOpacity]),S.useEffect((()=>{var r;e.fillMix.value=null!==(r=t.fillMix)&&void 0!==r?r:e.fillMix.value}),[t.fillMix]),S.useEffect((()=>{var r;e.strokeOpacity.value=null!==(r=t.strokeOpacity)&&void 0!==r?r:e.strokeOpacity.value}),[t.strokeOpacity]),S.useEffect((()=>{var r;e.thickness.value=null!==(r=t.thickness)&&void 0!==r?r:e.thickness.value}),[t.thickness]),S.useEffect((()=>{e.colorBackfaces.value=!!t.colorBackfaces}),[t.colorBackfaces]),S.useEffect((()=>{e.dash.value=!!t.dash}),[t.dash]),S.useEffect((()=>{e.dashInvert.value=!!t.dashInvert}),[t.dashInvert]),S.useEffect((()=>{var r;e.dashRepeats.value=null!==(r=t.dashRepeats)&&void 0!==r?r:e.dashRepeats.value}),[t.dashRepeats]),S.useEffect((()=>{var r;e.dashLength.value=null!==(r=t.dashLength)&&void 0!==r?r:e.dashLength.value}),[t.dashLength]),S.useEffect((()=>{e.squeeze.value=!!t.squeeze}),[t.squeeze]),S.useEffect((()=>{var r;e.squeezeMin.value=null!==(r=t.squeezeMin)&&void 0!==r?r:e.squeezeMin.value}),[t.squeezeMin]),S.useEffect((()=>{var r;e.squeezeMax.value=null!==(r=t.squeezeMax)&&void 0!==r?r:e.squeezeMax.value}),[t.squeezeMax]),S.useEffect((()=>{e.stroke.value=t.stroke?new T.Color(t.stroke):e.stroke.value}),[t.stroke]),S.useEffect((()=>{e.fill.value=t.fill?new T.Color(t.fill):e.fill.value}),[t.fill]),S.useEffect((()=>{e.backfaceStroke.value=t.backfaceStroke?new T.Color(t.backfaceStroke):e.backfaceStroke.value}),[t.backfaceStroke])}(n,t),S.useLayoutEffect((()=>{const t=eo(r);if(!t)throw new Error("Wireframe: Must be a child of a Mesh, Line or Points object or specify a geometry prop.");const n=t.clone();return to(t,e),()=>{t.copy(n),n.dispose()}}),[e]),S.useLayoutEffect((()=>{const e=r.current.parent,t=e.material.clone();return function(e,t){e.onBeforeCompile=e=>{e.uniforms={...e.uniforms,...t},e.vertexShader=e.vertexShader.replace("void main() {",`\n\t\t  ${Ya.vertex}\n\t\t  void main() {\n\t\t\tinitWireframe();\n\t\t`),e.fragmentShader=e.fragmentShader.replace("void main() {",`\n\t\t  ${Ya.fragment}\n\t\t  void main() {\n\t\t`),e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","\n\t\t  #include <color_fragment>\n\t\t\t  float edge = getWireframe();\n\t\t  vec4 colorStroke = vec4(stroke, edge);\n\t\t  #ifdef FLIP_SIDED\n\t\t\tcolorStroke.rgb = backfaceStroke;\n\t\t  #endif\n\t\t  vec4 colorFill = vec4(mix(diffuseColor.rgb, fill, fillMix), mix(diffuseColor.a, fillOpacity, fillMix));\n\t\t  vec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n\t\t  diffuseColor.rgb = outColor.rgb;\n\t\t  diffuseColor.a *= outColor.a;\n\t\t")},e.side=T.DoubleSide,e.transparent=!0}(e.material,n),()=>{e.material.dispose(),e.material=t}}),[]),S.createElement("object3D",{ref:r})}const ao=new T.Matrix4,oo=new T.Ray,io=new T.Sphere,so=new T.Vector3;class lo extends T.Group{constructor(){super(),this.size=0,this.color=new T.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){var r,n;const a=this.instance.current;if(!a||!a.geometry)return;const o=a.userData.instances.indexOf(this.instanceKey);if(-1===o||o>a.geometry.drawRange.count)return;const i=null!==(r=null==(n=e.params.Points)?void 0:n.threshold)&&void 0!==r?r:1;if(io.set(this.getWorldPosition(so),i),!1===e.ray.intersectsSphere(io))return;ao.copy(a.matrixWorld).invert(),oo.copy(e.ray).applyMatrix4(ao);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,c=oo.distanceSqToPoint(this.position);if(c<l){const r=new T.Vector3;oo.closestPointToPoint(this.position,r),r.applyMatrix4(this.matrixWorld);const n=e.ray.origin.distanceTo(r);if(n<e.near||n>e.far)return;t.push({distance:n,distanceToRay:Math.sqrt(c),point:r,index:o,face:null,object:this})}}}let co,uo;const mo=S.createContext(null),fo=new T.Matrix4,po=new T.Vector3,ho=S.forwardRef((({children:e,range:t,limit:r=1e3,...n},o)=>{const i=S.useRef(null);S.useImperativeHandle(o,(()=>i.current),[]);const[s,l]=S.useState([]),[[c,u,d]]=S.useState((()=>[new Float32Array(3*r),Float32Array.from({length:3*r},(()=>1)),Float32Array.from({length:r},(()=>1))]));S.useEffect((()=>{i.current.geometry.attributes.position.needsUpdate=!0})),a.useFrame((()=>{for(i.current.updateMatrix(),i.current.updateMatrixWorld(),fo.copy(i.current.matrixWorld).invert(),i.current.geometry.drawRange.count=Math.min(r,void 0!==t?t:r,s.length),co=0;co<s.length;co++)uo=s[co].current,uo.getWorldPosition(po).applyMatrix4(fo),po.toArray(c,3*co),i.current.geometry.attributes.position.needsUpdate=!0,uo.matrixWorldNeedsUpdate=!0,uo.color.toArray(u,3*co),i.current.geometry.attributes.color.needsUpdate=!0,d.set([uo.size],co),i.current.geometry.attributes.size.needsUpdate=!0}));const m=S.useMemo((()=>({getParent:()=>i,subscribe:e=>(l((t=>[...t,e])),()=>l((t=>t.filter((t=>t.current!==e.current)))))})),[]);return S.createElement("points",M.default({userData:{instances:s},matrixAutoUpdate:!1,ref:i,raycast:()=>null},n),S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[c,3],usage:T.DynamicDrawUsage}),S.createElement("bufferAttribute",{attach:"attributes-color",args:[u,3],usage:T.DynamicDrawUsage}),S.createElement("bufferAttribute",{attach:"attributes-size",args:[d,1],usage:T.DynamicDrawUsage})),S.createElement(mo.Provider,{value:m},e))})),xo=S.forwardRef((({children:e,...t},r)=>{S.useMemo((()=>a.extend({PositionPoint:lo})),[]);const n=S.useRef(null);S.useImperativeHandle(r,(()=>n.current),[]);const{subscribe:o,getParent:i}=S.useContext(mo);return S.useLayoutEffect((()=>o(n)),[]),S.createElement("positionPoint",M.default({instance:i(),instanceKey:n,ref:n},t),e)})),yo=S.forwardRef((({children:e,positions:t,colors:r,sizes:n,stride:o=3,...i},s)=>{const l=S.useRef(null);return S.useImperativeHandle(s,(()=>l.current),[]),a.useFrame((()=>{const e=l.current.geometry.attributes;e.position.needsUpdate=!0,r&&(e.color.needsUpdate=!0),n&&(e.size.needsUpdate=!0)})),S.createElement("points",M.default({ref:l},i),S.createElement("bufferGeometry",null,S.createElement("bufferAttribute",{attach:"attributes-position",args:[t,o],usage:T.DynamicDrawUsage}),r&&S.createElement("bufferAttribute",{attach:"attributes-color",args:[r,o],count:r.length/o,usage:T.DynamicDrawUsage}),n&&S.createElement("bufferAttribute",{attach:"attributes-size",args:[n,1],count:n.length/o,usage:T.DynamicDrawUsage})),e)})),vo=S.forwardRef(((e,t)=>e.positions instanceof Float32Array?S.createElement(yo,M.default({},e,{ref:t})):S.createElement(ho,M.default({},e,{ref:t})))),go=S.createContext(null),wo=S.forwardRef(((e,t)=>{S.useMemo((()=>a.extend({SegmentObject:zo})),[]);const{limit:r=1e3,lineWidth:n=1,children:o,...i}=e,[s,l]=S.useState([]),[u]=S.useState((()=>new c.Line2)),[d]=S.useState((()=>new c.LineMaterial)),[m]=S.useState((()=>new c.LineSegmentsGeometry)),[f]=S.useState((()=>new T.Vector2(512,512))),[p]=S.useState((()=>Array(6*r).fill(0))),[h]=S.useState((()=>Array(6*r).fill(0))),x=S.useMemo((()=>({subscribe:e=>(l((t=>[...t,e])),()=>l((t=>t.filter((t=>t.current!==e.current)))))})),[]);return a.useFrame((()=>{for(let t=0;t<r;t++){var e;const r=null==(e=s[t])?void 0:e.current;r&&(p[6*t+0]=r.start.x,p[6*t+1]=r.start.y,p[6*t+2]=r.start.z,p[6*t+3]=r.end.x,p[6*t+4]=r.end.y,p[6*t+5]=r.end.z,h[6*t+0]=r.color.r,h[6*t+1]=r.color.g,h[6*t+2]=r.color.b,h[6*t+3]=r.color.r,h[6*t+4]=r.color.g,h[6*t+5]=r.color.b)}m.setColors(h),m.setPositions(p),u.computeLineDistances()})),S.createElement("primitive",{object:u,ref:t},S.createElement("primitive",{object:m,attach:"geometry"}),S.createElement("primitive",M.default({object:d,attach:"material",vertexColors:!0,resolution:f,linewidth:n},i)),S.createElement(go.Provider,{value:x},o))}));class zo{constructor(){this.color=new T.Color("white"),this.start=new T.Vector3(0,0,0),this.end=new T.Vector3(0,0,0)}}const bo=e=>e instanceof T.Vector3?e:new T.Vector3(..."number"==typeof e?[e,e,e]:e),Eo=S.forwardRef((({color:e,start:t,end:r},n)=>{const a=S.useContext(go);if(!a)throw"Segment must used inside Segments component.";const o=S.useRef(null);return S.useImperativeHandle(n,(()=>o.current),[]),S.useLayoutEffect((()=>a.subscribe(o)),[]),S.createElement("segmentObject",{ref:o,color:e,start:bo(t),end:bo(r)})})),Mo=S.forwardRef((({children:e,hysteresis:t=0,distances:r,...n},o)=>{const i=S.useRef(null);return S.useImperativeHandle(o,(()=>i.current),[]),S.useLayoutEffect((()=>{const{current:e}=i;e.levels.length=0,e.children.forEach(((n,a)=>e.levels.push({object:n,hysteresis:t,distance:r[a]})))})),a.useFrame((e=>{var t;return null==(t=i.current)?void 0:t.update(e.camera)})),S.createElement("lOD",M.default({ref:i},n),e)}));const So=new n.Matrix4,Co=new n.Ray,To=new n.Sphere,Po=new n.Vector3;const Ro=t.createContext(null);const Do=S.forwardRef((({children:e,compute:t,width:r,height:n,samples:o=8,renderPriority:i=0,eventPriority:s=0,frames:l=1/0,stencilBuffer:c=!1,depthBuffer:u=!0,generateMipmaps:d=!1,...m},f)=>{const{size:p,viewport:h}=a.useThree(),x=rt((r||p.width)*h.dpr,(n||p.height)*h.dpr,{samples:o,stencilBuffer:c,depthBuffer:u,generateMipmaps:d}),[y]=S.useState((()=>new T.Scene)),v=S.useCallback(((e,t,r)=>{var n,a;let o=null==(n=x.texture)||null==(n=n.__r3f.parent)?void 0:n.object;for(;o&&!(o instanceof T.Object3D);){var i;o=null==(i=o.__r3f.parent)?void 0:i.object}if(!o)return!1;r.raycaster.camera||r.events.compute(e,r,null==(a=r.previousRoot)?void 0:a.getState());const[s]=r.raycaster.intersectObject(o);if(!s)return!1;const l=s.uv;if(!l)return!1;t.raycaster.setFromCamera(t.pointer.set(2*l.x-1,2*l.y-1),t.camera)}),[]);return S.useImperativeHandle(f,(()=>x.texture),[x]),S.createElement(S.Fragment,null,a.createPortal(S.createElement(Fo,{renderPriority:i,frames:l,fbo:x},e,S.createElement("group",{onPointerOver:()=>null})),y,{events:{compute:t||v,priority:s}}),S.createElement("primitive",M.default({object:x.texture},m)))}));function Fo({frames:e,renderPriority:t,children:r,fbo:n}){let o,i,s,l,c=0;return a.useFrame((t=>{(e===1/0||c<e)&&(o=t.gl.autoClear,i=t.gl.xr.enabled,s=t.gl.getRenderTarget(),l=t.gl.xr.isPresenting,t.gl.autoClear=!0,t.gl.xr.enabled=!1,t.gl.xr.isPresenting=!1,t.gl.setRenderTarget(n),t.gl.render(t.scene,t.camera),t.gl.setRenderTarget(s),t.gl.autoClear=o,t.gl.xr.enabled=i,t.gl.xr.isPresenting=l,c++)}),t),S.createElement(S.Fragment,null,r)}const ko=S.forwardRef((({children:e,compute:t,renderPriority:r=-1,eventPriority:n=0,frames:o=1/0,stencilBuffer:i=!1,depthBuffer:s=!0,generateMipmaps:l=!1,resolution:c=896,near:u=.1,far:d=1e3,flip:m=!1,position:f,rotation:p,scale:h,quaternion:x,matrix:y,matrixAutoUpdate:v,...g},w)=>{const{size:z,viewport:b}=a.useThree(),E=S.useRef(null),C=S.useMemo((()=>{const e=new T.WebGLCubeRenderTarget(Math.max((c||z.width)*b.dpr,(c||z.height)*b.dpr),{stencilBuffer:i,depthBuffer:s,generateMipmaps:l});return e.texture.isRenderTargetTexture=!m,e.texture.flipY=!0,e.texture.type=T.HalfFloatType,e}),[c,m]);S.useEffect((()=>()=>C.dispose()),[C]);const[P]=S.useState((()=>new T.Scene));return S.useImperativeHandle(w,(()=>({scene:P,fbo:C,camera:E.current})),[C]),S.createElement(S.Fragment,null,a.createPortal(S.createElement(_o,{renderPriority:r,frames:o,camera:E},e,S.createElement("group",{onPointerOver:()=>null})),P,{events:{compute:t,priority:n}}),S.createElement("primitive",M.default({object:C.texture},g)),S.createElement("cubeCamera",{ref:E,args:[u,d,C],position:f,rotation:p,scale:h,quaternion:x,matrix:y,matrixAutoUpdate:v}))}));function _o({frames:e,renderPriority:t,children:r,camera:n}){let o=0;return a.useFrame((t=>{(e===1/0||o<e)&&(n.current.update(t.gl,t.scene),o++)}),t),S.createElement(S.Fragment,null,r)}const Ao=S.forwardRef((({id:e=1,colorWrite:t=!1,depthWrite:r=!1,...n},a)=>{const o=S.useRef(null),i=S.useMemo((()=>({colorWrite:t,depthWrite:r,stencilWrite:!0,stencilRef:e,stencilFunc:T.AlwaysStencilFunc,stencilFail:T.ReplaceStencilOp,stencilZFail:T.ReplaceStencilOp,stencilZPass:T.ReplaceStencilOp})),[e,t,r]);return S.useLayoutEffect((()=>{Object.assign(o.current.material,i)})),S.useImperativeHandle(a,(()=>o.current),[]),S.createElement("mesh",M.default({ref:o,renderOrder:-e},n))}));function Lo({api:e}){const t=new T.Vector3,r=new T.Quaternion,n=new T.Vector3,o=new T.Euler(0,Math.PI,0);return a.useFrame((a=>{a.camera.matrixWorld.decompose(t,r,n),e.current.camera.position.copy(t),e.current.camera.quaternion.setFromEuler(o).premultiply(r)})),null}const Io=Ee({blur:0,map:null,sdf:null,blend:0,size:0,resolution:new T.Vector2},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n     vUv = uv;\n   }",`uniform sampler2D sdf;\n   uniform sampler2D map;\n   uniform float blur;\n   uniform float size;\n   uniform float time;\n   uniform vec2 resolution;\n   varying vec2 vUv;\n   #include <packing>\n   void main() {\n     vec2 uv = gl_FragCoord.xy / resolution.xy;\n     vec4 t = texture2D(map, uv);\n     float k = blur;\n     float d = texture2D(sdf, vUv).r/size;\n     float alpha = 1.0 - smoothstep(0.0, 1.0, clamp(d/k + 1.0, 0.0, 1.0));\n     gl_FragColor = vec4(t.rgb, blur == 0.0 ? t.a : t.a * alpha);\n     #include <tonemapping_fragment>\n     #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n   }`),Bo=S.forwardRef((({children:e,events:t,blur:r=0,eventPriority:n=0,renderPriority:o=0,worldUnits:i=!1,resolution:s=512,...l},c)=>{a.extend({PortalMaterialImpl:Io});const u=S.useRef(null),{scene:d,gl:m,size:f,viewport:p,setEvents:h}=a.useThree(),x=rt(s,s),[y,v]=S.useState(0);a.useFrame((()=>{const e=u.current.blend>0?Math.max(1,o):0;y!==e&&v(e)})),S.useEffect((()=>{void 0!==t&&h({enabled:!t})}),[t]);const[g,w]=S.useState(!0),z=pr(w);S.useLayoutEffect((()=>{var e;z.current=null==(e=u.current)||null==(e=e.__r3f.parent)?void 0:e.object}),[]),S.useLayoutEffect((()=>{if(z.current&&r&&null===u.current.sdf){const e=new T.Mesh(z.current.geometry,new T.MeshBasicMaterial),t=(new T.Box3).setFromBufferAttribute(e.geometry.attributes.position),r=new T.OrthographicCamera(t.min.x*(1+2/s),t.max.x*(1+2/s),t.max.y*(1+2/s),t.min.y*(1+2/s),.1,1e3);r.position.set(0,0,1),r.lookAt(0,0,0),m.setRenderTarget(x),m.render(e,r);const n=Vo(s,s,m)(x.texture),a=new Float32Array(s*s);m.readRenderTargetPixels(n,0,0,s,s,a);let o=1/0;for(let e=0;e<a.length;e++)a[e]<o&&(o=a[e]);o=-o,u.current.size=o,u.current.sdf=n.texture,m.setRenderTarget(null)}}),[s,r]),S.useImperativeHandle(c,(()=>u.current));const b=S.useCallback(((e,t,r)=>{var n;if(!z.current)return!1;if(t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera),0===(null==(n=u.current)?void 0:n.blend)){const[e]=t.raycaster.intersectObject(z.current);if(!e)return t.raycaster.camera=void 0,!1}}),[]);return S.createElement("portalMaterialImpl",M.default({ref:u,blur:r,blend:0,resolution:[f.width*p.dpr,f.height*p.dpr],attach:"material"},l),S.createElement(Do,{attach:"map",frames:g?1/0:0,eventPriority:n,renderPriority:o,compute:b},e,S.createElement(Uo,{events:t,rootScene:d,priority:y,material:u,worldUnits:i})))}));function Uo({events:e,rootScene:t,material:r,priority:n,worldUnits:o}){const i=a.useThree((e=>e.scene)),s=a.useThree((e=>e.setEvents)),l=rt(),u=rt();S.useLayoutEffect((()=>{i.matrixAutoUpdate=!1}),[]),S.useEffect((()=>{void 0!==e&&s({enabled:e})}),[e]);const[d,m]=S.useMemo((()=>{const e={value:0};return[new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{a:{value:l.texture},b:{value:u.texture},blend:e},vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n          }",fragmentShader:`\n          uniform sampler2D a;\n          uniform sampler2D b;\n          uniform float blend;\n          varying vec2 vUv;\n          #include <packing>\n          void main() {\n            vec4 ta = texture2D(a, vUv);\n            vec4 tb = texture2D(b, vUv);\n            gl_FragColor = mix(tb, ta, blend);\n            #include <tonemapping_fragment>\n            #include <${Ce>=154?"colorspace_fragment":"encodings_fragment"}>\n          }`})),e]}),[]);return a.useFrame((e=>{var a;let s=null==r||null==(a=r.current)||null==(a=a.__r3f.parent)?void 0:a.object;if(s){var c,f,p,h;if(o)i.matrixWorld.identity();else n&&1===(null==(c=r.current)?void 0:c.blend)&&s.updateWorldMatrix(!0,!1),i.matrixWorld.copy(s.matrixWorld);if(n)(null==(f=r.current)?void 0:f.blend)>0&&(null==(p=r.current)?void 0:p.blend)<1?(m.value=r.current.blend,e.gl.setRenderTarget(l),e.gl.render(i,e.camera),e.gl.setRenderTarget(u),e.gl.render(t,e.camera),e.gl.setRenderTarget(null),d.render(e.gl)):1===(null==(h=r.current)?void 0:h.blend)&&e.gl.render(i,e.camera)}}),n),S.createElement(S.Fragment,null)}const Vo=(e,t,r)=>{let n=new T.WebGLRenderTarget(e,t,{minFilter:T.LinearMipmapLinearFilter,magFilter:T.LinearFilter,type:T.FloatType,format:T.RedFormat,generateMipmaps:!0}),a=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),o=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),i=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),s=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter}),l=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter,type:T.FloatType,format:T.RedFormat}),u=new T.WebGLRenderTarget(e,t,{minFilter:T.NearestFilter,magFilter:T.NearestFilter,type:T.FloatType,format:T.RedFormat});const d=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (round(texture2D(tex, vUv).x)));\n        }"})),m=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (1.0 - round(texture2D(tex, vUv).x)));\n        }"})),f=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null},offset:{value:0},level:{value:0},maxSteps:{value:0}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:`\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform float offset;\n        uniform float level;\n        uniform float maxSteps;\n        #include <packing>\n        void main() {\n          float closestDist = 9999999.9;\n          vec2 closestPos = vec2(0.0);\n          for (float x = -1.0; x <= 1.0; x += 1.0) {\n            for (float y = -1.0; y <= 1.0; y += 1.0) {\n              vec2 voffset = vUv;\n              voffset += vec2(x, y) * vec2(${1/e}, ${1/t}) * offset;\n              vec2 pos = unpackRGBATo2Half(texture2D(tex, voffset));\n              float dist = distance(pos.xy, vUv);\n              if(pos.x != 0.0 && pos.y != 0.0 && dist < closestDist) {\n                closestDist = dist;\n                closestPos = pos;\n              }\n            }\n          }\n          gl_FragColor = pack2HalfToRGBA(closestPos);\n        }`})),p=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{tex:{value:null},size:{value:new T.Vector2(e,t)}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform vec2 size;\n        #include <packing>\n        void main() {\n          gl_FragColor = vec4(distance(size * unpackRGBATo2Half(texture2D(tex, vUv)), size * vUv), 0.0, 0.0, 0.0);\n        }"})),h=new c.FullScreenQuad(new T.ShaderMaterial({uniforms:{inside:{value:u.texture},outside:{value:l.texture},tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D inside;\n        uniform sampler2D outside;\n        uniform sampler2D tex;\n        #include <packing>\n        void main() {\n          float i = texture2D(inside, vUv).x;\n          float o =texture2D(outside, vUv).x;\n          if (texture2D(tex, vUv).x == 0.0) {\n            gl_FragColor = vec4(o, 0.0, 0.0, 0.0);\n          } else {\n            gl_FragColor = vec4(-i, 0.0, 0.0, 0.0);\n          }\n        }"}));return c=>{let x=n;c.minFilter=T.NearestFilter,c.magFilter=T.NearestFilter,d.material.uniforms.tex.value=c,r.setRenderTarget(a),d.render(r);const y=Math.ceil(Math.log(Math.max(e,t))/Math.log(2));let v=a,g=null;for(let e=0;e<y;e++){const t=Math.pow(2,y-e-1);g=v===a?i:a,f.material.uniforms.level.value=e,f.material.uniforms.maxSteps.value=y,f.material.uniforms.offset.value=t,f.material.uniforms.tex.value=v.texture,r.setRenderTarget(g),f.render(r),v=g}r.setRenderTarget(l),p.material.uniforms.tex.value=g.texture,p.render(r),m.material.uniforms.tex.value=c,r.setRenderTarget(o),m.render(r),v=o;for(let e=0;e<y;e++){const t=Math.pow(2,y-e-1);g=v===o?s:o,f.material.uniforms.level.value=e,f.material.uniforms.maxSteps.value=y,f.material.uniforms.offset.value=t,f.material.uniforms.tex.value=v.texture,r.setRenderTarget(g),f.render(r),v=g}return r.setRenderTarget(u),p.material.uniforms.tex.value=g.texture,p.render(r),r.setRenderTarget(x),h.material.uniforms.tex.value=c,h.render(r),r.setRenderTarget(null),x}},Oo=new T.Color,No=F.default();function jo(e,t){const{right:r,top:n,left:a,bottom:o,width:i,height:s}=t,l=t.bottom<0||n>e.height||r<0||t.left>e.width,c=e.top+e.height-o;return{position:{width:i,height:s,left:a-e.left,top:n,bottom:c,right:r},isOffscreen:l}}function Wo(e,{left:t,bottom:r,width:n,height:a}){let o;const i=n/a;var s;return(s=e.camera)&&s.isOrthographicCamera?e.camera.manual?e.camera.updateProjectionMatrix():e.camera.left===n/-2&&e.camera.right===n/2&&e.camera.top===a/2&&e.camera.bottom===a/-2||(Object.assign(e.camera,{left:n/-2,right:n/2,top:a/2,bottom:a/-2}),e.camera.updateProjectionMatrix()):e.camera.aspect!==i&&(e.camera.aspect=i,e.camera.updateProjectionMatrix()),o=e.gl.autoClear,e.gl.autoClear=!1,e.gl.setViewport(t,r,n,a),e.gl.setScissor(t,r,n,a),e.gl.setScissorTest(!0),o}function Go(e,t){e.gl.setScissorTest(!1),e.gl.autoClear=t}function Ho(e){e.gl.getClearColor(Oo),e.gl.setClearColor(Oo,e.gl.getClearAlpha()),e.gl.clear(!0,!0)}function $o({visible:e=!0,canvasSize:t,scene:r,index:n,children:o,frames:i,rect:s,track:l}){const c=a.useThree(),[u,d]=S.useState(!1);let m=0;return a.useFrame((n=>{var a;(i===1/0||m<=i)&&(l&&(s.current=null==(a=l.current)?void 0:a.getBoundingClientRect()),m++);if(s.current){const{position:a,isOffscreen:i}=jo(t,s.current);if(u!==i&&d(i),e&&!u&&s.current){const e=Wo(n,a);n.gl.render(o?n.scene:r,n.camera),Go(n,e)}}}),n),S.useLayoutEffect((()=>{const r=s.current;if(r&&(!e||!u)){const{position:e}=jo(t,r),n=Wo(c,e);Ho(c),Go(c,n)}}),[e,u]),S.useEffect((()=>{if(!l)return;const e=s.current,r=c.get().events.connected;return c.setEvents({connected:l.current}),()=>{if(e){const{position:r}=jo(t,e),n=Wo(c,r);Ho(c),Go(c,n)}c.setEvents({connected:r})}}),[l]),S.createElement(S.Fragment,null,o,S.createElement("group",{onPointerOver:()=>null}))}const qo=S.forwardRef((({track:e,visible:t=!0,index:r=1,id:n,style:o,className:i,frames:s=1/0,children:l,...c},u)=>{var d,m,f,p;const h=S.useRef(null),{size:x,scene:y}=a.useThree(),[v]=S.useState((()=>new T.Scene)),[g,w]=S.useReducer((()=>!0),!1),z=S.useCallback(((t,r)=>{if(h.current&&e&&e.current&&t.target===e.current){const{width:e,height:n,left:a,top:o}=h.current,i=t.clientX-a,s=t.clientY-o;r.pointer.set(i/e*2-1,-s/n*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)}}),[h,e]);return S.useEffect((()=>{var t;e&&(h.current=null==(t=e.current)?void 0:t.getBoundingClientRect()),w()}),[e]),S.createElement("group",M.default({ref:u},c),g&&a.createPortal(S.createElement($o,{visible:t,canvasSize:x,frames:s,scene:y,track:e,rect:h,index:r},l),v,{events:{compute:z,priority:r},size:{width:null==(d=h.current)?void 0:d.width,height:null==(m=h.current)?void 0:m.height,top:null==(f=h.current)?void 0:f.top,left:null==(p=h.current)?void 0:p.left}}))})),Xo=S.forwardRef((({as:e="div",id:t,visible:r,className:n,style:a,index:o=1,track:i,frames:s=1/0,children:l,...c},u)=>{const d=S.useId(),m=S.useRef(null);return S.useImperativeHandle(u,(()=>m.current)),S.createElement(S.Fragment,null,S.createElement(e,M.default({ref:m,id:t,className:n,style:a},c)),S.createElement(No.In,null,S.createElement(qo,{visible:r,key:d,track:m,frames:s,index:o},l)))})),Zo=(()=>{const e=S.forwardRef(((e,t)=>S.useContext(a.context)?S.createElement(qo,M.default({ref:t},e)):S.createElement(Xo,M.default({ref:t},e))));return e.Port=()=>S.createElement(No.Out,null),e})(),Yo=S.createContext(null),Qo=new T.Vector3,Ko=new T.Vector3,Jo=new T.Vector3(0,1,0),ei=new T.Matrix4,ti=({direction:e,axis:t})=>{const{translation:r,translationLimits:n,annotations:o,annotationsClass:i,depthTest:s,scale:l,lineWidth:c,fixed:u,axisColors:d,hoveredColor:m,opacity:f,renderOrder:p,onDragStart:h,onDrag:x,onDragEnd:y,userData:v}=S.useContext(Yo),g=a.useThree((e=>e.controls)),w=S.useRef(null),z=S.useRef(null),b=S.useRef(null),E=S.useRef(0),[M,C]=S.useState(!1),P=S.useCallback((n=>{o&&(w.current.innerText=`${r.current[t].toFixed(2)}`,w.current.style.display="block"),n.stopPropagation();const a=(new T.Matrix4).extractRotation(z.current.matrixWorld),i=n.point.clone(),s=(new T.Vector3).setFromMatrixPosition(z.current.matrixWorld),l=e.clone().applyMatrix4(a).normalize();b.current={clickPoint:i,dir:l},E.current=r.current[t],h({component:"Arrow",axis:t,origin:s,directions:[l]}),g&&(g.enabled=!1),n.target.setPointerCapture(n.pointerId)}),[o,e,g,h,r,t]),R=S.useCallback((e=>{if(e.stopPropagation(),M||C(!0),b.current){const{clickPoint:a,dir:i}=b.current,[s,l]=(null==n?void 0:n[t])||[void 0,void 0];let c=((e,t,r,n)=>{const a=t.dot(t),o=t.dot(e)-t.dot(r),i=t.dot(n);return 0===i?-o/a:(Qo.copy(n).multiplyScalar(a/i).sub(t),Ko.copy(n).multiplyScalar(o/i).add(r).sub(e),-Qo.dot(Ko)/Qo.dot(Qo))})(a,i,e.ray.origin,e.ray.direction);void 0!==s&&(c=Math.max(c,s-E.current)),void 0!==l&&(c=Math.min(c,l-E.current)),r.current[t]=E.current+c,o&&(w.current.innerText=`${r.current[t].toFixed(2)}`),ei.makeTranslation(i.x*c,i.y*c,i.z*c),x(ei)}}),[o,x,M,r,n,t]),D=S.useCallback((e=>{o&&(w.current.style.display="none"),e.stopPropagation(),b.current=null,y(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[o,g,y]),F=S.useCallback((e=>{e.stopPropagation(),C(!1)}),[]),{cylinderLength:k,coneWidth:_,coneLength:A,matrixL:L}=S.useMemo((()=>{const t=u?c/l*1.6:l/20,r=u?.2:l/5,n=u?1-r:l-r,a=(new T.Quaternion).setFromUnitVectors(Jo,e.clone().normalize());return{cylinderLength:n,coneWidth:t,coneLength:r,matrixL:(new T.Matrix4).makeRotationFromQuaternion(a)}}),[e,l,c,u]),I=M?m:d[t];return S.createElement("group",{ref:z},S.createElement("group",{matrix:L,matrixAutoUpdate:!1,onPointerDown:P,onPointerMove:R,onPointerUp:D,onPointerOut:F},o&&S.createElement(j,{position:[0,-A,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:i,ref:w})),S.createElement("mesh",{visible:!1,position:[0,(k+A)/2,0],userData:v},S.createElement("cylinderGeometry",{args:[1.4*_,1.4*_,k+A,8,1]})),S.createElement(ce,{transparent:!0,raycast:()=>null,depthTest:s,points:[0,0,0,0,k,0],lineWidth:c,side:T.DoubleSide,color:I,opacity:f,polygonOffset:!0,renderOrder:p,polygonOffsetFactor:-10,fog:!1}),S.createElement("mesh",{raycast:()=>null,position:[0,k+A/2,0],renderOrder:p},S.createElement("coneGeometry",{args:[_,A,24,1]}),S.createElement("meshBasicMaterial",{transparent:!0,depthTest:s,color:I,opacity:f,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},ri=new T.Vector3,ni=new T.Vector3,ai=e=>180*e/Math.PI,oi=e=>{let t=((e,t)=>{let r=Math.floor(e/t);return r=r<0?r+1:r,e-r*t})(e,2*Math.PI);return Math.abs(t)<1e-6?0:(t<0&&(t+=2*Math.PI),t)},ii=new T.Matrix4,si=new T.Vector3,li=new T.Ray,ci=new T.Vector3,ui=({dir1:e,dir2:t,axis:r})=>{const{rotationLimits:n,annotations:o,annotationsClass:i,depthTest:s,scale:l,lineWidth:c,fixed:u,axisColors:d,hoveredColor:m,renderOrder:f,opacity:p,onDragStart:h,onDrag:x,onDragEnd:y,userData:v}=S.useContext(Yo),g=a.useThree((e=>e.controls)),w=S.useRef(null),z=S.useRef(null),b=S.useRef(0),E=S.useRef(0),M=S.useRef(null),[C,P]=S.useState(!1),R=S.useCallback((e=>{o&&(w.current.innerText=`${ai(E.current).toFixed(0)}º`,w.current.style.display="block"),e.stopPropagation();const t=e.point.clone(),n=(new T.Vector3).setFromMatrixPosition(z.current.matrixWorld),a=(new T.Vector3).setFromMatrixColumn(z.current.matrixWorld,0).normalize(),i=(new T.Vector3).setFromMatrixColumn(z.current.matrixWorld,1).normalize(),s=(new T.Vector3).setFromMatrixColumn(z.current.matrixWorld,2).normalize(),l=(new T.Plane).setFromNormalAndCoplanarPoint(s,n);M.current={clickPoint:t,origin:n,e1:a,e2:i,normal:s,plane:l},h({component:"Rotator",axis:r,origin:n,directions:[a,i,s]}),g&&(g.enabled=!1),e.target.setPointerCapture(e.pointerId)}),[o,g,h,r]),D=S.useCallback((e=>{if(e.stopPropagation(),C||P(!0),M.current){const{clickPoint:t,origin:a,e1:i,e2:s,normal:l,plane:c}=M.current,[u,d]=(null==n?void 0:n[r])||[void 0,void 0];li.copy(e.ray),li.intersectPlane(c,ci),li.direction.negate(),li.intersectPlane(c,ci);let m=((e,t,r,n,a)=>{ri.copy(e).sub(r),ni.copy(t).sub(r);const o=n.dot(n),i=a.dot(a),s=ri.dot(n)/o,l=ri.dot(a)/i,c=ni.dot(n)/o,u=ni.dot(a)/i,d=Math.atan2(l,s);return Math.atan2(u,c)-d})(t,ci,a,i,s),f=ai(m);e.shiftKey&&(f=10*Math.round(f/10),m=(e=>e*Math.PI/180)(f)),void 0!==u&&void 0!==d&&d-u<2*Math.PI?(m=oi(m),m=m>Math.PI?m-2*Math.PI:m,m=T.MathUtils.clamp(m,u-b.current,d-b.current),E.current=b.current+m):(E.current=oi(b.current+m),E.current=E.current>Math.PI?E.current-2*Math.PI:E.current),o&&(f=ai(E.current),w.current.innerText=`${f.toFixed(0)}º`),ii.makeRotationAxis(l,m),si.copy(a).applyMatrix4(ii).sub(a).negate(),ii.setPosition(si),x(ii)}}),[o,x,C,n,r]),F=S.useCallback((e=>{o&&(w.current.style.display="none"),e.stopPropagation(),b.current=E.current,M.current=null,y(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[o,g,y]),k=S.useCallback((e=>{e.stopPropagation(),P(!1)}),[]),_=S.useMemo((()=>{const r=e.clone().normalize(),n=t.clone().normalize();return(new T.Matrix4).makeBasis(r,n,r.clone().cross(n))}),[e,t]),A=u?.65:.65*l,L=S.useMemo((()=>{const e=[];for(let t=0;t<=32;t++){const r=t*(Math.PI/2)/32;e.push(new T.Vector3(Math.cos(r)*A,Math.sin(r)*A,0))}return e}),[A]);return S.createElement("group",{ref:z,onPointerDown:R,onPointerMove:D,onPointerUp:F,onPointerOut:k,matrix:_,matrixAutoUpdate:!1},o&&S.createElement(j,{position:[A,A,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:i,ref:w})),S.createElement(ce,{points:L,lineWidth:4*c,visible:!1,userData:v}),S.createElement(ce,{transparent:!0,raycast:()=>null,depthTest:s,points:L,lineWidth:c,side:T.DoubleSide,color:C?m:d[r],opacity:p,polygonOffset:!0,polygonOffsetFactor:-10,renderOrder:f,fog:!1}))},di=new T.Ray,mi=new T.Vector3,fi=new T.Matrix4,pi=({dir1:e,dir2:t,axis:r})=>{const{translation:n,translationLimits:o,annotations:i,annotationsClass:s,depthTest:l,scale:c,lineWidth:u,fixed:d,axisColors:m,hoveredColor:f,opacity:p,renderOrder:h,onDragStart:x,onDrag:y,onDragEnd:v,userData:g}=S.useContext(Yo),w=a.useThree((e=>e.controls)),z=S.useRef(null),b=S.useRef(null),E=S.useRef(null),M=S.useRef(0),C=S.useRef(0),[P,R]=S.useState(!1),D=S.useCallback((e=>{i&&(z.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`,z.current.style.display="block"),e.stopPropagation();const t=e.point.clone(),a=(new T.Vector3).setFromMatrixPosition(b.current.matrixWorld),o=(new T.Vector3).setFromMatrixColumn(b.current.matrixWorld,0).normalize(),s=(new T.Vector3).setFromMatrixColumn(b.current.matrixWorld,1).normalize(),l=(new T.Vector3).setFromMatrixColumn(b.current.matrixWorld,2).normalize(),c=(new T.Plane).setFromNormalAndCoplanarPoint(l,a);E.current={clickPoint:t,e1:o,e2:s,plane:c},M.current=n.current[(r+1)%3],C.current=n.current[(r+2)%3],x({component:"Slider",axis:r,origin:a,directions:[o,s,l]}),w&&(w.enabled=!1),e.target.setPointerCapture(e.pointerId)}),[i,w,x,r]),F=S.useCallback((e=>{if(e.stopPropagation(),P||R(!0),E.current){const{clickPoint:t,e1:a,e2:s,plane:l}=E.current,[c,u]=(null==o?void 0:o[(r+1)%3])||[void 0,void 0],[d,m]=(null==o?void 0:o[(r+2)%3])||[void 0,void 0];di.copy(e.ray),di.intersectPlane(l,mi),di.direction.negate(),di.intersectPlane(l,mi),mi.sub(t);let[f,p]=((e,t,r)=>{const n=Math.abs(e.x)>=Math.abs(e.y)&&Math.abs(e.x)>=Math.abs(e.z)?0:Math.abs(e.y)>=Math.abs(e.x)&&Math.abs(e.y)>=Math.abs(e.z)?1:2,a=[0,1,2].sort(((e,r)=>Math.abs(t.getComponent(r))-Math.abs(t.getComponent(e)))),o=n===a[0]?a[1]:a[0],i=e.getComponent(n),s=e.getComponent(o),l=t.getComponent(n),c=t.getComponent(o),u=r.getComponent(n),d=(r.getComponent(o)-u*(s/i))/(c-l*(s/i));return[(u-d*l)/i,d]})(a,s,mi);void 0!==c&&(f=Math.max(f,c-M.current)),void 0!==u&&(f=Math.min(f,u-M.current)),void 0!==d&&(p=Math.max(p,d-C.current)),void 0!==m&&(p=Math.min(p,m-C.current)),n.current[(r+1)%3]=M.current+f,n.current[(r+2)%3]=C.current+p,i&&(z.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`),fi.makeTranslation(f*a.x+p*s.x,f*a.y+p*s.y,f*a.z+p*s.z),y(fi)}}),[i,y,P,n,o,r]),k=S.useCallback((e=>{i&&(z.current.style.display="none"),e.stopPropagation(),E.current=null,v(),w&&(w.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[i,w,v]),_=S.useCallback((e=>{e.stopPropagation(),R(!1)}),[]),A=S.useMemo((()=>{const r=e.clone().normalize(),n=t.clone().normalize();return(new T.Matrix4).makeBasis(r,n,r.clone().cross(n))}),[e,t]),L=d?1/7:c/7,I=d?.225:.225*c,B=P?f:m[r],U=S.useMemo((()=>[new T.Vector3(0,0,0),new T.Vector3(0,I,0),new T.Vector3(I,I,0),new T.Vector3(I,0,0),new T.Vector3(0,0,0)]),[I]);return S.createElement("group",{ref:b,matrix:A,matrixAutoUpdate:!1},i&&S.createElement(j,{position:[0,0,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:s,ref:z})),S.createElement("group",{position:[1.7*L,1.7*L,0]},S.createElement("mesh",{visible:!0,onPointerDown:D,onPointerMove:F,onPointerUp:k,onPointerOut:_,scale:I,userData:g,renderOrder:h},S.createElement("planeGeometry",null),S.createElement("meshBasicMaterial",{transparent:!0,depthTest:l,color:B,polygonOffset:!0,polygonOffsetFactor:-10,side:T.DoubleSide,fog:!1})),S.createElement(ce,{position:[-I/2,-I/2,0],transparent:!0,depthTest:l,points:U,lineWidth:u,color:B,opacity:p,polygonOffset:!0,polygonOffsetFactor:-10,userData:g,fog:!1,renderOrder:h})))},hi=new T.Vector3,xi=new T.Vector3,yi=new T.Vector3(0,1,0),vi=new T.Vector3,gi=new T.Matrix4,wi=({direction:e,axis:t})=>{const{scaleLimits:r,annotations:n,annotationsClass:o,depthTest:i,scale:s,lineWidth:l,fixed:c,axisColors:u,hoveredColor:d,opacity:m,renderOrder:f,onDragStart:p,onDrag:h,onDragEnd:x,userData:y}=S.useContext(Yo),v=a.useThree((e=>e.size)),g=a.useThree((e=>e.controls)),w=S.useRef(null),z=S.useRef(null),b=S.useRef(null),E=S.useRef(1),M=S.useRef(1),C=S.useRef(null),[P,R]=S.useState(!1),D=c?1.2:1.2*s,F=S.useCallback((r=>{n&&(w.current.innerText=`${M.current.toFixed(2)}`,w.current.style.display="block"),r.stopPropagation();const a=(new T.Matrix4).extractRotation(z.current.matrixWorld),o=r.point.clone(),i=(new T.Vector3).setFromMatrixPosition(z.current.matrixWorld),l=e.clone().applyMatrix4(a).normalize(),u=z.current.matrixWorld.clone(),d=u.clone().invert(),m=c?1/ie(z.current.getWorldPosition(hi),s,r.camera,v):1;C.current={clickPoint:o,dir:l,mPLG:u,mPLGInv:d,offsetMultiplier:m},p({component:"Sphere",axis:t,origin:i,directions:[l]}),g&&(g.enabled=!1),r.target.setPointerCapture(r.pointerId)}),[n,g,e,p,t,c,s,v]),k=S.useCallback((e=>{if(e.stopPropagation(),P||R(!0),C.current){const{clickPoint:a,dir:o,mPLG:i,mPLGInv:l,offsetMultiplier:u}=C.current,[d,m]=(null==r?void 0:r[t])||[1e-5,void 0],f=((e,t,r,n)=>{const a=t.dot(t),o=t.dot(e)-t.dot(r),i=t.dot(n);return 0===i?-o/a:(hi.copy(n).multiplyScalar(a/i).sub(t),xi.copy(n).multiplyScalar(o/i).add(r).sub(e),-hi.dot(xi)/hi.dot(hi))})(a,o,e.ray.origin,e.ray.direction),p=f*u,x=c?p:p/s;let y=Math.pow(2,.2*x);e.shiftKey&&(y=Math.round(10*y)/10),y=Math.max(y,d/E.current),void 0!==m&&(y=Math.min(y,m/E.current)),M.current=E.current*y,b.current.position.set(0,D+p,0),n&&(w.current.innerText=`${M.current.toFixed(2)}`),vi.set(1,1,1),vi.setComponent(t,y),gi.makeScale(vi.x,vi.y,vi.z).premultiply(i).multiply(l),h(gi)}}),[n,D,h,P,r,t]),_=S.useCallback((e=>{n&&(w.current.style.display="none"),e.stopPropagation(),E.current=M.current,C.current=null,b.current.position.set(0,D,0),x(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)}),[n,g,x,D]),A=S.useCallback((e=>{e.stopPropagation(),R(!1)}),[]),{radius:L,matrixL:I}=S.useMemo((()=>{const t=c?l/s*1.8:s/22.5,r=(new T.Quaternion).setFromUnitVectors(yi,e.clone().normalize());return{radius:t,matrixL:(new T.Matrix4).makeRotationFromQuaternion(r)}}),[e,s,l,c]),B=P?d:u[t];return S.createElement("group",{ref:z},S.createElement("group",{matrix:I,matrixAutoUpdate:!1,onPointerDown:F,onPointerMove:k,onPointerUp:_,onPointerOut:A},n&&S.createElement(j,{position:[0,D/2,0]},S.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:o,ref:w})),S.createElement("mesh",{ref:b,position:[0,D,0],renderOrder:f,userData:y},S.createElement("sphereGeometry",{args:[L,12,12]}),S.createElement("meshBasicMaterial",{transparent:!0,depthTest:i,color:B,opacity:m,polygonOffset:!0,polygonOffsetFactor:-10}))))},zi=new T.Matrix4,bi=new T.Matrix4,Ei=new T.Matrix4,Mi=new T.Matrix4,Si=new T.Matrix4,Ci=new T.Matrix4,Ti=new T.Matrix4,Pi=new T.Matrix4,Ri=new T.Matrix4,Di=new T.Box3,Fi=new T.Box3,ki=new T.Vector3,_i=new T.Vector3,Ai=new T.Vector3,Li=new T.Vector3,Ii=new T.Vector3,Bi=new T.Vector3(1,0,0),Ui=new T.Vector3(0,1,0),Vi=new T.Vector3(0,0,1),Oi=S.forwardRef((({enabled:e=!0,matrix:t,onDragStart:r,onDrag:n,onDragEnd:o,autoTransform:i=!0,anchor:s,disableAxes:l=!1,disableSliders:c=!1,disableRotations:u=!1,disableScaling:d=!1,activeAxes:m=[!0,!0,!0],offset:f=[0,0,0],rotation:p=[0,0,0],scale:h=1,lineWidth:x=4,fixed:y=!1,translationLimits:v,rotationLimits:g,scaleLimits:w,depthTest:z=!0,renderOrder:b=500,axisColors:E=["#ff2060","#20df80","#2080ff"],hoveredColor:C="#ffff40",annotations:P=!1,annotationsClass:R,opacity:D=1,visible:F=!0,userData:k,children:_,...A},L)=>{const I=a.useThree((e=>e.invalidate)),B=S.useRef(null),U=S.useRef(null),V=S.useRef(null),O=S.useRef(null),N=S.useRef([0,0,0]),j=S.useRef(new T.Vector3(1,1,1)),W=S.useRef(new T.Vector3(1,1,1));S.useLayoutEffect((()=>{s&&(O.current.updateWorldMatrix(!0,!0),Mi.copy(O.current.matrixWorld).invert(),Di.makeEmpty(),O.current.traverse((e=>{e.geometry&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),Ci.copy(e.matrixWorld).premultiply(Mi),Fi.copy(e.geometry.boundingBox),Fi.applyMatrix4(Ci),Di.union(Fi))})),ki.copy(Di.max).add(Di.min).multiplyScalar(.5),_i.copy(Di.max).sub(Di.min).multiplyScalar(.5),Ai.copy(_i).multiply(new T.Vector3(...s)).add(ki),Li.set(...f).add(Ai),V.current.position.copy(Li),I())}));const G=S.useMemo((()=>({onDragStart:e=>{zi.copy(U.current.matrix),bi.copy(U.current.matrixWorld),r&&r(e),I()},onDrag:e=>{Ei.copy(B.current.matrixWorld),Mi.copy(Ei).invert(),Si.copy(bi).premultiply(e),Ci.copy(Si).premultiply(Mi),Ti.copy(zi).invert(),Pi.copy(Ci).multiply(Ti),i&&U.current.matrix.copy(Ci),n&&n(Ci,Pi,Si,e),I()},onDragEnd:()=>{o&&o(),I()},translation:N,translationLimits:v,rotationLimits:g,axisColors:E,hoveredColor:C,opacity:D,scale:h,lineWidth:x,fixed:y,depthTest:z,renderOrder:b,userData:k,annotations:P,annotationsClass:R})),[r,n,o,N,v,g,w,z,h,x,y,...E,C,D,k,i,P,R]),H=new T.Vector3;return a.useFrame((e=>{if(y){const t=ie(V.current.getWorldPosition(H),h,e.camera,e.size);j.current.setScalar(t)}t&&t instanceof T.Matrix4&&(U.current.matrix=t),U.current.updateWorldMatrix(!0,!0),Ri.makeRotationFromEuler(V.current.rotation).setPosition(V.current.position).premultiply(U.current.matrixWorld),W.current.setFromMatrixScale(Ri),Ii.copy(j.current).divide(W.current),(Math.abs(V.current.scale.x-Ii.x)>1e-4||Math.abs(V.current.scale.y-Ii.y)>1e-4||Math.abs(V.current.scale.z-Ii.z)>1e-4)&&(V.current.scale.copy(Ii),e.invalidate())})),S.useImperativeHandle(L,(()=>U.current),[]),S.createElement(Yo.Provider,{value:G},S.createElement("group",{ref:B},S.createElement("group",M.default({ref:U,matrix:t,matrixAutoUpdate:!1},A),S.createElement("group",{visible:F,ref:V,position:f,rotation:p},e&&S.createElement(S.Fragment,null,!l&&m[0]&&S.createElement(ti,{axis:0,direction:Bi}),!l&&m[1]&&S.createElement(ti,{axis:1,direction:Ui}),!l&&m[2]&&S.createElement(ti,{axis:2,direction:Vi}),!c&&m[0]&&m[1]&&S.createElement(pi,{axis:2,dir1:Bi,dir2:Ui}),!c&&m[0]&&m[2]&&S.createElement(pi,{axis:1,dir1:Vi,dir2:Bi}),!c&&m[2]&&m[1]&&S.createElement(pi,{axis:0,dir1:Ui,dir2:Vi}),!u&&m[0]&&m[1]&&S.createElement(ui,{axis:2,dir1:Bi,dir2:Ui}),!u&&m[0]&&m[2]&&S.createElement(ui,{axis:1,dir1:Vi,dir2:Bi}),!u&&m[2]&&m[1]&&S.createElement(ui,{axis:0,dir1:Ui,dir2:Vi}),!d&&m[0]&&S.createElement(wi,{axis:0,direction:Bi}),!d&&m[1]&&S.createElement(wi,{axis:1,direction:Ui}),!d&&m[2]&&S.createElement(wi,{axis:2,direction:Vi}))),S.createElement("group",{ref:O},_))))})),Ni=t.forwardRef((({options:e={video:!0},...r},n)=>{const a=m.suspend((()=>navigator.mediaDevices.getDisplayMedia(e)),[]);return t.useEffect((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop())),m.clear([])}),[a]),S.createElement(nr,M.default({ref:n},r,{src:a}))})),ji=t.forwardRef((({constraints:e={audio:!1,video:{facingMode:"user"}},...r},n)=>{const a=m.suspend((()=>navigator.mediaDevices.getUserMedia(e)),[]);return t.useEffect((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop())),m.clear([])}),[a]),S.createElement(nr,M.default({ref:n},r,{src:a}))})),Wi=new T.Vector3(0,0,-1),Gi=function(){const e=new T.Vector3,t=new T.Vector3,r=new T.Vector3,n=new T.Vector3,a=new T.Vector3;return function(o,i,s,l){return e.copy(o),t.copy(i),r.copy(s),n.copy(t).sub(e),a.copy(r).sub(e),l.crossVectors(a,n).normalize()}}();const Hi=S.forwardRef((({points:e=Xi.SAMPLE_FACELANDMARKER_RESULT.faceLandmarks[0],face:t,facialTransformationMatrix:r,faceBlendshapes:n,offset:o,offsetScalar:i=80,width:s,height:l,depth:c=1,verticalTri:u=[159,386,152],origin:d,eyes:m=!0,eyesAsOrigin:f=!1,debug:p=!1,children:h,...x},y)=>{var v;t&&(e=t.keypoints,console.warn("Facemesh `face` prop is deprecated: use `points` instead"));const g=S.useRef(null),w=S.useRef(null),z=S.useRef(null),b=S.useRef(null),E=S.useRef(null),M=S.useRef(null),C=S.useRef(null),[P]=S.useState((()=>new T.Vector3)),[R]=S.useState((()=>new T.Object3D)),[D]=S.useState((()=>new T.Quaternion)),[F]=S.useState((()=>new T.Vector3)),{invalidate:k}=a.useThree();S.useEffect((()=>{var e;null==(e=E.current)||e.geometry.setIndex(Xi.TRIANGULATION)}),[]);const[_]=S.useState((()=>new T.Vector3));S.useEffect((()=>{var t,a;const h=null==(t=E.current)?void 0:t.geometry;if(!h)return;var x,y;(h.setFromPoints(e),h.setDrawRange(0,Xi.TRIANGULATION.length),r)?(R.matrix.fromArray(r.data),R.matrix.decompose(R.position,R.quaternion,R.scale),R.rotation.y*=-1,R.rotation.z*=-1,D.setFromEuler(R.rotation),o?(R.position.y*=-1,R.position.z*=-1,null==(x=g.current)||x.position.copy(R.position.divideScalar(i))):null==(y=g.current)||y.position.set(0,0,0)):(Gi(e[u[0]],e[u[1]],e[u[2]],P),D.setFromUnitVectors(Wi,P));const v=D.clone().invert();if(h.computeBoundingBox(),p&&k(),h.center(),h.applyQuaternion(v),null==(a=b.current)||a.setRotationFromQuaternion(D),m)if(n){if(M.current&&C.current&&z.current)if(f){const e=M.current._computeSphere(h),t=C.current._computeSphere(h),r=function(e,t){return e.clone().add(t).multiplyScalar(.5)}(e.center,t.center);d=r.negate(),M.current._update(h,n,e),C.current._update(h,n,t)}else M.current._update(h,n),C.current._update(h,n)}else console.warn("Facemesh `eyes` option only works if `faceBlendshapes` is provided: skipping.");if(z.current){if(void 0!==d)if("number"==typeof d){const e=h.getAttribute("position");F.set(-e.getX(d),-e.getY(d),-e.getZ(d))}else d.isVector3&&F.copy(d);else F.setScalar(0);z.current.position.copy(F)}if(w.current){let e=1;(s||l||c)&&(h.boundingBox.getSize(_),s&&(e=s/_.x),l&&(e=l/_.y),c&&(e=c/_.z)),w.current.scale.setScalar(1!==e?e:1)}h.computeVertexNormals(),h.attributes.position.needsUpdate=!0}),[e,r,n,R,o,i,s,l,c,u,d,m,p,k,P,D,_,F]);const A=S.useMemo((()=>({outerRef:b,meshRef:E,eyeRightRef:M,eyeLeftRef:C})),[]);S.useImperativeHandle(y,(()=>A),[A]);const[L]=S.useState((()=>new T.Vector3)),I=null==(v=E.current)?void 0:v.geometry.boundingBox,B=(null==I?void 0:I.getSize(L).z)||1;return S.createElement("group",x,S.createElement("group",{ref:g},S.createElement("group",{ref:b},S.createElement("group",{ref:w},p?S.createElement(S.Fragment,null,S.createElement("axesHelper",{args:[B]}),S.createElement(ce,{points:[[0,0,0],[0,0,-B]],color:65535})):null,S.createElement("group",{ref:z},m&&n&&S.createElement("group",{name:"eyes"},S.createElement(qi,{side:"left",ref:M,debug:p}),S.createElement(qi,{side:"right",ref:C,debug:p})),S.createElement("mesh",{ref:E,name:"face"},h,p?S.createElement(S.Fragment,null,I&&S.createElement("box3Helper",{args:[I]})):null))))))})),$i={contourLandmarks:{right:[33,133,159,145,153],left:[263,362,386,374,380]},blendshapes:{right:[14,16,18,12],left:[13,15,17,11]},color:{right:"red",left:"#00ff00"},fov:{horizontal:100,vertical:90}},qi=S.forwardRef((({side:e,debug:t=!0},r)=>{const n=S.useRef(null),a=S.useRef(null),[o]=S.useState((()=>new T.Sphere)),i=S.useCallback((t=>{const r=t.getAttribute("position"),n=$i.contourLandmarks[e].map((e=>new T.Vector3(r.getX(e),r.getY(e),r.getZ(e))));return o.center.set(0,0,0),n.forEach((e=>o.center.add(e))),o.center.divideScalar(n.length),o.radius=n[0].sub(n[1]).length()/2,o}),[o,e]),[s]=S.useState((()=>new T.Euler)),l=S.useCallback(((t,r,o)=>{var l;n.current&&(null!==(l=o)&&void 0!==l||(o=i(t)),n.current.position.copy(o.center),n.current.scale.setScalar(o.radius));if(r&&a.current){const t=$i.blendshapes[e],n=r.categories[t[0]].score,o=r.categories[t[1]].score,i=r.categories[t[2]].score,l=r.categories[t[3]].score,c=.5*($i.fov.horizontal*T.MathUtils.DEG2RAD)*(l-i),u=.5*($i.fov.vertical*T.MathUtils.DEG2RAD)*(n-o)*("left"===e?1:-1);s.set(c,u,0),a.current.setRotationFromEuler(s)}}),[i,e,s]),c=S.useMemo((()=>({eyeMeshRef:n,irisDirRef:a,_computeSphere:i,_update:l})),[i,l]);S.useImperativeHandle(r,(()=>c),[c]);const u=$i.color[e];return S.createElement("group",null,S.createElement("group",{ref:n},t&&S.createElement("axesHelper",null),S.createElement("group",{ref:a},S.createElement(S.Fragment,null,t&&S.createElement(ce,{points:[[0,0,0],[0,0,-2]],lineWidth:1,color:u})))))})),Xi={TRIANGULATION:[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255],SAMPLE_FACE:{keypoints:[{x:356.2804412841797,y:295.1960563659668,z:-23.786449432373047,name:"lips"},{x:354.8859405517578,y:264.69520568847656,z:-36.718435287475586},{x:355.2180862426758,y:275.3360366821289,z:-21.183712482452393},{x:347.349853515625,y:242.4400234222412,z:-25.093655586242676},{x:354.40135955810547,y:256.67933464050293,z:-38.23572635650635},{x:353.7689971923828,y:247.54886627197266,z:-34.5475435256958},{x:352.1288299560547,y:227.34312057495117,z:-13.095386028289795},{x:303.5013198852539,y:234.67002868652344,z:12.500141859054565,name:"rightEye"},{x:351.09378814697266,y:211.87547206878662,z:-6.413471698760986},{x:350.7115936279297,y:202.1251630783081,z:-6.413471698760986},{x:348.33667755126953,y:168.7741756439209,z:6.483500003814697,name:"faceOval"},{x:356.4806365966797,y:299.2995357513428,z:-23.144519329071045},{x:356.5511703491211,y:302.66146659851074,z:-21.020312309265137},{x:356.6239547729492,y:304.1536331176758,z:-18.137459754943848,name:"lips"},{x:356.5807342529297,y:305.1840591430664,z:-18.767719268798828,name:"lips"},{x:356.8241500854492,y:308.25711250305176,z:-20.16829490661621},{x:357.113037109375,y:312.26277351379395,z:-22.10575819015503},{x:357.34962463378906,y:317.1123218536377,z:-21.837315559387207,name:"lips"},{x:357.6658630371094,y:325.51036834716797,z:-16.27002477645874},{x:355.0201416015625,y:269.36279296875,z:-33.73054027557373},{x:348.5237503051758,y:270.33411026000977,z:-24.93025302886963},{x:279.97331619262695,y:213.24176788330078,z:47.759642601013184,name:"faceOval"},{x:322.66529083251953,y:238.5027265548706,z:5.535193085670471},{x:316.0983657836914,y:239.94489669799805,z:5.777376294136047},{x:309.9431610107422,y:240.24518966674805,z:7.510589361190796},{x:301.31994247436523,y:237.86138534545898,z:13.118728399276733},{x:328.14266204833984,y:235.80496788024902,z:6.646900177001953},{x:313.7326431274414,y:222.11161136627197,z:3.9887237548828125},{x:320.45196533203125,y:221.87729358673096,z:4.601476192474365},{x:307.35679626464844,y:223.63793849945068,z:5.932023525238037},{x:303.0031204223633,y:226.3743782043457,z:8.479321002960205},{x:296.80023193359375,y:242.94299125671387,z:15.931552648544312},{x:332.2352981567383,y:340.77341079711914,z:-10.165848731994629},{x:301.38587951660156,y:233.46447944641113,z:14.764405488967896,name:"rightEye"},{x:279.0147018432617,y:244.37155723571777,z:45.77549457550049},{x:289.60548400878906,y:239.1807460784912,z:23.191204071044922},{x:320.32257080078125,y:267.1292781829834,z:-4.954537749290466},{x:347.64583587646484,y:294.4955062866211,z:-23.062820434570312,name:"lips"},{x:349.28138732910156,y:303.1095886230469,z:-20.238323211669922},{x:338.9453125,y:298.19186210632324,z:-19.456336498260498,name:"lips"},{x:333.36788177490234,y:302.6706790924072,z:-14.776077270507812,name:"lips"},{x:342.89188385009766,y:304.3561363220215,z:-17.752301692962646},{x:337.7375030517578,y:306.0098361968994,z:-13.410515785217285},{x:325.6159210205078,y:316.22995376586914,z:-6.681914925575256},{x:349.0104675292969,y:264.9818515777588,z:-36.274919509887695},{x:347.7138900756836,y:257.5664806365967,z:-37.67549514770508},{x:291.79357528686523,y:218.88171672821045,z:11.578094959259033,name:"rightEyebrow"},{x:332.2689437866211,y:247.56946563720703,z:-3.3730539679527283},{x:332.0074462890625,y:267.1201229095459,z:-19.969879388809204},{x:331.27952575683594,y:263.6967658996582,z:-17.47218608856201},{x:301.04373931884766,y:269.56552505493164,z:3.61815482378006},{x:347.4863815307617,y:249.0706443786621,z:-32.633421421051025},{x:307.26118087768555,y:208.2646894454956,z:1.1591226607561111,name:"rightEyebrow"},{x:297.91919708251953,y:212.22604751586914,z:5.914516448974609,name:"rightEyebrow"},{x:285.1651382446289,y:197.98450469970703,z:36.391637325286865,name:"faceOval"},{x:337.04097747802734,y:211.25229835510254,z:-4.548954665660858},{x:326.5912628173828,y:223.16698551177979,z:6.670243740081787},{x:320.05664825439453,y:309.5834255218506,z:-4.055835008621216},{x:289.6866226196289,y:314.617395401001,z:53.875489234924316,name:"faceOval"},{x:337.4256896972656,y:270.8755302429199,z:-17.67060160636902},{x:343.69922637939453,y:273.0000400543213,z:-18.756048679351807},{x:327.4242401123047,y:309.22399520874023,z:-4.703601002693176,name:"lips"},{x:330.37220001220703,y:308.3323001861572,z:-6.442649960517883},{x:293.87027740478516,y:207.7961826324463,z:9.821539521217346,name:"rightEyebrow"},{x:332.11437225341797,y:271.22812271118164,z:-16.64351224899292},{x:320.1197814941406,y:207.40366458892822,z:-2.48164564371109,name:"rightEyebrow"},{x:318.59575271606445,y:201.07443809509277,z:-3.110446035861969,name:"rightEyebrow"},{x:310.72303771972656,y:175.75075149536133,z:13.328815698623657,name:"faceOval"},{x:289.67578887939453,y:202.29835510253906,z:21.370456218719482},{x:315.30879974365234,y:187.35260009765625,z:5.0304025411605835},{x:287.8936767578125,y:216.54793739318848,z:17.81065821647644,name:"rightEyebrow"},{x:283.9391899108887,y:215.01142501831055,z:32.04984903335571},{x:348.35330963134766,y:299.4155788421631,z:-22.47924566268921},{x:341.1790466308594,y:301.8221855163574,z:-18.977805376052856},{x:335.69713592529297,y:304.4266891479492,z:-14.682706594467163},{x:339.4615173339844,y:272.3654365539551,z:-16.38674020767212},{x:328.99600982666016,y:308.86685371398926,z:-5.616893768310547},{x:332.00313568115234,y:309.1875743865967,z:-10.335084199905396},{x:331.0068130493164,y:307.9274368286133,z:-6.681914925575256,name:"lips"},{x:341.13792419433594,y:266.4876937866211,z:-26.56425952911377},{x:339.02950286865234,y:305.6663703918457,z:-12.33674168586731,name:"lips"},{x:344.22935485839844,y:304.9452781677246,z:-15.161235332489014,name:"lips"},{x:350.1844024658203,y:304.374303817749,z:-17.5305438041687,name:"lips"},{x:348.52630615234375,y:325.9562301635742,z:-16.164982318878174},{x:348.6581802368164,y:317.1624183654785,z:-21.510512828826904,name:"lips"},{x:348.9766311645508,y:312.1923065185547,z:-21.708929538726807},{x:349.2427444458008,y:308.0660820007324,z:-19.643079042434692},{x:349.67491149902344,y:305.42747497558594,z:-18.16080331802368,name:"lips"},{x:337.95589447021484,y:306.6535949707031,z:-12.803598642349243,name:"lips"},{x:337.06878662109375,y:307.63169288635254,z:-14.274203777313232},{x:335.77449798583984,y:309.8449516296387,z:-15.698124170303345},{x:334.6099090576172,y:312.7997016906738,z:-14.764405488967896,name:"lips"},{x:327.2330856323242,y:293.80866050720215,z:-11.864047050476074},{x:280.97679138183594,y:279.79928970336914,z:68.90834331512451,name:"faceOval"},{x:355.13843536376953,y:271.7875671386719,z:-25.350427627563477},{x:334.7235870361328,y:307.4656391143799,z:-9.302158951759338,name:"lips"},{x:333.5293960571289,y:307.89782524108887,z:-10.200862884521484},{x:346.29688262939453,y:276.4256286621094,z:-19.748122692108154},{x:335.16246795654297,y:276.22097969055176,z:-12.313398122787476},{x:345.09132385253906,y:274.7082996368408,z:-19.304605722427368},{x:325.4267883300781,y:252.95130729675293,z:-1.6661019623279572},{x:315.347843170166,y:259.05200958251953,z:-.25604281574487686},{x:330.44933319091797,y:267.7570152282715,z:-14.017432928085327},{x:294.96768951416016,y:185.26001930236816,z:23.903164863586426,name:"faceOval"},{x:299.63531494140625,y:192.7913761138916,z:12.640198469161987},{x:304.5452117919922,y:202.4142837524414,z:3.244667649269104,name:"rightEyebrow"},{x:331.6915512084961,y:320.0467872619629,z:-10.632705688476562},{x:334.5911407470703,y:201.27566814422607,z:-6.133356094360352,name:"rightEyebrow"},{x:331.4815902709961,y:185.44180870056152,z:.6627205014228821},{x:328.05816650390625,y:170.8385467529297,z:7.358860373497009,name:"faceOval"},{x:304.49764251708984,y:239.76297855377197,z:10.387605428695679},{x:290.6382179260254,y:248.85257720947266,z:19.03616428375244},{x:331.5682601928711,y:233.20727348327637,z:7.837390303611755},{x:295.5115509033203,y:228.9834451675415,z:14.41426157951355},{x:336.94332122802734,y:241.8259334564209,z:-5.27842104434967},{x:336.2792205810547,y:262.7049922943115,z:-26.12074375152588},{x:284.4102478027344,y:255.3262710571289,z:25.467140674591064},{x:295.1420593261719,y:253.02655220031738,z:12.430112361907959},{x:303.5196113586426,y:254.20703887939453,z:6.139191389083862},{x:315.73450088500977,y:251.64799690246582,z:3.3788898587226868},{x:324.69661712646484,y:247.56494522094727,z:2.3328344523906708},{x:331.57970428466797,y:243.02241325378418,z:1.1423448473215103},{x:345.6210708618164,y:229.9976634979248,z:-10.825285911560059},{x:286.26644134521484,y:270.37991523742676,z:21.708929538726807},{x:290.2525520324707,y:228.4921360015869,z:17.71728754043579},{x:351.65367126464844,y:269.3400764465332,z:-33.450424671173096},{x:333.1378936767578,y:253.88388633728027,z:-7.230473756790161},{x:277.8318977355957,y:246.95331573486328,z:68.20805549621582,name:"faceOval"},{x:336.6680908203125,y:238.10003757476807,z:.7688578963279724},{x:329.95800018310547,y:269.18323516845703,z:-7.207130789756775},{x:299.17491912841797,y:234.13324356079102,z:15.95489501953125},{x:335.61729431152344,y:258.71752738952637,z:-23.016133308410645},{x:284.1079330444336,y:297.0343494415283,z:63.25934886932373,name:"faceOval"},{x:331.44542694091797,y:230.6892442703247,z:9.92658257484436,name:"rightEye"},{x:341.41536712646484,y:253.01264762878418,z:-29.038610458374023},{x:303.5472869873047,y:327.5896739959717,z:16.725212335586548},{x:304.7756576538086,y:337.4389457702637,z:27.38126277923584,name:"faceOval"},{x:280.80501556396484,y:275.32050132751465,z:45.0752067565918},{x:295.43582916259766,y:318.4501647949219,z:26.2608003616333},{x:281.4303207397461,y:228.7355661392212,z:40.94350814819336},{x:331.2549591064453,y:349.4216537475586,z:-7.376367449760437},{x:352.4247741699219,y:271.7330074310303,z:-24.953596591949463},{x:327.5672912597656,y:260.41900634765625,z:-5.456410646438599},{x:284.5432472229004,y:241.7647933959961,z:29.668869972229004},{x:310,y:235.66174507141113,z:8.502663969993591,name:"rightEye"},{x:315.7071113586426,y:235.7572603225708,z:6.938687562942505,name:"rightEye"},{x:330.41088104248047,y:311.04143142700195,z:-9.325502514839172,name:"lips"},{x:288.5377502441406,y:285.31983375549316,z:21.837315559387207},{x:344.55039978027344,y:359.4300842285156,z:-6.705257892608643,name:"faceOval"},{x:323.41880798339844,y:351.67362213134766,z:7.802375555038452,name:"faceOval"},{x:314.64088439941406,y:346.11894607543945,z:16.36339783668518,name:"faceOval"},{x:349.4945526123047,y:184.8434829711914,z:-.21847527474164963},{x:359.24694061279297,y:359.8348903656006,z:-8.403456211090088,name:"faceOval"},{x:321.26182556152344,y:234.64492321014404,z:6.90950870513916,name:"rightEye"},{x:326.318359375,y:232.90250301361084,z:8.029969334602356,name:"rightEye"},{x:329.6211624145508,y:231.6195774078369,z:9.722331762313843,name:"rightEye"},{x:285.9398078918457,y:228.2351303100586,z:24.650139808654785},{x:325.79288482666016,y:227.88007736206055,z:7.469738721847534,name:"rightEye"},{x:320.1699447631836,y:227.5934886932373,z:6.168370842933655,name:"rightEye"},{x:314.85408782958984,y:227.85282611846924,z:6.2675780057907104,name:"rightEye"},{x:309.3084907531738,y:229.1516876220703,z:7.7031683921813965,name:"rightEye"},{x:305.5621337890625,y:230.92366218566895,z:9.722331762313843,name:"rightEye"},{x:277.8681945800781,y:228.5354232788086,z:59.71122741699219,name:"faceOval"},{x:306.1444664001465,y:235.1954698562622,z:10.603528022766113,name:"rightEye"},{x:355.4478454589844,y:281.96210861206055,z:-20.565123558044434},{x:333.02661895751953,y:288.0105400085449,z:-14.72939133644104},{x:337.15728759765625,y:269.2059516906738,z:-19.8414945602417},{x:345.9898376464844,y:283.5453128814697,z:-20.4834246635437},{x:351.48963928222656,y:219.98916149139404,z:-7.0378947257995605},{x:312.39574432373047,y:336.50628089904785,z:8.671900033950806},{x:321.32152557373047,y:343.1755256652832,z:.9067271649837494},{x:343.78379821777344,y:353.2975959777832,z:-14.355905055999756},{x:296.8791389465332,y:327.91497230529785,z:41.01353645324707,name:"faceOval"},{x:329.6939468383789,y:229.27897453308105,z:8.934508562088013,name:"rightEye"},{x:341.6905212402344,y:241.4073657989502,z:-14.589333534240723},{x:359.03079986572266,y:353.48859786987305,z:-15.803166627883911},{x:333.1861877441406,y:356.43213272094727,z:-1.0234417766332626,name:"faceOval"},{x:283.97483825683594,y:291.4318656921387,z:41.94725513458252},{x:343.33770751953125,y:305.830135345459,z:-15.756480693817139,name:"lips"},{x:342.40283966064453,y:307.7453899383545,z:-17.4021577835083},{x:341.53621673583984,y:311.0595703125,z:-19.047834873199463},{x:340.9107208251953,y:315.4837703704834,z:-18.5576331615448,name:"lips"},{x:339.1478729248047,y:323.42233657836914,z:-14.367576837539673},{x:333.3201599121094,y:307.4406337738037,z:-9.617288708686829},{x:331.2411117553711,y:306.9811820983887,z:-9.669809937477112},{x:329.23255920410156,y:306.0508346557617,z:-9.582273960113525,name:"lips"},{x:322.4586486816406,y:301.33323669433594,z:-7.720675468444824},{x:297.1712112426758,y:286.9552803039551,z:8.240055441856384},{x:341.3060760498047,y:235.4432201385498,z:-7.504753470420837},{x:336.9318389892578,y:224.3451976776123,z:5.829898118972778},{x:332.65323638916016,y:226.70403957366943,z:8.105834126472473},{x:334.67357635498047,y:306.4397621154785,z:-8.981193900108337,name:"lips"},{x:297.4601936340332,y:306.29210472106934,z:15.476365089416504},{x:342.9119110107422,y:222.37077713012695,z:-2.754466235637665},{x:335.4629898071289,y:332.20250129699707,z:-11.823196411132812},{x:353.2412338256836,y:240.56339263916016,z:-27.147831916809082},{x:346.3080596923828,y:236.41446590423584,z:-18.452589511871338},{x:352.6475143432617,y:234.1420555114746,z:-19.748122692108154},{x:337.3209762573242,y:253.39937210083008,z:-16.024924516677856},{x:358.6122131347656,y:344.90861892700195,z:-18.592647314071655},{x:358.1117248535156,y:334.64990615844727,z:-17.49552845954895},{x:346.4450454711914,y:335.0321102142334,z:-16.32838249206543},{x:319.17640686035156,y:320.2833938598633,z:-3.276764452457428},{x:325.2540588378906,y:276.2369728088379,z:-6.460157036781311},{x:326.7214584350586,y:327.3939514160156,z:-7.417217493057251},{x:310.7190132141113,y:277.2265148162842,z:-3.5452082753181458},{x:319.78355407714844,y:284.8238182067871,z:-6.4543211460113525},{x:305.773983001709,y:290.83580017089844,z:.06907138042151928},{x:344.4001770019531,y:344.85408782958984,z:-16.946970224380493},{x:333.1879425048828,y:258.74256134033203,z:-11.90489649772644},{x:313.80598068237305,y:327.08919525146484,z:2.2277912497520447},{x:322.9637908935547,y:334.6819496154785,z:-3.3643004298210144},{x:313.4055519104004,y:311.2166690826416,z:-1.1175429821014404},{x:291.0865783691406,y:298.2831001281738,z:22.467575073242188},{x:305.6580924987793,y:313.3707904815674,z:5.561453700065613},{x:288.23760986328125,y:305.9941864013672,z:36.765122413635254},{x:315.10692596435547,y:296.26991271972656,z:-4.604393839836121},{x:337.50518798828125,y:247.5944423675537,z:-10.597691535949707},{x:338.8450622558594,y:265.47778129577637,z:-27.778091430664062},{x:334.25254821777344,y:269.0671920776367,z:-20.938611030578613},{x:341.64512634277344,y:259.6387195587158,z:-32.189905643463135},{x:331.44081115722656,y:219.0976095199585,z:4.207563698291779},{x:320.56339263916016,y:216.49658203125,z:2.930997312068939},{x:311.21912002563477,y:216.57853603363037,z:2.9674705862998962},{x:303.46256256103516,y:218.54614734649658,z:5.357203483581543},{x:297.99999237060547,y:222.505202293396,z:9.325502514839172},{x:294.93839263916016,y:236.39654159545898,z:18.534289598464966},{x:278.87489318847656,y:259.7095584869385,z:45.68212032318115},{x:300.3782653808594,y:245.38593292236328,z:12.278382778167725},{x:307.06348419189453,y:246.36857986450195,z:8.164191246032715},{x:315.5229187011719,y:245.3949737548828,z:5.503097176551819},{x:323.71395111083984,y:242.75178909301758,z:4.6335723996162415},{x:330.2785873413086,y:239.34658527374268,z:4.937030673027039},{x:334.6982192993164,y:236.0460376739502,z:4.823233783245087},{x:279.3412208557129,y:263.5196113586426,z:70.91583728790283,name:"faceOval"},{x:334.65972900390625,y:271.6648578643799,z:-17.775644063949585},{x:342.05677032470703,y:246.99846267700195,z:-20.84523916244507},{x:344.0357971191406,y:264.5701503753662,z:-32.936880588531494},{x:348.25531005859375,y:268.6645030975342,z:-30.695960521697998},{x:344.12227630615234,y:266.34212493896484,z:-29.808926582336426},{x:337.12318420410156,y:274.2556858062744,z:-15.768152475357056},{x:349.49047088623047,y:269.071683883667,z:-32.51670837402344},{x:350.1683044433594,y:271.4691352844238,z:-24.93025302886963},{x:333.9634704589844,y:230.56639194488525,z:8.89949381351471},{x:338.2147979736328,y:231.4807891845703,z:4.6715047955513},{x:340.4712677001953,y:231.74463272094727,z:-.34996166825294495},{x:303.28975677490234,y:232.24980354309082,z:11.916568279266357,name:"rightEye"},{x:299.4649124145508,y:229.53842639923096,z:12.325069904327393},{x:359.09618377685547,y:241.77349090576172,z:-24.650139808654785},{x:399.46216583251953,y:229.89503860473633,z:15.919880867004395,name:"leftEye"},{x:361.38919830322266,y:269.6129894256592,z:-24.510080814361572},{x:416.9973373413086,y:206.0895538330078,z:53.26857566833496,name:"faceOval"},{x:381.32179260253906,y:235.5476474761963,z:7.6214683055877686},{x:387.8068542480469,y:236.25958442687988,z:8.345099091529846},{x:393.95751953125,y:235.8660364151001,z:10.475142002105713},{x:401.84600830078125,y:232.77019500732422,z:16.760226488113403},{x:375.70568084716797,y:233.48456382751465,z:8.234220147132874},{x:388.17752838134766,y:218.94717693328857,z:6.810300946235657},{x:381.64928436279297,y:219.2656660079956,z:6.711093783378601},{x:394.4760513305664,y:219.66821193695068,z:9.173773527145386},{x:398.8843536376953,y:221.8837022781372,z:12.03328251838684},{x:406.5454864501953,y:237.12156772613525,z:19.7131085395813},{x:383.87447357177734,y:337.6932907104492,z:-8.631049990653992},{x:401.2682342529297,y:228.5916566848755,z:18.359217643737793,name:"leftEye"},{x:422.0449447631836,y:236.73934936523438,z:51.16771221160889},{x:412.69153594970703,y:232.80198097229004,z:27.52131938934326},{x:387.3497772216797,y:263.298397064209,z:-2.8609684109687805},{x:364.5124053955078,y:293.39221000671387,z:-22.397546768188477,name:"lips"},{x:363.62987518310547,y:302.1291446685791,z:-19.643079042434692},{x:373.2334518432617,y:295.8647060394287,z:-18.125789165496826,name:"lips"},{x:378.83365631103516,y:299.5177745819092,z:-13.153743743896484,name:"lips"},{x:369.91477966308594,y:302.5704002380371,z:-16.65518283843994},{x:374.9167251586914,y:303.5416603088379,z:-11.963253021240234},{x:387.58888244628906,y:312.2716999053955,z:-4.680258631706238},{x:360.6635284423828,y:264.31986808776855,z:-35.94811677932739},{x:361.04564666748047,y:256.8225860595703,z:-37.278664112091064},{x:408.3855438232422,y:213.52088928222656,z:15.756480693817139,name:"leftEyebrow"},{x:373.2946014404297,y:245.38101196289062,z:-1.9316278398036957},{x:376.83860778808594,y:264.3721103668213,z:-18.510947227478027},{x:376.9546127319336,y:261.0010528564453,z:-15.989909172058105},{x:406.1498260498047,y:263.5030174255371,z:7.072908878326416},{x:360.07205963134766,y:248.3631706237793,z:-32.16656446456909},{x:393.11119079589844,y:205.10473251342773,z:3.7786373496055603,name:"leftEyebrow"},{x:402.12791442871094,y:207.89000988006592,z:9.383859634399414,name:"leftEyebrow"},{x:410.8693313598633,y:191.6182279586792,z:41.27030849456787,name:"faceOval"},{x:364.9509811401367,y:210.40483474731445,z:-3.758212625980377},{x:375.94444274902344,y:221.1331844329834,z:8.368442058563232},{x:392.1904754638672,y:305.0360298156738,z:-1.752179116010666},{x:419.50225830078125,y:307.25592613220215,z:58.96425247192383,name:"faceOval"},{x:372.0027160644531,y:268.7212657928467,z:-16.631840467453003},{x:366.1614227294922,y:271.6237449645996,z:-18.219159841537476},{x:385.00938415527344,y:305.3863334655762,z:-2.567722797393799},{x:381.99771881103516,y:304.9723720550537,z:-4.575215280056},{x:405.078125,y:203.21216583251953,z:13.713973760604858,name:"leftEyebrow"},{x:377.13207244873047,y:268.4710121154785,z:-15.266278982162476},{x:380.9713363647461,y:205.36980628967285,z:-.7250899076461792,name:"leftEyebrow"},{x:381.7788314819336,y:198.9268398284912,z:-1.184653863310814,name:"leftEyebrow"},{x:385.5204772949219,y:172.1484375,z:16.04826807975769,name:"faceOval"},{x:407.94189453125,y:196.76236152648926,z:25.723915100097656},{x:383.03890228271484,y:184.5157527923584,z:7.393874526023865},{x:411.61781311035156,y:210.79241752624512,z:22.315845489501953,name:"leftEyebrow"},{x:414.30870056152344,y:208.4643030166626,z:37.021894454956055},{x:364.28722381591797,y:298.35777282714844,z:-21.86065673828125},{x:371.3682556152344,y:299.78848457336426,z:-17.834001779556274},{x:376.88201904296875,y:301.6696071624756,z:-13.153743743896484},{x:370.2193832397461,y:270.49095153808594,z:-15.569736957550049},{x:383.5081100463867,y:305.2726364135742,z:-3.673594295978546},{x:380.73760986328125,y:305.96869468688965,z:-8.660228252410889},{x:381.2334442138672,y:304.63574409484863,z:-4.820316135883331,name:"lips"},{x:368.1698989868164,y:264.8884963989258,z:-25.653886795043945},{x:373.5087203979492,y:303.4233856201172,z:-10.95950722694397,name:"lips"},{x:368.4544372558594,y:303.29601287841797,z:-14.169161319732666,name:"lips"},{x:362.76554107666016,y:303.5735607147217,z:-16.911956071853638,name:"lips"},{x:366.60980224609375,y:324.8870658874512,z:-15.616422891616821},{x:365.7067108154297,y:315.95678329467773,z:-20.903596878051758,name:"lips"},{x:365.0083923339844,y:311.2232208251953,z:-21.066999435424805},{x:364.1508102416992,y:307.0583438873291,z:-18.907777070999146},{x:363.37512969970703,y:304.5721435546875,z:-17.42550015449524,name:"lips"},{x:374.580078125,y:304.3059539794922,z:-11.40302300453186,name:"lips"},{x:375.55362701416016,y:305.0998020172119,z:-12.861957550048828},{x:377.2437286376953,y:307.1674346923828,z:-14.215847253799438},{x:378.68587493896484,y:309.9015712738037,z:-13.223772048950195,name:"lips"},{x:383.8992691040039,y:290.29629707336426,z:-9.97326910495758},{x:423.3871841430664,y:271.91688537597656,z:74.37058925628662,name:"faceOval"},{x:377.68043518066406,y:304.62209701538086,z:-7.603961229324341,name:"lips"},{x:379.00428771972656,y:304.9314594268799,z:-8.57852816581726},{x:364.00279998779297,y:275.2813911437988,z:-19.25792098045349},{x:374.68231201171875,y:273.82555961608887,z:-11.28047227859497},{x:365.0354766845703,y:273.4548568725586,z:-18.791062831878662},{x:380.61901092529297,y:249.8848056793213,z:.15501167625188828},{x:391.14158630371094,y:254.7934627532959,z:2.0906515419483185},{x:378.1761169433594,y:264.9612236022949,z:-12.605184316635132},{x:400.9540557861328,y:179.99592304229736,z:27.82477855682373,name:"faceOval"},{x:398.0038833618164,y:188.50656509399414,z:16.094952821731567},{x:394.8717498779297,y:199.0359592437744,z:6.226727366447449,name:"leftEyebrow"},{x:382.10926055908203,y:316.83926582336426,z:-8.946179747581482},{x:366.51588439941406,y:200.32583713531494,z:-5.24632453918457,name:"leftEyebrow"},{x:367.4893569946289,y:183.87210845947266,z:1.9039081037044525},{x:368.6243438720703,y:168.8127565383911,z:8.736093044281006,name:"faceOval"},{x:398.96175384521484,y:234.9675178527832,z:13.713973760604858},{x:412.9645538330078,y:242.23042488098145,z:23.272905349731445},{x:372.05257415771484,y:231.41919136047363,z:9.226294755935669},{x:406.0722351074219,y:223.58965873718262,z:18.370890617370605},{x:368.27442169189453,y:240.2039337158203,z:-4.166713654994965},{x:372.3575210571289,y:260.66442489624023,z:-24.976940155029297},{x:419.2244338989258,y:247.9079246520996,z:30.299127101898193},{x:409.43885803222656,y:246.60913467407227,z:16.398411989212036},{x:401.69139862060547,y:248.76328468322754,z:9.395531415939331},{x:389.7608184814453,y:247.56915092468262,z:5.841569304466248},{x:380.5461883544922,y:244.55984115600586,z:4.263003468513489},{x:373.25817108154297,y:240.80214500427246,z:2.5356262922286987},{x:358.77086639404297,y:229.35615062713623,z:-10.387605428695679},{x:419.5793914794922,y:262.8478717803955,z:26.5175724029541},{x:410.8808898925781,y:222.51372814178467,z:22.199130058288574},{x:358.45714569091797,y:268.91467094421387,z:-33.17030906677246},{x:373.4129333496094,y:251.6385841369629,z:-5.771540403366089},{x:422.5408172607422,y:239.23919677734375,z:74.04378890991211,name:"faceOval"},{x:367.8171920776367,y:236.58040523529053,z:1.820748895406723},{x:378.51959228515625,y:266.2532329559326,z:-5.74819803237915},{x:403.3472442626953,y:229.05112266540527,z:19.689764976501465},{x:372.34840393066406,y:256.6451168060303,z:-21.872329711914062},{x:422.54566192626953,y:289.1587829589844,z:68.67491245269775,name:"faceOval"},{x:371.9297409057617,y:228.90116214752197,z:11.432201862335205,name:"leftEye"},{x:366.21360778808594,y:251.6158962249756,z:-28.19826364517212},{x:409.1571807861328,y:321.3156223297119,z:20.2266526222229},{x:408.52943420410156,y:331.44238471984863,z:31.09278917312622,name:"faceOval"},{x:424.2788314819336,y:267.1992301940918,z:50.467424392700195},{x:415.60352325439453,y:311.6528606414795,z:30.579242706298828},{x:418.12793731689453,y:221.59927368164062,z:46.26569747924805},{x:385.68286895751953,y:346.0184955596924,z:-5.70151150226593},{x:357.82936096191406,y:271.3758373260498,z:-24.836881160736084},{x:379.588623046875,y:257.5071716308594,z:-3.755294680595398},{x:417.4592590332031,y:234.71948146820068,z:34.5475435256958},{x:393.4684371948242,y:231.58967971801758,z:11.408859491348267,name:"leftEye"},{x:387.8864288330078,y:232.14245796203613,z:9.51808214187622,name:"leftEye"},{x:382.4981689453125,y:307.5654888153076,z:-7.522260546684265,name:"lips"},{x:419.00169372558594,y:277.8332805633545,z:26.424202919006348},{x:373.62953186035156,y:357.6375102996826,z:-5.75986921787262,name:"faceOval"},{x:392.8708267211914,y:347.72446632385254,z:10.154176950454712,name:"faceOval"},{x:400.3953552246094,y:341.0005187988281,z:19.39797878265381,name:"faceOval"},{x:382.25440979003906,y:231.66935920715332,z:8.998700976371765,name:"leftEye"},{x:377.14550018310547,y:230.4228687286377,z:9.804032444953918,name:"leftEye"},{x:373.8358688354492,y:229.64950561523438,z:11.292144060134888,name:"leftEye"},{x:414.5794677734375,y:221.67891025543213,z:29.412097930908203},{x:377.00672149658203,y:225.66201210021973,z:9.360517263412476,name:"leftEye"},{x:382.29530334472656,y:224.8431158065796,z:8.32175612449646,name:"leftEye"},{x:387.5133514404297,y:224.49507236480713,z:8.917000889778137,name:"leftEye"},{x:393.15906524658203,y:225.24795055389404,z:10.737749338150024,name:"leftEye"},{x:397.05554962158203,y:226.55359268188477,z:13.002015352249146,name:"leftEye"},{x:420.5299377441406,y:221.014666557312,z:65.40690422058105,name:"faceOval"},{x:397.06920623779297,y:230.6661558151245,z:13.807345628738403,name:"leftEye"},{x:377.94647216796875,y:285.1647090911865,z:-13.305472135543823},{x:372.1118927001953,y:267.1267318725586,z:-18.83774757385254},{x:364.9968719482422,y:282.24411964416504,z:-19.818150997161865},{x:401.973876953125,y:331.20131492614746,z:11.566424369812012},{x:394.3083190917969,y:338.86693954467773,z:3.142542541027069},{x:373.9820861816406,y:351.4504623413086,z:-13.50388765335083},{x:414.3888854980469,y:321.24735832214355,z:45.51872253417969,name:"faceOval"},{x:373.44234466552734,y:227.33163356781006,z:10.626870393753052,name:"leftEye"},{x:364.0731430053711,y:240.31539916992188,z:-13.807345628738403},{x:384.2658233642578,y:353.3793067932129,z:.7385850697755814,name:"faceOval"},{x:423.20526123046875,y:283.5176181793213,z:47.152724266052246},{x:369.42798614501953,y:304.0898895263672,z:-14.647691249847412,name:"lips"},{x:370.63812255859375,y:305.90051651000977,z:-16.211668252944946},{x:371.91192626953125,y:309.0167713165283,z:-17.84567356109619},{x:373.0583953857422,y:313.3545398712158,z:-17.378815412521362,name:"lips"},{x:375.39905548095703,y:321.09289169311523,z:-13.118728399276733},{x:379.2567825317383,y:304.3582534790039,z:-7.924926280975342},{x:381.18797302246094,y:303.7031364440918,z:-7.843226194381714},{x:383.0918502807617,y:302.4884605407715,z:-7.6506465673446655,name:"lips"},{x:389.09461975097656,y:297.1475315093994,z:-5.5497825145721436},{x:411.6408920288086,y:280.24898529052734,z:12.02161192893982},{x:363.3110809326172,y:234.27620887756348,z:-6.775286793708801},{x:366.0474395751953,y:223.29872131347656,z:6.827808618545532},{x:370.34427642822266,y:225.1457118988037,z:9.558931589126587},{x:377.5371551513672,y:303.60079765319824,z:-7.358860373497009,name:"lips"},{x:412.9557800292969,y:299.53579902648926,z:19.39797878265381},{x:360.0810241699219,y:221.72012329101562,z:-2.153385728597641},{x:379.82784271240234,y:329.47723388671875,z:-10.48097848892212},{x:359.08477783203125,y:235.7911491394043,z:-18.079102039337158},{x:369.6688461303711,y:251.5407943725586,z:-14.962821006774902},{x:369.5555114746094,y:333.5307312011719,z:-15.67478060722351},{x:394.0193176269531,y:315.6973171234131,z:-.9920747578144073},{x:383.78997802734375,y:272.7268695831299,z:-4.689012169837952},{x:387.67765045166016,y:323.6722755432129,z:-5.640236139297485},{x:397.8769302368164,y:272.1331214904785,z:-.9395531564950943},{x:389.87476348876953,y:280.5630111694336,z:-4.29218202829361},{x:403.83888244628906,y:285.1167869567871,z:3.0229100584983826},{x:372.5467300415039,y:343.1070327758789,z:-16.153310537338257},{x:374.1112518310547,y:256.3721466064453,z:-10.574349164962769},{x:399.73785400390625,y:321.77515983581543,z:4.849494695663452},{x:392.03365325927734,y:330.56447982788086,z:-1.3407598435878754},{x:398.59134674072266,y:305.93902587890625,z:1.517290621995926},{x:417.95997619628906,y:290.9716987609863,z:26.89105987548828},{x:406.04541778564453,y:307.35154151916504,z:8.666064143180847},{x:420.75328826904297,y:298.40752601623535,z:41.78385257720947},{x:395.4522705078125,y:291.4153575897217,z:-2.1752697229385376},{x:368.6452102661133,y:245.8882999420166,z:-9.453888535499573},{x:370.34900665283203,y:263.56690406799316,z:-26.75100326538086},{x:374.98477935791016,y:266.6126346588135,z:-19.77146625518799},{x:366.99840545654297,y:258.12140464782715,z:-31.372904777526855},{x:371.00616455078125,y:217.63479709625244,z:5.60522198677063},{x:381.30577087402344,y:214.14087295532227,z:4.983716309070587},{x:390.1496124267578,y:213.38221549987793,z:5.593550801277161},{x:397.7696990966797,y:214.3659782409668,z:8.57852816581726},{x:403.1652069091797,y:217.65509605407715,z:13.013685941696167},{x:407.3551940917969,y:230.72525024414062,z:22.444231510162354},{x:424.0876770019531,y:251.7839241027832,z:51.16771221160889},{x:403.50196838378906,y:239.88757610321045,z:15.803166627883911},{x:397.31719970703125,y:241.49806022644043,z:11.233787536621094},{x:388.99425506591797,y:241.4366912841797,z:7.948269248008728},{x:380.7804489135742,y:239.78078842163086,z:6.600214838981628},{x:374.01336669921875,y:237.11946487426758,z:6.349278092384338},{x:369.39125061035156,y:234.35351371765137,z:5.987462401390076},{x:422.9730987548828,y:255.76455116271973,z:76.61150932312012,name:"faceOval"},{x:374.73915100097656,y:269.24214363098145,z:-16.608498096466064},{x:364.61681365966797,y:245.71088790893555,z:-20.02823829650879},{x:365.3834533691406,y:263.34174156188965,z:-32.32996463775635},{x:361.58252716064453,y:267.8273677825928,z:-30.345816612243652},{x:365.37208557128906,y:265.0249671936035,z:-29.178667068481445},{x:372.72605895996094,y:272.05135345458984,z:-14.834434986114502},{x:360.48614501953125,y:268.34827423095703,z:-32.189905643463135},{x:359.9516296386719,y:270.8049201965332,z:-24.650139808654785},{x:369.5049285888672,y:229.01945114135742,z:10.107489824295044},{x:365.5447769165039,y:230.24096488952637,z:5.593550801277161},{x:363.50669860839844,y:230.6208372116089,z:.43622106313705444},{x:399.3529510498047,y:227.65677452087402,z:15.35965085029602,name:"leftEye"},{x:402.5693130493164,y:224.60190296173096,z:15.931552648544312}],box:{xMin:277.8318977355957,yMin:168.7741756439209,xMax:424.2788314819336,yMax:359.8348903656006,width:146.4469337463379,height:191.0607147216797}},SAMPLE_FACELANDMARKER_RESULT:{faceLandmarks:[[{x:.5760777592658997,y:.8639070391654968,z:-.030997956171631813},{x:.572094738483429,y:.7886289358139038,z:-.07189624011516571},{x:.5723551511764526,y:.8075382709503174,z:-.03578168898820877},{x:.5548420548439026,y:.7188365459442139,z:-.057787876576185226},{x:.5706077814102173,y:.7674974799156189,z:-.07740399986505508},{x:.5681378245353699,y:.7387768030166626,z:-.07356284558773041},{x:.5621535181999207,y:.6681165099143982,z:-.04189874976873398},{x:.46613582968711853,y:.6679812073707581,z:.011289681307971478},{x:.5579932928085327,y:.6174106597900391,z:-.03502821549773216},{x:.5563451647758484,y:.5905600190162659,z:-.03928658738732338},{x:.5487832427024841,y:.4900572597980499,z:-.029898937791585922},{x:.5765544176101685,y:.8692144751548767,z:-.02831427752971649},{x:.5771114230155945,y:.873644232749939,z:-.02345779910683632},{x:.5771905779838562,y:.877016007900238,z:-.016658689826726913},{x:.5778058767318726,y:.8770116567611694,z:-.014505492523312569},{x:.5783766508102417,y:.8835000991821289,z:-.015996402129530907},{x:.5792440176010132,y:.8913810849189758,z:-.01924579218029976},{x:.5796768069267273,y:.8996334671974182,z:-.018261712044477463},{x:.5817288160324097,y:.9255813956260681,z:-.007126849144697189},{x:.5726592540740967,y:.7992473244667053,z:-.0643521398305893},{x:.5579419136047363,y:.7996989488601685,z:-.04566684365272522},{x:.4216199815273285,y:.5958762764930725,z:.06776496022939682},{x:.5052269697189331,y:.6796539425849915,z:-.0010737782577052712},{x:.49243026971817017,y:.6838865876197815,z:-.0005227324436418712},{x:.4796970784664154,y:.6856290102005005,z:.002684245817363262},{x:.4618356227874756,y:.6764569878578186,z:.013439622707664967},{x:.5160380601882935,y:.6737282276153564,z:-17607348127057776e-21},{x:.48070961236953735,y:.6255870461463928,z:-.008339674212038517},{x:.49719780683517456,y:.6256808042526245,z:-.008027955889701843},{x:.46674346923828125,y:.6317623853683472,z:-.004460199736058712},{x:.4582492709159851,y:.641118049621582,z:.0011905613355338573},{x:.45408669114112854,y:.6911458969116211,z:.020514748990535736},{x:.535312294960022,y:.9619986414909363,z:.012499462813138962},{x:.4608460068702698,y:.6628725528717041,z:.01517564244568348},{x:.4206731915473938,y:.6828458309173584,z:.07848648726940155},{x:.4390624463558197,y:.6796106696128845,z:.03283142298460007},{x:.5029968619346619,y:.7701570391654968,z:-.009734481573104858},{x:.5595027208328247,y:.8607323169708252,z:-.030043255537748337},{x:.5621269941329956,y:.8738374710083008,z:-.021709579974412918},{x:.5451499819755554,y:.865527331829071,z:-.022014077752828598},{x:.5351184010505676,y:.8705098032951355,z:-.011602800339460373},{x:.5495014190673828,y:.8744956254959106,z:-.016490943729877472},{x:.5395170450210571,y:.8759440779685974,z:-.007333362940698862},{x:.5183624029159546,y:.8959754705429077,z:.010520773939788342},{x:.5604349374771118,y:.7895449995994568,z:-.07082037627696991},{x:.557381272315979,y:.7687489986419678,z:-.07590588927268982},{x:.4432901442050934,y:.6308897733688354,z:.0027153254486620426},{x:.5258325338363647,y:.7151225805282593,z:-.014676518738269806},{x:.5271827578544617,y:.7833116054534912,z:-.037643320858478546},{x:.5257382988929749,y:.7717816233634949,z:-.03401920944452286},{x:.46516409516334534,y:.7705106735229492,z:.0065747760236263275},{x:.5558893084526062,y:.7420997619628906,z:-.0694495290517807},{x:.4720408320426941,y:.6066038608551025,z:-.021204356104135513},{x:.45432573556900024,y:.6158540844917297,z:-.011054684408009052},{x:.4305151402950287,y:.5608053803443909,z:.0396830290555954},{x:.5310865640640259,y:.6157484650611877,z:-.03081176057457924},{x:.5114666223526001,y:.6329749226570129,z:-.00335998204536736},{x:.506435751914978,y:.8786543607711792,z:.012980876490473747},{x:.4480472207069397,y:.8640613555908203,z:.12569651007652283},{x:.5372058153152466,y:.7942581176757812,z:-.03168361634016037},{x:.5488379597663879,y:.8001630306243896,z:-.03280917927622795},{x:.5213388204574585,y:.8794381618499756,z:.011892606504261494},{x:.5242055654525757,y:.8789222240447998,z:.008370225317776203},{x:.4477175176143646,y:.6039950251579285,z:-.0050799972377717495},{x:.526964008808136,y:.7916748523712158,z:-.02968614175915718},{x:.4971255660057068,y:.6050706505775452,z:-.028175678104162216},{x:.4938119053840637,y:.5882453918457031,z:-.03210941329598427},{x:.4757143557071686,y:.5094879865646362,z:-.01300730835646391},{x:.43947282433509827,y:.5816648006439209,z:.01415177434682846},{x:.485664039850235,y:.5477864146232605,z:-.023685332387685776},{x:.43635931611061096,y:.6226438283920288,z:.013606148771941662},{x:.42910251021385193,y:.6102726459503174,z:.03926564007997513},{x:.5605402588844299,y:.8680099248886108,z:-.027318159118294716},{x:.5474816560745239,y:.8702861070632935,z:-.019686367362737656},{x:.5373021364212036,y:.8728838562965393,z:-.010484928265213966},{x:.540735125541687,y:.7979167103767395,z:-.029073253273963928},{x:.5228585004806519,y:.87913578748703,z:.009915109723806381},{x:.530497670173645,y:.8815253973007202,z:.0020524784922599792},{x:.5259912610054016,y:.8790552616119385,z:.007895970717072487},{x:.5433906316757202,y:.7882310748100281,z:-.05121905356645584},{x:.541388213634491,y:.8777219653129578,z:-.00466804439201951},{x:.5515822172164917,y:.8767023086547852,z:-.010475946590304375},{x:.5637003779411316,y:.877059817314148,z:-.015273625031113625},{x:.5640299320220947,y:.9263423085212708,z:-.00658724969252944},{x:.5642300248146057,y:.8993074893951416,z:-.017653480172157288},{x:.5637336373329163,y:.8910360932350159,z:-.01852807030081749},{x:.5637134313583374,y:.8837276697158813,z:-.01482592523097992},{x:.564205527305603,y:.8768964409828186,z:-.01331155002117157},{x:.5419867634773254,y:.8778373599052429,z:-.0037720394320786},{x:.5404468774795532,y:.880696177482605,z:-.005610354244709015},{x:.5392338633537292,y:.8845721483230591,z:-.007352025713771582},{x:.538469672203064,y:.8891173601150513,z:-.005154991988092661},{x:.5189250111579895,y:.8452741503715515,z:-.009755070321261883},{x:.4258975088596344,y:.7662280797958374,z:.1387351155281067},{x:.5725725293159485,y:.8041572570800781,z:-.04583907872438431},{x:.5342061519622803,y:.8785833120346069,z:.002659974154084921},{x:.5324031114578247,y:.8804071545600891,z:.0017832003068178892},{x:.5538818836212158,y:.8078407645225525,z:-.03254539892077446},{x:.5325431823730469,y:.8026832938194275,z:-.019140373915433884},{x:.5514076948165894,y:.8043903112411499,z:-.03313535451889038},{x:.5131856203079224,y:.7284771800041199,z:-.009399853646755219},{x:.49331504106521606,y:.7443980574607849,z:-.005225230939686298},{x:.5239617824554443,y:.7807451486587524,z:-.025881027802824974},{x:.4473606050014496,y:.5315827131271362,z:.011164786294102669},{x:.45718759298324585,y:.5604941248893738,z:-.005943301599472761},{x:.4670005738735199,y:.5909327268600464,z:-.019681761041283607},{x:.5311570167541504,y:.9076261520385742,z:.00389476353302598},{x:.5249923467636108,y:.5893563628196716,z:-.037981919944286346},{x:.5166932344436646,y:.5429551005363464,z:-.03319704160094261},{x:.5085030198097229,y:.49676206707954407,z:-.02691275253891945},{x:.4687720239162445,y:.6834565997123718,z:.008113506250083447},{x:.4426414966583252,y:.7069531679153442,z:.028577271848917007},{x:.5230373740196228,y:.6675713658332825,z:.001773772411979735},{x:.4481240212917328,y:.6527872085571289,z:.012414850294589996},{x:.5339856743812561,y:.7012367844581604,z:-.020220188423991203},{x:.5347223281860352,y:.7761190533638,z:-.05141595005989075},{x:.4315067231655121,y:.7211957573890686,z:.04381405934691429},{x:.45203351974487305,y:.7206180095672607,z:.017288070172071457},{x:.46892452239990234,y:.7265436053276062,z:.005602988880127668},{x:.49314674735069275,y:.7202282547950745,z:-.0006408205372281373},{x:.5104925632476807,y:.7091827392578125,z:-.00362918758764863},{x:.5232142210006714,y:.698553740978241,z:-.00787867046892643},{x:.5497883558273315,y:.6743605136871338,z:-.036349106580019},{x:.43658503890037537,y:.7627100348472595,z:.042555369436740875},{x:.4397648870944977,y:.6528646349906921,z:.017956094816327095},{x:.5653332471847534,y:.7992802858352661,z:-.06365057826042175},{x:.5285563468933105,y:.736810564994812,z:-.018836988136172295},{x:.4180678725242615,y:.6792560815811157,z:.12284679710865021},{x:.5328429937362671,y:.6865872144699097,z:-.010484723374247551},{x:.5230283141136169,y:.7809416055679321,z:-.011922398582100868},{x:.4551771283149719,y:.6650775074958801,z:.01774493046104908},{x:.5337203741073608,y:.7618928551673889,z:-.04697106033563614},{x:.43463975191116333,y:.8133478164672852,z:.1354849934577942},{x:.5225707292556763,y:.6605283617973328,z:.004980515688657761},{x:.5441933870315552,y:.7497199773788452,z:-.06091512367129326},{x:.4774007797241211,y:.9159183502197266,z:.059622734785079956},{x:.48068761825561523,y:.9364941716194153,z:.08404944837093353},{x:.4268292486667633,y:.7657528519630432,z:.09051097184419632},{x:.46051913499832153,y:.8880485892295837,z:.0738474428653717},{x:.4243420660495758,y:.6434382200241089,z:.06230505183339119},{x:.5342157483100891,y:.9835634231567383,z:.021662971004843712},{x:.5668109655380249,y:.8042187094688416,z:-.044937074184417725},{x:.5176341533660889,y:.7530587315559387,z:-.012967454269528389},{x:.430206298828125,y:.6835605502128601,z:.04612284153699875},{x:.4794231951236725,y:.6732114553451538,z:.003970044665038586},{x:.49073347449302673,y:.6722435355186462,z:.0008692514384165406},{x:.5294116139411926,y:.884677529335022,z:.004413890186697245},{x:.4430122375488281,y:.80235356092453,z:.04987282305955887},{x:.5603825449943542,y:1.0092442035675049,z:.026417359709739685},{x:.5186598300933838,y:.9828659892082214,z:.0513598807156086},{x:.5010536909103394,y:.9640932679176331,z:.06591596454381943},{x:.5524769425392151,y:.539441704750061,z:-.035816047340631485},{x:.5879997611045837,y:1.0091472864151,z:.02285068854689598},{x:.5016193985939026,y:.6684437990188599,z:.00028415941051207483},{x:.511952817440033,y:.6642197370529175,z:.0021144719794392586},{x:.5194343328475952,y:.6623469591140747,z:.004674181342124939},{x:.4321230351924896,y:.6496355533599854,z:.03124697133898735},{x:.508686363697052,y:.6479565501213074,z:-.00044765998609364033},{x:.4963986277580261,y:.6431032419204712,z:-.0032507688738405704},{x:.4845542013645172,y:.6430778503417969,z:-.002903624437749386},{x:.4733612537384033,y:.647506833076477,z:.00023347247042693198},{x:.4668654501438141,y:.653346598148346,z:.004762572236359119},{x:.41815051436424255,y:.633708119392395,z:.09809435904026031},{x:.47159942984580994,y:.6711485385894775,z:.007849935442209244},{x:.5734396576881409,y:.8256140351295471,z:-.03155219927430153},{x:.5306524038314819,y:.8337990641593933,z:-.018351426348090172},{x:.5371729135513306,y:.7910830974578857,z:-.037286680191755295},{x:.5549534559249878,y:.8275275826454163,z:-.030664825811982155},{x:.5597432255744934,y:.6418541669845581,z:-.03318847343325615},{x:.4958484172821045,y:.9429569244384766,z:.048340678215026855},{x:.5140507817268372,y:.9634028077125549,z:.03589847311377525},{x:.5587693452835083,y:.9951097369194031,z:.00908728688955307},{x:.46411189436912537,y:.9051855206489563,z:.10601935535669327},{x:.5181609392166138,y:.6554316878318787,z:.002546071307733655},{x:.5436590909957886,y:.7085841298103333,z:-.03844436630606651},{x:.5872187614440918,y:.9960382580757141,z:.0063423276878893375},{x:.5379653573036194,y:.9989125728607178,z:.03636329993605614},{x:.4350326955318451,y:.8088565468788147,z:.09147704392671585},{x:.5523084998130798,y:.8773422837257385,z:-.009068487212061882},{x:.5510149598121643,y:.8816931843757629,z:-.011043853126466274},{x:.5503793954849243,y:.88776695728302,z:-.01348799467086792},{x:.5501549243927002,y:.8954370617866516,z:-.012142189778387547},{x:.546072781085968,y:.9192524552345276,z:-.003157563041895628},{x:.5314661860466003,y:.8771666884422302,z:.0005075141089037061},{x:.5293324589729309,y:.8762547969818115,z:.00039177737198770046},{x:.5275698900222778,y:.8750609755516052,z:47732755774632096e-21},{x:.5104271173477173,y:.8607332110404968,z:.0012934643309563398},{x:.45938700437545776,y:.8134918212890625,z:.023569690063595772},{x:.5418947339057922,y:.6864100694656372,z:-.027333909645676613},{x:.531914234161377,y:.6456130743026733,z:-.005434140563011169},{x:.523697018623352,y:.647885262966156,z:-.0002466466394253075},{x:.5338191390037537,y:.8783687353134155,z:.002268768846988678},{x:.46226605772972107,y:.8610277771949768,z:.04718952998518944},{x:.5434442758560181,y:.6456181406974792,z:-.02327350154519081},{x:.5399754643440247,y:.940219521522522,z:.005075343884527683},{x:.5661457777023315,y:.71457839012146,z:-.06242101639509201},{x:.5523148775100708,y:.6974870562553406,z:-.04863070324063301},{x:.5639959573745728,y:.6923378109931946,z:-.05180761218070984},{x:.5367592573165894,y:.7423217296600342,z:-.03623027727007866},{x:.5853689908981323,y:.9752064943313599,z:-.002361974213272333},{x:.5835235118865967,y:.9493685960769653,z:-.003941743168979883},{x:.5615018606185913,y:.949194610118866,z:-.0015953965485095978},{x:.5068561434745789,y:.9048219323158264,z:.01862684078514576},{x:.5134067535400391,y:.7971825003623962,z:-.008485661819577217},{x:.5223897099494934,y:.925589919090271,z:.01249657291918993},{x:.48500555753707886,y:.7959478497505188,z:-.0032065745908766985},{x:.5037734508514404,y:.8184596300125122,z:-.004932103678584099},{x:.4766361117362976,y:.828806459903717,z:.01027688942849636},{x:.5589827299118042,y:.974656343460083,z:.0009666886180639267},{x:.5294582843780518,y:.7541216611862183,z:-.025603046640753746},{x:.4973002076148987,y:.9208990931510925,z:.031931452453136444},{x:.5163551568984985,y:.9432790875434875,z:.024321340024471283},{x:.49399662017822266,y:.8814862370491028,z:.018687399104237556},{x:.44948166608810425,y:.836137592792511,z:.05702034756541252},{x:.47898444533348083,y:.8836610913276672,z:.03150695189833641},{x:.4454479217529297,y:.8499438166618347,z:.08868525922298431},{x:.49572959542274475,y:.8452823758125305,z:.0036111653316766024},{x:.5362502336502075,y:.7222585678100586,z:-.027912352234125137},{x:.5393770337104797,y:.7850722074508667,z:-.05415399745106697},{x:.531399667263031,y:.7898418307304382,z:-.03883346915245056},{x:.5451627373695374,y:.7717036604881287,z:-.06480253487825394},{x:.5206395983695984,y:.6287745833396912,z:-.010521138086915016},{x:.4974782466888428,y:.6191938519477844,z:-.014098240062594414},{x:.4774145185947418,y:.6193130612373352,z:-.013643337413668633},{x:.4616098403930664,y:.6259890198707581,z:-.008448202162981033},{x:.4516478478908539,y:.6368461847305298,z:9050309745362028e-20},{x:.4485096037387848,y:.6719120740890503,z:.022984720766544342},{x:.42177659273147583,y:.7240667343139648,z:.08511673659086227},{x:.4616215229034424,y:.6988231539726257,z:.014238474890589714},{x:.4755798876285553,y:.7034608721733093,z:.00625590980052948},{x:.4924992024898529,y:.7005885243415833,z:.0009391739731654525},{x:.5082254409790039,y:.693384051322937,z:-.0009464038303121924},{x:.5203112959861755,y:.6849707961082458,z:-.0022114769089967012},{x:.52867591381073,y:.6779075860977173,z:-.002962538506835699},{x:.4213953912258148,y:.7219811677932739,z:.1350894570350647},{x:.5320829749107361,y:.794858992099762,z:-.03181503340601921},{x:.5452795028686523,y:.7286570072174072,z:-.04771539941430092},{x:.5496407747268677,y:.7866933345794678,z:-.06452003121376038},{x:.557040274143219,y:.7962084412574768,z:-.05837344378232956},{x:.549176812171936,y:.7895247936248779,z:-.057761140167713165},{x:.5362890362739563,y:.8005836606025696,z:-.026903774589300156},{x:.560200035572052,y:.7983731031417847,z:-.06172555685043335},{x:.5616944432258606,y:.8022753596305847,z:-.045200999826192856},{x:.5273328423500061,y:.6611284017562866,z:.0029021520167589188},{x:.534850537776947,y:.6660012006759644,z:-.005215510260313749},{x:.5394860506057739,y:.6701375246047974,z:-.014931917190551758},{x:.4634307324886322,y:.658291757106781,z:.009295716881752014},{x:.4538393020629883,y:.6519932150840759,z:.00930330716073513},{x:.5776031613349915,y:.7159298658370972,z:-.057365912944078445},{x:.6504855155944824,y:.6461779475212097,z:.014184834435582161},{x:.5860154032707214,y:.7962266206741333,z:-.04522843658924103},{x:.6842049360275269,y:.5631637573242188,z:.07207967340946198},{x:.6152560710906982,y:.6674962639808655,z:.0007529259892180562},{x:.6280948519706726,y:.6684326529502869,z:.0016892586136236787},{x:.6408625245094299,y:.6663892269134521,z:.005331226624548435},{x:.6557814478874207,y:.6534678936004639,z:.01646413467824459},{x:.6035663485527039,y:.6639701724052429,z:.0013799630105495453},{x:.6329053044319153,y:.608010470867157,z:-.006195899099111557},{x:.6167260408401489,y:.6117533445358276,z:-.006319951266050339},{x:.6471013426780701,y:.6112449765205383,z:-.0017843559617176652},{x:.6560901999473572,y:.6185776591300964,z:.004047257360070944},{x:.6666946411132812,y:.6651176810264587,z:.023647578433156013},{x:.6311345100402832,y:.9495396018028259,z:.014004078693687916},{x:.6544655561447144,y:.6397901773452759,z:.01809609681367874},{x:.6965808868408203,y:.6482675075531006,z:.08304904401302338},{x:.679817259311676,y:.650188148021698,z:.03632688894867897},{x:.6336516737937927,y:.7541458010673523,z:-.007742783520370722},{x:.5921701192855835,y:.8567668199539185,z:-.029399123042821884},{x:.591663658618927,y:.870215654373169,z:-.02103729173541069},{x:.6068367958068848,y:.8584195375442505,z:-.020668085664510727},{x:.6176617741584778,y:.860965371131897,z:-.009790095500648022},{x:.6040634512901306,y:.8686612844467163,z:-.015289564616978168},{x:.6143736839294434,y:.8671170473098755,z:-.005712216719985008},{x:.6373105049133301,y:.8815656900405884,z:.012672550976276398},{x:.5832505822181702,y:.7866312861442566,z:-.07051534950733185},{x:.5836675763130188,y:.7658692598342896,z:-.07566110789775848},{x:.6709531545639038,y:.604898989200592,z:.005951565690338612},{x:.6029891967773438,y:.705652117729187,z:-.013388276100158691},{x:.6131622195243835,y:.7728396058082581,z:-.036248479038476944},{x:.6123163104057312,y:.7612020373344421,z:-.03264721855521202},{x:.6696187853813171,y:.744706928730011,z:.009673702530562878},{x:.5803102254867554,y:.7385968565940857,z:-.0689152330160141},{x:.6404349207878113,y:.5877999663352966,z:-.01929756999015808},{x:.6588467955589294,y:.5929454565048218,z:-.008487257175147533},{x:.6720337867736816,y:.530631422996521,z:.043437421321868896},{x:.584305465221405,y:.6099005341529846,z:-.030301367864012718},{x:.6034283638000488,y:.6217452883720398,z:-.001970183802768588},{x:.6460927724838257,y:.8608663082122803,z:.015541625209152699},{x:.6957815289497375,y:.8326103091239929,z:.13015234470367432},{x:.6043362617492676,y:.7861682772636414,z:-.030476901680231094},{x:.594293475151062,y:.7942103147506714,z:-.032218821346759796},{x:.6324057579040527,y:.8665139675140381,z:.014255806803703308},{x:.6296147704124451,y:.8667733669281006,z:.010388285852968693},{x:.663644552230835,y:.5798642635345459,z:-.0022301070857793093},{x:.6140630841255188,y:.7809288501739502,z:-.02835679054260254},{x:.615908145904541,y:.5921698212623596,z:-.026804860681295395},{x:.617181122303009,y:.5748661756515503,z:-.03060605563223362},{x:.6222207546234131,y:.49137672781944275,z:-.011151673272252083},{x:.6669357419013977,y:.5541607141494751,z:.017466170713305473},{x:.6182981729507446,y:.5320425629615784,z:-.021793590858578682},{x:.6760554313659668,y:.595052182674408,z:.017115700989961624},{x:.6801463961601257,y:.5800720453262329,z:.043127160519361496},{x:.5922210812568665,y:.8644017577171326,z:-.02662893570959568},{x:.6054555177688599,y:.8637874722480774,z:-.018363753333687782},{x:.6161889433860779,y:.8641164898872375,z:-.008808949030935764},{x:.6017249822616577,y:.7901403307914734,z:-.028126630932092667},{x:.631446123123169,y:.8664817810058594,z:.012112865224480629},{x:.6249198913574219,y:.8716511130332947,z:.003882825840264559},{x:.6281915903091431,y:.867301881313324,z:.009891441091895103},{x:.5986843109130859,y:.7813931703567505,z:-.050227612257003784},{x:.6126407384872437,y:.869275689125061,z:-.0031255714129656553},{x:.6027271151542664,y:.8711842894554138,z:-.009324162267148495},{x:.59088134765625,y:.8742044568061829,z:-.014608660712838173},{x:.5984604358673096,y:.9216185212135315,z:-.005981989670544863},{x:.5950398445129395,y:.8964707255363464,z:-.01703473925590515},{x:.5941568613052368,y:.8882410526275635,z:-.017784785479307175},{x:.5928806662559509,y:.8803883194923401,z:-.014153128489851952},{x:.5909661054611206,y:.8748103976249695,z:-.012609979137778282},{x:.6128016710281372,y:.8702545762062073,z:-.0022550546564161777},{x:.6150846481323242,y:.8726804256439209,z:-.00414019962772727},{x:.6173093914985657,y:.8770190477371216,z:-.005970994010567665},{x:.619335412979126,y:.8814800977706909,z:-.0036864024586975574},{x:.6292637586593628,y:.8314558267593384,z:-.007714875973761082},{x:.702275276184082,y:.7320667505264282,z:.1433621346950531},{x:.6204835176467896,y:.8689177632331848,z:.0044869170524179935},{x:.6223508715629578,y:.8704851269721985,z:.00352082890458405},{x:.590448260307312,y:.8029727935791016,z:-.03200828656554222},{x:.6097423434257507,y:.7933741211891174,z:-.018042555078864098},{x:.59229576587677,y:.7993767261505127,z:-.032564569264650345},{x:.6171364188194275,y:.7153720259666443,z:-.007672437466681004},{x:.6389747858047485,y:.726390540599823,z:-.002999067772179842},{x:.6151940226554871,y:.769412100315094,z:-.024427521973848343},{x:.6526776552200317,y:.505868136882782,z:.01412637997418642},{x:.6475822329521179,y:.5375454425811768,z:-.0033899128902703524},{x:.6433356404304504,y:.5714520215988159,z:-.017428796738386154},{x:.626949667930603,y:.8962116837501526,z:.005602736957371235},{x:.5868416428565979,y:.5829002261161804,z:-.03727729618549347},{x:.5877229571342468,y:.5345035791397095,z:-.032396964728832245},{x:.5887066125869751,y:.48655083775520325,z:-.025856535881757736},{x:.6507197618484497,y:.6612282991409302,z:.011114613153040409},{x:.6803066730499268,y:.677992045879364,z:.032125361263751984},{x:.5963194370269775,y:.6598632335662842,z:.002976928371936083},{x:.667536199092865,y:.6274255514144897,z:.015618261881172657},{x:.5930740833282471,y:.6940041780471802,z:-.019217798486351967},{x:.6053346395492554,y:.7676517963409424,z:-.050308309495449066},{x:.6934473514556885,y:.6884298920631409,z:.04794462397694588},{x:.6738007664680481,y:.6934011578559875,z:.020697161555290222},{x:.6588084697723389,y:.7033141851425171,z:.008462334051728249},{x:.6346072554588318,y:.7029502391815186,z:.001542167621664703},{x:.6157816648483276,y:.6966525912284851,z:-.002009218093007803},{x:.6015574336051941,y:.688928484916687,z:-.006588225718587637},{x:.5746836066246033,y:.6711069345474243,z:-.03597589209675789},{x:.6947521567344666,y:.7309479117393494,z:.046707939356565475},{x:.6759101152420044,y:.6249120831489563,z:.021654341369867325},{x:.5794773101806641,y:.7971615195274353,z:-.06339326500892639},{x:.6041849851608276,y:.727514922618866,z:-.017512541264295578},{x:.6968844532966614,y:.6440950036048889,z:.12727996706962585},{x:.5910853147506714,y:.679325520992279,z:-.009497715160250664},{x:.6157375574111938,y:.7695677280426025,z:-.010624290443956852},{x:.6606494784355164,y:.6410489678382874,z:.0208158977329731},{x:.6040687561035156,y:.7531470656394958,z:-.045887019485235214},{x:.7012156248092651,y:.780247151851654,z:.14028730988502502},{x:.595149576663971,y:.6527782678604126,z:.006308757700026035},{x:.5925500392913818,y:.7436665892601013,z:-.060151755809783936},{x:.6780198812484741,y:.8905693888664246,z:.0626060739159584},{x:.676746666431427,y:.9113880395889282,z:.08726003766059875},{x:.7030686140060425,y:.7312687635421753,z:.09529774636030197},{x:.688987135887146,y:.8588417172431946,z:.07752864807844162},{x:.6883691549301147,y:.6109960675239563,z:.06669612973928452},{x:.6358906030654907,y:.9702065587043762,z:.023120900616049767},{x:.5781539678573608,y:.8023634552955627,z:-.044763918966054916},{x:.6170316934585571,y:.7408350706100464,z:-.011375460773706436},{x:.688542366027832,y:.6516284346580505,z:.050206027925014496},{x:.6385149359703064,y:.6540714502334595,z:.006462941411882639},{x:.6279382109642029,y:.6563615798950195,z:.003062846139073372},{x:.6268895268440247,y:.8736732006072998,z:.00627936702221632},{x:.6944946050643921,y:.7709181308746338,z:.053824134171009064},{x:.614617109298706,y:1.0022112131118774,z:.02719894051551819},{x:.6493719220161438,y:.9665167927742004,z:.053563784807920456},{x:.6624587178230286,y:.943530797958374,z:.068605437874794},{x:.6162528991699219,y:.6558693051338196,z:.002187855076044798},{x:.6058168411254883,y:.654328465461731,z:.0036193584091961384},{x:.5987918972969055,y:.6536934971809387,z:.006134530063718557},{x:.6831037402153015,y:.6195642948150635,z:.03511790186166763},{x:.6062582731246948,y:.6356398463249207,z:.001280312892049551},{x:.6174948811531067,y:.62776118516922,z:-.0013642468256875873},{x:.6297246217727661,y:.6253792643547058,z:-.0007034156005829573},{x:.6407091617584229,y:.627578616142273,z:.0028144705574959517},{x:.6479622721672058,y:.6322650909423828,z:.00750273372977972},{x:.6915091276168823,y:.5990704298019409,z:.10270945727825165},{x:.6457163095474243,y:.6504453420639038,z:.010696077719330788},{x:.6164222955703735,y:.8231936097145081,z:-.016772059723734856},{x:.6042401194572449,y:.7830976843833923,z:-.03630910441279411},{x:.5922216773033142,y:.8228387236595154,z:-.029992375522851944},{x:.6646111011505127,y:.92097008228302,z:.050967294722795486},{x:.651232898235321,y:.9460107088088989,z:.038000158965587616},{x:.6140977144241333,y:.9882472157478333,z:.009882091544568539},{x:.6870781183242798,y:.8768675327301025,z:.10980932414531708},{x:.5986856818199158,y:.6456438899040222,z:.003999010659754276},{x:.585981547832489,y:.7034481763839722,z:-.0377722829580307},{x:.6342031359672546,y:.9867448806762695,z:.03786521404981613},{x:.7013950943946838,y:.776049017906189,z:.09598205983638763},{x:.6030206680297852,y:.8719133138656616,z:-.007931148633360863},{x:.6050592064857483,y:.8767156004905701,z:-.009791925549507141},{x:.6073468923568726,y:.8831382393836975,z:-.012361008673906326},{x:.6087977290153503,y:.890143632888794,z:-.01098148338496685},{x:.6147705316543579,y:.9110084772109985,z:-.0018823575228452682},{x:.622577965259552,y:.8670604825019836,z:.002609190298244357},{x:.6241236329078674,y:.8651344180107117,z:.0025534380692988634},{x:.6257084608078003,y:.8638408184051514,z:.0023300074972212315},{x:.639931321144104,y:.8449671268463135,z:.0038123116828501225},{x:.6810906529426575,y:.7856625318527222,z:.02717764675617218},{x:.583532452583313,y:.6811994910240173,z:-.026588857173919678},{x:.5855660438537598,y:.6393819451332092,z:-.004512844607234001},{x:.5932201743125916,y:.6398029327392578,z:.0008020466193556786},{x:.6200879812240601,y:.8683351874351501,z:.00417016725987196},{x:.6842559576034546,y:.8330534100532532,z:.050836317241191864},{x:.5754412412643433,y:.6418221592903137,z:-.022838059812784195},{x:.6232790350914001,y:.9295297265052795,z:.006339520215988159},{x:.5764067769050598,y:.694546639919281,z:-.04825803264975548},{x:.59778892993927,y:.7343927621841431,z:-.035004377365112305},{x:.6042810678482056,y:.9441440105438232,z:-.0010970570147037506},{x:.6496372222900391,y:.8869078159332275,z:.021036235615611076},{x:.6274012327194214,y:.7830310463905334,z:-.006658440921455622},{x:.637792706489563,y:.9104999899864197,z:.014290250837802887},{x:.6549934148788452,y:.7748609185218811,z:-.0006672973395325243},{x:.6404005289077759,y:.801220715045929,z:-.0026642554439604282},{x:.6671456694602966,y:.8045546412467957,z:.013180811889469624},{x:.6107483506202698,y:.9680658578872681,z:.001778992242179811},{x:.6060343980789185,y:.744587242603302,z:-.024382334202528},{x:.6602751612663269,y:.8998945355415344,z:.0344940721988678},{x:.6463775038719177,y:.9262562394142151,z:.02617623284459114},{x:.6579852104187012,y:.8602304458618164,z:.021586716175079346},{x:.6926165223121643,y:.8053340315818787,z:.061075080186128616},{x:.6724731922149658,y:.8594399690628052,z:.03457934781908989},{x:.6975721716880798,y:.8183245062828064,z:.09300774335861206},{x:.6512877941131592,y:.8258221745491028,z:.006324059329926968},{x:.594887375831604,y:.7148372530937195,z:-.026898479089140892},{x:.6017440557479858,y:.7773507833480835,z:-.05312420800328255},{x:.6096571683883667,y:.7806998491287231,z:-.037646256387233734},{x:.5952993035316467,y:.7654367685317993,z:-.06398405134677887},{x:.5950021147727966,y:.6201304793357849,z:-.009297547861933708},{x:.6165438890457153,y:.6052900552749634,z:-.012455573305487633},{x:.6362661719322205,y:.6015968918800354,z:-.011649220250546932},{x:.6522727608680725,y:.6046400666236877,z:-.005903332494199276},{x:.6625409722328186,y:.6128141283988953,z:.0030042496509850025},{x:.6688099503517151,y:.6457712054252625,z:.026322703808546066},{x:.7013440728187561,y:.6893666386604309,z:.08984331786632538},{x:.6608623266220093,y:.6749406456947327,z:.0172116681933403},{x:.6482325196266174,y:.6823726296424866,z:.008881398476660252},{x:.6313265562057495,y:.6842025518417358,z:.0031308617908507586},{x:.6147016286849976,y:.6809731721878052,z:.0007630771724507213},{x:.6018834114074707,y:.6755372285842896,z:-.0008834321051836014},{x:.5925027132034302,y:.670681357383728,z:-.001968748401850462},{x:.700127363204956,y:.6871103644371033,z:.13980500400066376},{x:.6095665693283081,y:.7853189706802368,z:-.03074747882783413},{x:.5880423784255981,y:.7229287028312683,z:-.04691500961780548},{x:.5930182337760925,y:.7811514139175415,z:-.06398335844278336},{x:.5867722034454346,y:.7922660112380981,z:-.05794971063733101},{x:.5933279991149902,y:.7842848896980286,z:-.05714067071676254},{x:.6063535809516907,y:.7920218706130981,z:-.02590685710310936},{x:.5839452743530273,y:.794978141784668,z:-.0615212507545948},{x:.5828126072883606,y:.8000800013542175,z:-.0449722595512867},{x:.5909603834152222,y:.6541213393211365,z:.003991890233010054},{x:.5852181911468506,y:.6602938771247864,z:-.004428438376635313},{x:.5825737714767456,y:.6651063561439514,z:-.014345290139317513},{x:.6517343521118164,y:.6362385153770447,z:.012151890434324741},{x:.6615052819252014,y:.6281577944755554,z:.0123682152479887},{x:.4856873154640198,y:.6568945646286011,z:.000720038078725338},{x:.49988406896591187,y:.6547410488128662,z:.0006949726957827806},{x:.48438939452171326,y:.6392973065376282,z:.000705525919329375},{x:.47143134474754333,y:.6589511632919312,z:.0006980331381782889},{x:.48704618215560913,y:.6752797961235046,z:.0006921177846379578},{x:.6243702173233032,y:.640461802482605,z:-6592126737814397e-20},{x:.6390967965126038,y:.6385173797607422,z:-.00016105435497593135},{x:.6230536699295044,y:.6224825382232666,z:-.00016136496560648084},{x:.6095397472381592,y:.641917884349823,z:-.0001803556369850412},{x:.6250996589660645,y:.6586247682571411,z:-.0001785515050869435}]],faceBlendshapes:[{categories:[{index:0,score:5187174338061595e-21,categoryName:"_neutral",displayName:""},{index:1,score:.24521504342556,categoryName:"browDownLeft",displayName:""},{index:2,score:.1987743377685547,categoryName:"browDownRight",displayName:""},{index:3,score:.013400448486208916,categoryName:"browInnerUp",displayName:""},{index:4,score:.012361560948193073,categoryName:"browOuterUpLeft",displayName:""},{index:5,score:.019305096939206123,categoryName:"browOuterUpRight",displayName:""},{index:6,score:28426356948330067e-21,categoryName:"cheekPuff",displayName:""},{index:7,score:3.4500112633395474e-7,categoryName:"cheekSquintLeft",displayName:""},{index:8,score:4.83789051486383e-7,categoryName:"cheekSquintRight",displayName:""},{index:9,score:.07650448381900787,categoryName:"eyeBlinkLeft",displayName:""},{index:10,score:.05070012807846069,categoryName:"eyeBlinkRight",displayName:""},{index:11,score:.13978900015354156,categoryName:"eyeLookDownLeft",displayName:""},{index:12,score:.14198613166809082,categoryName:"eyeLookDownRight",displayName:""},{index:13,score:.2177766114473343,categoryName:"eyeLookInLeft",displayName:""},{index:14,score:.014739357866346836,categoryName:"eyeLookInRight",displayName:""},{index:15,score:.02361512929201126,categoryName:"eyeLookOutLeft",displayName:""},{index:16,score:.19679604470729828,categoryName:"eyeLookOutRight",displayName:""},{index:17,score:.04874616861343384,categoryName:"eyeLookUpLeft",displayName:""},{index:18,score:.049392376095056534,categoryName:"eyeLookUpRight",displayName:""},{index:19,score:.34944331645965576,categoryName:"eyeSquintLeft",displayName:""},{index:20,score:.2939716875553131,categoryName:"eyeSquintRight",displayName:""},{index:21,score:.005955042317509651,categoryName:"eyeWideLeft",displayName:""},{index:22,score:.006776117719709873,categoryName:"eyeWideRight",displayName:""},{index:23,score:16942436559475027e-21,categoryName:"jawForward",displayName:""},{index:24,score:.0045165494084358215,categoryName:"jawLeft",displayName:""},{index:25,score:.07803940027952194,categoryName:"jawOpen",displayName:""},{index:26,score:2090057751047425e-20,categoryName:"jawRight",displayName:""},{index:27,score:.06032035872340202,categoryName:"mouthClose",displayName:""},{index:28,score:.00228882092051208,categoryName:"mouthDimpleLeft",displayName:""},{index:29,score:.00781762320548296,categoryName:"mouthDimpleRight",displayName:""},{index:30,score:.0017093931091949344,categoryName:"mouthFrownLeft",displayName:""},{index:31,score:.0019319106359034777,categoryName:"mouthFrownRight",displayName:""},{index:32,score:8485237776767462e-20,categoryName:"mouthFunnel",displayName:""},{index:33,score:.0009051355300471187,categoryName:"mouthLeft",displayName:""},{index:34,score:.0003630454302765429,categoryName:"mouthLowerDownLeft",displayName:""},{index:35,score:.00017601238505449146,categoryName:"mouthLowerDownRight",displayName:""},{index:36,score:.12865161895751953,categoryName:"mouthPressLeft",displayName:""},{index:37,score:.20137207210063934,categoryName:"mouthPressRight",displayName:""},{index:38,score:.0022203284315764904,categoryName:"mouthPucker",displayName:""},{index:39,score:.0009096377179957926,categoryName:"mouthRight",displayName:""},{index:40,score:.34189721941947937,categoryName:"mouthRollLower",displayName:""},{index:41,score:.11409689486026764,categoryName:"mouthRollUpper",displayName:""},{index:42,score:.17172536253929138,categoryName:"mouthShrugLower",displayName:""},{index:43,score:.004038424696773291,categoryName:"mouthShrugUpper",displayName:""},{index:44,score:.00023205230536404997,categoryName:"mouthSmileLeft",displayName:""},{index:45,score:.00019313619122840464,categoryName:"mouthSmileRight",displayName:""},{index:46,score:.0018571305554360151,categoryName:"mouthStretchLeft",displayName:""},{index:47,score:.0023813238367438316,categoryName:"mouthStretchRight",displayName:""},{index:48,score:24323100660694763e-21,categoryName:"mouthUpperUpLeft",displayName:""},{index:49,score:3161552012898028e-20,categoryName:"mouthUpperUpRight",displayName:""},{index:50,score:1.08198406678639e-7,categoryName:"noseSneerLeft",displayName:""},{index:51,score:12652527630052646e-22,categoryName:"noseSneerRight",displayName:""}],headIndex:-1,headName:""}],facialTransformationMatrixes:[{rows:4,columns:4,data:[.9947517514228821,.10230544209480286,.0013679931871592999,0,-.10230997204780579,.9947447776794434,.003816320328041911,0,-.000970348424743861,-.0039362297393381596,.9999914169311523,0,2.8888821601867676,-7.808934211730957,-30.52109146118164,1]}]}},Zi=t.createContext({}),Yi={basePath:"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.17/wasm",options:{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",outputFaceBlendshapes:!0,outputFacialTransformationMatrixes:!0}},Qi=t.forwardRef((({basePath:e=Yi.basePath,options:r=Yi.options,children:n},a)=>{const o=JSON.stringify(r),i=m.suspend((async()=>{const{FilesetResolver:t,FaceLandmarker:n}=await Promise.resolve().then((function(){return E(require("@mediapipe/tasks-vision"))})),a=await t.forVisionTasks(e);return n.createFromOptions(a,r)}),[e,o]);return t.useEffect((()=>()=>{null==i||i.close(),m.clear([e,o])}),[i,e,o]),t.useImperativeHandle(a,(()=>i),[i]),S.createElement(Zi.Provider,{value:i},n)}));function Ki(){return t.useContext(Zi)}function Ji(e,t){return e.clone().add(t).multiplyScalar(.5)}function es(e,t,r){const n=e.localToWorld(t);return r.worldToLocal(n)}const ts=t.createContext({}),rs=t.forwardRef((({camera:e,videoTexture:r={start:!0},manualDetect:n=!1,faceLandmarkerResult:o,manualUpdate:i=!1,makeDefault:l,smoothTime:c=.25,offset:u=!0,offsetScalar:d=80,eyes:m=!1,eyesAsOrigin:f=!0,depth:p=.15,debug:h=!1,facemesh:x},y)=>{var v,g;const w=a.useThree((e=>e.scene)),z=a.useThree((e=>e.camera)),b=a.useThree((e=>e.set)),E=a.useThree((e=>e.get)),C=e||z,P=t.useRef(null),[R]=t.useState((()=>new T.Object3D)),[D]=t.useState((()=>new T.Vector3)),[F]=t.useState((()=>new T.Vector3)),[k]=t.useState((()=>new T.Vector3)),[_]=t.useState((()=>new T.Vector3)),A=t.useCallback((()=>{R.parent=C.parent;const e=P.current;if(e){const{outerRef:t,eyeRightRef:r,eyeLeftRef:n}=e;if(r.current&&n.current){const{irisDirRef:e}=r.current,{irisDirRef:a}=n.current;e.current&&a.current&&t.current&&(D.copy(es(e.current,new T.Vector3(0,0,0),t.current)),F.copy(es(a.current,new T.Vector3(0,0,0),t.current)),R.position.copy(es(t.current,Ji(D,F),C.parent||w)),k.copy(es(e.current,new T.Vector3(0,0,1),t.current)),_.copy(es(a.current,new T.Vector3(0,0,1),t.current)),R.lookAt(t.current.localToWorld(Ji(k,_))))}else t.current&&(R.position.copy(es(t.current,new T.Vector3(0,0,0),C.parent||w)),R.lookAt(t.current.localToWorld(new T.Vector3(0,0,1))))}return R}),[C,F,_,D,k,w,R]),[L]=t.useState((()=>new T.Object3D)),I=t.useCallback((function(e,t){if(C){var r;if(null!==(r=t)&&void 0!==r||(t=A()),c>0){const r=1e-9;s.easing.damp3(L.position,t.position,c,e,void 0,void 0,r),s.easing.dampE(L.rotation,t.rotation,c,e,void 0,void 0,r)}else L.position.copy(t.position),L.rotation.copy(t.rotation);C.position.copy(L.position),C.rotation.copy(L.rotation)}}),[C,A,c,L.position,L.rotation]);a.useFrame(((e,t)=>{i||I(t)}));const B=t.useRef(null),[U,V]=t.useState(),O=Ki(),N=t.useCallback(((e,t)=>{const r=B.current;if(!r)return;const n=r.source.data,a=null==O?void 0:O.detectForVideo(n,e);V(a)}),[O]),j=t.useMemo((()=>Object.assign(Object.create(T.EventDispatcher.prototype),{computeTarget:A,update:I,facemeshApiRef:P})),[A,I]);t.useImperativeHandle(y,(()=>j),[j]),t.useEffect((()=>{if(l){const e=E().controls;return b({controls:j}),()=>b({controls:e})}}),[l,j,E,b]);const W=null!=o?o:U,G=null==W?void 0:W.faceLandmarks[0],H=null==W||null==(v=W.facialTransformationMatrixes)?void 0:v[0],$=null==W||null==(g=W.faceBlendshapes)?void 0:g[0],q={onVideoFrame:N,...r};return S.createElement(ts.Provider,{value:j},!n&&S.createElement(t.Suspense,{fallback:null},"src"in q?S.createElement(nr,M.default({ref:B},q)):S.createElement(ji,M.default({ref:B},q))),S.createElement(Hi,M.default({ref:P,children:S.createElement("meshNormalMaterial",{side:T.DoubleSide})},x,{points:G,depth:p,facialTransformationMatrix:H,faceBlendshapes:$,eyes:m,eyesAsOrigin:f,offset:u,offsetScalar:d,debug:h,"rotation-z":Math.PI,visible:h})))})),ns=new T.Vector3,as=new T.Vector2,os=new T.Vector3,is=new T.Vector3,ss=new T.Vector3,ls=new T.Plane,cs=S.forwardRef((({autoTransform:e=!0,matrix:t,axisLock:r,dragLimits:n,onHover:o,onDragStart:s,onDrag:l,onDragEnd:c,children:u,dragConfig:d,...m},f)=>{const p=a.useThree((e=>e.controls)),{camera:h,size:x,raycaster:y,invalidate:v}=a.useThree(),g=S.useRef(null),w=i.useGesture({onHover:({hovering:e})=>o&&o(null!=e&&e),onDragStart:({event:e})=>{p&&(p.enabled=!1);const{point:t}=e;g.current.matrix.decompose(ns,new T.Quaternion,new T.Vector3),os.copy(t),is.copy(os).sub(ns),s&&s(ns),v()},onDrag:({xy:[t,a],intentional:o})=>{if(!o)return;const i=(t-x.left)/x.width*2-1,s=-(a-x.top)/x.height*2+1;if(as.set(i,s),y.setFromCamera(as,h),r)switch(r){case"x":ss.set(1,0,0);break;case"y":ss.set(0,1,0);break;case"z":ss.set(0,0,1)}else h.getWorldDirection(ss).negate();ls.setFromNormalAndCoplanarPoint(ss,os),y.ray.intersectPlane(ls,os);const c=g.current.matrix.clone(),u=g.current.matrixWorld.clone(),d=new T.Vector3(os.x-is.x,os.y-is.y,os.z-is.z);if(n&&(d.x=n[0]?Math.max(Math.min(d.x,n[0][1]),n[0][0]):d.x,d.y=n[1]?Math.max(Math.min(d.y,n[1][1]),n[1][0]):d.y,d.z=n[2]?Math.max(Math.min(d.z,n[2][1]),n[2][0]):d.z),e){g.current.matrix.setPosition(d);const e=g.current.matrix.clone().multiply(c.invert()),t=g.current.matrix.clone().multiply(u.invert());l&&l(g.current.matrix,e,g.current.matrixWorld,t)}else{const e=(new T.Matrix4).copy(g.current.matrix);e.setPosition(d);const t=e.clone().multiply(c.invert()),r=e.clone().multiply(u.invert());l&&l(e,t,g.current.matrixWorld,r)}v()},onDragEnd:()=>{p&&(p.enabled=!0),c&&c(),v()}},{drag:{filterTaps:!0,threshold:1,..."object"==typeof d?d:{}}});return S.useImperativeHandle(f,(()=>g.current),[]),S.useLayoutEffect((()=>{t&&(g.current.matrix=t)}),[t]),S.createElement("group",M.default({ref:g},w(),{matrix:t,matrixAutoUpdate:!1},m),u)}));Object.defineProperty(exports,"CameraControlsImpl",{enumerable:!0,get:function(){return P.default}}),exports.AccumulativeShadows=sa,exports.AdaptiveDpr=function({pixelated:e}){const t=a.useThree((e=>e.gl)),r=a.useThree((e=>e.internal.active)),n=a.useThree((e=>e.performance.current)),o=a.useThree((e=>e.viewport.initialDpr)),i=a.useThree((e=>e.setDpr));return S.useEffect((()=>{const n=t.domElement;return()=>{r&&i(o),e&&n&&(n.style.imageRendering="auto")}}),[]),S.useEffect((()=>{i(n*o),e&&t.domElement&&(t.domElement.style.imageRendering=1===n?"auto":"pixelated")}),[n]),null},exports.AdaptiveEvents=function(){const e=a.useThree((e=>e.get)),t=a.useThree((e=>e.setEvents)),r=a.useThree((e=>e.performance.current));return S.useEffect((()=>{const r=e().events.enabled;return()=>t({enabled:r})}),[]),S.useEffect((()=>t({enabled:1===r})),[r]),null},exports.ArcballControls=mt,exports.AsciiRenderer=function({renderIndex:e=1,bgColor:t="black",fgColor:r="white",characters:n=" .:-+*=%@#",invert:o=!0,color:i=!1,resolution:s=.15}){const{size:l,gl:u,scene:d,camera:m}=a.useThree(),f=S.useMemo((()=>{const e=new c.AsciiEffect(u,n,{invert:o,color:i,resolution:s});return e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.left="0px",e.domElement.style.pointerEvents="none",e}),[n,o,i,s]);return S.useLayoutEffect((()=>{f.domElement.style.color=r,f.domElement.style.backgroundColor=t}),[r,t]),S.useEffect((()=>(u.domElement.style.opacity="0",u.domElement.parentNode.appendChild(f.domElement),()=>{u.domElement.style.opacity="1",u.domElement.parentNode.removeChild(f.domElement)})),[f]),S.useEffect((()=>{f.setSize(l.width,l.height)}),[f,l]),a.useFrame((e=>{f.render(d,m)}),e),S.createElement(S.Fragment,null)},exports.BBAnchor=({anchor:e,...t})=>{const r=S.useRef(null),n=S.useRef(null);return S.useEffect((()=>{var e;null!=(e=r.current)&&null!=(e=e.parent)&&e.parent&&(n.current=r.current.parent,r.current.parent.parent.add(r.current))}),[]),a.useFrame((()=>{n.current&&(hr.setFromObject(n.current),hr.getSize(xr),r.current.position.set(n.current.position.x+xr.x*(Array.isArray(e)?e[0]:e.x)/2,n.current.position.y+xr.y*(Array.isArray(e)?e[1]:e.y)/2,n.current.position.z+xr.z*(Array.isArray(e)?e[2]:e.z)/2))})),S.createElement("group",M.default({ref:r},t))},exports.Backdrop=function({children:e,floor:t=.25,segments:r=20,receiveShadow:n,...a}){const o=S.useRef(null);return S.useLayoutEffect((()=>{let e=0;const n=r/r/2,a=o.current.attributes.position;for(let o=0;o<r+1;o++)for(let i=0;i<r+1;i++)a.setXYZ(e++,o/r-n+(0===o?-t:0),i/r-n,ma(o/r));a.needsUpdate=!0,o.current.computeVertexNormals()}),[r,t]),S.createElement("group",a,S.createElement("mesh",{receiveShadow:n,rotation:[-Math.PI/2,0,Math.PI/2]},S.createElement("planeGeometry",{ref:o,args:[1,1,r,r]}),e))},exports.BakeShadows=function(){const e=a.useThree((e=>e.gl));return t.useEffect((()=>(e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,()=>{e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0})),[e.shadowMap]),null},exports.Billboard=ee,exports.Bounds=Un,exports.Box=cn,exports.Bvh=fr,exports.CameraControls=xt,exports.CameraShake=On,exports.Capsule=Cn,exports.CatmullRomLine=fe,exports.Caustics=ga,exports.Center=wr,exports.Circle=un,exports.Clone=Ve,exports.Cloud=Na,exports.CloudInstance=Oa,exports.Clouds=Va,exports.ComputedAttribute=({compute:e,name:t,...r})=>{const[a]=S.useState((()=>new n.BufferAttribute(new Float32Array(0),1))),o=S.useRef(null);return S.useLayoutEffect((()=>{if(o.current){var t;const r=null!==(t=o.current.parent)&&void 0!==t?t:o.current.__r3f.parent.object,n=e(r);o.current.copy(n)}}),[e]),S.createElement("primitive",M.default({ref:o,object:a,attach:`attributes-${t}`},r))},exports.Cone=dn,exports.ContactShadows=aa,exports.CubeCamera=function({children:e,frames:t=1/0,resolution:r,near:n,far:o,envMap:i,fog:s,...l}){const c=S.useRef(null),{fbo:u,camera:d,update:m}=it({resolution:r,near:n,far:o,envMap:i,fog:s});let f=0;return a.useFrame((()=>{c.current&&(t===1/0||f<t)&&(c.current.visible=!1,m(),c.current.visible=!0,f++)})),S.createElement("group",l,S.createElement("primitive",{object:d}),S.createElement("group",{ref:c},null==e?void 0:e(u.texture)))},exports.CubeTexture=function({children:e,files:t,...r}){const n=Yt(t,{...r});return S.createElement(S.Fragment,null,null==e?void 0:e(n))},exports.CubicBezierLine=me,exports.CurveModifier=Wr,exports.CycleRaycast=function({onChanged:e,portal:t,preventDefault:r=!0,scroll:n=!0,keyCode:o=9}){const i=S.useRef(0),s=a.useThree((e=>e.setEvents)),l=a.useThree((e=>e.get)),c=a.useThree((e=>e.gl));return S.useEffect((()=>{var a;let u,d=[];const m=l().events.filter,f=null!==(a=null==t?void 0:t.current)&&void 0!==a?a:c.domElement.parentNode,p=()=>f&&e&&e(d,Math.round(i.current)%d.length);s({filter:(e,t)=>{let r=[...e];r.length===d.length&&d.every((e=>r.map((e=>e.object.uuid)).includes(e.object.uuid)))||(i.current=0,d=r,p()),m&&(r=m(r,t));for(let e=0;e<Math.round(i.current)%r.length;e++){const e=r.shift();r=[...r,e]}return r}});const h=e=>{var t,r;i.current=e(i.current),null==(t=l().events.handlers)||t.onPointerCancel(void 0),null==(r=l().events.handlers)||r.onPointerMove(u),p()},x=e=>{(e.keyCode||e.which)===o&&(r&&e.preventDefault(),d.length>1&&h((e=>e+1)))},y=e=>{r&&e.preventDefault();let t=0;e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),d.length>1&&h((e=>Math.abs(e-t)))},v=e=>u=e;return document.addEventListener("pointermove",v,{passive:!0}),n&&document.addEventListener("wheel",y),void 0!==o&&document.addEventListener("keydown",x),()=>{s({filter:m}),void 0!==o&&document.removeEventListener("keydown",x),n&&document.removeEventListener("wheel",y),document.removeEventListener("pointermove",v)}}),[c,l,s,r,n,o]),null},exports.Cylinder=mn,exports.Decal=He,exports.Detailed=Mo,exports.DetectGPU=function({children:e,...t}){const r=dr(t);return S.createElement(S.Fragment,null,null==e?void 0:e(r))},exports.DeviceOrientationControls=st,exports.Dodecahedron=En,exports.DragControls=cs,exports.Edges=ke,exports.Effects=ze,exports.Environment=na,exports.EnvironmentCube=ea,exports.EnvironmentMap=Jn,exports.EnvironmentPortal=ta,exports.Example=zr,exports.Extrude=Mn,exports.FaceControls=rs,exports.FaceLandmarker=Qi,exports.FaceLandmarkerDefaults=Yi,exports.Facemesh=Hi,exports.FacemeshDatas=Xi,exports.FacemeshEye=qi,exports.FacemeshEyeDefaults=$i,exports.Fbo=nt,exports.Fbx=function({path:e,...t}){const r=Qt(e).children[0];return S.createElement(Ve,M.default({},t,{object:r}))},exports.FirstPersonControls=ht,exports.Fisheye=function({renderPriority:e=1,zoom:t=0,segments:r=64,children:n,resolution:o=896,...i}){const s=S.useRef(null),l=S.useRef(null),{width:c,height:u}=a.useThree((e=>e.size)),[d]=S.useState((()=>new T.OrthographicCamera));S.useLayoutEffect((()=>{d.position.set(0,0,100),d.zoom=100,d.left=c/-2,d.right=c/2,d.top=u/2,d.bottom=u/-2,d.updateProjectionMatrix()}),[c,u]);const m=Math.sqrt(c*c+u*u)/100*(.5+t/2),f=new T.Vector3,p=new T.Sphere(new T.Vector3,m),h=new T.Matrix3,x=S.useCallback(((e,t,r)=>{t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,d),t.raycaster.ray.intersectSphere(p,f)&&(f.normalize(),h.getNormalMatrix(l.current.camera.matrixWorld),l.current.camera.getWorldPosition(t.raycaster.ray.origin),t.raycaster.ray.direction.set(0,0,1).reflect(f),t.raycaster.ray.direction.x*=-1,t.raycaster.ray.direction.applyNormalMatrix(h).multiplyScalar(-1))}),[]);return a.useFrame((t=>{e&&t.gl.render(s.current,d)}),e),S.createElement(S.Fragment,null,S.createElement("mesh",M.default({ref:s},i,{scale:m}),S.createElement("sphereGeometry",{args:[1,r,r]}),S.createElement("meshBasicMaterial",null,S.createElement(ko,{compute:x,attach:"envMap",flip:!0,resolution:o,ref:l},n,S.createElement(Lo,{api:l})))))},exports.Float=Nn,exports.FlyControls=lt,exports.GizmoHelper=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:r=1,onUpdate:o,onTarget:i,children:s})=>{const l=a.useThree((e=>e.size)),c=a.useThree((e=>e.camera)),u=a.useThree((e=>e.controls)),d=a.useThree((e=>e.invalidate)),m=S.useRef(null),f=S.useRef(null),p=S.useRef(!1),h=S.useRef(0),x=S.useRef(new n.Vector3(0,0,0)),y=S.useRef(new n.Vector3(0,0,0));S.useEffect((()=>{y.current.copy(c.up),Ct.up.copy(c.up)}),[c]);const v=S.useCallback((e=>{p.current=!0,(u||i)&&(x.current=(null==i?void 0:i())||(kt(u)?u.getTarget(x.current):null==u?void 0:u.target)),h.current=c.position.distanceTo(Dt),Pt.copy(c.quaternion),Ft.copy(e).multiplyScalar(h.current).add(Dt),Ct.lookAt(Ft),Rt.copy(Ct.quaternion),d()}),[u,c,i,d]);a.useFrame(((e,t)=>{if(f.current&&m.current){var r;if(p.current)if(Pt.angleTo(Rt)<.01)p.current=!1,"minPolarAngle"in u&&c.up.copy(y.current);else{const e=t*St;Pt.rotateTowards(Rt,e),c.position.set(0,0,1).applyQuaternion(Pt).multiplyScalar(h.current).add(x.current),c.up.set(0,1,0).applyQuaternion(Pt).normalize(),c.quaternion.copy(Pt),kt(u)&&u.setPosition(c.position.x,c.position.y,c.position.z),o?o():u&&u.update(t),d()}Tt.copy(c.matrix).invert(),null==(r=m.current)||r.quaternion.setFromRotationMatrix(Tt)}}));const g=S.useMemo((()=>({tweenCamera:v})),[v]),[w,z]=t,b=e.endsWith("-center")?0:e.endsWith("-left")?-l.width/2+w:l.width/2-w,E=e.startsWith("center-")?0:e.startsWith("top-")?l.height/2-z:-l.height/2+z;return S.createElement(bt,{renderPriority:r},S.createElement(Et.Provider,{value:g},S.createElement(at,{makeDefault:!0,ref:f,position:[0,0,200]}),S.createElement("group",{ref:m,position:[b,E,0]},s)))},exports.GizmoViewcube=e=>S.createElement("group",{scale:[60,60,60]},S.createElement(Gt,e),Nt.map(((t,r)=>S.createElement(Ht,M.default({key:r,position:t,dimensions:jt[r]},e)))),Vt.map(((t,r)=>S.createElement(Ht,M.default({key:r,position:t,dimensions:Ot},e))))),exports.GizmoViewport=({hideNegativeAxes:e,hideAxisHeads:t,disabled:r,font:n="18px Inter var, Arial, sans-serif",axisColors:a=["#ff2060","#20df80","#2080ff"],axisHeadScale:o=1,axisScale:i,labels:s=["X","Y","Z"],labelColor:l="#000",onClick:c,...u})=>{const[d,m,f]=a,{tweenCamera:p}=Mt(),h={font:n,disabled:r,labelColor:l,onClick:c,axisHeadScale:o,onPointerDown:r?void 0:e=>{p(e.object.position),e.stopPropagation()}};return S.createElement("group",M.default({scale:40},u),S.createElement($t,{color:d,rotation:[0,0,0],scale:i}),S.createElement($t,{color:m,rotation:[0,0,Math.PI/2],scale:i}),S.createElement($t,{color:f,rotation:[0,-Math.PI/2,0],scale:i}),!t&&S.createElement(S.Fragment,null,S.createElement(qt,M.default({arcStyle:d,position:[1,0,0],label:s[0]},h)),S.createElement(qt,M.default({arcStyle:m,position:[0,1,0],label:s[1]},h)),S.createElement(qt,M.default({arcStyle:f,position:[0,0,1],label:s[2]},h)),!e&&S.createElement(S.Fragment,null,S.createElement(qt,M.default({arcStyle:d,position:[-1,0,0]},h)),S.createElement(qt,M.default({arcStyle:m,position:[0,-1,0]},h)),S.createElement(qt,M.default({arcStyle:f,position:[0,0,-1]},h)))))},exports.Gltf=Qe,exports.GradientTexture=function({stops:e,colors:t,size:r=1024,width:n=16,type:o=be.Linear,innerCircleRadius:i=0,outerCircleRadius:s="auto",...l}){const c=a.useThree((e=>e.gl)),u=S.useMemo((()=>{const a=document.createElement("canvas"),l=a.getContext("2d");let c;if(a.width=n,a.height=r,o===be.Linear)c=l.createLinearGradient(0,0,0,r);else{const e=a.width/2,t=a.height/2,r="auto"!==s?Math.abs(Number(s)):Math.sqrt(e**2+t**2);c=l.createRadialGradient(e,t,Math.abs(i),e,t,r)}const u=new T.Color;let d=e.length;for(;d--;)c.addColorStop(e[d],u.set(t[d]).getStyle());return l.save(),l.fillStyle=c,l.fillRect(0,0,n,r),l.restore(),a}),[e]);return S.createElement("canvasTexture",M.default({colorSpace:c.outputColorSpace,args:[u],attach:"map"},l))},exports.GradientType=be,exports.Grid=Zt,exports.Helper=({type:e,args:t=[]})=>{const r=S.useRef(null),n=S.useRef(null);return S.useLayoutEffect((()=>{n.current=r.current.parent})),lr(n,e,...t),S.createElement("object3D",{ref:r})},exports.Html=j,exports.Hud=bt,exports.Icosahedron=zn,exports.Image=Fe,exports.Instance=Lr,exports.InstancedAttribute=Vr,exports.Instances=Ir,exports.IsObject=Me,exports.KeyboardControls=function({map:e,children:t,onChange:r,domElement:n}){const a=e.map((e=>e.name+e.keys)).join("-"),i=S.useMemo((()=>o.create(l.subscribeWithSelector((()=>e.reduce(((e,t)=>({...e,[t.name]:!1})),{}))))),[a]),s=S.useMemo((()=>[i.subscribe,i.getState,i]),[a]),c=i.setState;return S.useEffect((()=>{const t=e.map((({name:e,keys:t,up:n})=>({keys:t,up:n,fn:t=>{c({[e]:t}),r&&r(e,t,s[1]())}}))).reduce(((e,{keys:t,fn:r,up:n=!0})=>(t.forEach((t=>e[t]={fn:r,pressed:!1,up:n})),e)),{}),a=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:a,pressed:o,up:i}=n;n.pressed=!0,!i&&o||a(!0)},o=({key:e,code:r})=>{const n=t[e]||t[r];if(!n)return;const{fn:a,up:o}=n;n.pressed=!1,o&&a(!1)},i=n||window;return i.addEventListener("keydown",a,{passive:!0}),i.addEventListener("keyup",o,{passive:!0}),()=>{i.removeEventListener("keydown",a),i.removeEventListener("keyup",o)}}),[n,a]),S.createElement(K.Provider,{value:s,children:t})},exports.Ktx2=({children:e,input:t,basisPath:r})=>{const n=Jt(t,r);return S.createElement(S.Fragment,null,null==e?void 0:e(n))},exports.Lathe=Sn,exports.Lightformer=Ca,exports.Line=ce,exports.Loader=function({containerStyles:e,innerStyles:t,barStyles:r,dataStyles:n,dataInterpolation:a=H,initialState:o=e=>e}){const{active:i,progress:s}=G(),l=S.useRef(0),c=S.useRef(0),u=S.useRef(null),[d,m]=S.useState(o(i));S.useEffect((()=>{let e;return i!==d&&(e=setTimeout((()=>m(i)),300)),()=>clearTimeout(e)}),[d,i]);const f=S.useCallback((()=>{u.current&&(l.current+=(s-l.current)/2,(l.current>.95*s||100===s)&&(l.current=s),u.current.innerText=a(l.current),l.current<s&&(c.current=requestAnimationFrame(f)))}),[a,s]);return S.useEffect((()=>(f(),()=>cancelAnimationFrame(c.current))),[f]),d?S.createElement("div",{style:{...$.container,opacity:i?1:0,...e}},S.createElement("div",null,S.createElement("div",{style:{...$.inner,...t}},S.createElement("div",{style:{...$.bar,transform:`scaleX(${s/100})`,...r}}),S.createElement("span",{ref:u,style:{...$.data,...n}})))):null},exports.MapControls=ct,exports.MarchingCube=je,exports.MarchingCubes=Ne,exports.MarchingPlane=We,exports.Mask=Ao,exports.MatcapTexture=({children:e,id:t,format:r,onLoad:n})=>{const a=Xa(t,r,n);return S.createElement(S.Fragment,null,null==e?void 0:e(a))},exports.Merged=Br,exports.MeshDiscardMaterial=rn,exports.MeshDistortMaterial=Hr,exports.MeshPortalMaterial=Bo,exports.MeshReflectorMaterial=Qr,exports.MeshRefractionMaterial=function({aberrationStrength:e=0,fastChroma:r=!0,envMap:n,...o}){a.extend({MeshRefractionMaterial:Kr});const i=t.useRef(null),{size:s}=a.useThree(),l=t.useMemo((()=>{var t,a;const o={},i=(s=n)&&s.isCubeTexture;var s;const l=(null!==(t=i?null==(a=n.image[0])?void 0:a.width:n.image.width)&&void 0!==t?t:1024)/4,c=Math.floor(Math.log2(l)),u=Math.pow(2,c),d=3*Math.max(u,112),m=4*u;return i&&(o.ENVMAP_TYPE_CUBEM=""),o.CUBEUV_TEXEL_WIDTH=""+1/d,o.CUBEUV_TEXEL_HEIGHT=""+1/m,o.CUBEUV_MAX_MIP=`${c}.0`,e>0&&(o.CHROMATIC_ABERRATIONS=""),r&&(o.FAST_CHROMA=""),o}),[e,r]);return t.useLayoutEffect((()=>{var e;const t=null==(e=i.current)||null==(e=e.__r3f)||null==(e=e.parent)||null==(e=e.object)?void 0:e.geometry;t&&(i.current.bvh=new g.MeshBVHUniformStruct,i.current.bvh.updateFrom(new g.MeshBVH(t.clone().toNonIndexed(),{strategy:g.SAH})))}),[]),a.useFrame((({camera:e})=>{i.current.viewMatrixInverse=e.matrixWorld,i.current.projectionMatrixInverse=e.projectionMatrixInverse})),S.createElement("meshRefractionMaterial",M.default({key:JSON.stringify(l),defines:l,ref:i,resolution:[s.width,s.height],aberrationStrength:e,envMap:n},o))},exports.MeshTransmissionMaterial=tn,exports.MeshWobbleMaterial=qr,exports.MotionPathControls=wt,exports.MultiMaterial=function(e){const t=S.useRef(null);return S.useLayoutEffect((()=>{const e=t.current.parent,r=null==e?void 0:e.geometry;if(r){const n=e.material;e.material=t.current.__r3f.children.map((e=>e.object));const a=[...r.groups];return r.clearGroups(),e.material.forEach(((t,n)=>{n<e.material.length-1&&(t.depthWrite=!1),r.addGroup(0,1/0,n)})),()=>{e.material=n,r.groups=a}}})),S.createElement("group",M.default({ref:t},e))},exports.NormalTexture=({children:e,id:t,onLoad:r,...n})=>{const a=Za(t,n,r);return S.createElement(S.Fragment,null,null==e?void 0:e(a))},exports.Octahedron=bn,exports.OrbitControls=ut,exports.OrthographicCamera=at,exports.Outlines=function({color:e="black",opacity:t=1,transparent:r=!1,screenspace:n=!1,toneMapped:o=!0,polygonOffset:i=!1,polygonOffsetFactor:s=0,renderOrder:l=0,thickness:u=.05,angle:d=Math.PI,clippingPlanes:m,...f}){const p=S.useRef(null),[h]=S.useState((()=>new _e({side:T.BackSide}))),{gl:x}=a.useThree(),y=x.getDrawingBufferSize(new T.Vector2);S.useMemo((()=>a.extend({OutlinesMaterial:_e})),[]);const v=S.useRef(0),g=S.useRef(null);return S.useLayoutEffect((()=>{const e=p.current;if(!e)return;const t=e.parent;if(t&&t.geometry&&(v.current!==d||g.current!==t.geometry)){var r;v.current=d,g.current=t.geometry;let n=null==(r=e.children)?void 0:r[0];n&&(d&&n.geometry.dispose(),e.remove(n)),t.skeleton?(n=new T.SkinnedMesh,n.material=h,n.bind(t.skeleton,t.bindMatrix),e.add(n)):t.isInstancedMesh?(n=new T.InstancedMesh(t.geometry,h,t.count),n.instanceMatrix=t.instanceMatrix,e.add(n)):(n=new T.Mesh,n.material=h,e.add(n)),n.geometry=d?c.toCreasedNormals(t.geometry,d):t.geometry,n.morphTargetInfluences=t.morphTargetInfluences,n.morphTargetDictionary=t.morphTargetDictionary}})),S.useLayoutEffect((()=>{const c=p.current;if(!c)return;const d=c.children[0];if(d){d.renderOrder=l;const f=c.parent;a.applyProps(d,{morphTargetInfluences:f.morphTargetInfluences,morphTargetDictionary:f.morphTargetDictionary}),a.applyProps(d.material,{transparent:r,thickness:u,color:e,opacity:t,size:y,screenspace:n,toneMapped:o,polygonOffset:i,polygonOffsetFactor:s,clippingPlanes:m,clipping:m&&m.length>0})}})),S.useEffect((()=>()=>{const e=p.current;if(!e)return;const t=e.children[0];t&&(d&&t.geometry.dispose(),e.remove(t))}),[]),S.createElement("group",M.default({ref:p},f))},exports.PerformanceMonitor=function({iterations:e=10,ms:r=250,threshold:n=.75,step:o=.1,factor:i=.5,flipflops:s=1/0,bounds:l=e=>e>100?[60,100]:[40,60],onIncline:c,onDecline:u,onChange:d,onFallback:m,children:f}){const p=Math.pow(10,0),[h,x]=t.useState((()=>({fps:0,index:0,factor:i,flipped:0,refreshrate:0,fallback:!1,frames:[],averages:[],subscriptions:new Map,subscribe:e=>{const t=Symbol();return h.subscriptions.set(t,e.current),()=>{h.subscriptions.delete(t)}}})));let y=0;return a.useFrame((()=>{const{frames:t,averages:a}=h;if(!h.fallback&&a.length<e){t.push(performance.now());const i=t[t.length-1]-t[0];if(i>=r){if(h.fps=Math.round(t.length/i*1e3*p)/p,h.refreshrate=Math.max(h.refreshrate,h.fps),a[h.index++%e]=h.fps,a.length===e){const[t,r]=l(h.refreshrate),i=a.filter((e=>e>=r)),f=a.filter((e=>e<t));i.length>e*n&&(h.factor=Math.min(1,h.factor+o),h.flipped++,c&&c(h),h.subscriptions.forEach((e=>e.onIncline&&e.onIncline(h)))),f.length>e*n&&(h.factor=Math.max(0,h.factor-o),h.flipped++,u&&u(h),h.subscriptions.forEach((e=>e.onDecline&&e.onDecline(h)))),y!==h.factor&&(y=h.factor,d&&d(h),h.subscriptions.forEach((e=>e.onChange&&e.onChange(h)))),h.flipped>s&&!h.fallback&&(h.fallback=!0,m&&m(h),h.subscriptions.forEach((e=>e.onFallback&&e.onFallback(h)))),h.averages=[]}h.frames=[]}}})),S.createElement(Ro.Provider,{value:h},f)},exports.PerspectiveCamera=ot,exports.PivotControls=Oi,exports.Plane=pn,exports.Point=xo,exports.PointMaterial=on,exports.PointMaterialImpl=an,exports.PointerLockControls=pt,exports.Points=vo,exports.PointsBuffer=yo,exports.Polyhedron=wn,exports.PositionMesh=Tr,exports.PositionPoint=lo,exports.PositionalAudio=pe,exports.Preload=function({all:e,scene:t,camera:r}){const o=a.useThree((({gl:e})=>e)),i=a.useThree((({camera:e})=>e)),s=a.useThree((({scene:e})=>e));return S.useLayoutEffect((()=>{const a=[];e&&(t||s).traverse((e=>{!1===e.visible&&(a.push(e),e.visible=!0)})),o.compile(t||s,r||i);const l=new n.WebGLCubeRenderTarget(128);new n.CubeCamera(.01,1e5,l).update(o,t||s),l.dispose(),a.forEach((e=>e.visible=!1))}),[]),null},exports.PresentationControls=function({enabled:e=!0,snap:t,global:r,domElement:o,cursor:l=!0,children:c,speed:u=1,rotation:d=[0,0,0],zoom:m=1,polar:f=[0,Math.PI/2],azimuth:p=[-1/0,1/0],damping:h=.25}){const x=a.useThree((e=>e.events)),y=a.useThree((e=>e.gl)),v=o||x.connected||y.domElement,{size:g}=a.useThree(),w=S.useMemo((()=>[d[0]+f[0],d[0]+f[1]]),[d[0],f[0],f[1]]),z=S.useMemo((()=>[d[1]+p[0],d[1]+p[1]]),[d[1],p[0],p[1]]),b=S.useMemo((()=>[n.MathUtils.clamp(d[0],...w),n.MathUtils.clamp(d[1],...z),d[2]]),[d[0],d[1],d[2],w,z]);S.useEffect((()=>{if(r&&l&&e)return v.style.cursor="grab",y.domElement.style.cursor="",()=>{v.style.cursor="default",y.domElement.style.cursor="default"}}),[r,l,v,e]);const[E]=S.useState({scale:1,rotation:b,damping:h}),C=S.useRef(null);a.useFrame(((e,t)=>{s.easing.damp3(C.current.scale,E.scale,E.damping,t),s.easing.dampE(C.current.rotation,E.rotation,E.damping,t)}));const T=i.useGesture({onHover:({last:t})=>{l&&!r&&e&&(v.style.cursor=t?"auto":"grab")},onDrag:({down:r,delta:[a,o],memo:[i,s]=E.rotation||b})=>e?(l&&(v.style.cursor=r?"grabbing":"grab"),a=n.MathUtils.clamp(s+a/g.width*Math.PI*u,...z),o=n.MathUtils.clamp(i+o/g.height*Math.PI*u,...w),E.scale=r&&o>w[1]/2?m:1,E.rotation=t&&!r?b:[o,a,0],E.damping=t&&!r&&"boolean"!=typeof t?t:h,[o,a]):[o,a]},{target:r?v:void 0});return S.createElement("group",M.default({ref:C},null==T?void 0:T()),c)},exports.Progress=function({children:e}){const t=G();return S.createElement(S.Fragment,null,null==e?void 0:e(t))},exports.QuadraticBezierLine=de,exports.RandomizedLight=la,exports.RenderCubeTexture=ko,exports.RenderTexture=Do,exports.Resize=_n,exports.Ring=gn,exports.RoundedBox=Rn,exports.RoundedBoxGeometry=Dn,exports.Sampler=function({children:e,weight:t,transform:r,instances:n,mesh:a,count:o=16,...i}){const s=S.useRef(null),l=S.useRef(null),c=S.useRef(null);return S.useLayoutEffect((()=>{var e,t;l.current=null!==(e=null==n?void 0:n.current)&&void 0!==e?e:s.current.children.find((e=>e.hasOwnProperty("instanceMatrix"))),c.current=null!==(t=null==a?void 0:a.current)&&void 0!==t?t:s.current.children.find((e=>"Mesh"===e.type))}),[e,null==a?void 0:a.current,null==n?void 0:n.current]),Ue(c,o,r,t,l),S.createElement("group",M.default({ref:s},i),e)},exports.ScreenQuad=kn,exports.ScreenSizer=le,exports.ScreenSpace=te,exports.ScreenVideoTexture=Ni,exports.Scroll=Q,exports.ScrollControls=function({eps:e=1e-5,enabled:t=!0,infinite:r,horizontal:n,pages:o=1,distance:i=1,damping:l=.25,maxSpeed:c=1/0,prepend:u=!1,style:d={},children:m}){const{get:f,setEvents:p,gl:h,size:x,invalidate:y,events:v}=a.useThree(),[g]=S.useState((()=>document.createElement("div"))),[w]=S.useState((()=>document.createElement("div"))),[z]=S.useState((()=>document.createElement("div"))),b=h.domElement.parentNode,E=S.useRef(0),M=S.useMemo((()=>{const t={el:g,eps:e,fill:w,fixed:z,horizontal:n,damping:l,offset:0,delta:0,scroll:E,pages:o,range(e,t,r=0){const n=e-r,a=n+t+2*r;return this.offset<n?0:this.offset>a?1:(this.offset-n)/(a-n)},curve(e,t,r=0){return Math.sin(this.range(e,t,r)*Math.PI)},visible(e,t,r=0){const n=e-r,a=n+t+2*r;return this.offset>=n&&this.offset<=a}};return t}),[e,l,n,o]);S.useEffect((()=>{g.style.position="absolute",g.style.width="100%",g.style.height="100%",g.style[n?"overflowX":"overflowY"]="auto",g.style[n?"overflowY":"overflowX"]="hidden",g.style.top="0px",g.style.left="0px";for(const e in d)g.style[e]=d[e];z.style.position="sticky",z.style.top="0px",z.style.left="0px",z.style.width="100%",z.style.height="100%",z.style.overflow="hidden",g.appendChild(z),w.style.height=n?"100%":o*i*100+"%",w.style.width=n?o*i*100+"%":"100%",w.style.pointerEvents="none",g.appendChild(w),u?b.prepend(g):b.appendChild(g),g[n?"scrollLeft":"scrollTop"]=1;const e=v.connected||h.domElement;requestAnimationFrame((()=>null==v.connect?void 0:v.connect(g)));const t=f().events.compute;return p({compute(e,t){const{left:r,top:n}=b.getBoundingClientRect(),a=e.clientX-r,o=e.clientY-n;t.pointer.set(a/t.size.width*2-1,-o/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{b.removeChild(g),p({compute:t}),null==v.connect||v.connect(e)}}),[o,i,n,g,w,z,b]),S.useEffect((()=>{if(v.connected===g){const e=x[n?"width":"height"],a=g[n?"scrollWidth":"scrollHeight"],o=a-e;let i=0,s=!0,l=!0;const c=()=>{if(t&&!l&&(y(),i=g[n?"scrollLeft":"scrollTop"],E.current=i/o,r)){if(!s)if(i>=o){const e=1-M.offset;g[n?"scrollLeft":"scrollTop"]=1,E.current=M.offset=-e,s=!0}else if(i<=0){const e=1+M.offset;g[n?"scrollLeft":"scrollTop"]=a,E.current=M.offset=e,s=!0}s&&setTimeout((()=>s=!1),40)}};g.addEventListener("scroll",c,{passive:!0}),requestAnimationFrame((()=>l=!1));const u=e=>g.scrollLeft+=e.deltaY/2;return n&&g.addEventListener("wheel",u,{passive:!0}),()=>{g.removeEventListener("scroll",c),n&&g.removeEventListener("wheel",u)}}}),[g,v,x,r,M,y,n,t]);let C=0;return a.useFrame(((t,r)=>{C=M.offset,s.easing.damp(M,"offset",E.current,l,r,c,void 0,e),s.easing.damp(M,"delta",Math.abs(C-M.offset),l,r,c,void 0,e),M.delta>e&&y()})),S.createElement(q.Provider,{value:M},m)},exports.Segment=Eo,exports.SegmentObject=zo,exports.Segments=wo,exports.Select=function({box:e,multiple:t,children:r,onChange:n,onChangePointerUp:o,border:i="1px solid #55aaff",backgroundColor:s="rgba(75, 160, 255, 0.1)",filter:l=e=>e,...d}){const[m,f]=S.useState(!1),{setEvents:p,camera:h,raycaster:x,gl:y,controls:v,size:g,get:w}=a.useThree(),[z,b]=S.useState(!1),[E,C]=S.useReducer(((e,{object:t,shift:r})=>void 0===t?[]:Array.isArray(t)?t:r?e.includes(t)?e.filter((e=>e!==t)):[t,...e]:e[0]===t?[]:[t]),[]);S.useEffect((()=>{m?null==n||n(E):null==o||o(E)}),[E,m]);const P=S.useCallback((e=>{e.stopPropagation(),C({object:l([e.object])[0],shift:t&&e.shiftKey})}),[]),R=S.useCallback((e=>!z&&C({})),[z]),D=S.useRef(null);return S.useEffect((()=>{if(!e||!t)return;const r=new c.SelectionBox(h,D.current),n=document.createElement("div");n.style.pointerEvents="none",n.style.border=i,n.style.backgroundColor=s,n.style.position="fixed";const a=new T.Vector2,o=new T.Vector2,d=new T.Vector2,m=w().events.enabled,x=null==v?void 0:v.enabled;let z=!1;function b(e,t){const{offsetX:r,offsetY:n}=e,{width:a,height:o}=g;t.set(r/a*2-1,-n/o*2+1)}function E(e){e.shiftKey&&(!function(e){var t;v&&(v.enabled=!1),p({enabled:!1}),f(z=!0),null==(t=y.domElement.parentElement)||t.appendChild(n),n.style.left=`${e.clientX}px`,n.style.top=`${e.clientY}px`,n.style.width="0px",n.style.height="0px",a.x=e.clientX,a.y=e.clientY}(e),b(e,r.startPoint))}let M=[];function S(e){if(z){!function(e){d.x=Math.max(a.x,e.clientX),d.y=Math.max(a.y,e.clientY),o.x=Math.min(a.x,e.clientX),o.y=Math.min(a.y,e.clientY),n.style.left=`${o.x}px`,n.style.top=`${o.y}px`,n.style.width=d.x-o.x+"px",n.style.height=d.y-o.y+"px"}(e),b(e,r.endPoint);const t=r.select().sort((e=>e.uuid)).filter((e=>e.isMesh));u.shallow(t,M)||(M=t,C({object:l(t)}))}}function P(e){var t;z&&z&&(v&&(v.enabled=x),p({enabled:m}),f(z=!1),null==(t=n.parentElement)||t.removeChild(n))}return document.addEventListener("pointerdown",E,{passive:!0}),document.addEventListener("pointermove",S,{passive:!0,capture:!0}),document.addEventListener("pointerup",P,{passive:!0}),()=>{document.removeEventListener("pointerdown",E),document.removeEventListener("pointermove",S,!0),document.removeEventListener("pointerup",P)}}),[g.width,g.height,x,h,v,y]),S.createElement("group",M.default({ref:D,onClick:P,onPointerOver:()=>b(!0),onPointerOut:()=>b(!1),onPointerMissed:R},d),S.createElement(J.Provider,{value:E},r))},exports.Shadow=fa,exports.ShadowAlpha=function({opacity:e,alphaMap:t}){const r=S.useRef(null),n=S.useRef(null),o=S.useRef({value:1}),i=S.useRef({value:null}),s=S.useRef({value:!1});return S.useLayoutEffect((()=>{r.current.onBeforeCompile=n.current.onBeforeCompile=e=>{const t=e.fragmentShader.indexOf("void main");let r,n="",a=t;for(;"\n"!==r&&a<t+100;)r=e.fragmentShader.charAt(a),n+=r,a++;n=n.trim(),e.vertexShader=e.vertexShader.replace("void main() {","\n        varying vec2 custom_vUv;\n\n        void main() {\n          custom_vUv = uv;\n          \n        "),e.fragmentShader=e.fragmentShader.replace(n,"\n          uniform float uShadowOpacity;\n          uniform sampler2D uAlphaMap;\n          uniform bool uHasAlphaMap;\n\n          varying vec2 custom_vUv;\n  \n          float bayerDither2x2( vec2 v ) {\n            return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );\n          }\n    \n          float bayerDither4x4( vec2 v ) {\n            vec2 P1 = mod( v, 2.0 );\n            vec2 P2 = mod( floor( 0.5  * v ), 2.0 );\n            return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );\n          }\n  \n          void main() {\n            float alpha = \n              uHasAlphaMap ? \n                uShadowOpacity * texture2D(uAlphaMap, custom_vUv).x\n              : uShadowOpacity;\n\n            if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;\n            \n          "),e.uniforms.uShadowOpacity=o.current,e.uniforms.uAlphaMap=i.current,e.uniforms.uHasAlphaMap=s.current}}),[]),a.useFrame((()=>{var n;const a=null==(n=r.current.__r3f)||null==(n=n.parent)?void 0:n.object;if(a){const r=a.material;r&&(o.current.value=null!=e?e:r.opacity,!1===t?(i.current.value=null,s.current.value=!1):(i.current.value=t||r.alphaMap,s.current.value=!!i.current.value))}})),S.createElement(S.Fragment,null,S.createElement("meshDepthMaterial",{ref:r,attach:"customDepthMaterial",depthPacking:T.RGBADepthPacking}),S.createElement("meshDistanceMaterial",{ref:n,attach:"customDistanceMaterial"}))},exports.Shape=Tn,exports.Sky=Pa,exports.SoftShadows=function({focus:e=0,samples:t=10,size:r=25}){const n=a.useThree((e=>e.gl)),o=a.useThree((e=>e.scene)),i=a.useThree((e=>e.camera));return S.useEffect((()=>{const a=T.ShaderChunk.shadowmap_pars_fragment;return T.ShaderChunk.shadowmap_pars_fragment=T.ShaderChunk.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP\n"+(({focus:e=0,size:t=25,samples:r=10}={})=>`\n#define PENUMBRA_FILTER_SIZE float(${t})\n#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))\nvec3 randRGB(vec2 uv) {\n  return vec3(\n    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),\n    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),\n    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)\n  );\n}\n\nvec3 lowPassRandRGB(vec2 uv) {\n  // 3x3 convolution (average)\n  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9\n  vec3 result = vec3(0);\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));\n  result *= 0.111111111; // 1.0 / 9.0\n  return result;\n}\nvec3 highPassRandRGB(vec2 uv) {\n  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal\n  // hp(x) = x - lp(x)\n  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;\n}\n\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\nfloat penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation\n  return (zReceiver - zBlocker) / zBlocker;\n}\nfloat findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float blockerDepthSum = float(${e});\n  float blockers = 0.0;\n\n  int j = 0;\n  vec2 offset = vec2(0.);\n  float depth = 0.;\n\n  #pragma unroll_loop_start\n  for(int i = 0; i < ${r}; i ++) {\n    offset = (vogelDiskSample(j, ${r}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;\n    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));\n    if (depth < compare) {\n      blockerDepthSum += depth;\n      blockers++;\n    }\n    j++;\n  }\n  #pragma unroll_loop_end\n\n  if (blockers > 0.0) {\n    return blockerDepthSum / blockers;\n  }\n  return -1.0;\n}\n\n        \nfloat vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float shadow = 0.0f;\n  int j = 0;\n  vec2 vogelSample = vec2(0.0);\n  vec2 offset = vec2(0.0);\n  #pragma unroll_loop_start\n  for (int i = 0; i < ${r}; i++) {\n    vogelSample = vogelDiskSample(j, ${r}, angle) * texelSize;\n    offset = vogelSample * (1.0 + filterRadius * float(${t}));\n    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    j++;\n  }\n  #pragma unroll_loop_end\n  return shadow * 1.0 / ${r}.0;\n}\n\nfloat PCSS (sampler2D shadowMap, vec4 coords) {\n  vec2 uv = coords.xy;\n  float zReceiver = coords.z; // Assumed to be eye-space z in this code\n  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;\n  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);\n  if (avgBlockerDepth == -1.0) {\n    return 1.0;\n  }\n  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\n  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);\n}`)({size:r,samples:t,focus:e})).replace("#if defined( SHADOWMAP_TYPE_PCF )","\nreturn PCSS(shadowMap, shadowCoord);\n#if defined( SHADOWMAP_TYPE_PCF )"),sn(n,o,i),()=>{T.ShaderChunk.shadowmap_pars_fragment=a,sn(n,o,i)}}),[e,r,t]),null},exports.Sparkles=qa,exports.Sphere=fn,exports.Splat=function({src:e,toneMapped:t=!1,alphaTest:r=0,alphaHash:n=!1,chunkSize:o=25e3,...i}){a.extend({SplatMaterial:Ke});const s=S.useRef(null),l=a.useThree((e=>e.gl)),c=a.useThree((e=>e.camera)),u=a.useLoader(et,e,(e=>{e.gl=l,e.chunkSize=o}));return S.useLayoutEffect((()=>u.connect(s.current)),[e]),a.useFrame((()=>u.update(s.current,c,n))),S.createElement("mesh",M.default({ref:s,frustumCulled:!1},i),S.createElement("splatMaterial",{key:`${e}/${r}/${n}${Ke.key}`,transparent:!n,depthTest:!0,alphaTest:n?0:r,centerAndScaleTexture:u.centerAndScaleTexture,covAndColorTexture:u.covAndColorTexture,depthWrite:!!n||r>0,blending:n?T.NormalBlending:T.CustomBlending,blendSrcAlpha:T.OneFactor,alphaHash:!!n,toneMapped:t}))},exports.SpotLight=Sa,exports.SpotLightShadow=function(e){return e.shader?S.createElement(Ea,e):S.createElement(Ma,e)},exports.SpriteAnimator=jr,exports.Stage=function({children:e,center:t,adjustCamera:r=!0,intensity:n=.5,shadows:a="contact",environment:o="city",preset:i="rembrandt",...s}){var l,c,u,d,m,f,p,h;const x="string"==typeof i?ua[i]:i,[{radius:y,height:v},g]=S.useState({radius:0,width:0,height:0,depth:0}),w=null!==(l=null==a?void 0:a.bias)&&void 0!==l?l:-1e-4,z=null!==(c=null==a?void 0:a.normalBias)&&void 0!==c?c:0,b=null!==(u=null==a?void 0:a.size)&&void 0!==u?u:1024,E=null!==(d=null==a?void 0:a.offset)&&void 0!==d?d:0,C="contact"===a||"contact"===(null==a?void 0:a.type),T="accumulative"===a||"accumulative"===(null==a?void 0:a.type),P={..."object"==typeof a?a:{}},R=o?"string"==typeof o?{preset:o}:o:null,D=S.useCallback((e=>{const{width:r,height:n,depth:a,boundingSphere:o}=e;g({radius:o.radius,width:r,height:n,depth:a}),null!=t&&t.onCentered&&t.onCentered(e)}),[]);return S.createElement(S.Fragment,null,S.createElement("ambientLight",{intensity:n/3}),S.createElement("spotLight",{penumbra:1,position:[x.main[0]*y,x.main[1]*y,x.main[2]*y],intensity:2*n,castShadow:!!a,"shadow-bias":w,"shadow-normalBias":z,"shadow-mapSize":b}),S.createElement("pointLight",{position:[x.fill[0]*y,x.fill[1]*y,x.fill[2]*y],intensity:n}),S.createElement(Un,M.default({fit:!!r,clip:!!r,margin:Number(r),observe:!0},s),S.createElement(da,{radius:y,adjustCamera:r}),S.createElement(wr,M.default({},t,{position:[0,E/2,0],onCentered:D}),e)),S.createElement("group",{position:[0,-v/2-E/2,0]},C&&S.createElement(aa,M.default({scale:4*y,far:y,blur:2},P)),T&&S.createElement(sa,M.default({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:4*y},P),S.createElement(la,{amount:null!==(m=P.amount)&&void 0!==m?m:8,radius:null!==(f=P.radius)&&void 0!==f?f:y,ambient:null!==(p=P.ambient)&&void 0!==p?p:.5,intensity:null!==(h=P.intensity)&&void 0!==h?h:1,position:[x.main[0]*y,x.main[1]*y,x.main[2]*y],size:4*y,bias:-w,mapSize:b}))),o&&S.createElement(na,R))},exports.Stars=Fa,exports.Stats=function({showPanel:e=0,className:t,parent:r}){const n=function(e,t=[],r){const[n,a]=S.useState();return S.useLayoutEffect((()=>{const t=e();return a(t),cr(r,t),()=>cr(r,null)}),t),n}((()=>new R.default),[]);return S.useEffect((()=>{if(n){const o=r&&r.current||document.body;n.showPanel(e),null==o||o.appendChild(n.dom);const i=(null!=t?t:"").split(" ").filter((e=>e));i.length&&n.dom.classList.add(...i);const s=a.addEffect((()=>n.begin())),l=a.addAfterEffect((()=>n.end()));return()=>{i.length&&n.dom.classList.remove(...i),null==o||o.removeChild(n.dom),s(),l()}}}),[r,n,t,e]),null},exports.StatsGl=ur,exports.Svg=$e,exports.Tetrahedron=vn,exports.Text=he,exports.Text3D=we,exports.Texture=({children:e,input:t,onLoad:r})=>{const n=Se(t,r);return S.createElement(S.Fragment,null,null==e?void 0:e(n))},exports.Torus=xn,exports.TorusKnot=yn,exports.TrackballControls=dt,exports.Trail=Be,exports.TrailTexture=({children:e,...t})=>{const r=gr(t);return S.createElement(S.Fragment,null,null==e?void 0:e(r))},exports.TransformControls=ft,exports.Tube=hn,exports.VideoTexture=nr,exports.View=Zo,exports.WebcamVideoTexture=ji,exports.Wireframe=function({geometry:e,...t}){return e?S.createElement(ro,M.default({geometry:e},t)):S.createElement(no,t)},exports.accumulativeContext=oa,exports.calcPosFromAngles=Ta,exports.calculateScaleFactor=ie,exports.checkIfFrameIsEmpty=ir,exports.createInstances=function(){const e=S.createContext(null);return[S.forwardRef(((t,r)=>S.createElement(Ir,M.default({ref:r,context:e},t)))),S.forwardRef(((t,r)=>S.createElement(Lr,M.default({ref:r,context:e},t))))]},exports.getFirstFrame=or,exports.isWebGL2Available=()=>{try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}},exports.meshBounds=function(e,t){const r=this.geometry,n=this.material,a=this.matrixWorld;void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),To.copy(r.boundingSphere),To.applyMatrix4(a),!1!==e.ray.intersectsSphere(To)&&(So.copy(a).invert(),Co.copy(e.ray).applyMatrix4(So),null!==r.boundingBox&&null===Co.intersectBox(r.boundingBox,Po)||t.push({distance:Po.distanceTo(e.ray.origin),point:Po.clone(),object:this})))},exports.shaderMaterial=Ee,exports.useAnimations=function(e,t){const r=S.useRef(null),[o]=S.useState((()=>t?t instanceof n.Object3D?{current:t}:t:r)),[i]=S.useState((()=>new n.AnimationMixer(void 0)));S.useLayoutEffect((()=>{t&&(o.current=t instanceof n.Object3D?t:t.current),i._root=o.current}));const s=S.useRef({}),l=S.useMemo((()=>{const t={};return e.forEach((e=>Object.defineProperty(t,e.name,{enumerable:!0,get(){if(o.current)return s.current[e.name]||(s.current[e.name]=i.clipAction(e,o.current))},configurable:!0}))),{ref:o,clips:e,actions:t,names:e.map((e=>e.name)),mixer:i}}),[e]);return a.useFrame(((e,t)=>i.update(t))),S.useEffect((()=>{const e=o.current;return()=>{s.current={},i.stopAllAction(),Object.values(l.actions).forEach((t=>{e&&i.uncacheAction(t,e)}))}}),[e]),l},exports.useAspect=function(e,t,r=1){const n=a.useThree((e=>e.viewport)),o=t*(n.aspect>e/t?n.width/e:n.height/t);return[e*(n.aspect>e/t?n.width/e:n.height/t)*r,o*r,1]},exports.useBVH=function(e,t){t={strategy:g.SAH,verbose:!1,setBoundingBox:!0,maxDepth:40,maxLeafTris:10,indirect:!1,...t},S.useEffect((()=>{if(e.current){e.current.raycast=g.acceleratedRaycast;const r=e.current.geometry;return r.computeBoundsTree=g.computeBoundsTree,r.disposeBoundsTree=g.disposeBoundsTree,r.computeBoundsTree(t),()=>{r.boundsTree&&r.disposeBoundsTree()}}}),[e,JSON.stringify(t)])},exports.useBounds=Vn,exports.useBoxProjectedEnv=function(e=new T.Vector3,t=new T.Vector3){const[r]=S.useState((()=>({position:new T.Vector3,size:new T.Vector3})));a.applyProps(r,{position:e,size:t});const n=S.useRef(null),o=S.useMemo((()=>({ref:n,onBeforeCompile:e=>function(e,t,r){e.defines.BOX_PROJECTED_ENV_MAP=!0,e.uniforms.envMapPosition={value:t},e.uniforms.envMapSize={value:r},e.vertexShader=`\n  varying vec3 vWorldPosition;\n  ${e.vertexShader.replace("#include <worldpos_vertex>","\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n  vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n  #ifdef BOX_PROJECTED_ENV_MAP\n    vWorldPosition = worldPosition.xyz;\n  #endif\n#endif\n")}`,e.fragmentShader=`\n    \n#ifdef BOX_PROJECTED_ENV_MAP\n  uniform vec3 envMapSize;\n  uniform vec3 envMapPosition;\n  varying vec3 vWorldPosition;\n    \n  vec3 parallaxCorrectNormal( vec3 v, vec3 cubeSize, vec3 cubePos ) {\n    vec3 nDir = normalize( v );\n    vec3 rbmax = ( .5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbmin = ( -.5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbminmax;\n    rbminmax.x = ( nDir.x > 0. ) ? rbmax.x : rbmin.x;\n    rbminmax.y = ( nDir.y > 0. ) ? rbmax.y : rbmin.y;\n    rbminmax.z = ( nDir.z > 0. ) ? rbmax.z : rbmin.z;\n    float correction = min( min( rbminmax.x, rbminmax.y ), rbminmax.z );\n    vec3 boxIntersection = vWorldPosition + nDir * correction;    \n    return boxIntersection - cubePos;\n  }\n#endif\n\n    ${e.fragmentShader.replace("#include <envmap_physical_pars_fragment>",T.ShaderChunk.envmap_physical_pars_fragment).replace("vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n         \n#ifdef BOX_PROJECTED_ENV_MAP\n  worldNormal = parallaxCorrectNormal( worldNormal, envMapSize, envMapPosition );\n#endif\n\n         ").replace("reflectVec = inverseTransformDirection( reflectVec, viewMatrix );","reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n         \n#ifdef BOX_PROJECTED_ENV_MAP\n  reflectVec = parallaxCorrectNormal( reflectVec, envMapSize, envMapPosition );\n#endif\n\n        ")}`}(e,r.position,r.size),customProgramCacheKey:()=>JSON.stringify(r.position.toArray())+JSON.stringify(r.size.toArray())})),[...r.position.toArray(),...r.size.toArray()]);return S.useLayoutEffect((()=>{n.current.needsUpdate=!0}),[r]),o},exports.useCamera=function(e,t){const r=a.useThree((e=>e.pointer)),[o]=S.useState((()=>{const o=new n.Raycaster;return t&&a.applyProps(o,t),function(t,a){o.setFromCamera(r,e instanceof n.Camera?e:e.current);const i=this.constructor.prototype.raycast.bind(this);i&&i(o,a)}}));return o},exports.useContextBridge=function(...e){const t=S.useRef([]);return t.current=e.map((e=>S.useContext(e))),S.useMemo((()=>({children:r})=>e.reduceRight(((e,r,n)=>S.createElement(r.Provider,{value:t.current[n],children:e})),r)),[])},exports.useCubeCamera=it,exports.useCubeTexture=Yt,exports.useCursor=function(e,t="pointer",r="auto",n=document.body){S.useEffect((()=>{if(e)return n.style.cursor=t,()=>{n.style.cursor=r}}),[e])},exports.useDepthBuffer=function({size:e=256,frames:t=1/0}={}){const r=a.useThree((e=>e.viewport.dpr)),{width:o,height:i}=a.useThree((e=>e.size)),s=e||o*r,l=e||i*r,c=S.useMemo((()=>{const e=new n.DepthTexture(s,l);return e.format=n.DepthFormat,e.type=n.UnsignedShortType,{depthTexture:e}}),[s,l]);let u=0;const d=rt(s,l,c);return a.useFrame((e=>{(t===1/0||u<t)&&(e.gl.setRenderTarget(d),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),u++)})),d.depthTexture},exports.useDetectGPU=dr,exports.useEnvironment=$n,exports.useFBO=rt,exports.useFBX=Qt,exports.useFaceControls=()=>t.useContext(ts),exports.useFaceLandmarker=Ki,exports.useFont=ve,exports.useGLTF=Ye,exports.useGizmoContext=Mt,exports.useHelper=lr,exports.useIntersect=pr,exports.useKTX2=Jt,exports.useKeyboardControls=function(e){const[t,r,n]=S.useContext(K);return e?n(e):[t,r]},exports.useMask=function(e,t=!1){return{stencilWrite:!0,stencilRef:e,stencilFunc:t?T.NotEqualStencilFunc:T.EqualStencilFunc,stencilFail:T.KeepStencilOp,stencilZFail:T.KeepStencilOp,stencilZPass:T.KeepStencilOp}},exports.useMatcapTexture=Xa,exports.useMotion=vt,exports.useNormalTexture=Za,exports.usePerformanceMonitor=function({onIncline:e,onDecline:r,onChange:n,onFallback:a}){const o=t.useContext(Ro),i=t.useRef({onIncline:e,onDecline:r,onChange:n,onFallback:a});t.useLayoutEffect((()=>{i.current.onIncline=e,i.current.onDecline=r,i.current.onChange=n,i.current.onFallback=a}),[e,r,n,a]),t.useLayoutEffect((()=>o.subscribe(i)),[o])},exports.useProgress=G,exports.useScroll=X,exports.useSelect=function(){return S.useContext(J)},exports.useSpriteAnimator=function(){return S.useContext(Or)},exports.useSpriteLoader=sr,exports.useSurfaceSampler=Ue,exports.useTexture=Se,exports.useTrail=Ie,exports.useTrailTexture=gr,exports.useVideoTexture=rr;
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/index.js:export { Environment, EnvironmentCube, EnvironmentMap, EnvironmentPortal } from './core/Environment.js';
./node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/index.js:export { useEnvironment } from './core/useEnvironment.js';
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/webxr/XRControllerModelFactory.js:const applyEnvironmentMap = (envMap, obj) => {
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/webxr/XRControllerModelFactory.js:  setEnvironmentMap(envMap) {
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/webxr/XRControllerModelFactory.js:    applyEnvironmentMap(this.envMap, this);
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/webxr/XRControllerModelFactory.js:    applyEnvironmentMap(controllerModel.envMap, scene);
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/webxr/XRControllerModelFactory.d.ts:    setEnvironmentMap(envMap: Texture): XRControllerModel;
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/environments/RoomEnvironment.js:function RoomEnvironment() {
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/environments/RoomEnvironment.js:  RoomEnvironment
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/environments/RoomEnvironment.js://# sourceMappingURL=RoomEnvironment.js.map
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/environments/RoomEnvironment.d.ts: * https://github.com/google/model-viewer/blob/master/packages/model-viewer/src/three-components/EnvironmentScene.ts
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/environments/RoomEnvironment.d.ts:declare function RoomEnvironment(): THREE.Scene;
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/environments/RoomEnvironment.d.ts:export { RoomEnvironment };
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/index.js:import { RoomEnvironment } from "./environments/RoomEnvironment.js";
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/index.js:  RoomEnvironment,
./node_modules/.pnpm/three-stdlib@2.36.0_three@0.180.0/node_modules/three-stdlib/index.d.ts:export * from './environments/RoomEnvironment';
./node_modules/.pnpm/@types+webxr@0.5.23/node_modules/@types/webxr/index.d.ts:type XREnvironmentBlendMode = "opaque" | "additive" | "alpha-blend";
./node_modules/.pnpm/@types+webxr@0.5.23/node_modules/@types/webxr/index.d.ts:    readonly environmentBlendMode: XREnvironmentBlendMode;
./node_modules/.pnpm/tunnel-rat@0.1.2_@types+react@19.1.13_react@19.1.1/node_modules/tunnel-rat/jest.config.js:  testEnvironment: 'jsdom',
./node_modules/.pnpm/react-reconciler@0.31.0_react@19.1.1/node_modules/react-reconciler/cjs/react-reconciler.development.js:    function isConcurrentActEnvironment() {
./node_modules/.pnpm/react-reconciler@0.31.0_react@19.1.1/node_modules/react-reconciler/cjs/react-reconciler.development.js:      var isReactActEnvironmentGlobal =
./node_modules/.pnpm/react-reconciler@0.31.0_react@19.1.1/node_modules/react-reconciler/cjs/react-reconciler.development.js:      isReactActEnvironmentGlobal ||
./node_modules/.pnpm/react-reconciler@0.31.0_react@19.1.1/node_modules/react-reconciler/cjs/react-reconciler.development.js:      return isReactActEnvironmentGlobal;
./node_modules/.pnpm/react-reconciler@0.31.0_react@19.1.1/node_modules/react-reconciler/cjs/react-reconciler.development.js:      isConcurrentActEnvironment() &&
./node_modules/.pnpm/react-reconciler@0.31.0_react@19.1.1/node_modules/react-reconciler/cjs/react-reconciler.development.js:      isConcurrentActEnvironment() &&
./node_modules/.pnpm/@supabase+supabase-js@2.57.4/node_modules/@supabase/supabase-js/dist/umd/supabase.js:!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.supabase=t():e.supabase=t()}(self,(()=>(()=>{"use strict";var e={745:(e,t,s)=>{s.r(t),s.d(t,{AuthAdminApi:()=>Se,AuthApiError:()=>u,AuthClient:()=>Te,AuthError:()=>c,AuthImplicitGrantRedirectError:()=>m,AuthInvalidCredentialsError:()=>w,AuthInvalidJwtError:()=>j,AuthInvalidTokenResponseError:()=>y,AuthPKCEGrantCodeExchangeError:()=>_,AuthRetryableFetchError:()=>k,AuthSessionMissingError:()=>g,AuthUnknownError:()=>f,AuthWeakPasswordError:()=>T,CustomAuthError:()=>p,GoTrueAdminApi:()=>he,GoTrueClient:()=>ke,NavigatorLockAcquireTimeoutError:()=>pe,SIGN_OUT_SCOPES:()=>ce,isAuthApiError:()=>d,isAuthError:()=>h,isAuthImplicitGrantRedirectError:()=>b,isAuthRetryableFetchError:()=>S,isAuthSessionMissingError:()=>v,isAuthWeakPasswordError:()=>E,lockInternals:()=>de,navigatorLock:()=>ve,processLock:()=>we});const r="2.71.1",i=3e4,n={"X-Client-Info":`gotrue-js/${r}`},o="X-Supabase-Api-Version",a={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},l=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class c extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function h(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class u extends c{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function d(e){return h(e)&&"AuthApiError"===e.name}class f extends c{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class p extends c{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class g extends p{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function v(e){return h(e)&&"AuthSessionMissingError"===e.name}class y extends p{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class w extends p{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class m extends p{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function b(e){return h(e)&&"AuthImplicitGrantRedirectError"===e.name}class _ extends p{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class k extends p{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function S(e){return h(e)&&"AuthRetryableFetchError"===e.name}class T extends p{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}function E(e){return h(e)&&"AuthWeakPasswordError"===e.name}class j extends p{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),P=" \t\n\r=".split(""),A=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<P.length;t+=1)e[P[t].charCodeAt(0)]=-2;for(let t=0;t<O.length;t+=1)e[O[t].charCodeAt(0)]=t;return e})();function C(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(O[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(O[e]),t.queuedBits-=6}}function $(e,t,s){const r=A[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function x(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},n=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,r,s)};for(let t=0;t<e.length;t+=1)$(e.charCodeAt(t),i,n);return t.join("")}function R(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function I(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)$(e.charCodeAt(t),s,r);return new Uint8Array(t)}function U(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach((e=>C(e,s,r))),C(null,s,r),t.join("")}const L=()=>"undefined"!=typeof window&&"undefined"!=typeof document,N={tested:!1,writable:!1},D=()=>{if(!L())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(N.tested)return N.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),N.tested=!0,N.writable=!0}catch(e){N.tested=!0,N.writable=!1}return N.writable},F=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},M=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,B=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},q=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(e){return s}},W=async(e,t)=>{await e.removeItem(t)};class H{constructor(){this.promise=new H.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function K(e){const t=e.split(".");if(3!==t.length)throw new j("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!l.test(t[e]))throw new j("JWT not in base64url format");return{header:JSON.parse(x(t[0])),payload:JSON.parse(x(t[1])),signature:I(t[2]),raw:{header:t[0],payload:t[1]}}}function z(e){return("0"+e.toString(16)).substr(-2)}async function J(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,z).join("")}();let i=r;s&&(i+="/PASSWORD_RECOVERY"),await B(e,`${t}-code-verifier`,i);const n=await async function(e){if("undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder)return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(r);return[n,r===n?"plain":"s256"]}H.promiseConstructor=Promise;const G=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,V=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Y(e){if(!V.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Q(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function X(e){return JSON.parse(JSON.stringify(e))}const Z=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ee=[502,503,504];async function te(e){var t;if(!M(e))throw new k(Z(e),0);if(ee.includes(e.status))throw new k(Z(e),e.status);let s,r;try{s=await e.json()}catch(e){throw new f(Z(e),e)}const i=function(e){const t=e.headers.get(o);if(!t)return null;if(!t.match(G))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=a["2024-01-01"].timestamp&&"object"==typeof s&&s&&"string"==typeof s.code?r=s.code:"object"==typeof s&&s&&"string"==typeof s.error_code&&(r=s.error_code),r){if("weak_password"===r)throw new T(Z(s),e.status,(null===(t=s.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new g}else if("object"==typeof s&&s&&"object"==typeof s.weak_password&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new T(Z(s),e.status,s.weak_password.reasons);throw new u(Z(s),e.status||500,r)}async function se(e,t,s,r){var i;const n=Object.assign({},null==r?void 0:r.headers);n[o]||(n[o]=a["2024-01-01"].name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);const l=null!==(i=null==r?void 0:r.query)&&void 0!==i?i:{};(null==r?void 0:r.redirectTo)&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",h=await async function(e,t,s,r,i,n){const o=((e,t,s,r)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),s))})(t,r,{},n);let a;try{a=await e(s,Object.assign({},o))}catch(e){throw console.error(e),new k(Z(e),0)}if(a.ok||await te(a),null==r?void 0:r.noResolveJson)return a;try{return await a.json()}catch(e){await te(e)}}(e,t,s+c,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},0,null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(h):{data:Object.assign({},h),error:null}}function re(e){var t;let s=null;var r;return function(e){return e.access_token&&e.refresh_token&&e.expires_in}(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r))),{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ie(e){const t=re(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function ne(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function oe(e){return{data:e,error:null}}function ae(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:n}=e,o=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:n},user:Object.assign({},o)},error:null}}function le(e){return e}const ce=["global","local","others"];class he{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=F(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ce[0]){if(ce.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ce.join(", ")}`);try{return await se(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(h(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await se(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ne})}catch(e){if(h(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:ae,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(h(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await se(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ne})}catch(e){if(h(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,s,r,i,n,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(i=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==i?i:""},xform:le});if(c.error)throw c.error;const h=await c.json(),u=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t})),l.total=parseInt(u)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(e){if(h(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){Y(e);try{return await se(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ne})}catch(e){if(h(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){Y(e);try{return await se(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ne})}catch(e){if(h(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){Y(e);try{return await se(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ne})}catch(e){if(h(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){Y(e.userId);try{const{data:t,error:s}=await se(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(e){if(h(e))return{data:null,error:e};throw e}}async _deleteFactor(e){Y(e.userId),Y(e.id);try{return{data:await se(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(h(e))return{data:null,error:e};throw e}}}function ue(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const de={debug:!!(globalThis&&D()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class fe extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class pe extends fe{}class ge extends fe{}async function ve(e,t,s){de.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),de.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw de.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new pe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(de.debug)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}de.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await s()}finally{de.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}const ye={};async function we(e,t,s){var r;const i=null!==(r=ye[e])&&void 0!==r?r:Promise.resolve(),n=Promise.race([i.catch((()=>null)),t>=0?new Promise(((s,r)=>{setTimeout((()=>{r(new ge(`Acquring process lock with name "${e}" timed out`))}),t)})):null].filter((e=>e))).catch((e=>{if(e&&e.isAcquireTimeout)throw e;return null})).then((async()=>await s()));return ye[e]=n.catch((async e=>{if(e&&e.isAcquireTimeout)return await i,null;throw e})),await n}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const me={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:n,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function be(e,t,s){return await s()}const _e={};class ke{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ke.nextInstanceID,ke.nextInstanceID+=1,this.instanceID>0&&L()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},me),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new he({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=F(r.fetch),this.lock=r.lock||be,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:L()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=ve:this.lock=be,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:D()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ue(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=ue(this.memoryStorage)),L()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=_e[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){_e[this.storageKey]=Object.assign(Object.assign({},_e[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=_e[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){_e[this.storageKey]=Object.assign(Object.assign({},_e[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${r}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach(((e,s)=>{t[s]=e}))}catch(e){}return s.searchParams.forEach(((e,s)=>{t[s]=e})),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),L()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),b(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:n,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",o),await this._saveSession(n),setTimeout((async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return h(e)?{error:e}:{error:new f("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const i=await se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:re}),{data:n,error:o}=i;if(o||!n)return{data:{user:null,session:null},error:o};const a=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,s,r;try{let i;if("email"in e){const{email:s,password:r,options:n}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await J(this.storage,this.storageKey)),i=await se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:o,code_challenge_method:a},xform:re})}else{if(!("phone"in e))throw new w("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:o}=e;i=await se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(s=null==o?void 0:o.data)&&void 0!==s?s:{},channel:null!==(r=null==o?void 0:o.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:re})}}const{data:n,error:o}=i;if(o||!n)return{data:{user:null,session:null},error:o};const a=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:i}=e;t=await se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:ie})}else{if(!("phone"in e))throw new w("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:i}=e;t=await se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:ie})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new y}}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,r,i,n,o,a,l,c,u,d,f;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:h,wallet:d,statement:f,options:v}=e;let y;if(L())if("object"==typeof d)y=d;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");y=e.solana}else{if("object"!=typeof d||!(null==v?void 0:v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=d}const w=new URL(null!==(t=null==v?void 0:v.url)&&void 0!==t?t:window.location.href);if("signIn"in y&&y.signIn){const e=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==v?void 0:v.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),f?{statement:f}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");p="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),g=t.signature}else{if(!("signMessage"in y&&"function"==typeof y.signMessage&&"publicKey"in y&&"object"==typeof y&&y.publicKey&&"toBase58"in y.publicKey&&"function"==typeof y.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${w.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${null!==(r=null===(s=null==v?void 0:v.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==r?r:(new Date).toISOString()}`,...(null===(i=null==v?void 0:v.signInWithSolana)||void 0===i?void 0:i.notBefore)?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...(null===(n=null==v?void 0:v.signInWithSolana)||void 0===n?void 0:n.expirationTime)?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...(null===(o=null==v?void 0:v.signInWithSolana)||void 0===o?void 0:o.chainId)?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...(null===(a=null==v?void 0:v.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...(null===(l=null==v?void 0:v.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...(null===(u=null===(c=null==v?void 0:v.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===u?void 0:u.length)?["Resources",...v.signInWithSolana.resources.map((e=>`- ${e}`))]:[]].join("\n");const e=await y.signMessage((new TextEncoder).encode(p),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=e}}try{const{data:t,error:s}=await se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:U(g)},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(f=e.options)||void 0===f?void 0:f.captchaToken}}:null),xform:re});if(s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new y}}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async _exchangeCodeForSession(e){const t=await q(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:i}=await se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:re});if(await W(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new y}}catch(e){if(h(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:i,nonce:n}=e,o=await se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:re}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new y}}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,s,r,i,n;try{if("email"in e){const{email:r,options:i}=e;let n=null,o=null;"pkce"===this.flowType&&([n,o]=await J(this.storage,this.storageKey));const{error:a}=await se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(s=null==i?void 0:i.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:n,code_challenge_method:o},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:s}=e,{data:o,error:a}=await se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(i=null==s?void 0:s.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new w("You must provide either an email or phone number.")}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:n,error:o}=await se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:re});if(o)throw o;if(!n)throw new Error("An error occurred on token verification.");const a=n.session,l=n.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,s,r;try{let i=null,n=null;return"pkce"===this.flowType&&([i,n]=await J(this.storage,this.storageKey)),await se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:n}),headers:this.headers,xform:oe})}catch(e){if(h(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new g;const{error:r}=await se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:n}=await se(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){const{phone:s,type:r,options:i}=e,{data:n,error:o}=await se(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:o}}throw new w("You must provide either an email or phone number and a type")}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await q(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const t=await q(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=Q()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,(async()=>await this._getUser())))}async _getUser(e){try{return e?await se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ne}):await this._useSession((async e=>{var t,s,r;const{data:i,error:n}=e;if(n)throw n;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:ne}):{data:{user:null},error:new g}}))}catch(e){if(h(e))return v(e)&&(await this._removeSession(),await W(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new g;const n=r.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await J(this.storage,this.storageKey));const{data:l,error:c}=await se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:n.access_token,xform:ne});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}}))}catch(e){if(h(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new g;const t=Date.now()/1e3;let s=t,r=!0,i=null;const{payload:n}=K(e.access_token);if(n.exp&&(s=n.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:r,error:n}=await this._getUser(e.access_token);if(n)throw n;i={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(h(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var s;if(!e){const{data:r,error:i}=t;if(i)throw i;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new g;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(e){if(h(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!L())throw new m("No browser detected.");if(e.error||e.error_description||e.error_code)throw new m(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new _("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new m("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new _("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:n,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!(n&&a&&o&&c))throw new m("No session defined in URL");const h=Math.round(Date.now()/1e3),u=parseInt(a);let d=h+u;l&&(d=parseInt(l));const f=d-h;1e3*f<=i&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${u}s`);const p=d-u;h-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,h):h-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,h);const{data:g,error:v}=await this._getUser(n);if(v)throw v;const y={provider_token:s,provider_refresh_token:r,access_token:n,expires_in:u,expires_at:d,refresh_token:o,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(e){if(h(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await q(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const n=null===(s=r.session)||void 0===s?void 0:s.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!d(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await W(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession((async t=>{var s,r;try{const{data:{session:r},error:i}=t;if(i)throw i;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(t){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}}))}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await J(this.storage,this.storageKey,!0));try{return await se(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(h(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(h(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession((async t=>{var s,r,i,n,o;const{data:a,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await se(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==o?o:void 0})}));if(r)throw r;return L()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(t){if(h(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var s,r;const{data:i,error:n}=t;if(n)throw n;return await se(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})}))}catch(e){if(h(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:re})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&S(t)&&Date.now()+s-n<i},new Promise(((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await s(i);if(!r(i,null))return void e(t)}catch(e){if(!r(i,e))return void t(e)}})()})))}catch(e){if(this._debug(t,"error",e),h(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),L()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await q(this.storage,this.storageKey);if(r&&this.userStorage){let t=await q(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:r.user},await B(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:Q()}else if(r&&!r.user&&!r.user){const e=await q(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(r.user=e.user,await W(this.storage,this.storageKey+"-user"),await B(this.storage,this.storageKey,r)):r.user=Q()}if(this._debug(s,"session from storage",r),!this._isValidSession(r))return this._debug(s,"session is not valid"),void(null!==r&&await this._removeSession());const i=1e3*(null!==(t=r.expires_at)&&void 0!==t?t:1/0)-Date.now()<9e4;if(this._debug(s,`session has${i?"":" not"} expired with margin of 90000s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),S(e)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(r.access_token);!t&&(null==e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(s,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){return this._debug(s,"error",e),void console.error(e)}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new g;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new H;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new g;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(e){if(this._debug(r,"error",e),h(e)){const s={session:null,error:e};return S(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(s),s}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(e),e}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],i=Array.from(this.stateChangeEmitters.values()).map((async s=>{try{await s.callback(e,t)}catch(e){r.push(e)}}));if(await Promise.all(i),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await B(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const r=X(e);await B(this.storage,this.storageKey,r)}else{const e=X(t);await B(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await W(this.storage,this.storageKey),await W(this.storage,this.storageKey+"-code-verifier"),await W(this.storage,this.storageKey+"-user"),this.userStorage&&await W(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&L()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),i);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const e=Date.now();try{return await this._useSession((async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-e)/i);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof fe))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!L()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await J(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await se(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(e){if(h(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession((async t=>{var s,r;const{data:i,error:n}=t;if(n)return{data:null,error:n};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:l}=await se(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(s=null==i?void 0:i.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==a?void 0:a.totp)||void 0===r?void 0:r.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})}))}catch(e){if(h(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:n,error:o}=await se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:o})}))}catch(e){if(h(e))return{data:null,error:e};throw e}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(e){if(h(e))return{data:null,error:e};throw e}}))}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),i=s.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:s,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:n}=K(r.access_token);let o=null;n.aal&&(o=n.aal);let a=o;return(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==s?s:[]).length>0&&(a="aal2"),{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:n.amr||[]},error:null}}))))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find((t=>t.kid===e));if(s)return s;const r=Date.now();if(s=this.jwks.keys.find((t=>t.kid===e)),s&&this.jwks_cached_at+6e5>r)return s;const{data:i,error:n}=await se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return i.keys&&0!==i.keys.length?(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find((t=>t.kid===e)),s||null):null}async getClaims(e,t={}){try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:r,payload:i,signature:n,raw:{header:o,payload:a}}=K(s);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(i.exp);const l=r.alg&&!r.alg.startsWith("HS")&&r.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(r.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:i,header:r,signature:n},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),h=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,n,function(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}R(r,t)}}(e,(e=>t.push(e))),new Uint8Array(t)}(`${o}.${a}`)))throw new j("Invalid JWT signature");return{data:{claims:i,header:r,signature:n},error:null}}catch(e){if(h(e))return{data:null,error:e};throw e}}}ke.nextInstanceID=0;const Se=he,Te=ke},227:(e,t,s)=>{s.r(t),s.d(t,{FunctionRegion:()=>a,FunctionsClient:()=>l,FunctionsError:()=>r,FunctionsFetchError:()=>i,FunctionsHttpError:()=>o,FunctionsRelayError:()=>n});class r extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class i extends r{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class n extends r{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class o extends r{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var a;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(a||(a={}));class l{constructor(e,{headers:t={},customFetch:r,region:i=a.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s,r,a,l,c;return r=this,a=void 0,c=function*(){try{const{headers:r,method:a,body:l}=t;let c={},{region:h}=t;h||(h=this.region);const u=new URL(`${this.url}/${e}`);let d;h&&"any"!==h&&(c["x-region"]=h,u.searchParams.set("forceFunctionRegion",h)),l&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",d=l):"string"==typeof l?(c["Content-Type"]="text/plain",d=l):"undefined"!=typeof FormData&&l instanceof FormData?d=l:(c["Content-Type"]="application/json",d=JSON.stringify(l)));const f=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),r),body:d}).catch((e=>{throw new i(e)})),p=f.headers.get("x-relay-error");if(p&&"true"===p)throw new n(f);if(!f.ok)throw new o(f);let g,v=(null!==(s=f.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return g="application/json"===v?yield f.json():"application/octet-stream"===v?yield f.blob():"text/event-stream"===v?f:"multipart/form-data"===v?yield f.formData():yield f.text(),{data:g,error:null,response:f}}catch(e){return{data:null,error:e,response:e instanceof o||e instanceof n?e.context:void 0}}},new((l=void 0)||(l=Promise))((function(e,t){function s(e){try{n(c.next(e))}catch(e){t(e)}}function i(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var r;t.done?e(t.value):(r=t.value,r instanceof l?r:new l((function(e){e(r)}))).then(s,i)}n((c=c.apply(r,a||[])).next())}))}}},907:(e,t,s)=>{s.r(t),s.d(t,{Headers:()=>o,Request:()=>a,Response:()=>l,default:()=>n,fetch:()=>i});var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==s.g)return s.g;throw new Error("unable to locate global object")}();const i=r.fetch,n=r.fetch.bind(r),o=r.Headers,a=r.Request,l=r.Response},660:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(907)),n=r(s(818));t.default=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(s=e.isMaybeSingle)&&void 0!==s&&s,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,s,r,i;let o=null,a=null,l=null,c=e.status,h=e.statusText;if(e.ok){if("HEAD"!==this.method){const s=await e.text();""===s||(a="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?s:JSON.parse(s))}const i=null===(s=this.headers.get("Prefer"))||void 0===s?void 0:s.match(/count=(exact|planned|estimated)/),n=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");i&&n&&n.length>1&&(l=parseInt(n[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,c=406,h="Not Acceptable"):a=1===a.length?a[0]:null)}else{const t=await e.text();try{o=JSON.parse(t),Array.isArray(o)&&404===e.status&&(a=[],o=null,c=200,h="OK")}catch(s){404===e.status&&""===t?(c=204,h="No Content"):o={message:t}}if(o&&this.isMaybeSingle&&(null===(i=null==o?void 0:o.details)||void 0===i?void 0:i.includes("0 rows"))&&(o=null,c=200,h="OK"),o&&this.shouldThrowOnError)throw new n.default(o)}return{error:o,data:a,count:l,status:c,statusText:h}}));return this.shouldThrowOnError||(s=s.catch((e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),s.then(e,t)}returns(){return this}overrideTypes(){return this}}},961:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(45)),n=r(s(825));class o{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let c;s||r?(a=s?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{l.searchParams.append(e,t)}))):(a="POST",c=t);const h=new Headers(this.headers);return i&&h.set("Prefer",`count=${i}`),new n.default({method:a,url:l,headers:h,schema:this.schemaName,body:c,fetch:null!==(o=this.fetch)&&void 0!==o?o:fetch})}}t.default=o},818:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class s extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=s},825:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(261));class n extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";"plain"===r?i="pl":"phrase"===r?i="ph":"websearch"===r&&(i="w");const n=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}}t.default=n},45:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(825));t.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let n=!1;const o=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e))).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new i.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var r;if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:n=!0}={}){var o;if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),void 0!==t&&this.url.searchParams.set("on_conflict",t),r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(o=this.fetch)&&void 0!==o?o:fetch})}update(e,{count:t}={}){var s;return t&&this.headers.append("Prefer",`count=${t}`),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}delete({count:e}={}){var t;return e&&this.headers.append("Prefer",`count=${e}`),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}},261:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(660));class n extends i.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){const n=i?`${i}.order`:"order",o=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const i=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(n,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:n="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.get("Accept"))&&void 0!==o?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${l}"; options=${a};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}}t.default=n},279:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const i=r(s(961));t.PostgrestClient=i.default;const n=r(s(45));t.PostgrestQueryBuilder=n.default;const o=r(s(825));t.PostgrestFilterBuilder=o.default;const a=r(s(261));t.PostgrestTransformBuilder=a.default;const l=r(s(660));t.PostgrestBuilder=l.default;const c=r(s(818));t.PostgrestError=c.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default}},830:(e,t,s)=>{s.r(t),s.d(t,{REALTIME_CHANNEL_STATES:()=>P,REALTIME_LISTEN_TYPES:()=>E,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:()=>T,REALTIME_PRESENCE_LISTEN_EVENTS:()=>S,REALTIME_SUBSCRIBE_STATES:()=>j,RealtimeChannel:()=>A,RealtimeClient:()=>x,RealtimePresence:()=>O,WebSocketFactory:()=>r});const r=class{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==s.g&&void 0!==s.g.WebSocket)return{type:"native",constructor:s.g.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){const e=process.versions;if(e&&e.node){const t=e.node,s=parseInt(t.replace(/^v/,"").split(".")[0]);return s>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}};var i,n,o,a,l,c;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(i||(i={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(n||(n={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(o||(o={})),function(e){e.websocket="websocket"}(a||(a={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(l||(l={}));class h{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let n=this.HEADER_LENGTH+2;const o=s.decode(e.slice(n,n+r));n+=r;const a=s.decode(e.slice(n,n+i));return n+=i,{ref:null,topic:o,event:a,payload:JSON.parse(s.decode(e.slice(n,e.byteLength)))}}}class u{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(c||(c={}));const d=(e,t,s={})=>{var r;const i=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((s,r)=>(s[r]=f(r,e,t,i),s)),{})},f=(e,t,s,r)=>{const i=t.find((t=>t.name===e)),n=null==i?void 0:i.type,o=s[e];return n&&!r.includes(n)?p(n,o):g(o)},p=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return m(t,s)}switch(e){case c.bool:return v(t);case c.float4:case c.float8:case c.int2:case c.int4:case c.int8:case c.numeric:case c.oid:return y(t);case c.json:case c.jsonb:return w(t);case c.timestamp:return b(t);case c.abstime:case c.date:case c.daterange:case c.int4range:case c.int8range:case c.money:case c.reltime:case c.text:case c.time:case c.timestamptz:case c.timetz:case c.tsrange:case c.tstzrange:default:return g(t)}},g=e=>e,v=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},y=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},w=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},m=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const i=e.slice(1,s);try{r=JSON.parse("["+i+"]")}catch(e){r=i?i.split(","):[]}return r.map((e=>p(t,e)))}return e},b=e=>"string"==typeof e?e.replace(" ","T"):e,_=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class k{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var S,T,E,j;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(S||(S={}));class O{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=O.syncState(this.state,e,t,s),this.pendingDiffs.forEach((e=>{this.state=O.syncDiff(this.state,e,t,s)})),this.pendingDiffs=[],r()})),this.channel._on(s.diff,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=O.syncDiff(this.state,e,t,s),r())})),this.onJoin(((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})})),this.onLeave(((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,s,r){const i=this.cloneDeep(e),n=this.transformState(t),o={},a={};return this.map(i,((e,t)=>{n[e]||(a[e]=t)})),this.map(n,((e,t)=>{const s=i[e];if(s){const r=t.map((e=>e.presence_ref)),i=s.map((e=>e.presence_ref)),n=t.filter((e=>i.indexOf(e.presence_ref)<0)),l=s.filter((e=>r.indexOf(e.presence_ref)<0));n.length>0&&(o[e]=n),l.length>0&&(a[e]=l)}else o[e]=t})),this.syncDiff(i,{joins:o,leaves:a},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,((t,r)=>{var i;const n=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(r),n.length>0){const s=e[t].map((e=>e.presence_ref)),r=n.filter((e=>s.indexOf(e.presence_ref)<0));e[t].unshift(...r)}s(t,n,r)})),this.map(n,((t,s)=>{let i=e[t];if(!i)return;const n=s.map((e=>e.presence_ref));i=i.filter((e=>n.indexOf(e.presence_ref)<0)),e[t]=i,r(t,i,s),0===i.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((s=>t(s,e[s])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(T||(T={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(E||(E={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(j||(j={}));const P=n;class A{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=n.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new k(this,o.join,this.params,this.timeout),this.rejoinTimer=new u((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=n.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=n.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=n.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=n.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("error",(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=n.errored,this.rejoinTimer.scheduleTimeout())})),this._on(o.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new O(this),this.broadcastEndpointURL=_(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==n.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map((e=>e.filter)))&&void 0!==r?r:[],h=!!this.bindings[E.PRESENCE]&&this.bindings[E.PRESENCE].length>0||!0===(null===(i=this.params.config.presence)||void 0===i?void 0:i.enabled),u={},d={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:h}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError((t=>null==e?void 0:e(j.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(j.CLOSED))),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,i=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,o=[];for(let s=0;s<i;s++){const i=r[s],{filter:{event:a,schema:l,table:c,filter:h}}=i,u=t&&t[s];if(!u||u.event!==a||u.schema!==l||u.table!==c||u.filter!==h)return this.unsubscribe(),this.state=n.errored,void(null==e||e(j.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));o.push(Object.assign(Object.assign({},i),{id:u.id}))}return this.bindings.postgres_changes=o,void(e&&e(j.SUBSCRIBED))}null==e||e(j.SUBSCRIBED)})).receive("error",(t=>{this.state=n.errored,null==e||e(j.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(j.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===n.joined&&e===E.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then((()=>this.subscribe()))),this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((s=>{var r,i,n;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(i=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===i?void 0:i.broadcast)||void 0===n?void 0:n.ack)||s("ok"),o.receive("ok",(()=>s("ok"))),o.receive("error",(()=>s("error"))),o.receive("timeout",(()=>s("timed out")))}));{const{event:i,payload:n}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:n,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){return"AbortError"===e.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=n.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(o.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise((r=>{s=new k(this,o.leave,{},e),s.receive("ok",(()=>{t(),r("ok")})).receive("timeout",(()=>{t(),r("timed out")})).receive("error",(()=>{r("error")})),s.send(),this._canPush()||s.trigger("ok",{})})).finally((()=>{null==s||s.destroy()}))}teardown(){this.pushBuffer.forEach((e=>e.destroy())),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=n.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout((()=>r.abort()),s),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),n}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new k(this,e,t,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const n=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:h}=o;if(s&&[a,l,c,h].indexOf(n)>=0&&s!==this._joinRef())return;let u=this._onMessage(n,t,s);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===n})).map((e=>e.callback(u,s))):null===(i=this.bindings[n])||void 0===i||i.filter((e=>{var s,r,i,o,a,l;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,o=null===(s=e.filter)||void 0===s?void 0:s.event;return n&&(null===(r=t.ids)||void 0===r?void 0:r.includes(n))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const s=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n})).map((e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:s,commit_timestamp:r,type:i,errors:n}=e,o={schema:t,table:s,commit_timestamp:r,eventType:i,new:{},old:{},errors:n};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,s)}))}_isClosed(){return this.state===n.closed}_isJoined(){return this.state===n.joined}_isJoining(){return this.state===n.joining}_isLeaving(){return this.state===n.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&A.isEqual(e.filter,t))}))),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(o.close,{},e)}_onError(e){this._on(o.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=n.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=d(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=d(e.columns,e.old_record)),t}}const C=()=>{},$=[1e3,2e3,5e3,1e4];class x{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=C,this.ref=0,this.reconnectTimer=null,this.logger=C,this.conn=null,this.sendBuffer=[],this.serializer=new h,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))).catch((e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)})):fetch),(...e)=>t(...e)},!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${a.websocket}`,this.httpEndpoint=_(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=r.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout((()=>{this._setConnectionState("disconnected")}),100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case i.connecting:return l.Connecting;case i.open:return l.Open;case i.closing:return l.Closing;default:return l.Closed}}isConnected(){return this.connectionState()===l.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find((e=>e.topic===s));if(r)return r;{const s=new A(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:r,ref:i}=e,n=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout((()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()}),100)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t.topic!==e.topic))}_onConnMessage(e){this.decode(e.data,(e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(e){this.log("error","error in heartbeat callback",e)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:s,payload:r,ref:i}=e,n=i?`(${i})`:"",o=r.status||"";this.log("receive",`${o} ${t} ${s} ${n}`.trim(),r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(s,r,i))),this._triggerStateCallbacks("message",e)}))}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach((e=>e.teardown()))}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach((e=>e._trigger(o.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach((e=>{const s={access_token:t,version:"realtime-js/2.15.5"};t&&e.updateJoinPayload(s),e.joinedOnce&&e._isJoined()&&e._push(o.access_token,{access_token:t})})))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch((t=>{this.log("error",`error setting auth in ${e}`,t)}))}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach((s=>{try{s(t)}catch(t){this.log("error",`error in ${e} callback`,t)}}))}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new u((async()=>{setTimeout((async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),10)}),this.reconnectAfterMs)}_initializeOptions(e){var t,s,r,i,n,o,a,l,c;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(s=null==e?void 0:e.timeout)&&void 0!==s?s:1e4,this.heartbeatIntervalMs=null!==(r=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==r?r:25e3,this.worker=null!==(i=null==e?void 0:e.worker)&&void 0!==i&&i,this.accessToken=null!==(n=null==e?void 0:e.accessToken)&&void 0!==n?n:null,this.heartbeatCallback=null!==(o=null==e?void 0:e.heartbeatCallback)&&void 0!==o?o:C,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(a=null==e?void 0:e.reconnectAfterMs)&&void 0!==a?a:e=>$[e-1]||1e4,this.encode=null!==(l=null==e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null==e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}},623:(e,t,s)=>{s.r(t),s.d(t,{StorageApiError:()=>n,StorageClient:()=>E,StorageError:()=>r,StorageUnknownError:()=>o,isStorageError:()=>i});class r extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function i(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class n extends r{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class o extends r{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const a=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},l=e=>{if(Array.isArray(e))return e.map((e=>l(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,s])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=l(s)})),t};var c=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};const h=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),u=(e,t,r)=>c(void 0,void 0,void 0,(function*(){const i=yield(a=void 0,l=void 0,c=void 0,u=function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(s.bind(s,907))).Response:Response},new(c||(c=Promise))((function(e,t){function s(e){try{i(u.next(e))}catch(e){t(e)}}function r(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c((function(e){e(i)}))).then(s,r)}i((u=u.apply(a,l||[])).next())})));var a,l,c,u;e instanceof i&&!(null==r?void 0:r.noResolveJson)?e.json().then((s=>{const r=e.status||500,i=(null==s?void 0:s.statusCode)||r+"";t(new n(h(s),r,i))})).catch((e=>{t(new o(h(e),e))})):t(new o(h(e),e))})),d=(e,t,s,r)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&r?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(r)?(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),i.body=JSON.stringify(r)):i.body=r,(null==t?void 0:t.duplex)&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),s)):i};function f(e,t,s,r,i,n){return c(this,void 0,void 0,(function*(){return new Promise(((o,a)=>{e(s,d(t,r,i,n)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>o(e))).catch((e=>u(e,a,r)))}))}))}function p(e,t,s,r){return c(this,void 0,void 0,(function*(){return f(e,"GET",t,s,r)}))}function g(e,t,s,r,i){return c(this,void 0,void 0,(function*(){return f(e,"POST",t,r,i,s)}))}function v(e,t,s,r,i){return c(this,void 0,void 0,(function*(){return f(e,"PUT",t,r,i,s)}))}function y(e,t,s,r,i){return c(this,void 0,void 0,(function*(){return f(e,"DELETE",t,r,i,s)}))}var w=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};const m={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},b={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class _{constructor(e,t={},s,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=s,this.fetch=a(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,s,r){return w(this,void 0,void 0,(function*(){try{let i;const n=Object.assign(Object.assign({},b),r);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)});const a=n.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(i=new FormData,i.append("cacheControl",n.cacheControl),a&&i.append("metadata",this.encodeMetadata(a)),i.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(i=s,i.append("cacheControl",n.cacheControl),a&&i.append("metadata",this.encodeMetadata(a))):(i=s,o["cache-control"]=`max-age=${n.cacheControl}`,o["content-type"]=n.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==r?void 0:r.headers)&&(o=Object.assign(Object.assign({},o),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),h=yield("PUT"==e?v:g)(this.fetch,`${this.url}/object/${c}`,i,Object.assign({headers:o},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{}));return{data:{path:l,id:h.Id,fullPath:h.Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}upload(e,t,s){return w(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,s)}))}uploadToSignedUrl(e,t,s,r){return w(this,void 0,void 0,(function*(){const n=this._removeEmptyFolders(e),o=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:b.upsert},r),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType),{data:{path:n,fullPath:(yield v(this.fetch,a.toString(),e,{headers:i})).Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}createSignedUploadUrl(e,t){return w(this,void 0,void 0,(function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(i["x-upsert"]="true");const n=yield g(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),o=new URL(this.url+n.url),a=o.searchParams.get("token");if(!a)throw new r("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}update(e,t,s){return w(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,s)}))}move(e,t,s){return w(this,void 0,void 0,(function*(){try{return{data:yield g(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}copy(e,t,s){return w(this,void 0,void 0,(function*(){try{return{data:{path:(yield g(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}createSignedUrl(e,t,s){return w(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),i=yield g(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${n}`)},{data:i,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}createSignedUrls(e,t,s){return w(this,void 0,void 0,(function*(){try{const r=yield g(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null}))),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}download(e,t){return w(this,void 0,void 0,(function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield p(this.fetch,`${this.url}/${s}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}info(e){return w(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield p(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:l(e),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}exists(e){return w(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s){return c(this,void 0,void 0,(function*(){return f(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),undefined)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e)&&e instanceof o){const t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}))}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&r.push(i);const n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&r.push(o);let a=r.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${s}${a}`)}}}remove(e){return w(this,void 0,void 0,(function*(){try{return{data:yield y(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}list(e,t,s){return w(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},m),t),{prefix:e||""});return{data:yield g(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}listV2(e,t){return w(this,void 0,void 0,(function*(){try{const s=Object.assign({},e);return{data:yield g(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const k={"X-Client-Info":"storage-js/2.12.1"};var S=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};class T{constructor(e,t={},s,r){this.shouldThrowOnError=!1;const i=new URL(e);(null==r?void 0:r.useNewHostname)&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},k),t),this.fetch=a(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return S(this,void 0,void 0,(function*(){try{return{data:yield p(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}getBucket(e){return S(this,void 0,void 0,(function*(){try{return{data:yield p(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}createBucket(e,t={public:!1}){return S(this,void 0,void 0,(function*(){try{return{data:yield g(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}updateBucket(e,t){return S(this,void 0,void 0,(function*(){try{return{data:yield v(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}emptyBucket(e){return S(this,void 0,void 0,(function*(){try{return{data:yield g(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}deleteBucket(e){return S(this,void 0,void 0,(function*(){try{return{data:yield y(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(i(e))return{data:null,error:e};throw e}}))}}class E extends T{constructor(e,t={},s,r){super(e,t,s,r)}from(e){return new _(this.url,this.headers,e,this.fetch)}}},787:function(e,t,s){var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=s(227),n=s(279),o=s(830),a=s(623),l=s(985),c=s(720),h=s(793),u=s(689);t.default=class{constructor(e,t,s){var r,i,o;this.supabaseUrl=e,this.supabaseKey=t;const u=(0,h.validateSupabaseUrl)(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const d=`sb-${u.hostname.split(".")[0]}-auth-token`,f={db:l.DEFAULT_DB_OPTIONS,realtime:l.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},l.DEFAULT_AUTH_OPTIONS),{storageKey:d}),global:l.DEFAULT_GLOBAL_OPTIONS},p=(0,h.applySettingDefaults)(null!=s?s:{},f);this.storageKey=null!==(r=p.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(i=p.global.headers)&&void 0!==i?i:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(o=p.auth)&&void 0!==o?o:{},this.headers,p.global.fetch),this.fetch=(0,c.fetchWithAuth)(t,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new n.PostgrestClient(new URL("rest/v1",u).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new a.StorageClient(this.storageUrl.href,this.headers,this.fetch,null==s?void 0:s.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new i.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return r(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,userStorage:i,storageKey:n,flowType:o,lock:a,debug:l},c,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new u.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,userStorage:i,flowType:o,lock:a,debug:l,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some((e=>"authorization"===e.toLowerCase()))})}_initRealtimeClient(e){return new o.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}},440:function(e,t,s){var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createClient=t.SupabaseClient=t.FunctionRegion=t.FunctionsError=t.FunctionsRelayError=t.FunctionsFetchError=t.FunctionsHttpError=t.PostgrestError=void 0;const o=n(s(787));i(s(745),t);var a=s(279);Object.defineProperty(t,"PostgrestError",{enumerable:!0,get:function(){return a.PostgrestError}});var l=s(227);Object.defineProperty(t,"FunctionsHttpError",{enumerable:!0,get:function(){return l.FunctionsHttpError}}),Object.defineProperty(t,"FunctionsFetchError",{enumerable:!0,get:function(){return l.FunctionsFetchError}}),Object.defineProperty(t,"FunctionsRelayError",{enumerable:!0,get:function(){return l.FunctionsRelayError}}),Object.defineProperty(t,"FunctionsError",{enumerable:!0,get:function(){return l.FunctionsError}}),Object.defineProperty(t,"FunctionRegion",{enumerable:!0,get:function(){return l.FunctionRegion}}),i(s(830),t);var c=s(787);Object.defineProperty(t,"SupabaseClient",{enumerable:!0,get:function(){return n(c).default}}),t.createClient=(e,t,s)=>new o.default(e,t,s),function(){if("undefined"!=typeof window)return!1;if("undefined"==typeof process)return!1;const e=process.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18}()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")},689:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SupabaseAuthClient=void 0;const r=s(745);class i extends r.AuthClient{constructor(e){super(e)}}t.SupabaseAuthClient=i},985:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_REALTIME_OPTIONS=t.DEFAULT_AUTH_OPTIONS=t.DEFAULT_DB_OPTIONS=t.DEFAULT_GLOBAL_OPTIONS=t.DEFAULT_HEADERS=void 0;const r=s(560);let i="";i="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node",t.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${i}/${r.version}`},t.DEFAULT_GLOBAL_OPTIONS={headers:t.DEFAULT_HEADERS},t.DEFAULT_DB_OPTIONS={schema:"public"},t.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},t.DEFAULT_REALTIME_OPTIONS={}},720:function(e,t,s){var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return i(t,e),t},o=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchWithAuth=t.resolveHeadersConstructor=t.resolveFetch=void 0;const a=n(s(907));t.resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?a.default:fetch),(...e)=>t(...e)},t.resolveHeadersConstructor=()=>"undefined"==typeof Headers?a.Headers:Headers,t.fetchWithAuth=(e,s,r)=>{const i=(0,t.resolveFetch)(r),n=(0,t.resolveHeadersConstructor)();return(t,r)=>o(void 0,void 0,void 0,(function*(){var o;const a=null!==(o=yield s())&&void 0!==o?o:e;let l=new n(null==r?void 0:r.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),i(t,Object.assign(Object.assign({},r),{headers:l}))}))}},793:function(e,t){var s=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};function r(e){return e.endsWith("/")?e:e+"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.validateSupabaseUrl=t.applySettingDefaults=t.isBrowser=t.ensureTrailingSlash=t.uuid=void 0,t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},t.ensureTrailingSlash=r,t.isBrowser=()=>"undefined"!=typeof window,t.applySettingDefaults=function(e,t){var r,i;const{db:n,auth:o,realtime:a,global:l}=e,{db:c,auth:h,realtime:u,global:d}=t,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},h),o),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},null!==(r=null==d?void 0:d.headers)&&void 0!==r?r:{}),null!==(i=null==l?void 0:l.headers)&&void 0!==i?i:{})}),accessToken:()=>s(this,void 0,void 0,(function*(){return""}))};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f},t.validateSupabaseUrl=function(e){const t=null==e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(r(t))}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}},560:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="2.57.4"}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,s),n.exports}return s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s(440)})()));
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/src/lib/websocket-factory.ts:export interface WebSocketEnvironment {
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/src/lib/websocket-factory.ts:  private static detectEnvironment(): WebSocketEnvironment {
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/src/lib/websocket-factory.ts:    const env = this.detectEnvironment()
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/src/lib/websocket-factory.ts:      const env = this.detectEnvironment()
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/main/lib/websocket-factory.js:    static detectEnvironment() {
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/main/lib/websocket-factory.js:        const env = this.detectEnvironment();
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/main/lib/websocket-factory.js:            const env = this.detectEnvironment();
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/main/lib/websocket-factory.d.ts:export interface WebSocketEnvironment {
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/main/lib/websocket-factory.d.ts:    private static detectEnvironment;
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.js:    static detectEnvironment() {
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.js:        const env = this.detectEnvironment();
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.js:            const env = this.detectEnvironment();
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.d.ts:export interface WebSocketEnvironment {
./node_modules/.pnpm/@supabase+realtime-js@2.15.5/node_modules/@supabase/realtime-js/dist/module/lib/websocket-factory.d.ts:    private static detectEnvironment;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/nodes/lighting/BasicEnvironmentNode.d.ts:declare class BasicEnvironmentNode extends LightingNode {
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/nodes/lighting/BasicEnvironmentNode.d.ts:export default BasicEnvironmentNode;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/nodes/lighting/EnvironmentNode.d.ts:export default class EnvironmentNode extends LightingNode {
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/nodes/Nodes.d.ts:export { default as BasicEnvironmentNode } from "./lighting/BasicEnvironmentNode.js";
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/nodes/Nodes.d.ts:export { default as EnvironmentNode } from "./lighting/EnvironmentNode.js";
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/extras/PMREMGenerator.d.ts: * This class generates a Prefiltered, Mipmapped Radiance Environment Map (PMREM) from a cubeMap environment texture.
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshBasicNodeMaterial.d.ts:import BasicEnvironmentNode from "../../nodes/lighting/BasicEnvironmentNode.js";
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshBasicNodeMaterial.d.ts:     * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshBasicNodeMaterial.d.ts:     * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshBasicNodeMaterial.d.ts:    setupEnvironment(builder: NodeBuilder): BasicEnvironmentNode | null;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshLambertNodeMaterial.d.ts:import BasicEnvironmentNode from "../../nodes/lighting/BasicEnvironmentNode.js";
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshLambertNodeMaterial.d.ts:     * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshLambertNodeMaterial.d.ts:     * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshLambertNodeMaterial.d.ts:    setupEnvironment(builder: NodeBuilder): BasicEnvironmentNode | null;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshPhongNodeMaterial.d.ts:import BasicEnvironmentNode from "../../nodes/lighting/BasicEnvironmentNode.js";
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshPhongNodeMaterial.d.ts:     * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshPhongNodeMaterial.d.ts:     * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshPhongNodeMaterial.d.ts:    setupEnvironment(builder: NodeBuilder): BasicEnvironmentNode | null;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshStandardNodeMaterial.d.ts:import EnvironmentNode from "../../nodes/lighting/EnvironmentNode.js";
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshStandardNodeMaterial.d.ts:     * Overwritten since this type of material uses {@link EnvironmentNode}
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshStandardNodeMaterial.d.ts:     * @return {?EnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/MeshStandardNodeMaterial.d.ts:    setupEnvironment(builder: NodeBuilder): EnvironmentNode | null;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/materials/nodes/NodeMaterial.d.ts:    setupEnvironment(builder: NodeBuilder): Node | null;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/renderers/webxr/WebXRManager.d.ts:    getEnvironmentBlendMode: () => XREnvironmentBlendMode | undefined;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/renderers/common/nodes/Nodes.d.ts:    getEnvironmentNode(scene: Scene): ShaderNodeObject<Node> | null;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/renderers/common/nodes/Nodes.d.ts:    updateEnvironment(scene: Scene): void;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/src/renderers/common/XRManager.d.ts:    getEnvironmentBlendMode(): XREnvironmentBlendMode | undefined;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/examples/jsm/webxr/XRControllerModelFactory.d.ts:    setEnvironmentMap(envMap: Texture): XRControllerModel;
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/examples/jsm/environments/DebugEnvironment.d.ts:export class DebugEnvironment extends Scene {
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/examples/jsm/environments/RoomEnvironment.d.ts:export class RoomEnvironment extends Scene {
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/examples/jsm/Addons.d.ts:export * from "./environments/DebugEnvironment.js";
./node_modules/.pnpm/@types+three@0.180.0/node_modules/@types/three/examples/jsm/Addons.d.ts:export * from "./environments/RoomEnvironment.js";
./node_modules/.pnpm/prismjs@1.30.0/node_modules/prismjs/components/prism-bash.js:			// [0]: Arithmetic Environment
./node_modules/.pnpm/prismjs@1.30.0/node_modules/prismjs/components/prism-io.js:	'keyword': /\b(?:activate|activeCoroCount|asString|block|break|call|catch|clone|collectGarbage|compileString|continue|do|doFile|doMessage|doString|else|elseif|exit|for|foreach|forward|getEnvironmentVariable|getSlot|hasSlot|if|ifFalse|ifNil|ifNilEval|ifTrue|isActive|isNil|isResumable|list|message|method|parent|pass|pause|perform|performWithArgList|print|println|proto|raise|raiseResumable|removeSlot|resend|resume|schedulerSleepSeconds|self|sender|setSchedulerSleepSeconds|setSlot|shallowCopy|slotNames|super|system|then|thisBlock|thisContext|try|type|uniqueId|updateSlot|wait|while|write|yield)\b/,
./node_modules/.pnpm/prismjs@1.30.0/node_modules/prismjs/components/prism-io.min.js:Prism.languages.io={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?(?:\*\/|$)|\/\/.*|#.*)/,lookbehind:!0,greedy:!0},"triple-quoted-string":{pattern:/"""(?:\\[\s\S]|(?!""")[^\\])*"""/,greedy:!0,alias:"string"},string:{pattern:/"(?:\\.|[^\\\r\n"])*"/,greedy:!0},keyword:/\b(?:activate|activeCoroCount|asString|block|break|call|catch|clone|collectGarbage|compileString|continue|do|doFile|doMessage|doString|else|elseif|exit|for|foreach|forward|getEnvironmentVariable|getSlot|hasSlot|if|ifFalse|ifNil|ifNilEval|ifTrue|isActive|isNil|isResumable|list|message|method|parent|pass|pause|perform|performWithArgList|print|println|proto|raise|raiseResumable|removeSlot|resend|resume|schedulerSleepSeconds|self|sender|setSchedulerSleepSeconds|setSlot|shallowCopy|slotNames|super|system|then|thisBlock|thisContext|try|type|uniqueId|updateSlot|wait|while|write|yield)\b/,builtin:/\b(?:Array|AudioDevice|AudioMixer|BigNum|Block|Box|Buffer|CFunction|CGI|Color|Curses|DBM|DNSResolver|DOConnection|DOProxy|DOServer|Date|Directory|Duration|DynLib|Error|Exception|FFT|File|Fnmatch|Font|Future|GL|GLE|GLScissor|GLU|GLUCylinder|GLUQuadric|GLUSphere|GLUT|Host|Image|Importer|LinkList|List|Lobby|Locals|MD5|MP3Decoder|MP3Encoder|Map|Message|Movie|Notification|Number|Object|OpenGL|Point|Protos|Random|Regex|SGML|SGMLElement|SGMLParser|SQLite|Sequence|Server|ShowMessage|SleepyCat|SleepyCatCursor|Socket|SocketManager|Sound|Soup|Store|String|Tree|UDPSender|UPDReceiver|URL|User|Warning|WeakLink)\b/,boolean:/\b(?:false|nil|true)\b/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e-?\d+)?/i,operator:/[=!*/%+\-^&|]=|>>?=?|<<?=?|:?:?=|\+\+?|--?|\*\*?|\/\/?|%|\|\|?|&&?|\b(?:and|not|or|return)\b|@@?|\?\??|\.\./,punctuation:/[{}[\];(),.:]/};
./node_modules/.pnpm/prismjs@1.30.0/node_modules/prismjs/components/prism-sqf.js:	'function': /\b(?:abs|accTime|acos|action|actionIDs|actionKeys|actionKeysImages|actionKeysNames|actionKeysNamesArray|actionName|actionParams|activateAddons|activatedAddons|activateKey|add3DENConnection|add3DENEventHandler|add3DENLayer|addAction|addBackpack|addBackpackCargo|addBackpackCargoGlobal|addBackpackGlobal|addCamShake|addCuratorAddons|addCuratorCameraArea|addCuratorEditableObjects|addCuratorEditingArea|addCuratorPoints|addEditorObject|addEventHandler|addForce|addForceGeneratorRTD|addGoggles|addGroupIcon|addHandgunItem|addHeadgear|addItem|addItemCargo|addItemCargoGlobal|addItemPool|addItemToBackpack|addItemToUniform|addItemToVest|addLiveStats|addMagazine|addMagazineAmmoCargo|addMagazineCargo|addMagazineCargoGlobal|addMagazineGlobal|addMagazinePool|addMagazines|addMagazineTurret|addMenu|addMenuItem|addMissionEventHandler|addMPEventHandler|addMusicEventHandler|addOwnedMine|addPlayerScores|addPrimaryWeaponItem|addPublicVariableEventHandler|addRating|addResources|addScore|addScoreSide|addSecondaryWeaponItem|addSwitchableUnit|addTeamMember|addToRemainsCollector|addTorque|addUniform|addVehicle|addVest|addWaypoint|addWeapon|addWeaponCargo|addWeaponCargoGlobal|addWeaponGlobal|addWeaponItem|addWeaponPool|addWeaponTurret|admin|agent|agents|AGLToASL|aimedAtTarget|aimPos|airDensityCurveRTD|airDensityRTD|airplaneThrottle|airportSide|AISFinishHeal|alive|all3DENEntities|allAirports|allControls|allCurators|allCutLayers|allDead|allDeadMen|allDisplays|allGroups|allMapMarkers|allMines|allMissionObjects|allow3DMode|allowCrewInImmobile|allowCuratorLogicIgnoreAreas|allowDamage|allowDammage|allowFileOperations|allowFleeing|allowGetIn|allowSprint|allPlayers|allSimpleObjects|allSites|allTurrets|allUnits|allUnitsUAV|allVariables|ammo|ammoOnPylon|animate|animateBay|animateDoor|animatePylon|animateSource|animationNames|animationPhase|animationSourcePhase|animationState|append|apply|armoryPoints|arrayIntersect|asin|ASLToAGL|ASLToATL|assert|assignAsCargo|assignAsCargoIndex|assignAsCommander|assignAsDriver|assignAsGunner|assignAsTurret|assignCurator|assignedCargo|assignedCommander|assignedDriver|assignedGunner|assignedItems|assignedTarget|assignedTeam|assignedVehicle|assignedVehicleRole|assignItem|assignTeam|assignToAirport|atan|atan2|atg|ATLToASL|attachedObject|attachedObjects|attachedTo|attachObject|attachTo|attackEnabled|backpack|backpackCargo|backpackContainer|backpackItems|backpackMagazines|backpackSpaceFor|behaviour|benchmark|binocular|blufor|boundingBox|boundingBoxReal|boundingCenter|briefingName|buildingExit|buildingPos|buldozer_EnableRoadDiag|buldozer_IsEnabledRoadDiag|buldozer_LoadNewRoads|buldozer_reloadOperMap|buttonAction|buttonSetAction|cadetMode|callExtension|camCommand|camCommit|camCommitPrepared|camCommitted|camConstuctionSetParams|camCreate|camDestroy|cameraEffect|cameraEffectEnableHUD|cameraInterest|cameraOn|cameraView|campaignConfigFile|camPreload|camPreloaded|camPrepareBank|camPrepareDir|camPrepareDive|camPrepareFocus|camPrepareFov|camPrepareFovRange|camPreparePos|camPrepareRelPos|camPrepareTarget|camSetBank|camSetDir|camSetDive|camSetFocus|camSetFov|camSetFovRange|camSetPos|camSetRelPos|camSetTarget|camTarget|camUseNVG|canAdd|canAddItemToBackpack|canAddItemToUniform|canAddItemToVest|cancelSimpleTaskDestination|canFire|canMove|canSlingLoad|canStand|canSuspend|canTriggerDynamicSimulation|canUnloadInCombat|canVehicleCargo|captive|captiveNum|cbChecked|cbSetChecked|ceil|channelEnabled|cheatsEnabled|checkAIFeature|checkVisibility|civilian|className|clear3DENAttribute|clear3DENInventory|clearAllItemsFromBackpack|clearBackpackCargo|clearBackpackCargoGlobal|clearForcesRTD|clearGroupIcons|clearItemCargo|clearItemCargoGlobal|clearItemPool|clearMagazineCargo|clearMagazineCargoGlobal|clearMagazinePool|clearOverlay|clearRadio|clearVehicleInit|clearWeaponCargo|clearWeaponCargoGlobal|clearWeaponPool|clientOwner|closeDialog|closeDisplay|closeOverlay|collapseObjectTree|collect3DENHistory|collectiveRTD|combatMode|commandArtilleryFire|commandChat|commander|commandFire|commandFollow|commandFSM|commandGetOut|commandingMenu|commandMove|commandRadio|commandStop|commandSuppressiveFire|commandTarget|commandWatch|comment|commitOverlay|compile|compileFinal|completedFSM|composeText|configClasses|configFile|configHierarchy|configName|configNull|configProperties|configSourceAddonList|configSourceMod|configSourceModList|confirmSensorTarget|connectTerminalToUAV|controlNull|controlsGroupCtrl|copyFromClipboard|copyToClipboard|copyWaypoints|cos|count|countEnemy|countFriendly|countSide|countType|countUnknown|create3DENComposition|create3DENEntity|createAgent|createCenter|createDialog|createDiaryLink|createDiaryRecord|createDiarySubject|createDisplay|createGearDialog|createGroup|createGuardedPoint|createLocation|createMarker|createMarkerLocal|createMenu|createMine|createMissionDisplay|createMPCampaignDisplay|createSimpleObject|createSimpleTask|createSite|createSoundSource|createTask|createTeam|createTrigger|createUnit|createVehicle|createVehicleCrew|createVehicleLocal|crew|ctAddHeader|ctAddRow|ctClear|ctCurSel|ctData|ctFindHeaderRows|ctFindRowHeader|ctHeaderControls|ctHeaderCount|ctRemoveHeaders|ctRemoveRows|ctrlActivate|ctrlAddEventHandler|ctrlAngle|ctrlAutoScrollDelay|ctrlAutoScrollRewind|ctrlAutoScrollSpeed|ctrlChecked|ctrlClassName|ctrlCommit|ctrlCommitted|ctrlCreate|ctrlDelete|ctrlEnable|ctrlEnabled|ctrlFade|ctrlHTMLLoaded|ctrlIDC|ctrlIDD|ctrlMapAnimAdd|ctrlMapAnimClear|ctrlMapAnimCommit|ctrlMapAnimDone|ctrlMapCursor|ctrlMapMouseOver|ctrlMapScale|ctrlMapScreenToWorld|ctrlMapWorldToScreen|ctrlModel|ctrlModelDirAndUp|ctrlModelScale|ctrlParent|ctrlParentControlsGroup|ctrlPosition|ctrlRemoveAllEventHandlers|ctrlRemoveEventHandler|ctrlScale|ctrlSetActiveColor|ctrlSetAngle|ctrlSetAutoScrollDelay|ctrlSetAutoScrollRewind|ctrlSetAutoScrollSpeed|ctrlSetBackgroundColor|ctrlSetChecked|ctrlSetDisabledColor|ctrlSetEventHandler|ctrlSetFade|ctrlSetFocus|ctrlSetFont|ctrlSetFontH1|ctrlSetFontH1B|ctrlSetFontH2|ctrlSetFontH2B|ctrlSetFontH3|ctrlSetFontH3B|ctrlSetFontH4|ctrlSetFontH4B|ctrlSetFontH5|ctrlSetFontH5B|ctrlSetFontH6|ctrlSetFontH6B|ctrlSetFontHeight|ctrlSetFontHeightH1|ctrlSetFontHeightH2|ctrlSetFontHeightH3|ctrlSetFontHeightH4|ctrlSetFontHeightH5|ctrlSetFontHeightH6|ctrlSetFontHeightSecondary|ctrlSetFontP|ctrlSetFontPB|ctrlSetFontSecondary|ctrlSetForegroundColor|ctrlSetModel|ctrlSetModelDirAndUp|ctrlSetModelScale|ctrlSetPixelPrecision|ctrlSetPosition|ctrlSetScale|ctrlSetStructuredText|ctrlSetText|ctrlSetTextColor|ctrlSetTextColorSecondary|ctrlSetTextSecondary|ctrlSetTooltip|ctrlSetTooltipColorBox|ctrlSetTooltipColorShade|ctrlSetTooltipColorText|ctrlShow|ctrlShown|ctrlText|ctrlTextHeight|ctrlTextSecondary|ctrlTextWidth|ctrlType|ctrlVisible|ctRowControls|ctRowCount|ctSetCurSel|ctSetData|ctSetHeaderTemplate|ctSetRowTemplate|ctSetValue|ctValue|curatorAddons|curatorCamera|curatorCameraArea|curatorCameraAreaCeiling|curatorCoef|curatorEditableObjects|curatorEditingArea|curatorEditingAreaType|curatorMouseOver|curatorPoints|curatorRegisteredObjects|curatorSelected|curatorWaypointCost|current3DENOperation|currentChannel|currentCommand|currentMagazine|currentMagazineDetail|currentMagazineDetailTurret|currentMagazineTurret|currentMuzzle|currentNamespace|currentTask|currentTasks|currentThrowable|currentVisionMode|currentWaypoint|currentWeapon|currentWeaponMode|currentWeaponTurret|currentZeroing|cursorObject|cursorTarget|customChat|customRadio|cutFadeOut|cutObj|cutRsc|cutText|damage|date|dateToNumber|daytime|deActivateKey|debriefingText|debugFSM|debugLog|deg|delete3DENEntities|deleteAt|deleteCenter|deleteCollection|deleteEditorObject|deleteGroup|deleteGroupWhenEmpty|deleteIdentity|deleteLocation|deleteMarker|deleteMarkerLocal|deleteRange|deleteResources|deleteSite|deleteStatus|deleteTeam|deleteVehicle|deleteVehicleCrew|deleteWaypoint|detach|detectedMines|diag_activeMissionFSMs|diag_activeScripts|diag_activeSQFScripts|diag_activeSQSScripts|diag_captureFrame|diag_captureFrameToFile|diag_captureSlowFrame|diag_codePerformance|diag_drawMode|diag_dynamicSimulationEnd|diag_enable|diag_enabled|diag_fps|diag_fpsMin|diag_frameNo|diag_lightNewLoad|diag_list|diag_log|diag_logSlowFrame|diag_mergeConfigFile|diag_recordTurretLimits|diag_setLightNew|diag_tickTime|diag_toggle|dialog|diarySubjectExists|didJIP|didJIPOwner|difficulty|difficultyEnabled|difficultyEnabledRTD|difficultyOption|direction|directSay|disableAI|disableCollisionWith|disableConversation|disableDebriefingStats|disableMapIndicators|disableNVGEquipment|disableRemoteSensors|disableSerialization|disableTIEquipment|disableUAVConnectability|disableUserInput|displayAddEventHandler|displayCtrl|displayNull|displayParent|displayRemoveAllEventHandlers|displayRemoveEventHandler|displaySetEventHandler|dissolveTeam|distance|distance2D|distanceSqr|distributionRegion|do3DENAction|doArtilleryFire|doFire|doFollow|doFSM|doGetOut|doMove|doorPhase|doStop|doSuppressiveFire|doTarget|doWatch|drawArrow|drawEllipse|drawIcon|drawIcon3D|drawLine|drawLine3D|drawLink|drawLocation|drawPolygon|drawRectangle|drawTriangle|driver|drop|dynamicSimulationDistance|dynamicSimulationDistanceCoef|dynamicSimulationEnabled|dynamicSimulationSystemEnabled|east|edit3DENMissionAttributes|editObject|editorSetEventHandler|effectiveCommander|emptyPositions|enableAI|enableAIFeature|enableAimPrecision|enableAttack|enableAudioFeature|enableAutoStartUpRTD|enableAutoTrimRTD|enableCamShake|enableCaustics|enableChannel|enableCollisionWith|enableCopilot|enableDebriefingStats|enableDiagLegend|enableDynamicSimulation|enableDynamicSimulationSystem|enableEndDialog|enableEngineArtillery|enableEnvironment|enableFatigue|enableGunLights|enableInfoPanelComponent|enableIRLasers|enableMimics|enablePersonTurret|enableRadio|enableReload|enableRopeAttach|enableSatNormalOnDetail|enableSaving|enableSentences|enableSimulation|enableSimulationGlobal|enableStamina|enableStressDamage|enableTeamSwitch|enableTraffic|enableUAVConnectability|enableUAVWaypoints|enableVehicleCargo|enableVehicleSensor|enableWeaponDisassembly|endl|endLoadingScreen|endMission|engineOn|enginesIsOnRTD|enginesPowerRTD|enginesRpmRTD|enginesTorqueRTD|entities|environmentEnabled|estimatedEndServerTime|estimatedTimeLeft|evalObjectArgument|everyBackpack|everyContainer|exec|execEditorScript|exp|expectedDestination|exportJIPMessages|eyeDirection|eyePos|face|faction|fadeMusic|fadeRadio|fadeSound|fadeSpeech|failMission|fillWeaponsFromPool|find|findCover|findDisplay|findEditorObject|findEmptyPosition|findEmptyPositionReady|findIf|findNearestEnemy|finishMissionInit|finite|fire|fireAtTarget|firstBackpack|flag|flagAnimationPhase|flagOwner|flagSide|flagTexture|fleeing|floor|flyInHeight|flyInHeightASL|fog|fogForecast|fogParams|forceAddUniform|forceAtPositionRTD|forcedMap|forceEnd|forceFlagTexture|forceFollowRoad|forceGeneratorRTD|forceMap|forceRespawn|forceSpeed|forceWalk|forceWeaponFire|forceWeatherChange|forgetTarget|format|formation|formationDirection|formationLeader|formationMembers|formationPosition|formationTask|formatText|formLeader|freeLook|fromEditor|fuel|fullCrew|gearIDCAmmoCount|gearSlotAmmoCount|gearSlotData|get3DENActionState|get3DENAttribute|get3DENCamera|get3DENConnections|get3DENEntity|get3DENEntityID|get3DENGrid|get3DENIconsVisible|get3DENLayerEntities|get3DENLinesVisible|get3DENMissionAttribute|get3DENMouseOver|get3DENSelected|getAimingCoef|getAllEnvSoundControllers|getAllHitPointsDamage|getAllOwnedMines|getAllSoundControllers|getAmmoCargo|getAnimAimPrecision|getAnimSpeedCoef|getArray|getArtilleryAmmo|getArtilleryComputerSettings|getArtilleryETA|getAssignedCuratorLogic|getAssignedCuratorUnit|getBackpackCargo|getBleedingRemaining|getBurningValue|getCameraViewDirection|getCargoIndex|getCenterOfMass|getClientState|getClientStateNumber|getCompatiblePylonMagazines|getConnectedUAV|getContainerMaxLoad|getCursorObjectParams|getCustomAimCoef|getDammage|getDescription|getDir|getDirVisual|getDLCAssetsUsage|getDLCAssetsUsageByName|getDLCs|getDLCUsageTime|getEditorCamera|getEditorMode|getEditorObjectScope|getElevationOffset|getEngineTargetRpmRTD|getEnvSoundController|getFatigue|getFieldManualStartPage|getForcedFlagTexture|getFriend|getFSMVariable|getFuelCargo|getGroupIcon|getGroupIconParams|getGroupIcons|getHideFrom|getHit|getHitIndex|getHitPointDamage|getItemCargo|getMagazineCargo|getMarkerColor|getMarkerPos|getMarkerSize|getMarkerType|getMass|getMissionConfig|getMissionConfigValue|getMissionDLCs|getMissionLayerEntities|getMissionLayers|getModelInfo|getMousePosition|getMusicPlayedTime|getNumber|getObjectArgument|getObjectChildren|getObjectDLC|getObjectMaterials|getObjectProxy|getObjectTextures|getObjectType|getObjectViewDistance|getOxygenRemaining|getPersonUsedDLCs|getPilotCameraDirection|getPilotCameraPosition|getPilotCameraRotation|getPilotCameraTarget|getPlateNumber|getPlayerChannel|getPlayerScores|getPlayerUID|getPlayerUIDOld|getPos|getPosASL|getPosASLVisual|getPosASLW|getPosATL|getPosATLVisual|getPosVisual|getPosWorld|getPylonMagazines|getRelDir|getRelPos|getRemoteSensorsDisabled|getRepairCargo|getResolution|getRotorBrakeRTD|getShadowDistance|getShotParents|getSlingLoad|getSoundController|getSoundControllerResult|getSpeed|getStamina|getStatValue|getSuppression|getTerrainGrid|getTerrainHeightASL|getText|getTotalDLCUsageTime|getTrimOffsetRTD|getUnitLoadout|getUnitTrait|getUserMFDText|getUserMFDValue|getVariable|getVehicleCargo|getWeaponCargo|getWeaponSway|getWingsOrientationRTD|getWingsPositionRTD|getWPPos|glanceAt|globalChat|globalRadio|goggles|group|groupChat|groupFromNetId|groupIconSelectable|groupIconsVisible|groupId|groupOwner|groupRadio|groupSelectedUnits|groupSelectUnit|grpNull|gunner|gusts|halt|handgunItems|handgunMagazine|handgunWeapon|handsHit|hasInterface|hasPilotCamera|hasWeapon|hcAllGroups|hcGroupParams|hcLeader|hcRemoveAllGroups|hcRemoveGroup|hcSelected|hcSelectGroup|hcSetGroup|hcShowBar|hcShownBar|headgear|hideBody|hideObject|hideObjectGlobal|hideSelection|hint|hintC|hintCadet|hintSilent|hmd|hostMission|htmlLoad|HUDMovementLevels|humidity|image|importAllGroups|importance|in|inArea|inAreaArray|incapacitatedState|independent|inflame|inflamed|infoPanel|infoPanelComponentEnabled|infoPanelComponents|infoPanels|inGameUISetEventHandler|inheritsFrom|initAmbientLife|inPolygon|inputAction|inRangeOfArtillery|insertEditorObject|intersect|is3DEN|is3DENMultiplayer|isAbleToBreathe|isAgent|isAimPrecisionEnabled|isArray|isAutoHoverOn|isAutonomous|isAutoStartUpEnabledRTD|isAutotest|isAutoTrimOnRTD|isBleeding|isBurning|isClass|isCollisionLightOn|isCopilotEnabled|isDamageAllowed|isDedicated|isDLCAvailable|isEngineOn|isEqualTo|isEqualType|isEqualTypeAll|isEqualTypeAny|isEqualTypeArray|isEqualTypeParams|isFilePatchingEnabled|isFlashlightOn|isFlatEmpty|isForcedWalk|isFormationLeader|isGroupDeletedWhenEmpty|isHidden|isInRemainsCollector|isInstructorFigureEnabled|isIRLaserOn|isKeyActive|isKindOf|isLaserOn|isLightOn|isLocalized|isManualFire|isMarkedForCollection|isMultiplayer|isMultiplayerSolo|isNil|isNull|isNumber|isObjectHidden|isObjectRTD|isOnRoad|isPipEnabled|isPlayer|isRealTime|isRemoteExecuted|isRemoteExecutedJIP|isServer|isShowing3DIcons|isSimpleObject|isSprintAllowed|isStaminaEnabled|isSteamMission|isStreamFriendlyUIEnabled|isStressDamageEnabled|isText|isTouchingGround|isTurnedOut|isTutHintsEnabled|isUAVConnectable|isUAVConnected|isUIContext|isUniformAllowed|isVehicleCargo|isVehicleRadarOn|isVehicleSensorEnabled|isWalking|isWeaponDeployed|isWeaponRested|itemCargo|items|itemsWithMagazines|join|joinAs|joinAsSilent|joinSilent|joinString|kbAddDatabase|kbAddDatabaseTargets|kbAddTopic|kbHasTopic|kbReact|kbRemoveTopic|kbTell|kbWasSaid|keyImage|keyName|knowsAbout|land|landAt|landResult|language|laserTarget|lbAdd|lbClear|lbColor|lbColorRight|lbCurSel|lbData|lbDelete|lbIsSelected|lbPicture|lbPictureRight|lbSelection|lbSetColor|lbSetColorRight|lbSetCurSel|lbSetData|lbSetPicture|lbSetPictureColor|lbSetPictureColorDisabled|lbSetPictureColorSelected|lbSetPictureRight|lbSetPictureRightColor|lbSetPictureRightColorDisabled|lbSetPictureRightColorSelected|lbSetSelectColor|lbSetSelectColorRight|lbSetSelected|lbSetText|lbSetTextRight|lbSetTooltip|lbSetValue|lbSize|lbSort|lbSortByValue|lbText|lbTextRight|lbValue|leader|leaderboardDeInit|leaderboardGetRows|leaderboardInit|leaderboardRequestRowsFriends|leaderboardRequestRowsGlobal|leaderboardRequestRowsGlobalAroundUser|leaderboardsRequestUploadScore|leaderboardsRequestUploadScoreKeepBest|leaderboardState|leaveVehicle|libraryCredits|libraryDisclaimers|lifeState|lightAttachObject|lightDetachObject|lightIsOn|lightnings|limitSpeed|linearConversion|lineBreak|lineIntersects|lineIntersectsObjs|lineIntersectsSurfaces|lineIntersectsWith|linkItem|list|listObjects|listRemoteTargets|listVehicleSensors|ln|lnbAddArray|lnbAddColumn|lnbAddRow|lnbClear|lnbColor|lnbColorRight|lnbCurSelRow|lnbData|lnbDeleteColumn|lnbDeleteRow|lnbGetColumnsPosition|lnbPicture|lnbPictureRight|lnbSetColor|lnbSetColorRight|lnbSetColumnsPos|lnbSetCurSelRow|lnbSetData|lnbSetPicture|lnbSetPictureColor|lnbSetPictureColorRight|lnbSetPictureColorSelected|lnbSetPictureColorSelectedRight|lnbSetPictureRight|lnbSetText|lnbSetTextRight|lnbSetValue|lnbSize|lnbSort|lnbSortByValue|lnbText|lnbTextRight|lnbValue|load|loadAbs|loadBackpack|loadFile|loadGame|loadIdentity|loadMagazine|loadOverlay|loadStatus|loadUniform|loadVest|local|localize|locationNull|locationPosition|lock|lockCameraTo|lockCargo|lockDriver|locked|lockedCargo|lockedDriver|lockedTurret|lockIdentity|lockTurret|lockWP|log|logEntities|logNetwork|logNetworkTerminate|lookAt|lookAtPos|magazineCargo|magazines|magazinesAllTurrets|magazinesAmmo|magazinesAmmoCargo|magazinesAmmoFull|magazinesDetail|magazinesDetailBackpack|magazinesDetailUniform|magazinesDetailVest|magazinesTurret|magazineTurretAmmo|mapAnimAdd|mapAnimClear|mapAnimCommit|mapAnimDone|mapCenterOnCamera|mapGridPosition|markAsFinishedOnSteam|markerAlpha|markerBrush|markerColor|markerDir|markerPos|markerShape|markerSize|markerText|markerType|max|members|menuAction|menuAdd|menuChecked|menuClear|menuCollapse|menuData|menuDelete|menuEnable|menuEnabled|menuExpand|menuHover|menuPicture|menuSetAction|menuSetCheck|menuSetData|menuSetPicture|menuSetValue|menuShortcut|menuShortcutText|menuSize|menuSort|menuText|menuURL|menuValue|min|mineActive|mineDetectedBy|missionConfigFile|missionDifficulty|missionName|missionNamespace|missionStart|missionVersion|modelToWorld|modelToWorldVisual|modelToWorldVisualWorld|modelToWorldWorld|modParams|moonIntensity|moonPhase|morale|move|move3DENCamera|moveInAny|moveInCargo|moveInCommander|moveInDriver|moveInGunner|moveInTurret|moveObjectToEnd|moveOut|moveTime|moveTo|moveToCompleted|moveToFailed|musicVolume|name|nameSound|nearEntities|nearestBuilding|nearestLocation|nearestLocations|nearestLocationWithDubbing|nearestObject|nearestObjects|nearestTerrainObjects|nearObjects|nearObjectsReady|nearRoads|nearSupplies|nearTargets|needReload|netId|netObjNull|newOverlay|nextMenuItemIndex|nextWeatherChange|nMenuItems|numberOfEnginesRTD|numberToDate|objectCurators|objectFromNetId|objectParent|objNull|objStatus|onBriefingGear|onBriefingGroup|onBriefingNotes|onBriefingPlan|onBriefingTeamSwitch|onCommandModeChanged|onDoubleClick|onEachFrame|onGroupIconClick|onGroupIconOverEnter|onGroupIconOverLeave|onHCGroupSelectionChanged|onMapSingleClick|onPlayerConnected|onPlayerDisconnected|onPreloadFinished|onPreloadStarted|onShowNewObject|onTeamSwitch|openCuratorInterface|openDLCPage|openDSInterface|openMap|openSteamApp|openYoutubeVideo|opfor|orderGetIn|overcast|overcastForecast|owner|param|params|parseNumber|parseSimpleArray|parseText|parsingNamespace|particlesQuality|pi|pickWeaponPool|pitch|pixelGrid|pixelGridBase|pixelGridNoUIScale|pixelH|pixelW|playableSlotsNumber|playableUnits|playAction|playActionNow|player|playerRespawnTime|playerSide|playersNumber|playGesture|playMission|playMove|playMoveNow|playMusic|playScriptedMission|playSound|playSound3D|position|positionCameraToWorld|posScreenToWorld|posWorldToScreen|ppEffectAdjust|ppEffectCommit|ppEffectCommitted|ppEffectCreate|ppEffectDestroy|ppEffectEnable|ppEffectEnabled|ppEffectForceInNVG|precision|preloadCamera|preloadObject|preloadSound|preloadTitleObj|preloadTitleRsc|primaryWeapon|primaryWeaponItems|primaryWeaponMagazine|priority|processDiaryLink|processInitCommands|productVersion|profileName|profileNamespace|profileNameSteam|progressLoadingScreen|progressPosition|progressSetPosition|publicVariable|publicVariableClient|publicVariableServer|pushBack|pushBackUnique|putWeaponPool|queryItemsPool|queryMagazinePool|queryWeaponPool|rad|radioChannelAdd|radioChannelCreate|radioChannelRemove|radioChannelSetCallSign|radioChannelSetLabel|radioVolume|rain|rainbow|random|rank|rankId|rating|rectangular|registeredTasks|registerTask|reload|reloadEnabled|remoteControl|remoteExec|remoteExecCall|remoteExecutedOwner|remove3DENConnection|remove3DENEventHandler|remove3DENLayer|removeAction|removeAll3DENEventHandlers|removeAllActions|removeAllAssignedItems|removeAllContainers|removeAllCuratorAddons|removeAllCuratorCameraAreas|removeAllCuratorEditingAreas|removeAllEventHandlers|removeAllHandgunItems|removeAllItems|removeAllItemsWithMagazines|removeAllMissionEventHandlers|removeAllMPEventHandlers|removeAllMusicEventHandlers|removeAllOwnedMines|removeAllPrimaryWeaponItems|removeAllWeapons|removeBackpack|removeBackpackGlobal|removeCuratorAddons|removeCuratorCameraArea|removeCuratorEditableObjects|removeCuratorEditingArea|removeDrawIcon|removeDrawLinks|removeEventHandler|removeFromRemainsCollector|removeGoggles|removeGroupIcon|removeHandgunItem|removeHeadgear|removeItem|removeItemFromBackpack|removeItemFromUniform|removeItemFromVest|removeItems|removeMagazine|removeMagazineGlobal|removeMagazines|removeMagazinesTurret|removeMagazineTurret|removeMenuItem|removeMissionEventHandler|removeMPEventHandler|removeMusicEventHandler|removeOwnedMine|removePrimaryWeaponItem|removeSecondaryWeaponItem|removeSimpleTask|removeSwitchableUnit|removeTeamMember|removeUniform|removeVest|removeWeapon|removeWeaponAttachmentCargo|removeWeaponCargo|removeWeaponGlobal|removeWeaponTurret|reportRemoteTarget|requiredVersion|resetCamShake|resetSubgroupDirection|resistance|resize|resources|respawnVehicle|restartEditorCamera|reveal|revealMine|reverse|reversedMouseY|roadAt|roadsConnectedTo|roleDescription|ropeAttachedObjects|ropeAttachedTo|ropeAttachEnabled|ropeAttachTo|ropeCreate|ropeCut|ropeDestroy|ropeDetach|ropeEndPosition|ropeLength|ropes|ropeUnwind|ropeUnwound|rotorsForcesRTD|rotorsRpmRTD|round|runInitScript|safeZoneH|safeZoneW|safeZoneWAbs|safeZoneX|safeZoneXAbs|safeZoneY|save3DENInventory|saveGame|saveIdentity|saveJoysticks|saveOverlay|saveProfileNamespace|saveStatus|saveVar|savingEnabled|say|say2D|say3D|score|scoreSide|screenshot|screenToWorld|scriptDone|scriptName|scriptNull|scudState|secondaryWeapon|secondaryWeaponItems|secondaryWeaponMagazine|select|selectBestPlaces|selectDiarySubject|selectedEditorObjects|selectEditorObject|selectionNames|selectionPosition|selectLeader|selectMax|selectMin|selectNoPlayer|selectPlayer|selectRandom|selectRandomWeighted|selectWeapon|selectWeaponTurret|sendAUMessage|sendSimpleCommand|sendTask|sendTaskResult|sendUDPMessage|serverCommand|serverCommandAvailable|serverCommandExecutable|serverName|serverTime|set|set3DENAttribute|set3DENAttributes|set3DENGrid|set3DENIconsVisible|set3DENLayer|set3DENLinesVisible|set3DENLogicType|set3DENMissionAttribute|set3DENMissionAttributes|set3DENModelsVisible|set3DENObjectType|set3DENSelected|setAccTime|setActualCollectiveRTD|setAirplaneThrottle|setAirportSide|setAmmo|setAmmoCargo|setAmmoOnPylon|setAnimSpeedCoef|setAperture|setApertureNew|setArmoryPoints|setAttributes|setAutonomous|setBehaviour|setBleedingRemaining|setBrakesRTD|setCameraInterest|setCamShakeDefParams|setCamShakeParams|setCamUseTI|setCaptive|setCenterOfMass|setCollisionLight|setCombatMode|setCompassOscillation|setConvoySeparation|setCuratorCameraAreaCeiling|setCuratorCoef|setCuratorEditingAreaType|setCuratorWaypointCost|setCurrentChannel|setCurrentTask|setCurrentWaypoint|setCustomAimCoef|setCustomWeightRTD|setDamage|setDammage|setDate|setDebriefingText|setDefaultCamera|setDestination|setDetailMapBlendPars|setDir|setDirection|setDrawIcon|setDriveOnPath|setDropInterval|setDynamicSimulationDistance|setDynamicSimulationDistanceCoef|setEditorMode|setEditorObjectScope|setEffectCondition|setEngineRpmRTD|setFace|setFaceAnimation|setFatigue|setFeatureType|setFlagAnimationPhase|setFlagOwner|setFlagSide|setFlagTexture|setFog|setForceGeneratorRTD|setFormation|setFormationTask|setFormDir|setFriend|setFromEditor|setFSMVariable|setFuel|setFuelCargo|setGroupIcon|setGroupIconParams|setGroupIconsSelectable|setGroupIconsVisible|setGroupId|setGroupIdGlobal|setGroupOwner|setGusts|setHideBehind|setHit|setHitIndex|setHitPointDamage|setHorizonParallaxCoef|setHUDMovementLevels|setIdentity|setImportance|setInfoPanel|setLeader|setLightAmbient|setLightAttenuation|setLightBrightness|setLightColor|setLightDayLight|setLightFlareMaxDistance|setLightFlareSize|setLightIntensity|setLightnings|setLightUseFlare|setLocalWindParams|setMagazineTurretAmmo|setMarkerAlpha|setMarkerAlphaLocal|setMarkerBrush|setMarkerBrushLocal|setMarkerColor|setMarkerColorLocal|setMarkerDir|setMarkerDirLocal|setMarkerPos|setMarkerPosLocal|setMarkerShape|setMarkerShapeLocal|setMarkerSize|setMarkerSizeLocal|setMarkerText|setMarkerTextLocal|setMarkerType|setMarkerTypeLocal|setMass|setMimic|setMousePosition|setMusicEffect|setMusicEventHandler|setName|setNameSound|setObjectArguments|setObjectMaterial|setObjectMaterialGlobal|setObjectProxy|setObjectTexture|setObjectTextureGlobal|setObjectViewDistance|setOvercast|setOwner|setOxygenRemaining|setParticleCircle|setParticleClass|setParticleFire|setParticleParams|setParticleRandom|setPilotCameraDirection|setPilotCameraRotation|setPilotCameraTarget|setPilotLight|setPiPEffect|setPitch|setPlateNumber|setPlayable|setPlayerRespawnTime|setPos|setPosASL|setPosASL2|setPosASLW|setPosATL|setPosition|setPosWorld|setPylonLoadOut|setPylonsPriority|setRadioMsg|setRain|setRainbow|setRandomLip|setRank|setRectangular|setRepairCargo|setRotorBrakeRTD|setShadowDistance|setShotParents|setSide|setSimpleTaskAlwaysVisible|setSimpleTaskCustomData|setSimpleTaskDescription|setSimpleTaskDestination|setSimpleTaskTarget|setSimpleTaskType|setSimulWeatherLayers|setSize|setSkill|setSlingLoad|setSoundEffect|setSpeaker|setSpeech|setSpeedMode|setStamina|setStaminaScheme|setStatValue|setSuppression|setSystemOfUnits|setTargetAge|setTaskMarkerOffset|setTaskResult|setTaskState|setTerrainGrid|setText|setTimeMultiplier|setTitleEffect|setToneMapping|setToneMappingParams|setTrafficDensity|setTrafficDistance|setTrafficGap|setTrafficSpeed|setTriggerActivation|setTriggerArea|setTriggerStatements|setTriggerText|setTriggerTimeout|setTriggerType|setType|setUnconscious|setUnitAbility|setUnitLoadout|setUnitPos|setUnitPosWeak|setUnitRank|setUnitRecoilCoefficient|setUnitTrait|setUnloadInCombat|setUserActionText|setUserMFDText|setUserMFDValue|setVariable|setVectorDir|setVectorDirAndUp|setVectorUp|setVehicleAmmo|setVehicleAmmoDef|setVehicleArmor|setVehicleCargo|setVehicleId|setVehicleInit|setVehicleLock|setVehiclePosition|setVehicleRadar|setVehicleReceiveRemoteTargets|setVehicleReportOwnPosition|setVehicleReportRemoteTargets|setVehicleTIPars|setVehicleVarName|setVelocity|setVelocityModelSpace|setVelocityTransformation|setViewDistance|setVisibleIfTreeCollapsed|setWantedRpmRTD|setWaves|setWaypointBehaviour|setWaypointCombatMode|setWaypointCompletionRadius|setWaypointDescription|setWaypointForceBehaviour|setWaypointFormation|setWaypointHousePosition|setWaypointLoiterRadius|setWaypointLoiterType|setWaypointName|setWaypointPosition|setWaypointScript|setWaypointSpeed|setWaypointStatements|setWaypointTimeout|setWaypointType|setWaypointVisible|setWeaponReloadingTime|setWind|setWindDir|setWindForce|setWindStr|setWingForceScaleRTD|setWPPos|show3DIcons|showChat|showCinemaBorder|showCommandingMenu|showCompass|showCuratorCompass|showGPS|showHUD|showLegend|showMap|shownArtilleryComputer|shownChat|shownCompass|shownCuratorCompass|showNewEditorObject|shownGPS|shownHUD|shownMap|shownPad|shownRadio|shownScoretable|shownUAVFeed|shownWarrant|shownWatch|showPad|showRadio|showScoretable|showSubtitles|showUAVFeed|showWarrant|showWatch|showWaypoint|showWaypoints|side|sideAmbientLife|sideChat|sideEmpty|sideEnemy|sideFriendly|sideLogic|sideRadio|sideUnknown|simpleTasks|simulationEnabled|simulCloudDensity|simulCloudOcclusion|simulInClouds|simulWeatherSync|sin|size|sizeOf|skill|skillFinal|skipTime|sleep|sliderPosition|sliderRange|sliderSetPosition|sliderSetRange|sliderSetSpeed|sliderSpeed|slingLoadAssistantShown|soldierMagazines|someAmmo|sort|soundVolume|speaker|speed|speedMode|splitString|sqrt|squadParams|stance|startLoadingScreen|stop|stopEngineRTD|stopped|str|sunOrMoon|supportInfo|suppressFor|surfaceIsWater|surfaceNormal|surfaceType|swimInDepth|switchableUnits|switchAction|switchCamera|switchGesture|switchLight|switchMove|synchronizedObjects|synchronizedTriggers|synchronizedWaypoints|synchronizeObjectsAdd|synchronizeObjectsRemove|synchronizeTrigger|synchronizeWaypoint|systemChat|systemOfUnits|tan|targetKnowledge|targets|targetsAggregate|targetsQuery|taskAlwaysVisible|taskChildren|taskCompleted|taskCustomData|taskDescription|taskDestination|taskHint|taskMarkerOffset|taskNull|taskParent|taskResult|taskState|taskType|teamMember|teamMemberNull|teamName|teams|teamSwitch|teamSwitchEnabled|teamType|terminate|terrainIntersect|terrainIntersectASL|terrainIntersectAtASL|text|textLog|textLogFormat|tg|time|timeMultiplier|titleCut|titleFadeOut|titleObj|titleRsc|titleText|toArray|toFixed|toLower|toString|toUpper|triggerActivated|triggerActivation|triggerArea|triggerAttachedVehicle|triggerAttachObject|triggerAttachVehicle|triggerDynamicSimulation|triggerStatements|triggerText|triggerTimeout|triggerTimeoutCurrent|triggerType|turretLocal|turretOwner|turretUnit|tvAdd|tvClear|tvCollapse|tvCollapseAll|tvCount|tvCurSel|tvData|tvDelete|tvExpand|tvExpandAll|tvPicture|tvPictureRight|tvSetColor|tvSetCurSel|tvSetData|tvSetPicture|tvSetPictureColor|tvSetPictureColorDisabled|tvSetPictureColorSelected|tvSetPictureRight|tvSetPictureRightColor|tvSetPictureRightColorDisabled|tvSetPictureRightColorSelected|tvSetSelectColor|tvSetText|tvSetTooltip|tvSetValue|tvSort|tvSortByValue|tvText|tvTooltip|tvValue|type|typeName|typeOf|UAVControl|uiNamespace|uiSleep|unassignCurator|unassignItem|unassignTeam|unassignVehicle|underwater|uniform|uniformContainer|uniformItems|uniformMagazines|unitAddons|unitAimPosition|unitAimPositionVisual|unitBackpack|unitIsUAV|unitPos|unitReady|unitRecoilCoefficient|units|unitsBelowHeight|unlinkItem|unlockAchievement|unregisterTask|updateDrawIcon|updateMenuItem|updateObjectTree|useAIOperMapObstructionTest|useAISteeringComponent|useAudioTimeForMoves|userInputDisabled|vectorAdd|vectorCos|vectorCrossProduct|vectorDiff|vectorDir|vectorDirVisual|vectorDistance|vectorDistanceSqr|vectorDotProduct|vectorFromTo|vectorMagnitude|vectorMagnitudeSqr|vectorModelToWorld|vectorModelToWorldVisual|vectorMultiply|vectorNormalized|vectorUp|vectorUpVisual|vectorWorldToModel|vectorWorldToModelVisual|vehicle|vehicleCargoEnabled|vehicleChat|vehicleRadio|vehicleReceiveRemoteTargets|vehicleReportOwnPosition|vehicleReportRemoteTargets|vehicles|vehicleVarName|velocity|velocityModelSpace|verifySignature|vest|vestContainer|vestItems|vestMagazines|viewDistance|visibleCompass|visibleGPS|visibleMap|visiblePosition|visiblePositionASL|visibleScoretable|visibleWatch|waitUntil|waves|waypointAttachedObject|waypointAttachedVehicle|waypointAttachObject|waypointAttachVehicle|waypointBehaviour|waypointCombatMode|waypointCompletionRadius|waypointDescription|waypointForceBehaviour|waypointFormation|waypointHousePosition|waypointLoiterRadius|waypointLoiterType|waypointName|waypointPosition|waypoints|waypointScript|waypointsEnabledUAV|waypointShow|waypointSpeed|waypointStatements|waypointTimeout|waypointTimeoutCurrent|waypointType|waypointVisible|weaponAccessories|weaponAccessoriesCargo|weaponCargo|weaponDirection|weaponInertia|weaponLowered|weapons|weaponsItems|weaponsItemsCargo|weaponState|weaponsTurret|weightRTD|west|WFSideText|wind|windDir|windRTD|windStr|wingsForcesRTD|worldName|worldSize|worldToModel|worldToModelVisual|worldToScreen)\b/i,
./node_modules/.pnpm/prismjs@1.30.0/node_modules/prismjs/components/prism-sqf.min.js:Prism.languages.sqf=Prism.languages.extend("clike",{string:{pattern:/"(?:(?:"")?[^"])*"(?!")|'(?:[^'])*'/,greedy:!0},keyword:/\b(?:breakOut|breakTo|call|case|catch|default|do|echo|else|execFSM|execVM|exitWith|for|forEach|forEachMember|forEachMemberAgent|forEachMemberTeam|from|goto|if|nil|preprocessFile|preprocessFileLineNumbers|private|scopeName|spawn|step|switch|then|throw|to|try|while|with)\b/i,boolean:/\b(?:false|true)\b/i,function:/\b(?:abs|accTime|acos|action|actionIDs|actionKeys|actionKeysImages|actionKeysNames|actionKeysNamesArray|actionName|actionParams|activateAddons|activatedAddons|activateKey|add3DENConnection|add3DENEventHandler|add3DENLayer|addAction|addBackpack|addBackpackCargo|addBackpackCargoGlobal|addBackpackGlobal|addCamShake|addCuratorAddons|addCuratorCameraArea|addCuratorEditableObjects|addCuratorEditingArea|addCuratorPoints|addEditorObject|addEventHandler|addForce|addForceGeneratorRTD|addGoggles|addGroupIcon|addHandgunItem|addHeadgear|addItem|addItemCargo|addItemCargoGlobal|addItemPool|addItemToBackpack|addItemToUniform|addItemToVest|addLiveStats|addMagazine|addMagazineAmmoCargo|addMagazineCargo|addMagazineCargoGlobal|addMagazineGlobal|addMagazinePool|addMagazines|addMagazineTurret|addMenu|addMenuItem|addMissionEventHandler|addMPEventHandler|addMusicEventHandler|addOwnedMine|addPlayerScores|addPrimaryWeaponItem|addPublicVariableEventHandler|addRating|addResources|addScore|addScoreSide|addSecondaryWeaponItem|addSwitchableUnit|addTeamMember|addToRemainsCollector|addTorque|addUniform|addVehicle|addVest|addWaypoint|addWeapon|addWeaponCargo|addWeaponCargoGlobal|addWeaponGlobal|addWeaponItem|addWeaponPool|addWeaponTurret|admin|agent|agents|AGLToASL|aimedAtTarget|aimPos|airDensityCurveRTD|airDensityRTD|airplaneThrottle|airportSide|AISFinishHeal|alive|all3DENEntities|allAirports|allControls|allCurators|allCutLayers|allDead|allDeadMen|allDisplays|allGroups|allMapMarkers|allMines|allMissionObjects|allow3DMode|allowCrewInImmobile|allowCuratorLogicIgnoreAreas|allowDamage|allowDammage|allowFileOperations|allowFleeing|allowGetIn|allowSprint|allPlayers|allSimpleObjects|allSites|allTurrets|allUnits|allUnitsUAV|allVariables|ammo|ammoOnPylon|animate|animateBay|animateDoor|animatePylon|animateSource|animationNames|animationPhase|animationSourcePhase|animationState|append|apply|armoryPoints|arrayIntersect|asin|ASLToAGL|ASLToATL|assert|assignAsCargo|assignAsCargoIndex|assignAsCommander|assignAsDriver|assignAsGunner|assignAsTurret|assignCurator|assignedCargo|assignedCommander|assignedDriver|assignedGunner|assignedItems|assignedTarget|assignedTeam|assignedVehicle|assignedVehicleRole|assignItem|assignTeam|assignToAirport|atan|atan2|atg|ATLToASL|attachedObject|attachedObjects|attachedTo|attachObject|attachTo|attackEnabled|backpack|backpackCargo|backpackContainer|backpackItems|backpackMagazines|backpackSpaceFor|behaviour|benchmark|binocular|blufor|boundingBox|boundingBoxReal|boundingCenter|briefingName|buildingExit|buildingPos|buldozer_EnableRoadDiag|buldozer_IsEnabledRoadDiag|buldozer_LoadNewRoads|buldozer_reloadOperMap|buttonAction|buttonSetAction|cadetMode|callExtension|camCommand|camCommit|camCommitPrepared|camCommitted|camConstuctionSetParams|camCreate|camDestroy|cameraEffect|cameraEffectEnableHUD|cameraInterest|cameraOn|cameraView|campaignConfigFile|camPreload|camPreloaded|camPrepareBank|camPrepareDir|camPrepareDive|camPrepareFocus|camPrepareFov|camPrepareFovRange|camPreparePos|camPrepareRelPos|camPrepareTarget|camSetBank|camSetDir|camSetDive|camSetFocus|camSetFov|camSetFovRange|camSetPos|camSetRelPos|camSetTarget|camTarget|camUseNVG|canAdd|canAddItemToBackpack|canAddItemToUniform|canAddItemToVest|cancelSimpleTaskDestination|canFire|canMove|canSlingLoad|canStand|canSuspend|canTriggerDynamicSimulation|canUnloadInCombat|canVehicleCargo|captive|captiveNum|cbChecked|cbSetChecked|ceil|channelEnabled|cheatsEnabled|checkAIFeature|checkVisibility|civilian|className|clear3DENAttribute|clear3DENInventory|clearAllItemsFromBackpack|clearBackpackCargo|clearBackpackCargoGlobal|clearForcesRTD|clearGroupIcons|clearItemCargo|clearItemCargoGlobal|clearItemPool|clearMagazineCargo|clearMagazineCargoGlobal|clearMagazinePool|clearOverlay|clearRadio|clearVehicleInit|clearWeaponCargo|clearWeaponCargoGlobal|clearWeaponPool|clientOwner|closeDialog|closeDisplay|closeOverlay|collapseObjectTree|collect3DENHistory|collectiveRTD|combatMode|commandArtilleryFire|commandChat|commander|commandFire|commandFollow|commandFSM|commandGetOut|commandingMenu|commandMove|commandRadio|commandStop|commandSuppressiveFire|commandTarget|commandWatch|comment|commitOverlay|compile|compileFinal|completedFSM|composeText|configClasses|configFile|configHierarchy|configName|configNull|configProperties|configSourceAddonList|configSourceMod|configSourceModList|confirmSensorTarget|connectTerminalToUAV|controlNull|controlsGroupCtrl|copyFromClipboard|copyToClipboard|copyWaypoints|cos|count|countEnemy|countFriendly|countSide|countType|countUnknown|create3DENComposition|create3DENEntity|createAgent|createCenter|createDialog|createDiaryLink|createDiaryRecord|createDiarySubject|createDisplay|createGearDialog|createGroup|createGuardedPoint|createLocation|createMarker|createMarkerLocal|createMenu|createMine|createMissionDisplay|createMPCampaignDisplay|createSimpleObject|createSimpleTask|createSite|createSoundSource|createTask|createTeam|createTrigger|createUnit|createVehicle|createVehicleCrew|createVehicleLocal|crew|ctAddHeader|ctAddRow|ctClear|ctCurSel|ctData|ctFindHeaderRows|ctFindRowHeader|ctHeaderControls|ctHeaderCount|ctRemoveHeaders|ctRemoveRows|ctrlActivate|ctrlAddEventHandler|ctrlAngle|ctrlAutoScrollDelay|ctrlAutoScrollRewind|ctrlAutoScrollSpeed|ctrlChecked|ctrlClassName|ctrlCommit|ctrlCommitted|ctrlCreate|ctrlDelete|ctrlEnable|ctrlEnabled|ctrlFade|ctrlHTMLLoaded|ctrlIDC|ctrlIDD|ctrlMapAnimAdd|ctrlMapAnimClear|ctrlMapAnimCommit|ctrlMapAnimDone|ctrlMapCursor|ctrlMapMouseOver|ctrlMapScale|ctrlMapScreenToWorld|ctrlMapWorldToScreen|ctrlModel|ctrlModelDirAndUp|ctrlModelScale|ctrlParent|ctrlParentControlsGroup|ctrlPosition|ctrlRemoveAllEventHandlers|ctrlRemoveEventHandler|ctrlScale|ctrlSetActiveColor|ctrlSetAngle|ctrlSetAutoScrollDelay|ctrlSetAutoScrollRewind|ctrlSetAutoScrollSpeed|ctrlSetBackgroundColor|ctrlSetChecked|ctrlSetDisabledColor|ctrlSetEventHandler|ctrlSetFade|ctrlSetFocus|ctrlSetFont|ctrlSetFontH1|ctrlSetFontH1B|ctrlSetFontH2|ctrlSetFontH2B|ctrlSetFontH3|ctrlSetFontH3B|ctrlSetFontH4|ctrlSetFontH4B|ctrlSetFontH5|ctrlSetFontH5B|ctrlSetFontH6|ctrlSetFontH6B|ctrlSetFontHeight|ctrlSetFontHeightH1|ctrlSetFontHeightH2|ctrlSetFontHeightH3|ctrlSetFontHeightH4|ctrlSetFontHeightH5|ctrlSetFontHeightH6|ctrlSetFontHeightSecondary|ctrlSetFontP|ctrlSetFontPB|ctrlSetFontSecondary|ctrlSetForegroundColor|ctrlSetModel|ctrlSetModelDirAndUp|ctrlSetModelScale|ctrlSetPixelPrecision|ctrlSetPosition|ctrlSetScale|ctrlSetStructuredText|ctrlSetText|ctrlSetTextColor|ctrlSetTextColorSecondary|ctrlSetTextSecondary|ctrlSetTooltip|ctrlSetTooltipColorBox|ctrlSetTooltipColorShade|ctrlSetTooltipColorText|ctrlShow|ctrlShown|ctrlText|ctrlTextHeight|ctrlTextSecondary|ctrlTextWidth|ctrlType|ctrlVisible|ctRowControls|ctRowCount|ctSetCurSel|ctSetData|ctSetHeaderTemplate|ctSetRowTemplate|ctSetValue|ctValue|curatorAddons|curatorCamera|curatorCameraArea|curatorCameraAreaCeiling|curatorCoef|curatorEditableObjects|curatorEditingArea|curatorEditingAreaType|curatorMouseOver|curatorPoints|curatorRegisteredObjects|curatorSelected|curatorWaypointCost|current3DENOperation|currentChannel|currentCommand|currentMagazine|currentMagazineDetail|currentMagazineDetailTurret|currentMagazineTurret|currentMuzzle|currentNamespace|currentTask|currentTasks|currentThrowable|currentVisionMode|currentWaypoint|currentWeapon|currentWeaponMode|currentWeaponTurret|currentZeroing|cursorObject|cursorTarget|customChat|customRadio|cutFadeOut|cutObj|cutRsc|cutText|damage|date|dateToNumber|daytime|deActivateKey|debriefingText|debugFSM|debugLog|deg|delete3DENEntities|deleteAt|deleteCenter|deleteCollection|deleteEditorObject|deleteGroup|deleteGroupWhenEmpty|deleteIdentity|deleteLocation|deleteMarker|deleteMarkerLocal|deleteRange|deleteResources|deleteSite|deleteStatus|deleteTeam|deleteVehicle|deleteVehicleCrew|deleteWaypoint|detach|detectedMines|diag_activeMissionFSMs|diag_activeScripts|diag_activeSQFScripts|diag_activeSQSScripts|diag_captureFrame|diag_captureFrameToFile|diag_captureSlowFrame|diag_codePerformance|diag_drawMode|diag_dynamicSimulationEnd|diag_enable|diag_enabled|diag_fps|diag_fpsMin|diag_frameNo|diag_lightNewLoad|diag_list|diag_log|diag_logSlowFrame|diag_mergeConfigFile|diag_recordTurretLimits|diag_setLightNew|diag_tickTime|diag_toggle|dialog|diarySubjectExists|didJIP|didJIPOwner|difficulty|difficultyEnabled|difficultyEnabledRTD|difficultyOption|direction|directSay|disableAI|disableCollisionWith|disableConversation|disableDebriefingStats|disableMapIndicators|disableNVGEquipment|disableRemoteSensors|disableSerialization|disableTIEquipment|disableUAVConnectability|disableUserInput|displayAddEventHandler|displayCtrl|displayNull|displayParent|displayRemoveAllEventHandlers|displayRemoveEventHandler|displaySetEventHandler|dissolveTeam|distance|distance2D|distanceSqr|distributionRegion|do3DENAction|doArtilleryFire|doFire|doFollow|doFSM|doGetOut|doMove|doorPhase|doStop|doSuppressiveFire|doTarget|doWatch|drawArrow|drawEllipse|drawIcon|drawIcon3D|drawLine|drawLine3D|drawLink|drawLocation|drawPolygon|drawRectangle|drawTriangle|driver|drop|dynamicSimulationDistance|dynamicSimulationDistanceCoef|dynamicSimulationEnabled|dynamicSimulationSystemEnabled|east|edit3DENMissionAttributes|editObject|editorSetEventHandler|effectiveCommander|emptyPositions|enableAI|enableAIFeature|enableAimPrecision|enableAttack|enableAudioFeature|enableAutoStartUpRTD|enableAutoTrimRTD|enableCamShake|enableCaustics|enableChannel|enableCollisionWith|enableCopilot|enableDebriefingStats|enableDiagLegend|enableDynamicSimulation|enableDynamicSimulationSystem|enableEndDialog|enableEngineArtillery|enableEnvironment|enableFatigue|enableGunLights|enableInfoPanelComponent|enableIRLasers|enableMimics|enablePersonTurret|enableRadio|enableReload|enableRopeAttach|enableSatNormalOnDetail|enableSaving|enableSentences|enableSimulation|enableSimulationGlobal|enableStamina|enableStressDamage|enableTeamSwitch|enableTraffic|enableUAVConnectability|enableUAVWaypoints|enableVehicleCargo|enableVehicleSensor|enableWeaponDisassembly|endl|endLoadingScreen|endMission|engineOn|enginesIsOnRTD|enginesPowerRTD|enginesRpmRTD|enginesTorqueRTD|entities|environmentEnabled|estimatedEndServerTime|estimatedTimeLeft|evalObjectArgument|everyBackpack|everyContainer|exec|execEditorScript|exp|expectedDestination|exportJIPMessages|eyeDirection|eyePos|face|faction|fadeMusic|fadeRadio|fadeSound|fadeSpeech|failMission|fillWeaponsFromPool|find|findCover|findDisplay|findEditorObject|findEmptyPosition|findEmptyPositionReady|findIf|findNearestEnemy|finishMissionInit|finite|fire|fireAtTarget|firstBackpack|flag|flagAnimationPhase|flagOwner|flagSide|flagTexture|fleeing|floor|flyInHeight|flyInHeightASL|fog|fogForecast|fogParams|forceAddUniform|forceAtPositionRTD|forcedMap|forceEnd|forceFlagTexture|forceFollowRoad|forceGeneratorRTD|forceMap|forceRespawn|forceSpeed|forceWalk|forceWeaponFire|forceWeatherChange|forgetTarget|format|formation|formationDirection|formationLeader|formationMembers|formationPosition|formationTask|formatText|formLeader|freeLook|fromEditor|fuel|fullCrew|gearIDCAmmoCount|gearSlotAmmoCount|gearSlotData|get3DENActionState|get3DENAttribute|get3DENCamera|get3DENConnections|get3DENEntity|get3DENEntityID|get3DENGrid|get3DENIconsVisible|get3DENLayerEntities|get3DENLinesVisible|get3DENMissionAttribute|get3DENMouseOver|get3DENSelected|getAimingCoef|getAllEnvSoundControllers|getAllHitPointsDamage|getAllOwnedMines|getAllSoundControllers|getAmmoCargo|getAnimAimPrecision|getAnimSpeedCoef|getArray|getArtilleryAmmo|getArtilleryComputerSettings|getArtilleryETA|getAssignedCuratorLogic|getAssignedCuratorUnit|getBackpackCargo|getBleedingRemaining|getBurningValue|getCameraViewDirection|getCargoIndex|getCenterOfMass|getClientState|getClientStateNumber|getCompatiblePylonMagazines|getConnectedUAV|getContainerMaxLoad|getCursorObjectParams|getCustomAimCoef|getDammage|getDescription|getDir|getDirVisual|getDLCAssetsUsage|getDLCAssetsUsageByName|getDLCs|getDLCUsageTime|getEditorCamera|getEditorMode|getEditorObjectScope|getElevationOffset|getEngineTargetRpmRTD|getEnvSoundController|getFatigue|getFieldManualStartPage|getForcedFlagTexture|getFriend|getFSMVariable|getFuelCargo|getGroupIcon|getGroupIconParams|getGroupIcons|getHideFrom|getHit|getHitIndex|getHitPointDamage|getItemCargo|getMagazineCargo|getMarkerColor|getMarkerPos|getMarkerSize|getMarkerType|getMass|getMissionConfig|getMissionConfigValue|getMissionDLCs|getMissionLayerEntities|getMissionLayers|getModelInfo|getMousePosition|getMusicPlayedTime|getNumber|getObjectArgument|getObjectChildren|getObjectDLC|getObjectMaterials|getObjectProxy|getObjectTextures|getObjectType|getObjectViewDistance|getOxygenRemaining|getPersonUsedDLCs|getPilotCameraDirection|getPilotCameraPosition|getPilotCameraRotation|getPilotCameraTarget|getPlateNumber|getPlayerChannel|getPlayerScores|getPlayerUID|getPlayerUIDOld|getPos|getPosASL|getPosASLVisual|getPosASLW|getPosATL|getPosATLVisual|getPosVisual|getPosWorld|getPylonMagazines|getRelDir|getRelPos|getRemoteSensorsDisabled|getRepairCargo|getResolution|getRotorBrakeRTD|getShadowDistance|getShotParents|getSlingLoad|getSoundController|getSoundControllerResult|getSpeed|getStamina|getStatValue|getSuppression|getTerrainGrid|getTerrainHeightASL|getText|getTotalDLCUsageTime|getTrimOffsetRTD|getUnitLoadout|getUnitTrait|getUserMFDText|getUserMFDValue|getVariable|getVehicleCargo|getWeaponCargo|getWeaponSway|getWingsOrientationRTD|getWingsPositionRTD|getWPPos|glanceAt|globalChat|globalRadio|goggles|group|groupChat|groupFromNetId|groupIconSelectable|groupIconsVisible|groupId|groupOwner|groupRadio|groupSelectedUnits|groupSelectUnit|grpNull|gunner|gusts|halt|handgunItems|handgunMagazine|handgunWeapon|handsHit|hasInterface|hasPilotCamera|hasWeapon|hcAllGroups|hcGroupParams|hcLeader|hcRemoveAllGroups|hcRemoveGroup|hcSelected|hcSelectGroup|hcSetGroup|hcShowBar|hcShownBar|headgear|hideBody|hideObject|hideObjectGlobal|hideSelection|hint|hintC|hintCadet|hintSilent|hmd|hostMission|htmlLoad|HUDMovementLevels|humidity|image|importAllGroups|importance|in|inArea|inAreaArray|incapacitatedState|independent|inflame|inflamed|infoPanel|infoPanelComponentEnabled|infoPanelComponents|infoPanels|inGameUISetEventHandler|inheritsFrom|initAmbientLife|inPolygon|inputAction|inRangeOfArtillery|insertEditorObject|intersect|is3DEN|is3DENMultiplayer|isAbleToBreathe|isAgent|isAimPrecisionEnabled|isArray|isAutoHoverOn|isAutonomous|isAutoStartUpEnabledRTD|isAutotest|isAutoTrimOnRTD|isBleeding|isBurning|isClass|isCollisionLightOn|isCopilotEnabled|isDamageAllowed|isDedicated|isDLCAvailable|isEngineOn|isEqualTo|isEqualType|isEqualTypeAll|isEqualTypeAny|isEqualTypeArray|isEqualTypeParams|isFilePatchingEnabled|isFlashlightOn|isFlatEmpty|isForcedWalk|isFormationLeader|isGroupDeletedWhenEmpty|isHidden|isInRemainsCollector|isInstructorFigureEnabled|isIRLaserOn|isKeyActive|isKindOf|isLaserOn|isLightOn|isLocalized|isManualFire|isMarkedForCollection|isMultiplayer|isMultiplayerSolo|isNil|isNull|isNumber|isObjectHidden|isObjectRTD|isOnRoad|isPipEnabled|isPlayer|isRealTime|isRemoteExecuted|isRemoteExecutedJIP|isServer|isShowing3DIcons|isSimpleObject|isSprintAllowed|isStaminaEnabled|isSteamMission|isStreamFriendlyUIEnabled|isStressDamageEnabled|isText|isTouchingGround|isTurnedOut|isTutHintsEnabled|isUAVConnectable|isUAVConnected|isUIContext|isUniformAllowed|isVehicleCargo|isVehicleRadarOn|isVehicleSensorEnabled|isWalking|isWeaponDeployed|isWeaponRested|itemCargo|items|itemsWithMagazines|join|joinAs|joinAsSilent|joinSilent|joinString|kbAddDatabase|kbAddDatabaseTargets|kbAddTopic|kbHasTopic|kbReact|kbRemoveTopic|kbTell|kbWasSaid|keyImage|keyName|knowsAbout|land|landAt|landResult|language|laserTarget|lbAdd|lbClear|lbColor|lbColorRight|lbCurSel|lbData|lbDelete|lbIsSelected|lbPicture|lbPictureRight|lbSelection|lbSetColor|lbSetColorRight|lbSetCurSel|lbSetData|lbSetPicture|lbSetPictureColor|lbSetPictureColorDisabled|lbSetPictureColorSelected|lbSetPictureRight|lbSetPictureRightColor|lbSetPictureRightColorDisabled|lbSetPictureRightColorSelected|lbSetSelectColor|lbSetSelectColorRight|lbSetSelected|lbSetText|lbSetTextRight|lbSetTooltip|lbSetValue|lbSize|lbSort|lbSortByValue|lbText|lbTextRight|lbValue|leader|leaderboardDeInit|leaderboardGetRows|leaderboardInit|leaderboardRequestRowsFriends|leaderboardRequestRowsGlobal|leaderboardRequestRowsGlobalAroundUser|leaderboardsRequestUploadScore|leaderboardsRequestUploadScoreKeepBest|leaderboardState|leaveVehicle|libraryCredits|libraryDisclaimers|lifeState|lightAttachObject|lightDetachObject|lightIsOn|lightnings|limitSpeed|linearConversion|lineBreak|lineIntersects|lineIntersectsObjs|lineIntersectsSurfaces|lineIntersectsWith|linkItem|list|listObjects|listRemoteTargets|listVehicleSensors|ln|lnbAddArray|lnbAddColumn|lnbAddRow|lnbClear|lnbColor|lnbColorRight|lnbCurSelRow|lnbData|lnbDeleteColumn|lnbDeleteRow|lnbGetColumnsPosition|lnbPicture|lnbPictureRight|lnbSetColor|lnbSetColorRight|lnbSetColumnsPos|lnbSetCurSelRow|lnbSetData|lnbSetPicture|lnbSetPictureColor|lnbSetPictureColorRight|lnbSetPictureColorSelected|lnbSetPictureColorSelectedRight|lnbSetPictureRight|lnbSetText|lnbSetTextRight|lnbSetValue|lnbSize|lnbSort|lnbSortByValue|lnbText|lnbTextRight|lnbValue|load|loadAbs|loadBackpack|loadFile|loadGame|loadIdentity|loadMagazine|loadOverlay|loadStatus|loadUniform|loadVest|local|localize|locationNull|locationPosition|lock|lockCameraTo|lockCargo|lockDriver|locked|lockedCargo|lockedDriver|lockedTurret|lockIdentity|lockTurret|lockWP|log|logEntities|logNetwork|logNetworkTerminate|lookAt|lookAtPos|magazineCargo|magazines|magazinesAllTurrets|magazinesAmmo|magazinesAmmoCargo|magazinesAmmoFull|magazinesDetail|magazinesDetailBackpack|magazinesDetailUniform|magazinesDetailVest|magazinesTurret|magazineTurretAmmo|mapAnimAdd|mapAnimClear|mapAnimCommit|mapAnimDone|mapCenterOnCamera|mapGridPosition|markAsFinishedOnSteam|markerAlpha|markerBrush|markerColor|markerDir|markerPos|markerShape|markerSize|markerText|markerType|max|members|menuAction|menuAdd|menuChecked|menuClear|menuCollapse|menuData|menuDelete|menuEnable|menuEnabled|menuExpand|menuHover|menuPicture|menuSetAction|menuSetCheck|menuSetData|menuSetPicture|menuSetValue|menuShortcut|menuShortcutText|menuSize|menuSort|menuText|menuURL|menuValue|min|mineActive|mineDetectedBy|missionConfigFile|missionDifficulty|missionName|missionNamespace|missionStart|missionVersion|modelToWorld|modelToWorldVisual|modelToWorldVisualWorld|modelToWorldWorld|modParams|moonIntensity|moonPhase|morale|move|move3DENCamera|moveInAny|moveInCargo|moveInCommander|moveInDriver|moveInGunner|moveInTurret|moveObjectToEnd|moveOut|moveTime|moveTo|moveToCompleted|moveToFailed|musicVolume|name|nameSound|nearEntities|nearestBuilding|nearestLocation|nearestLocations|nearestLocationWithDubbing|nearestObject|nearestObjects|nearestTerrainObjects|nearObjects|nearObjectsReady|nearRoads|nearSupplies|nearTargets|needReload|netId|netObjNull|newOverlay|nextMenuItemIndex|nextWeatherChange|nMenuItems|numberOfEnginesRTD|numberToDate|objectCurators|objectFromNetId|objectParent|objNull|objStatus|onBriefingGear|onBriefingGroup|onBriefingNotes|onBriefingPlan|onBriefingTeamSwitch|onCommandModeChanged|onDoubleClick|onEachFrame|onGroupIconClick|onGroupIconOverEnter|onGroupIconOverLeave|onHCGroupSelectionChanged|onMapSingleClick|onPlayerConnected|onPlayerDisconnected|onPreloadFinished|onPreloadStarted|onShowNewObject|onTeamSwitch|openCuratorInterface|openDLCPage|openDSInterface|openMap|openSteamApp|openYoutubeVideo|opfor|orderGetIn|overcast|overcastForecast|owner|param|params|parseNumber|parseSimpleArray|parseText|parsingNamespace|particlesQuality|pi|pickWeaponPool|pitch|pixelGrid|pixelGridBase|pixelGridNoUIScale|pixelH|pixelW|playableSlotsNumber|playableUnits|playAction|playActionNow|player|playerRespawnTime|playerSide|playersNumber|playGesture|playMission|playMove|playMoveNow|playMusic|playScriptedMission|playSound|playSound3D|position|positionCameraToWorld|posScreenToWorld|posWorldToScreen|ppEffectAdjust|ppEffectCommit|ppEffectCommitted|ppEffectCreate|ppEffectDestroy|ppEffectEnable|ppEffectEnabled|ppEffectForceInNVG|precision|preloadCamera|preloadObject|preloadSound|preloadTitleObj|preloadTitleRsc|primaryWeapon|primaryWeaponItems|primaryWeaponMagazine|priority|processDiaryLink|processInitCommands|productVersion|profileName|profileNamespace|profileNameSteam|progressLoadingScreen|progressPosition|progressSetPosition|publicVariable|publicVariableClient|publicVariableServer|pushBack|pushBackUnique|putWeaponPool|queryItemsPool|queryMagazinePool|queryWeaponPool|rad|radioChannelAdd|radioChannelCreate|radioChannelRemove|radioChannelSetCallSign|radioChannelSetLabel|radioVolume|rain|rainbow|random|rank|rankId|rating|rectangular|registeredTasks|registerTask|reload|reloadEnabled|remoteControl|remoteExec|remoteExecCall|remoteExecutedOwner|remove3DENConnection|remove3DENEventHandler|remove3DENLayer|removeAction|removeAll3DENEventHandlers|removeAllActions|removeAllAssignedItems|removeAllContainers|removeAllCuratorAddons|removeAllCuratorCameraAreas|removeAllCuratorEditingAreas|removeAllEventHandlers|removeAllHandgunItems|removeAllItems|removeAllItemsWithMagazines|removeAllMissionEventHandlers|removeAllMPEventHandlers|removeAllMusicEventHandlers|removeAllOwnedMines|removeAllPrimaryWeaponItems|removeAllWeapons|removeBackpack|removeBackpackGlobal|removeCuratorAddons|removeCuratorCameraArea|removeCuratorEditableObjects|removeCuratorEditingArea|removeDrawIcon|removeDrawLinks|removeEventHandler|removeFromRemainsCollector|removeGoggles|removeGroupIcon|removeHandgunItem|removeHeadgear|removeItem|removeItemFromBackpack|removeItemFromUniform|removeItemFromVest|removeItems|removeMagazine|removeMagazineGlobal|removeMagazines|removeMagazinesTurret|removeMagazineTurret|removeMenuItem|removeMissionEventHandler|removeMPEventHandler|removeMusicEventHandler|removeOwnedMine|removePrimaryWeaponItem|removeSecondaryWeaponItem|removeSimpleTask|removeSwitchableUnit|removeTeamMember|removeUniform|removeVest|removeWeapon|removeWeaponAttachmentCargo|removeWeaponCargo|removeWeaponGlobal|removeWeaponTurret|reportRemoteTarget|requiredVersion|resetCamShake|resetSubgroupDirection|resistance|resize|resources|respawnVehicle|restartEditorCamera|reveal|revealMine|reverse|reversedMouseY|roadAt|roadsConnectedTo|roleDescription|ropeAttachedObjects|ropeAttachedTo|ropeAttachEnabled|ropeAttachTo|ropeCreate|ropeCut|ropeDestroy|ropeDetach|ropeEndPosition|ropeLength|ropes|ropeUnwind|ropeUnwound|rotorsForcesRTD|rotorsRpmRTD|round|runInitScript|safeZoneH|safeZoneW|safeZoneWAbs|safeZoneX|safeZoneXAbs|safeZoneY|save3DENInventory|saveGame|saveIdentity|saveJoysticks|saveOverlay|saveProfileNamespace|saveStatus|saveVar|savingEnabled|say|say2D|say3D|score|scoreSide|screenshot|screenToWorld|scriptDone|scriptName|scriptNull|scudState|secondaryWeapon|secondaryWeaponItems|secondaryWeaponMagazine|select|selectBestPlaces|selectDiarySubject|selectedEditorObjects|selectEditorObject|selectionNames|selectionPosition|selectLeader|selectMax|selectMin|selectNoPlayer|selectPlayer|selectRandom|selectRandomWeighted|selectWeapon|selectWeaponTurret|sendAUMessage|sendSimpleCommand|sendTask|sendTaskResult|sendUDPMessage|serverCommand|serverCommandAvailable|serverCommandExecutable|serverName|serverTime|set|set3DENAttribute|set3DENAttributes|set3DENGrid|set3DENIconsVisible|set3DENLayer|set3DENLinesVisible|set3DENLogicType|set3DENMissionAttribute|set3DENMissionAttributes|set3DENModelsVisible|set3DENObjectType|set3DENSelected|setAccTime|setActualCollectiveRTD|setAirplaneThrottle|setAirportSide|setAmmo|setAmmoCargo|setAmmoOnPylon|setAnimSpeedCoef|setAperture|setApertureNew|setArmoryPoints|setAttributes|setAutonomous|setBehaviour|setBleedingRemaining|setBrakesRTD|setCameraInterest|setCamShakeDefParams|setCamShakeParams|setCamUseTI|setCaptive|setCenterOfMass|setCollisionLight|setCombatMode|setCompassOscillation|setConvoySeparation|setCuratorCameraAreaCeiling|setCuratorCoef|setCuratorEditingAreaType|setCuratorWaypointCost|setCurrentChannel|setCurrentTask|setCurrentWaypoint|setCustomAimCoef|setCustomWeightRTD|setDamage|setDammage|setDate|setDebriefingText|setDefaultCamera|setDestination|setDetailMapBlendPars|setDir|setDirection|setDrawIcon|setDriveOnPath|setDropInterval|setDynamicSimulationDistance|setDynamicSimulationDistanceCoef|setEditorMode|setEditorObjectScope|setEffectCondition|setEngineRpmRTD|setFace|setFaceAnimation|setFatigue|setFeatureType|setFlagAnimationPhase|setFlagOwner|setFlagSide|setFlagTexture|setFog|setForceGeneratorRTD|setFormation|setFormationTask|setFormDir|setFriend|setFromEditor|setFSMVariable|setFuel|setFuelCargo|setGroupIcon|setGroupIconParams|setGroupIconsSelectable|setGroupIconsVisible|setGroupId|setGroupIdGlobal|setGroupOwner|setGusts|setHideBehind|setHit|setHitIndex|setHitPointDamage|setHorizonParallaxCoef|setHUDMovementLevels|setIdentity|setImportance|setInfoPanel|setLeader|setLightAmbient|setLightAttenuation|setLightBrightness|setLightColor|setLightDayLight|setLightFlareMaxDistance|setLightFlareSize|setLightIntensity|setLightnings|setLightUseFlare|setLocalWindParams|setMagazineTurretAmmo|setMarkerAlpha|setMarkerAlphaLocal|setMarkerBrush|setMarkerBrushLocal|setMarkerColor|setMarkerColorLocal|setMarkerDir|setMarkerDirLocal|setMarkerPos|setMarkerPosLocal|setMarkerShape|setMarkerShapeLocal|setMarkerSize|setMarkerSizeLocal|setMarkerText|setMarkerTextLocal|setMarkerType|setMarkerTypeLocal|setMass|setMimic|setMousePosition|setMusicEffect|setMusicEventHandler|setName|setNameSound|setObjectArguments|setObjectMaterial|setObjectMaterialGlobal|setObjectProxy|setObjectTexture|setObjectTextureGlobal|setObjectViewDistance|setOvercast|setOwner|setOxygenRemaining|setParticleCircle|setParticleClass|setParticleFire|setParticleParams|setParticleRandom|setPilotCameraDirection|setPilotCameraRotation|setPilotCameraTarget|setPilotLight|setPiPEffect|setPitch|setPlateNumber|setPlayable|setPlayerRespawnTime|setPos|setPosASL|setPosASL2|setPosASLW|setPosATL|setPosition|setPosWorld|setPylonLoadOut|setPylonsPriority|setRadioMsg|setRain|setRainbow|setRandomLip|setRank|setRectangular|setRepairCargo|setRotorBrakeRTD|setShadowDistance|setShotParents|setSide|setSimpleTaskAlwaysVisible|setSimpleTaskCustomData|setSimpleTaskDescription|setSimpleTaskDestination|setSimpleTaskTarget|setSimpleTaskType|setSimulWeatherLayers|setSize|setSkill|setSlingLoad|setSoundEffect|setSpeaker|setSpeech|setSpeedMode|setStamina|setStaminaScheme|setStatValue|setSuppression|setSystemOfUnits|setTargetAge|setTaskMarkerOffset|setTaskResult|setTaskState|setTerrainGrid|setText|setTimeMultiplier|setTitleEffect|setToneMapping|setToneMappingParams|setTrafficDensity|setTrafficDistance|setTrafficGap|setTrafficSpeed|setTriggerActivation|setTriggerArea|setTriggerStatements|setTriggerText|setTriggerTimeout|setTriggerType|setType|setUnconscious|setUnitAbility|setUnitLoadout|setUnitPos|setUnitPosWeak|setUnitRank|setUnitRecoilCoefficient|setUnitTrait|setUnloadInCombat|setUserActionText|setUserMFDText|setUserMFDValue|setVariable|setVectorDir|setVectorDirAndUp|setVectorUp|setVehicleAmmo|setVehicleAmmoDef|setVehicleArmor|setVehicleCargo|setVehicleId|setVehicleInit|setVehicleLock|setVehiclePosition|setVehicleRadar|setVehicleReceiveRemoteTargets|setVehicleReportOwnPosition|setVehicleReportRemoteTargets|setVehicleTIPars|setVehicleVarName|setVelocity|setVelocityModelSpace|setVelocityTransformation|setViewDistance|setVisibleIfTreeCollapsed|setWantedRpmRTD|setWaves|setWaypointBehaviour|setWaypointCombatMode|setWaypointCompletionRadius|setWaypointDescription|setWaypointForceBehaviour|setWaypointFormation|setWaypointHousePosition|setWaypointLoiterRadius|setWaypointLoiterType|setWaypointName|setWaypointPosition|setWaypointScript|setWaypointSpeed|setWaypointStatements|setWaypointTimeout|setWaypointType|setWaypointVisible|setWeaponReloadingTime|setWind|setWindDir|setWindForce|setWindStr|setWingForceScaleRTD|setWPPos|show3DIcons|showChat|showCinemaBorder|showCommandingMenu|showCompass|showCuratorCompass|showGPS|showHUD|showLegend|showMap|shownArtilleryComputer|shownChat|shownCompass|shownCuratorCompass|showNewEditorObject|shownGPS|shownHUD|shownMap|shownPad|shownRadio|shownScoretable|shownUAVFeed|shownWarrant|shownWatch|showPad|showRadio|showScoretable|showSubtitles|showUAVFeed|showWarrant|showWatch|showWaypoint|showWaypoints|side|sideAmbientLife|sideChat|sideEmpty|sideEnemy|sideFriendly|sideLogic|sideRadio|sideUnknown|simpleTasks|simulationEnabled|simulCloudDensity|simulCloudOcclusion|simulInClouds|simulWeatherSync|sin|size|sizeOf|skill|skillFinal|skipTime|sleep|sliderPosition|sliderRange|sliderSetPosition|sliderSetRange|sliderSetSpeed|sliderSpeed|slingLoadAssistantShown|soldierMagazines|someAmmo|sort|soundVolume|speaker|speed|speedMode|splitString|sqrt|squadParams|stance|startLoadingScreen|stop|stopEngineRTD|stopped|str|sunOrMoon|supportInfo|suppressFor|surfaceIsWater|surfaceNormal|surfaceType|swimInDepth|switchableUnits|switchAction|switchCamera|switchGesture|switchLight|switchMove|synchronizedObjects|synchronizedTriggers|synchronizedWaypoints|synchronizeObjectsAdd|synchronizeObjectsRemove|synchronizeTrigger|synchronizeWaypoint|systemChat|systemOfUnits|tan|targetKnowledge|targets|targetsAggregate|targetsQuery|taskAlwaysVisible|taskChildren|taskCompleted|taskCustomData|taskDescription|taskDestination|taskHint|taskMarkerOffset|taskNull|taskParent|taskResult|taskState|taskType|teamMember|teamMemberNull|teamName|teams|teamSwitch|teamSwitchEnabled|teamType|terminate|terrainIntersect|terrainIntersectASL|terrainIntersectAtASL|text|textLog|textLogFormat|tg|time|timeMultiplier|titleCut|titleFadeOut|titleObj|titleRsc|titleText|toArray|toFixed|toLower|toString|toUpper|triggerActivated|triggerActivation|triggerArea|triggerAttachedVehicle|triggerAttachObject|triggerAttachVehicle|triggerDynamicSimulation|triggerStatements|triggerText|triggerTimeout|triggerTimeoutCurrent|triggerType|turretLocal|turretOwner|turretUnit|tvAdd|tvClear|tvCollapse|tvCollapseAll|tvCount|tvCurSel|tvData|tvDelete|tvExpand|tvExpandAll|tvPicture|tvPictureRight|tvSetColor|tvSetCurSel|tvSetData|tvSetPicture|tvSetPictureColor|tvSetPictureColorDisabled|tvSetPictureColorSelected|tvSetPictureRight|tvSetPictureRightColor|tvSetPictureRightColorDisabled|tvSetPictureRightColorSelected|tvSetSelectColor|tvSetText|tvSetTooltip|tvSetValue|tvSort|tvSortByValue|tvText|tvTooltip|tvValue|type|typeName|typeOf|UAVControl|uiNamespace|uiSleep|unassignCurator|unassignItem|unassignTeam|unassignVehicle|underwater|uniform|uniformContainer|uniformItems|uniformMagazines|unitAddons|unitAimPosition|unitAimPositionVisual|unitBackpack|unitIsUAV|unitPos|unitReady|unitRecoilCoefficient|units|unitsBelowHeight|unlinkItem|unlockAchievement|unregisterTask|updateDrawIcon|updateMenuItem|updateObjectTree|useAIOperMapObstructionTest|useAISteeringComponent|useAudioTimeForMoves|userInputDisabled|vectorAdd|vectorCos|vectorCrossProduct|vectorDiff|vectorDir|vectorDirVisual|vectorDistance|vectorDistanceSqr|vectorDotProduct|vectorFromTo|vectorMagnitude|vectorMagnitudeSqr|vectorModelToWorld|vectorModelToWorldVisual|vectorMultiply|vectorNormalized|vectorUp|vectorUpVisual|vectorWorldToModel|vectorWorldToModelVisual|vehicle|vehicleCargoEnabled|vehicleChat|vehicleRadio|vehicleReceiveRemoteTargets|vehicleReportOwnPosition|vehicleReportRemoteTargets|vehicles|vehicleVarName|velocity|velocityModelSpace|verifySignature|vest|vestContainer|vestItems|vestMagazines|viewDistance|visibleCompass|visibleGPS|visibleMap|visiblePosition|visiblePositionASL|visibleScoretable|visibleWatch|waitUntil|waves|waypointAttachedObject|waypointAttachedVehicle|waypointAttachObject|waypointAttachVehicle|waypointBehaviour|waypointCombatMode|waypointCompletionRadius|waypointDescription|waypointForceBehaviour|waypointFormation|waypointHousePosition|waypointLoiterRadius|waypointLoiterType|waypointName|waypointPosition|waypoints|waypointScript|waypointsEnabledUAV|waypointShow|waypointSpeed|waypointStatements|waypointTimeout|waypointTimeoutCurrent|waypointType|waypointVisible|weaponAccessories|weaponAccessoriesCargo|weaponCargo|weaponDirection|weaponInertia|weaponLowered|weapons|weaponsItems|weaponsItemsCargo|weaponState|weaponsTurret|weightRTD|west|WFSideText|wind|windDir|windRTD|windStr|wingsForcesRTD|worldName|worldSize|worldToModel|worldToModelVisual|worldToScreen)\b/i,number:/(?:\$|\b0x)[\da-f]+\b|(?:\B\.\d+|\b\d+(?:\.\d+)?)(?:e[+-]?\d+)?\b/i,operator:/##|>>|&&|\|\||[!=<>]=?|[-+*/%#^]|\b(?:and|mod|not|or)\b/i,"magic-variable":{pattern:/\b(?:this|thisList|thisTrigger|_exception|_fnc_scriptName|_fnc_scriptNameParent|_forEachIndex|_this|_thisEventHandler|_thisFSM|_thisScript|_x)\b/i,alias:"keyword"},constant:/\bDIK(?:_[a-z\d]+)+\b/i}),Prism.languages.insertBefore("sqf","string",{macro:{pattern:/(^[ \t]*)#[a-z](?:[^\r\n\\]|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{directive:{pattern:/#[a-z]+\b/i,alias:"keyword"},comment:Prism.languages.sqf.comment}}}),delete Prism.languages.sqf["class-name"];
./node_modules/.pnpm/prismjs@1.30.0/node_modules/prismjs/plugins/custom-class/prism-custom-class.js:	 * @param {ClassAdderEnvironment} env
./node_modules/.pnpm/prismjs@1.30.0/node_modules/prismjs/plugins/custom-class/prism-custom-class.js:	 * @typedef ClassAdderEnvironment
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-client.development.js:    function isConcurrentActEnvironment() {
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-client.development.js:      var isReactActEnvironmentGlobal =
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-client.development.js:      isReactActEnvironmentGlobal ||
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-client.development.js:      return isReactActEnvironmentGlobal;
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-client.development.js:      isConcurrentActEnvironment() &&
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-client.development.js:      isConcurrentActEnvironment() &&
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-profiling.development.js:    function isConcurrentActEnvironment() {
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-profiling.development.js:      var isReactActEnvironmentGlobal =
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-profiling.development.js:      isReactActEnvironmentGlobal ||
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-profiling.development.js:      return isReactActEnvironmentGlobal;
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-profiling.development.js:      isConcurrentActEnvironment() &&
./node_modules/.pnpm/react-dom@19.1.1_react@19.1.1/node_modules/react-dom/cjs/react-dom-profiling.development.js:      isConcurrentActEnvironment() &&
./node_modules/.pnpm/fast-equals@5.2.2/node_modules/fast-equals/config/webpack.config.js:    new webpack.EnvironmentPlugin(['NODE_ENV']),
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/BasicEnvironmentNode.js: * `BasicEnvironmentNode` is intended for non-PBR materials like {@link MeshBasicNodeMaterial}
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/BasicEnvironmentNode.js:class BasicEnvironmentNode extends LightingNode {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/BasicEnvironmentNode.js:		return 'BasicEnvironmentNode';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/BasicEnvironmentNode.js:export default BasicEnvironmentNode;
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/EnvironmentNode.js: * `EnvironmentNode` is intended for PBR materials like {@link MeshStandardNodeMaterial}.
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/EnvironmentNode.js:class EnvironmentNode extends LightingNode {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/EnvironmentNode.js:		return 'EnvironmentNode';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/lighting/EnvironmentNode.js:export default EnvironmentNode;
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/accessors/Normal.js:		// Use getUV context to avoid side effects from nodes overwriting getUV in the context (e.g. EnvironmentNode)
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/accessors/Normal.js:		// Use getUV context to avoid side effects from nodes overwriting getUV in the context (e.g. EnvironmentNode)
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/functions/BSDF/EnvironmentBRDF.js:const EnvironmentBRDF = /*@__PURE__*/ Fn( ( inputs ) => {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/functions/BSDF/EnvironmentBRDF.js:export default EnvironmentBRDF;
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/functions/BasicLightingModel.js: * diffuse color. Environment mapping is supported. Used in {@link MeshBasicNodeMaterial}.
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/functions/PhysicalLightingModel.js:import EnvironmentBRDF from './BSDF/EnvironmentBRDF.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/functions/PhysicalLightingModel.js:	const F = vec3( EnvironmentBRDF( { // n, v, specularColor, specularF90, roughness
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/functions/PhysicalLightingModel.js:			const clearcoatEnv = EnvironmentBRDF( {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/Nodes.js:export { default as EnvironmentNode } from './lighting/EnvironmentNode.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/nodes/Nodes.js:export { default as BasicEnvironmentNode } from './lighting/BasicEnvironmentNode.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/extras/PMREMGenerator.js: * This class generates a Prefiltered, Mipmapped Radiance Environment Map
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshBasicNodeMaterial.js:import BasicEnvironmentNode from '../../nodes/lighting/BasicEnvironmentNode.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshBasicNodeMaterial.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshBasicNodeMaterial.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshBasicNodeMaterial.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshBasicNodeMaterial.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshBasicNodeMaterial.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshLambertNodeMaterial.js:import BasicEnvironmentNode from '../../nodes/lighting/BasicEnvironmentNode.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshLambertNodeMaterial.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshLambertNodeMaterial.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshLambertNodeMaterial.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshLambertNodeMaterial.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshLambertNodeMaterial.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshPhongNodeMaterial.js:import BasicEnvironmentNode from '../../nodes/lighting/BasicEnvironmentNode.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshPhongNodeMaterial.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshPhongNodeMaterial.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshPhongNodeMaterial.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshPhongNodeMaterial.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshPhongNodeMaterial.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshStandardNodeMaterial.js:import EnvironmentNode from '../../nodes/lighting/EnvironmentNode.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshStandardNodeMaterial.js:	 * Overwritten since this type of material uses {@link EnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshStandardNodeMaterial.js:	 * @return {?EnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshStandardNodeMaterial.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshStandardNodeMaterial.js:		let envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/MeshStandardNodeMaterial.js:		return envNode ? new EnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/NodeMaterial.js:	setupEnvironment( /*builder*/ ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/materials/nodes/NodeMaterial.js:		const envNode = this.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/webgl/WebGLBackground.js:		const environmentBlendMode = renderer.xr.getEnvironmentBlendMode();
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/webxr/WebXRManager.js:		this.getEnvironmentBlendMode = function () {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/nodes/Nodes.js:				nodeBuilder.environmentNode = this.getEnvironmentNode( renderObject.scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/nodes/Nodes.js:	getEnvironmentNode( scene ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/nodes/Nodes.js:		this.updateEnvironment( scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/nodes/Nodes.js:			const environmentNode = this.getEnvironmentNode( scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/nodes/Nodes.js:	updateEnvironment( scene ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/extras/PMREMGenerator.js: * This class generates a Prefiltered, Mipmapped Radiance Environment Map
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/Background.js:		const environmentBlendMode = renderer.xr.getEnvironmentBlendMode();
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/common/XRManager.js:	getEnvironmentBlendMode() {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl.js:vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl.js:		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
./node_modules/.pnpm/three@0.180.0/node_modules/three/src/renderers/shaders/ShaderChunk/transmission_pars_fragment.glsl.js:		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.module.js:var lights_physical_pars_fragment = "struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}";
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.module.js:var transmission_pars_fragment = "#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif";
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.module.js:		const environmentBlendMode = renderer.xr.getEnvironmentBlendMode();
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.module.js: * This class generates a Prefiltered, Mipmapped Radiance Environment Map
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.module.js:		this.getEnvironmentBlendMode = function () {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.module.min.js:import{Matrix3 as e,Vector2 as t,Color as n,mergeUniforms as r,Vector3 as i,CubeUVReflectionMapping as a,Mesh as o,BoxGeometry as s,ShaderMaterial as l,BackSide as c,cloneUniforms as d,Euler as u,Matrix4 as f,ColorManagement as p,SRGBTransfer as m,PlaneGeometry as h,FrontSide as _,getUnlitUniformColorSpace as g,IntType as v,HalfFloatType as E,UnsignedByteType as S,FloatType as T,RGBAFormat as M,Plane as x,EquirectangularReflectionMapping as R,EquirectangularRefractionMapping as A,WebGLCubeRenderTarget as b,CubeReflectionMapping as C,CubeRefractionMapping as L,OrthographicCamera as P,PerspectiveCamera as U,NoToneMapping as D,MeshBasicMaterial as w,NoBlending as I,WebGLRenderTarget as y,BufferGeometry as N,BufferAttribute as O,LinearSRGBColorSpace as F,LinearFilter as B,warnOnce as H,Uint32BufferAttribute as G,Uint16BufferAttribute as V,arrayNeedsUint32 as z,Vector4 as k,DataArrayTexture as W,CubeTexture as X,Data3DTexture as Y,LessEqualCompare as K,DepthTexture as q,Texture as j,GLSL3 as Z,PCFShadowMap as $,PCFSoftShadowMap as Q,VSMShadowMap as J,CustomToneMapping as ee,NeutralToneMapping as te,AgXToneMapping as ne,ACESFilmicToneMapping as re,CineonToneMapping as ie,ReinhardToneMapping as ae,LinearToneMapping as oe,LinearTransfer as se,AddOperation as le,MixOperation as ce,MultiplyOperation as de,UniformsUtils as ue,DoubleSide as fe,NormalBlending as pe,TangentSpaceNormalMap as me,ObjectSpaceNormalMap as he,Layers as _e,Frustum as ge,MeshDepthMaterial as ve,RGBADepthPacking as Ee,MeshDistanceMaterial as Se,NearestFilter as Te,LessEqualDepth as Me,ReverseSubtractEquation as xe,SubtractEquation as Re,AddEquation as Ae,OneMinusConstantAlphaFactor as be,ConstantAlphaFactor as Ce,OneMinusConstantColorFactor as Le,ConstantColorFactor as Pe,OneMinusDstAlphaFactor as Ue,OneMinusDstColorFactor as De,OneMinusSrcAlphaFactor as we,OneMinusSrcColorFactor as Ie,DstAlphaFactor as ye,DstColorFactor as Ne,SrcAlphaSaturateFactor as Oe,SrcAlphaFactor as Fe,SrcColorFactor as Be,OneFactor as He,ZeroFactor as Ge,NotEqualDepth as Ve,GreaterDepth as ze,GreaterEqualDepth as ke,EqualDepth as We,LessDepth as Xe,AlwaysDepth as Ye,NeverDepth as Ke,CullFaceNone as qe,CullFaceBack as je,CullFaceFront as Ze,CustomBlending as $e,MultiplyBlending as Qe,SubtractiveBlending as Je,AdditiveBlending as et,MinEquation as tt,MaxEquation as nt,MirroredRepeatWrapping as rt,ClampToEdgeWrapping as it,RepeatWrapping as at,LinearMipmapLinearFilter as ot,LinearMipmapNearestFilter as st,NearestMipmapLinearFilter as lt,NearestMipmapNearestFilter as ct,NotEqualCompare as dt,GreaterCompare as ut,GreaterEqualCompare as ft,EqualCompare as pt,LessCompare as mt,AlwaysCompare as ht,NeverCompare as _t,NoColorSpace as gt,DepthStencilFormat as vt,getByteLength as Et,DepthFormat as St,UnsignedIntType as Tt,UnsignedInt248Type as Mt,UnsignedShortType as xt,createElementNS as Rt,UnsignedShort4444Type as At,UnsignedShort5551Type as bt,UnsignedInt5999Type as Ct,UnsignedInt101111Type as Lt,ByteType as Pt,ShortType as Ut,AlphaFormat as Dt,RGBFormat as wt,RedFormat as It,RedIntegerFormat as yt,RGFormat as Nt,RGIntegerFormat as Ot,RGBAIntegerFormat as Ft,RGB_S3TC_DXT1_Format as Bt,RGBA_S3TC_DXT1_Format as Ht,RGBA_S3TC_DXT3_Format as Gt,RGBA_S3TC_DXT5_Format as Vt,RGB_PVRTC_4BPPV1_Format as zt,RGB_PVRTC_2BPPV1_Format as kt,RGBA_PVRTC_4BPPV1_Format as Wt,RGBA_PVRTC_2BPPV1_Format as Xt,RGB_ETC1_Format as Yt,RGB_ETC2_Format as Kt,RGBA_ETC2_EAC_Format as qt,RGBA_ASTC_4x4_Format as jt,RGBA_ASTC_5x4_Format as Zt,RGBA_ASTC_5x5_Format as $t,RGBA_ASTC_6x5_Format as Qt,RGBA_ASTC_6x6_Format as Jt,RGBA_ASTC_8x5_Format as en,RGBA_ASTC_8x6_Format as tn,RGBA_ASTC_8x8_Format as nn,RGBA_ASTC_10x5_Format as rn,RGBA_ASTC_10x6_Format as an,RGBA_ASTC_10x8_Format as on,RGBA_ASTC_10x10_Format as sn,RGBA_ASTC_12x10_Format as ln,RGBA_ASTC_12x12_Format as cn,RGBA_BPTC_Format as dn,RGB_BPTC_SIGNED_Format as un,RGB_BPTC_UNSIGNED_Format as fn,RED_RGTC1_Format as pn,SIGNED_RED_RGTC1_Format as mn,RED_GREEN_RGTC2_Format as hn,SIGNED_RED_GREEN_RGTC2_Format as _n,ExternalTexture as gn,EventDispatcher as vn,ArrayCamera as En,WebXRController as Sn,RAD2DEG as Tn,createCanvasElement as Mn,SRGBColorSpace as xn,REVISION as Rn,WebGLCoordinateSystem as An,probeAsync as bn}from"./three.core.min.js";export{AdditiveAnimationBlendMode,AlwaysStencilFunc,AmbientLight,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BasicDepthPacking,BasicShadowMap,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxHelper,BufferGeometryLoader,Cache,Camera,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CircleGeometry,Clock,ColorKeyframeTrack,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,Controls,CubeCamera,CubeTextureLoader,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceFrontBack,Curve,CurvePath,CylinderGeometry,Cylindrical,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DetachedBindMode,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DodecahedronGeometry,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualStencilFunc,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,Fog,FogExp2,FramebufferTexture,FrustumArray,GLBufferAttribute,GLSL1,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group,HemisphereLight,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InterpolationSamplingMode,InterpolationSamplingType,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,MOUSE,Material,MaterialLoader,MathUtils,Matrix2,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NeverStencilFunc,NormalAnimationBlendMode,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,OctahedronGeometry,Path,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RGBDepthPacking,RGBIntegerFormat,RGDepthPacking,RawShaderMaterial,Ray,Raycaster,RectAreaLight,RenderTarget,RenderTarget3D,ReplaceStencilOp,RingGeometry,Scene,ShadowMaterial,Shape,ShapeGeometry,ShapePath,ShapeUtils,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,TOUCH,TetrahedronGeometry,TextureLoader,TextureUtils,Timer,TimestampQuery,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,UVMapping,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,VectorKeyframeTrack,VideoFrameTexture,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroSlopeEnding,ZeroStencilOp}from"./three.core.min.js";function Cn(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Ln(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,a=r.byteLength,o=e.createBuffer();let s;if(e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)s=e.FLOAT;else if("undefined"!=typeof Float16Array&&r instanceof Float16Array)s=e.HALF_FLOAT;else if(r instanceof Uint16Array)s=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)s=e.SHORT;else if(r instanceof Uint32Array)s=e.UNSIGNED_INT;else if(r instanceof Int32Array)s=e.INT;else if(r instanceof Int8Array)s=e.BYTE;else if(r instanceof Uint8Array)s=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);s=e.UNSIGNED_BYTE}return{buffer:o,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:a}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,a=n.updateRanges;if(e.bindBuffer(r,t),0===a.length)e.bufferSubData(r,0,i);else{a.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<a.length;e++){const n=a[t],r=a[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,a[t]=r)}a.length=t+1;for(let t=0,n=a.length;t<n;t++){const n=a[t];e.bufferSubData(r,n.start*i.BYTES_PER_ELEMENT,i,n.start,n.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}const Pn={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth = unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\tfloat hard_shadow = step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow = step( compare, distribution.x );\n\t\t#endif\n\t\tif ( hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Un={common:{diffuse:{value:new n(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new e},alphaMap:{value:null},alphaMapTransform:{value:new e},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new e}},envmap:{envMap:{value:null},envMapRotation:{value:new e},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new e}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new e}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new e},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new e},normalScale:{value:new t(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new e},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new e}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new e}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new e}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new n(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new n(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new e},alphaTest:{value:0},uvTransform:{value:new e}},sprite:{diffuse:{value:new n(16777215)},opacity:{value:1},center:{value:new t(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new e},alphaMap:{value:null},alphaMapTransform:{value:new e},alphaTest:{value:0}}},Dn={basic:{uniforms:r([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.fog]),vertexShader:Pn.meshbasic_vert,fragmentShader:Pn.meshbasic_frag},lambert:{uniforms:r([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new n(0)}}]),vertexShader:Pn.meshlambert_vert,fragmentShader:Pn.meshlambert_frag},phong:{uniforms:r([Un.common,Un.specularmap,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,Un.lights,{emissive:{value:new n(0)},specular:{value:new n(1118481)},shininess:{value:30}}]),vertexShader:Pn.meshphong_vert,fragmentShader:Pn.meshphong_frag},standard:{uniforms:r([Un.common,Un.envmap,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.roughnessmap,Un.metalnessmap,Un.fog,Un.lights,{emissive:{value:new n(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag},toon:{uniforms:r([Un.common,Un.aomap,Un.lightmap,Un.emissivemap,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.gradientmap,Un.fog,Un.lights,{emissive:{value:new n(0)}}]),vertexShader:Pn.meshtoon_vert,fragmentShader:Pn.meshtoon_frag},matcap:{uniforms:r([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,Un.fog,{matcap:{value:null}}]),vertexShader:Pn.meshmatcap_vert,fragmentShader:Pn.meshmatcap_frag},points:{uniforms:r([Un.points,Un.fog]),vertexShader:Pn.points_vert,fragmentShader:Pn.points_frag},dashed:{uniforms:r([Un.common,Un.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pn.linedashed_vert,fragmentShader:Pn.linedashed_frag},depth:{uniforms:r([Un.common,Un.displacementmap]),vertexShader:Pn.depth_vert,fragmentShader:Pn.depth_frag},normal:{uniforms:r([Un.common,Un.bumpmap,Un.normalmap,Un.displacementmap,{opacity:{value:1}}]),vertexShader:Pn.meshnormal_vert,fragmentShader:Pn.meshnormal_frag},sprite:{uniforms:r([Un.sprite,Un.fog]),vertexShader:Pn.sprite_vert,fragmentShader:Pn.sprite_frag},background:{uniforms:{uvTransform:{value:new e},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pn.background_vert,fragmentShader:Pn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new e}},vertexShader:Pn.backgroundCube_vert,fragmentShader:Pn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pn.cube_vert,fragmentShader:Pn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pn.equirect_vert,fragmentShader:Pn.equirect_frag},distanceRGBA:{uniforms:r([Un.common,Un.displacementmap,{referencePosition:{value:new i},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pn.distanceRGBA_vert,fragmentShader:Pn.distanceRGBA_frag},shadow:{uniforms:r([Un.lights,Un.fog,{color:{value:new n(0)},opacity:{value:1}}]),vertexShader:Pn.shadow_vert,fragmentShader:Pn.shadow_frag}};Dn.physical={uniforms:r([Dn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new e},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new e},clearcoatNormalScale:{value:new t(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new e},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new e},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new e},sheen:{value:0},sheenColor:{value:new n(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new e},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new e},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new e},transmissionSamplerSize:{value:new t},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new e},attenuationDistance:{value:0},attenuationColor:{value:new n(0)},specularColor:{value:new n(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new e},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new e},anisotropyVector:{value:new t},anisotropyMap:{value:null},anisotropyMapTransform:{value:new e}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag};const wn={r:0,b:0,g:0},In=new u,yn=new f;function Nn(e,t,r,i,u,f,v){const E=new n(0);let S,T,M=!0===f?0:1,x=null,R=0,A=null;function b(e){let n=!0===e.isScene?e.background:null;if(n&&n.isTexture){n=(e.backgroundBlurriness>0?r:t).get(n)}return n}function C(t,n){t.getRGB(wn,g(e)),i.buffers.color.setClear(wn.r,wn.g,wn.b,n,v)}return{getClearColor:function(){return E},setClearColor:function(e,t=1){E.set(e),M=t,C(E,M)},getClearAlpha:function(){return M},setClearAlpha:function(e){M=e,C(E,M)},render:function(t){let n=!1;const r=b(t);null===r?C(E,M):r&&r.isColor&&(C(r,1),n=!0);const a=e.xr.getEnvironmentBlendMode();"additive"===a?i.buffers.color.setClear(0,0,0,1,v):"alpha-blend"===a&&i.buffers.color.setClear(0,0,0,0,v),(e.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const r=b(n);r&&(r.isCubeTexture||r.mapping===a)?(void 0===T&&(T=new o(new s(1,1,1),new l({name:"BackgroundCubeMaterial",uniforms:d(Dn.backgroundCube.uniforms),vertexShader:Dn.backgroundCube.vertexShader,fragmentShader:Dn.backgroundCube.fragmentShader,side:c,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),T.geometry.deleteAttribute("normal"),T.geometry.deleteAttribute("uv"),T.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(T.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),u.update(T)),In.copy(n.backgroundRotation),In.x*=-1,In.y*=-1,In.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(In.y*=-1,In.z*=-1),T.material.uniforms.envMap.value=r,T.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,T.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,T.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,T.material.uniforms.backgroundRotation.value.setFromMatrix4(yn.makeRotationFromEuler(In)),T.material.toneMapped=p.getTransfer(r.colorSpace)!==m,x===r&&R===r.version&&A===e.toneMapping||(T.material.needsUpdate=!0,x=r,R=r.version,A=e.toneMapping),T.layers.enableAll(),t.unshift(T,T.geometry,T.material,0,0,null)):r&&r.isTexture&&(void 0===S&&(S=new o(new h(2,2),new l({name:"BackgroundMaterial",uniforms:d(Dn.background.uniforms),vertexShader:Dn.background.vertexShader,fragmentShader:Dn.background.fragmentShader,side:_,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),S.geometry.deleteAttribute("normal"),Object.defineProperty(S.material,"map",{get:function(){return this.uniforms.t2D.value}}),u.update(S)),S.material.uniforms.t2D.value=r,S.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,S.material.toneMapped=p.getTransfer(r.colorSpace)!==m,!0===r.matrixAutoUpdate&&r.updateMatrix(),S.material.uniforms.uvTransform.value.copy(r.matrix),x===r&&R===r.version&&A===e.toneMapping||(S.material.needsUpdate=!0,x=r,R=r.version,A=e.toneMapping),S.layers.enableAll(),t.unshift(S,S.geometry,S.material,0,0,null))},dispose:function(){void 0!==T&&(T.geometry.dispose(),T.material.dispose(),T=void 0),void 0!==S&&(S.geometry.dispose(),S.material.dispose(),S=void 0)}}}function On(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=c(null);let a=i,o=!1;function s(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],r=[],i=[];for(let e=0;e<n;e++)t[e]=0,r[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function d(){const e=a.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function u(e){f(e,0)}function f(t,n){const r=a.newAttributes,i=a.enabledAttributes,o=a.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),o[t]!==n&&(e.vertexAttribDivisor(t,n),o[t]=n)}function p(){const t=a.newAttributes,n=a.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function m(t,n,r,i,a,o,s){!0===s?e.vertexAttribIPointer(t,n,r,a,o):e.vertexAttribPointer(t,n,r,i,a,o)}function h(){_(),o=!0,a!==i&&(a=i,s(a.object))}function _(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,l,h,_){let g=!1;const E=function(t,n,i){const a=!0===i.wireframe;let o=r[t.id];void 0===o&&(o={},r[t.id]=o);let s=o[n.id];void 0===s&&(s={},o[n.id]=s);let l=s[a];void 0===l&&(l=c(e.createVertexArray()),s[a]=l);return l}(h,l,i);a!==E&&(a=E,s(a.object)),g=function(e,t,n,r){const i=a.attributes,o=t.attributes;let s=0;const l=n.getAttributes();for(const t in l){if(l[t].location>=0){const n=i[t];let r=o[t];if(void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor)),void 0===n)return!0;if(n.attribute!==r)return!0;if(r&&n.data!==r.data)return!0;s++}}return a.attributesNum!==s||a.index!==r}(n,h,l,_),g&&function(e,t,n,r){const i={},o=t.attributes;let s=0;const l=n.getAttributes();for(const t in l){if(l[t].location>=0){let n=o[t];void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor));const r={};r.attribute=n,n&&n.data&&(r.data=n.data),i[t]=r,s++}}a.attributes=i,a.attributesNum=s,a.index=r}(n,h,l,_),null!==_&&t.update(_,e.ELEMENT_ARRAY_BUFFER),(g||o)&&(o=!1,function(n,r,i,a){d();const o=a.attributes,s=i.getAttributes(),l=r.defaultAttributeValues;for(const r in s){const i=s[r];if(i.location>=0){let s=o[r];if(void 0===s&&("instanceMatrix"===r&&n.instanceMatrix&&(s=n.instanceMatrix),"instanceColor"===r&&n.instanceColor&&(s=n.instanceColor)),void 0!==s){const r=s.normalized,o=s.itemSize,l=t.get(s);if(void 0===l)continue;const c=l.buffer,d=l.type,p=l.bytesPerElement,h=d===e.INT||d===e.UNSIGNED_INT||s.gpuType===v;if(s.isInterleavedBufferAttribute){const t=s.data,l=t.stride,_=s.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)f(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)u(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)m(i.location+e,o/i.locationSize,d,r,l*p,(_+o/i.locationSize*e)*p,h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)f(i.location+e,s.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<i.locationSize;e++)u(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)m(i.location+e,o/i.locationSize,d,r,o*p,o/i.locationSize*e*p,h)}}else if(void 0!==l){const t=l[r];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}p()}(n,i,l,h),null!==_&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(_).buffer))},reset:h,resetDefaultState:_,dispose:function(){h();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)l(i[e].object),delete i[e];delete n[e.id]}},initAttributes:d,enableAttribute:u,disableUnusedAttributes:p}}function Fn(e,t,n){let r;function i(t,i,a){0!==a&&(e.drawArraysInstanced(r,t,i,a),n.update(i,r,a))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,a);let o=0;for(let e=0;e<a;e++)o+=i[e];n.update(o,r,1)},this.renderMultiDrawInstances=function(e,a,o,s){if(0===o)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],a[t],s[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,a,0,s,0,o);let t=0;for(let e=0;e<o;e++)t+=a[e]*s[e];n.update(t,r,1)}}}function Bn(e,t,n,r){let i;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=void 0!==n.precision?n.precision:"highp";const s=a(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reversedDepthBuffer&&t.has("EXT_clip_control"),d=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:a,textureFormatReadable:function(t){return t===M||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===E&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==S&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==T&&!i)},precision:o,logarithmicDepthBuffer:l,reversedDepthBuffer:c,maxTextures:d,maxVertexTextures:u,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:u>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function Hn(t){const n=this;let r=null,i=0,a=!1,o=!1;const s=new x,l=new e,c={value:null,needsUpdate:!1};function d(e,t,r,i){const a=null!==e?e.length:0;let o=null;if(0!==a){if(o=c.value,!0!==i||null===o){const n=r+4*a,i=t.matrixWorldInverse;l.getNormalMatrix(i),(null===o||o.length<n)&&(o=new Float32Array(n));for(let t=0,n=r;t!==a;++t,n+=4)s.copy(e[t]).applyMatrix4(i,l),s.normal.toArray(o,n),o[n+3]=s.constant}c.value=o,c.needsUpdate=!0}return n.numPlanes=a,n.numIntersection=0,o}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==i||a;return a=t,i=e.length,n},this.beginShadows=function(){o=!0,d(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(e,t){r=d(e,t,0)},this.setState=function(e,s,l){const u=e.clippingPlanes,f=e.clipIntersection,p=e.clipShadows,m=t.get(e);if(!a||null===u||0===u.length||o&&!p)o?d(null):function(){c.value!==r&&(c.value=r,c.needsUpdate=i>0);n.numPlanes=i,n.numIntersection=0}();else{const e=o?0:i,t=4*e;let n=m.clippingState||null;c.value=n,n=d(u,s,t,l);for(let e=0;e!==t;++e)n[e]=r[e];m.clippingState=n,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=e}}}function Gn(e){let t=new WeakMap;function n(e,t){return t===R?e.mapping=C:t===A&&(e.mapping=L),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping;if(a===R||a===A){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const a=i.image;if(a&&a.height>0){const o=new b(a.height);return o.fromEquirectangularTexture(e,i),t.set(i,o),i.addEventListener("dispose",r),n(o.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}const Vn=[.125,.215,.35,.446,.526,.582],zn=20,kn=new P,Wn=new n;let Xn=null,Yn=0,Kn=0,qn=!1;const jn=(1+Math.sqrt(5))/2,Zn=1/jn,$n=[new i(-jn,Zn,0),new i(jn,Zn,0),new i(-Zn,0,jn),new i(Zn,0,jn),new i(0,jn,-Zn),new i(0,jn,Zn),new i(-1,1,-1),new i(1,1,-1),new i(-1,1,1),new i(1,1,1)],Qn=new i;class Jn{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100,i={}){const{size:a=256,position:o=Qn}=i;Xn=this._renderer.getRenderTarget(),Yn=this._renderer.getActiveCubeFace(),Kn=this._renderer.getActiveMipmapLevel(),qn=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s,o),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=rr(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=nr(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Xn,Yn,Kn),this._renderer.xr.enabled=qn,e.scissorTest=!1,tr(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===C||e.mapping===L?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Xn=this._renderer.getRenderTarget(),Yn=this._renderer.getActiveCubeFace(),Kn=this._renderer.getActiveMipmapLevel(),qn=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:B,minFilter:B,generateMipmaps:!1,type:E,format:M,colorSpace:F,depthBuffer:!1},r=er(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=er(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const a=e-4+1+Vn.length;for(let o=0;o<a;o++){const a=Math.pow(2,i);n.push(a);let s=1/a;o>e-4?s=Vn[o-e+4-1]:0===o&&(s=0),r.push(s);const l=1/(a-2),c=-l,d=1+l,u=[c,c,d,c,d,d,c,c,d,d,c,d],f=6,p=6,m=3,h=2,_=1,g=new Float32Array(m*p*f),v=new Float32Array(h*p*f),E=new Float32Array(_*p*f);for(let e=0;e<f;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];g.set(r,m*p*e),v.set(u,h*p*e);const i=[e,e,e,e,e,e];E.set(i,_*p*e)}const S=new N;S.setAttribute("position",new O(g,m)),S.setAttribute("uv",new O(v,h)),S.setAttribute("faceIndex",new O(E,_)),t.push(S),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(zn),a=new i(0,1,0),o=new l({name:"SphericalGaussianBlur",defines:{n:zn,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:ir(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:I,depthTest:!1,depthWrite:!1});return o}(r,e,t)}return r}_compileMaterial(e){const t=new o(this._lodPlanes[0],e);this._renderer.compile(t,kn)}_sceneToCubeUV(e,t,n,r,i){const a=new U(90,1,t,n),l=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],u=this._renderer,f=u.autoClear,p=u.toneMapping;u.getClearColor(Wn),u.toneMapping=D,u.autoClear=!1;u.state.buffers.depth.getReversed()&&(u.setRenderTarget(r),u.clearDepth(),u.setRenderTarget(null));const m=new w({name:"PMREM.Background",side:c,depthWrite:!1,depthTest:!1}),h=new o(new s,m);let _=!1;const g=e.background;g?g.isColor&&(m.color.copy(g),e.background=null,_=!0):(m.color.copy(Wn),_=!0);for(let t=0;t<6;t++){const n=t%3;0===n?(a.up.set(0,l[t],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+d[t],i.y,i.z)):1===n?(a.up.set(0,0,l[t]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+d[t],i.z)):(a.up.set(0,l[t],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+d[t]));const o=this._cubeSize;tr(r,n*o,t>2?o:0,o,o),u.setRenderTarget(r),_&&u.render(h,a),u.render(e,a)}h.geometry.dispose(),h.material.dispose(),u.toneMapping=p,u.autoClear=f,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===C||e.mapping===L;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=rr()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=nr());const i=r?this._cubemapMaterial:this._equirectMaterial,a=new o(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const s=this._cubeSize;tr(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(a,kn)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let t=1;t<r;t++){const n=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=$n[(r-t-1)%$n.length];this._blur(e,t-1,t,n,i)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,s){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new o(this._lodPlanes[r],c),u=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(i)?Math.PI/(2*f):2*Math.PI/39,m=i/p,h=isFinite(i)?1+Math.floor(3*m):zn;h>zn&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${h} samples when the maximum is set to 20`);const _=[];let g=0;for(let e=0;e<zn;++e){const t=e/m,n=Math.exp(-t*t/2);_.push(n),0===e?g+=n:e<h&&(g+=2*n)}for(let e=0;e<_.length;e++)_[e]=_[e]/g;u.envMap.value=e.texture,u.samples.value=h,u.weights.value=_,u.latitudinal.value="latitudinal"===a,s&&(u.poleAxis.value=s);const{_lodMax:v}=this;u.dTheta.value=p,u.mipInt.value=v-n;const E=this._sizeLods[r];tr(t,3*E*(r>v-4?r-v+4:0),4*(this._cubeSize-E),3*E,2*E),l.setRenderTarget(t),l.render(d,kn)}}function er(e,t,n){const r=new y(e,t,n);return r.texture.mapping=a,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function tr(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function nr(){return new l({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ir(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:I,depthTest:!1,depthWrite:!1})}function rr(){return new l({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ir(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:I,depthTest:!1,depthWrite:!1})}function ir(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function ar(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping,o=a===R||a===A,s=a===C||a===L;if(o||s){let a=t.get(i);const l=void 0!==a?a.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new Jn(e)),a=o?n.fromEquirectangular(i,a):n.fromCubemap(i,a),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),a.texture;if(void 0!==a)return a.texture;{const l=i.image;return o&&l&&l.height>0||s&&l&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(l)?(null===n&&(n=new Jn(e)),a=o?n.fromEquirectangular(i):n.fromCubemap(i),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),i.addEventListener("dispose",r),a.texture):null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function or(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&H("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function sr(e,t,n,r){const i={},a=new WeakMap;function o(e){const s=e.target;null!==s.index&&t.remove(s.index);for(const e in s.attributes)t.remove(s.attributes[e]);s.removeEventListener("dispose",o),delete i[s.id];const l=a.get(s);l&&(t.remove(l),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){const n=[],r=e.index,i=e.attributes.position;let o=0;if(null!==r){const e=r.array;o=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{if(void 0===i)return;{const e=i.array;o=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const s=new(z(n)?G:V)(n,1);s.version=o;const l=a.get(e);l&&t.remove(l),a.set(e,s)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const n in r)t.update(r[n],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function lr(e,t,n){let r,i,a;function o(t,o,s){0!==s&&(e.drawElementsInstanced(r,o,i,t*a,s),n.update(o,r,s))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,o){e.drawElements(r,o,i,t*a),n.update(o,r,1)},this.renderInstances=o,this.renderMultiDraw=function(e,a,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,a,0,i,e,0,o);let s=0;for(let e=0;e<o;e++)s+=a[e];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,s,l,c){if(0===l)return;const d=t.get("WEBGL_multi_draw");if(null===d)for(let t=0;t<e.length;t++)o(e[t]/a,s[t],c[t]);else{d.multiDrawElementsInstancedWEBGL(r,s,0,i,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=s[e]*c[e];n.update(t,r,1)}}}function cr(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function dr(e,n,r){const i=new WeakMap,a=new k;return{update:function(o,s,l){const c=o.morphTargetInfluences,d=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,u=void 0!==d?d.length:0;let f=i.get(s);if(void 0===f||f.count!==u){void 0!==f&&f.texture.dispose();const p=void 0!==s.morphAttributes.position,m=void 0!==s.morphAttributes.normal,h=void 0!==s.morphAttributes.color,_=s.morphAttributes.position||[],g=s.morphAttributes.normal||[],v=s.morphAttributes.color||[];let E=0;!0===p&&(E=1),!0===m&&(E=2),!0===h&&(E=3);let S=s.attributes.position.count*E,M=1;S>n.maxTextureSize&&(M=Math.ceil(S/n.maxTextureSize),S=n.maxTextureSize);const x=new Float32Array(S*M*4*u),R=new W(x,S,M,u);R.type=T,R.needsUpdate=!0;const A=4*E;for(let C=0;C<u;C++){const L=_[C],P=g[C],U=v[C],D=S*M*4*C;for(let w=0;w<L.count;w++){const I=w*A;!0===p&&(a.fromBufferAttribute(L,w),x[D+I+0]=a.x,x[D+I+1]=a.y,x[D+I+2]=a.z,x[D+I+3]=0),!0===m&&(a.fromBufferAttribute(P,w),x[D+I+4]=a.x,x[D+I+5]=a.y,x[D+I+6]=a.z,x[D+I+7]=0),!0===h&&(a.fromBufferAttribute(U,w),x[D+I+8]=a.x,x[D+I+9]=a.y,x[D+I+10]=a.z,x[D+I+11]=4===U.itemSize?a.w:1)}}function b(){R.dispose(),i.delete(s),s.removeEventListener("dispose",b)}f={count:u,texture:R,size:new t(S,M)},i.set(s,f),s.addEventListener("dispose",b)}if(!0===o.isInstancedMesh&&null!==o.morphTexture)l.getUniforms().setValue(e,"morphTexture",o.morphTexture,r);else{let y=0;for(let O=0;O<c.length;O++)y+=c[O];const N=s.morphTargetsRelative?1:1-y;l.getUniforms().setValue(e,"morphTargetBaseInfluence",N),l.getUniforms().setValue(e,"morphTargetInfluences",c)}l.getUniforms().setValue(e,"morphTargetsTexture",f.texture,r),l.getUniforms().setValue(e,"morphTargetsTextureSize",f.size)}}}function ur(e,t,n,r){let i=new WeakMap;function a(e){const t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){const s=r.render.frame,l=o.geometry,c=t.get(o,l);if(i.get(c)!==s&&(t.update(c),i.set(c,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){const e=o.skeleton;i.get(e)!==s&&(e.update(),i.set(e,s))}return c},dispose:function(){i=new WeakMap}}}const fr=new j,pr=new q(1,1),mr=new W,hr=new Y,_r=new X,gr=[],vr=[],Er=new Float32Array(16),Sr=new Float32Array(9),Tr=new Float32Array(4);function Mr(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=gr[i];if(void 0===a&&(a=new Float32Array(i),gr[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function xr(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Rr(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function Ar(e,t){let n=vr[t];void 0===n&&(n=new Int32Array(t),vr[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function br(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Cr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(xr(n,t))return;e.uniform2fv(this.addr,t),Rr(n,t)}}function Lr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(xr(n,t))return;e.uniform3fv(this.addr,t),Rr(n,t)}}function Pr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(xr(n,t))return;e.uniform4fv(this.addr,t),Rr(n,t)}}function Ur(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(xr(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Rr(n,t)}else{if(xr(n,r))return;Tr.set(r),e.uniformMatrix2fv(this.addr,!1,Tr),Rr(n,r)}}function Dr(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(xr(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Rr(n,t)}else{if(xr(n,r))return;Sr.set(r),e.uniformMatrix3fv(this.addr,!1,Sr),Rr(n,r)}}function wr(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(xr(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Rr(n,t)}else{if(xr(n,r))return;Er.set(r),e.uniformMatrix4fv(this.addr,!1,Er),Rr(n,r)}}function Ir(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function yr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(xr(n,t))return;e.uniform2iv(this.addr,t),Rr(n,t)}}function Nr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(xr(n,t))return;e.uniform3iv(this.addr,t),Rr(n,t)}}function Or(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(xr(n,t))return;e.uniform4iv(this.addr,t),Rr(n,t)}}function Fr(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Br(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(xr(n,t))return;e.uniform2uiv(this.addr,t),Rr(n,t)}}function Hr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(xr(n,t))return;e.uniform3uiv(this.addr,t),Rr(n,t)}}function Gr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(xr(n,t))return;e.uniform4uiv(this.addr,t),Rr(n,t)}}function Vr(e,t,n){const r=this.cache,i=n.allocateTextureUnit();let a;r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),this.type===e.SAMPLER_2D_SHADOW?(pr.compareFunction=K,a=pr):a=fr,n.setTexture2D(t||a,i)}function zr(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||hr,i)}function kr(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||_r,i)}function Wr(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||mr,i)}function Xr(e,t){e.uniform1fv(this.addr,t)}function Yr(e,t){const n=Mr(t,this.size,2);e.uniform2fv(this.addr,n)}function Kr(e,t){const n=Mr(t,this.size,3);e.uniform3fv(this.addr,n)}function qr(e,t){const n=Mr(t,this.size,4);e.uniform4fv(this.addr,n)}function jr(e,t){const n=Mr(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Zr(e,t){const n=Mr(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function $r(e,t){const n=Mr(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Qr(e,t){e.uniform1iv(this.addr,t)}function Jr(e,t){e.uniform2iv(this.addr,t)}function ei(e,t){e.uniform3iv(this.addr,t)}function ti(e,t){e.uniform4iv(this.addr,t)}function ni(e,t){e.uniform1uiv(this.addr,t)}function ri(e,t){e.uniform2uiv(this.addr,t)}function ii(e,t){e.uniform3uiv(this.addr,t)}function ai(e,t){e.uniform4uiv(this.addr,t)}function oi(e,t,n){const r=this.cache,i=t.length,a=Ar(n,i);xr(r,a)||(e.uniform1iv(this.addr,a),Rr(r,a));for(let e=0;e!==i;++e)n.setTexture2D(t[e]||fr,a[e])}function si(e,t,n){const r=this.cache,i=t.length,a=Ar(n,i);xr(r,a)||(e.uniform1iv(this.addr,a),Rr(r,a));for(let e=0;e!==i;++e)n.setTexture3D(t[e]||hr,a[e])}function li(e,t,n){const r=this.cache,i=t.length,a=Ar(n,i);xr(r,a)||(e.uniform1iv(this.addr,a),Rr(r,a));for(let e=0;e!==i;++e)n.setTextureCube(t[e]||_r,a[e])}function ci(e,t,n){const r=this.cache,i=t.length,a=Ar(n,i);xr(r,a)||(e.uniform1iv(this.addr,a),Rr(r,a));for(let e=0;e!==i;++e)n.setTexture2DArray(t[e]||mr,a[e])}class di{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return br;case 35664:return Cr;case 35665:return Lr;case 35666:return Pr;case 35674:return Ur;case 35675:return Dr;case 35676:return wr;case 5124:case 35670:return Ir;case 35667:case 35671:return yr;case 35668:case 35672:return Nr;case 35669:case 35673:return Or;case 5125:return Fr;case 36294:return Br;case 36295:return Hr;case 36296:return Gr;case 35678:case 36198:case 36298:case 36306:case 35682:return Vr;case 35679:case 36299:case 36307:return zr;case 35680:case 36300:case 36308:case 36293:return kr;case 36289:case 36303:case 36311:case 36292:return Wr}}(t.type)}}class ui{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Xr;case 35664:return Yr;case 35665:return Kr;case 35666:return qr;case 35674:return jr;case 35675:return Zr;case 35676:return $r;case 5124:case 35670:return Qr;case 35667:case 35671:return Jr;case 35668:case 35672:return ei;case 35669:case 35673:return ti;case 5125:return ni;case 36294:return ri;case 36295:return ii;case 36296:return ai;case 35678:case 36198:case 36298:case 36306:case 35682:return oi;case 35679:case 36299:case 36307:return si;case 35680:case 36300:case 36308:case 36293:return li;case 36289:case 36303:case 36311:case 36292:return ci}}(t.type)}}class fi{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}}}const pi=/(\w+)(\])?(\[|\.)?/g;function mi(e,t){e.seq.push(t),e.map[t.id]=t}function hi(e,t,n){const r=e.name,i=r.length;for(pi.lastIndex=0;;){const a=pi.exec(r),o=pi.lastIndex;let s=a[1];const l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===i){mi(n,void 0===c?new di(s,e,t):new ui(s,e,t));break}{let e=n.map[s];void 0===e&&(e=new fi(s),mi(n,e)),n=e}}}class _i{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);hi(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],o=n[a.id];!1!==o.needsUpdate&&a.setValue(e,o.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function gi(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let vi=0;const Ei=new e;function Si(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(r&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let e=i;e<a;e++){const i=e+1;r.push(`${i===t?">":" "} ${i}: ${n[e]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return i}function Ti(e,t){const n=function(e){p._getMatrix(Ei,p.workingColorSpace,e);const t=`mat3( ${Ei.elements.map(e=>e.toFixed(4))} )`;switch(p.getTransfer(e)){case se:return[t,"LinearTransferOETF"];case m:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function Mi(e,t){let n;switch(t){case oe:n="Linear";break;case ae:n="Reinhard";break;case ie:n="Cineon";break;case re:n="ACESFilmic";break;case ne:n="AgX";break;case te:n="Neutral";break;case ee:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const xi=new i;function Ri(){p.getLuminanceCoefficients(xi);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${xi.x.toFixed(4)}, ${xi.y.toFixed(4)}, ${xi.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function Ai(e){return""!==e}function bi(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Ci(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const Li=/^[ \t]*#include +<([\w\d./]+)>/gm;function Pi(e){return e.replace(Li,Di)}const Ui=new Map;function Di(e,t){let n=Pn[t];if(void 0===n){const e=Ui.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=Pn[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return Pi(n)}const wi=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ii(e){return e.replace(wi,yi)}function yi(e,t,n,r){let i="";for(let e=parseInt(t);e<parseInt(n);e++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function Ni(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Oi(e,t,n,r){const i=e.getContext(),o=n.defines;let s=n.vertexShader,l=n.fragmentShader;const c=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===$?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===Q?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===J&&(t="SHADOWMAP_TYPE_VSM"),t}(n),d=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case C:case L:t="ENVMAP_TYPE_CUBE";break;case a:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===L&&(t="ENVMAP_MODE_REFRACTION");return t}(n),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case de:t="ENVMAP_BLENDING_MULTIPLY";break;case ce:t="ENVMAP_BLENDING_MIX";break;case le:t="ENVMAP_BLENDING_ADD"}return t}(n),p=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),m=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Ai).join("\n")}(n),h=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(o),_=i.createProgram();let g,v,E=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,h].filter(Ai).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,h].filter(Ai).join("\n"),v.length>0&&(v+="\n")):(g=[Ni(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,h,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ai).join("\n"),v=[Ni(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,h,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.envMap?"#define "+u:"",n.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==D?"#define TONE_MAPPING":"",n.toneMapping!==D?Pn.tonemapping_pars_fragment:"",n.toneMapping!==D?Mi("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Pn.colorspace_pars_fragment,Ti("linearToOutputTexel",n.outputColorSpace),Ri(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ai).join("\n")),s=Pi(s),s=bi(s,n),s=Ci(s,n),l=Pi(l),l=bi(l,n),l=Ci(l,n),s=Ii(s),l=Ii(l),!0!==n.isRawShaderMaterial&&(E="#version 300 es\n",g=[m,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===Z?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Z?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const S=E+g+s,T=E+v+l,M=gi(i,i.VERTEX_SHADER,S),x=gi(i,i.FRAGMENT_SHADER,T);function R(t){if(e.debug.checkShaderErrors){const n=i.getProgramInfoLog(_)||"",r=i.getShaderInfoLog(M)||"",a=i.getShaderInfoLog(x)||"",o=n.trim(),s=r.trim(),l=a.trim();let c=!0,d=!0;if(!1===i.getProgramParameter(_,i.LINK_STATUS))if(c=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(i,_,M,x);else{const e=Si(i,M,"vertex"),n=Si(i,x,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+o+"\n"+e+"\n"+n)}else""!==o?console.warn("THREE.WebGLProgram: Program Info Log:",o):""!==s&&""!==l||(d=!1);d&&(t.diagnostics={runnable:c,programLog:o,vertexShader:{log:s,prefix:g},fragmentShader:{log:l,prefix:v}})}i.deleteShader(M),i.deleteShader(x),A=new _i(i,_),b=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),a=r.name;let o=1;r.type===e.FLOAT_MAT2&&(o=2),r.type===e.FLOAT_MAT3&&(o=3),r.type===e.FLOAT_MAT4&&(o=4),n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:o}}return n}(i,_)}let A,b;i.attachShader(_,M),i.attachShader(_,x),void 0!==n.index0AttributeName?i.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_),this.getUniforms=function(){return void 0===A&&R(this),A},this.getAttributes=function(){return void 0===b&&R(this),b};let P=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===P&&(P=i.getProgramParameter(_,37297)),P},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=vi++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=M,this.fragmentShader=x,this}let Fi=0;class Bi{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new Hi(e),t.set(e,n)),n}}class Hi{constructor(e){this.id=Fi++,this.code=e,this.usedTimes=0}}function Gi(e,t,n,r,i,o,s){const l=new _e,d=new Bi,u=new Set,f=[],h=i.logarithmicDepthBuffer,_=i.vertexTextures;let g=i.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(e){return u.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(o,l,f,S,T){const M=S.fog,x=T.geometry,R=o.isMeshStandardMaterial?S.environment:null,A=(o.isMeshStandardMaterial?n:t).get(o.envMap||R),b=A&&A.mapping===a?A.image.height:null,C=v[o.type];null!==o.precision&&(g=i.getMaxPrecision(o.precision),g!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",g,"instead."));const L=x.morphAttributes.position||x.morphAttributes.normal||x.morphAttributes.color,P=void 0!==L?L.length:0;let U,w,I,y,N=0;if(void 0!==x.morphAttributes.position&&(N=1),void 0!==x.morphAttributes.normal&&(N=2),void 0!==x.morphAttributes.color&&(N=3),C){const e=Dn[C];U=e.vertexShader,w=e.fragmentShader}else U=o.vertexShader,w=o.fragmentShader,d.update(o),I=d.getVertexShaderID(o),y=d.getFragmentShaderID(o);const O=e.getRenderTarget(),B=e.state.buffers.depth.getReversed(),H=!0===T.isInstancedMesh,G=!0===T.isBatchedMesh,V=!!o.map,z=!!o.matcap,k=!!A,W=!!o.aoMap,X=!!o.lightMap,Y=!!o.bumpMap,K=!!o.normalMap,q=!!o.displacementMap,j=!!o.emissiveMap,Z=!!o.metalnessMap,$=!!o.roughnessMap,Q=o.anisotropy>0,J=o.clearcoat>0,ee=o.dispersion>0,te=o.iridescence>0,ne=o.sheen>0,re=o.transmission>0,ie=Q&&!!o.anisotropyMap,ae=J&&!!o.clearcoatMap,oe=J&&!!o.clearcoatNormalMap,se=J&&!!o.clearcoatRoughnessMap,le=te&&!!o.iridescenceMap,ce=te&&!!o.iridescenceThicknessMap,de=ne&&!!o.sheenColorMap,ue=ne&&!!o.sheenRoughnessMap,_e=!!o.specularMap,ge=!!o.specularColorMap,ve=!!o.specularIntensityMap,Ee=re&&!!o.transmissionMap,Se=re&&!!o.thicknessMap,Te=!!o.gradientMap,Me=!!o.alphaMap,xe=o.alphaTest>0,Re=!!o.alphaHash,Ae=!!o.extensions;let be=D;o.toneMapped&&(null!==O&&!0!==O.isXRRenderTarget||(be=e.toneMapping));const Ce={shaderID:C,shaderType:o.type,shaderName:o.name,vertexShader:U,fragmentShader:w,defines:o.defines,customVertexShaderID:I,customFragmentShaderID:y,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:g,batching:G,batchingColor:G&&null!==T._colorsTexture,instancing:H,instancingColor:H&&null!==T.instanceColor,instancingMorph:H&&null!==T.morphTexture,supportsVertexTextures:_,outputColorSpace:null===O?e.outputColorSpace:!0===O.isXRRenderTarget?O.texture.colorSpace:F,alphaToCoverage:!!o.alphaToCoverage,map:V,matcap:z,envMap:k,envMapMode:k&&A.mapping,envMapCubeUVHeight:b,aoMap:W,lightMap:X,bumpMap:Y,normalMap:K,displacementMap:_&&q,emissiveMap:j,normalMapObjectSpace:K&&o.normalMapType===he,normalMapTangentSpace:K&&o.normalMapType===me,metalnessMap:Z,roughnessMap:$,anisotropy:Q,anisotropyMap:ie,clearcoat:J,clearcoatMap:ae,clearcoatNormalMap:oe,clearcoatRoughnessMap:se,dispersion:ee,iridescence:te,iridescenceMap:le,iridescenceThicknessMap:ce,sheen:ne,sheenColorMap:de,sheenRoughnessMap:ue,specularMap:_e,specularColorMap:ge,specularIntensityMap:ve,transmission:re,transmissionMap:Ee,thicknessMap:Se,gradientMap:Te,opaque:!1===o.transparent&&o.blending===pe&&!1===o.alphaToCoverage,alphaMap:Me,alphaTest:xe,alphaHash:Re,combine:o.combine,mapUv:V&&E(o.map.channel),aoMapUv:W&&E(o.aoMap.channel),lightMapUv:X&&E(o.lightMap.channel),bumpMapUv:Y&&E(o.bumpMap.channel),normalMapUv:K&&E(o.normalMap.channel),displacementMapUv:q&&E(o.displacementMap.channel),emissiveMapUv:j&&E(o.emissiveMap.channel),metalnessMapUv:Z&&E(o.metalnessMap.channel),roughnessMapUv:$&&E(o.roughnessMap.channel),anisotropyMapUv:ie&&E(o.anisotropyMap.channel),clearcoatMapUv:ae&&E(o.clearcoatMap.channel),clearcoatNormalMapUv:oe&&E(o.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:se&&E(o.clearcoatRoughnessMap.channel),iridescenceMapUv:le&&E(o.iridescenceMap.channel),iridescenceThicknessMapUv:ce&&E(o.iridescenceThicknessMap.channel),sheenColorMapUv:de&&E(o.sheenColorMap.channel),sheenRoughnessMapUv:ue&&E(o.sheenRoughnessMap.channel),specularMapUv:_e&&E(o.specularMap.channel),specularColorMapUv:ge&&E(o.specularColorMap.channel),specularIntensityMapUv:ve&&E(o.specularIntensityMap.channel),transmissionMapUv:Ee&&E(o.transmissionMap.channel),thicknessMapUv:Se&&E(o.thicknessMap.channel),alphaMapUv:Me&&E(o.alphaMap.channel),vertexTangents:!!x.attributes.tangent&&(K||Q),vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!x.attributes.color&&4===x.attributes.color.itemSize,pointsUvs:!0===T.isPoints&&!!x.attributes.uv&&(V||Me),fog:!!M,useFog:!0===o.fog,fogExp2:!!M&&M.isFogExp2,flatShading:!0===o.flatShading&&!1===o.wireframe,sizeAttenuation:!0===o.sizeAttenuation,logarithmicDepthBuffer:h,reversedDepthBuffer:B,skinning:!0===T.isSkinnedMesh,morphTargets:void 0!==x.morphAttributes.position,morphNormals:void 0!==x.morphAttributes.normal,morphColors:void 0!==x.morphAttributes.color,morphTargetsCount:P,morphTextureStride:N,numDirLights:l.directional.length,numPointLights:l.point.length,numSpotLights:l.spot.length,numSpotLightMaps:l.spotLightMap.length,numRectAreaLights:l.rectArea.length,numHemiLights:l.hemi.length,numDirLightShadows:l.directionalShadowMap.length,numPointLightShadows:l.pointShadowMap.length,numSpotLightShadows:l.spotShadowMap.length,numSpotLightShadowsWithMaps:l.numSpotLightShadowsWithMaps,numLightProbes:l.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&f.length>0,shadowMapType:e.shadowMap.type,toneMapping:be,decodeVideoTexture:V&&!0===o.map.isVideoTexture&&p.getTransfer(o.map.colorSpace)===m,decodeVideoTextureEmissive:j&&!0===o.emissiveMap.isVideoTexture&&p.getTransfer(o.emissiveMap.colorSpace)===m,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===fe,flipSided:o.side===c,useDepthPacking:o.depthPacking>=0,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionClipCullDistance:Ae&&!0===o.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ae&&!0===o.extensions.multiDraw||G)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:o.customProgramCacheKey()};return Ce.vertexUv1s=u.has(1),Ce.vertexUv2s=u.has(2),Ce.vertexUv3s=u.has(3),u.clear(),Ce},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){l.disableAll(),t.supportsVertexTextures&&l.enable(0);t.instancing&&l.enable(1);t.instancingColor&&l.enable(2);t.instancingMorph&&l.enable(3);t.matcap&&l.enable(4);t.envMap&&l.enable(5);t.normalMapObjectSpace&&l.enable(6);t.normalMapTangentSpace&&l.enable(7);t.clearcoat&&l.enable(8);t.iridescence&&l.enable(9);t.alphaTest&&l.enable(10);t.vertexColors&&l.enable(11);t.vertexAlphas&&l.enable(12);t.vertexUv1s&&l.enable(13);t.vertexUv2s&&l.enable(14);t.vertexUv3s&&l.enable(15);t.vertexTangents&&l.enable(16);t.anisotropy&&l.enable(17);t.alphaHash&&l.enable(18);t.batching&&l.enable(19);t.dispersion&&l.enable(20);t.batchingColor&&l.enable(21);t.gradientMap&&l.enable(22);e.push(l.mask),l.disableAll(),t.fog&&l.enable(0);t.useFog&&l.enable(1);t.flatShading&&l.enable(2);t.logarithmicDepthBuffer&&l.enable(3);t.reversedDepthBuffer&&l.enable(4);t.skinning&&l.enable(5);t.morphTargets&&l.enable(6);t.morphNormals&&l.enable(7);t.morphColors&&l.enable(8);t.premultipliedAlpha&&l.enable(9);t.shadowMapEnabled&&l.enable(10);t.doubleSided&&l.enable(11);t.flipSided&&l.enable(12);t.useDepthPacking&&l.enable(13);t.dithering&&l.enable(14);t.transmission&&l.enable(15);t.sheen&&l.enable(16);t.opaque&&l.enable(17);t.pointsUvs&&l.enable(18);t.decodeVideoTexture&&l.enable(19);t.decodeVideoTextureEmissive&&l.enable(20);t.alphaToCoverage&&l.enable(21);e.push(l.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=v[e.type];let n;if(t){const e=Dn[t];n=ue.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,t=f.length;e<t;e++){const t=f[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new Oi(e,n,t,o),f.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=f.indexOf(e);f[t]=f[f.length-1],f.pop(),e.destroy()}},releaseShaderCache:function(e){d.remove(e)},programs:f,dispose:function(){d.dispose()}}}function Vi(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function zi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ki(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Wi(){const e=[];let t=0;const n=[],r=[],i=[];function a(n,r,i,a,o,s){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,o,s,l,c){const d=a(e,t,o,s,l,c);o.transmission>0?r.push(d):!0===o.transparent?i.push(d):n.push(d)},unshift:function(e,t,o,s,l,c){const d=a(e,t,o,s,l,c);o.transmission>0?r.unshift(d):!0===o.transparent?i.unshift(d):n.unshift(d)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||zi),r.length>1&&r.sort(t||ki),i.length>1&&i.sort(t||ki)}}}function Xi(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new Wi,e.set(t,[i])):n>=r.length?(i=new Wi,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function Yi(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new i,color:new n};break;case"SpotLight":r={position:new i,direction:new i,color:new n,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new i,color:new n,distance:0,decay:0};break;case"HemisphereLight":r={direction:new i,skyColor:new n,groundColor:new n};break;case"RectAreaLight":r={color:new n,position:new i,halfWidth:new i,halfHeight:new i}}return e[t.id]=r,r}}}let Ki=0;function qi(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function ji(e){const n=new Yi,r=function(){const e={};return{get:function(n){if(void 0!==e[n.id])return e[n.id];let r;switch(n.type){case"DirectionalLight":case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new t};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new t,shadowCameraNear:1,shadowCameraFar:1e3}}return e[n.id]=r,r}}}(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)a.probe.push(new i);const o=new i,s=new f,l=new f;return{setup:function(t){let i=0,o=0,s=0;for(let e=0;e<9;e++)a.probe[e].set(0,0,0);let l=0,c=0,d=0,u=0,f=0,p=0,m=0,h=0,_=0,g=0,v=0;t.sort(qi);for(let e=0,E=t.length;e<E;e++){const E=t[e],S=E.color,T=E.intensity,M=E.distance,x=E.shadow&&E.shadow.map?E.shadow.map.texture:null;if(E.isAmbientLight)i+=S.r*T,o+=S.g*T,s+=S.b*T;else if(E.isLightProbe){for(let e=0;e<9;e++)a.probe[e].addScaledVector(E.sh.coefficients[e],T);v++}else if(E.isDirectionalLight){const e=n.get(E);if(e.color.copy(E.color).multiplyScalar(E.intensity),E.castShadow){const e=E.shadow,t=r.get(E);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,a.directionalShadow[l]=t,a.directionalShadowMap[l]=x,a.directionalShadowMatrix[l]=E.shadow.matrix,p++}a.directional[l]=e,l++}else if(E.isSpotLight){const e=n.get(E);e.position.setFromMatrixPosition(E.matrixWorld),e.color.copy(S).multiplyScalar(T),e.distance=M,e.coneCos=Math.cos(E.angle),e.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),e.decay=E.decay,a.spot[d]=e;const t=E.shadow;if(E.map&&(a.spotLightMap[_]=E.map,_++,t.updateMatrices(E),E.castShadow&&g++),a.spotLightMatrix[d]=t.matrix,E.castShadow){const e=r.get(E);e.shadowIntensity=t.intensity,e.shadowBias=t.bias,e.shadowNormalBias=t.normalBias,e.shadowRadius=t.radius,e.shadowMapSize=t.mapSize,a.spotShadow[d]=e,a.spotShadowMap[d]=x,h++}d++}else if(E.isRectAreaLight){const e=n.get(E);e.color.copy(S).multiplyScalar(T),e.halfWidth.set(.5*E.width,0,0),e.halfHeight.set(0,.5*E.height,0),a.rectArea[u]=e,u++}else if(E.isPointLight){const e=n.get(E);if(e.color.copy(E.color).multiplyScalar(E.intensity),e.distance=E.distance,e.decay=E.decay,E.castShadow){const e=E.shadow,t=r.get(E);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,a.pointShadow[c]=t,a.pointShadowMap[c]=x,a.pointShadowMatrix[c]=E.shadow.matrix,m++}a.point[c]=e,c++}else if(E.isHemisphereLight){const e=n.get(E);e.skyColor.copy(E.color).multiplyScalar(T),e.groundColor.copy(E.groundColor).multiplyScalar(T),a.hemi[f]=e,f++}}u>0&&(!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=Un.LTC_FLOAT_1,a.rectAreaLTC2=Un.LTC_FLOAT_2):(a.rectAreaLTC1=Un.LTC_HALF_1,a.rectAreaLTC2=Un.LTC_HALF_2)),a.ambient[0]=i,a.ambient[1]=o,a.ambient[2]=s;const E=a.hash;E.directionalLength===l&&E.pointLength===c&&E.spotLength===d&&E.rectAreaLength===u&&E.hemiLength===f&&E.numDirectionalShadows===p&&E.numPointShadows===m&&E.numSpotShadows===h&&E.numSpotMaps===_&&E.numLightProbes===v||(a.directional.length=l,a.spot.length=d,a.rectArea.length=u,a.point.length=c,a.hemi.length=f,a.directionalShadow.length=p,a.directionalShadowMap.length=p,a.pointShadow.length=m,a.pointShadowMap.length=m,a.spotShadow.length=h,a.spotShadowMap.length=h,a.directionalShadowMatrix.length=p,a.pointShadowMatrix.length=m,a.spotLightMatrix.length=h+_-g,a.spotLightMap.length=_,a.numSpotLightShadowsWithMaps=g,a.numLightProbes=v,E.directionalLength=l,E.pointLength=c,E.spotLength=d,E.rectAreaLength=u,E.hemiLength=f,E.numDirectionalShadows=p,E.numPointShadows=m,E.numSpotShadows=h,E.numSpotMaps=_,E.numLightProbes=v,a.version=Ki++)},setupView:function(e,t){let n=0,r=0,i=0,c=0,d=0;const u=t.matrixWorldInverse;for(let t=0,f=e.length;t<f;t++){const f=e[t];if(f.isDirectionalLight){const e=a.directional[n];e.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(u),n++}else if(f.isSpotLight){const e=a.spot[i];e.position.setFromMatrixPosition(f.matrixWorld),e.position.applyMatrix4(u),e.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(u),i++}else if(f.isRectAreaLight){const e=a.rectArea[c];e.position.setFromMatrixPosition(f.matrixWorld),e.position.applyMatrix4(u),l.identity(),s.copy(f.matrixWorld),s.premultiply(u),l.extractRotation(s),e.halfWidth.set(.5*f.width,0,0),e.halfHeight.set(0,.5*f.height,0),e.halfWidth.applyMatrix4(l),e.halfHeight.applyMatrix4(l),c++}else if(f.isPointLight){const e=a.point[r];e.position.setFromMatrixPosition(f.matrixWorld),e.position.applyMatrix4(u),r++}else if(f.isHemisphereLight){const e=a.hemi[d];e.direction.setFromMatrixPosition(f.matrixWorld),e.direction.transformDirection(u),d++}}},state:a}}function Zi(e){const t=new ji(e),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function $i(e){let t=new WeakMap;return{get:function(n,r=0){const i=t.get(n);let a;return void 0===i?(a=new Zi(e),t.set(n,[a])):r>=i.length?(a=new Zi(e),i.push(a)):a=i[r],a},dispose:function(){t=new WeakMap}}}function Qi(e,n,r){let i=new ge;const a=new t,s=new t,d=new k,u=new ve({depthPacking:Ee}),f=new Se,p={},m=r.maxTextureSize,h={[_]:c,[c]:_,[fe]:fe},g=new l({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new t},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),v=g.clone();v.defines.HORIZONTAL_PASS=1;const E=new N;E.setAttribute("position",new O(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const S=new o(E,g),T=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=$;let M=this.type;function x(t,r){const i=n.update(S);g.defines.VSM_SAMPLES!==t.blurSamples&&(g.defines.VSM_SAMPLES=t.blurSamples,v.defines.VSM_SAMPLES=t.blurSamples,g.needsUpdate=!0,v.needsUpdate=!0),null===t.mapPass&&(t.mapPass=new y(a.x,a.y)),g.uniforms.shadow_pass.value=t.map.texture,g.uniforms.resolution.value=t.mapSize,g.uniforms.radius.value=t.radius,e.setRenderTarget(t.mapPass),e.clear(),e.renderBufferDirect(r,null,i,g,S,null),v.uniforms.shadow_pass.value=t.mapPass.texture,v.uniforms.resolution.value=t.mapSize,v.uniforms.radius.value=t.radius,e.setRenderTarget(t.map),e.clear(),e.renderBufferDirect(r,null,i,v,S,null)}function R(t,n,r,i){let a=null;const o=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===r.isPointLight?f:u,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=a.uuid,t=n.uuid;let r=p[e];void 0===r&&(r={},p[e]=r);let i=r[t];void 0===i&&(i=a.clone(),r[t]=i,n.addEventListener("dispose",b)),a=i}if(a.visible=n.visible,a.wireframe=n.wireframe,a.side=i===J?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],a.alphaMap=n.alphaMap,a.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial){e.properties.get(a).light=r}return a}function A(t,r,a,o,s){if(!1===t.visible)return;if(t.layers.test(r.layers)&&(t.isMesh||t.isLine||t.isPoints)&&(t.castShadow||t.receiveShadow&&s===J)&&(!t.frustumCulled||i.intersectsObject(t))){t.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,t.matrixWorld);const i=n.update(t),l=t.material;if(Array.isArray(l)){const n=i.groups;for(let c=0,d=n.length;c<d;c++){const d=n[c],u=l[d.materialIndex];if(u&&u.visible){const n=R(t,u,o,s);t.onBeforeShadow(e,t,r,a,i,n,d),e.renderBufferDirect(a,null,i,n,t,d),t.onAfterShadow(e,t,r,a,i,n,d)}}}else if(l.visible){const n=R(t,l,o,s);t.onBeforeShadow(e,t,r,a,i,n,null),e.renderBufferDirect(a,null,i,n,t,null),t.onAfterShadow(e,t,r,a,i,n,null)}}const l=t.children;for(let e=0,t=l.length;e<t;e++)A(l[e],r,a,o,s)}function b(e){e.target.removeEventListener("dispose",b);for(const t in p){const n=p[t],r=e.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(t,n,r){if(!1===T.enabled)return;if(!1===T.autoUpdate&&!1===T.needsUpdate)return;if(0===t.length)return;const o=e.getRenderTarget(),l=e.getActiveCubeFace(),c=e.getActiveMipmapLevel(),u=e.state;u.setBlending(I),!0===u.buffers.depth.getReversed()?u.buffers.color.setClear(0,0,0,0):u.buffers.color.setClear(1,1,1,1),u.buffers.depth.setTest(!0),u.setScissorTest(!1);const f=M!==J&&this.type===J,p=M===J&&this.type!==J;for(let o=0,l=t.length;o<l;o++){const l=t[o],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;a.copy(c.mapSize);const h=c.getFrameExtents();if(a.multiply(h),s.copy(c.mapSize),(a.x>m||a.y>m)&&(a.x>m&&(s.x=Math.floor(m/h.x),a.x=s.x*h.x,c.mapSize.x=s.x),a.y>m&&(s.y=Math.floor(m/h.y),a.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map||!0===f||!0===p){const e=this.type!==J?{minFilter:Te,magFilter:Te}:{};null!==c.map&&c.map.dispose(),c.map=new y(a.x,a.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const _=c.getViewportCount();for(let e=0;e<_;e++){const t=c.getViewport(e);d.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),u.viewport(d),c.updateMatrices(l,e),i=c.getFrustum(),A(n,r,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===J&&x(c,r),c.needsUpdate=!1}M=this.type,T.needsUpdate=!1,e.setRenderTarget(o,l,c)}}const Ji={[Ke]:Ye,[Xe]:ze,[We]:Ve,[Me]:ke,[Ye]:Ke,[ze]:Xe,[Ve]:We,[ke]:Me};function ea(e,t){const r=new function(){let t=!1;const n=new k;let r=null;const i=new k(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},i=new function(){let n=!1,r=!1,i=null,a=null,o=null;return{setReversed:function(e){if(r!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),r=e;const i=o;o=null,this.setClear(i)}},getReversed:function(){return r},setTest:function(t){t?W(e.DEPTH_TEST):X(e.DEPTH_TEST)},setMask:function(t){i===t||n||(e.depthMask(t),i=t)},setFunc:function(t){if(r&&(t=Ji[t]),a!==t){switch(t){case Ke:e.depthFunc(e.NEVER);break;case Ye:e.depthFunc(e.ALWAYS);break;case Xe:e.depthFunc(e.LESS);break;case Me:e.depthFunc(e.LEQUAL);break;case We:e.depthFunc(e.EQUAL);break;case ke:e.depthFunc(e.GEQUAL);break;case ze:e.depthFunc(e.GREATER);break;case Ve:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}a=t}},setLocked:function(e){n=e},setClear:function(t){o!==t&&(r&&(t=1-t),e.clearDepth(t),o=t)},reset:function(){n=!1,i=null,a=null,o=null,r=!1}}},a=new function(){let t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(n){t||(n?W(e.STENCIL_TEST):X(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null}}},o=new WeakMap,s=new WeakMap;let l={},d={},u=new WeakMap,f=[],p=null,m=!1,h=null,_=null,g=null,v=null,E=null,S=null,T=null,M=new n(0,0,0),x=0,R=!1,A=null,b=null,C=null,L=null,P=null;const U=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let D=!1,w=0;const y=e.getParameter(e.VERSION);-1!==y.indexOf("WebGL")?(w=parseFloat(/^WebGL (\d)/.exec(y)[1]),D=w>=1):-1!==y.indexOf("OpenGL ES")&&(w=parseFloat(/^OpenGL ES (\d)/.exec(y)[1]),D=w>=2);let N=null,O={};const F=e.getParameter(e.SCISSOR_BOX),B=e.getParameter(e.VIEWPORT),H=(new k).fromArray(F),G=(new k).fromArray(B);function V(t,n,r,i){const a=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return o}const z={};function W(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function X(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}z[e.TEXTURE_2D]=V(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=V(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),z[e.TEXTURE_2D_ARRAY]=V(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),z[e.TEXTURE_3D]=V(e.TEXTURE_3D,e.TEXTURE_3D,1,1),r.setClear(0,0,0,1),i.setClear(1),a.setClear(0),W(e.DEPTH_TEST),i.setFunc(Me),j(!1),Z(je),W(e.CULL_FACE),q(I);const Y={[Ae]:e.FUNC_ADD,[Re]:e.FUNC_SUBTRACT,[xe]:e.FUNC_REVERSE_SUBTRACT};Y[tt]=e.MIN,Y[nt]=e.MAX;const K={[Ge]:e.ZERO,[He]:e.ONE,[Be]:e.SRC_COLOR,[Fe]:e.SRC_ALPHA,[Oe]:e.SRC_ALPHA_SATURATE,[Ne]:e.DST_COLOR,[ye]:e.DST_ALPHA,[Ie]:e.ONE_MINUS_SRC_COLOR,[we]:e.ONE_MINUS_SRC_ALPHA,[De]:e.ONE_MINUS_DST_COLOR,[Ue]:e.ONE_MINUS_DST_ALPHA,[Pe]:e.CONSTANT_COLOR,[Le]:e.ONE_MINUS_CONSTANT_COLOR,[Ce]:e.CONSTANT_ALPHA,[be]:e.ONE_MINUS_CONSTANT_ALPHA};function q(t,n,r,i,a,o,s,l,c,d){if(t!==I){if(!1===m&&(W(e.BLEND),m=!0),t===$e)a=a||n,o=o||r,s=s||i,n===_&&a===E||(e.blendEquationSeparate(Y[n],Y[a]),_=n,E=a),r===g&&i===v&&o===S&&s===T||(e.blendFuncSeparate(K[r],K[i],K[o],K[s]),g=r,v=i,S=o,T=s),!1!==l.equals(M)&&c===x||(e.blendColor(l.r,l.g,l.b,c),M.copy(l),x=c),h=t,R=!1;else if(t!==h||d!==R){if(_===Ae&&E===Ae||(e.blendEquation(e.FUNC_ADD),_=Ae,E=Ae),d)switch(t){case pe:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case et:e.blendFunc(e.ONE,e.ONE);break;case Je:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Qe:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case pe:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case et:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case Je:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Qe:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,v=null,S=null,T=null,M.set(0,0,0),x=0,h=t,R=d}}else!0===m&&(X(e.BLEND),m=!1)}function j(t){A!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),A=t)}function Z(t){t!==qe?(W(e.CULL_FACE),t!==b&&(t===je?e.cullFace(e.BACK):t===Ze?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):X(e.CULL_FACE),b=t}function $(t,n,r){t?(W(e.POLYGON_OFFSET_FILL),L===n&&P===r||(e.polygonOffset(n,r),L=n,P=r)):X(e.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:i,stencil:a},enable:W,disable:X,bindFramebuffer:function(t,n){return d[t]!==n&&(e.bindFramebuffer(t,n),d[t]=n,t===e.DRAW_FRAMEBUFFER&&(d[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(d[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=f,i=!1;if(t){r=u.get(n),void 0===r&&(r=[],u.set(n,r));const a=t.textures;if(r.length!==a.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=a.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=a.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:q,setMaterial:function(t,n){t.side===fe?X(e.CULL_FACE):W(e.CULL_FACE);let o=t.side===c;n&&(o=!o),j(o),t.blending===pe&&!1===t.transparent?q(I):q(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),r.setMask(t.colorWrite);const s=t.stencilWrite;a.setTest(s),s&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),$(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?W(e.SAMPLE_ALPHA_TO_COVERAGE):X(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:j,setCullFace:Z,setLineWidth:function(t){t!==C&&(D&&e.lineWidth(t),C=t)},setPolygonOffset:$,setScissorTest:function(t){t?W(e.SCISSOR_TEST):X(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+U-1),N!==t&&(e.activeTexture(t),N=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===N?e.TEXTURE0+U-1:N);let i=O[r];void 0===i&&(i={type:void 0,texture:void 0},O[r]=i),i.type===t&&i.texture===n||(N!==r&&(e.activeTexture(r),N=r),e.bindTexture(t,n||z[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=O[N];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);o.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),o.set(n,r))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===H.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),H.copy(t))},viewport:function(t){!1===G.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),G.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),i.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},N=null,O={},d={},u=new WeakMap,f=[],p=null,m=!1,h=null,_=null,g=null,v=null,E=null,S=null,T=null,M=new n(0,0,0),x=0,R=!1,A=null,b=null,C=null,L=null,P=null,H.set(0,0,e.canvas.width,e.canvas.height),G.set(0,0,e.canvas.width,e.canvas.height),r.reset(),i.reset(),a.reset()}}}function ta(e,n,r,i,a,o,s){const l=n.has("WEBGL_multisampled_render_to_texture")?n.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),d=new t,u=new WeakMap;let f;const h=new WeakMap;let _=!1;try{_="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function g(e,t){return _?new OffscreenCanvas(e,t):Rt("canvas")}function v(e,t,n){let r=1;const i=Q(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),a=Math.floor(r*i.height);void 0===f&&(f=g(n,a));const o=t?g(n,a):f;o.width=n,o.height=a;return o.getContext("2d").drawImage(e,0,0,n,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+a+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function E(e){return e.generateMipmaps}function x(t){e.generateMipmap(t)}function R(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function A(t,r,i,a,o=!1){if(null!==t){if(void 0!==e[t])return e[t];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+t+"'")}let s=r;if(r===e.RED&&(i===e.FLOAT&&(s=e.R32F),i===e.HALF_FLOAT&&(s=e.R16F),i===e.UNSIGNED_BYTE&&(s=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.R8UI),i===e.UNSIGNED_SHORT&&(s=e.R16UI),i===e.UNSIGNED_INT&&(s=e.R32UI),i===e.BYTE&&(s=e.R8I),i===e.SHORT&&(s=e.R16I),i===e.INT&&(s=e.R32I)),r===e.RG&&(i===e.FLOAT&&(s=e.RG32F),i===e.HALF_FLOAT&&(s=e.RG16F),i===e.UNSIGNED_BYTE&&(s=e.RG8)),r===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RG8UI),i===e.UNSIGNED_SHORT&&(s=e.RG16UI),i===e.UNSIGNED_INT&&(s=e.RG32UI),i===e.BYTE&&(s=e.RG8I),i===e.SHORT&&(s=e.RG16I),i===e.INT&&(s=e.RG32I)),r===e.RGB_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RGB8UI),i===e.UNSIGNED_SHORT&&(s=e.RGB16UI),i===e.UNSIGNED_INT&&(s=e.RGB32UI),i===e.BYTE&&(s=e.RGB8I),i===e.SHORT&&(s=e.RGB16I),i===e.INT&&(s=e.RGB32I)),r===e.RGBA_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RGBA8UI),i===e.UNSIGNED_SHORT&&(s=e.RGBA16UI),i===e.UNSIGNED_INT&&(s=e.RGBA32UI),i===e.BYTE&&(s=e.RGBA8I),i===e.SHORT&&(s=e.RGBA16I),i===e.INT&&(s=e.RGBA32I)),r===e.RGB&&(i===e.UNSIGNED_INT_5_9_9_9_REV&&(s=e.RGB9_E5),i===e.UNSIGNED_INT_10F_11F_11F_REV&&(s=e.R11F_G11F_B10F)),r===e.RGBA){const t=o?se:p.getTransfer(a);i===e.FLOAT&&(s=e.RGBA32F),i===e.HALF_FLOAT&&(s=e.RGBA16F),i===e.UNSIGNED_BYTE&&(s=t===m?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)}return s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||n.get("EXT_color_buffer_float"),s}function b(t,n){let r;return t?null===n||n===Tt||n===Mt?r=e.DEPTH24_STENCIL8:n===T?r=e.DEPTH32F_STENCIL8:n===xt&&(r=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===Tt||n===Mt?r=e.DEPTH_COMPONENT24:n===T?r=e.DEPTH_COMPONENT32F:n===xt&&(r=e.DEPTH_COMPONENT16),r}function C(e,t){return!0===E(e)||e.isFramebufferTexture&&e.minFilter!==Te&&e.minFilter!==B?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function L(e){const t=e.target;t.removeEventListener("dispose",L),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=h.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&U(e),0===Object.keys(r).length&&h.delete(n)}i.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function P(t){const n=t.target;n.removeEventListener("dispose",P),function(t){const n=i.get(t);t.depthTexture&&(t.depthTexture.dispose(),i.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(n.__webglFramebuffer[t]))for(let r=0;r<n.__webglFramebuffer[t].length;r++)e.deleteFramebuffer(n.__webglFramebuffer[t][r]);else e.deleteFramebuffer(n.__webglFramebuffer[t]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=t.textures;for(let t=0,n=r.length;t<n;t++){const n=i.get(r[t]);n.__webglTexture&&(e.deleteTexture(n.__webglTexture),s.memory.textures--),i.remove(r[t])}i.remove(t)}(n)}function U(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete h.get(r)[n.__cacheKey],s.memory.textures--}let D=0;function w(t,n){const a=i.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&a.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void V(a,t,n);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(a.__webglTexture=t.sourceTexture?t.sourceTexture:null);r.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+n)}const I={[at]:e.REPEAT,[it]:e.CLAMP_TO_EDGE,[rt]:e.MIRRORED_REPEAT},y={[Te]:e.NEAREST,[ct]:e.NEAREST_MIPMAP_NEAREST,[lt]:e.NEAREST_MIPMAP_LINEAR,[B]:e.LINEAR,[st]:e.LINEAR_MIPMAP_NEAREST,[ot]:e.LINEAR_MIPMAP_LINEAR},N={[_t]:e.NEVER,[ht]:e.ALWAYS,[mt]:e.LESS,[K]:e.LEQUAL,[pt]:e.EQUAL,[ft]:e.GEQUAL,[ut]:e.GREATER,[dt]:e.NOTEQUAL};function O(t,r){if(r.type!==T||!1!==n.has("OES_texture_float_linear")||r.magFilter!==B&&r.magFilter!==st&&r.magFilter!==lt&&r.magFilter!==ot&&r.minFilter!==B&&r.minFilter!==st&&r.minFilter!==lt&&r.minFilter!==ot||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(t,e.TEXTURE_WRAP_S,I[r.wrapS]),e.texParameteri(t,e.TEXTURE_WRAP_T,I[r.wrapT]),t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY||e.texParameteri(t,e.TEXTURE_WRAP_R,I[r.wrapR]),e.texParameteri(t,e.TEXTURE_MAG_FILTER,y[r.magFilter]),e.texParameteri(t,e.TEXTURE_MIN_FILTER,y[r.minFilter]),r.compareFunction&&(e.texParameteri(t,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(t,e.TEXTURE_COMPARE_FUNC,N[r.compareFunction])),!0===n.has("EXT_texture_filter_anisotropic")){if(r.magFilter===Te)return;if(r.minFilter!==lt&&r.minFilter!==ot)return;if(r.type===T&&!1===n.has("OES_texture_float_linear"))return;if(r.anisotropy>1||i.get(r).__currentAnisotropy){const o=n.get("EXT_texture_filter_anisotropic");e.texParameterf(t,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r.anisotropy,a.getMaxAnisotropy())),i.get(r).__currentAnisotropy=r.anisotropy}}}function H(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",L));const i=n.source;let a=h.get(i);void 0===a&&(a={},h.set(i,a));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),a[o].usedTimes++;const i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&U(n)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return r}function G(e,t,n){return Math.floor(Math.floor(e/n)/t)}function V(t,n,s){let l=e.TEXTURE_2D;(n.isDataArrayTexture||n.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),n.isData3DTexture&&(l=e.TEXTURE_3D);const c=H(t,n),d=n.source;r.bindTexture(l,t.__webglTexture,e.TEXTURE0+s);const u=i.get(d);if(d.version!==u.__version||!0===c){r.activeTexture(e.TEXTURE0+s);const t=p.getPrimaries(p.workingColorSpace),i=n.colorSpace===gt?null:p.getPrimaries(n.colorSpace),f=n.colorSpace===gt||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,f);let m=v(n.image,!1,a.maxTextureSize);m=$(n,m);const h=o.convert(n.format,n.colorSpace),_=o.convert(n.type);let g,S=A(n.internalFormat,h,_,n.colorSpace,n.isVideoTexture);O(l,n);const T=n.mipmaps,R=!0!==n.isVideoTexture,L=void 0===u.__version||!0===c,P=d.dataReady,U=C(n,m);if(n.isDepthTexture)S=b(n.format===vt,n.type),L&&(R?r.texStorage2D(e.TEXTURE_2D,1,S,m.width,m.height):r.texImage2D(e.TEXTURE_2D,0,S,m.width,m.height,0,h,_,null));else if(n.isDataTexture)if(T.length>0){R&&L&&r.texStorage2D(e.TEXTURE_2D,U,S,T[0].width,T[0].height);for(let t=0,n=T.length;t<n;t++)g=T[t],R?P&&r.texSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,h,_,g.data):r.texImage2D(e.TEXTURE_2D,t,S,g.width,g.height,0,h,_,g.data);n.generateMipmaps=!1}else R?(L&&r.texStorage2D(e.TEXTURE_2D,U,S,m.width,m.height),P&&function(t,n,i,a){const o=t.updateRanges;if(0===o.length)r.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,i,a,n.data);else{o.sort((e,t)=>e.start-t.start);let s=0;for(let e=1;e<o.length;e++){const t=o[s],r=o[e],i=t.start+t.count,a=G(r.start,n.width,4),l=G(t.start,n.width,4);r.start<=i+1&&a===l&&G(r.start+r.count-1,n.width,4)===a?t.count=Math.max(t.count,r.start+r.count-t.start):(++s,o[s]=r)}o.length=s+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),d=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,n.width);for(let t=0,s=o.length;t<s;t++){const s=o[t],l=Math.floor(s.start/4),c=Math.ceil(s.count/4),d=l%n.width,u=Math.floor(l/n.width),f=c,p=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,d),e.pixelStorei(e.UNPACK_SKIP_ROWS,u),r.texSubImage2D(e.TEXTURE_2D,0,d,u,f,p,i,a,n.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,d)}}(n,m,h,_)):r.texImage2D(e.TEXTURE_2D,0,S,m.width,m.height,0,h,_,m.data);else if(n.isCompressedTexture)if(n.isCompressedArrayTexture){R&&L&&r.texStorage3D(e.TEXTURE_2D_ARRAY,U,S,T[0].width,T[0].height,m.depth);for(let t=0,i=T.length;t<i;t++)if(g=T[t],n.format!==M)if(null!==h)if(R){if(P)if(n.layerUpdates.size>0){const i=Et(g.width,g.height,n.format,n.type);for(const a of n.layerUpdates){const n=g.data.subarray(a*i/g.data.BYTES_PER_ELEMENT,(a+1)*i/g.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,a,g.width,g.height,1,h,n)}n.clearLayerUpdates()}else r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,g.width,g.height,m.depth,h,g.data)}else r.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,S,g.width,g.height,m.depth,0,g.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else R?P&&r.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,g.width,g.height,m.depth,h,_,g.data):r.texImage3D(e.TEXTURE_2D_ARRAY,t,S,g.width,g.height,m.depth,0,h,_,g.data)}else{R&&L&&r.texStorage2D(e.TEXTURE_2D,U,S,T[0].width,T[0].height);for(let t=0,i=T.length;t<i;t++)g=T[t],n.format!==M?null!==h?R?P&&r.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,h,g.data):r.compressedTexImage2D(e.TEXTURE_2D,t,S,g.width,g.height,0,g.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):R?P&&r.texSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,h,_,g.data):r.texImage2D(e.TEXTURE_2D,t,S,g.width,g.height,0,h,_,g.data)}else if(n.isDataArrayTexture)if(R){if(L&&r.texStorage3D(e.TEXTURE_2D_ARRAY,U,S,m.width,m.height,m.depth),P)if(n.layerUpdates.size>0){const t=Et(m.width,m.height,n.format,n.type);for(const i of n.layerUpdates){const n=m.data.subarray(i*t/m.data.BYTES_PER_ELEMENT,(i+1)*t/m.data.BYTES_PER_ELEMENT);r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,i,m.width,m.height,1,h,_,n)}n.clearLayerUpdates()}else r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,m.width,m.height,m.depth,h,_,m.data)}else r.texImage3D(e.TEXTURE_2D_ARRAY,0,S,m.width,m.height,m.depth,0,h,_,m.data);else if(n.isData3DTexture)R?(L&&r.texStorage3D(e.TEXTURE_3D,U,S,m.width,m.height,m.depth),P&&r.texSubImage3D(e.TEXTURE_3D,0,0,0,0,m.width,m.height,m.depth,h,_,m.data)):r.texImage3D(e.TEXTURE_3D,0,S,m.width,m.height,m.depth,0,h,_,m.data);else if(n.isFramebufferTexture){if(L)if(R)r.texStorage2D(e.TEXTURE_2D,U,S,m.width,m.height);else{let t=m.width,n=m.height;for(let i=0;i<U;i++)r.texImage2D(e.TEXTURE_2D,i,S,t,n,0,h,_,null),t>>=1,n>>=1}}else if(T.length>0){if(R&&L){const t=Q(T[0]);r.texStorage2D(e.TEXTURE_2D,U,S,t.width,t.height)}for(let t=0,n=T.length;t<n;t++)g=T[t],R?P&&r.texSubImage2D(e.TEXTURE_2D,t,0,0,h,_,g):r.texImage2D(e.TEXTURE_2D,t,S,h,_,g);n.generateMipmaps=!1}else if(R){if(L){const t=Q(m);r.texStorage2D(e.TEXTURE_2D,U,S,t.width,t.height)}P&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,h,_,m)}else r.texImage2D(e.TEXTURE_2D,0,S,h,_,m);E(n)&&x(l),u.__version=d.version,n.onUpdate&&n.onUpdate(n)}t.__version=n.version}function z(t,n,a,s,c,d){const u=o.convert(a.format,a.colorSpace),f=o.convert(a.type),p=A(a.internalFormat,u,f,a.colorSpace),m=i.get(n),h=i.get(a);if(h.__renderTarget=n,!m.__hasExternalTextures){const t=Math.max(1,n.width>>d),i=Math.max(1,n.height>>d);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?r.texImage3D(c,d,p,t,i,n.depth,0,u,f,null):r.texImage2D(c,d,p,t,i,0,u,f,null)}r.bindFramebuffer(e.FRAMEBUFFER,t),Z(n)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,c,h.__webglTexture,0,j(n)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,c,h.__webglTexture,d),r.bindFramebuffer(e.FRAMEBUFFER,null)}function k(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const i=n.depthTexture,a=i&&i.isDepthTexture?i.type:null,o=b(n.stencilBuffer,a),s=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=j(n);Z(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,o,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,o,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,o,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,s,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const a=t[i],s=o.convert(a.format,a.colorSpace),c=o.convert(a.type),d=A(a.internalFormat,s,c,a.colorSpace),u=j(n);r&&!1===Z(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,u,d,n.width,n.height):Z(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,u,d,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,d,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function W(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(e.FRAMEBUFFER,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const a=i.get(n.depthTexture);a.__renderTarget=n,a.__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),w(n.depthTexture,0);const o=a.__webglTexture,s=j(n);if(n.depthTexture.format===St)Z(n)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0,s):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0);else{if(n.depthTexture.format!==vt)throw new Error("Unknown depthTexture format");Z(n)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0,s):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0)}}function X(t){const n=i.get(t),a=!0===t.isWebGLCubeRenderTarget;if(n.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(n.__depthDisposeCallback&&n.__depthDisposeCallback(),e){const t=()=>{delete n.__boundDepthTexture,delete n.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),n.__depthDisposeCallback=t}n.__boundDepthTexture=e}if(t.depthTexture&&!n.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");const e=t.texture.mipmaps;e&&e.length>0?W(n.__webglFramebuffer[0],t):W(n.__webglFramebuffer,t)}else if(a){n.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(r.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[i]),void 0===n.__webglDepthbuffer[i])n.__webglDepthbuffer[i]=e.createRenderbuffer(),k(n.__webglDepthbuffer[i],t,!1);else{const r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,a=n.__webglDepthbuffer[i];e.bindRenderbuffer(e.RENDERBUFFER,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,a)}}else{const i=t.texture.mipmaps;if(i&&i.length>0?r.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[0]):r.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),void 0===n.__webglDepthbuffer)n.__webglDepthbuffer=e.createRenderbuffer(),k(n.__webglDepthbuffer,t,!1);else{const r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=n.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,i)}}r.bindFramebuffer(e.FRAMEBUFFER,null)}const Y=[],q=[];function j(e){return Math.min(a.maxSamples,e.samples)}function Z(e){const t=i.get(e);return e.samples>0&&!0===n.has("WEBGL_multisampled_render_to_texture")&&!1!==t.__useRenderToTexture}function $(e,t){const n=e.colorSpace,r=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==F&&n!==gt&&(p.getTransfer(n)===m?r===M&&i===S||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function Q(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(d.width=e.naturalWidth||e.width,d.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(d.width=e.displayWidth,d.height=e.displayHeight):(d.width=e.width,d.height=e.height),d}this.allocateTextureUnit=function(){const e=D;return e>=a.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+a.maxTextures),D+=1,e},this.resetTextureUnits=function(){D=0},this.setTexture2D=w,this.setTexture2DArray=function(t,n){const a=i.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?V(a,t,n):r.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+n)},this.setTexture3D=function(t,n){const a=i.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?V(a,t,n):r.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+n)},this.setTextureCube=function(t,n){const s=i.get(t);t.version>0&&s.__version!==t.version?function(t,n,s){if(6!==n.image.length)return;const l=H(t,n),c=n.source;r.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);const d=i.get(c);if(c.version!==d.__version||!0===l){r.activeTexture(e.TEXTURE0+s);const t=p.getPrimaries(p.workingColorSpace),i=n.colorSpace===gt?null:p.getPrimaries(n.colorSpace),u=n.colorSpace===gt||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,u);const f=n.isCompressedTexture||n.image[0].isCompressedTexture,m=n.image[0]&&n.image[0].isDataTexture,h=[];for(let e=0;e<6;e++)h[e]=f||m?m?n.image[e].image:n.image[e]:v(n.image[e],!0,a.maxCubemapSize),h[e]=$(n,h[e]);const _=h[0],g=o.convert(n.format,n.colorSpace),S=o.convert(n.type),T=A(n.internalFormat,g,S,n.colorSpace),R=!0!==n.isVideoTexture,b=void 0===d.__version||!0===l,L=c.dataReady;let P,U=C(n,_);if(O(e.TEXTURE_CUBE_MAP,n),f){R&&b&&r.texStorage2D(e.TEXTURE_CUBE_MAP,U,T,_.width,_.height);for(let t=0;t<6;t++){P=h[t].mipmaps;for(let i=0;i<P.length;i++){const a=P[i];n.format!==M?null!==g?R?L&&r.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,a.width,a.height,g,a.data):r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,T,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):R?L&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,a.width,a.height,g,S,a.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,T,a.width,a.height,0,g,S,a.data)}}}else{if(P=n.mipmaps,R&&b){P.length>0&&U++;const t=Q(h[0]);r.texStorage2D(e.TEXTURE_CUBE_MAP,U,T,t.width,t.height)}for(let t=0;t<6;t++)if(m){R?L&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,h[t].width,h[t].height,g,S,h[t].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,T,h[t].width,h[t].height,0,g,S,h[t].data);for(let n=0;n<P.length;n++){const i=P[n].image[t].image;R?L&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,i.width,i.height,g,S,i.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,T,i.width,i.height,0,g,S,i.data)}}else{R?L&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,g,S,h[t]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,T,g,S,h[t]);for(let n=0;n<P.length;n++){const i=P[n];R?L&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,g,S,i.image[t]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,T,g,S,i.image[t])}}}E(n)&&x(e.TEXTURE_CUBE_MAP),d.__version=c.version,n.onUpdate&&n.onUpdate(n)}t.__version=n.version}(s,t,n):r.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+n)},this.rebindTextures=function(t,n,r){const a=i.get(t);void 0!==n&&z(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&X(t)},this.setupRenderTarget=function(t){const n=t.texture,a=i.get(t),l=i.get(n);t.addEventListener("dispose",P);const c=t.textures,d=!0===t.isWebGLCubeRenderTarget,u=c.length>1;if(u||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=n.version,s.memory.textures++),d){a.__webglFramebuffer=[];for(let t=0;t<6;t++)if(n.mipmaps&&n.mipmaps.length>0){a.__webglFramebuffer[t]=[];for(let r=0;r<n.mipmaps.length;r++)a.__webglFramebuffer[t][r]=e.createFramebuffer()}else a.__webglFramebuffer[t]=e.createFramebuffer()}else{if(n.mipmaps&&n.mipmaps.length>0){a.__webglFramebuffer=[];for(let t=0;t<n.mipmaps.length;t++)a.__webglFramebuffer[t]=e.createFramebuffer()}else a.__webglFramebuffer=e.createFramebuffer();if(u)for(let t=0,n=c.length;t<n;t++){const n=i.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===Z(t)){a.__webglMultisampledFramebuffer=e.createFramebuffer(),a.__webglColorRenderbuffer=[],r.bindFramebuffer(e.FRAMEBUFFER,a.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];a.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,a.__webglColorRenderbuffer[n]);const i=o.convert(r.format,r.colorSpace),s=o.convert(r.type),l=A(r.internalFormat,i,s,r.colorSpace,!0===t.isXRRenderTarget),d=j(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,d,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,a.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(a.__webglDepthRenderbuffer=e.createRenderbuffer(),k(a.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(e.FRAMEBUFFER,null)}}if(d){r.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),O(e.TEXTURE_CUBE_MAP,n);for(let r=0;r<6;r++)if(n.mipmaps&&n.mipmaps.length>0)for(let i=0;i<n.mipmaps.length;i++)z(a.__webglFramebuffer[r][i],t,n,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,i);else z(a.__webglFramebuffer[r],t,n,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0);E(n)&&x(e.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(u){for(let n=0,o=c.length;n<o;n++){const o=c[n],s=i.get(o);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(l,s.__webglTexture),O(l,o),z(a.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0+n,l,0),E(o)&&x(l)}r.unbindTexture()}else{let i=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(i=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(i,l.__webglTexture),O(i,n),n.mipmaps&&n.mipmaps.length>0)for(let r=0;r<n.mipmaps.length;r++)z(a.__webglFramebuffer[r],t,n,e.COLOR_ATTACHMENT0,i,r);else z(a.__webglFramebuffer,t,n,e.COLOR_ATTACHMENT0,i,0);E(n)&&x(i),r.unbindTexture()}t.depthBuffer&&X(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let n=0,a=t.length;n<a;n++){const a=t[n];if(E(a)){const t=R(e),n=i.get(a).__webglTexture;r.bindTexture(t,n),x(t),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===Z(t)){const n=t.textures,a=t.width,o=t.height;let s=e.COLOR_BUFFER_BIT;const l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,d=i.get(t),u=n.length>1;if(u)for(let t=0;t<n.length;t++)r.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),r.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);r.bindFramebuffer(e.READ_FRAMEBUFFER,d.__webglMultisampledFramebuffer);const f=t.texture.mipmaps;f&&f.length>0?r.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer[0]):r.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer);for(let r=0;r<n.length;r++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),u){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,d.__webglColorRenderbuffer[r]);const t=i.get(n[r]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),!0===c&&(Y.length=0,q.length=0,Y.push(e.COLOR_ATTACHMENT0+r),t.depthBuffer&&!1===t.resolveDepthBuffer&&(Y.push(l),q.push(l),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,q)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,Y))}if(r.bindFramebuffer(e.READ_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),u)for(let t=0;t<n.length;t++){r.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,d.__webglColorRenderbuffer[t]);const a=i.get(n[t]).__webglTexture;r.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}r.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&c){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=X,this.setupFrameBufferTexture=z,this.useMultisampledRTT=Z}function na(e,t){return{convert:function(n,r=gt){let i;const a=p.getTransfer(r);if(n===S)return e.UNSIGNED_BYTE;if(n===At)return e.UNSIGNED_SHORT_4_4_4_4;if(n===bt)return e.UNSIGNED_SHORT_5_5_5_1;if(n===Ct)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===Lt)return e.UNSIGNED_INT_10F_11F_11F_REV;if(n===Pt)return e.BYTE;if(n===Ut)return e.SHORT;if(n===xt)return e.UNSIGNED_SHORT;if(n===v)return e.INT;if(n===Tt)return e.UNSIGNED_INT;if(n===T)return e.FLOAT;if(n===E)return e.HALF_FLOAT;if(n===Dt)return e.ALPHA;if(n===wt)return e.RGB;if(n===M)return e.RGBA;if(n===St)return e.DEPTH_COMPONENT;if(n===vt)return e.DEPTH_STENCIL;if(n===It)return e.RED;if(n===yt)return e.RED_INTEGER;if(n===Nt)return e.RG;if(n===Ot)return e.RG_INTEGER;if(n===Ft)return e.RGBA_INTEGER;if(n===Bt||n===Ht||n===Gt||n===Vt)if(a===m){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===Bt)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Ht)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Gt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Vt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===Bt)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Ht)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Gt)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Vt)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===zt||n===kt||n===Wt||n===Xt){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===zt)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===kt)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Wt)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Xt)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Yt||n===Kt||n===qt){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===Yt||n===Kt)return a===m?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===qt)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===jt||n===Zt||n===$t||n===Qt||n===Jt||n===en||n===tn||n===nn||n===rn||n===an||n===on||n===sn||n===ln||n===cn){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===jt)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Zt)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===$t)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Qt)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Jt)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===en)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===tn)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===nn)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===rn)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===an)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===on)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===sn)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===ln)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===cn)return a===m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===dn||n===un||n===fn){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===dn)return a===m?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===un)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===fn)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===pn||n===mn||n===hn||n===_n){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===pn)return i.COMPRESSED_RED_RGTC1_EXT;if(n===mn)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===hn)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===_n)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===Mt?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class ra{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const n=new gn(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new l({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new o(new h(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class ia extends vn{constructor(e,n){super();const r=this;let a=null,o=1,s=null,l="local-floor",c=1,d=null,u=null,f=null,p=null,m=null,h=null;const _="undefined"!=typeof XRWebGLBinding,g=new ra,v={},E=n.getContextAttributes();let T=null,x=null;const R=[],A=[],b=new t;let C=null;const L=new U;L.viewport=new k;const P=new U;P.viewport=new k;const D=[L,P],w=new En;let I=null,N=null;function O(e){const t=A.indexOf(e.inputSource);if(-1===t)return;const n=R[t];void 0!==n&&(n.update(e.inputSource,e.frame,d||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function F(){a.removeEventListener("select",O),a.removeEventListener("selectstart",O),a.removeEventListener("selectend",O),a.removeEventListener("squeeze",O),a.removeEventListener("squeezestart",O),a.removeEventListener("squeezeend",O),a.removeEventListener("end",F),a.removeEventListener("inputsourceschange",B);for(let e=0;e<R.length;e++){const t=A[e];null!==t&&(A[e]=null,R[e].disconnect(t))}I=null,N=null,g.reset();for(const e in v)delete v[e];e.setRenderTarget(T),m=null,p=null,f=null,a=null,x=null,W.stop(),r.isPresenting=!1,e.setPixelRatio(C),e.setSize(b.width,b.height,!1),r.dispatchEvent({type:"sessionend"})}function B(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=A.indexOf(n);r>=0&&(A[r]=null,R[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=A.indexOf(n);if(-1===r){for(let e=0;e<R.length;e++){if(e>=A.length){A.push(n),r=e;break}if(null===A[e]){A[e]=n,r=e;break}}if(-1===r)break}const i=R[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=R[e];return void 0===t&&(t=new Sn,R[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=R[e];return void 0===t&&(t=new Sn,R[e]=t),t.getGripSpace()},this.getHand=function(e){let t=R[e];return void 0===t&&(t=new Sn,R[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){o=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){l=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||s},this.setReferenceSpace=function(e){d=e},this.getBaseLayer=function(){return null!==p?p:m},this.getBinding=function(){return null===f&&_&&(f=new XRWebGLBinding(a,n)),f},this.getFrame=function(){return h},this.getSession=function(){return a},this.setSession=async function(t){if(a=t,null!==a){T=e.getRenderTarget(),a.addEventListener("select",O),a.addEventListener("selectstart",O),a.addEventListener("selectend",O),a.addEventListener("squeeze",O),a.addEventListener("squeezestart",O),a.addEventListener("squeezeend",O),a.addEventListener("end",F),a.addEventListener("inputsourceschange",B),!0!==E.xrCompatible&&await n.makeXRCompatible(),C=e.getPixelRatio(),e.getSize(b);if(_&&"createProjectionLayer"in XRWebGLBinding.prototype){let t=null,r=null,i=null;E.depth&&(i=E.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,t=E.stencil?vt:St,r=E.stencil?Mt:Tt);const s={colorFormat:n.RGBA8,depthFormat:i,scaleFactor:o};f=this.getBinding(),p=f.createProjectionLayer(s),a.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),x=new y(p.textureWidth,p.textureHeight,{format:M,type:S,depthTexture:new q(p.textureWidth,p.textureHeight,r,void 0,void 0,void 0,void 0,void 0,void 0,t),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0,resolveDepthBuffer:!1===p.ignoreDepthValues,resolveStencilBuffer:!1===p.ignoreDepthValues})}else{const t={antialias:E.antialias,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:o};m=new XRWebGLLayer(a,n,t),a.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),x=new y(m.framebufferWidth,m.framebufferHeight,{format:M,type:S,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil,resolveDepthBuffer:!1===m.ignoreDepthValues,resolveStencilBuffer:!1===m.ignoreDepthValues})}x.isXRRenderTarget=!0,this.setFoveation(c),d=null,s=await a.requestReferenceSpace(l),W.setContext(a),W.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==a)return a.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};const H=new i,G=new i;function V(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===a)return;let t=e.near,n=e.far;null!==g.texture&&(g.depthNear>0&&(t=g.depthNear),g.depthFar>0&&(n=g.depthFar)),w.near=P.near=L.near=t,w.far=P.far=L.far=n,I===w.near&&N===w.far||(a.updateRenderState({depthNear:w.near,depthFar:w.far}),I=w.near,N=w.far),w.layers.mask=6|e.layers.mask,L.layers.mask=3&w.layers.mask,P.layers.mask=5&w.layers.mask;const r=e.parent,i=w.cameras;V(w,r);for(let e=0;e<i.length;e++)V(i[e],r);2===i.length?function(e,t,n){H.setFromMatrixPosition(t.matrixWorld),G.setFromMatrixPosition(n.matrixWorld);const r=H.distanceTo(G),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],d=(i[8]-1)/i[0],u=(a[8]+1)/a[0],f=o*d,p=o*u,m=r/(-d+u),h=m*-d;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(h),e.translateZ(m),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=o+m,n=s+m,i=f-h,a=p+(r-h),d=l*s/n*t,u=c*s/n*t;e.projectionMatrix.makePerspective(i,a,d,u,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(w,L,P):w.projectionMatrix.copy(L.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*Tn*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,w,r)},this.getCamera=function(){return w},this.getFoveation=function(){if(null!==p||null!==m)return c},this.setFoveation=function(e){c=e,null!==p&&(p.fixedFoveation=e),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==g.texture},this.getDepthSensingMesh=function(){return g.getMesh(w)},this.getCameraTexture=function(e){return v[e]};let z=null;const W=new Cn;W.setAnimationLoop(function(t,n){if(u=n.getViewerPose(d||s),h=n,null!==u){const t=u.views;null!==m&&(e.setRenderTargetFramebuffer(x,m.framebuffer),e.setRenderTarget(x));let n=!1;t.length!==w.cameras.length&&(w.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r];let a=null;if(null!==m)a=m.getViewport(i);else{const t=f.getViewSubImage(p,i);a=t.viewport,0===r&&(e.setRenderTargetTextures(x,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(x))}let o=D[r];void 0===o&&(o=new U,o.layers.enable(r),o.viewport=new k,D[r]=o),o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(i.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(a.x,a.y,a.width,a.height),0===r&&(w.matrix.copy(o.matrix),w.matrix.decompose(w.position,w.quaternion,w.scale)),!0===n&&w.cameras.push(o)}const i=a.enabledFeatures;if(i&&i.includes("depth-sensing")&&"gpu-optimized"==a.depthUsage&&_){f=r.getBinding();const e=f.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&g.init(e,a.renderState)}if(i&&i.includes("camera-access")&&_){e.state.unbindTexture(),f=r.getBinding();for(let e=0;e<t.length;e++){const n=t[e].camera;if(n){let e=v[n];e||(e=new gn,v[n]=e);const t=f.getCameraImage(n);e.sourceTexture=t}}}}for(let e=0;e<R.length;e++){const t=A[e],r=R[e];null!==t&&void 0!==r&&r.update(t,n,d||s)}z&&z(t,n),n.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:n}),h=null}),this.setAnimationLoop=function(e){z=e},this.dispose=function(){}}}const aa=new u,oa=new f;function sa(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,r.side===c&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),r.side===c&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);const i=t.get(r),a=i.envMap,o=i.envMapRotation;a&&(e.envMap.value=a,aa.copy(o),aa.x*=-1,aa.y*=-1,aa.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(aa.y*=-1,aa.z*=-1),e.envMapRotation.value.setFromMatrix4(oa.makeRotationFromEuler(aa)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,g(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,o,s){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===c&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,s)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function la(e,t,n,r){let i={},a={},o=[];const s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const i=e.value,a=t+"_"+n;if(void 0===r[a])return r[a]="number"==typeof i||"boolean"==typeof i?i:i.clone(),!0;{const e=r[a];if("number"==typeof i||"boolean"==typeof i){if(e!==i)return r[a]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function d(t){const n=t.target;n.removeEventListener("dispose",d);const r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,u){let f=i[n.id];void 0===f&&(!function(e){const t=e.uniforms;let n=0;const r=16;for(let e=0,i=t.length;e<i;e++){const i=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=i.length;e<t;e++){const t=i[e],a=Array.isArray(t.value)?t.value:[t.value];for(let e=0,i=a.length;e<i;e++){const i=c(a[e]),o=n%r,s=o%i.boundary,l=o+s;n+=s,0!==l&&r-l<i.storage&&(n+=r-l),t.__data=new Float32Array(i.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=n,n+=i.storage}}}const i=n%r;i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),f=function(t){const n=function(){for(let e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=f,n.addEventListener("dispose",d));const p=u.program;r.updateUBOMapping(n,p);const m=t.render.frame;a[n.id]!==m&&(!function(t){const n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let t=0,n=r.length;t<n;t++){const n=Array.isArray(r[t])?r[t]:[r[t]];for(let r=0,i=n.length;r<i;r++){const i=n[r];if(!0===l(i,t,r,a)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let a=0;a<n.length;a++){const o=n[a],s=c(o);"number"==typeof o||"boolean"==typeof o?(i.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):o.isMatrix3?(i.__data[0]=o.elements[0],i.__data[1]=o.elements[1],i.__data[2]=o.elements[2],i.__data[3]=0,i.__data[4]=o.elements[3],i.__data[5]=o.elements[4],i.__data[6]=o.elements[5],i.__data[7]=0,i.__data[8]=o.elements[6],i.__data[9]=o.elements[7],i.__data[10]=o.elements[8],i.__data[11]=0):(o.toArray(i.__data,r),r+=s.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=m)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}class ca{constructor(e={}){const{canvas:t=Mn(),context:r=null,depth:a=!0,stencil:o=!1,alpha:s=!1,antialias:l=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:u=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:h=!1,reversedDepthBuffer:g=!1}=e;let v;if(this.isWebGLRenderer=!0,null!==r){if("undefined"!=typeof WebGLRenderingContext&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=r.getContextAttributes().alpha}else v=s;const T=new Uint32Array(4),M=new Int32Array(4);let x=null,R=null;const A=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=D,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const C=this;let L=!1;this._outputColorSpace=xn;let P=0,U=0,w=null,I=-1,N=null;const O=new k,B=new k;let G=null;const V=new n(0);let z=0,W=t.width,X=t.height,Y=1,K=null,q=null;const j=new k(0,0,W,X),Z=new k(0,0,W,X);let $=!1;const Q=new ge;let J=!1,ee=!1;const te=new f,ne=new i,re=new k,ie={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ae=!1;function oe(){return null===w?Y:1}let se,le,ce,de,ue,pe,me,he,_e,ve,Ee,Se,Te,Me,xe,Re,Ae,be,Ce,Le,Pe,Ue,De,we,Ie=r;function ye(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:a,stencil:o,antialias:l,premultipliedAlpha:d,preserveDrawingBuffer:u,powerPreference:m,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Rn}`),t.addEventListener("webglcontextlost",Fe,!1),t.addEventListener("webglcontextrestored",Be,!1),t.addEventListener("webglcontextcreationerror",He,!1),null===Ie){const t="webgl2";if(Ie=ye(t,e),null===Ie)throw ye(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function Ne(){se=new or(Ie),se.init(),Ue=new na(Ie,se),le=new Bn(Ie,se,e,Ue),ce=new ea(Ie,se),le.reversedDepthBuffer&&g&&ce.buffers.depth.setReversed(!0),de=new cr(Ie),ue=new Vi,pe=new ta(Ie,se,ce,ue,le,Ue,de),me=new Gn(C),he=new ar(C),_e=new Ln(Ie),De=new On(Ie,_e),ve=new sr(Ie,_e,de,De),Ee=new ur(Ie,ve,_e,de),Ce=new dr(Ie,le,pe),Re=new Hn(ue),Se=new Gi(C,me,he,se,le,De,Re),Te=new sa(C,ue),Me=new Xi,xe=new $i(se),be=new Nn(C,me,he,ce,Ee,v,d),Ae=new Qi(C,Ee,le),we=new la(Ie,de,le,ce),Le=new Fn(Ie,se,de),Pe=new lr(Ie,se,de),de.programs=Se.programs,C.capabilities=le,C.extensions=se,C.properties=ue,C.renderLists=Me,C.shadowMap=Ae,C.state=ce,C.info=de}Ne();const Oe=new ia(C,Ie);function Fe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),L=!0}function Be(){console.log("THREE.WebGLRenderer: Context Restored."),L=!1;const e=de.autoReset,t=Ae.enabled,n=Ae.autoUpdate,r=Ae.needsUpdate,i=Ae.type;Ne(),de.autoReset=e,Ae.enabled=t,Ae.autoUpdate=n,Ae.needsUpdate=r,Ae.type=i}function He(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ge(e){const t=e.target;t.removeEventListener("dispose",Ge),function(e){(function(e){const t=ue.get(e).programs;void 0!==t&&(t.forEach(function(e){Se.releaseProgram(e)}),e.isShaderMaterial&&Se.releaseShaderCache(e))})(e),ue.remove(e)}(t)}function Ve(e,t,n){!0===e.transparent&&e.side===fe&&!1===e.forceSinglePass?(e.side=c,e.needsUpdate=!0,$e(e,t,n),e.side=_,e.needsUpdate=!0,$e(e,t,n),e.side=fe):$e(e,t,n)}this.xr=Oe,this.getContext=function(){return Ie},this.getContextAttributes=function(){return Ie.getContextAttributes()},this.forceContextLoss=function(){const e=se.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=se.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(e){void 0!==e&&(Y=e,this.setSize(W,X,!1))},this.getSize=function(e){return e.set(W,X)},this.setSize=function(e,n,r=!0){Oe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=e,X=n,t.width=Math.floor(e*Y),t.height=Math.floor(n*Y),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(W*Y,X*Y).floor()},this.setDrawingBufferSize=function(e,n,r){W=e,X=n,Y=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(O)},this.getViewport=function(e){return e.copy(j)},this.setViewport=function(e,t,n,r){e.isVector4?j.set(e.x,e.y,e.z,e.w):j.set(e,t,n,r),ce.viewport(O.copy(j).multiplyScalar(Y).round())},this.getScissor=function(e){return e.copy(Z)},this.setScissor=function(e,t,n,r){e.isVector4?Z.set(e.x,e.y,e.z,e.w):Z.set(e,t,n,r),ce.scissor(B.copy(Z).multiplyScalar(Y).round())},this.getScissorTest=function(){return $},this.setScissorTest=function(e){ce.setScissorTest($=e)},this.setOpaqueSort=function(e){K=e},this.setTransparentSort=function(e){q=e},this.getClearColor=function(e){return e.copy(be.getClearColor())},this.setClearColor=function(){be.setClearColor(...arguments)},this.getClearAlpha=function(){return be.getClearAlpha()},this.setClearAlpha=function(){be.setClearAlpha(...arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;if(e){let e=!1;if(null!==w){const t=w.texture.format;e=t===Ft||t===Ot||t===yt}if(e){const e=w.texture.type,t=e===S||e===Tt||e===xt||e===Mt||e===At||e===bt,n=be.getClearColor(),r=be.getClearAlpha(),i=n.r,a=n.g,o=n.b;t?(T[0]=i,T[1]=a,T[2]=o,T[3]=r,Ie.clearBufferuiv(Ie.COLOR,0,T)):(M[0]=i,M[1]=a,M[2]=o,M[3]=r,Ie.clearBufferiv(Ie.COLOR,0,M))}else r|=Ie.COLOR_BUFFER_BIT}t&&(r|=Ie.DEPTH_BUFFER_BIT),n&&(r|=Ie.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ie.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Fe,!1),t.removeEventListener("webglcontextrestored",Be,!1),t.removeEventListener("webglcontextcreationerror",He,!1),be.dispose(),Me.dispose(),xe.dispose(),ue.dispose(),me.dispose(),he.dispose(),Ee.dispose(),De.dispose(),we.dispose(),Se.dispose(),Oe.dispose(),Oe.removeEventListener("sessionstart",ke),Oe.removeEventListener("sessionend",We),Xe.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=ie);const o=i.isMesh&&i.matrixWorld.determinant()<0,s=function(e,t,n,r,i){!0!==t.isScene&&(t=ie);pe.resetTextureUnits();const a=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=null===w?C.outputColorSpace:!0===w.isXRRenderTarget?w.texture.colorSpace:F,l=(r.isMeshStandardMaterial?he:me).get(r.envMap||o),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,d=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),u=!!n.morphAttributes.position,f=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let m=D;r.toneMapped&&(null!==w&&!0!==w.isXRRenderTarget||(m=C.toneMapping));const h=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,_=void 0!==h?h.length:0,g=ue.get(r),v=R.state.lights;if(!0===J&&(!0===ee||e!==N)){const t=e===N&&r.id===I;Re.setState(r,e,t)}let E=!1;r.version===g.__version?g.needsLights&&g.lightsStateVersion!==v.state.version||g.outputColorSpace!==s||i.isBatchedMesh&&!1===g.batching?E=!0:i.isBatchedMesh||!0!==g.batching?i.isBatchedMesh&&!0===g.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===g.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===g.instancing?E=!0:i.isInstancedMesh||!0!==g.instancing?i.isSkinnedMesh&&!1===g.skinning?E=!0:i.isSkinnedMesh||!0!==g.skinning?i.isInstancedMesh&&!0===g.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===g.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===g.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===g.instancingMorph&&null!==i.morphTexture||g.envMap!==l||!0===r.fog&&g.fog!==a?E=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===Re.numPlanes&&g.numIntersection===Re.numIntersection?(g.vertexAlphas!==c||g.vertexTangents!==d||g.morphTargets!==u||g.morphNormals!==f||g.morphColors!==p||g.toneMapping!==m||g.morphTargetsCount!==_)&&(E=!0):E=!0:E=!0:E=!0:E=!0:(E=!0,g.__version=r.version);let S=g.currentProgram;!0===E&&(S=$e(r,t,i));let T=!1,M=!1,x=!1;const A=S.getUniforms(),b=g.uniforms;ce.useProgram(S.program)&&(T=!0,M=!0,x=!0);r.id!==I&&(I=r.id,M=!0);if(T||N!==e){ce.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),A.setValue(Ie,"projectionMatrix",e.projectionMatrix),A.setValue(Ie,"viewMatrix",e.matrixWorldInverse);const t=A.map.cameraPosition;void 0!==t&&t.setValue(Ie,ne.setFromMatrixPosition(e.matrixWorld)),le.logarithmicDepthBuffer&&A.setValue(Ie,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&A.setValue(Ie,"isOrthographic",!0===e.isOrthographicCamera),N!==e&&(N=e,M=!0,x=!0)}if(i.isSkinnedMesh){A.setOptional(Ie,i,"bindMatrix"),A.setOptional(Ie,i,"bindMatrixInverse");const e=i.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),A.setValue(Ie,"boneTexture",e.boneTexture,pe))}i.isBatchedMesh&&(A.setOptional(Ie,i,"batchingTexture"),A.setValue(Ie,"batchingTexture",i._matricesTexture,pe),A.setOptional(Ie,i,"batchingIdTexture"),A.setValue(Ie,"batchingIdTexture",i._indirectTexture,pe),A.setOptional(Ie,i,"batchingColorTexture"),null!==i._colorsTexture&&A.setValue(Ie,"batchingColorTexture",i._colorsTexture,pe));const L=n.morphAttributes;void 0===L.position&&void 0===L.normal&&void 0===L.color||Ce.update(i,n,S);(M||g.receiveShadow!==i.receiveShadow)&&(g.receiveShadow=i.receiveShadow,A.setValue(Ie,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(b.envMap.value=l,b.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(b.envMapIntensity.value=t.environmentIntensity);M&&(A.setValue(Ie,"toneMappingExposure",C.toneMappingExposure),g.needsLights&&(U=x,(P=b).ambientLightColor.needsUpdate=U,P.lightProbe.needsUpdate=U,P.directionalLights.needsUpdate=U,P.directionalLightShadows.needsUpdate=U,P.pointLights.needsUpdate=U,P.pointLightShadows.needsUpdate=U,P.spotLights.needsUpdate=U,P.spotLightShadows.needsUpdate=U,P.rectAreaLights.needsUpdate=U,P.hemisphereLights.needsUpdate=U),a&&!0===r.fog&&Te.refreshFogUniforms(b,a),Te.refreshMaterialUniforms(b,r,Y,X,R.state.transmissionRenderTarget[e.id]),_i.upload(Ie,Qe(g),b,pe));var P,U;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(_i.upload(Ie,Qe(g),b,pe),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&A.setValue(Ie,"center",i.center);if(A.setValue(Ie,"modelViewMatrix",i.modelViewMatrix),A.setValue(Ie,"normalMatrix",i.normalMatrix),A.setValue(Ie,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];we.update(n,S),we.bind(n,S)}}return S}(e,t,n,r,i);ce.setMaterial(r,o);let l=n.index,c=1;if(!0===r.wireframe){if(l=ve.getWireframeAttribute(n),void 0===l)return;c=2}const d=n.drawRange,u=n.attributes.position;let f=d.start*c,p=(d.start+d.count)*c;null!==a&&(f=Math.max(f,a.start*c),p=Math.min(p,(a.start+a.count)*c)),null!==l?(f=Math.max(f,0),p=Math.min(p,l.count)):null!=u&&(f=Math.max(f,0),p=Math.min(p,u.count));const m=p-f;if(m<0||m===1/0)return;let h;De.setup(i,r,s,n,l);let _=Le;if(null!==l&&(h=_e.get(l),_=Pe,_.setIndex(h)),i.isMesh)!0===r.wireframe?(ce.setLineWidth(r.wireframeLinewidth*oe()),_.setMode(Ie.LINES)):_.setMode(Ie.TRIANGLES);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),ce.setLineWidth(e*oe()),i.isLineSegments?_.setMode(Ie.LINES):i.isLineLoop?_.setMode(Ie.LINE_LOOP):_.setMode(Ie.LINE_STRIP)}else i.isPoints?_.setMode(Ie.POINTS):i.isSprite&&_.setMode(Ie.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)H("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),_.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if(se.get("WEBGL_multi_draw"))_.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else{const e=i._multiDrawStarts,t=i._multiDrawCounts,n=i._multiDrawCount,a=l?_e.get(l).bytesPerElement:1,o=ue.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)o.setValue(Ie,"_gl_DrawID",r),_.render(e[r]/a,t[r])}else if(i.isInstancedMesh)_.renderInstances(f,m,i.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);_.renderInstances(f,m,t)}else _.render(f,m)},this.compile=function(e,t,n=null){null===n&&(n=e),R=xe.get(n),R.init(t),b.push(R),n.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(R.pushLight(e),e.castShadow&&R.pushShadow(e))}),e!==n&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(R.pushLight(e),e.castShadow&&R.pushShadow(e))}),R.setupLights();const r=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Ve(a,n,e),r.add(a)}else Ve(t,n,e),r.add(t)}),R=b.pop(),r},this.compileAsync=function(e,t,n=null){const r=this.compile(e,t,n);return new Promise(t=>{function n(){r.forEach(function(e){ue.get(e).currentProgram.isReady()&&r.delete(e)}),0!==r.size?setTimeout(n,10):t(e)}null!==se.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let ze=null;function ke(){Xe.stop()}function We(){Xe.start()}const Xe=new Cn;function Ye(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)R.pushLight(e),e.castShadow&&R.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||Q.intersectsSprite(e)){r&&re.setFromMatrixPosition(e.matrixWorld).applyMatrix4(te);const t=Ee.update(e),i=e.material;i.visible&&x.push(e,t,i,n,re.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||Q.intersectsObject(e))){const t=Ee.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),re.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),re.copy(t.boundingSphere.center)),re.applyMatrix4(e.matrixWorld).applyMatrix4(te)),Array.isArray(i)){const r=t.groups;for(let a=0,o=r.length;a<o;a++){const o=r[a],s=i[o.materialIndex];s&&s.visible&&x.push(e,t,s,n,re.z,o)}}else i.visible&&x.push(e,t,i,n,re.z,null)}const i=e.children;for(let e=0,a=i.length;e<a;e++)Ye(i[e],t,n,r)}function Ke(e,t,n,r){const i=e.opaque,a=e.transmissive,o=e.transparent;R.setupLightsView(n),!0===J&&Re.setGlobalState(C.clippingPlanes,n),r&&ce.viewport(O.copy(r)),i.length>0&&je(i,t,n),a.length>0&&je(a,t,n),o.length>0&&je(o,t,n),ce.buffers.depth.setTest(!0),ce.buffers.depth.setMask(!0),ce.buffers.color.setMask(!0),ce.setPolygonOffset(!1)}function qe(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===R.state.transmissionRenderTarget[r.id]&&(R.state.transmissionRenderTarget[r.id]=new y(1,1,{generateMipmaps:!0,type:se.has("EXT_color_buffer_half_float")||se.has("EXT_color_buffer_float")?E:S,minFilter:ot,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:p.workingColorSpace}));const i=R.state.transmissionRenderTarget[r.id],a=r.viewport||O;i.setSize(a.z*C.transmissionResolutionScale,a.w*C.transmissionResolutionScale);const s=C.getRenderTarget(),l=C.getActiveCubeFace(),d=C.getActiveMipmapLevel();C.setRenderTarget(i),C.getClearColor(V),z=C.getClearAlpha(),z<1&&C.setClearColor(16777215,.5),C.clear(),ae&&be.render(n);const u=C.toneMapping;C.toneMapping=D;const f=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),R.setupLightsView(r),!0===J&&Re.setGlobalState(C.clippingPlanes,r),je(e,n,r),pe.updateMultisampleRenderTarget(i),pe.updateRenderTargetMipmap(i),!1===se.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let i=0,a=t.length;i<a;i++){const a=t[i],o=a.object,s=a.geometry,l=a.material,d=a.group;if(l.side===fe&&o.layers.test(r.layers)){const t=l.side;l.side=c,l.needsUpdate=!0,Ze(o,n,r,s,l,d),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(pe.updateMultisampleRenderTarget(i),pe.updateRenderTargetMipmap(i))}C.setRenderTarget(s,l,d),C.setClearColor(V,z),void 0!==f&&(r.viewport=f),C.toneMapping=u}function je(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],o=a.object,s=a.geometry,l=a.group;let c=a.material;!0===c.allowOverride&&null!==r&&(c=r),o.layers.test(n.layers)&&Ze(o,t,n,s,c,l)}}function Ze(e,t,n,r,i,a){e.onBeforeRender(C,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(C,t,n,r,e,a),!0===i.transparent&&i.side===fe&&!1===i.forceSinglePass?(i.side=c,i.needsUpdate=!0,C.renderBufferDirect(n,t,r,i,e,a),i.side=_,i.needsUpdate=!0,C.renderBufferDirect(n,t,r,i,e,a),i.side=fe):C.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(C,t,n,r,i,a)}function $e(e,t,n){!0!==t.isScene&&(t=ie);const r=ue.get(e),i=R.state.lights,a=R.state.shadowsArray,o=i.state.version,s=Se.getParameters(e,i.state,a,t,n),l=Se.getProgramCacheKey(s);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?he:me).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Ge),c=new Map,r.programs=c);let d=c.get(l);if(void 0!==d){if(r.currentProgram===d&&r.lightsStateVersion===o)return Je(e,s),d}else s.uniforms=Se.getUniforms(e),e.onBeforeCompile(s,C),d=Se.acquireProgram(s,l),c.set(l,d),r.uniforms=s.uniforms;const u=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(u.clippingPlanes=Re.uniform),Je(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(u.ambientLightColor.value=i.state.ambient,u.lightProbe.value=i.state.probe,u.directionalLights.value=i.state.directional,u.directionalLightShadows.value=i.state.directionalShadow,u.spotLights.value=i.state.spot,u.spotLightShadows.value=i.state.spotShadow,u.rectAreaLights.value=i.state.rectArea,u.ltc_1.value=i.state.rectAreaLTC1,u.ltc_2.value=i.state.rectAreaLTC2,u.pointLights.value=i.state.point,u.pointLightShadows.value=i.state.pointShadow,u.hemisphereLights.value=i.state.hemi,u.directionalShadowMap.value=i.state.directionalShadowMap,u.directionalShadowMatrix.value=i.state.directionalShadowMatrix,u.spotShadowMap.value=i.state.spotShadowMap,u.spotLightMatrix.value=i.state.spotLightMatrix,u.spotLightMap.value=i.state.spotLightMap,u.pointShadowMap.value=i.state.pointShadowMap,u.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=d,r.uniformsList=null,d}function Qe(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=_i.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Je(e,t){const n=ue.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Xe.setAnimationLoop(function(e){ze&&ze(e)}),"undefined"!=typeof self&&Xe.setContext(self),this.setAnimationLoop=function(e){ze=e,Oe.setAnimationLoop(e),null===e?Xe.stop():Xe.start()},Oe.addEventListener("sessionstart",ke),Oe.addEventListener("sessionend",We),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===L)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Oe.enabled&&!0===Oe.isPresenting&&(!0===Oe.cameraAutoUpdate&&Oe.updateCamera(t),t=Oe.getCamera()),!0===e.isScene&&e.onBeforeRender(C,e,t,w),R=xe.get(e,b.length),R.init(t),b.push(R),te.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Q.setFromProjectionMatrix(te,An,t.reversedDepth),ee=this.localClippingEnabled,J=Re.init(this.clippingPlanes,ee),x=Me.get(e,A.length),x.init(),A.push(x),!0===Oe.enabled&&!0===Oe.isPresenting){const e=C.xr.getDepthSensingMesh();null!==e&&Ye(e,t,-1/0,C.sortObjects)}Ye(e,t,0,C.sortObjects),x.finish(),!0===C.sortObjects&&x.sort(K,q),ae=!1===Oe.enabled||!1===Oe.isPresenting||!1===Oe.hasDepthSensing(),ae&&be.addToRenderList(x,e),this.info.render.frame++,!0===J&&Re.beginShadows();const n=R.state.shadowsArray;Ae.render(n,e,t),!0===J&&Re.endShadows(),!0===this.info.autoReset&&this.info.reset();const r=x.opaque,i=x.transmissive;if(R.setupLights(),t.isArrayCamera){const n=t.cameras;if(i.length>0)for(let t=0,a=n.length;t<a;t++){qe(r,i,e,n[t])}ae&&be.render(e);for(let t=0,r=n.length;t<r;t++){const r=n[t];Ke(x,e,r,r.viewport)}}else i.length>0&&qe(r,i,e,t),ae&&be.render(e),Ke(x,e,t);null!==w&&0===U&&(pe.updateMultisampleRenderTarget(w),pe.updateRenderTargetMipmap(w)),!0===e.isScene&&e.onAfterRender(C,e,t),De.resetDefaultState(),I=-1,N=null,b.pop(),b.length>0?(R=b[b.length-1],!0===J&&Re.setGlobalState(C.clippingPlanes,R.state.camera)):R=null,A.pop(),x=A.length>0?A[A.length-1]:null},this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return U},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(e,t,n){const r=ue.get(e);r.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),ue.get(e.texture).__webglTexture=t,ue.get(e.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=ue.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const et=Ie.createFramebuffer();this.setRenderTarget=function(e,t=0,n=0){w=e,P=t,U=n;let r=!0,i=null,a=!1,o=!1;if(e){const s=ue.get(e);if(void 0!==s.__useDefaultFramebuffer)ce.bindFramebuffer(Ie.FRAMEBUFFER,null),r=!1;else if(void 0===s.__webglFramebuffer)pe.setupRenderTarget(e);else if(s.__hasExternalTextures)pe.rebindTextures(e,ue.get(e.texture).__webglTexture,ue.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(s.__boundDepthTexture!==t){if(null!==t&&ue.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");pe.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);const c=ue.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(c[t])?c[t][n]:c[t],a=!0):i=e.samples>0&&!1===pe.useMultisampledRTT(e)?ue.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,O.copy(e.viewport),B.copy(e.scissor),G=e.scissorTest}else O.copy(j).multiplyScalar(Y).floor(),B.copy(Z).multiplyScalar(Y).floor(),G=$;0!==n&&(i=et);if(ce.bindFramebuffer(Ie.FRAMEBUFFER,i)&&r&&ce.drawBuffers(e,i),ce.viewport(O),ce.scissor(B),ce.setScissorTest(G),a){const r=ue.get(e.texture);Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(o){const r=t;for(let t=0;t<e.textures.length;t++){const i=ue.get(e.textures[t]);Ie.framebufferTextureLayer(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0+t,i.__webglTexture,n,r)}}else if(null!==e&&0!==n){const t=ue.get(e.texture);Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_2D,t.__webglTexture,n)}I=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o,s=0){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=ue.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(l=l[o]),l){ce.bindFramebuffer(Ie.FRAMEBUFFER,l);try{const o=e.textures[s],l=o.format,c=o.type;if(!le.textureFormatReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!le.textureTypeReadable(c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&(e.textures.length>1&&Ie.readBuffer(Ie.COLOR_ATTACHMENT0+s),Ie.readPixels(t,n,r,i,Ue.convert(l),Ue.convert(c),a))}finally{const e=null!==w?ue.get(w).__webglFramebuffer:null;ce.bindFramebuffer(Ie.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,r,i,a,o,s=0){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=ue.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(l=l[o]),l){if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i){ce.bindFramebuffer(Ie.FRAMEBUFFER,l);const o=e.textures[s],c=o.format,d=o.type;if(!le.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!le.textureTypeReadable(d))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const u=Ie.createBuffer();Ie.bindBuffer(Ie.PIXEL_PACK_BUFFER,u),Ie.bufferData(Ie.PIXEL_PACK_BUFFER,a.byteLength,Ie.STREAM_READ),e.textures.length>1&&Ie.readBuffer(Ie.COLOR_ATTACHMENT0+s),Ie.readPixels(t,n,r,i,Ue.convert(c),Ue.convert(d),0);const f=null!==w?ue.get(w).__webglFramebuffer:null;ce.bindFramebuffer(Ie.FRAMEBUFFER,f);const p=Ie.fenceSync(Ie.SYNC_GPU_COMMANDS_COMPLETE,0);return Ie.flush(),await bn(Ie,p,4),Ie.bindBuffer(Ie.PIXEL_PACK_BUFFER,u),Ie.getBufferSubData(Ie.PIXEL_PACK_BUFFER,0,a),Ie.deleteBuffer(u),Ie.deleteSync(p),a}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t=null,n=0){const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),o=null!==t?t.x:0,s=null!==t?t.y:0;pe.setTexture2D(e,0),Ie.copyTexSubImage2D(Ie.TEXTURE_2D,n,0,0,o,s,i,a),ce.unbindTexture()};const tt=Ie.createFramebuffer(),nt=Ie.createFramebuffer();this.copyTextureToTexture=function(e,t,n=null,r=null,i=0,a=null){let o,s,l,c,d,u,f,p,m;null===a&&(0!==i?(H("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),a=i,i=0):a=0);const h=e.isCompressedTexture?e.mipmaps[a]:e.image;if(null!==n)o=n.max.x-n.min.x,s=n.max.y-n.min.y,l=n.isBox3?n.max.z-n.min.z:1,c=n.min.x,d=n.min.y,u=n.isBox3?n.min.z:0;else{const t=Math.pow(2,-i);o=Math.floor(h.width*t),s=Math.floor(h.height*t),l=e.isDataArrayTexture?h.depth:e.isData3DTexture?Math.floor(h.depth*t):1,c=0,d=0,u=0}null!==r?(f=r.x,p=r.y,m=r.z):(f=0,p=0,m=0);const _=Ue.convert(t.format),g=Ue.convert(t.type);let v;t.isData3DTexture?(pe.setTexture3D(t,0),v=Ie.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(pe.setTexture2DArray(t,0),v=Ie.TEXTURE_2D_ARRAY):(pe.setTexture2D(t,0),v=Ie.TEXTURE_2D),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,t.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,t.unpackAlignment);const E=Ie.getParameter(Ie.UNPACK_ROW_LENGTH),S=Ie.getParameter(Ie.UNPACK_IMAGE_HEIGHT),T=Ie.getParameter(Ie.UNPACK_SKIP_PIXELS),M=Ie.getParameter(Ie.UNPACK_SKIP_ROWS),x=Ie.getParameter(Ie.UNPACK_SKIP_IMAGES);Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,h.width),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,h.height),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,c),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,d),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,u);const R=e.isDataArrayTexture||e.isData3DTexture,A=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const n=ue.get(e),r=ue.get(t),h=ue.get(n.__renderTarget),_=ue.get(r.__renderTarget);ce.bindFramebuffer(Ie.READ_FRAMEBUFFER,h.__webglFramebuffer),ce.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,_.__webglFramebuffer);for(let n=0;n<l;n++)R&&(Ie.framebufferTextureLayer(Ie.READ_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,ue.get(e).__webglTexture,i,u+n),Ie.framebufferTextureLayer(Ie.DRAW_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,ue.get(t).__webglTexture,a,m+n)),Ie.blitFramebuffer(c,d,o,s,f,p,o,s,Ie.DEPTH_BUFFER_BIT,Ie.NEAREST);ce.bindFramebuffer(Ie.READ_FRAMEBUFFER,null),ce.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,null)}else if(0!==i||e.isRenderTargetTexture||ue.has(e)){const n=ue.get(e),r=ue.get(t);ce.bindFramebuffer(Ie.READ_FRAMEBUFFER,tt),ce.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,nt);for(let e=0;e<l;e++)R?Ie.framebufferTextureLayer(Ie.READ_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,n.__webglTexture,i,u+e):Ie.framebufferTexture2D(Ie.READ_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_2D,n.__webglTexture,i),A?Ie.framebufferTextureLayer(Ie.DRAW_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,r.__webglTexture,a,m+e):Ie.framebufferTexture2D(Ie.DRAW_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_2D,r.__webglTexture,a),0!==i?Ie.blitFramebuffer(c,d,o,s,f,p,o,s,Ie.COLOR_BUFFER_BIT,Ie.NEAREST):A?Ie.copyTexSubImage3D(v,a,f,p,m+e,c,d,o,s):Ie.copyTexSubImage2D(v,a,f,p,c,d,o,s);ce.bindFramebuffer(Ie.READ_FRAMEBUFFER,null),ce.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,null)}else A?e.isDataTexture||e.isData3DTexture?Ie.texSubImage3D(v,a,f,p,m,o,s,l,_,g,h.data):t.isCompressedArrayTexture?Ie.compressedTexSubImage3D(v,a,f,p,m,o,s,l,_,h.data):Ie.texSubImage3D(v,a,f,p,m,o,s,l,_,g,h):e.isDataTexture?Ie.texSubImage2D(Ie.TEXTURE_2D,a,f,p,o,s,_,g,h.data):e.isCompressedTexture?Ie.compressedTexSubImage2D(Ie.TEXTURE_2D,a,f,p,h.width,h.height,_,h.data):Ie.texSubImage2D(Ie.TEXTURE_2D,a,f,p,o,s,_,g,h);Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,E),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,S),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,T),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,M),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,x),0===a&&t.generateMipmaps&&Ie.generateMipmap(v),ce.unbindTexture()},this.initRenderTarget=function(e){void 0===ue.get(e).__webglFramebuffer&&pe.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?pe.setTextureCube(e,0):e.isData3DTexture?pe.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?pe.setTexture2DArray(e,0):pe.setTexture2D(e,0),ce.unbindTexture()},this.resetState=function(){P=0,U=0,w=null,ce.reset(),De.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return An}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=p._getDrawingBufferColorSpace(e),t.unpackColorSpace=p._getUnpackColorSpace()}}export{re as ACESFilmicToneMapping,Ae as AddEquation,le as AddOperation,et as AdditiveBlending,ne as AgXToneMapping,Dt as AlphaFormat,ht as AlwaysCompare,Ye as AlwaysDepth,En as ArrayCamera,c as BackSide,s as BoxGeometry,O as BufferAttribute,N as BufferGeometry,Pt as ByteType,ie as CineonToneMapping,it as ClampToEdgeWrapping,n as Color,p as ColorManagement,Ce as ConstantAlphaFactor,Pe as ConstantColorFactor,C as CubeReflectionMapping,L as CubeRefractionMapping,X as CubeTexture,a as CubeUVReflectionMapping,je as CullFaceBack,Ze as CullFaceFront,qe as CullFaceNone,$e as CustomBlending,ee as CustomToneMapping,Y as Data3DTexture,W as DataArrayTexture,St as DepthFormat,vt as DepthStencilFormat,q as DepthTexture,fe as DoubleSide,ye as DstAlphaFactor,Ne as DstColorFactor,pt as EqualCompare,We as EqualDepth,R as EquirectangularReflectionMapping,A as EquirectangularRefractionMapping,u as Euler,vn as EventDispatcher,gn as ExternalTexture,T as FloatType,_ as FrontSide,ge as Frustum,Z as GLSL3,ut as GreaterCompare,ze as GreaterDepth,ft as GreaterEqualCompare,ke as GreaterEqualDepth,E as HalfFloatType,v as IntType,_e as Layers,mt as LessCompare,Xe as LessDepth,K as LessEqualCompare,Me as LessEqualDepth,B as LinearFilter,ot as LinearMipmapLinearFilter,st as LinearMipmapNearestFilter,F as LinearSRGBColorSpace,oe as LinearToneMapping,se as LinearTransfer,e as Matrix3,f as Matrix4,nt as MaxEquation,o as Mesh,w as MeshBasicMaterial,ve as MeshDepthMaterial,Se as MeshDistanceMaterial,tt as MinEquation,rt as MirroredRepeatWrapping,ce as MixOperation,Qe as MultiplyBlending,de as MultiplyOperation,Te as NearestFilter,lt as NearestMipmapLinearFilter,ct as NearestMipmapNearestFilter,te as NeutralToneMapping,_t as NeverCompare,Ke as NeverDepth,I as NoBlending,gt as NoColorSpace,D as NoToneMapping,pe as NormalBlending,dt as NotEqualCompare,Ve as NotEqualDepth,he as ObjectSpaceNormalMap,He as OneFactor,be as OneMinusConstantAlphaFactor,Le as OneMinusConstantColorFactor,Ue as OneMinusDstAlphaFactor,De as OneMinusDstColorFactor,we as OneMinusSrcAlphaFactor,Ie as OneMinusSrcColorFactor,P as OrthographicCamera,$ as PCFShadowMap,Q as PCFSoftShadowMap,Jn as PMREMGenerator,U as PerspectiveCamera,x as Plane,h as PlaneGeometry,hn as RED_GREEN_RGTC2_Format,pn as RED_RGTC1_Format,Rn as REVISION,Ee as RGBADepthPacking,M as RGBAFormat,Ft as RGBAIntegerFormat,sn as RGBA_ASTC_10x10_Format,rn as RGBA_ASTC_10x5_Format,an as RGBA_ASTC_10x6_Format,on as RGBA_ASTC_10x8_Format,ln as RGBA_ASTC_12x10_Format,cn as RGBA_ASTC_12x12_Format,jt as RGBA_ASTC_4x4_Format,Zt as RGBA_ASTC_5x4_Format,$t as RGBA_ASTC_5x5_Format,Qt as RGBA_ASTC_6x5_Format,Jt as RGBA_ASTC_6x6_Format,en as RGBA_ASTC_8x5_Format,tn as RGBA_ASTC_8x6_Format,nn as RGBA_ASTC_8x8_Format,dn as RGBA_BPTC_Format,qt as RGBA_ETC2_EAC_Format,Xt as RGBA_PVRTC_2BPPV1_Format,Wt as RGBA_PVRTC_4BPPV1_Format,Ht as RGBA_S3TC_DXT1_Format,Gt as RGBA_S3TC_DXT3_Format,Vt as RGBA_S3TC_DXT5_Format,wt as RGBFormat,un as RGB_BPTC_SIGNED_Format,fn as RGB_BPTC_UNSIGNED_Format,Yt as RGB_ETC1_Format,Kt as RGB_ETC2_Format,kt as RGB_PVRTC_2BPPV1_Format,zt as RGB_PVRTC_4BPPV1_Format,Bt as RGB_S3TC_DXT1_Format,Nt as RGFormat,Ot as RGIntegerFormat,It as RedFormat,yt as RedIntegerFormat,ae as ReinhardToneMapping,at as RepeatWrapping,xe as ReverseSubtractEquation,_n as SIGNED_RED_GREEN_RGTC2_Format,mn as SIGNED_RED_RGTC1_Format,xn as SRGBColorSpace,m as SRGBTransfer,Pn as ShaderChunk,Dn as ShaderLib,l as ShaderMaterial,Ut as ShortType,Fe as SrcAlphaFactor,Oe as SrcAlphaSaturateFactor,Be as SrcColorFactor,Re as SubtractEquation,Je as SubtractiveBlending,me as TangentSpaceNormalMap,j as Texture,V as Uint16BufferAttribute,G as Uint32BufferAttribute,Un as UniformsLib,ue as UniformsUtils,S as UnsignedByteType,Lt as UnsignedInt101111Type,Mt as UnsignedInt248Type,Ct as UnsignedInt5999Type,Tt as UnsignedIntType,At as UnsignedShort4444Type,bt as UnsignedShort5551Type,xt as UnsignedShortType,J as VSMShadowMap,t as Vector2,i as Vector3,k as Vector4,An as WebGLCoordinateSystem,b as WebGLCubeRenderTarget,y as WebGLRenderTarget,ca as WebGLRenderer,na as WebGLUtils,Sn as WebXRController,Ge as ZeroFactor,Mn as createCanvasElement};
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		// Use getUV context to avoid side effects from nodes overwriting getUV in the context (e.g. EnvironmentNode)
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		// Use getUV context to avoid side effects from nodes overwriting getUV in the context (e.g. EnvironmentNode)
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	setupEnvironment( /*builder*/ ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		const envNode = this.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js: * `BasicEnvironmentNode` is intended for non-PBR materials like {@link MeshBasicNodeMaterial}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:class BasicEnvironmentNode extends LightingNode {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		return 'BasicEnvironmentNode';
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js: * diffuse color. Environment mapping is supported. Used in {@link MeshBasicNodeMaterial}.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:const EnvironmentBRDF = /*@__PURE__*/ Fn( ( inputs ) => {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	const F = vec3( EnvironmentBRDF( { // n, v, specularColor, specularF90, roughness
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:			const clearcoatEnv = EnvironmentBRDF( {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js: * This class generates a Prefiltered, Mipmapped Radiance Environment Map
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js: * `EnvironmentNode` is intended for PBR materials like {@link MeshStandardNodeMaterial}.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:class EnvironmentNode extends LightingNode {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		return 'EnvironmentNode';
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * Overwritten since this type of material uses {@link EnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	 * @return {?EnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		let envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		return envNode ? new EnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		const environmentBlendMode = renderer.xr.getEnvironmentBlendMode();
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:				nodeBuilder.environmentNode = this.getEnvironmentNode( renderObject.scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	getEnvironmentNode( scene ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:		this.updateEnvironment( scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:			const environmentNode = this.getEnvironmentNode( scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	updateEnvironment( scene ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:	getEnvironmentBlendMode() {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.js:export { ACESFilmicToneMapping, AONode, AddEquation, AddOperation, AdditiveBlending, AgXToneMapping, AlphaFormat, AlwaysCompare, AlwaysDepth, AlwaysStencilFunc, AmbientLight, AmbientLightNode, AnalyticLightNode, ArrayCamera, ArrayElementNode, ArrayNode, AssignNode, AttributeNode, BackSide, BasicEnvironmentNode, BasicShadowMap, BatchNode, BitcastNode, BoxGeometry, BufferAttribute, BufferAttributeNode, BufferGeometry, BufferNode, BumpMapNode, BundleGroup, BypassNode, ByteType, CacheNode, Camera, CineonToneMapping, ClampToEdgeWrapping, ClippingGroup, CodeNode, Color, ColorManagement, ColorSpaceNode, ComputeNode, ConstNode, ContextNode, ConvertNode, CubeCamera, CubeReflectionMapping, CubeRefractionMapping, CubeTexture, CubeTextureNode, CubeUVReflectionMapping, CullFaceBack, CullFaceFront, CullFaceNone, CustomBlending, CylinderGeometry, DataArrayTexture, DataTexture, DebugNode, DecrementStencilOp, DecrementWrapStencilOp, DepthFormat, DepthStencilFormat, DepthTexture, DirectionalLight, DirectionalLightNode, DoubleSide, DstAlphaFactor, DstColorFactor, DynamicDrawUsage, EnvironmentNode, EqualCompare, EqualDepth, EqualStencilFunc, EquirectangularReflectionMapping, EquirectangularRefractionMapping, Euler, EventDispatcher, EventNode, ExpressionNode, FileLoader, Float16BufferAttribute, Float32BufferAttribute, FloatType, FramebufferTexture, FrontFacingNode, FrontSide, Frustum, FrustumArray, FunctionCallNode, FunctionNode, FunctionOverloadingNode, GLSLNodeParser, GreaterCompare, GreaterDepth, GreaterEqualCompare, GreaterEqualDepth, GreaterEqualStencilFunc, GreaterStencilFunc, Group, HalfFloatType, HemisphereLight, HemisphereLightNode, IESSpotLight, IESSpotLightNode, IncrementStencilOp, IncrementWrapStencilOp, IndexNode, IndirectStorageBufferAttribute, InstanceNode, InstancedBufferAttribute, InstancedInterleavedBuffer, InstancedMeshNode, IntType, InterleavedBuffer, InterleavedBufferAttribute, InvertStencilOp, IrradianceNode, JoinNode, KeepStencilOp, LessCompare, LessDepth, LessEqualCompare, LessEqualDepth, LessEqualStencilFunc, LessStencilFunc, LightProbe, LightProbeNode, Lighting, LightingContextNode, LightingModel, LightingNode, LightsNode, Line2NodeMaterial, LineBasicMaterial, LineBasicNodeMaterial, LineDashedMaterial, LineDashedNodeMaterial, LinearFilter, LinearMipMapLinearFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, LinearSRGBColorSpace, LinearToneMapping, LinearTransfer, Loader, LoopNode, MRTNode, Material, MaterialLoader, MaterialNode, MaterialReferenceNode, MathUtils, Matrix2, Matrix3, Matrix4, MaxEquation, MaxMipLevelNode, MemberNode, Mesh, MeshBasicMaterial, MeshBasicNodeMaterial, MeshLambertMaterial, MeshLambertNodeMaterial, MeshMatcapMaterial, MeshMatcapNodeMaterial, MeshNormalMaterial, MeshNormalNodeMaterial, MeshPhongMaterial, MeshPhongNodeMaterial, MeshPhysicalMaterial, MeshPhysicalNodeMaterial, MeshSSSNodeMaterial, MeshStandardMaterial, MeshStandardNodeMaterial, MeshToonMaterial, MeshToonNodeMaterial, MinEquation, MirroredRepeatWrapping, MixOperation, ModelNode, MorphNode, MultiplyBlending, MultiplyOperation, NearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, NeutralToneMapping, NeverCompare, NeverDepth, NeverStencilFunc, NoBlending, NoColorSpace, NoToneMapping, Node, NodeAccess, NodeAttribute, NodeBuilder, NodeCache, NodeCode, NodeFrame, NodeFunctionInput, NodeLoader, NodeMaterial, NodeMaterialLoader, NodeMaterialObserver, NodeObjectLoader, NodeShaderStage, NodeType, NodeUniform, NodeUpdateType, NodeUtils, NodeVar, NodeVarying, NormalBlending, NormalMapNode, NotEqualCompare, NotEqualDepth, NotEqualStencilFunc, Object3D, Object3DNode, ObjectLoader, ObjectSpaceNormalMap, OneFactor, OneMinusDstAlphaFactor, OneMinusDstColorFactor, OneMinusSrcAlphaFactor, OneMinusSrcColorFactor, OrthographicCamera, OutputStructNode, PCFShadowMap, PMREMGenerator, PMREMNode, ParameterNode, PassNode, PerspectiveCamera, PhongLightingModel, PhysicalLightingModel, Plane, PlaneGeometry, PointLight, PointLightNode, PointUVNode, PointsMaterial, PointsNodeMaterial, PostProcessing, PosterizeNode, ProjectorLight, ProjectorLightNode, PropertyNode, QuadMesh, Quaternion, RED_GREEN_RGTC2_Format, RED_RGTC1_Format, REVISION, RGBAFormat, RGBAIntegerFormat, RGBA_ASTC_10x10_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_BPTC_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGBFormat, RGBIntegerFormat, RGB_ETC1_Format, RGB_ETC2_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGB_S3TC_DXT1_Format, RGFormat, RGIntegerFormat, RTTNode, RangeNode, RectAreaLight, RectAreaLightNode, RedFormat, RedIntegerFormat, ReferenceNode, ReflectorNode, ReinhardToneMapping, RemapNode, RenderOutputNode, RenderTarget, RendererReferenceNode, RendererUtils, RepeatWrapping, ReplaceStencilOp, ReverseSubtractEquation, RotateNode, SIGNED_RED_GREEN_RGTC2_Format, SIGNED_RED_RGTC1_Format, SRGBColorSpace, SRGBTransfer, Scene, SceneNode, ScreenNode, ScriptableNode, ScriptableValueNode, SetNode, ShadowBaseNode, ShadowMaterial, ShadowNode, ShadowNodeMaterial, ShortType, SkinningNode, Sphere, SphereGeometry, SplitNode, SpotLight, SpotLightNode, SpriteMaterial, SpriteNodeMaterial, SpriteSheetUVNode, SrcAlphaFactor, SrcAlphaSaturateFactor, SrcColorFactor, StackNode, StaticDrawUsage, Storage3DTexture, StorageArrayElementNode, StorageArrayTexture, StorageBufferAttribute, StorageBufferNode, StorageInstancedBufferAttribute, StorageTexture, StorageTextureNode, StructNode, StructTypeNode, SubBuildNode, SubtractEquation, SubtractiveBlending, TSL, TangentSpaceNormalMap, TempNode, Texture, Texture3DNode, TextureNode, TextureSizeNode, TimestampQuery, ToneMappingNode, ToonOutlinePassNode, UVMapping, Uint16BufferAttribute, Uint32BufferAttribute, UniformArrayNode, UniformGroupNode, UniformNode, UnsignedByteType, UnsignedInt101111Type, UnsignedInt248Type, UnsignedInt5999Type, UnsignedIntType, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedShortType, UserDataNode, VSMShadowMap, VarNode, VaryingNode, Vector2, Vector3, Vector4, VertexColorNode, ViewportDepthNode, ViewportDepthTextureNode, ViewportSharedTextureNode, ViewportTextureNode, VolumeNodeMaterial, WebGLCoordinateSystem, WebGLCubeRenderTarget, WebGPUCoordinateSystem, WebGPURenderer, WebXRController, ZeroFactor, ZeroStencilOp, createCanvasElement, defaultBuildStages, defaultShaderStages, shaderStages, vectorComponents };
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.min.js:import{Color as e,Vector2 as t,Vector3 as r,Vector4 as s,Matrix2 as i,Matrix3 as n,Matrix4 as a,EventDispatcher as o,MathUtils as u,WebGLCoordinateSystem as l,WebGPUCoordinateSystem as d,ColorManagement as c,SRGBTransfer as h,NoToneMapping as p,StaticDrawUsage as g,InterleavedBuffer as m,InterleavedBufferAttribute as f,DynamicDrawUsage as y,NoColorSpace as b,Texture as x,UnsignedIntType as T,IntType as _,NearestFilter as v,Sphere as N,BackSide as S,DoubleSide as E,Euler as R,CubeTexture as A,CubeReflectionMapping as w,CubeRefractionMapping as C,TangentSpaceNormalMap as M,ObjectSpaceNormalMap as P,InstancedInterleavedBuffer as B,InstancedBufferAttribute as L,DataArrayTexture as F,FloatType as I,FramebufferTexture as D,LinearMipmapLinearFilter as U,DepthTexture as V,Material as O,NormalBlending as G,LineBasicMaterial as k,LineDashedMaterial as z,NoBlending as $,MeshNormalMaterial as H,SRGBColorSpace as W,WebGLCubeRenderTarget as q,BoxGeometry as j,Mesh as X,Scene as K,LinearFilter as Y,CubeCamera as Q,EquirectangularReflectionMapping as Z,EquirectangularRefractionMapping as J,AddOperation as ee,MixOperation as te,MultiplyOperation as re,MeshBasicMaterial as se,MeshLambertMaterial as ie,MeshPhongMaterial as ne,OrthographicCamera as ae,PerspectiveCamera as oe,RenderTarget as ue,LinearSRGBColorSpace as le,RGBAFormat as de,HalfFloatType as ce,CubeUVReflectionMapping as he,BufferGeometry as pe,BufferAttribute as ge,MeshStandardMaterial as me,MeshPhysicalMaterial as fe,MeshToonMaterial as ye,MeshMatcapMaterial as be,SpriteMaterial as xe,PointsMaterial as Te,ShadowMaterial as _e,Uint32BufferAttribute as ve,Uint16BufferAttribute as Ne,arrayNeedsUint32 as Se,Camera as Ee,DepthStencilFormat as Re,DepthFormat as Ae,UnsignedInt248Type as we,UnsignedByteType as Ce,Plane as Me,Object3D as Pe,warnOnce as Be,LinearMipMapLinearFilter as Le,Float32BufferAttribute as Fe,UVMapping as Ie,VSMShadowMap as De,LessCompare as Ue,RGFormat as Ve,BasicShadowMap as Oe,SphereGeometry as Ge,LinearMipmapNearestFilter as ke,NearestMipmapLinearFilter as ze,Float16BufferAttribute as $e,REVISION as He,ArrayCamera as We,PlaneGeometry as qe,FrontSide as je,CustomBlending as Xe,AddEquation as Ke,ZeroFactor as Ye,CylinderGeometry as Qe,Quaternion as Ze,WebXRController as Je,RAD2DEG as et,PCFShadowMap as tt,FrustumArray as rt,Frustum as st,DataTexture as it,RedIntegerFormat as nt,RedFormat as at,ShortType as ot,ByteType as ut,UnsignedShortType as lt,RGIntegerFormat as dt,RGBIntegerFormat as ct,RGBFormat as ht,RGBAIntegerFormat as pt,createCanvasElement as gt,ReverseSubtractEquation as mt,SubtractEquation as ft,OneMinusDstAlphaFactor as yt,OneMinusDstColorFactor as bt,OneMinusSrcAlphaFactor as xt,OneMinusSrcColorFactor as Tt,DstAlphaFactor as _t,DstColorFactor as vt,SrcAlphaSaturateFactor as Nt,SrcAlphaFactor as St,SrcColorFactor as Et,OneFactor as Rt,CullFaceNone as At,CullFaceBack as wt,CullFaceFront as Ct,MultiplyBlending as Mt,SubtractiveBlending as Pt,AdditiveBlending as Bt,NotEqualDepth as Lt,GreaterDepth as Ft,GreaterEqualDepth as It,EqualDepth as Dt,LessEqualDepth as Ut,LessDepth as Vt,AlwaysDepth as Ot,NeverDepth as Gt,UnsignedShort4444Type as kt,UnsignedShort5551Type as zt,UnsignedInt5999Type as $t,UnsignedInt101111Type as Ht,AlphaFormat as Wt,RGB_S3TC_DXT1_Format as qt,RGBA_S3TC_DXT1_Format as jt,RGBA_S3TC_DXT3_Format as Xt,RGBA_S3TC_DXT5_Format as Kt,RGB_PVRTC_4BPPV1_Format as Yt,RGB_PVRTC_2BPPV1_Format as Qt,RGBA_PVRTC_4BPPV1_Format as Zt,RGBA_PVRTC_2BPPV1_Format as Jt,RGB_ETC1_Format as er,RGB_ETC2_Format as tr,RGBA_ETC2_EAC_Format as rr,RGBA_ASTC_4x4_Format as sr,RGBA_ASTC_5x4_Format as ir,RGBA_ASTC_5x5_Format as nr,RGBA_ASTC_6x5_Format as ar,RGBA_ASTC_6x6_Format as or,RGBA_ASTC_8x5_Format as ur,RGBA_ASTC_8x6_Format as lr,RGBA_ASTC_8x8_Format as dr,RGBA_ASTC_10x5_Format as cr,RGBA_ASTC_10x6_Format as hr,RGBA_ASTC_10x8_Format as pr,RGBA_ASTC_10x10_Format as gr,RGBA_ASTC_12x10_Format as mr,RGBA_ASTC_12x12_Format as fr,RGBA_BPTC_Format as yr,RED_RGTC1_Format as br,SIGNED_RED_RGTC1_Format as xr,RED_GREEN_RGTC2_Format as Tr,SIGNED_RED_GREEN_RGTC2_Format as _r,MirroredRepeatWrapping as vr,ClampToEdgeWrapping as Nr,RepeatWrapping as Sr,NearestMipmapNearestFilter as Er,NotEqualCompare as Rr,GreaterCompare as Ar,GreaterEqualCompare as wr,EqualCompare as Cr,LessEqualCompare as Mr,AlwaysCompare as Pr,NeverCompare as Br,LinearTransfer as Lr,getByteLength as Fr,TimestampQuery as Ir,NotEqualStencilFunc as Dr,GreaterStencilFunc as Ur,GreaterEqualStencilFunc as Vr,EqualStencilFunc as Or,LessEqualStencilFunc as Gr,LessStencilFunc as kr,AlwaysStencilFunc as zr,NeverStencilFunc as $r,DecrementWrapStencilOp as Hr,IncrementWrapStencilOp as Wr,DecrementStencilOp as qr,IncrementStencilOp as jr,InvertStencilOp as Xr,ReplaceStencilOp as Kr,ZeroStencilOp as Yr,KeepStencilOp as Qr,MaxEquation as Zr,MinEquation as Jr,SpotLight as es,PointLight as ts,DirectionalLight as rs,RectAreaLight as ss,AmbientLight as is,HemisphereLight as ns,LightProbe as as,LinearToneMapping as os,ReinhardToneMapping as us,CineonToneMapping as ls,ACESFilmicToneMapping as ds,AgXToneMapping as cs,NeutralToneMapping as hs,Group as ps,Loader as gs,FileLoader as ms,MaterialLoader as fs,ObjectLoader as ys}from"./three.core.min.js";export{AdditiveAnimationBlendMode,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BasicDepthPacking,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxHelper,BufferGeometryLoader,Cache,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CircleGeometry,Clock,ColorKeyframeTrack,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,Controls,CubeTextureLoader,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceFrontBack,Curve,CurvePath,CustomToneMapping,Cylindrical,Data3DTexture,DataTextureLoader,DataUtils,DefaultLoadingManager,DetachedBindMode,DirectionalLightHelper,DiscreteInterpolant,DodecahedronGeometry,DynamicCopyUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,ExternalTexture,ExtrudeGeometry,Fog,FogExp2,GLBufferAttribute,GLSL1,GLSL3,GridHelper,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,InstancedBufferGeometry,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InterpolationSamplingMode,InterpolationSamplingType,KeyframeTrack,LOD,LatheGeometry,Layers,Light,Line,Line3,LineCurve,LineCurve3,LineLoop,LineSegments,LinearInterpolant,LinearMipMapNearestFilter,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,MOUSE,MeshDepthMaterial,MeshDistanceMaterial,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NormalAnimationBlendMode,NumberKeyframeTrack,OctahedronGeometry,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,PCFSoftShadowMap,Path,PlaneHelper,PointLightHelper,Points,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RGBADepthPacking,RGBDepthPacking,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGDepthPacking,RawShaderMaterial,Ray,Raycaster,RenderTarget3D,RingGeometry,ShaderMaterial,Shape,ShapeGeometry,ShapePath,ShapeUtils,Skeleton,SkeletonHelper,SkinnedMesh,Source,Spherical,SphericalHarmonics3,SplineCurve,SpotLightHelper,Sprite,StaticCopyUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,TOUCH,TetrahedronGeometry,TextureLoader,TextureUtils,Timer,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,VectorKeyframeTrack,VideoFrameTexture,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLRenderTarget,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroSlopeEnding}from"./three.core.min.js";const bs=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],xs=new WeakMap;class Ts{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=!0===e.object.isSkinnedMesh,this.refreshUniforms=bs,this.renderId=0}firstInitialization(e){return!1===this.renderObjects.has(e)&&(this.getRenderObjectData(e),!0)}needsVelocity(e){const t=e.getMRT();return null!==t&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(void 0===t){const{geometry:r,material:s,object:i}=e;if(t={material:this.getMaterialData(s),geometry:{id:r.id,attributes:this.getAttributesData(r.attributes),indexVersion:r.index?r.index.version:null,drawRange:{start:r.drawRange.start,count:r.drawRange.count}},worldMatrix:i.matrixWorld.clone()},i.center&&(t.center=i.center.clone()),i.morphTargetInfluences&&(t.morphTargetInfluences=i.morphTargetInfluences.slice()),null!==e.bundle&&(t.version=e.bundle.version),t.material.transmission>0){const{width:r,height:s}=e.context;t.bufferWidth=r,t.bufferHeight=s}t.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const r in e){const s=e[r];t[r]={version:s.version}}return t}containsNode(e){const t=e.material;for(const e in t)if(t[e]&&t[e].isNode)return!0;return null!==e.renderer.overrideNodes.modelViewMatrix||null!==e.renderer.overrideNodes.modelNormalViewMatrix}getMaterialData(e){const t={};for(const r of this.refreshUniforms){const s=e[r];null!=s&&("object"==typeof s&&void 0!==s.clone?!0===s.isTexture?t[r]={id:s.id,version:s.version}:t[r]=s.clone():t[r]=s)}return t}equals(e,t){const{object:r,material:s,geometry:i}=e,n=this.getRenderObjectData(e);if(!0!==n.worldMatrix.equals(r.matrixWorld))return n.worldMatrix.copy(r.matrixWorld),!1;const a=n.material;for(const e in a){const t=a[e],r=s[e];if(void 0!==t.equals){if(!1===t.equals(r))return t.copy(r),!1}else if(!0===r.isTexture){if(t.id!==r.id||t.version!==r.version)return t.id=r.id,t.version=r.version,!1}else if(t!==r)return a[e]=r,!1}if(a.transmission>0){const{width:t,height:r}=e.context;if(n.bufferWidth!==t||n.bufferHeight!==r)return n.bufferWidth=t,n.bufferHeight=r,!1}const o=n.geometry,u=i.attributes,l=o.attributes,d=Object.keys(l),c=Object.keys(u);if(o.id!==i.id)return o.id=i.id,!1;if(d.length!==c.length)return n.geometry.attributes=this.getAttributesData(u),!1;for(const e of d){const t=l[e],r=u[e];if(void 0===r)return delete l[e],!1;if(t.version!==r.version)return t.version=r.version,!1}const h=i.index,p=o.indexVersion,g=h?h.version:null;if(p!==g)return o.indexVersion=g,!1;if(o.drawRange.start!==i.drawRange.start||o.drawRange.count!==i.drawRange.count)return o.drawRange.start=i.drawRange.start,o.drawRange.count=i.drawRange.count,!1;if(n.morphTargetInfluences){let e=!1;for(let t=0;t<n.morphTargetInfluences.length;t++)n.morphTargetInfluences[t]!==r.morphTargetInfluences[t]&&(e=!0);if(e)return!0}if(n.lights)for(let e=0;e<t.length;e++)if(n.lights[e].map!==t[e].map)return!1;return n.center&&!1===n.center.equals(r.center)?(n.center.copy(r.center),!0):(null!==e.bundle&&(n.version=e.bundle.version),!0)}getLightsData(e){const t=[];for(const r of e)!0===r.isSpotLight&&null!==r.map&&t.push({map:r.map.version});return t}getLights(e,t){if(xs.has(e)){const r=xs.get(e);if(r.renderId===t)return r.lightsData}const r=this.getLightsData(e.getLights());return xs.set(e,{renderId:t,lightsData:r}),r}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:r}=t;if(this.renderId!==r)return this.renderId=r,!0;const s=!0===e.object.static,i=null!==e.bundle&&!0===e.bundle.static&&this.getRenderObjectData(e).version===e.bundle.version;if(s||i)return!1;const n=this.getLights(e.lightsNode,r);return!0!==this.equals(e,n)}}function _s(e,t=0){let r=3735928559^t,s=1103547991^t;if(e instanceof Array)for(let t,i=0;i<e.length;i++)t=e[i],r=Math.imul(r^t,2654435761),s=Math.imul(s^t,1597334677);else for(let t,i=0;i<e.length;i++)t=e.charCodeAt(i),r=Math.imul(r^t,2654435761),s=Math.imul(s^t,1597334677);return r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507),s^=Math.imul(r^r>>>13,3266489909),4294967296*(2097151&s)+(r>>>0)}const vs=e=>_s(e),Ns=e=>_s(e),Ss=(...e)=>_s(e);function Es(e,t=!1){const r=[];!0===e.isNode&&r.push(e.id);for(const{property:s,childNode:i}of Rs(e))r.push(_s(s.slice(0,-4)),i.getCacheKey(t));return _s(r)}function*Rs(e,t=!1){for(const r of Object.getOwnPropertyNames(e)){if(!0===r.startsWith("_"))continue;const s=e[r];if(!0===Array.isArray(s))for(let e=0;e<s.length;e++){const i=s[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:r,index:e,childNode:i})}else if(s&&!0===s.isNode)yield{property:r,childNode:s};else if(s&&Object.getPrototypeOf(s)===Object.prototype)for(const e in s){if(!0===e.startsWith("_"))continue;const i=s[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:r,index:e,childNode:i})}}}const As=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),ws=new WeakMap;function Cs(e){return As.get(e)}function Ms(e){if(/[iu]?vec\d/.test(e))return e.startsWith("ivec")?Int32Array:e.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(e))return Float32Array;if(/float/.test(e))return Float32Array;if(/uint/.test(e))return Uint32Array;if(/int/.test(e))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${e}`)}function Ps(e){return/float|int|uint/.test(e)?1:/vec2/.test(e)?2:/vec3/.test(e)?3:/vec4/.test(e)||/mat2/.test(e)?4:/mat3/.test(e)?9:/mat4/.test(e)?16:void console.error("THREE.TSL: Unsupported type:",e)}function Bs(e){return/float|int|uint/.test(e)?1:/vec2/.test(e)?2:/vec3/.test(e)?3:/vec4/.test(e)||/mat2/.test(e)?4:/mat3/.test(e)?12:/mat4/.test(e)?16:void console.error("THREE.TSL: Unsupported type:",e)}function Ls(e){return/float|int|uint/.test(e)?4:/vec2/.test(e)?8:/vec3/.test(e)||/vec4/.test(e)?16:/mat2/.test(e)?8:/mat3/.test(e)?48:/mat4/.test(e)?64:void console.error("THREE.TSL: Unsupported type:",e)}function Fs(e){if(null==e)return null;const t=typeof e;return!0===e.isNode?"node":"number"===t?"float":"boolean"===t?"bool":"string"===t?"string":"function"===t?"shader":!0===e.isVector2?"vec2":!0===e.isVector3?"vec3":!0===e.isVector4?"vec4":!0===e.isMatrix2?"mat2":!0===e.isMatrix3?"mat3":!0===e.isMatrix4?"mat4":!0===e.isColor?"color":e instanceof ArrayBuffer?"ArrayBuffer":null}function Is(o,...u){const l=o?o.slice(-4):void 0;return 1===u.length&&("vec2"===l?u=[u[0],u[0]]:"vec3"===l?u=[u[0],u[0],u[0]]:"vec4"===l&&(u=[u[0],u[0],u[0],u[0]])),"color"===o?new e(...u):"vec2"===l?new t(...u):"vec3"===l?new r(...u):"vec4"===l?new s(...u):"mat2"===l?new i(...u):"mat3"===l?new n(...u):"mat4"===l?new a(...u):"bool"===o?u[0]||!1:"float"===o||"int"===o||"uint"===o?u[0]||0:"string"===o?u[0]||"":"ArrayBuffer"===o?Vs(u[0]):null}function Ds(e){let t=ws.get(e);return void 0===t&&(t={},ws.set(e,t)),t}function Us(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return btoa(t)}function Vs(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0)).buffer}var Os=Object.freeze({__proto__:null,arrayBufferToBase64:Us,base64ToArrayBuffer:Vs,getByteBoundaryFromType:Ls,getCacheKey:Es,getDataFromObject:Ds,getLengthFromType:Ps,getMemoryLengthFromType:Bs,getNodeChildren:Rs,getTypeFromLength:Cs,getTypedArrayFromType:Ms,getValueFromType:Is,getValueType:Fs,hash:Ss,hashArray:Ns,hashString:vs});const Gs={VERTEX:"vertex",FRAGMENT:"fragment"},ks={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},zs={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},$s={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},Hs=["fragment","vertex"],Ws=["setup","analyze","generate"],qs=[...Hs,"compute"],js=["x","y","z","w"],Xs={analyze:"setup",generate:"analyze"};let Ks=0;class Ys extends o{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=ks.NONE,this.updateBeforeType=ks.NONE,this.updateAfterType=ks.NONE,this.uuid=u.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:Ks++})}set needsUpdate(e){!0===e&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,ks.FRAME)}onRenderUpdate(e){return this.onUpdate(e,ks.RENDER)}onObjectUpdate(e){return this.onUpdate(e,ks.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of Rs(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return!0!==(e=e||this.version!==this._cacheKeyVersion)&&null!==this._cacheKey||(this._cacheKey=Ss(Es(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){const t=e.getNodeProperties(this);let r=0;for(const e of this.getChildren())t["node"+r++]=e;return t.outputNode||null}analyze(e,t=null){const r=e.increaseUsage(this);if(!0===this.parents){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(1===r){const t=e.getNodeProperties(this);for(const r of Object.values(t))r&&!0===r.isNode&&r.build(e,this)}}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);if(r&&!0===r.isNode)return r.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const r=this.getShared(e);if(this!==r)return r.build(e,t);const s=e.getDataFromNode(this);s.buildStages=s.buildStages||{},s.buildStages[e.buildStage]=!0;const i=Xs[e.buildStage];if(i&&!0!==s.buildStages[i]){const t=e.getBuildStage();e.setBuildStage(i),this.build(e),e.setBuildStage(t)}e.addNode(this),e.addChain(this);let n=null;const a=e.getBuildStage();if("setup"===a){this.updateReference(e);const t=e.getNodeProperties(this);if(!0!==t.initialized){t.initialized=!0,t.outputNode=this.setup(e)||t.outputNode||null;for(const r of Object.values(t))if(r&&!0===r.isNode){if(!0===r.parents){const t=e.getNodeProperties(r);t.parents=t.parents||[],t.parents.push(this)}r.build(e)}}n=t.outputNode}else if("analyze"===a)this.analyze(e,t);else if("generate"===a){if(1===this.generate.length){const r=this.getNodeType(e),s=e.getDataFromNode(this);n=s.snippet,void 0===n?void 0===s.generated?(s.generated=!0,n=this.generate(e)||"",s.snippet=n):(console.warn("THREE.Node: Recursion detected.",this),n="/* Recursion detected. */"):void 0!==s.flowCodes&&void 0!==e.context.nodeBlock&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),n=e.format(n,r,t)}else n=this.generate(e,t)||"";""===n&&null!==t&&"void"!==t&&"OutputType"!==t&&(console.error(`THREE.TSL: Invalid generated code, expected a "${t}".`),n=e.generateConst(t))}return e.removeChain(this),e.addSequentialNode(this),n}getSerializeChildren(){return Rs(this)}serialize(e){const t=this.getSerializeChildren(),r={};for(const{property:s,index:i,childNode:n}of t)void 0!==i?(void 0===r[s]&&(r[s]=Number.isInteger(i)?[]:{}),r[s][i]=n.toJSON(e.meta).uuid):r[s]=n.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(void 0!==e.inputNodes){const t=e.meta.nodes;for(const r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){const s=[];for(const i of e.inputNodes[r])s.push(t[i]);this[r]=s}else if("object"==typeof e.inputNodes[r]){const s={};for(const i in e.inputNodes[r]){const n=e.inputNodes[r][i];s[i]=t[n]}this[r]=s}else{const s=e.inputNodes[r];this[r]=t[s]}}}toJSON(e){const{uuid:t,type:r}=this,s=void 0===e||"string"==typeof e;s&&(e={textures:{},images:{},nodes:{}});let i=e.nodes[t];function n(e){const t=[];for(const r in e){const s=e[r];delete s.metadata,t.push(s)}return t}if(void 0===i&&(i={uuid:t,type:r,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},!0!==s&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta),s){const t=n(e.textures),r=n(e.images),s=n(e.nodes);t.length>0&&(i.textures=t),r.length>0&&(i.images=r),s.length>0&&(i.nodes=s)}return i}}class Qs extends Ys{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e);return`${this.node.build(e)}[ ${this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint")} ]`}}class Zs extends Ys{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let r=null;for(const s of this.convertTo.split("|"))null!==r&&e.getTypeLength(t)!==e.getTypeLength(s)||(r=s);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const r=this.node,s=this.getNodeType(e),i=r.build(e,s);return e.format(i,s,t)}}class Js extends Ys{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if("generate"===e.getBuildStage()){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(void 0!==s.propertyName)return e.format(s.propertyName,r,t);if("void"!==r&&"void"!==t&&this.hasDependencies(e)){const i=super.build(e,r),n=e.getVarFromNode(this,null,r),a=e.getPropertyName(n);return e.addLineFlowCode(`${a} = ${i}`,this),s.snippet=i,s.propertyName=a,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class ei extends Js{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,r)=>t+e.getTypeLength(r.getNodeType(e)),0))}generate(e,t){const r=this.getNodeType(e),s=e.getTypeLength(r),i=this.nodes,n=e.getComponentType(r),a=[];let o=0;for(const t of i){if(o>=s){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${r}()' type.`);break}let i,u=t.getNodeType(e),l=e.getTypeLength(u);o+l>s&&(console.error(`THREE.TSL: Length of '${r}()' data exceeds maximum length of output type.`),l=s-o,u=e.getTypeFromLength(l)),o+=l,i=t.build(e,u);if(e.getComponentType(u)!==n){const t=e.getTypeFromLength(l,n);i=e.format(i,u,t)}a.push(i)}const u=`${e.getType(r)}( ${a.join(", ")} )`;return e.format(u,r,t)}}const ti=js.join("");class ri extends Ys{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(js.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){const r=this.node,s=e.getTypeLength(r.getNodeType(e));let i=null;if(s>1){let n=null;this.getVectorLength()>=s&&(n=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const a=r.build(e,n);i=this.components.length===s&&this.components===ti.slice(0,this.components.length)?e.format(a,n,t):e.format(`${a}.${this.components}`,this.getNodeType(e),t)}else i=r.build(e,t);return i}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class si extends Js{static get type(){return"SetNode"}constructor(e,t,r){super(),this.sourceNode=e,this.components=t,this.targetNode=r}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:r,targetNode:s}=this,i=this.getNodeType(e),n=e.getComponentType(s.getNodeType(e)),a=e.getTypeFromLength(r.length,n),o=s.build(e,a),u=t.build(e,i),l=e.getTypeLength(i),d=[];for(let e=0;e<l;e++){const t=js[e];t===r[0]?(d.push(o),e+=r.length-1):d.push(u+"."+t)}return`${e.getType(i)}( ${d.join(", ")} )`}}class ii extends Js{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:r}=this,s=this.getNodeType(e),i=r.build(e),n=e.getVarFromNode(this),a=e.getPropertyName(n);e.addLineFlowCode(a+" = "+i,this);const o=e.getTypeLength(s),u=[];let l=0;for(let e=0;e<o;e++){const r=js[e];r===t[l]?(u.push("1.0 - "+a+"."+r),l++):u.push(a+"."+r)}return`${e.getType(s)}( ${u.join(", ")} )`}}class ni extends Ys{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return null===this.nodeType?Fs(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Fs(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=Us(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?Is(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const ai=/float|u?int/;class oi extends ni{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const r=this.getNodeType(e);return ai.test(r)&&ai.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),r,t)}}class ui extends Ys{static get type(){return"MemberNode"}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}hasMember(e){return(!this.structNode.isMemberNode||!1!==this.structNode.hasMember(e))&&"void"!==this.structNode.getMemberType(e,this.property)}getNodeType(e){return!1===this.hasMember(e)?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(!1===this.hasMember(e))return"float";const r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}generate(e){if(!1===this.hasMember(e)){console.warn(`THREE.TSL: Member "${this.property}" does not exist in struct.`);const t=this.getNodeType(e);return e.generateConst(t)}return this.structNode.build(e)+"."+this.property}}let li=null;const di=new Map;function ci(e,t){if(di.has(e))console.warn(`THREE.TSL: Redefinition of method chaining '${e}'.`);else{if("function"!=typeof t)throw new Error(`THREE.TSL: Node element ${e} is not a function`);di.set(e,t),"assign"!==e&&(Ys.prototype[e]=function(...e){return this.isStackNode?this.add(t(...e)):t(this,...e)},Ys.prototype[e+"Assign"]=function(...e){return this.isStackNode?this.assign(e[0],t(...e)):this.assign(t(this,...e))})}}const hi=e=>(e=>e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"))(e).split("").sort().join("");Ys.prototype.assign=function(...e){if(!0!==this.isStackNode)return null!==li?li.assign(this,...e):console.error("THREE.TSL: No stack defined for assign operation. Make sure the assign is inside a Fn()."),this;{const t=di.get("assign");return this.add(t(...e))}},Ys.prototype.toVarIntent=function(){return this},Ys.prototype.get=function(e){return new ui(this,e)};const pi={};function gi(e,t,r){pi[e]=pi[t]=pi[r]={get(){this._cache=this._cache||{};let t=this._cache[e];return void 0===t&&(t=new ri(this,e),this._cache[e]=t),t},set(t){this[e].assign(Gi(t))}};const s=e.toUpperCase(),i=t.toUpperCase(),n=r.toUpperCase();Ys.prototype["set"+s]=Ys.prototype["set"+i]=Ys.prototype["set"+n]=function(t){const r=hi(e);return new si(this,r,Gi(t))},Ys.prototype["flip"+s]=Ys.prototype["flip"+i]=Ys.prototype["flip"+n]=function(){const t=hi(e);return new ii(this,t)}}const mi=["x","y","z","w"],fi=["r","g","b","a"],yi=["s","t","p","q"];for(let e=0;e<4;e++){let t=mi[e],r=fi[e],s=yi[e];gi(t,r,s);for(let i=0;i<4;i++){t=mi[e]+mi[i],r=fi[e]+fi[i],s=yi[e]+yi[i],gi(t,r,s);for(let n=0;n<4;n++){t=mi[e]+mi[i]+mi[n],r=fi[e]+fi[i]+fi[n],s=yi[e]+yi[i]+yi[n],gi(t,r,s);for(let a=0;a<4;a++)t=mi[e]+mi[i]+mi[n]+mi[a],r=fi[e]+fi[i]+fi[n]+fi[a],s=yi[e]+yi[i]+yi[n]+yi[a],gi(t,r,s)}}}for(let e=0;e<32;e++)pi[e]={get(){this._cache=this._cache||{};let t=this._cache[e];return void 0===t&&(t=new Qs(this,new oi(e,"uint")),this._cache[e]=t),t},set(t){this[e].assign(Gi(t))}};Object.defineProperties(Ys.prototype,pi);const bi=new WeakMap,xi=function(e,t=null){for(const r in e)e[r]=Gi(e[r],t);return e},Ti=function(e,t=null){const r=e.length;for(let s=0;s<r;s++)e[s]=Gi(e[s],t);return e},_i=function(e,t=null,r=null,s=null){function i(e){return null!==s?(e=Gi(Object.assign(e,s)),!0===s.intent&&(e=e.toVarIntent())):e=Gi(e),e}let n,a,o,u=t;function l(t){let r;return r=u?/[a-z]/i.test(u)?u+"()":u:e.type,void 0!==a&&t.length<a?(console.error(`THREE.TSL: "${r}" parameter length is less than minimum required.`),t.concat(new Array(a-t.length).fill(0))):void 0!==o&&t.length>o?(console.error(`THREE.TSL: "${r}" parameter length exceeds limit.`),t.slice(0,o)):t}return null===t?n=(...t)=>i(new e(...$i(l(t)))):null!==r?(r=Gi(r),n=(...s)=>i(new e(t,...$i(l(s)),r))):n=(...r)=>i(new e(t,...$i(l(r)))),n.setParameterLength=(...e)=>(1===e.length?a=o=e[0]:2===e.length&&([a,o]=e),n),n.setName=e=>(u=e,n),n},vi=function(e,...t){return Gi(new e(...$i(t)))};class Ni extends Ys{constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,rawInputs:r}=this,s=e.getNodeProperties(t),i=e.getClosestSubBuild(t.subBuilds)||"",n=i||"default";if(s[n])return s[n];const a=e.subBuildFn;e.subBuildFn=i;let o=null;if(t.layout){let s=bi.get(e.constructor);void 0===s&&(s=new WeakMap,bi.set(e.constructor,s));let i=s.get(t);void 0===i&&(i=Gi(e.buildFunctionNode(t)),s.set(t,i)),e.addInclude(i);const n=r?function(e){let t;zi(e);t=e[0]&&(e[0].isNode||Object.getPrototypeOf(e[0])!==Object.prototype)?[...e]:e[0];return t}(r):null;o=Gi(i.call(n))}else{const s=new Proxy(e,{get:(e,t,r)=>{let s;return s=Symbol.iterator===t?function*(){yield}:Reflect.get(e,t,r),s}}),i=r?function(e){let t=0;return zi(e),new Proxy(e,{get:(r,s,i)=>{let n;if("length"===s)return n=e.length,n;if(Symbol.iterator===s)n=function*(){for(const t of e)yield Gi(t)};else{if(e.length>0)if(Object.getPrototypeOf(e[0])===Object.prototype){const r=e[0];n=void 0===r[s]?r[t++]:Reflect.get(r,s,i)}else e[0]instanceof Ys&&(n=void 0===e[s]?e[t++]:Reflect.get(e,s,i));else n=Reflect.get(r,s,i);n=Gi(n)}return n}})}(r):null,n=Array.isArray(r)?r.length>0:null!==r,a=t.jsFunc,u=n||a.length>1?a(i,s):a(s);o=Gi(u)}return e.subBuildFn=a,t.once&&(s[n]=o),o}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),r=e.getSubBuildOutput(this);return t[r]=t[r]||this.setupOutput(e),t[r].subBuild=e.getClosestSubBuild(this),t[r]}build(e,t=null){let r=null;const s=e.getBuildStage(),i=e.getNodeProperties(this),n=e.getSubBuildOutput(this),a=this.getOutputNode(e);if("setup"===s){const t=e.getSubBuildProperty("initialized",this);if(!0!==i[t]&&(i[t]=!0,i[n]=this.getOutputNode(e),i[n].build(e),this.shaderNode.subBuilds))for(const t of e.chaining){const r=e.getDataFromNode(t,"any");r.subBuilds=r.subBuilds||new Set;for(const e of this.shaderNode.subBuilds)r.subBuilds.add(e)}r=i[n]}else"analyze"===s?a.build(e,t):"generate"===s&&(r=a.build(e,t)||"");return r}}class Si extends Ys{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return Gi(new Ni(this,e))}setup(){return this.call()}}const Ei=[!1,!0],Ri=[0,1,2,3],Ai=[-1,-2],wi=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],Ci=new Map;for(const e of Ei)Ci.set(e,new oi(e));const Mi=new Map;for(const e of Ri)Mi.set(e,new oi(e,"uint"));const Pi=new Map([...Mi].map(e=>new oi(e.value,"int")));for(const e of Ai)Pi.set(e,new oi(e,"int"));const Bi=new Map([...Pi].map(e=>new oi(e.value)));for(const e of wi)Bi.set(e,new oi(e));for(const e of wi)Bi.set(-e,new oi(-e));const Li={bool:Ci,uint:Mi,ints:Pi,float:Bi},Fi=new Map([...Ci,...Bi]),Ii=(e,t)=>Fi.has(e)?Fi.get(e):!0===e.isNode?e:new oi(e,t),Di=function(e,t=null){return(...r)=>{for(const t of r)if(void 0===t)return console.error(`THREE.TSL: Invalid parameter for the type "${e}".`),Gi(new oi(0,e));if((0===r.length||!["bool","float","int","uint"].includes(e)&&r.every(e=>{const t=typeof e;return"object"!==t&&"function"!==t}))&&(r=[Is(e,...r)]),1===r.length&&null!==t&&t.has(r[0]))return ki(t.get(r[0]));if(1===r.length){const t=Ii(r[0],e);return t.nodeType===e?ki(t):ki(new Zs(t,e))}const s=r.map(e=>Ii(e));return ki(new ei(s,e))}},Ui=e=>"object"==typeof e&&null!==e?e.value:e,Vi=e=>null!=e?e.nodeType||e.convertTo||("string"==typeof e?e:null):null;function Oi(e,t){return new Si(e,t)}const Gi=(e,t=null)=>function(e,t=null){const r=Fs(e);return"node"===r?e:null===t&&("float"===r||"boolean"===r)||r&&"shader"!==r&&"string"!==r?Gi(Ii(e,t)):"shader"===r?e.isFn?e:Ki(e):e}(e,t),ki=(e,t=null)=>Gi(e,t).toVarIntent(),zi=(e,t=null)=>new xi(e,t),$i=(e,t=null)=>new Ti(e,t),Hi=(e,t=null,r=null,s=null)=>new _i(e,t,r,s),Wi=(e,...t)=>new vi(e,...t),qi=(e,t=null,r=null,s={})=>new _i(e,t,r,{intent:!0,...s});let ji=0;class Xi extends Ys{constructor(e,t=null){super();let r=null;null!==t&&("object"==typeof t?r=t.return:("string"==typeof t?r=t:console.error("THREE.TSL: Invalid layout type."),t=null)),this.shaderNode=new Oi(e,r),null!==t&&this.setLayout(t),this.isFn=!0}setLayout(e){const t=this.shaderNode.nodeType;if("object"!=typeof e.inputs){const r={name:"fn"+ji++,type:t,inputs:[]};for(const t in e)"return"!==t&&r.inputs.push({name:t,type:e[t]});e=r}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const t=this.shaderNode.call(e);return"void"===this.shaderNode.nodeType&&t.toStack(),t.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const t=this.getNodeType(e);return console.error('THREE.TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".'),e.generateConst(t)}}function Ki(e,t=null){const r=new Xi(e,t);return new Proxy(()=>{},{apply:(e,t,s)=>r.call(...s),get:(e,t,s)=>Reflect.get(r,t,s),set:(e,t,s,i)=>Reflect.set(r,t,s,i)})}const Yi=e=>{li=e},Qi=()=>li,Zi=(...e)=>li.If(...e);function Ji(e){return li&&li.add(e),e}ci("toStack",Ji);const en=new Di("color"),tn=new Di("float",Li.float),rn=new Di("int",Li.ints),sn=new Di("uint",Li.uint),nn=new Di("bool",Li.bool),an=new Di("vec2"),on=new Di("ivec2"),un=new Di("uvec2"),ln=new Di("bvec2"),dn=new Di("vec3"),cn=new Di("ivec3"),hn=new Di("uvec3"),pn=new Di("bvec3"),gn=new Di("vec4"),mn=new Di("ivec4"),fn=new Di("uvec4"),yn=new Di("bvec4"),bn=new Di("mat2"),xn=new Di("mat3"),Tn=new Di("mat4");ci("toColor",en),ci("toFloat",tn),ci("toInt",rn),ci("toUint",sn),ci("toBool",nn),ci("toVec2",an),ci("toIVec2",on),ci("toUVec2",un),ci("toBVec2",ln),ci("toVec3",dn),ci("toIVec3",cn),ci("toUVec3",hn),ci("toBVec3",pn),ci("toVec4",gn),ci("toIVec4",mn),ci("toUVec4",fn),ci("toBVec4",yn),ci("toMat2",bn),ci("toMat3",xn),ci("toMat4",Tn);const _n=Hi(Qs).setParameterLength(2),vn=(e,t)=>Gi(new Zs(Gi(e),t));ci("element",_n),ci("convert",vn);ci("append",e=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),Ji(e)));class Nn extends Ys{static get type(){return"PropertyNode"}constructor(e,t=null,r=!1){super(e),this.name=t,this.varying=r,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const Sn=(e,t)=>Gi(new Nn(e,t)),En=(e,t)=>Gi(new Nn(e,t,!0)),Rn=Wi(Nn,"vec4","DiffuseColor"),An=Wi(Nn,"vec3","EmissiveColor"),wn=Wi(Nn,"float","Roughness"),Cn=Wi(Nn,"float","Metalness"),Mn=Wi(Nn,"float","Clearcoat"),Pn=Wi(Nn,"float","ClearcoatRoughness"),Bn=Wi(Nn,"vec3","Sheen"),Ln=Wi(Nn,"float","SheenRoughness"),Fn=Wi(Nn,"float","Iridescence"),In=Wi(Nn,"float","IridescenceIOR"),Dn=Wi(Nn,"float","IridescenceThickness"),Un=Wi(Nn,"float","AlphaT"),Vn=Wi(Nn,"float","Anisotropy"),On=Wi(Nn,"vec3","AnisotropyT"),Gn=Wi(Nn,"vec3","AnisotropyB"),kn=Wi(Nn,"color","SpecularColor"),zn=Wi(Nn,"float","SpecularF90"),$n=Wi(Nn,"float","Shininess"),Hn=Wi(Nn,"vec4","Output"),Wn=Wi(Nn,"float","dashSize"),qn=Wi(Nn,"float","gapSize"),jn=Wi(Nn,"float","pointWidth"),Xn=Wi(Nn,"float","IOR"),Kn=Wi(Nn,"float","Transmission"),Yn=Wi(Nn,"float","Thickness"),Qn=Wi(Nn,"float","AttenuationDistance"),Zn=Wi(Nn,"color","AttenuationColor"),Jn=Wi(Nn,"float","Dispersion");class ea extends Ys{static get type(){return"UniformGroupNode"}constructor(e,t=!1,r=1){super("string"),this.name=e,this.shared=t,this.order=r,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const ta=e=>new ea(e),ra=(e,t=0)=>new ea(e,!0,t),sa=ra("frame"),ia=ra("render"),na=ta("object");class aa extends ni{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=na}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(t=>{const r=e(t,this);void 0!==r&&(this.value=r)},t)}getInputType(e){let t=super.getInputType(e);return"bool"===t&&(t="uint"),t}generate(e,t){const r=this.getNodeType(e),s=this.getUniformHash(e);let i=e.getNodeFromHash(s);void 0===i&&(e.setHashNode(this,s),i=this);const n=i.getInputType(e),a=e.getUniformFromNode(i,n,e.shaderStage,this.name||e.context.nodeName),o=e.getPropertyName(a);void 0!==e.context.nodeName&&delete e.context.nodeName;let u=o;if("bool"===r){const t=e.getDataFromNode(this);let s=t.propertyName;if(void 0===s){const i=e.getVarFromNode(this,null,"bool");s=e.getPropertyName(i),t.propertyName=s,u=e.format(o,n,r),e.addLineFlowCode(`${s} = ${u}`,this)}u=s}return e.format(u,r,t)}}const oa=(e,t)=>{const r=Vi(t||e);return r===e&&(e=Is(r)),e=e&&!0===e.isNode?e.node&&e.node.value||e.value:e,Gi(new aa(e,r))};class ua extends Js{static get type(){return"ArrayNode"}constructor(e,t,r=null){super(e),this.count=t,this.values=r,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return null===this.nodeType&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const la=(...e)=>{let t;if(1===e.length){const r=e[0];t=new ua(null,r.length,r)}else{const r=e[0],s=e[1];t=new ua(r,s)}return Gi(t)};ci("toArray",(e,t)=>la(Array(t).fill(e)));class da extends Js{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){const r=e.getTypeLength(t.node.getNodeType(e));return js.join("").slice(0,r)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:r}=this,s=t.getScope();e.getNodeProperties(s).assign=!0;const i=e.getNodeProperties(this);i.sourceNode=r,i.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:r,sourceNode:s}=e.getNodeProperties(this),i=this.needsSplitAssign(e),n=r.build(e),a=r.getNodeType(e),o=s.build(e,a),u=s.getNodeType(e),l=e.getDataFromNode(this);let d;if(!0===l.initialized)"void"!==t&&(d=n);else if(i){const s=e.getVarFromNode(this,null,a),i=e.getPropertyName(s);e.addLineFlowCode(`${i} = ${o}`,this);const u=r.node,l=u.node.context({assign:!0}).build(e);for(let t=0;t<u.components.length;t++){const r=u.components[t];e.addLineFlowCode(`${l}.${r} = ${i}[ ${t} ]`,this)}"void"!==t&&(d=n)}else d=`${n} = ${o}`,"void"!==t&&"void"!==u||(e.addLineFlowCode(d,this),"void"!==t&&(d=n));return l.initialized=!0,e.format(d,a,t)}}const ca=Hi(da).setParameterLength(2);ci("assign",ca);class ha extends Js{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){const t=[],r=this.functionNode,s=r.getInputs(e),i=this.parameters,n=(t,r)=>{const s=r.type;let i;return i="pointer"===s?"&"+t.build(e):t.build(e,s),i};if(Array.isArray(i)){if(i.length>s.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),i.length=s.length;else if(i.length<s.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");i.length<s.length;)i.push(tn(0));for(let e=0;e<i.length;e++)t.push(n(i[e],s[e]))}else for(const e of s){const r=i[e.name];void 0!==r?t.push(n(r,e)):(console.error(`THREE.TSL: Input '${e.name}' not found in 'Fn()'.`),t.push(n(tn(0),e)))}return`${r.build(e,"property")}( ${t.join(", ")} )`}}const pa=(e,...t)=>(t=t.length>1||t[0]&&!0===t[0].isNode?$i(t):zi(t[0]),Gi(new ha(Gi(e),t)));ci("call",pa);const ga={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class ma extends Js{static get type(){return"OperatorNode"}constructor(e,t,r,...s){if(super(),s.length>0){let i=new ma(e,t,r);for(let t=0;t<s.length-1;t++)i=new ma(e,i,s[t]);t=i,r=s[s.length-1]}this.op=e,this.aNode=t,this.bNode=r,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(ga[this.op],t)}getNodeType(e,t=null){const r=this.op,s=this.aNode,i=this.bNode,n=s.getNodeType(e),a=i?i.getNodeType(e):null;if("void"===n||"void"===a)return t||"void";if("%"===r)return n;if("~"===r||"&"===r||"|"===r||"^"===r||">>"===r||"<<"===r)return e.getIntegerType(n);if("!"===r||"&&"===r||"||"===r||"^^"===r)return"bool";if("=="===r||"!="===r||"<"===r||">"===r||"<="===r||">="===r){const t=Math.max(e.getTypeLength(n),e.getTypeLength(a));return t>1?`bvec${t}`:"bool"}if(e.isMatrix(n)){if("float"===a)return n;if(e.isVector(a))return e.getVectorFromMatrix(n);if(e.isMatrix(a))return n}else if(e.isMatrix(a)){if("float"===n)return a;if(e.isVector(n))return e.getVectorFromMatrix(a)}return e.getTypeLength(a)>e.getTypeLength(n)?a:n}generate(e,t){const r=this.op,{aNode:s,bNode:i}=this,n=this.getNodeType(e,t);let a=null,o=null;"void"!==n?(a=s.getNodeType(e),o=i?i.getNodeType(e):null,"<"===r||">"===r||"<="===r||">="===r||"=="===r||"!="===r?e.isVector(a)?o=a:e.isVector(o)?a=o:a!==o&&(a=o="float"):">>"===r||"<<"===r?(a=n,o=e.changeComponentType(o,"uint")):"%"===r?(a=n,o=e.isInteger(a)&&e.isInteger(o)?o:a):e.isMatrix(a)?"float"===o?o="float":e.isVector(o)?o=e.getVectorFromMatrix(a):e.isMatrix(o)||(a=o=n):a=e.isMatrix(o)?"float"===a?"float":e.isVector(a)?e.getVectorFromMatrix(o):o=n:o=n):a=o=n;const u=s.build(e,a),d=i?i.build(e,o):null,c=e.getFunctionOperator(r);if("void"!==t){const s=e.renderer.coordinateSystem===l;if("=="===r||"!="===r||"<"===r||">"===r||"<="===r||">="===r)return s&&e.isVector(a)?e.format(`${this.getOperatorMethod(e,t)}( ${u}, ${d} )`,n,t):e.format(`( ${u} ${r} ${d} )`,n,t);if("%"===r)return e.isInteger(o)?e.format(`( ${u} % ${d} )`,n,t):e.format(`${this.getOperatorMethod(e,n)}( ${u}, ${d} )`,n,t);if("!"===r||"~"===r)return e.format(`(${r}${u})`,a,t);if(c)return e.format(`${c}( ${u}, ${d} )`,n,t);if(e.isMatrix(a)&&"float"===o)return e.format(`( ${d} ${r} ${u} )`,n,t);if("float"===a&&e.isMatrix(o))return e.format(`${u} ${r} ${d}`,n,t);{let i=`( ${u} ${r} ${d} )`;return!s&&"bool"===n&&e.isVector(a)&&e.isVector(o)&&(i=`all${i}`),e.format(i,n,t)}}if("void"!==a)return c?e.format(`${c}( ${u}, ${d} )`,n,t):e.isMatrix(a)&&"float"===o?e.format(`${d} ${r} ${u}`,n,t):e.format(`${u} ${r} ${d}`,n,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const fa=qi(ma,"+").setParameterLength(2,1/0).setName("add"),ya=qi(ma,"-").setParameterLength(2,1/0).setName("sub"),ba=qi(ma,"*").setParameterLength(2,1/0).setName("mul"),xa=qi(ma,"/").setParameterLength(2,1/0).setName("div"),Ta=qi(ma,"%").setParameterLength(2).setName("mod"),_a=qi(ma,"==").setParameterLength(2).setName("equal"),va=qi(ma,"!=").setParameterLength(2).setName("notEqual"),Na=qi(ma,"<").setParameterLength(2).setName("lessThan"),Sa=qi(ma,">").setParameterLength(2).setName("greaterThan"),Ea=qi(ma,"<=").setParameterLength(2).setName("lessThanEqual"),Ra=qi(ma,">=").setParameterLength(2).setName("greaterThanEqual"),Aa=qi(ma,"&&").setParameterLength(2,1/0).setName("and"),wa=qi(ma,"||").setParameterLength(2,1/0).setName("or"),Ca=qi(ma,"!").setParameterLength(1).setName("not"),Ma=qi(ma,"^^").setParameterLength(2).setName("xor"),Pa=qi(ma,"&").setParameterLength(2).setName("bitAnd"),Ba=qi(ma,"~").setParameterLength(2).setName("bitNot"),La=qi(ma,"|").setParameterLength(2).setName("bitOr"),Fa=qi(ma,"^").setParameterLength(2).setName("bitXor"),Ia=qi(ma,"<<").setParameterLength(2).setName("shiftLeft"),Da=qi(ma,">>").setParameterLength(2).setName("shiftRight"),Ua=Ki(([e])=>(e.addAssign(1),e)),Va=Ki(([e])=>(e.subAssign(1),e)),Oa=Ki(([e])=>{const t=rn(e).toConst();return e.addAssign(1),t}),Ga=Ki(([e])=>{const t=rn(e).toConst();return e.subAssign(1),t});ci("add",fa),ci("sub",ya),ci("mul",ba),ci("div",xa),ci("mod",Ta),ci("equal",_a),ci("notEqual",va),ci("lessThan",Na),ci("greaterThan",Sa),ci("lessThanEqual",Ea),ci("greaterThanEqual",Ra),ci("and",Aa),ci("or",wa),ci("not",Ca),ci("xor",Ma),ci("bitAnd",Pa),ci("bitNot",Ba),ci("bitOr",La),ci("bitXor",Fa),ci("shiftLeft",Ia),ci("shiftRight",Da),ci("incrementBefore",Ua),ci("decrementBefore",Va),ci("increment",Oa),ci("decrement",Ga);const ka=(e,t)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),Ta(rn(e),rn(t)));ci("modInt",ka);class za extends Js{static get type(){return"MathNode"}constructor(e,t,r=null,s=null){if(super(),(e===za.MAX||e===za.MIN)&&arguments.length>3){let i=new za(e,t,r);for(let t=2;t<arguments.length-1;t++)i=new za(e,i,arguments[t]);t=i,r=arguments[arguments.length-1],s=null}this.method=e,this.aNode=t,this.bNode=r,this.cNode=s,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,s=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),n=e.isMatrix(r)?0:e.getTypeLength(r),a=e.isMatrix(s)?0:e.getTypeLength(s);return i>n&&i>a?t:n>a?r:a>i?s:t}getNodeType(e){const t=this.method;return t===za.LENGTH||t===za.DISTANCE||t===za.DOT?"float":t===za.CROSS?"vec3":t===za.ALL||t===za.ANY?"bool":t===za.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:r,method:s}=this;let i=null;if(s===za.ONE_MINUS)i=ya(1,t);else if(s===za.RECIPROCAL)i=xa(1,t);else if(s===za.DIFFERENCE)i=go(ya(t,r));else if(s===za.TRANSFORM_DIRECTION){let s=t,n=r;e.isMatrix(s.getNodeType(e))?n=gn(dn(n),0):s=gn(dn(s),0);const a=ba(s,n).xyz;i=no(a)}return null!==i?i:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const s=this.getNodeType(e),i=this.getInputType(e),n=this.aNode,a=this.bNode,o=this.cNode,u=e.renderer.coordinateSystem;if(r===za.NEGATE)return e.format("( - "+n.build(e,i)+" )",s,t);{const c=[];return r===za.CROSS?c.push(n.build(e,s),a.build(e,s)):u===l&&r===za.STEP?c.push(n.build(e,1===e.getTypeLength(n.getNodeType(e))?"float":i),a.build(e,i)):u!==l||r!==za.MIN&&r!==za.MAX?r===za.REFRACT?c.push(n.build(e,i),a.build(e,i),o.build(e,"float")):r===za.MIX?c.push(n.build(e,i),a.build(e,i),o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":i)):(u===d&&r===za.ATAN&&null!==a&&(r="atan2"),"fragment"===e.shaderStage||r!==za.DFDX&&r!==za.DFDY||(console.warn(`THREE.TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),c.push(n.build(e,i)),null!==a&&c.push(a.build(e,i)),null!==o&&c.push(o.build(e,i))):c.push(n.build(e,i),a.build(e,1===e.getTypeLength(a.getNodeType(e))?"float":i)),e.format(`${e.getMethod(r,s)}( ${c.join(", ")} )`,s,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}za.ALL="all",za.ANY="any",za.RADIANS="radians",za.DEGREES="degrees",za.EXP="exp",za.EXP2="exp2",za.LOG="log",za.LOG2="log2",za.SQRT="sqrt",za.INVERSE_SQRT="inversesqrt",za.FLOOR="floor",za.CEIL="ceil",za.NORMALIZE="normalize",za.FRACT="fract",za.SIN="sin",za.COS="cos",za.TAN="tan",za.ASIN="asin",za.ACOS="acos",za.ATAN="atan",za.ABS="abs",za.SIGN="sign",za.LENGTH="length",za.NEGATE="negate",za.ONE_MINUS="oneMinus",za.DFDX="dFdx",za.DFDY="dFdy",za.ROUND="round",za.RECIPROCAL="reciprocal",za.TRUNC="trunc",za.FWIDTH="fwidth",za.TRANSPOSE="transpose",za.DETERMINANT="determinant",za.INVERSE="inverse",za.EQUALS="equals",za.MIN="min",za.MAX="max",za.STEP="step",za.REFLECT="reflect",za.DISTANCE="distance",za.DIFFERENCE="difference",za.DOT="dot",za.CROSS="cross",za.POW="pow",za.TRANSFORM_DIRECTION="transformDirection",za.MIX="mix",za.CLAMP="clamp",za.REFRACT="refract",za.SMOOTHSTEP="smoothstep",za.FACEFORWARD="faceforward";const $a=tn(1e-6),Ha=tn(1e6),Wa=tn(Math.PI),qa=tn(2*Math.PI),ja=qi(za,za.ALL).setParameterLength(1),Xa=qi(za,za.ANY).setParameterLength(1),Ka=qi(za,za.RADIANS).setParameterLength(1),Ya=qi(za,za.DEGREES).setParameterLength(1),Qa=qi(za,za.EXP).setParameterLength(1),Za=qi(za,za.EXP2).setParameterLength(1),Ja=qi(za,za.LOG).setParameterLength(1),eo=qi(za,za.LOG2).setParameterLength(1),to=qi(za,za.SQRT).setParameterLength(1),ro=qi(za,za.INVERSE_SQRT).setParameterLength(1),so=qi(za,za.FLOOR).setParameterLength(1),io=qi(za,za.CEIL).setParameterLength(1),no=qi(za,za.NORMALIZE).setParameterLength(1),ao=qi(za,za.FRACT).setParameterLength(1),oo=qi(za,za.SIN).setParameterLength(1),uo=qi(za,za.COS).setParameterLength(1),lo=qi(za,za.TAN).setParameterLength(1),co=qi(za,za.ASIN).setParameterLength(1),ho=qi(za,za.ACOS).setParameterLength(1),po=qi(za,za.ATAN).setParameterLength(1,2),go=qi(za,za.ABS).setParameterLength(1),mo=qi(za,za.SIGN).setParameterLength(1),fo=qi(za,za.LENGTH).setParameterLength(1),yo=qi(za,za.NEGATE).setParameterLength(1),bo=qi(za,za.ONE_MINUS).setParameterLength(1),xo=qi(za,za.DFDX).setParameterLength(1),To=qi(za,za.DFDY).setParameterLength(1),_o=qi(za,za.ROUND).setParameterLength(1),vo=qi(za,za.RECIPROCAL).setParameterLength(1),No=qi(za,za.TRUNC).setParameterLength(1),So=qi(za,za.FWIDTH).setParameterLength(1),Eo=qi(za,za.TRANSPOSE).setParameterLength(1),Ro=qi(za,za.DETERMINANT).setParameterLength(1),Ao=qi(za,za.INVERSE).setParameterLength(1),wo=(e,t)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),_a(e,t)),Co=qi(za,za.MIN).setParameterLength(2,1/0),Mo=qi(za,za.MAX).setParameterLength(2,1/0),Po=qi(za,za.STEP).setParameterLength(2),Bo=qi(za,za.REFLECT).setParameterLength(2),Lo=qi(za,za.DISTANCE).setParameterLength(2),Fo=qi(za,za.DIFFERENCE).setParameterLength(2),Io=qi(za,za.DOT).setParameterLength(2),Do=qi(za,za.CROSS).setParameterLength(2),Uo=qi(za,za.POW).setParameterLength(2),Vo=e=>ba(e,e),Oo=e=>ba(e,e,e),Go=e=>ba(e,e,e,e),ko=qi(za,za.TRANSFORM_DIRECTION).setParameterLength(2),zo=e=>ba(mo(e),Uo(go(e),1/3)),$o=e=>Io(e,e),Ho=qi(za,za.MIX).setParameterLength(3),Wo=(e,t=0,r=1)=>Gi(new za(za.CLAMP,Gi(e),Gi(t),Gi(r))),qo=e=>Wo(e),jo=qi(za,za.REFRACT).setParameterLength(3),Xo=qi(za,za.SMOOTHSTEP).setParameterLength(3),Ko=qi(za,za.FACEFORWARD).setParameterLength(3),Yo=Ki(([e])=>{const t=Io(e.xy,an(12.9898,78.233)),r=Ta(t,Wa);return ao(oo(r).mul(43758.5453))}),Qo=(e,t,r)=>Ho(t,r,e),Zo=(e,t,r)=>Xo(t,r,e),Jo=(e,t)=>Po(t,e),eu=(e,t)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),po(e,t)),tu=Ko,ru=ro;ci("all",ja),ci("any",Xa),ci("equals",wo),ci("radians",Ka),ci("degrees",Ya),ci("exp",Qa),ci("exp2",Za),ci("log",Ja),ci("log2",eo),ci("sqrt",to),ci("inverseSqrt",ro),ci("floor",so),ci("ceil",io),ci("normalize",no),ci("fract",ao),ci("sin",oo),ci("cos",uo),ci("tan",lo),ci("asin",co),ci("acos",ho),ci("atan",po),ci("abs",go),ci("sign",mo),ci("length",fo),ci("lengthSq",$o),ci("negate",yo),ci("oneMinus",bo),ci("dFdx",xo),ci("dFdy",To),ci("round",_o),ci("reciprocal",vo),ci("trunc",No),ci("fwidth",So),ci("atan2",eu),ci("min",Co),ci("max",Mo),ci("step",Jo),ci("reflect",Bo),ci("distance",Lo),ci("dot",Io),ci("cross",Do),ci("pow",Uo),ci("pow2",Vo),ci("pow3",Oo),ci("pow4",Go),ci("transformDirection",ko),ci("mix",Qo),ci("clamp",Wo),ci("refract",jo),ci("smoothstep",Zo),ci("faceForward",Ko),ci("difference",Fo),ci("saturate",qo),ci("cbrt",zo),ci("transpose",Eo),ci("determinant",Ro),ci("inverse",Ao),ci("rand",Yo);class su extends Ys{static get type(){return"ConditionalNode"}constructor(e,t,r=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=r}getNodeType(e){const{ifNode:t,elseNode:r}=e.getNodeProperties(this);if(void 0===t)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const s=t.getNodeType(e);if(null!==r){const t=r.getNodeType(e);if(e.getTypeLength(t)>e.getTypeLength(s))return t}return s}setup(e){const t=this.condNode.cache(),r=this.ifNode.cache(),s=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(r).parentNodeBlock=i,null!==s&&(e.getDataFromNode(s).parentNodeBlock=i);const n=e.context.uniformFlow,a=e.getNodeProperties(this);a.condNode=t,a.ifNode=n?r:r.context({nodeBlock:r}),a.elseNode=s?n?s:s.context({nodeBlock:s}):null}generate(e,t){const r=this.getNodeType(e),s=e.getDataFromNode(this);if(void 0!==s.nodeProperty)return s.nodeProperty;const{condNode:i,ifNode:n,elseNode:a}=e.getNodeProperties(this),o=e.currentFunctionNode,u="void"!==t,l=u?Sn(r).build(e):"";s.nodeProperty=l;const d=i.build(e,"bool");if(e.context.uniformFlow&&null!==a){const s=n.build(e,r),i=a.build(e,r),o=e.getTernary(d,s,i);return e.format(o,r,t)}e.addFlowCode(`\n${e.tab}if ( ${d} ) {\n\n`).addFlowTab();let c=n.build(e,r);if(c&&(u?c=l+" = "+c+";":(c="return "+c+";",null===o&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),c="// "+c))),e.removeFlowTab().addFlowCode(e.tab+"\t"+c+"\n\n"+e.tab+"}"),null!==a){e.addFlowCode(" else {\n\n").addFlowTab();let t=a.build(e,r);t&&(u?t=l+" = "+t+";":(t="return "+t+";",null===o&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),t="// "+t))),e.removeFlowTab().addFlowCode(e.tab+"\t"+t+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(l,r,t)}}const iu=Hi(su).setParameterLength(2,3);ci("select",iu);class nu extends Ys{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const r=e.getContext();e.setContext({...e.context,...this.value});const s=this.node.build(e,t);return e.setContext(r),s}}const au=Hi(nu).setParameterLength(1,2),ou=e=>au(e,{uniformFlow:!0}),uu=(e,t)=>au(e,{nodeName:t});function lu(e,t){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),uu(e,t)}ci("context",au),ci("label",lu),ci("uniformFlow",ou),ci("setName",uu);class du extends Ys{static get type(){return"VarNode"}constructor(e,t=null,r=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=r,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}build(...e){if(!0===this.intent){if(!0!==e[0].getNodeProperties(this).assign)return this.node.build(...e)}return super.build(...e)}generate(e){const{node:t,name:r,readOnly:s}=this,{renderer:i}=e,n=!0===i.backend.isWebGPUBackend;let a=!1,o=!1;s&&(a=e.isDeterministic(t),o=n?s:a);const u=e.getVectorType(this.getNodeType(e)),l=t.build(e,u),d=e.getVarFromNode(this,r,u,void 0,o),c=e.getPropertyName(d);let h=c;if(o)if(n)h=a?`const ${c}`:`let ${c}`;else{const r=t.getArrayCount(e);h=`const ${e.getVar(d.type,c,r)}`}return e.addLineFlowCode(`${h} = ${l}`,this),c}}const cu=Hi(du),hu=(e,t=null)=>cu(e,t).toStack(),pu=(e,t=null)=>cu(e,t,!0).toStack(),gu=e=>null===Qi()?e:cu(e).setIntent(!0).toStack();ci("toVar",hu),ci("toConst",pu),ci("toVarIntent",gu);class mu extends Ys{static get type(){return"SubBuild"}constructor(e,t,r=null){super(r),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(null!==this.nodeType)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const r=this.node.build(e,...t);return e.removeSubBuild(),r}}const fu=(e,t,r=null)=>Gi(new mu(Gi(e),t,r));class yu extends Ys{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let r=t.varying;if(void 0===r){const s=this.name,i=this.getNodeType(e),n=this.interpolationType,a=this.interpolationSampling;t.varying=r=e.getVaryingFromNode(this,s,i,n,a),t.node=fu(this.node,"VERTEX")}return r.needsInterpolation||(r.needsInterpolation="fragment"===e.shaderStage),r}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(Gs.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(Gs.VERTEX,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),r=e.getNodeProperties(this),s=this.setupVarying(e);if(void 0===r[t]){const i=this.getNodeType(e),n=e.getPropertyName(s,Gs.VERTEX);e.flowNodeFromShaderStage(Gs.VERTEX,r.node,i,n),r[t]=n}return e.getPropertyName(s)}}const bu=Hi(yu).setParameterLength(1,2),xu=e=>bu(e);ci("toVarying",bu),ci("toVertexStage",xu),ci("varying",(...e)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),bu(...e))),ci("vertexStage",(...e)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),bu(...e)));const Tu=Ki(([e])=>{const t=e.mul(.9478672986).add(.0521327014).pow(2.4),r=e.mul(.0773993808),s=e.lessThanEqual(.04045);return Ho(t,r,s)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),_u=Ki(([e])=>{const t=e.pow(.41666).mul(1.055).sub(.055),r=e.mul(12.92),s=e.lessThanEqual(.0031308);return Ho(t,r,s)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),vu="WorkingColorSpace";class Nu extends Js{static get type(){return"ColorSpaceNode"}constructor(e,t,r){super("vec4"),this.colorNode=e,this.source=t,this.target=r}resolveColorSpace(e,t){return t===vu?c.workingColorSpace:"OutputColorSpace"===t?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,r=this.resolveColorSpace(e,this.source),s=this.resolveColorSpace(e,this.target);let i=t;return!1!==c.enabled&&r!==s&&r&&s?(c.getTransfer(r)===h&&(i=gn(Tu(i.rgb),i.a)),c.getPrimaries(r)!==c.getPrimaries(s)&&(i=gn(xn(c._getMatrix(new n,r,s)).mul(i.rgb),i.a)),c.getTransfer(s)===h&&(i=gn(_u(i.rgb),i.a)),i):i}}const Su=(e,t)=>Gi(new Nu(Gi(e),vu,t)),Eu=(e,t)=>Gi(new Nu(Gi(e),t,vu));ci("workingToColorSpace",Su),ci("colorSpaceToWorking",Eu);let Ru=class extends Qs{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),r=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(t,r,s)}};class Au extends Ys{static get type(){return"ReferenceBaseNode"}constructor(e,t,r=null,s=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=s,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.updateType=ks.OBJECT}setGroup(e){return this.group=e,this}element(e){return Gi(new Ru(this,Gi(e)))}setNodeType(e){const t=oa(null,e);null!==this.group&&t.setGroup(this.group),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let r=e[t[0]];for(let e=1;e<t.length;e++)r=r[t[e]];return r}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}class wu extends Au{static get type(){return"RendererReferenceNode"}constructor(e,t,r=null){super(e,t,r),this.renderer=r,this.setGroup(ia)}updateReference(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}}const Cu=(e,t,r=null)=>Gi(new wu(e,t,r));class Mu extends Js{static get type(){return"ToneMappingNode"}constructor(e,t=Bu,r=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=r}customCacheKey(){return Ss(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,r=this.toneMapping;if(r===p)return t;let s=null;const i=e.renderer.library.getToneMappingFunction(r);return null!==i?s=gn(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",r),s=t),s}}const Pu=(e,t,r)=>Gi(new Mu(e,Gi(t),Gi(r))),Bu=Cu("toneMappingExposure","float");ci("toneMapping",(e,t,r)=>Pu(t,r,e));class Lu extends ni{static get type(){return"BufferAttributeNode"}constructor(e,t=null,r=0,s=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=r,this.bufferOffset=s,this.usage=g,this.instanced=!1,this.attribute=null,this.global=!0,e&&!0===e.isBufferAttribute&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(0===this.bufferStride&&0===this.bufferOffset){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(null!==this.attribute)return;const t=this.getNodeType(e),r=this.value,s=e.getTypeLength(t),i=this.bufferStride||s,n=this.bufferOffset,a=!0===r.isInterleavedBuffer?r:new m(r,i),o=new f(a,s,n);a.setUsage(this.usage),this.attribute=o,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),r=e.getBufferAttributeFromNode(this,t),s=e.getPropertyName(r);let i=null;if("vertex"===e.shaderStage||"compute"===e.shaderStage)this.name=s,i=s;else{i=bu(this).build(e,t)}return i}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&!0===this.attribute.isBufferAttribute&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const Fu=(e,t=null,r=0,s=0)=>Gi(new Lu(e,t,r,s)),Iu=(e,t=null,r=0,s=0)=>Fu(e,t,r,s).setUsage(y),Du=(e,t=null,r=0,s=0)=>Fu(e,t,r,s).setInstanced(!0),Uu=(e,t=null,r=0,s=0)=>Iu(e,t,r,s).setInstanced(!0);ci("toAttribute",e=>Fu(e.value));class Vu extends Ys{static get type(){return"ComputeNode"}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=ks.OBJECT,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){e.getNodeProperties(this).outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:r}=e;if("compute"===r){const t=this.computeNode.build(e,"void");""!==t&&e.addLineFlowCode(t,this)}else{const r=e.getNodeProperties(this).outputComputeNode;if(r)return r.build(e,t)}}}const Ou=(e,t=[64])=>{(0===t.length||t.length>3)&&console.error("THREE.TSL: compute() workgroupSize must have 1, 2, or 3 elements");for(let e=0;e<t.length;e++){const r=t[e];("number"!=typeof r||r<=0||!Number.isInteger(r))&&console.error(`THREE.TSL: compute() workgroupSize element at index [ ${e} ] must be a positive integer`)}for(;t.length<3;)t.push(1);return Gi(new Vu(Gi(e),t))},Gu=(e,t,r)=>Ou(e,r).setCount(t);ci("compute",Gu),ci("computeKernel",Ou);class ku extends Ys{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.getNodeType(e);return e.setCache(t),s}build(e,...t){const r=e.getCache(),s=e.getCacheFromNode(this,this.parent);e.setCache(s);const i=this.node.build(e,...t);return e.setCache(r),i}}const zu=(e,t)=>Gi(new ku(Gi(e),t));ci("cache",zu);class $u extends Ys{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const Hu=Hi($u).setParameterLength(2);ci("bypass",Hu);class Wu extends Ys{static get type(){return"RemapNode"}constructor(e,t,r,s=tn(0),i=tn(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=r,this.outLowNode=s,this.outHighNode=i,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:r,outLowNode:s,outHighNode:i,doClamp:n}=this;let a=e.sub(t).div(r.sub(t));return!0===n&&(a=a.clamp()),a.mul(i.sub(s)).add(s)}}const qu=Hi(Wu,null,null,{doClamp:!1}).setParameterLength(3,5),ju=Hi(Wu).setParameterLength(3,5);ci("remap",qu),ci("remapClamp",ju);class Xu extends Ys{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const r=this.getNodeType(e),s=this.snippet;if("void"!==r)return e.format(s,r,t);e.addLineFlowCode(s,this)}}const Ku=Hi(Xu).setParameterLength(1,2),Yu=e=>(e?iu(e,Ku("discard")):Ku("discard")).toStack();ci("discard",Yu);class Qu extends Js{static get type(){return"RenderOutputNode"}constructor(e,t,r){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=r,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const r=(null!==this.toneMapping?this.toneMapping:e.toneMapping)||p,s=(null!==this.outputColorSpace?this.outputColorSpace:e.outputColorSpace)||b;return r!==p&&(t=t.toneMapping(r)),s!==b&&s!==c.workingColorSpace&&(t=t.workingToColorSpace(s)),t}}const Zu=(e,t=null,r=null)=>Gi(new Qu(Gi(e),t,r));ci("renderOutput",Zu);class Ju extends Js{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,r=this.node.build(e),s="--- TSL debug - "+e.shaderStage+" shader ---",i="-".repeat(s.length);let n="";return n+="// #"+s+"#\n",n+=e.flow.code.replace(/^\t/gm,"")+"\n",n+="/* ... */ "+r+" /* ... */\n",n+="// #"+i+"#\n",null!==t?t(e,n):console.log(n),r}}const el=(e,t=null)=>Gi(new Ju(Gi(e),t)).toStack();ci("debug",el);class tl extends Ys{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(null===t){const r=this.getAttributeName(e);if(e.hasGeometryAttribute(r)){const s=e.geometry.getAttribute(r);t=e.getTypeFromAttribute(s)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),r=this.getNodeType(e);if(!0===e.hasGeometryAttribute(t)){const s=e.geometry.getAttribute(t),i=e.getTypeFromAttribute(s),n=e.getAttribute(t,i);if("vertex"===e.shaderStage)return e.format(n.name,i,r);return bu(this).build(e,r)}return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(r)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const rl=(e,t=null)=>Gi(new tl(e,t)),sl=(e=0)=>rl("uv"+(e>0?e:""),"vec2");class il extends Ys{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const r=this.textureNode.build(e,"property"),s=null===this.levelNode?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${r}, ${s} )`,this.getNodeType(e),t)}}const nl=Hi(il).setParameterLength(1,2);class al extends aa{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=ks.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,r=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(r&&void 0!==r.width){const{width:e,height:t}=r;this.value=Math.log2(Math.max(e,t))}}}const ol=Hi(al).setParameterLength(1),ul=new x;class ll extends aa{static get type(){return"TextureNode"}constructor(e=ul,t=null,r=null,s=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=r,this.biasNode=s,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=ks.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(null===t)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return!0===this.value.isDepthTexture?"float":this.value.type===T?"uvec4":this.value.type===_?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return sl(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return null===this._matrixUniform&&(this._matrixUniform=oa(this.value.matrix)),this._matrixUniform.mul(dn(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?ks.OBJECT:ks.NONE,this}setupUV(e,t){const r=this.value;return e.isFlipY()&&(r.image instanceof ImageBitmap&&!0===r.flipY||!0===r.isRenderTargetTexture||!0===r.isFramebufferTexture||!0===r.isDepthTexture)&&(t=this.sampler?t.flipY():t.setY(rn(nl(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const r=this.value;if(!r||!0!==r.isTexture)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let s=this.uvNode;null!==s&&!0!==e.context.forceUVContext||!e.context.getUV||(s=e.context.getUV(this,e)),s||(s=this.getDefaultUV()),!0===this.updateMatrix&&(s=this.getTransformedUV(s)),s=this.setupUV(e,s);let i=this.levelNode;null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=s,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,r,s,i,n,a,o,u){const l=this.value;let d;return d=s?e.generateTextureLevel(l,t,r,s,n,u):i?e.generateTextureBias(l,t,r,i,n,u):o?e.generateTextureGrad(l,t,r,o,n,u):a?e.generateTextureCompare(l,t,r,a,n,u):!1===this.sampler?e.generateTextureLoad(l,t,r,n,u):e.generateTexture(l,t,r,n,u),d}generate(e,t){const r=this.value,s=e.getNodeProperties(this),i=super.generate(e,"property");if(/^sampler/.test(t))return i+"_sampler";if(e.isReference(t))return i;{const n=e.getDataFromNode(this);let a=n.propertyName;if(void 0===a){const{uvNode:t,levelNode:r,biasNode:o,compareNode:u,depthNode:l,gradNode:d,offsetNode:c}=s,h=this.generateUV(e,t),p=r?r.build(e,"float"):null,g=o?o.build(e,"float"):null,m=l?l.build(e,"int"):null,f=u?u.build(e,"float"):null,y=d?[d[0].build(e,"vec2"),d[1].build(e,"vec2")]:null,b=c?this.generateOffset(e,c):null,x=e.getVarFromNode(this);a=e.getPropertyName(x);const T=this.generateSnippet(e,i,h,p,g,m,f,y,b);e.addLineFlowCode(`${a} = ${T}`,this),n.snippet=T,n.propertyName=a}let o=a;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(o=Eu(Ku(o,u),r.colorSpace).setup(e).build(e,u)),e.format(o,u,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){const t=this.clone();t.biasNode=Gi(e).mul(ol(t)),t.referenceNode=this.getBase();const r=t.value;return!1===t.generateMipmaps&&(r&&!1===r.generateMipmaps||r.minFilter===v||r.magFilter===v)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),Gi(t)}level(e){const t=this.clone();return t.levelNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}size(e){return nl(this,e)}bias(e){const t=this.clone();return t.biasNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const t=this.clone();return t.compareNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}grad(e,t){const r=this.clone();return r.gradNode=[Gi(e),Gi(t)],r.referenceNode=this.getBase(),Gi(r)}depth(e){const t=this.clone();return t.depthNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}offset(e){const t=this.clone();return t.offsetNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;null!==t&&(t.value=e.matrix),!0===e.matrixAutoUpdate&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const dl=Hi(ll).setParameterLength(1,4).setName("texture"),cl=(e=ul,t=null,r=null,s=null)=>{let i;return e&&!0===e.isTextureNode?(i=Gi(e.clone()),i.referenceNode=e.getBase(),null!==t&&(i.uvNode=Gi(t)),null!==r&&(i.levelNode=Gi(r)),null!==s&&(i.biasNode=Gi(s))):i=dl(e,t,r,s),i},hl=(...e)=>cl(...e).setSampler(!1);class pl extends aa{static get type(){return"BufferNode"}constructor(e,t,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=r}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const gl=(e,t,r)=>Gi(new pl(e,t,r));class ml extends Qs{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),r=this.getNodeType(),s=this.node.getPaddedType();return e.format(t,s,r)}}class fl extends pl{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=null===t?Fs(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=ks.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return"mat2"===e?t="mat2":!0===/mat/.test(e)?t="mat4":"i"===e.charAt(0)?t="ivec4":"u"===e.charAt(0)&&(t="uvec4"),t}update(){const{array:e,value:t}=this,r=this.elementType;if("float"===r||"int"===r||"uint"===r)for(let r=0;r<e.length;r++){t[4*r]=e[r]}else if("color"===r)for(let r=0;r<e.length;r++){const s=4*r,i=e[r];t[s]=i.r,t[s+1]=i.g,t[s+2]=i.b||0}else if("mat2"===r)for(let r=0;r<e.length;r++){const s=4*r,i=e[r];t[s]=i.elements[0],t[s+1]=i.elements[1],t[s+2]=i.elements[2],t[s+3]=i.elements[3]}else if("mat3"===r)for(let r=0;r<e.length;r++){const s=16*r,i=e[r];t[s]=i.elements[0],t[s+1]=i.elements[1],t[s+2]=i.elements[2],t[s+4]=i.elements[3],t[s+5]=i.elements[4],t[s+6]=i.elements[5],t[s+8]=i.elements[6],t[s+9]=i.elements[7],t[s+10]=i.elements[8],t[s+15]=1}else if("mat4"===r)for(let r=0;r<e.length;r++){const s=16*r,i=e[r];for(let e=0;e<i.elements.length;e++)t[s+e]=i.elements[e]}else for(let r=0;r<e.length;r++){const s=4*r,i=e[r];t[s]=i.x,t[s+1]=i.y,t[s+2]=i.z||0,t[s+3]=i.w||0}}setup(e){const t=this.array.length,r=this.elementType;let s=Float32Array;const i=this.paddedType,n=e.getTypeLength(i);return"i"===r.charAt(0)&&(s=Int32Array),"u"===r.charAt(0)&&(s=Uint32Array),this.value=new s(t*n),this.bufferCount=t,this.bufferType=i,super.setup(e)}element(e){return Gi(new ml(this,Gi(e)))}}const yl=(e,t)=>Gi(new fl(e,t));const bl=Hi(class extends Ys{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}).setParameterLength(1);let xl,Tl;class _l extends Ys{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===_l.DPR?"float":this.scope===_l.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=ks.NONE;return this.scope!==_l.SIZE&&this.scope!==_l.VIEWPORT&&this.scope!==_l.DPR||(e=ks.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===_l.VIEWPORT?null!==t?Tl.copy(t.viewport):(e.getViewport(Tl),Tl.multiplyScalar(e.getPixelRatio())):this.scope===_l.DPR?this._output.value=e.getPixelRatio():null!==t?(xl.width=t.width,xl.height=t.height):e.getDrawingBufferSize(xl)}setup(){const e=this.scope;let r=null;return r=e===_l.SIZE?oa(xl||(xl=new t)):e===_l.VIEWPORT?oa(Tl||(Tl=new s)):e===_l.DPR?oa(1):an(El.div(Sl)),this._output=r,r}generate(e){if(this.scope===_l.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const r=e.getNodeProperties(Sl).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${r}.y - ${t}.y )`}return t}return super.generate(e)}}_l.COORDINATE="coordinate",_l.VIEWPORT="viewport",_l.SIZE="size",_l.UV="uv",_l.DPR="dpr";const vl=Wi(_l,_l.DPR),Nl=Wi(_l,_l.UV),Sl=Wi(_l,_l.SIZE),El=Wi(_l,_l.COORDINATE),Rl=Wi(_l,_l.VIEWPORT),Al=Rl.zw,wl=El.sub(Rl.xy),Cl=wl.div(Al),Ml=Ki(()=>(console.warn('THREE.TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),Sl),"vec2").once()(),Pl=oa(0,"uint").setName("u_cameraIndex").setGroup(ra("cameraIndex")).toVarying("v_cameraIndex"),Bl=oa("float").setName("cameraNear").setGroup(ia).onRenderUpdate(({camera:e})=>e.near),Ll=oa("float").setName("cameraFar").setGroup(ia).onRenderUpdate(({camera:e})=>e.far),Fl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.projectionMatrix);t=yl(r).setGroup(ia).setName("cameraProjectionMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraProjectionMatrix")}else t=oa("mat4").setName("cameraProjectionMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.projectionMatrix);return t}).once()(),Il=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.projectionMatrixInverse);t=yl(r).setGroup(ia).setName("cameraProjectionMatricesInverse").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraProjectionMatrixInverse")}else t=oa("mat4").setName("cameraProjectionMatrixInverse").setGroup(ia).onRenderUpdate(({camera:e})=>e.projectionMatrixInverse);return t}).once()(),Dl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.matrixWorldInverse);t=yl(r).setGroup(ia).setName("cameraViewMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraViewMatrix")}else t=oa("mat4").setName("cameraViewMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.matrixWorldInverse);return t}).once()(),Ul=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.matrixWorld);t=yl(r).setGroup(ia).setName("cameraWorldMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraWorldMatrix")}else t=oa("mat4").setName("cameraWorldMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.matrixWorld);return t}).once()(),Vl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.normalMatrix);t=yl(r).setGroup(ia).setName("cameraNormalMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraNormalMatrix")}else t=oa("mat3").setName("cameraNormalMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.normalMatrix);return t}).once()(),Ol=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const s=[];for(let t=0,i=e.cameras.length;t<i;t++)s.push(new r);const i=yl(s).setGroup(ia).setName("cameraPositions").onRenderUpdate(({camera:e},t)=>{const r=e.cameras,s=t.array;for(let e=0,t=r.length;e<t;e++)s[e].setFromMatrixPosition(r[e].matrixWorld)});t=i.element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraPosition")}else t=oa(new r).setName("cameraPosition").setGroup(ia).onRenderUpdate(({camera:e},t)=>t.value.setFromMatrixPosition(e.matrixWorld));return t}).once()(),Gl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.viewport);t=yl(r,"vec4").setGroup(ia).setName("cameraViewports").element(Pl).toConst("cameraViewport")}else t=gn(0,0,Sl.x,Sl.y).toConst("cameraViewport");return t}).once()(),kl=new N;class zl extends Ys{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=ks.OBJECT,this.uniformNode=new aa(null)}getNodeType(){const e=this.scope;return e===zl.WORLD_MATRIX?"mat4":e===zl.POSITION||e===zl.VIEW_POSITION||e===zl.DIRECTION||e===zl.SCALE?"vec3":e===zl.RADIUS?"float":void 0}update(e){const t=this.object3d,s=this.uniformNode,i=this.scope;if(i===zl.WORLD_MATRIX)s.value=t.matrixWorld;else if(i===zl.POSITION)s.value=s.value||new r,s.value.setFromMatrixPosition(t.matrixWorld);else if(i===zl.SCALE)s.value=s.value||new r,s.value.setFromMatrixScale(t.matrixWorld);else if(i===zl.DIRECTION)s.value=s.value||new r,t.getWorldDirection(s.value);else if(i===zl.VIEW_POSITION){const i=e.camera;s.value=s.value||new r,s.value.setFromMatrixPosition(t.matrixWorld),s.value.applyMatrix4(i.matrixWorldInverse)}else if(i===zl.RADIUS){const r=e.object.geometry;null===r.boundingSphere&&r.computeBoundingSphere(),kl.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),s.value=kl.radius}}generate(e){const t=this.scope;return t===zl.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===zl.POSITION||t===zl.VIEW_POSITION||t===zl.DIRECTION||t===zl.SCALE?this.uniformNode.nodeType="vec3":t===zl.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}zl.WORLD_MATRIX="worldMatrix",zl.POSITION="position",zl.SCALE="scale",zl.VIEW_POSITION="viewPosition",zl.DIRECTION="direction",zl.RADIUS="radius";const $l=Hi(zl,zl.DIRECTION).setParameterLength(1),Hl=Hi(zl,zl.WORLD_MATRIX).setParameterLength(1),Wl=Hi(zl,zl.POSITION).setParameterLength(1),ql=Hi(zl,zl.SCALE).setParameterLength(1),jl=Hi(zl,zl.VIEW_POSITION).setParameterLength(1),Xl=Hi(zl,zl.RADIUS).setParameterLength(1);class Kl extends zl{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const Yl=Wi(Kl,Kl.DIRECTION),Ql=Wi(Kl,Kl.WORLD_MATRIX),Zl=Wi(Kl,Kl.POSITION),Jl=Wi(Kl,Kl.SCALE),ed=Wi(Kl,Kl.VIEW_POSITION),td=Wi(Kl,Kl.RADIUS),rd=oa(new n).onObjectUpdate(({object:e},t)=>t.value.getNormalMatrix(e.matrixWorld)),sd=oa(new a).onObjectUpdate(({object:e},t)=>t.value.copy(e.matrixWorld).invert()),id=Ki(e=>e.renderer.overrideNodes.modelViewMatrix||nd).once()().toVar("modelViewMatrix"),nd=Dl.mul(Ql),ad=Ki(e=>(e.context.isHighPrecisionModelViewMatrix=!0,oa("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),od=Ki(e=>{const t=e.context.isHighPrecisionModelViewMatrix;return oa("mat3").onObjectUpdate(({object:e,camera:r})=>(!0!==t&&e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),ud=rl("position","vec3"),ld=ud.toVarying("positionLocal"),dd=ud.toVarying("positionPrevious"),cd=Ki(e=>Ql.mul(ld).xyz.toVarying(e.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),hd=Ki(()=>ld.transformDirection(Ql).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),pd=Ki(e=>e.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),gd=pd.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class md extends Ys{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if("fragment"!==e.shaderStage)return"true";const{material:t}=e;return t.side===S?"false":e.getFrontFacing()}}const fd=Wi(md),yd=tn(fd).mul(2).sub(1),bd=Ki(([e],{material:t})=>{const r=t.side;return r===S?e=e.mul(-1):r===E&&(e=e.mul(yd)),e}),xd=rl("normal","vec3"),Td=Ki(e=>!1===e.geometry.hasAttribute("normal")?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),dn(0,1,0)):xd,"vec3").once()().toVar("normalLocal"),_d=pd.dFdx().cross(pd.dFdy()).normalize().toVar("normalFlat"),vd=Ki(e=>{let t;return t=!0===e.material.flatShading?_d:wd(Td).toVarying("v_normalViewGeometry").normalize(),t},"vec3").once()().toVar("normalViewGeometry"),Nd=Ki(e=>{let t=vd.transformDirection(Dl);return!0!==e.material.flatShading&&(t=t.toVarying("v_normalWorldGeometry")),t.normalize().toVar("normalWorldGeometry")},"vec3").once()(),Sd=Ki(({subBuildFn:e,material:t,context:r})=>{let s;return"NORMAL"===e||"VERTEX"===e?(s=vd,!0!==t.flatShading&&(s=bd(s))):s=r.setupNormal().context({getUV:null}),s},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),Ed=Sd.transformDirection(Dl).toVar("normalWorld"),Rd=Ki(({subBuildFn:e,context:t})=>{let r;return r="NORMAL"===e||"VERTEX"===e?Sd:t.setupClearcoatNormal().context({getUV:null}),r},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),Ad=Ki(([e,t=Ql])=>{const r=xn(t),s=e.div(dn(r[0].dot(r[0]),r[1].dot(r[1]),r[2].dot(r[2])));return r.mul(s).xyz}),wd=Ki(([e],t)=>{const r=t.renderer.overrideNodes.modelNormalViewMatrix;if(null!==r)return r.transformDirection(e);const s=rd.mul(e);return Dl.transformDirection(s)}),Cd=Ki(()=>(console.warn('THREE.TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),Sd)).once(["NORMAL","VERTEX"])(),Md=Ki(()=>(console.warn('THREE.TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),Ed)).once(["NORMAL","VERTEX"])(),Pd=Ki(()=>(console.warn('THREE.TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),Rd)).once(["NORMAL","VERTEX"])(),Bd=new R,Ld=new a,Fd=oa(0).onReference(({material:e})=>e).onObjectUpdate(({material:e})=>e.refractionRatio),Id=oa(1).onReference(({material:e})=>e).onObjectUpdate(function({material:e,scene:t}){return e.envMap?e.envMapIntensity:t.environmentIntensity}),Dd=oa(new a).onReference(function(e){return e.material}).onObjectUpdate(function({material:e,scene:t}){const r=null!==t.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation;return r?(Bd.copy(r),Ld.makeRotationFromEuler(Bd)):Ld.identity(),Ld}),Ud=gd.negate().reflect(Sd),Vd=gd.negate().refract(Sd,Fd),Od=Ud.transformDirection(Dl).toVar("reflectVector"),Gd=Vd.transformDirection(Dl).toVar("reflectVector"),kd=new A;class zd extends ll{static get type(){return"CubeTextureNode"}constructor(e,t=null,r=null,s=null){super(e,t,r,s),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===w?Od:e.mapping===C?Gd:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),dn(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const r=this.value;return e.renderer.coordinateSystem!==d&&r.isRenderTargetTexture||(t=dn(t.x.negate(),t.yz)),Dd.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const $d=Hi(zd).setParameterLength(1,4).setName("cubeTexture"),Hd=(e=kd,t=null,r=null,s=null)=>{let i;return e&&!0===e.isCubeTextureNode?(i=Gi(e.clone()),i.referenceNode=e,null!==t&&(i.uvNode=Gi(t)),null!==r&&(i.levelNode=Gi(r)),null!==s&&(i.biasNode=Gi(s))):i=$d(e,t,r,s),i};class Wd extends Qs{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),r=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(t,r,s)}}class qd extends Ys{static get type(){return"ReferenceNode"}constructor(e,t,r=null,s=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=s,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.name=null,this.updateType=ks.OBJECT}element(e){return Gi(new Wd(this,Gi(e)))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let t=null;t=null!==this.count?gl(null,e,this.count):Array.isArray(this.getValueFromReference())?yl(null,e):"texture"===e?cl(null):"cubeTexture"===e?Hd(null):oa(null,e),null!==this.group&&t.setGroup(this.group),null!==this.name&&t.setName(this.name),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let r=e[t[0]];for(let e=1;e<t.length;e++)r=r[t[e]];return r}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const jd=(e,t,r)=>Gi(new qd(e,t,r)),Xd=(e,t,r,s)=>Gi(new qd(e,t,s,r));class Kd extends qd{static get type(){return"MaterialReferenceNode"}constructor(e,t,r=null){super(e,t,r),this.material=r,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=null!==this.material?this.material:e.material,this.reference}}const Yd=(e,t,r=null)=>Gi(new Kd(e,t,r)),Qd=sl(),Zd=pd.dFdx(),Jd=pd.dFdy(),ec=Qd.dFdx(),tc=Qd.dFdy(),rc=Sd,sc=Jd.cross(rc),ic=rc.cross(Zd),nc=sc.mul(ec.x).add(ic.mul(tc.x)),ac=sc.mul(ec.y).add(ic.mul(tc.y)),oc=nc.dot(nc).max(ac.dot(ac)),uc=oc.equal(0).select(0,oc.inverseSqrt()),lc=nc.mul(uc).toVar("tangentViewFrame"),dc=ac.mul(uc).toVar("bitangentViewFrame"),cc=Ki(e=>(!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents(),rl("tangent","vec4")))(),hc=cc.xyz.toVar("tangentLocal"),pc=Ki(({subBuildFn:e,geometry:t,material:r})=>{let s;return s="VERTEX"===e||t.hasAttribute("tangent")?id.mul(gn(hc,0)).xyz.toVarying("v_tangentView").normalize():lc,!0!==r.flatShading&&(s=bd(s)),s},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),gc=pc.transformDirection(Dl).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),mc=Ki(([e,t],{subBuildFn:r,material:s})=>{let i=e.mul(cc.w).xyz;return"NORMAL"===r&&!0!==s.flatShading&&(i=i.toVarying(t)),i}).once(["NORMAL"]),fc=mc(xd.cross(cc),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),yc=mc(Td.cross(hc),"v_bitangentLocal").normalize().toVar("bitangentLocal"),bc=Ki(({subBuildFn:e,geometry:t,material:r})=>{let s;return s="VERTEX"===e||t.hasAttribute("tangent")?mc(Sd.cross(pc),"v_bitangentView").normalize():dc,!0!==r.flatShading&&(s=bd(s)),s},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),xc=mc(Ed.cross(gc),"v_bitangentWorld").normalize().toVar("bitangentWorld"),Tc=xn(pc,bc,Sd).toVar("TBNViewMatrix"),_c=gd.mul(Tc),vc=Ki(()=>{let e=Gn.cross(gd);return e=e.cross(Gn).normalize(),e=Ho(e,Sd,Vn.mul(wn.oneMinus()).oneMinus().pow2().pow2()).normalize(),e}).once()();class Nc extends Js{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=M}setup({material:e}){const{normalMapType:t,scaleNode:r}=this;let s=this.node.mul(2).sub(1);if(null!==r){let t=r;!0===e.flatShading&&(t=bd(t)),s=dn(s.xy.mul(t),s.z)}let i=null;return t===P?i=wd(s):t===M?i=Tc.mul(s).normalize():(console.error(`THREE.NodeMaterial: Unsupported normal map type: ${t}`),i=Sd),i}}const Sc=Hi(Nc).setParameterLength(1,2),Ec=Ki(({textureNode:e,bumpScale:t})=>{const r=t=>e.cache().context({getUV:e=>t(e.uvNode||sl()),forceUVContext:!0}),s=tn(r(e=>e));return an(tn(r(e=>e.add(e.dFdx()))).sub(s),tn(r(e=>e.add(e.dFdy()))).sub(s)).mul(t)}),Rc=Ki(e=>{const{surf_pos:t,surf_norm:r,dHdxy:s}=e,i=t.dFdx().normalize(),n=r,a=t.dFdy().normalize().cross(n),o=n.cross(i),u=i.dot(a).mul(yd),l=u.sign().mul(s.x.mul(a).add(s.y.mul(o)));return u.abs().mul(r).sub(l).normalize()});class Ac extends Js{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=null!==this.scaleNode?this.scaleNode:1,t=Ec({textureNode:this.textureNode,bumpScale:e});return Rc({surf_pos:pd,surf_norm:Sd,dHdxy:t})}}const wc=Hi(Ac).setParameterLength(1,2),Cc=new Map;class Mc extends Ys{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let r=Cc.get(e);return void 0===r&&(r=Yd(e,t),Cc.set(e,r)),r}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache("map"===e?"map":e+"Map","texture")}setup(e){const t=e.context.material,r=this.scope;let s=null;if(r===Mc.COLOR){const e=void 0!==t.color?this.getColor(r):dn();s=t.map&&!0===t.map.isTexture?e.mul(this.getTexture("map")):e}else if(r===Mc.OPACITY){const e=this.getFloat(r);s=t.alphaMap&&!0===t.alphaMap.isTexture?e.mul(this.getTexture("alpha")):e}else if(r===Mc.SPECULAR_STRENGTH)s=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture("specular").r:tn(1);else if(r===Mc.SPECULAR_INTENSITY){const e=this.getFloat(r);s=t.specularIntensityMap&&!0===t.specularIntensityMap.isTexture?e.mul(this.getTexture(r).a):e}else if(r===Mc.SPECULAR_COLOR){const e=this.getColor(r);s=t.specularColorMap&&!0===t.specularColorMap.isTexture?e.mul(this.getTexture(r).rgb):e}else if(r===Mc.ROUGHNESS){const e=this.getFloat(r);s=t.roughnessMap&&!0===t.roughnessMap.isTexture?e.mul(this.getTexture(r).g):e}else if(r===Mc.METALNESS){const e=this.getFloat(r);s=t.metalnessMap&&!0===t.metalnessMap.isTexture?e.mul(this.getTexture(r).b):e}else if(r===Mc.EMISSIVE){const e=this.getFloat("emissiveIntensity"),i=this.getColor(r).mul(e);s=t.emissiveMap&&!0===t.emissiveMap.isTexture?i.mul(this.getTexture(r)):i}else if(r===Mc.NORMAL)t.normalMap?(s=Sc(this.getTexture("normal"),this.getCache("normalScale","vec2")),s.normalMapType=t.normalMapType):s=t.bumpMap?wc(this.getTexture("bump").r,this.getFloat("bumpScale")):Sd;else if(r===Mc.CLEARCOAT){const e=this.getFloat(r);s=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?e.mul(this.getTexture(r).r):e}else if(r===Mc.CLEARCOAT_ROUGHNESS){const e=this.getFloat(r);s=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?e.mul(this.getTexture(r).r):e}else if(r===Mc.CLEARCOAT_NORMAL)s=t.clearcoatNormalMap?Sc(this.getTexture(r),this.getCache(r+"Scale","vec2")):Sd;else if(r===Mc.SHEEN){const e=this.getColor("sheenColor").mul(this.getFloat("sheen"));s=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?e.mul(this.getTexture("sheenColor").rgb):e}else if(r===Mc.SHEEN_ROUGHNESS){const e=this.getFloat(r);s=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?e.mul(this.getTexture(r).a):e,s=s.clamp(.07,1)}else if(r===Mc.ANISOTROPY)if(t.anisotropyMap&&!0===t.anisotropyMap.isTexture){const e=this.getTexture(r);s=bn(gh.x,gh.y,gh.y.negate(),gh.x).mul(e.rg.mul(2).sub(an(1)).normalize().mul(e.b))}else s=gh;else if(r===Mc.IRIDESCENCE_THICKNESS){const e=jd("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const i=jd("0","float",t.iridescenceThicknessRange);s=e.sub(i).mul(this.getTexture(r).g).add(i)}else s=e}else if(r===Mc.TRANSMISSION){const e=this.getFloat(r);s=t.transmissionMap?e.mul(this.getTexture(r).r):e}else if(r===Mc.THICKNESS){const e=this.getFloat(r);s=t.thicknessMap?e.mul(this.getTexture(r).g):e}else if(r===Mc.IOR)s=this.getFloat(r);else if(r===Mc.LIGHT_MAP)s=this.getTexture(r).rgb.mul(this.getFloat("lightMapIntensity"));else if(r===Mc.AO)s=this.getTexture(r).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(r===Mc.LINE_DASH_OFFSET)s=t.dashOffset?this.getFloat(r):tn(0);else{const t=this.getNodeType(e);s=this.getCache(r,t)}return s}}Mc.ALPHA_TEST="alphaTest",Mc.COLOR="color",Mc.OPACITY="opacity",Mc.SHININESS="shininess",Mc.SPECULAR="specular",Mc.SPECULAR_STRENGTH="specularStrength",Mc.SPECULAR_INTENSITY="specularIntensity",Mc.SPECULAR_COLOR="specularColor",Mc.REFLECTIVITY="reflectivity",Mc.ROUGHNESS="roughness",Mc.METALNESS="metalness",Mc.NORMAL="normal",Mc.CLEARCOAT="clearcoat",Mc.CLEARCOAT_ROUGHNESS="clearcoatRoughness",Mc.CLEARCOAT_NORMAL="clearcoatNormal",Mc.EMISSIVE="emissive",Mc.ROTATION="rotation",Mc.SHEEN="sheen",Mc.SHEEN_ROUGHNESS="sheenRoughness",Mc.ANISOTROPY="anisotropy",Mc.IRIDESCENCE="iridescence",Mc.IRIDESCENCE_IOR="iridescenceIOR",Mc.IRIDESCENCE_THICKNESS="iridescenceThickness",Mc.IOR="ior",Mc.TRANSMISSION="transmission",Mc.THICKNESS="thickness",Mc.ATTENUATION_DISTANCE="attenuationDistance",Mc.ATTENUATION_COLOR="attenuationColor",Mc.LINE_SCALE="scale",Mc.LINE_DASH_SIZE="dashSize",Mc.LINE_GAP_SIZE="gapSize",Mc.LINE_WIDTH="linewidth",Mc.LINE_DASH_OFFSET="dashOffset",Mc.POINT_SIZE="size",Mc.DISPERSION="dispersion",Mc.LIGHT_MAP="light",Mc.AO="ao";const Pc=Wi(Mc,Mc.ALPHA_TEST),Bc=Wi(Mc,Mc.COLOR),Lc=Wi(Mc,Mc.SHININESS),Fc=Wi(Mc,Mc.EMISSIVE),Ic=Wi(Mc,Mc.OPACITY),Dc=Wi(Mc,Mc.SPECULAR),Uc=Wi(Mc,Mc.SPECULAR_INTENSITY),Vc=Wi(Mc,Mc.SPECULAR_COLOR),Oc=Wi(Mc,Mc.SPECULAR_STRENGTH),Gc=Wi(Mc,Mc.REFLECTIVITY),kc=Wi(Mc,Mc.ROUGHNESS),zc=Wi(Mc,Mc.METALNESS),$c=Wi(Mc,Mc.NORMAL),Hc=Wi(Mc,Mc.CLEARCOAT),Wc=Wi(Mc,Mc.CLEARCOAT_ROUGHNESS),qc=Wi(Mc,Mc.CLEARCOAT_NORMAL),jc=Wi(Mc,Mc.ROTATION),Xc=Wi(Mc,Mc.SHEEN),Kc=Wi(Mc,Mc.SHEEN_ROUGHNESS),Yc=Wi(Mc,Mc.ANISOTROPY),Qc=Wi(Mc,Mc.IRIDESCENCE),Zc=Wi(Mc,Mc.IRIDESCENCE_IOR),Jc=Wi(Mc,Mc.IRIDESCENCE_THICKNESS),eh=Wi(Mc,Mc.TRANSMISSION),th=Wi(Mc,Mc.THICKNESS),rh=Wi(Mc,Mc.IOR),sh=Wi(Mc,Mc.ATTENUATION_DISTANCE),ih=Wi(Mc,Mc.ATTENUATION_COLOR),nh=Wi(Mc,Mc.LINE_SCALE),ah=Wi(Mc,Mc.LINE_DASH_SIZE),oh=Wi(Mc,Mc.LINE_GAP_SIZE),uh=Wi(Mc,Mc.LINE_WIDTH),lh=Wi(Mc,Mc.LINE_DASH_OFFSET),dh=Wi(Mc,Mc.POINT_SIZE),ch=Wi(Mc,Mc.DISPERSION),hh=Wi(Mc,Mc.LIGHT_MAP),ph=Wi(Mc,Mc.AO),gh=oa(new t).onReference(function(e){return e.material}).onRenderUpdate(function({material:e}){this.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation))}),mh=Ki(e=>e.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class fh extends Ys{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),r=this.scope;let s,i;if(r===fh.VERTEX)s=e.getVertexIndex();else if(r===fh.INSTANCE)s=e.getInstanceIndex();else if(r===fh.DRAW)s=e.getDrawIndex();else if(r===fh.INVOCATION_LOCAL)s=e.getInvocationLocalIndex();else if(r===fh.INVOCATION_SUBGROUP)s=e.getInvocationSubgroupIndex();else{if(r!==fh.SUBGROUP)throw new Error("THREE.IndexNode: Unknown scope: "+r);s=e.getSubgroupIndex()}if("vertex"===e.shaderStage||"compute"===e.shaderStage)i=s;else{i=bu(this).build(e,t)}return i}}fh.VERTEX="vertex",fh.INSTANCE="instance",fh.SUBGROUP="subgroup",fh.INVOCATION_LOCAL="invocationLocal",fh.INVOCATION_SUBGROUP="invocationSubgroup",fh.DRAW="draw";const yh=Wi(fh,fh.VERTEX),bh=Wi(fh,fh.INSTANCE),xh=Wi(fh,fh.SUBGROUP),Th=Wi(fh,fh.INVOCATION_SUBGROUP),_h=Wi(fh,fh.INVOCATION_LOCAL),vh=Wi(fh,fh.DRAW);class Nh extends Ys{static get type(){return"InstanceNode"}constructor(e,t,r=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=r,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=ks.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{instanceMatrix:t,instanceColor:r}=this,{count:s}=t;let{instanceMatrixNode:i,instanceColorNode:n}=this;if(null===i){if(s<=1e3)i=gl(t.array,"mat4",Math.max(s,1)).element(bh);else{const e=new B(t.array,16,1);this.buffer=e;const r=t.usage===y?Uu:Du,s=[r(e,"vec4",16,0),r(e,"vec4",16,4),r(e,"vec4",16,8),r(e,"vec4",16,12)];i=Tn(...s)}this.instanceMatrixNode=i}if(r&&null===n){const e=new L(r.array,3),t=r.usage===y?Uu:Du;this.bufferColor=e,n=dn(t(e,"vec3",3,0)),this.instanceColorNode=n}const a=i.mul(ld).xyz;if(ld.assign(a),e.hasGeometryAttribute("normal")){const e=Ad(Td,i);Td.assign(e)}null!==this.instanceColorNode&&En("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==y&&null!==this.buffer&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==y&&null!==this.bufferColor&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}const Sh=Hi(Nh).setParameterLength(2,3);class Eh extends Nh{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:r,instanceColor:s}=e;super(t,r,s),this.instancedMesh=e}}const Rh=Hi(Eh).setParameterLength(1);class Ah extends Ys{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){null===this.batchingIdNode&&(null===e.getDrawIndex()?this.batchingIdNode=bh:this.batchingIdNode=vh);const t=Ki(([e])=>{const t=rn(nl(hl(this.batchMesh._indirectTexture),0).x),r=rn(e).mod(t),s=rn(e).div(t);return hl(this.batchMesh._indirectTexture,on(r,s)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]}),r=t(rn(this.batchingIdNode)),s=this.batchMesh._matricesTexture,i=rn(nl(hl(s),0).x),n=tn(r).mul(4).toInt().toVar(),a=n.mod(i),o=n.div(i),u=Tn(hl(s,on(a,o)),hl(s,on(a.add(1),o)),hl(s,on(a.add(2),o)),hl(s,on(a.add(3),o))),l=this.batchMesh._colorsTexture;if(null!==l){const e=Ki(([e])=>{const t=rn(nl(hl(l),0).x),r=e,s=r.mod(t),i=r.div(t);return hl(l,on(s,i)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]}),t=e(r);En("vec3","vBatchColor").assign(t)}const d=xn(u);ld.assign(u.mul(ld));const c=Td.div(dn(d[0].dot(d[0]),d[1].dot(d[1]),d[2].dot(d[2]))),h=d.mul(c).xyz;Td.assign(h),e.hasGeometryAttribute("tangent")&&hc.mulAssign(d)}}const wh=Hi(Ah).setParameterLength(1);class Ch extends Qs{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const r=this.storageBufferNode.structTypeNode;return r?r.getMemberType(e,t):"void"}setup(e){return!1===e.isAvailable("storageBuffer")&&!0===this.node.isPBO&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let r;const s=e.context.assign;if(r=!1===e.isAvailable("storageBuffer")?!0!==this.node.isPBO||!0===s||!this.node.value.isInstancedBufferAttribute&&"compute"===e.shaderStage?this.node.build(e):e.generatePBO(this):super.generate(e),!0!==s){const s=this.getNodeType(e);r=e.format(r,s,t)}return r}}const Mh=Hi(Ch).setParameterLength(2);class Ph extends pl{static get type(){return"StorageBufferNode"}constructor(e,t=null,r=0){let s,i=null;t&&t.isStruct?(s="struct",i=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(r=e.count)):null===t&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(s=Cs(e.itemSize),r=e.count):s=t,super(e,s,r),this.isStorageBufferNode=!0,this.structTypeNode=i,this.access=$s.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,!0!==e.isStorageBufferAttribute&&!0!==e.isStorageInstancedBufferAttribute&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(0===this.bufferCount){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return Mh(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess($s.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return null===this._attribute&&(this._attribute=Fu(this.value),this._varying=bu(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(null!==this.structTypeNode)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return null!==this.structTypeNode?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(null!==this.structTypeNode&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:r}=this.getAttributeData(),s=r.build(e);return e.registerTransform(s,t),s}}const Bh=(e,t=null,r=0)=>Gi(new Ph(e,t,r)),Lh=new WeakMap;class Fh extends Ys{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=ks.OBJECT,this.skinIndexNode=rl("skinIndex","uvec4"),this.skinWeightNode=rl("skinWeight","vec4"),this.bindMatrixNode=jd("bindMatrix","mat4"),this.bindMatrixInverseNode=jd("bindMatrixInverse","mat4"),this.boneMatricesNode=Xd("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=ld,this.toPositionNode=ld,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:r,skinWeightNode:s,bindMatrixNode:i,bindMatrixInverseNode:n}=this,a=e.element(r.x),o=e.element(r.y),u=e.element(r.z),l=e.element(r.w),d=i.mul(t),c=fa(a.mul(s.x).mul(d),o.mul(s.y).mul(d),u.mul(s.z).mul(d),l.mul(s.w).mul(d));return n.mul(c).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=Td){const{skinIndexNode:r,skinWeightNode:s,bindMatrixNode:i,bindMatrixInverseNode:n}=this,a=e.element(r.x),o=e.element(r.y),u=e.element(r.z),l=e.element(r.w);let d=fa(s.x.mul(a),s.y.mul(o),s.z.mul(u),s.w.mul(l));return d=n.mul(d).mul(i),d.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return null===this.previousBoneMatricesNode&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=Xd("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,dd)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||!0===Ds(e.object).useVelocity}setup(e){this.needsPreviousBoneMatrices(e)&&dd.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const t=this.getSkinnedNormal();Td.assign(t),e.hasGeometryAttribute("tangent")&&hc.assign(t)}return t}generate(e,t){if("void"!==t)return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;Lh.get(t)!==e.frameId&&(Lh.set(t,e.frameId),null!==this.previousBoneMatricesNode&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const Ih=e=>Gi(new Fh(e));class Dh extends Ys{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode("i".charCodeAt(0)+e)}getProperties(e){const t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;const r={};for(let e=0,t=this.params.length-1;e<t;e++){const t=this.params[e],s=!0!==t.isNode&&t.name||this.getVarName(e),i=!0!==t.isNode&&t.type||"int";r[s]=Ku(s,i)}const s=e.addStack();t.returnsNode=this.params[this.params.length-1](r,e),t.stackNode=s;const i=this.params[0];return!0!==i.isNode&&"function"==typeof i.update&&(t.updateNode=Ki(this.params[0].update)(r)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),r=this.params,s=t.stackNode;for(let s=0,i=r.length-1;s<i;s++){const i=r[s];let n,a=!1,o=null,u=null,l=null,d=null,c=null,h=null;if(i.isNode?"bool"===i.getNodeType(e)?(a=!0,d="bool",u=i.build(e,d)):(d="int",l=this.getVarName(s),o="0",u=i.build(e,d),c="<"):(d=i.type||"int",l=i.name||this.getVarName(s),o=i.start,u=i.end,c=i.condition,h=i.update,"number"==typeof o?o=e.generateConst(d,o):o&&o.isNode&&(o=o.build(e,d)),"number"==typeof u?u=e.generateConst(d,u):u&&u.isNode&&(u=u.build(e,d)),void 0!==o&&void 0===u?(o+=" - 1",u="0",c=">="):void 0!==u&&void 0===o&&(o="0",c="<"),void 0===c&&(c=Number(o)>Number(u)?">=":"<")),a)n=`while ( ${u} )`;else{const r={start:o,end:u},s=r.start,i=r.end;let a;const p=()=>c.includes("<")?"+=":"-=";if(null!=h)switch(typeof h){case"function":a=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":a=l+" "+p()+" "+e.generateConst(d,h);break;case"string":a=l+" "+h;break;default:h.isNode?a=l+" "+p()+" "+h.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),a="break /* invalid update */")}else h="int"===d||"uint"===d?c.includes("<")?"++":"--":p()+" 1.",a=l+" "+h;n=`for ( ${e.getVar(d,l)+" = "+s}; ${l+" "+c+" "+i}; ${a} )`}e.addFlowCode((0===s?"\n":"")+e.tab+n+" {\n\n").addFlowTab()}const i=s.build(e,"void"),n=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+i);for(let t=0,r=this.params.length-1;t<r;t++)e.addFlowCode((0===t?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),n}}const Uh=(...e)=>Gi(new Dh($i(e,"int"))).toStack(),Vh=()=>Ku("break").toStack(),Oh=new WeakMap,Gh=new s,kh=Ki(({bufferMap:e,influence:t,stride:r,width:s,depth:i,offset:n})=>{const a=rn(yh).mul(r).add(n),o=a.div(s),u=a.sub(o.mul(s));return hl(e,on(u,o)).depth(i).xyz.mul(t)});class zh extends Ys{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=oa(1),this.updateType=ks.OBJECT}setup(e){const{geometry:r}=e,s=void 0!==r.morphAttributes.position,i=r.hasAttribute("normal")&&void 0!==r.morphAttributes.normal,n=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,a=void 0!==n?n.length:0,{texture:o,stride:u,size:l}=function(e){const r=void 0!==e.morphAttributes.position,s=void 0!==e.morphAttributes.normal,i=void 0!==e.morphAttributes.color,n=e.morphAttributes.position||e.morphAttributes.normal||e.morphAttributes.color,a=void 0!==n?n.length:0;let o=Oh.get(e);if(void 0===o||o.count!==a){void 0!==o&&o.texture.dispose();const u=e.morphAttributes.position||[],l=e.morphAttributes.normal||[],d=e.morphAttributes.color||[];let c=0;!0===r&&(c=1),!0===s&&(c=2),!0===i&&(c=3);let h=e.attributes.position.count*c,p=1;const g=4096;h>g&&(p=Math.ceil(h/g),h=g);const m=new Float32Array(h*p*4*a),f=new F(m,h,p,a);f.type=I,f.needsUpdate=!0;const y=4*c;for(let x=0;x<a;x++){const T=u[x],_=l[x],v=d[x],N=h*p*4*x;for(let S=0;S<T.count;S++){const E=S*y;!0===r&&(Gh.fromBufferAttribute(T,S),m[N+E+0]=Gh.x,m[N+E+1]=Gh.y,m[N+E+2]=Gh.z,m[N+E+3]=0),!0===s&&(Gh.fromBufferAttribute(_,S),m[N+E+4]=Gh.x,m[N+E+5]=Gh.y,m[N+E+6]=Gh.z,m[N+E+7]=0),!0===i&&(Gh.fromBufferAttribute(v,S),m[N+E+8]=Gh.x,m[N+E+9]=Gh.y,m[N+E+10]=Gh.z,m[N+E+11]=4===v.itemSize?Gh.w:1)}}function b(){f.dispose(),Oh.delete(e),e.removeEventListener("dispose",b)}o={count:a,texture:f,stride:c,size:new t(h,p)},Oh.set(e,o),e.addEventListener("dispose",b)}return o}(r);!0===s&&ld.mulAssign(this.morphBaseInfluence),!0===i&&Td.mulAssign(this.morphBaseInfluence);const d=rn(l.width);Uh(a,({i:e})=>{const t=tn(0).toVar();this.mesh.count>1&&null!==this.mesh.morphTexture&&void 0!==this.mesh.morphTexture?t.assign(hl(this.mesh.morphTexture,on(rn(e).add(1),rn(bh))).r):t.assign(jd("morphTargetInfluences","float").element(e).toVar()),Zi(t.notEqual(0),()=>{!0===s&&ld.addAssign(kh({bufferMap:o,influence:t,stride:u,width:d,depth:e,offset:rn(0)})),!0===i&&Td.addAssign(kh({bufferMap:o,influence:t,stride:u,width:d,depth:e,offset:rn(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((e,t)=>e+t,0)}}const $h=Hi(zh).setParameterLength(1);class Hh extends Ys{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class Wh extends Hh{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class qh extends nu{static get type(){return"LightingContextNode"}constructor(e,t=null,r=null,s=null){super(e),this.lightingModel=t,this.backdropNode=r,this.backdropAlphaNode=s,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,r={directDiffuse:dn().toVar("directDiffuse"),directSpecular:dn().toVar("directSpecular"),indirectDiffuse:dn().toVar("indirectDiffuse"),indirectSpecular:dn().toVar("indirectSpecular")};return{radiance:dn().toVar("radiance"),irradiance:dn().toVar("irradiance"),iblIrradiance:dn().toVar("iblIrradiance"),ambientOcclusion:tn(1).toVar("ambientOcclusion"),reflectedLight:r,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const jh=Hi(qh);class Xh extends Hh{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}const Kh=new t;class Yh extends ll{static get type(){return"ViewportTextureNode"}constructor(e=Nl,t=null,r=null){let s=null;null===r?(s=new D,s.minFilter=U,r=s):s=r,super(r,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=s,this.isOutputTextureNode=!0,this.updateBeforeType=ks.FRAME,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let t,r;if(this.referenceNode?(t=this.referenceNode.defaultFramebuffer,r=this.referenceNode._cacheTextures):(t=this.defaultFramebuffer,r=this._cacheTextures),null===e)return t;if(!1===r.has(e)){const s=t.clone();r.set(e,s)}return r.get(e)}updateReference(e){const t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){const t=e.renderer,r=t.getRenderTarget();null===r?t.getDrawingBufferSize(Kh):Kh.set(r.width,r.height);const s=this.getTextureForReference(r);s.image.width===Kh.width&&s.image.height===Kh.height||(s.image.width=Kh.width,s.image.height=Kh.height,s.needsUpdate=!0);const i=s.generateMipmaps;s.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(s),s.generateMipmaps=i}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const Qh=Hi(Yh).setParameterLength(0,3),Zh=Hi(Yh,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let Jh=null;class ep extends Yh{static get type(){return"ViewportDepthTextureNode"}constructor(e=Nl,t=null){null===Jh&&(Jh=new V),super(e,t,Jh)}getTextureForReference(){return Jh}}const tp=Hi(ep).setParameterLength(0,2);class rp extends Ys{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===rp.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,r=this.valueNode;let s=null;if(t===rp.DEPTH_BASE)null!==r&&(s=op().assign(r));else if(t===rp.DEPTH)s=e.isPerspectiveCamera?ip(pd.z,Bl,Ll):sp(pd.z,Bl,Ll);else if(t===rp.LINEAR_DEPTH)if(null!==r)if(e.isPerspectiveCamera){const e=np(r,Bl,Ll);s=sp(e,Bl,Ll)}else s=r;else s=sp(pd.z,Bl,Ll);return s}}rp.DEPTH_BASE="depthBase",rp.DEPTH="depth",rp.LINEAR_DEPTH="linearDepth";const sp=(e,t,r)=>e.add(t).div(t.sub(r)),ip=(e,t,r)=>t.add(e).mul(r).div(r.sub(t).mul(e)),np=(e,t,r)=>t.mul(r).div(r.sub(t).mul(e).sub(r)),ap=(e,t,r)=>{t=t.max(1e-6).toVar();const s=eo(e.negate().div(t)),i=eo(r.div(t));return s.div(i)},op=Hi(rp,rp.DEPTH_BASE),up=Wi(rp,rp.DEPTH),lp=Hi(rp,rp.LINEAR_DEPTH).setParameterLength(0,1),dp=lp(tp());up.assign=e=>op(e);class cp extends Ys{static get type(){return"ClippingNode"}constructor(e=cp.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:r,unionPlanes:s}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===cp.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(r,s):this.scope===cp.HARDWARE?this.setupHardwareClipping(s,e):this.setupDefault(r,s)}setupAlphaToCoverage(e,t){return Ki(()=>{const r=tn().toVar("distanceToPlane"),s=tn().toVar("distanceToGradient"),i=tn(1).toVar("clipOpacity"),n=t.length;if(!1===this.hardwareClipping&&n>0){const e=yl(t).setGroup(ia);Uh(n,({i:t})=>{const n=e.element(t);r.assign(pd.dot(n.xyz).negate().add(n.w)),s.assign(r.fwidth().div(2)),i.mulAssign(Xo(s.negate(),s,r))})}const a=e.length;if(a>0){const t=yl(e).setGroup(ia),n=tn(1).toVar("intersectionClipOpacity");Uh(a,({i:e})=>{const i=t.element(e);r.assign(pd.dot(i.xyz).negate().add(i.w)),s.assign(r.fwidth().div(2)),n.mulAssign(Xo(s.negate(),s,r).oneMinus())}),i.mulAssign(n.oneMinus())}Rn.a.mulAssign(i),Rn.a.equal(0).discard()})()}setupDefault(e,t){return Ki(()=>{const r=t.length;if(!1===this.hardwareClipping&&r>0){const e=yl(t).setGroup(ia);Uh(r,({i:t})=>{const r=e.element(t);pd.dot(r.xyz).greaterThan(r.w).discard()})}const s=e.length;if(s>0){const t=yl(e).setGroup(ia),r=nn(!0).toVar("clipped");Uh(s,({i:e})=>{const s=t.element(e);r.assign(pd.dot(s.xyz).greaterThan(s.w).and(r))}),r.discard()}})()}setupHardwareClipping(e,t){const r=e.length;return t.enableHardwareClipping(r),Ki(()=>{const s=yl(e).setGroup(ia),i=bl(t.getClipDistance());Uh(r,({i:e})=>{const t=s.element(e),r=pd.dot(t.xyz).sub(t.w).negate();i.element(e).assign(r)})})()}}cp.ALPHA_TO_COVERAGE="alphaToCoverage",cp.DEFAULT="default",cp.HARDWARE="hardware";const hp=Ki(([e])=>ao(ba(1e4,oo(ba(17,e.x).add(ba(.1,e.y)))).mul(fa(.1,go(oo(ba(13,e.y).add(e.x))))))),pp=Ki(([e])=>hp(an(hp(e.xy),e.z))),gp=Ki(([e])=>{const t=Mo(fo(xo(e.xyz)),fo(To(e.xyz))),r=tn(1).div(tn(.05).mul(t)).toVar("pixScale"),s=an(Za(so(eo(r))),Za(io(eo(r)))),i=an(pp(so(s.x.mul(e.xyz))),pp(so(s.y.mul(e.xyz)))),n=ao(eo(r)),a=fa(ba(n.oneMinus(),i.x),ba(n,i.y)),o=Co(n,n.oneMinus()),u=dn(a.mul(a).div(ba(2,o).mul(ya(1,o))),a.sub(ba(.5,o)).div(ya(1,o)),ya(1,ya(1,a).mul(ya(1,a)).div(ba(2,o).mul(ya(1,o))))),l=a.lessThan(o.oneMinus()).select(a.lessThan(o).select(u.x,u.y),u.z);return Wo(l,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class mp extends tl{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e);let r;return r=!0===e.hasGeometryAttribute(t)?super.generate(e):e.generateConst(this.nodeType,new s(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const fp=(e=0)=>Gi(new mp(e)),yp=Ki(([e,t])=>Co(1,e.oneMinus().div(t)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),bp=Ki(([e,t])=>Co(e.div(t.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),xp=Ki(([e,t])=>e.oneMinus().mul(t.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Tp=Ki(([e,t])=>Ho(e.mul(2).mul(t),e.oneMinus().mul(2).mul(t.oneMinus()).oneMinus(),Po(.5,e))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),_p=Ki(([e,t])=>{const r=t.a.add(e.a.mul(t.a.oneMinus()));return gn(t.rgb.mul(t.a).add(e.rgb.mul(e.a).mul(t.a.oneMinus())).div(r),r)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),vp=Ki(([e])=>gn(e.rgb.mul(e.a),e.a),{color:"vec4",return:"vec4"}),Np=Ki(([e])=>(Zi(e.a.equal(0),()=>gn(0)),gn(e.rgb.div(e.a),e.a)),{color:"vec4",return:"vec4"});class Sp extends O{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+Es(this)}build(e){this.setup(e)}setupObserver(e){return new Ts(e)}setup(e){e.context.setupNormal=()=>fu(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,r=t.getRenderTarget();e.addStack();const s=fu(this.setupVertex(e),"VERTEX"),i=this.vertexNode||s;let n;e.stack.outputNode=i,this.setupHardwareClipping(e),null!==this.geometryNode&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();const a=this.setupClipping(e);if(!0!==this.depthWrite&&!0!==this.depthTest||(null!==r?!0===r.depthBuffer&&this.setupDepth(e):!0===t.depth&&this.setupDepth(e)),null===this.fragmentNode){this.setupDiffuseColor(e),this.setupVariants(e);const s=this.setupLighting(e);null!==a&&e.stack.add(a);const i=gn(s,Rn.a).max(0);n=this.setupOutput(e,i),Hn.assign(n);const o=null!==this.outputNode;if(o&&(n=this.outputNode),null!==r){const e=t.getMRT(),r=this.mrtNode;null!==e?(o&&Hn.assign(n),n=e,null!==r&&(n=e.merge(r))):null!==r&&(n=r)}}else{let t=this.fragmentNode;!0!==t.isOutputStructNode&&(t=gn(t)),n=this.setupOutput(e,t)}e.stack.outputNode=n,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(null===e.clippingContext)return null;const{unionPlanes:t,intersectionPlanes:r}=e.clippingContext;let s=null;if(t.length>0||r.length>0){const t=e.renderer.samples;this.alphaToCoverage&&t>1?s=Gi(new cp(cp.ALPHA_TO_COVERAGE)):e.stack.add(Gi(new cp))}return s}setupHardwareClipping(e){if(this.hardwareClipping=!1,null===e.clippingContext)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(Gi(new cp(cp.HARDWARE))),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:r}=e;let s=this.depthNode;if(null===s){const e=t.getMRT();e&&e.has("depth")?s=e.get("depth"):!0===t.logarithmicDepthBuffer&&(s=r.isPerspectiveCamera?ap(pd.z,Bl,Ll):sp(pd.z,Bl,Ll))}null!==s&&up.assign(s).toStack()}setupPositionView(){return id.mul(ld).xyz}setupModelViewProjection(){return Fl.mul(pd)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),mh}setupPosition(e){const{object:t,geometry:r}=e;if((r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color)&&$h(t).toStack(),!0===t.isSkinnedMesh&&Ih(t).toStack(),this.displacementMap){const e=Yd("displacementMap","texture"),t=Yd("displacementScale","float"),r=Yd("displacementBias","float");ld.addAssign(Td.normalize().mul(e.x.mul(t).add(r)))}return t.isBatchedMesh&&wh(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&!0===t.instanceMatrix.isInstancedBufferAttribute&&Rh(t).toStack(),null!==this.positionNode&&ld.assign(fu(this.positionNode,"POSITION","vec3")),ld}setupDiffuseColor({object:e,geometry:t}){null!==this.maskNode&&nn(this.maskNode).not().discard();let r=this.colorNode?gn(this.colorNode):Bc;if(!0===this.vertexColors&&t.hasAttribute("color")&&(r=r.mul(fp())),e.instanceColor){r=En("vec3","vInstanceColor").mul(r)}if(e.isBatchedMesh&&e._colorsTexture){r=En("vec3","vBatchColor").mul(r)}Rn.assign(r);const s=this.opacityNode?tn(this.opacityNode):Ic;Rn.a.assign(Rn.a.mul(s));let i=null;(null!==this.alphaTestNode||this.alphaTest>0)&&(i=null!==this.alphaTestNode?tn(this.alphaTestNode):Pc,Rn.a.lessThanEqual(i).discard()),!0===this.alphaHash&&Rn.a.lessThan(gp(ld)).discard();!1===this.transparent&&this.blending===G&&!1===this.alphaToCoverage?Rn.a.assign(1):null===i&&Rn.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return!0===this.lights?dn(0):Rn.rgb}setupNormal(){return this.normalNode?dn(this.normalNode):$c}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Yd("envMap","cubeTexture"):Yd("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Xh(hh)),t}setupLights(e){const t=[],r=this.setupEnvironment(e);r&&r.isLightingNode&&t.push(r);const s=this.setupLightMap(e);if(s&&s.isLightingNode&&t.push(s),null!==this.aoNode||e.material.aoMap){const e=null!==this.aoNode?this.aoNode:ph;t.push(new Wh(e))}let i=this.lightsNode||e.lightsNode;return t.length>0&&(i=e.renderer.lighting.createNode([...i.getLights(),...t])),i}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:r,backdropAlphaNode:s,emissiveNode:i}=this,n=!0===this.lights||null!==this.lightsNode?this.setupLights(e):null;let a=this.setupOutgoingLight(e);if(n&&n.getScope().hasLights){const t=this.setupLightingModel(e)||null;a=jh(n,t,r,s)}else null!==r&&(a=dn(null!==s?Ho(a,r,s):r));return(i&&!0===i.isNode||t.emissive&&!0===t.emissive.isColor)&&(An.assign(dn(i||Fc)),a=a.add(An)),a}setupFog(e,t){const r=e.fogNode;return r&&(Hn.assign(t),t=gn(r.toVar())),t}setupPremultipliedAlpha(e,t){return vp(t)}setupOutput(e,t){return!0===this.fog&&(t=this.setupFog(e,t)),!0===this.premultipliedAlpha&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(const t in e){const r=e[t];void 0===this[t]&&(this[t]=r,r&&r.clone&&(this[t]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const e in t)void 0===Object.getOwnPropertyDescriptor(this.constructor.prototype,e)&&void 0!==t[e].get&&Object.defineProperty(this.constructor.prototype,e,t[e])}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{},nodes:{}});const r=O.prototype.toJSON.call(this,e),s=Rs(this);r.inputNodes={};for(const{property:t,childNode:i}of s)r.inputNodes[t]=i.toJSON(e).uuid;function i(e){const t=[];for(const r in e){const s=e[r];delete s.metadata,t.push(s)}return t}if(t){const t=i(e.textures),s=i(e.images),n=i(e.nodes);t.length>0&&(r.textures=t),s.length>0&&(r.images=s),n.length>0&&(r.nodes=n)}return r}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const Ep=new k;class Rp extends Sp{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(Ep),this.setValues(e)}}const Ap=new z;class wp extends Sp{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(Ap),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?tn(this.offsetNode):lh,t=this.dashScaleNode?tn(this.dashScaleNode):nh,r=this.dashSizeNode?tn(this.dashSizeNode):ah,s=this.gapSizeNode?tn(this.gapSizeNode):oh;Wn.assign(r),qn.assign(s);const i=bu(rl("lineDistance").mul(t));(e?i.add(e):i).mod(Wn.add(qn)).greaterThan(Wn).discard()}}let Cp=null;class Mp extends Yh{static get type(){return"ViewportSharedTextureNode"}constructor(e=Nl,t=null){null===Cp&&(Cp=new D),super(e,t,Cp)}getTextureForReference(){return Cp}updateReference(){return this}}const Pp=Hi(Mp).setParameterLength(0,2),Bp=new z;class Lp extends Sp{static get type(){return"Line2NodeMaterial"}constructor(e={}){super(),this.isLine2NodeMaterial=!0,this.setDefaultValues(Bp),this.useColor=e.vertexColors,this.dashOffset=0,this.lineColorNode=null,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.blending=$,this._useDash=e.dashed,this._useAlphaToCoverage=!0,this._useWorldUnits=!1,this.setValues(e)}setup(e){const{renderer:t}=e,r=this._useAlphaToCoverage,s=this.useColor,i=this._useDash,n=this._useWorldUnits,a=Ki(({start:e,end:t})=>{const r=Fl.element(2).element(2),s=Fl.element(3).element(2).mul(-.5).div(r).sub(e.z).div(t.z.sub(e.z));return gn(Ho(e.xyz,t.xyz,s),t.w)}).setLayout({name:"trimSegment",type:"vec4",inputs:[{name:"start",type:"vec4"},{name:"end",type:"vec4"}]});this.vertexNode=Ki(()=>{const e=rl("instanceStart"),t=rl("instanceEnd"),r=gn(id.mul(gn(e,1))).toVar("start"),s=gn(id.mul(gn(t,1))).toVar("end");if(i){const e=this.dashScaleNode?tn(this.dashScaleNode):nh,t=this.offsetNode?tn(this.offsetNode):lh,r=rl("instanceDistanceStart"),s=rl("instanceDistanceEnd");let i=ud.y.lessThan(.5).select(e.mul(r),e.mul(s));i=i.add(t),En("float","lineDistance").assign(i)}n&&(En("vec3","worldStart").assign(r.xyz),En("vec3","worldEnd").assign(s.xyz));const o=Rl.z.div(Rl.w),u=Fl.element(2).element(3).equal(-1);Zi(u,()=>{Zi(r.z.lessThan(0).and(s.z.greaterThan(0)),()=>{s.assign(a({start:r,end:s}))}).ElseIf(s.z.lessThan(0).and(r.z.greaterThanEqual(0)),()=>{r.assign(a({start:s,end:r}))})});const l=Fl.mul(r),d=Fl.mul(s),c=l.xyz.div(l.w),h=d.xyz.div(d.w),p=h.xy.sub(c.xy).toVar();p.x.assign(p.x.mul(o)),p.assign(p.normalize());const g=gn().toVar();if(n){const e=s.xyz.sub(r.xyz).normalize(),t=Ho(r.xyz,s.xyz,.5).normalize(),n=e.cross(t).normalize(),a=e.cross(n),o=En("vec4","worldPos");o.assign(ud.y.lessThan(.5).select(r,s));const u=uh.mul(.5);o.addAssign(gn(ud.x.lessThan(0).select(n.mul(u),n.mul(u).negate()),0)),i||(o.addAssign(gn(ud.y.lessThan(.5).select(e.mul(u).negate(),e.mul(u)),0)),o.addAssign(gn(a.mul(u),0)),Zi(ud.y.greaterThan(1).or(ud.y.lessThan(0)),()=>{o.subAssign(gn(a.mul(2).mul(u),0))})),g.assign(Fl.mul(o));const l=dn().toVar();l.assign(ud.y.lessThan(.5).select(c,h)),g.z.assign(l.z.mul(g.w))}else{const e=an(p.y,p.x.negate()).toVar("offset");p.x.assign(p.x.div(o)),e.x.assign(e.x.div(o)),e.assign(ud.x.lessThan(0).select(e.negate(),e)),Zi(ud.y.lessThan(0),()=>{e.assign(e.sub(p))}).ElseIf(ud.y.greaterThan(1),()=>{e.assign(e.add(p))}),e.assign(e.mul(uh)),e.assign(e.div(Rl.w)),g.assign(ud.y.lessThan(.5).select(l,d)),e.assign(e.mul(g.w)),g.assign(g.add(gn(e,0,0)))}return g})();const o=Ki(({p1:e,p2:t,p3:r,p4:s})=>{const i=e.sub(r),n=s.sub(r),a=t.sub(e),o=i.dot(n),u=n.dot(a),l=i.dot(a),d=n.dot(n),c=a.dot(a).mul(d).sub(u.mul(u)),h=o.mul(u).sub(l.mul(d)).div(c).clamp(),p=o.add(u.mul(h)).div(d).clamp();return an(h,p)});if(this.colorNode=Ki(()=>{const e=sl();if(i){const t=this.dashSizeNode?tn(this.dashSizeNode):ah,r=this.gapSizeNode?tn(this.gapSizeNode):oh;Wn.assign(t),qn.assign(r);const s=En("float","lineDistance");e.y.lessThan(-1).or(e.y.greaterThan(1)).discard(),s.mod(Wn.add(qn)).greaterThan(Wn).discard()}const a=tn(1).toVar("alpha");if(n){const e=En("vec3","worldStart"),s=En("vec3","worldEnd"),n=En("vec4","worldPos").xyz.normalize().mul(1e5),u=s.sub(e),l=o({p1:e,p2:s,p3:dn(0,0,0),p4:n}),d=e.add(u.mul(l.x)),c=n.mul(l.y),h=d.sub(c).length().div(uh);if(!i)if(r&&t.samples>1){const e=h.fwidth();a.assign(Xo(e.negate().add(.5),e.add(.5),h).oneMinus())}else h.greaterThan(.5).discard()}else if(r&&t.samples>1){const t=e.x,r=e.y.greaterThan(0).select(e.y.sub(1),e.y.add(1)),s=t.mul(t).add(r.mul(r)),i=tn(s.fwidth()).toVar("dlen");Zi(e.y.abs().greaterThan(1),()=>{a.assign(Xo(i.oneMinus(),i.add(1),s).oneMinus())})}else Zi(e.y.abs().greaterThan(1),()=>{const t=e.x,r=e.y.greaterThan(0).select(e.y.sub(1),e.y.add(1));t.mul(t).add(r.mul(r)).greaterThan(1).discard()});let u;if(this.lineColorNode)u=this.lineColorNode;else if(s){const e=rl("instanceColorStart"),t=rl("instanceColorEnd");u=ud.y.lessThan(.5).select(e,t).mul(Bc)}else u=Bc;return gn(u,a)})(),this.transparent){const e=this.opacityNode?tn(this.opacityNode):Ic;this.outputNode=gn(this.colorNode.rgb.mul(e).add(Pp().rgb.mul(e.oneMinus())),this.colorNode.a)}super.setup(e)}get worldUnits(){return this._useWorldUnits}set worldUnits(e){this._useWorldUnits!==e&&(this._useWorldUnits=e,this.needsUpdate=!0)}get dashed(){return this._useDash}set dashed(e){this._useDash!==e&&(this._useDash=e,this.needsUpdate=!0)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const Fp=e=>Gi(e).mul(.5).add(.5),Ip=new H;class Dp extends Sp{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Ip),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?tn(this.opacityNode):Ic;Rn.assign(Eu(gn(Fp(Sd),e),W))}}const Up=Ki(([e=hd])=>{const t=e.z.atan(e.x).mul(1/(2*Math.PI)).add(.5),r=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return an(t,r)});class Vp extends q{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const r=t.minFilter,s=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i=new j(5,5,5),n=Up(hd),a=new Sp;a.colorNode=cl(t,n,0),a.side=S,a.blending=$;const o=new X(i,a),u=new K;u.add(o),t.minFilter===U&&(t.minFilter=Y);const l=new Q(1,10,this),d=e.getMRT();return e.setMRT(null),l.update(e,u),e.setMRT(d),t.minFilter=r,t.currentGenerateMipmaps=s,o.geometry.dispose(),o.material.dispose(),this}}const Op=new WeakMap;class Gp extends Js{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=Hd(null);const t=new A;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=ks.RENDER}updateBefore(e){const{renderer:t,material:r}=e,s=this.envNode;if(s.isTextureNode||s.isMaterialReferenceNode){const e=s.isTextureNode?s.value:r[s.property];if(e&&e.isTexture){const r=e.mapping;if(r===Z||r===J){if(Op.has(e)){const t=Op.get(e);zp(t,e.mapping),this._cubeTexture=t}else{const r=e.image;if(function(e){return null!=e&&e.height>0}(r)){const s=new Vp(r.height);s.fromEquirectangularTexture(t,e),zp(s.texture,e.mapping),this._cubeTexture=s.texture,Op.set(e,s.texture),e.addEventListener("dispose",kp)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function kp(e){const t=e.target;t.removeEventListener("dispose",kp);const r=Op.get(t);void 0!==r&&(Op.delete(t),r.dispose())}function zp(e,t){t===Z?e.mapping=w:t===J&&(e.mapping=C)}const $p=Hi(Gp).setParameterLength(1);class Hp extends Hh{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=$p(this.envNode)}}class Wp extends Hh{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=tn(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class qp{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class jp extends qp{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,r=e.reflectedLight,s=e.irradianceLightMap;r.indirectDiffuse.assign(gn(0)),s?r.indirectDiffuse.addAssign(s):r.indirectDiffuse.addAssign(gn(1,1,1,0)),r.indirectDiffuse.mulAssign(t),r.indirectDiffuse.mulAssign(Rn.rgb)}finish(e){const{material:t,context:r}=e,s=r.outgoingLight,i=e.context.environment;if(i)switch(t.combine){case re:s.rgb.assign(Ho(s.rgb,s.rgb.mul(i.rgb),Oc.mul(Gc)));break;case te:s.rgb.assign(Ho(s.rgb,i.rgb,Oc.mul(Gc)));break;case ee:s.rgb.addAssign(i.rgb.mul(Oc.mul(Gc)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine)}}}const Xp=new se;class Kp extends Sp{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Xp),this.setValues(e)}setupNormal(){return bd(vd)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Hp(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Wp(hh)),t}setupOutgoingLight(){return Rn.rgb}setupLightingModel(){return new jp}}const Yp=Ki(({f0:e,f90:t,dotVH:r})=>{const s=r.mul(-5.55473).sub(6.98316).mul(r).exp2();return e.mul(s.oneMinus()).add(t.mul(s))}),Qp=Ki(e=>e.diffuseColor.mul(1/Math.PI)),Zp=Ki(({dotNH:e})=>$n.mul(tn(.5)).add(1).mul(tn(1/Math.PI)).mul(e.pow($n))),Jp=Ki(({lightDirection:e})=>{const t=e.add(gd).normalize(),r=Sd.dot(t).clamp(),s=gd.dot(t).clamp(),i=Yp({f0:kn,f90:1,dotVH:s}),n=tn(.25),a=Zp({dotNH:r});return i.mul(n).mul(a)});class eg extends jp{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:r}){const s=Sd.dot(e).clamp().mul(t);r.directDiffuse.addAssign(s.mul(Qp({diffuseColor:Rn.rgb}))),!0===this.specular&&r.directSpecular.addAssign(s.mul(Jp({lightDirection:e})).mul(Oc))}indirect(e){const{ambientOcclusion:t,irradiance:r,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(r.mul(Qp({diffuseColor:Rn}))),s.indirectDiffuse.mulAssign(t)}}const tg=new ie;class rg extends Sp{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(tg),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Hp(t):null}setupLightingModel(){return new eg(!1)}}const sg=new ne;class ig extends Sp{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(sg),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Hp(t):null}setupLightingModel(){return new eg}setupVariants(){const e=(this.shininessNode?tn(this.shininessNode):Lc).max(1e-4);$n.assign(e);const t=this.specularNode||Dc;kn.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const ng=Ki(e=>{if(!1===e.geometry.hasAttribute("normal"))return tn(0);const t=vd.dFdx().abs().max(vd.dFdy().abs());return t.x.max(t.y).max(t.z)}),ag=Ki(e=>{const{roughness:t}=e,r=ng();let s=t.max(.0525);return s=s.add(r),s=s.min(1),s}),og=Ki(({alpha:e,dotNL:t,dotNV:r})=>{const s=e.pow2(),i=t.mul(s.add(s.oneMinus().mul(r.pow2())).sqrt()),n=r.mul(s.add(s.oneMinus().mul(t.pow2())).sqrt());return xa(.5,i.add(n).max($a))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),ug=Ki(({alphaT:e,alphaB:t,dotTV:r,dotBV:s,dotTL:i,dotBL:n,dotNV:a,dotNL:o})=>{const u=o.mul(dn(e.mul(r),t.mul(s),a).length()),l=a.mul(dn(e.mul(i),t.mul(n),o).length());return xa(.5,u.add(l)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),lg=Ki(({alpha:e,dotNH:t})=>{const r=e.pow2(),s=t.pow2().mul(r.oneMinus()).oneMinus();return r.div(s.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),dg=tn(1/Math.PI),cg=Ki(({alphaT:e,alphaB:t,dotNH:r,dotTH:s,dotBH:i})=>{const n=e.mul(t),a=dn(t.mul(s),e.mul(i),n.mul(r)),o=a.dot(a),u=n.div(o);return dg.mul(n.mul(u.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),hg=Ki(({lightDirection:e,f0:t,f90:r,roughness:s,f:i,normalView:n=Sd,USE_IRIDESCENCE:a,USE_ANISOTROPY:o})=>{const u=s.pow2(),l=e.add(gd).normalize(),d=n.dot(e).clamp(),c=n.dot(gd).clamp(),h=n.dot(l).clamp(),p=gd.dot(l).clamp();let g,m,f=Yp({f0:t,f90:r,dotVH:p});if(Ui(a)&&(f=Fn.mix(f,i)),Ui(o)){const t=On.dot(e),r=On.dot(gd),s=On.dot(l),i=Gn.dot(e),n=Gn.dot(gd),a=Gn.dot(l);g=ug({alphaT:Un,alphaB:u,dotTV:r,dotBV:n,dotTL:t,dotBL:i,dotNV:c,dotNL:d}),m=cg({alphaT:Un,alphaB:u,dotNH:h,dotTH:s,dotBH:a})}else g=og({alpha:u,dotNL:d,dotNV:c}),m=lg({alpha:u,dotNH:h});return f.mul(g).mul(m)}),pg=Ki(({roughness:e,dotNV:t})=>{const r=gn(-1,-.0275,-.572,.022),s=gn(1,.0425,1.04,-.04),i=e.mul(r).add(s),n=i.x.mul(i.x).min(t.mul(-9.28).exp2()).mul(i.x).add(i.y);return an(-1.04,1.04).mul(n).add(i.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),gg=Ki(e=>{const{dotNV:t,specularColor:r,specularF90:s,roughness:i}=e,n=pg({dotNV:t,roughness:i});return r.mul(n.x).add(s.mul(n.y))}),mg=Ki(({f:e,f90:t,dotVH:r})=>{const s=r.oneMinus().saturate(),i=s.mul(s),n=s.mul(i,i).clamp(0,.9999);return e.sub(dn(t).mul(n)).div(n.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),fg=Ki(({roughness:e,dotNH:t})=>{const r=e.pow2(),s=tn(1).div(r),i=t.pow2().oneMinus().max(.0078125);return tn(2).add(s).mul(i.pow(s.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),yg=Ki(({dotNV:e,dotNL:t})=>tn(1).div(tn(4).mul(t.add(e).sub(t.mul(e))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),bg=Ki(({lightDirection:e})=>{const t=e.add(gd).normalize(),r=Sd.dot(e).clamp(),s=Sd.dot(gd).clamp(),i=Sd.dot(t).clamp(),n=fg({roughness:Ln,dotNH:i}),a=yg({dotNV:s,dotNL:r});return Bn.mul(n).mul(a)}),xg=Ki(({N:e,V:t,roughness:r})=>{const s=e.dot(t).saturate(),i=an(r,s.oneMinus().sqrt());return i.assign(i.mul(.984375).add(.0078125)),i}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),Tg=Ki(({f:e})=>{const t=e.length();return Mo(t.mul(t).add(e.z).div(t.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),_g=Ki(({v1:e,v2:t})=>{const r=e.dot(t),s=r.abs().toVar(),i=s.mul(.0145206).add(.4965155).mul(s).add(.8543985).toVar(),n=s.add(4.1616724).mul(s).add(3.417594).toVar(),a=i.div(n),o=r.greaterThan(0).select(a,Mo(r.mul(r).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return e.cross(t).mul(o)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),vg=Ki(({N:e,V:t,P:r,mInv:s,p0:i,p1:n,p2:a,p3:o})=>{const u=n.sub(i).toVar(),l=o.sub(i).toVar(),d=u.cross(l),c=dn().toVar();return Zi(d.dot(r.sub(i)).greaterThanEqual(0),()=>{const u=t.sub(e.mul(t.dot(e))).normalize(),l=e.cross(u).negate(),d=s.mul(xn(u,l,e).transpose()).toVar(),h=d.mul(i.sub(r)).normalize().toVar(),p=d.mul(n.sub(r)).normalize().toVar(),g=d.mul(a.sub(r)).normalize().toVar(),m=d.mul(o.sub(r)).normalize().toVar(),f=dn(0).toVar();f.addAssign(_g({v1:h,v2:p})),f.addAssign(_g({v1:p,v2:g})),f.addAssign(_g({v1:g,v2:m})),f.addAssign(_g({v1:m,v2:h})),c.assign(dn(Tg({f:f})))}),c}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),Ng=Ki(({P:e,p0:t,p1:r,p2:s,p3:i})=>{const n=r.sub(t).toVar(),a=i.sub(t).toVar(),o=n.cross(a),u=dn().toVar();return Zi(o.dot(e.sub(t)).greaterThanEqual(0),()=>{const n=t.sub(e).normalize().toVar(),a=r.sub(e).normalize().toVar(),o=s.sub(e).normalize().toVar(),l=i.sub(e).normalize().toVar(),d=dn(0).toVar();d.addAssign(_g({v1:n,v2:a})),d.addAssign(_g({v1:a,v2:o})),d.addAssign(_g({v1:o,v2:l})),d.addAssign(_g({v1:l,v2:n})),u.assign(dn(Tg({f:d.abs()})))}),u}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"P",type:"vec3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),Sg=1/6,Eg=e=>ba(Sg,ba(e,ba(e,e.negate().add(3)).sub(3)).add(1)),Rg=e=>ba(Sg,ba(e,ba(e,ba(3,e).sub(6))).add(4)),Ag=e=>ba(Sg,ba(e,ba(e,ba(-3,e).add(3)).add(3)).add(1)),wg=e=>ba(Sg,Uo(e,3)),Cg=e=>Eg(e).add(Rg(e)),Mg=e=>Ag(e).add(wg(e)),Pg=e=>fa(-1,Rg(e).div(Eg(e).add(Rg(e)))),Bg=e=>fa(1,wg(e).div(Ag(e).add(wg(e)))),Lg=(e,t,r)=>{const s=e.uvNode,i=ba(s,t.zw).add(.5),n=so(i),a=ao(i),o=Cg(a.x),u=Mg(a.x),l=Pg(a.x),d=Bg(a.x),c=Pg(a.y),h=Bg(a.y),p=an(n.x.add(l),n.y.add(c)).sub(.5).mul(t.xy),g=an(n.x.add(d),n.y.add(c)).sub(.5).mul(t.xy),m=an(n.x.add(l),n.y.add(h)).sub(.5).mul(t.xy),f=an(n.x.add(d),n.y.add(h)).sub(.5).mul(t.xy),y=Cg(a.y).mul(fa(o.mul(e.sample(p).level(r)),u.mul(e.sample(g).level(r)))),b=Mg(a.y).mul(fa(o.mul(e.sample(m).level(r)),u.mul(e.sample(f).level(r))));return y.add(b)},Fg=Ki(([e,t])=>{const r=an(e.size(rn(t))),s=an(e.size(rn(t.add(1)))),i=xa(1,r),n=xa(1,s),a=Lg(e,gn(i,r),so(t)),o=Lg(e,gn(n,s),io(t));return ao(t).mix(a,o)}),Ig=Ki(([e,t])=>{const r=t.mul(ol(e));return Fg(e,r)}),Dg=Ki(([e,t,r,s,i])=>{const n=dn(jo(t.negate(),no(e),xa(1,s))),a=dn(fo(i[0].xyz),fo(i[1].xyz),fo(i[2].xyz));return no(n).mul(r.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),Ug=Ki(([e,t])=>e.mul(Wo(t.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),Vg=Zh(),Og=Zh(),Gg=Ki(([e,t,r],{material:s})=>{const i=(s.side===S?Vg:Og).sample(e),n=eo(Sl.x).mul(Ug(t,r));return Fg(i,n)}),kg=Ki(([e,t,r])=>(Zi(r.notEqual(0),()=>{const s=Ja(t).negate().div(r);return Qa(s.negate().mul(e))}),dn(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),zg=Ki(([e,t,r,s,i,n,a,o,u,l,d,c,h,p,g])=>{let m,f;if(g){m=gn().toVar(),f=dn().toVar();const i=d.sub(1).mul(g.mul(.025)),n=dn(d.sub(i),d,d.add(i));Uh({start:0,end:3},({i:i})=>{const d=n.element(i),g=Dg(e,t,c,d,o),y=a.add(g),b=l.mul(u.mul(gn(y,1))),x=an(b.xy.div(b.w)).toVar();x.addAssign(1),x.divAssign(2),x.assign(an(x.x,x.y.oneMinus()));const T=Gg(x,r,d);m.element(i).assign(T.element(i)),m.a.addAssign(T.a),f.element(i).assign(s.element(i).mul(kg(fo(g),h,p).element(i)))}),m.a.divAssign(3)}else{const i=Dg(e,t,c,d,o),n=a.add(i),g=l.mul(u.mul(gn(n,1))),y=an(g.xy.div(g.w)).toVar();y.addAssign(1),y.divAssign(2),y.assign(an(y.x,y.y.oneMinus())),m=Gg(y,r,d),f=s.mul(kg(fo(i),h,p))}const y=f.rgb.mul(m.rgb),b=e.dot(t).clamp(),x=dn(gg({dotNV:b,specularColor:i,specularF90:n,roughness:r})),T=f.r.add(f.g,f.b).div(3);return gn(x.oneMinus().mul(y),m.a.oneMinus().mul(T).oneMinus())}),$g=xn(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),Hg=(e,t)=>e.sub(t).div(e.add(t)).pow2(),Wg=Ki(({outsideIOR:e,eta2:t,cosTheta1:r,thinFilmThickness:s,baseF0:i})=>{const n=Ho(e,t,Xo(0,.03,s)),a=e.div(n).pow2().mul(r.pow2().oneMinus()).oneMinus();Zi(a.lessThan(0),()=>dn(1));const o=a.sqrt(),u=Hg(n,e),l=Yp({f0:u,f90:1,dotVH:r}),d=l.oneMinus(),c=n.lessThan(e).select(Math.PI,0),h=tn(Math.PI).sub(c),p=(e=>{const t=e.sqrt();return dn(1).add(t).div(dn(1).sub(t))})(i.clamp(0,.9999)),g=Hg(p,n.toVec3()),m=Yp({f0:g,f90:1,dotVH:o}),f=dn(p.x.lessThan(n).select(Math.PI,0),p.y.lessThan(n).select(Math.PI,0),p.z.lessThan(n).select(Math.PI,0)),y=n.mul(s,o,2),b=dn(h).add(f),x=l.mul(m).clamp(1e-5,.9999),T=x.sqrt(),_=d.pow2().mul(m).div(dn(1).sub(x)),v=l.add(_).toVar(),N=_.sub(d).toVar();return Uh({start:1,end:2,condition:"<=",name:"m"},({m:e})=>{N.mulAssign(T);const t=((e,t)=>{const r=e.mul(2*Math.PI*1e-9),s=dn(54856e-17,44201e-17,52481e-17),i=dn(1681e3,1795300,2208400),n=dn(43278e5,93046e5,66121e5),a=tn(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(r.mul(2239900).add(t.x).cos()).mul(r.pow2().mul(-45282e5).exp());let o=s.mul(n.mul(2*Math.PI).sqrt()).mul(i.mul(r).add(t).cos()).mul(r.pow2().negate().mul(n).exp());return o=dn(o.x.add(a),o.y,o.z).div(1.0685e-7),$g.mul(o)})(tn(e).mul(y),tn(e).mul(b)).mul(2);v.addAssign(N.mul(t))}),v.max(dn(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),qg=Ki(({normal:e,viewDir:t,roughness:r})=>{const s=e.dot(t).saturate(),i=r.pow2(),n=iu(r.lessThan(.25),tn(-339.2).mul(i).add(tn(161.4).mul(r)).sub(25.9),tn(-8.48).mul(i).add(tn(14.3).mul(r)).sub(9.95)),a=iu(r.lessThan(.25),tn(44).mul(i).sub(tn(23.7).mul(r)).add(3.26),tn(1.97).mul(i).sub(tn(3.27).mul(r)).add(.72));return iu(r.lessThan(.25),0,tn(.1).mul(r).sub(.025)).add(n.mul(s).add(a).exp()).mul(1/Math.PI).saturate()}),jg=dn(.04),Xg=tn(1);class Kg extends qp{constructor(e=!1,t=!1,r=!1,s=!1,i=!1,n=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=r,this.anisotropy=s,this.transmission=i,this.dispersion=n,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(!0===this.clearcoat&&(this.clearcoatRadiance=dn().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=dn().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=dn().toVar("clearcoatSpecularIndirect")),!0===this.sheen&&(this.sheenSpecularDirect=dn().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=dn().toVar("sheenSpecularIndirect")),!0===this.iridescence){const e=Sd.dot(gd).clamp();this.iridescenceFresnel=Wg({outsideIOR:tn(1),eta2:In,cosTheta1:e,thinFilmThickness:Dn,baseF0:kn}),this.iridescenceF0=mg({f:this.iridescenceFresnel,f90:1,dotVH:e})}if(!0===this.transmission){const t=cd,r=Ol.sub(cd).normalize(),s=Ed,i=e.context;i.backdrop=zg(s,r,wn,Rn,kn,zn,t,Ql,Dl,Fl,Xn,Yn,Zn,Qn,this.dispersion?Jn:null),i.backdropAlpha=Kn,Rn.a.mulAssign(Ho(1,i.backdrop.a,Kn))}super.start(e)}computeMultiscattering(e,t,r){const s=Sd.dot(gd).clamp(),i=pg({roughness:wn,dotNV:s}),n=(this.iridescenceF0?Fn.mix(kn,this.iridescenceF0):kn).mul(i.x).add(r.mul(i.y)),a=i.x.add(i.y).oneMinus(),o=kn.add(kn.oneMinus().mul(.047619)),u=n.mul(o).div(a.mul(o).oneMinus());e.addAssign(n),t.addAssign(u.mul(a))}direct({lightDirection:e,lightColor:t,reflectedLight:r}){const s=Sd.dot(e).clamp().mul(t);if(!0===this.sheen&&this.sheenSpecularDirect.addAssign(s.mul(bg({lightDirection:e}))),!0===this.clearcoat){const r=Rd.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(r.mul(hg({lightDirection:e,f0:jg,f90:Xg,roughness:Pn,normalView:Rd})))}r.directDiffuse.addAssign(s.mul(Qp({diffuseColor:Rn.rgb}))),r.directSpecular.addAssign(s.mul(hg({lightDirection:e,f0:kn,f90:1,roughness:wn,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:r,halfHeight:s,reflectedLight:i,ltc_1:n,ltc_2:a}){const o=t.add(r).sub(s),u=t.sub(r).sub(s),l=t.sub(r).add(s),d=t.add(r).add(s),c=Sd,h=gd,p=pd.toVar(),g=xg({N:c,V:h,roughness:wn}),m=n.sample(g).toVar(),f=a.sample(g).toVar(),y=xn(dn(m.x,0,m.y),dn(0,1,0),dn(m.z,0,m.w)).toVar(),b=kn.mul(f.x).add(kn.oneMinus().mul(f.y)).toVar();i.directSpecular.addAssign(e.mul(b).mul(vg({N:c,V:h,P:p,mInv:y,p0:o,p1:u,p2:l,p3:d}))),i.directDiffuse.addAssign(e.mul(Rn).mul(vg({N:c,V:h,P:p,mInv:xn(1,0,0,0,1,0,0,0,1),p0:o,p1:u,p2:l,p3:d})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(t.mul(Qp({diffuseColor:Rn})))}indirectSpecular(e){const{radiance:t,iblIrradiance:r,reflectedLight:s}=e.context;if(!0===this.sheen&&this.sheenSpecularIndirect.addAssign(r.mul(Bn,qg({normal:Sd,viewDir:gd,roughness:Ln}))),!0===this.clearcoat){const e=Rd.dot(gd).clamp(),t=gg({dotNV:e,specularColor:jg,specularF90:Xg,roughness:Pn});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(t))}const i=dn().toVar("singleScattering"),n=dn().toVar("multiScattering"),a=r.mul(1/Math.PI);this.computeMultiscattering(i,n,zn);const o=i.add(n),u=Rn.mul(o.r.max(o.g).max(o.b).oneMinus());s.indirectSpecular.addAssign(t.mul(i)),s.indirectSpecular.addAssign(n.mul(a)),s.indirectDiffuse.addAssign(u.mul(a))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:r}=e.context,s=Sd.dot(gd).clamp().add(t),i=wn.mul(-16).oneMinus().negate().exp2(),n=t.sub(s.pow(i).oneMinus()).clamp();!0===this.clearcoat&&this.clearcoatSpecularIndirect.mulAssign(t),!0===this.sheen&&this.sheenSpecularIndirect.mulAssign(t),r.indirectDiffuse.mulAssign(t),r.indirectSpecular.mulAssign(n)}finish({context:e}){const{outgoingLight:t}=e;if(!0===this.clearcoat){const e=Rd.dot(gd).clamp(),r=Yp({dotVH:e,f0:jg,f90:Xg}),s=t.mul(Mn.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(Mn));t.assign(s)}if(!0===this.sheen){const e=Bn.r.max(Bn.g).max(Bn.b).mul(.157).oneMinus(),r=t.mul(e).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const Yg=tn(1),Qg=tn(-2),Zg=tn(.8),Jg=tn(-1),em=tn(.4),tm=tn(2),rm=tn(.305),sm=tn(3),im=tn(.21),nm=tn(4),am=tn(4),om=tn(16),um=Ki(([e])=>{const t=dn(go(e)).toVar(),r=tn(-1).toVar();return Zi(t.x.greaterThan(t.z),()=>{Zi(t.x.greaterThan(t.y),()=>{r.assign(iu(e.x.greaterThan(0),0,3))}).Else(()=>{r.assign(iu(e.y.greaterThan(0),1,4))})}).Else(()=>{Zi(t.z.greaterThan(t.y),()=>{r.assign(iu(e.z.greaterThan(0),2,5))}).Else(()=>{r.assign(iu(e.y.greaterThan(0),1,4))})}),r}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),lm=Ki(([e,t])=>{const r=an().toVar();return Zi(t.equal(0),()=>{r.assign(an(e.z,e.y).div(go(e.x)))}).ElseIf(t.equal(1),()=>{r.assign(an(e.x.negate(),e.z.negate()).div(go(e.y)))}).ElseIf(t.equal(2),()=>{r.assign(an(e.x.negate(),e.y).div(go(e.z)))}).ElseIf(t.equal(3),()=>{r.assign(an(e.z.negate(),e.y).div(go(e.x)))}).ElseIf(t.equal(4),()=>{r.assign(an(e.x.negate(),e.z).div(go(e.y)))}).Else(()=>{r.assign(an(e.x,e.y).div(go(e.z)))}),ba(.5,r.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),dm=Ki(([e])=>{const t=tn(0).toVar();return Zi(e.greaterThanEqual(Zg),()=>{t.assign(Yg.sub(e).mul(Jg.sub(Qg)).div(Yg.sub(Zg)).add(Qg))}).ElseIf(e.greaterThanEqual(em),()=>{t.assign(Zg.sub(e).mul(tm.sub(Jg)).div(Zg.sub(em)).add(Jg))}).ElseIf(e.greaterThanEqual(rm),()=>{t.assign(em.sub(e).mul(sm.sub(tm)).div(em.sub(rm)).add(tm))}).ElseIf(e.greaterThanEqual(im),()=>{t.assign(rm.sub(e).mul(nm.sub(sm)).div(rm.sub(im)).add(sm))}).Else(()=>{t.assign(tn(-2).mul(eo(ba(1.16,e))))}),t}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),cm=Ki(([e,t])=>{const r=e.toVar();r.assign(ba(2,r).sub(1));const s=dn(r,1).toVar();return Zi(t.equal(0),()=>{s.assign(s.zyx)}).ElseIf(t.equal(1),()=>{s.assign(s.xzy),s.xz.mulAssign(-1)}).ElseIf(t.equal(2),()=>{s.x.mulAssign(-1)}).ElseIf(t.equal(3),()=>{s.assign(s.zyx),s.xz.mulAssign(-1)}).ElseIf(t.equal(4),()=>{s.assign(s.xzy),s.xy.mulAssign(-1)}).ElseIf(t.equal(5),()=>{s.z.mulAssign(-1)}),s}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),hm=Ki(([e,t,r,s,i,n])=>{const a=tn(r),o=dn(t),u=Wo(dm(a),Qg,n),l=ao(u),d=so(u),c=dn(pm(e,o,d,s,i,n)).toVar();return Zi(l.notEqual(0),()=>{const t=dn(pm(e,o,d.add(1),s,i,n)).toVar();c.assign(Ho(c,t,l))}),c}),pm=Ki(([e,t,r,s,i,n])=>{const a=tn(r).toVar(),o=dn(t),u=tn(um(o)).toVar(),l=tn(Mo(am.sub(a),0)).toVar();a.assign(Mo(a,am));const d=tn(Za(a)).toVar(),c=an(lm(o,u).mul(d.sub(2)).add(1)).toVar();return Zi(u.greaterThan(2),()=>{c.y.addAssign(d),u.subAssign(3)}),c.x.addAssign(u.mul(d)),c.x.addAssign(l.mul(ba(3,om))),c.y.addAssign(ba(4,Za(n).sub(d))),c.x.mulAssign(s),c.y.mulAssign(i),e.sample(c).grad(an(),an())}),gm=Ki(({envMap:e,mipInt:t,outputDirection:r,theta:s,axis:i,CUBEUV_TEXEL_WIDTH:n,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:o})=>{const u=uo(s),l=r.mul(u).add(i.cross(r).mul(oo(s))).add(i.mul(i.dot(r).mul(u.oneMinus())));return pm(e,l,t,n,a,o)}),mm=Ki(({n:e,latitudinal:t,poleAxis:r,outputDirection:s,weights:i,samples:n,dTheta:a,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c})=>{const h=dn(iu(t,r,Do(r,s))).toVar();Zi(h.equal(dn(0)),()=>{h.assign(dn(s.z,0,s.x.negate()))}),h.assign(no(h));const p=dn().toVar();return p.addAssign(i.element(0).mul(gm({theta:0,axis:h,outputDirection:s,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c}))),Uh({start:rn(1),end:e},({i:e})=>{Zi(e.greaterThanEqual(n),()=>{Vh()});const t=tn(a.mul(tn(e))).toVar();p.addAssign(i.element(e).mul(gm({theta:t.mul(-1),axis:h,outputDirection:s,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c}))),p.addAssign(i.element(e).mul(gm({theta:t,axis:h,outputDirection:s,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c})))}),gn(p,1)}),fm=[.125,.215,.35,.446,.526,.582],ym=20,bm=new ae(-1,1,1,-1,0,1),xm=new oe(90,1),Tm=new e;let _m=null,vm=0,Nm=0;const Sm=(1+Math.sqrt(5))/2,Em=1/Sm,Rm=[new r(-Sm,Em,0),new r(Sm,Em,0),new r(-Em,0,Sm),new r(Em,0,Sm),new r(0,Sm,-Em),new r(0,Sm,Em),new r(-1,1,-1),new r(1,1,-1),new r(-1,1,1),new r(1,1,1)],Am=new r,wm=new WeakMap,Cm=[3,1,5,0,4,2],Mm=cm(sl(),rl("faceIndex")).normalize(),Pm=dn(Mm.x,Mm.y,Mm.z);class Bm{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,r=.1,s=100,i={}){const{size:n=256,position:a=Am,renderTarget:o=null}=i;if(this._setSize(n),!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const n=o||this._allocateTarget();return i.renderTarget=n,this.fromSceneAsync(e,t,r,s,i),n}_m=this._renderer.getRenderTarget(),vm=this._renderer.getActiveCubeFace(),Nm=this._renderer.getActiveMipmapLevel();const u=o||this._allocateTarget();return u.depthBuffer=!0,this._init(u),this._sceneToCubeUV(e,r,s,u,a),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,t=0,r=.1,s=100,i={}){return!1===this._hasInitialized&&await this._renderer.init(),this.fromScene(e,t,r,s,i)}fromEquirectangular(e,t=null){if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const r=t||this._allocateTarget();return this.fromEquirectangularAsync(e,r),r}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return!1===this._hasInitialized&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const r=t||this._allocateTarget();return this.fromCubemapAsync(e,t),r}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return!1===this._hasInitialized&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Dm(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Um(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===w||e.mapping===C?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_m,vm,Nm),e.scissorTest=!1,Fm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),_m=this._renderer.getRenderTarget(),vm=this._renderer.getActiveCubeFace(),Nm=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTarget();return this._init(r),this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTarget(){return Lm(3*Math.max(this._cubeSize,112),4*this._cubeSize)}_init(e){if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Lm(e.width,e.height);const{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=function(e){const t=[],r=[],s=[],i=[];let n=e;const a=e-4+1+fm.length;for(let o=0;o<a;o++){const a=Math.pow(2,n);r.push(a);let u=1/a;o>e-4?u=fm[o-e+4-1]:0===o&&(u=0),s.push(u);const l=1/(a-2),d=-l,c=1+l,h=[d,d,c,d,c,c,d,d,c,c,d,c],p=6,g=6,m=3,f=2,y=1,b=new Float32Array(m*g*p),x=new Float32Array(f*g*p),T=new Float32Array(y*g*p);for(let e=0;e<p;e++){const t=e%3*2/3-1,r=e>2?0:-1,s=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0],i=Cm[e];b.set(s,m*g*i),x.set(h,f*g*i);const n=[i,i,i,i,i,i];T.set(n,y*g*i)}const _=new pe;_.setAttribute("position",new ge(b,m)),_.setAttribute("uv",new ge(x,f)),_.setAttribute("faceIndex",new ge(T,y)),t.push(_),i.push(new X(_,null)),n>4&&n--}return{lodPlanes:t,sizeLods:r,sigmas:s,lodMeshes:i}}(t)),this._blurMaterial=function(e,t,s){const i=yl(new Array(ym).fill(0)),n=oa(new r(0,1,0)),a=oa(0),o=tn(ym),u=oa(0),l=oa(1),d=cl(null),c=oa(0),h=tn(1/t),p=tn(1/s),g=tn(e),m={n:o,latitudinal:u,weights:i,poleAxis:n,outputDirection:Pm,dTheta:a,samples:l,envMap:d,mipInt:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:g},f=Im("blur");return f.fragmentNode=mm({...m,latitudinal:u.equal(1)}),wm.set(f,m),f}(t,e.width,e.height)}}async _compileMaterial(e){const t=new X(this._lodPlanes[0],e);await this._renderer.compile(t,bm)}_sceneToCubeUV(e,t,r,s,i){const n=xm;n.near=t,n.far=r;const a=[1,1,1,1,-1,1],o=[1,-1,1,-1,1,-1],u=this._renderer,l=u.autoClear;u.getClearColor(Tm),u.autoClear=!1;let d=this._backgroundBox;if(null===d){const e=new se({name:"PMREM.Background",side:S,depthWrite:!1,depthTest:!1});d=new X(new j,e)}let c=!1;const h=e.background;h?h.isColor&&(d.material.color.copy(h),e.background=null,c=!0):(d.material.color.copy(Tm),c=!0),u.setRenderTarget(s),u.clear(),c&&u.render(d,n);for(let t=0;t<6;t++){const r=t%3;0===r?(n.up.set(0,a[t],0),n.position.set(i.x,i.y,i.z),n.lookAt(i.x+o[t],i.y,i.z)):1===r?(n.up.set(0,0,a[t]),n.position.set(i.x,i.y,i.z),n.lookAt(i.x,i.y+o[t],i.z)):(n.up.set(0,a[t],0),n.position.set(i.x,i.y,i.z),n.lookAt(i.x,i.y,i.z+o[t]));const l=this._cubeSize;Fm(s,r*l,t>2?l:0,l,l),u.render(e,n)}u.autoClear=l,e.background=h}_textureToCubeUV(e,t){const r=this._renderer,s=e.mapping===w||e.mapping===C;s?null===this._cubemapMaterial&&(this._cubemapMaterial=Dm(e)):null===this._equirectMaterial&&(this._equirectMaterial=Um(e));const i=s?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;const n=this._lodMeshes[0];n.material=i;const a=this._cubeSize;Fm(t,0,0,3*a,2*a),r.setRenderTarget(t),r.render(n,bm)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let t=1;t<s;t++){const r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=Rm[(s-t-1)%Rm.length];this._blur(e,t-1,t,r,i)}t.autoClear=r}_blur(e,t,r,s,i){const n=this._pingPongRenderTarget;this._halfBlur(e,n,t,r,s,"latitudinal",i),this._halfBlur(n,e,r,r,s,"longitudinal",i)}_halfBlur(e,t,r,s,i,n,a){const o=this._renderer,u=this._blurMaterial;"latitudinal"!==n&&"longitudinal"!==n&&console.error("blur direction must be either latitudinal or longitudinal!");const l=this._lodMeshes[s];l.material=u;const d=wm.get(u),c=this._sizeLods[r]-1,h=isFinite(i)?Math.PI/(2*c):2*Math.PI/39,p=i/h,g=isFinite(i)?1+Math.floor(3*p):ym;g>ym&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const m=[];let f=0;for(let e=0;e<ym;++e){const t=e/p,r=Math.exp(-t*t/2);m.push(r),0===e?f+=r:e<g&&(f+=2*r)}for(let e=0;e<m.length;e++)m[e]=m[e]/f;e.texture.frame=(e.texture.frame||0)+1,d.envMap.value=e.texture,d.samples.value=g,d.weights.array=m,d.latitudinal.value="latitudinal"===n?1:0,a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=h,d.mipInt.value=y-r;const b=this._sizeLods[s];Fm(t,3*b*(s>y-4?s-y+4:0),4*(this._cubeSize-b),3*b,2*b),o.setRenderTarget(t),o.render(l,bm)}}function Lm(e,t){const r=new ue(e,t,{magFilter:Y,minFilter:Y,generateMipmaps:!1,type:ce,format:de,colorSpace:le});return r.texture.mapping=he,r.texture.name="PMREM.cubeUv",r.texture.isPMREMTexture=!0,r.scissorTest=!0,r}function Fm(e,t,r,s,i){e.viewport.set(t,r,s,i),e.scissor.set(t,r,s,i)}function Im(e){const t=new Sp;return t.depthTest=!1,t.depthWrite=!1,t.blending=$,t.name=`PMREM_${e}`,t}function Dm(e){const t=Im("cubemap");return t.fragmentNode=Hd(e,Pm),t}function Um(e){const t=Im("equirect");return t.fragmentNode=cl(e,Up(Pm),0),t}const Vm=new WeakMap;function Om(e,t,r){const s=function(e){let t=Vm.get(e);void 0===t&&(t=new WeakMap,Vm.set(e,t));return t}(t);let i=s.get(e);if((void 0!==i?i.pmremVersion:-1)!==e.pmremVersion){const t=e.image;if(e.isCubeTexture){if(!function(e){if(null==e)return!1;let t=0;const r=6;for(let s=0;s<r;s++)void 0!==e[s]&&t++;return t===r}(t))return null;i=r.fromCubemap(e,i)}else{if(!function(e){return null!=e&&e.height>0}(t))return null;i=r.fromEquirectangular(e,i)}i.pmremVersion=e.pmremVersion,s.set(e,i)}return i.texture}class Gm extends Js{static get type(){return"PMREMNode"}constructor(e,t=null,r=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=r,this._generator=null;const s=new x;s.isRenderTargetTexture=!0,this._texture=cl(s),this._width=oa(0),this._height=oa(0),this._maxMip=oa(0),this.updateBeforeType=ks.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=function(e){const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const r=t?t.pmremVersion:-1,s=this._value;r!==s.pmremVersion&&(t=!0===s.isPMREMTexture?s:Om(s,e.renderer,this._generator),null!==t&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){null===this._generator&&(this._generator=new Bm(e.renderer)),this.updateBefore(e);let t=this.uvNode;null===t&&e.context.getUV&&(t=e.context.getUV(this)),t=Dd.mul(dn(t.x,t.y.negate(),t.z));let r=this.levelNode;return null===r&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),hm(this._texture,t,r,this._width,this._height,this._maxMip)}dispose(){super.dispose(),null!==this._generator&&this._generator.dispose()}}const km=Hi(Gm).setParameterLength(1,3),zm=new WeakMap;class $m extends Hh{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const e=r.isTextureNode?r.value:t[r.property];let s=zm.get(e);void 0===s&&(s=km(e),zm.set(e,s)),r=s}const s=!0===t.useAnisotropy||t.anisotropy>0?vc:Sd,i=r.context(Hm(wn,s)).mul(Id),n=r.context(Wm(Ed)).mul(Math.PI).mul(Id),a=zu(i),o=zu(n);e.context.radiance.addAssign(a),e.context.iblIrradiance.addAssign(o);const u=e.context.lightingModel.clearcoatRadiance;if(u){const e=r.context(Hm(Pn,Rd)).mul(Id),t=zu(e);u.addAssign(t)}}}const Hm=(e,t)=>{let r=null;return{getUV:()=>(null===r&&(r=gd.negate().reflect(t),r=e.mul(e).mix(r,t).normalize(),r=r.transformDirection(Dl)),r),getTextureLevel:()=>e}},Wm=e=>({getUV:()=>e,getTextureLevel:()=>tn(1)}),qm=new me;class jm extends Sp{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(qm),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return null===t&&e.environmentNode&&(t=e.environmentNode),t?new $m(t):null}setupLightingModel(){return new Kg}setupSpecular(){const e=Ho(dn(.04),Rn.rgb,Cn);kn.assign(e),zn.assign(1)}setupVariants(){const e=this.metalnessNode?tn(this.metalnessNode):zc;Cn.assign(e);let t=this.roughnessNode?tn(this.roughnessNode):kc;t=ag({roughness:t}),wn.assign(t),this.setupSpecular(),Rn.assign(gn(Rn.rgb.mul(e.oneMinus()),Rn.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Xm=new fe;class Km extends jm{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Xm),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||null!==this.clearcoatNode}get useIridescence(){return this.iridescence>0||null!==this.iridescenceNode}get useSheen(){return this.sheen>0||null!==this.sheenNode}get useAnisotropy(){return this.anisotropy>0||null!==this.anisotropyNode}get useTransmission(){return this.transmission>0||null!==this.transmissionNode}get useDispersion(){return this.dispersion>0||null!==this.dispersionNode}setupSpecular(){const e=this.iorNode?tn(this.iorNode):rh;Xn.assign(e),kn.assign(Ho(Co(Vo(Xn.sub(1).div(Xn.add(1))).mul(Vc),dn(1)).mul(Uc),Rn.rgb,Cn)),zn.assign(Ho(Uc,1,Cn))}setupLightingModel(){return new Kg(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const e=this.clearcoatNode?tn(this.clearcoatNode):Hc,t=this.clearcoatRoughnessNode?tn(this.clearcoatRoughnessNode):Wc;Mn.assign(e),Pn.assign(ag({roughness:t}))}if(this.useSheen){const e=this.sheenNode?dn(this.sheenNode):Xc,t=this.sheenRoughnessNode?tn(this.sheenRoughnessNode):Kc;Bn.assign(e),Ln.assign(t)}if(this.useIridescence){const e=this.iridescenceNode?tn(this.iridescenceNode):Qc,t=this.iridescenceIORNode?tn(this.iridescenceIORNode):Zc,r=this.iridescenceThicknessNode?tn(this.iridescenceThicknessNode):Jc;Fn.assign(e),In.assign(t),Dn.assign(r)}if(this.useAnisotropy){const e=(this.anisotropyNode?an(this.anisotropyNode):Yc).toVar();Vn.assign(e.length()),Zi(Vn.equal(0),()=>{e.assign(an(1,0))}).Else(()=>{e.divAssign(an(Vn)),Vn.assign(Vn.saturate())}),Un.assign(Vn.pow2().mix(wn.pow2(),1)),On.assign(Tc[0].mul(e.x).add(Tc[1].mul(e.y))),Gn.assign(Tc[1].mul(e.x).sub(Tc[0].mul(e.y)))}if(this.useTransmission){const e=this.transmissionNode?tn(this.transmissionNode):eh,t=this.thicknessNode?tn(this.thicknessNode):th,r=this.attenuationDistanceNode?tn(this.attenuationDistanceNode):sh,s=this.attenuationColorNode?dn(this.attenuationColorNode):ih;if(Kn.assign(e),Yn.assign(t),Qn.assign(r),Zn.assign(s),this.useDispersion){const e=this.dispersionNode?tn(this.dispersionNode):ch;Jn.assign(e)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?dn(this.clearcoatNormalNode):qc}setup(e){e.context.setupClearcoatNormal=()=>fu(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}class Ym extends Kg{constructor(e=!1,t=!1,r=!1,s=!1,i=!1,n=!1,a=!1){super(e,t,r,s,i,n),this.useSSS=a}direct({lightDirection:e,lightColor:t,reflectedLight:r},s){if(!0===this.useSSS){const i=s.material,{thicknessColorNode:n,thicknessDistortionNode:a,thicknessAmbientNode:o,thicknessAttenuationNode:u,thicknessPowerNode:l,thicknessScaleNode:d}=i,c=e.add(Sd.mul(a)).normalize(),h=tn(gd.dot(c.negate()).saturate().pow(l).mul(d)),p=dn(h.add(o).mul(n));r.directDiffuse.addAssign(p.mul(u.mul(t)))}super.direct({lightDirection:e,lightColor:t,reflectedLight:r},s)}}class Qm extends Km{static get type(){return"MeshSSSNodeMaterial"}constructor(e){super(e),this.thicknessColorNode=null,this.thicknessDistortionNode=tn(.1),this.thicknessAmbientNode=tn(0),this.thicknessAttenuationNode=tn(.1),this.thicknessPowerNode=tn(2),this.thicknessScaleNode=tn(10)}get useSSS(){return null!==this.thicknessColorNode}setupLightingModel(){return new Ym(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion,this.useSSS)}copy(e){return this.thicknessColorNode=e.thicknessColorNode,this.thicknessDistortionNode=e.thicknessDistortionNode,this.thicknessAmbientNode=e.thicknessAmbientNode,this.thicknessAttenuationNode=e.thicknessAttenuationNode,this.thicknessPowerNode=e.thicknessPowerNode,this.thicknessScaleNode=e.thicknessScaleNode,super.copy(e)}}const Zm=Ki(({normal:e,lightDirection:t,builder:r})=>{const s=e.dot(t),i=an(s.mul(.5).add(.5),0);if(r.material.gradientMap){const e=Yd("gradientMap","texture").context({getUV:()=>i});return dn(e.r)}{const e=i.fwidth().mul(.5);return Ho(dn(.7),dn(1),Xo(tn(.7).sub(e.x),tn(.7).add(e.x),i.x))}});class Jm extends qp{direct({lightDirection:e,lightColor:t,reflectedLight:r},s){const i=Zm({normal:xd,lightDirection:e,builder:s}).mul(t);r.directDiffuse.addAssign(i.mul(Qp({diffuseColor:Rn.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:r,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(r.mul(Qp({diffuseColor:Rn}))),s.indirectDiffuse.mulAssign(t)}}const ef=new ye;class tf extends Sp{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(ef),this.setValues(e)}setupLightingModel(){return new Jm}}const rf=Ki(()=>{const e=dn(gd.z,0,gd.x.negate()).normalize(),t=gd.cross(e);return an(e.dot(Sd),t.dot(Sd)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),sf=new be;class nf extends Sp{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(sf),this.setValues(e)}setupVariants(e){const t=rf;let r;r=e.material.matcap?Yd("matcap","texture").context({getUV:()=>t}):dn(Ho(.2,.8,t.y)),Rn.rgb.mulAssign(r.rgb)}}class af extends Js{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:r}=this;if("vec2"===this.getNodeType(e)){const e=t.cos(),s=t.sin();return bn(e,s,s.negate(),e).mul(r)}{const e=t,s=Tn(gn(1,0,0,0),gn(0,uo(e.x),oo(e.x).negate(),0),gn(0,oo(e.x),uo(e.x),0),gn(0,0,0,1)),i=Tn(gn(uo(e.y),0,oo(e.y),0),gn(0,1,0,0),gn(oo(e.y).negate(),0,uo(e.y),0),gn(0,0,0,1)),n=Tn(gn(uo(e.z),oo(e.z).negate(),0,0),gn(oo(e.z),uo(e.z),0,0),gn(0,0,1,0),gn(0,0,0,1));return s.mul(i).mul(n).mul(gn(r,1)).xyz}}}const of=Hi(af).setParameterLength(2),uf=new xe;class lf extends Sp{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(uf),this.setValues(e)}setupPositionView(e){const{object:t,camera:r}=e,{positionNode:s,rotationNode:i,scaleNode:n,sizeAttenuation:a}=this,o=id.mul(dn(s||0));let u=an(Ql[0].xyz.length(),Ql[1].xyz.length());null!==n&&(u=u.mul(an(n))),r.isPerspectiveCamera&&!1===a&&(u=u.mul(o.z.negate()));let l=ud.xy;if(t.center&&!0===t.center.isVector2){const e=((e,t,r)=>Gi(new Au(e,t,r)))("center","vec2",t);l=l.sub(e.sub(.5))}l=l.mul(u);const d=tn(i||jc),c=of(l,d);return gn(o.xy.add(c),o.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const df=new Te,cf=new t;class hf extends lf{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(df),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return id.mul(dn(e||ld)).xyz}setupVertexSprite(e){const{material:t,camera:r}=e,{rotationNode:s,scaleNode:i,sizeNode:n,sizeAttenuation:a}=this;let o=super.setupVertex(e);if(!0!==t.isNodeMaterial)return o;let u=null!==n?an(n):dh;u=u.mul(vl),r.isPerspectiveCamera&&!0===a&&(u=u.mul(pf.div(pd.z.negate()))),i&&i.isNode&&(u=u.mul(an(i)));let l=ud.xy;if(s&&s.isNode){const e=tn(s);l=of(l,e)}return l=l.mul(u),l=l.div(Al.div(2)),l=l.mul(o.w),o=o.add(gn(l,0,0)),o}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const pf=oa(1).onFrameUpdate(function({renderer:e}){const t=e.getSize(cf);this.value=.5*t.y});class gf extends qp{constructor(){super(),this.shadowNode=tn(1).toVar("shadowMask")}direct({lightNode:e}){null!==e.shadowNode&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Rn.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Rn.rgb)}}const mf=new _e;class ff extends Sp{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(mf),this.setValues(e)}setupLightingModel(){return new gf}}const yf=Sn("vec3"),bf=Sn("vec3"),xf=Sn("vec3");class Tf extends qp{constructor(){super()}start(e){const{material:t,context:r}=e,s=Sn("vec3"),i=Sn("vec3");Zi(Ol.sub(cd).length().greaterThan(td.mul(2)),()=>{s.assign(Ol),i.assign(cd)}).Else(()=>{s.assign(cd),i.assign(Ol)});const n=i.sub(s),a=oa("int").onRenderUpdate(({material:e})=>e.steps),o=n.length().div(a).toVar(),u=n.normalize().toVar(),l=tn(0).toVar(),d=dn(1).toVar();t.offsetNode&&l.addAssign(t.offsetNode.mul(o)),Uh(a,()=>{const i=s.add(u.mul(l)),n=Dl.mul(gn(i,1)).xyz;let a;null!==t.depthNode&&(bf.assign(lp(ip(n.z,Bl,Ll))),r.sceneDepthNode=lp(t.depthNode).toVar()),r.positionWorld=i,r.shadowPositionWorld=i,r.positionView=n,yf.assign(0),t.scatteringNode&&(a=t.scatteringNode({positionRay:i})),super.start(e),a&&yf.mulAssign(a);const c=yf.mul(.01).negate().mul(o).exp();d.mulAssign(c),l.addAssign(o)}),xf.addAssign(d.saturate().oneMinus())}scatteringLight(e,t){const r=t.context.sceneDepthNode;r?Zi(r.greaterThanEqual(bf),()=>{yf.addAssign(e)}):yf.addAssign(e)}direct({lightNode:e,lightColor:t},r){if(void 0===e.light.distance)return;const s=t.xyz.toVar();s.mulAssign(e.shadowNode),this.scatteringLight(s,r)}directRectArea({lightColor:e,lightPosition:t,halfWidth:r,halfHeight:s},i){const n=t.add(r).sub(s),a=t.sub(r).sub(s),o=t.sub(r).add(s),u=t.add(r).add(s),l=i.context.positionView,d=e.xyz.mul(Ng({P:l,p0:n,p1:a,p2:o,p3:u})).pow(1.5);this.scatteringLight(d,i)}finish(e){e.context.outgoingLight.assign(xf)}}class _f extends Sp{static get type(){return"VolumeNodeMaterial"}constructor(e){super(),this.isVolumeNodeMaterial=!0,this.steps=25,this.offsetNode=null,this.scatteringNode=null,this.lights=!0,this.transparent=!0,this.side=S,this.depthTest=!1,this.depthWrite=!1,this.setValues(e)}setupLightingModel(){return new Tf}}class vf{constructor(e,t){this.nodes=e,this.info=t,this._context="undefined"!=typeof self?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,r)=>{this._requestId=this._context.requestAnimationFrame(e),!0===this.info.autoReset&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,null!==this._animationLoop&&this._animationLoop(t,r)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Nf{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(t=t.get(e[r]),void 0===t)return;return t.get(e[e.length-1])}set(e,t){let r=this.weakMap;for(let t=0;t<e.length-1;t++){const s=e[t];!1===r.has(s)&&r.set(s,new WeakMap),r=r.get(s)}return r.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(t=t.get(e[r]),void 0===t)return!1;return t.delete(e[e.length-1])}}let Sf=0;class Ef{constructor(e,t,r,s,i,n,a,o,u,l){this.id=Sf++,this._nodes=e,this._geometries=t,this.renderer=r,this.object=s,this.material=i,this.scene=n,this.camera=a,this.lightsNode=o,this.context=u,this.geometry=s.geometry,this.version=i.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=l,this.clippingContextCacheKey=null!==l?l.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return null!==this.clippingContext&&this.clippingContext.cacheKey!==this.clippingContextCacheKey&&(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return!0===this.material.hardwareClipping?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(null!==this.attributes)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,r=[],s=new Set,i={};for(const n of e){let e;if(n.node&&n.node.attribute?e=n.node.attribute:(e=t.getAttribute(n.name),i[n.name]=e.version),void 0===e)continue;r.push(e);const a=e.isInterleavedBufferAttribute?e.data:e;s.add(a)}return this.attributes=r,this.attributesId=i,this.vertexBuffers=Array.from(s.values()),r}getVertexBuffers(){return null===this.vertexBuffers&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:r,group:s,drawRange:i}=this,n=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),a=this.getIndex(),o=null!==a;let u=1;if(!0===r.isInstancedBufferGeometry?u=r.instanceCount:void 0!==e.count&&(u=Math.max(0,e.count)),0===u)return null;if(n.instanceCount=u,!0===e.isBatchedMesh)return n;let l=1;!0!==t.wireframe||e.isPoints||e.isLineSegments||e.isLine||e.isLineLoop||(l=2);let d=i.start*l,c=(i.start+i.count)*l;null!==s&&(d=Math.max(d,s.start*l),c=Math.min(c,(s.start+s.count)*l));const h=r.attributes.position;let p=1/0;o?p=a.count:null!=h&&(p=h.count),d=Math.max(d,0),c=Math.min(c,p);const g=c-d;return g<0||g===1/0?null:(n.vertexCount=g,n.firstVertex=d,n)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const r of Object.keys(e.attributes).sort()){const s=e.attributes[r];t+=r+",",s.data&&(t+=s.data.stride+","),s.offset&&(t+=s.offset+","),s.itemSize&&(t+=s.itemSize+","),s.normalized&&(t+="n,")}for(const r of Object.keys(e.morphAttributes).sort()){const s=e.morphAttributes[r];t+="morph-"+r+",";for(let e=0,r=s.length;e<r;e++){t+=s[e].id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t,renderer:r}=this;let s=t.customProgramCacheKey();for(const e of function(e){const t=Object.keys(e);let r=Object.getPrototypeOf(e);for(;r;){const e=Object.getOwnPropertyDescriptors(r);for(const r in e)if(void 0!==e[r]){const s=e[r];s&&"function"==typeof s.get&&t.push(r)}r=Object.getPrototypeOf(r)}return t}(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(e))continue;const i=t[e];let n;if(null!==i){const e=typeof i;"number"===e?n=0!==i?"1":"0":"object"===e?(n="{",i.isTexture&&(n+=i.mapping,!0===r.backend.isWebGPUBackend&&(n+=i.magFilter,n+=i.minFilter,n+=i.wrapS,n+=i.wrapT,n+=i.wrapR)),n+="}"):n=String(i)}else n=String(i);s+=n+","}return s+=this.clippingContextCacheKey+",",e.geometry&&(s+=this.getGeometryCacheKey()),e.skeleton&&(s+=e.skeleton.bones.length+","),e.isBatchedMesh&&(s+=e._matricesTexture.uuid+",",null!==e._colorsTexture&&(s+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1)&&(s+=e.uuid+","),s+=e.receiveShadow+",",vs(s)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(null!==this.attributes){const e=this.attributesId;for(const t in e){const r=this.geometry.getAttribute(t);if(void 0===r||e[t]!==r.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return!0!==this.material.isShadowPassMaterial&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=Ss(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=Ss(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const Rf=[];class Af{constructor(e,t,r,s,i,n){this.renderer=e,this.nodes=t,this.geometries=r,this.pipelines=s,this.bindings=i,this.info=n,this.chainMaps={}}get(e,t,r,s,i,n,a,o){const u=this.getChainMap(o);Rf[0]=e,Rf[1]=t,Rf[2]=n,Rf[3]=i;let l=u.get(Rf);return void 0===l?(l=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,r,s,i,n,a,o),u.set(Rf,l)):(l.updateClipping(a),l.needsGeometryUpdate&&l.setGeometry(e.geometry),(l.version!==t.version||l.needsUpdate)&&(l.initialCacheKey!==l.getCacheKey()?(l.dispose(),l=this.get(e,t,r,s,i,n,a,o)):l.version=t.version)),Rf.length=0,l}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Nf)}dispose(){this.chainMaps={}}createRenderObject(e,t,r,s,i,n,a,o,u,l,d){const c=this.getChainMap(d),h=new Ef(e,t,r,s,i,n,a,o,u,l);return h.onDispose=()=>{this.pipelines.delete(h),this.bindings.delete(h),this.nodes.delete(h),c.delete(h.getChainArray())},h}}class wf{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const Cf=1,Mf=2,Pf=3,Bf=4,Lf=16;class Ff extends wf{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return null!==t&&this.backend.destroyAttribute(e),t}update(e,t){const r=this.get(e);if(void 0===r.version)t===Cf?this.backend.createAttribute(e):t===Mf?this.backend.createIndexAttribute(e):t===Pf?this.backend.createStorageAttribute(e):t===Bf&&this.backend.createIndirectStorageAttribute(e),r.version=this._getBufferAttribute(e).version;else{const t=this._getBufferAttribute(e);(r.version<t.version||t.usage===y)&&(this.backend.updateAttribute(e),r.version=t.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function If(e){return null!==e.index?e.index.version:e.attributes.position.version}function Df(e){const t=[],r=e.index,s=e.attributes.position;if(null!==r){const e=r.array;for(let r=0,s=e.length;r<s;r+=3){const s=e[r+0],i=e[r+1],n=e[r+2];t.push(s,i,i,n,n,s)}}else{for(let e=0,r=s.array.length/3-1;e<r;e+=3){const r=e+0,s=e+1,i=e+2;t.push(r,s,s,i,i,r)}}const i=new(Se(t)?ve:Ne)(t,1);return i.version=If(e),i}class Uf extends wf{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&!0===this.get(t).initialized}updateForRender(e){!1===this.has(e)&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry;this.get(t).initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,i=e.getAttributes();null!==s&&this.attributes.delete(s);for(const e of i)this.attributes.delete(e);const n=this.wireframes.get(t);void 0!==n&&this.attributes.delete(n),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const e of t)e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute?this.updateAttribute(e,Pf):this.updateAttribute(e,Cf);const r=this.getIndex(e);null!==r&&this.updateAttribute(r,Mf);const s=e.geometry.indirect;null!==s&&this.updateAttribute(s,Bf)}updateAttribute(e,t){const r=this.info.render.calls;e.isInterleavedBufferAttribute?void 0===this.attributeCall.get(e)?(this.attributes.update(e,t),this.attributeCall.set(e,r)):this.attributeCall.get(e.data)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e.data,r),this.attributeCall.set(e,r)):this.attributeCall.get(e)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e,r))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:r}=e;let s=t.index;if(!0===r.wireframe){const e=this.wireframes;let r=e.get(t);void 0===r?(r=Df(t),e.set(t,r)):r.version!==If(t)&&(this.attributes.delete(r),r=Df(t),e.set(t,r)),s=r}return s}}class Vf{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,r){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=r*(t/3):e.isPoints?this.render.points+=r*t:e.isLineSegments?this.render.lines+=r*(t/2):e.isLine?this.render.lines+=r*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class Of{constructor(e){this.cacheKey=e,this.usedTimes=0}}class Gf extends Of{constructor(e,t,r){super(e),this.vertexProgram=t,this.fragmentProgram=r}}class kf extends Of{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let zf=0;class $f{constructor(e,t,r,s=null,i=null){this.id=zf++,this.code=e,this.stage=t,this.name=r,this.transforms=s,this.attributes=i,this.usedTimes=0}}class Hf extends wf{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:r}=this,s=this.get(e);if(this._needsComputeUpdate(e)){const i=s.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);const n=this.nodes.getForCompute(e);let a=this.programs.compute.get(n.computeShader);void 0===a&&(i&&0===i.computeProgram.usedTimes&&this._releaseProgram(i.computeProgram),a=new $f(n.computeShader,"compute",e.name,n.transforms,n.nodeAttributes),this.programs.compute.set(n.computeShader,a),r.createProgram(a));const o=this._getComputeCacheKey(e,a);let u=this.caches.get(o);void 0===u&&(i&&0===i.usedTimes&&this._releasePipeline(i),u=this._getComputePipeline(e,a,o,t)),u.usedTimes++,a.usedTimes++,s.version=e.version,s.pipeline=u}return s.pipeline}getForRender(e,t=null){const{backend:r}=this,s=this.get(e);if(this._needsRenderUpdate(e)){const i=s.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);const n=e.getNodeBuilderState(),a=e.material?e.material.name:"";let o=this.programs.vertex.get(n.vertexShader);void 0===o&&(i&&0===i.vertexProgram.usedTimes&&this._releaseProgram(i.vertexProgram),o=new $f(n.vertexShader,"vertex",a),this.programs.vertex.set(n.vertexShader,o),r.createProgram(o));let u=this.programs.fragment.get(n.fragmentShader);void 0===u&&(i&&0===i.fragmentProgram.usedTimes&&this._releaseProgram(i.fragmentProgram),u=new $f(n.fragmentShader,"fragment",a),this.programs.fragment.set(n.fragmentShader,u),r.createProgram(u));const l=this._getRenderCacheKey(e,o,u);let d=this.caches.get(l);void 0===d?(i&&0===i.usedTimes&&this._releasePipeline(i),d=this._getRenderPipeline(e,o,u,l,t)):e.pipeline=d,d.usedTimes++,o.usedTimes++,u.usedTimes++,s.pipeline=d}return s.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,0===t.usedTimes&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,0===t.computeProgram.usedTimes&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,0===t.vertexProgram.usedTimes&&this._releaseProgram(t.vertexProgram),0===t.fragmentProgram.usedTimes&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,r,s){r=r||this._getComputeCacheKey(e,t);let i=this.caches.get(r);return void 0===i&&(i=new kf(r,t),this.caches.set(r,i),this.backend.createComputePipeline(i,s)),i}_getRenderPipeline(e,t,r,s,i){s=s||this._getRenderCacheKey(e,t,r);let n=this.caches.get(s);return void 0===n&&(n=new Gf(s,t,r),this.caches.set(s,n),e.pipeline=n,this.backend.createRenderPipeline(e,i)),n}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,r){return t.id+","+r.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,r=e.stage;this.programs[r].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return void 0===t.pipeline||t.version!==e.version}_needsRenderUpdate(e){return void 0===this.get(e).pipeline||this.backend.needsRenderUpdate(e)}}class Wf extends wf{constructor(e,t,r,s,i,n){super(),this.backend=e,this.textures=r,this.pipelines=i,this.attributes=s,this.nodes=t,this.info=n,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const e of t){const r=this.get(e);void 0===r.bindGroup&&(this._init(e),this.backend.createBindings(e,t,0),r.bindGroup=e)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const e of t){const r=this.get(e);void 0===r.bindGroup&&(this._init(e),this.backend.createBindings(e,t,0),r.bindGroup=e)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const e=t.attribute,r=e.isIndirectStorageBufferAttribute?Bf:Pf;this.attributes.update(e,r)}}_update(e,t){const{backend:r}=this;let s=!1,i=!0,n=0,a=0;for(const t of e.bindings){if(t.isNodeUniformsGroup){if(!1===this.nodes.updateGroup(t))continue}if(t.isStorageBuffer){const e=t.attribute,r=e.isIndirectStorageBufferAttribute?Bf:Pf;this.attributes.update(e,r)}if(t.isUniformBuffer){t.update()&&r.updateBinding(t)}else if(t.isSampledTexture){const e=t.update(),o=t.texture,u=this.textures.get(o);e&&(this.textures.updateTexture(o),t.generation!==u.generation&&(t.generation=u.generation,s=!0,i=!1));if(void 0!==r.get(o).externalTexture||u.isDefaultTexture?i=!1:(n=10*n+o.id,a+=o.version),!0===o.isStorageTexture){const e=this.get(o);!0===t.store?e.needsMipmap=!0:this.textures.needsMipmaps(o)&&!0===e.needsMipmap&&(this.backend.generateMipmaps(o),e.needsMipmap=!1)}}else t.isSampler&&t.update()}!0===s&&this.backend.updateBindings(e,t,i?n:0,a)}}function qf(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?e.z-t.z:e.id-t.id}function jf(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Xf(e){return(e.transmission>0||e.transmissionNode)&&e.side===E&&!1===e.forceSinglePass}class Kf{constructor(e,t,r){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,r),this.lightsArray=[],this.scene=t,this.camera=r,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,r,s,i,n,a){let o=this.renderItems[this.renderItemsIndex];return void 0===o?(o={id:e.id,object:e,geometry:t,material:r,groupOrder:s,renderOrder:e.renderOrder,z:i,group:n,clippingContext:a},this.renderItems[this.renderItemsIndex]=o):(o.id=e.id,o.object=e,o.geometry=t,o.material=r,o.groupOrder=s,o.renderOrder=e.renderOrder,o.z=i,o.group=n,o.clippingContext=a),this.renderItemsIndex++,o}push(e,t,r,s,i,n,a){const o=this.getNextRenderItem(e,t,r,s,i,n,a);!0===e.occlusionTest&&this.occlusionQueryCount++,!0===r.transparent||r.transmission>0?(Xf(r)&&this.transparentDoublePass.push(o),this.transparent.push(o)):this.opaque.push(o)}unshift(e,t,r,s,i,n,a){const o=this.getNextRenderItem(e,t,r,s,i,n,a);!0===r.transparent||r.transmission>0?(Xf(r)&&this.transparentDoublePass.unshift(o),this.transparent.unshift(o)):this.opaque.unshift(o)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||qf),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||jf),this.transparent.length>1&&this.transparent.sort(t||jf)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const t=this.renderItems[e];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.groupOrder=null,t.renderOrder=null,t.z=null,t.group=null,t.clippingContext=null}}}const Yf=[];class Qf{constructor(e){this.lighting=e,this.lists=new Nf}get(e,t){const r=this.lists;Yf[0]=e,Yf[1]=t;let s=r.get(Yf);return void 0===s&&(s=new Kf(this.lighting,e,t),r.set(Yf,s)),Yf.length=0,s}dispose(){this.lists=new Nf}}let Zf=0;class Jf{constructor(){this.id=Zf++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new s,this.scissor=!1,this.scissorValue=new s,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return ey(this)}}function ey(e){const{textures:t,activeCubeFace:r,activeMipmapLevel:s}=e,i=[r,s];for(const e of t)i.push(e.id);return Ns(i)}const ty=[],ry=new K,sy=new Ee;class iy{constructor(){this.chainMaps={}}get(e,t,r=null){let s;if(ty[0]=e,ty[1]=t,null===r)s="default";else{const e=r.texture.format;s=`${r.textures.length}:${e}:${r.samples}:${r.depthBuffer}:${r.stencilBuffer}`}const i=this._getChainMap(s);let n=i.get(ty);return void 0===n&&(n=new Jf,i.set(ty,n)),ty.length=0,null!==r&&(n.sampleCount=0===r.samples?1:r.samples),n}getForClear(e=null){return this.get(ry,sy,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Nf)}dispose(){this.chainMaps={}}}const ny=new r;class ay extends wf{constructor(e,t,r){super(),this.renderer=e,this.backend=t,this.info=r}updateRenderTarget(e,t=0){const r=this.get(e),s=0===e.samples?1:e.samples,i=r.depthTextureMips||(r.depthTextureMips={}),n=e.textures,a=this.getSize(n[0]),o=a.width>>t,u=a.height>>t;let l=e.depthTexture||i[t];const d=!0===e.depthBuffer||!0===e.stencilBuffer;let c=!1;void 0===l&&d&&(l=new V,l.format=e.stencilBuffer?Re:Ae,l.type=e.stencilBuffer?we:T,l.image.width=o,l.image.height=u,l.image.depth=a.depth,l.isArrayTexture=!0===e.multiview&&a.depth>1,i[t]=l),r.width===a.width&&a.height===r.height||(c=!0,l&&(l.needsUpdate=!0,l.image.width=o,l.image.height=u,l.image.depth=l.isArrayTexture?l.image.depth:1)),r.width=a.width,r.height=a.height,r.textures=n,r.depthTexture=l||null,r.depth=e.depthBuffer,r.stencil=e.stencilBuffer,r.renderTarget=e,r.sampleCount!==s&&(c=!0,l&&(l.needsUpdate=!0),r.sampleCount=s);const h={sampleCount:s};if(!0!==e.isXRRenderTarget){for(let e=0;e<n.length;e++){const t=n[e];c&&(t.needsUpdate=!0),this.updateTexture(t,h)}l&&this.updateTexture(l,h)}if(!0!==r.initialized){r.initialized=!0;const t=()=>{e.removeEventListener("dispose",t);for(let e=0;e<n.length;e++)this._destroyTexture(n[e]);l&&this._destroyTexture(l),this.delete(e),this.backend.delete(e)};e.addEventListener("dispose",t)}}updateTexture(e,t={}){const r=this.get(e);if(!0===r.initialized&&r.version===e.version)return;const s=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,i=this.backend;if(s&&!0===r.initialized&&(i.destroySampler(e),i.destroyTexture(e)),e.isFramebufferTexture){const t=this.renderer.getRenderTarget();e.type=t?t.texture.type:Ce}const{width:n,height:a,depth:o}=this.getSize(e);if(t.width=n,t.height=a,t.depth=o,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,n,a):1,e.isCubeTexture&&e.mipmaps.length>0&&t.levels++,s||!0===e.isStorageTexture||!0===e.isExternalTexture)i.createSampler(e),i.createTexture(e,t),r.generation=e.version;else{if(!0!==r.initialized&&i.createSampler(e),e.version>0){const s=e.image;if(void 0===s)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(!1===s.complete)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const r=[];for(const t of e.images)r.push(t);t.images=r}else t.image=s;void 0!==r.isDefaultTexture&&!0!==r.isDefaultTexture||(i.createTexture(e,t),r.isDefaultTexture=!1,r.generation=e.version),!0===e.source.dataReady&&i.updateTexture(e,t),t.needsMipmaps&&0===e.mipmaps.length&&i.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}else i.createDefaultTexture(e),r.isDefaultTexture=!0,r.generation=e.version}if(!0!==r.initialized){r.initialized=!0,r.generation=e.version,this.info.memory.textures++,e.isVideoTexture&&c.getTransfer(e.colorSpace)!==h&&console.warn("WebGPURenderer: Video textures must use a color space with a sRGB transfer function, e.g. SRGBColorSpace.");const t=()=>{e.removeEventListener("dispose",t),this._destroyTexture(e)};e.addEventListener("dispose",t)}r.version=e.version}getSize(e,t=ny){let r=e.images?e.images[0]:e.image;return r?(void 0!==r.image&&(r=r.image),"undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement?(t.width=r.videoWidth||1,t.height=r.videoHeight||1,t.depth=1):r instanceof VideoFrame?(t.width=r.displayWidth||1,t.height=r.displayHeight||1,t.depth=1):(t.width=r.width||1,t.height=r.height||1,t.depth=e.isCubeTexture?6:r.depth||1)):t.width=t.height=t.depth=1,t}getMipLevels(e,t,r){let s;return s=e.mipmaps.length>0?e.mipmaps.length:!0===e.isCompressedTexture?1:Math.floor(Math.log2(Math.max(t,r)))+1,s}needsMipmaps(e){return!0===e.generateMipmaps||e.mipmaps.length>0}_destroyTexture(e){!0===this.has(e)&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class oy extends e{constructor(e,t,r,s=1){super(e,t,r),this.a=s}set(e,t,r,s=1){return this.a=s,super.set(e,t,r)}copy(e){return void 0!==e.a&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class uy extends Nn{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class ly extends Ys{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.hasOutput?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.hasOutput?this.outputNode.getMemberType(e,t):"void"}add(e){return!0!==e.isNode?(console.error("THREE.TSL: Invalid node added to stack."),this):(this.nodes.push(e),this)}If(e,t){const r=new Oi(t);return this._currentCond=iu(e,r),this.add(this._currentCond)}ElseIf(e,t){const r=new Oi(t),s=iu(e,r);return this._currentCond.elseNode=s,this._currentCond=s,this}Else(e){return this._currentCond.elseNode=new Oi(e),this}Switch(e){return this._expressionNode=Gi(e),this}Case(...e){const t=[];if(e.length>=2)for(let r=0;r<e.length-1;r++)t.push(this._expressionNode.equal(Gi(e[r])));else console.error("THREE.TSL: Invalid parameter length. Case() requires at least two parameters.");const r=new Oi(e[e.length-1]);let s=t[0];for(let e=1;e<t.length;e++)s=s.or(t[e]);const i=iu(s,r);return null===this._currentCond?(this._currentCond=i,this.add(this._currentCond)):(this._currentCond.elseNode=i,this._currentCond=i,this)}Default(e){return this.Else(e),this}setup(e){const t=e.getNodeProperties(this);let r=0;for(const s of this.getChildren()){if(s.isVarNode&&!0===s.intent){if(!0!==e.getNodeProperties(s).assign)continue}t["node"+r++]=s}return t.outputNode||null}get hasOutput(){return this.outputNode&&this.outputNode.isNode}build(e,...t){const r=e.currentStack,s=Qi();Yi(this),e.currentStack=this;const i=e.buildStage;for(const t of this.nodes){if(t.isVarNode&&!0===t.intent){if(!0!==e.getNodeProperties(t).assign)continue}if("setup"===i)t.build(e);else if("analyze"===i)t.build(e,this);else if("generate"===i){const r=e.getDataFromNode(t,"any").stages,s=r&&r[e.shaderStage];if(t.isVarNode&&s&&1===s.length&&s[0]&&s[0].isStackNode)continue;t.build(e,"void")}}let n;return n=this.hasOutput?this.outputNode.build(e,...t):super.build(e,...t),Yi(s),e.currentStack=r,n}}const dy=Hi(ly).setParameterLength(0,1);class cy extends Ys{static get type(){return"StructTypeNode"}constructor(e,t=null){var r;super("struct"),this.membersLayout=(r=e,Object.entries(r).map(([e,t])=>"string"==typeof t?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})),this.name=t,this.isStructLayoutNode=!0}getLength(){const e=Float32Array.BYTES_PER_ELEMENT;let t=0;for(const r of this.membersLayout){const s=r.type,i=Bs(s)*e,n=t%8,a=n%Ls(s),o=n+a;t+=a,0!==o&&8-o<i&&(t+=8-o),t+=i}return 8*Math.ceil(t/8)/e}getMemberType(e,t){const r=this.membersLayout.find(e=>e.name===t);return r?r.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.getStructTypeFromNode(this,this.membersLayout,this.name),e.addInclude(this)}generate(e){return this.getNodeType(e)}}class hy extends Ys{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structTypeNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structTypeNode.getNodeType(e)}getMemberType(e,t){return this.structTypeNode.getMemberType(e,t)}generate(e){const t=e.getVarFromNode(this),r=t.type,s=e.getPropertyName(t);return e.addLineFlowCode(`${s} = ${e.generateStruct(r,this.structTypeNode.membersLayout,this.values)}`,this),t.name}}class py extends Ys{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const t=e.getNodeProperties(this);if(void 0===t.membersLayout){const r=this.members,s=[];for(let t=0;t<r.length;t++){const i="m"+t,n=r[t].getNodeType(e);s.push({name:i,type:n,index:t})}t.membersLayout=s,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){const t=e.getOutputStructName(),r=this.members,s=""!==t?t+".":"";for(let t=0;t<r.length;t++){const i=r[t].build(e);e.addLineFlowCode(`${s}m${t} = ${i}`,this)}return t}}const gy=Hi(py);function my(e,t){for(let r=0;r<e.length;r++)if(e[r].name===t)return r;return-1}class fy extends py{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return void 0!==this.outputNodes[e]}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes};return yy(t)}setup(e){const t=this.outputNodes,r=[],s=e.renderer.getRenderTarget().textures;for(const e in t){r[my(s,e)]=gn(t[e])}return this.members=r,super.setup(e)}}const yy=Hi(fy);class by extends Js{static get type(){return"BitcastNode"}constructor(e,t,r=null){super(),this.valueNode=e,this.conversionType=t,this.inputType=r,this.isBitcastNode=!0}getNodeType(e){if(null!==this.inputType){const t=this.valueNode.getNodeType(e),r=e.getTypeLength(t);return e.getTypeFromLength(r,this.conversionType)}return this.conversionType}generate(e){const t=this.getNodeType(e);let r="";if(null!==this.inputType){const t=this.valueNode.getNodeType(e);r=1===e.getTypeLength(t)?this.inputType:e.changeComponentType(t,this.inputType)}else r=this.valueNode.getNodeType(e);return`${e.getBitcastMethod(t,r)}( ${this.valueNode.build(e,r)} )`}}const xy=qi(by).setParameterLength(2),Ty=Ki(([e])=>{const t=e.toUint().mul(747796405).add(2891336453),r=t.shiftRight(t.shiftRight(28).add(4)).bitXor(t).mul(277803737);return r.shiftRight(22).bitXor(r).toFloat().mul(1/2**32)}),_y=(e,t)=>Uo(ba(4,e.mul(ya(1,e))),t),vy=Ki(([e])=>e.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),Ny=Ki(([e])=>dn(vy(e.z.add(vy(e.y.mul(1)))),vy(e.z.add(vy(e.x.mul(1)))),vy(e.y.add(vy(e.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Sy=Ki(([e,t,r])=>{const s=dn(e).toVar(),i=tn(1.4).toVar(),n=tn(0).toVar(),a=dn(s).toVar();return Uh({start:tn(0),end:tn(3),type:"float",condition:"<="},()=>{const e=dn(Ny(a.mul(2))).toVar();s.addAssign(e.add(r.mul(tn(.1).mul(t)))),a.mulAssign(1.8),i.mulAssign(1.5),s.mulAssign(1.2);const o=tn(vy(s.z.add(vy(s.x.add(vy(s.y)))))).toVar();n.addAssign(o.div(i)),a.addAssign(.14)}),n}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class Ey extends Ys{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFnCall=null,this.global=!0}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let r=this._candidateFnCall;if(null===r){let s=null,i=-1;for(const r of this.functionNodes){const n=r.shaderNode.layout;if(null===n)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const a=n.inputs;if(t.length===a.length){let n=0;for(let r=0;r<t.length;r++){const s=t[r],i=a[r];s.getNodeType(e)===i.type?n++:n=0}n>i&&(s=r,i=n)}}this._candidateFnCall=r=s(...t)}return r}}const Ry=Hi(Ey),Ay=e=>(...t)=>Ry(e,...t),wy=oa(0).setGroup(ia).onRenderUpdate(e=>e.time),Cy=oa(0).setGroup(ia).onRenderUpdate(e=>e.deltaTime),My=oa(0,"uint").setGroup(ia).onRenderUpdate(e=>e.frameId),Py=Ki(([e,t,r=an(.5)])=>of(e.sub(r),t).add(r)),By=Ki(([e,t,r=an(.5)])=>{const s=e.sub(r),i=s.dot(s),n=i.mul(i).mul(t);return e.add(s.mul(n))}),Ly=Ki(({position:e=null,horizontal:t=!0,vertical:r=!1})=>{let s;null!==e?(s=Ql.toVar(),s[3][0]=e.x,s[3][1]=e.y,s[3][2]=e.z):s=Ql;const i=Dl.mul(s);return Ui(t)&&(i[0][0]=Ql[0].length(),i[0][1]=0,i[0][2]=0),Ui(r)&&(i[1][0]=0,i[1][1]=Ql[1].length(),i[1][2]=0),i[2][0]=0,i[2][1]=0,i[2][2]=1,Fl.mul(i).mul(ld)}),Fy=Ki(([e=null])=>{const t=lp();return lp(tp(e)).sub(t).lessThan(0).select(Nl,e)});class Iy extends Ys{static get type(){return"SpriteSheetUVNode"}constructor(e,t=sl(),r=tn(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=r}setup(){const{frameNode:e,uvNode:t,countNode:r}=this,{width:s,height:i}=r,n=e.mod(s.mul(i)).floor(),a=n.mod(s),o=i.sub(n.add(1).div(s).ceil()),u=r.reciprocal(),l=an(a,o);return t.add(l).mul(u)}}const Dy=Hi(Iy).setParameterLength(3),Uy=Ki(([e,t=null,r=null,s=tn(1),i=ld,n=Td])=>{let a=n.abs().normalize();a=a.div(a.dot(dn(1)));const o=i.yz.mul(s),u=i.zx.mul(s),l=i.xy.mul(s),d=e.value,c=null!==t?t.value:d,h=null!==r?r.value:d,p=cl(d,o).mul(a.x),g=cl(c,u).mul(a.y),m=cl(h,l).mul(a.z);return fa(p,g,m)}),Vy=new Me,Oy=new r,Gy=new r,ky=new r,zy=new a,$y=new r(0,0,-1),Hy=new s,Wy=new r,qy=new r,jy=new s,Xy=new t,Ky=new ue,Yy=Nl.flipX();Ky.depthTexture=new V(1,1);let Qy=!1;class Zy extends ll{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||Ky.texture,Yy),this._reflectorBaseNode=e.reflector||new Jy(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(null===this._depthNode){if(!0!==this._reflectorBaseNode.depth)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=Gi(new Zy({defaultTexture:Ky.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class Jy extends Ys{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:r=new Pe,resolutionScale:s=1,generateMipmaps:i=!1,bounces:n=!0,depth:a=!1,samples:o=0}=t;this.textureNode=e,this.target=r,this.resolutionScale=s,void 0!==t.resolution&&(Be('THREE.ReflectorNode: The "resolution" parameter has been renamed to "resolutionScale".'),this.resolutionScale=t.resolution),this.generateMipmaps=i,this.bounces=n,this.depth=a,this.samples=o,this.updateBeforeType=n?ks.RENDER:ks.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}_updateResolution(e,t){const r=this.resolutionScale;t.getDrawingBufferSize(Xy),e.setSize(Math.round(Xy.width*r),Math.round(Xy.height*r))}setup(e){return this._updateResolution(Ky,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return void 0===t&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return void 0===t&&(t=new ue(0,0,{type:ce,samples:this.samples}),!0===this.generateMipmaps&&(t.texture.minFilter=Le,t.texture.generateMipmaps=!0),!0===this.depth&&(t.depthTexture=new V),this.renderTargets.set(e,t)),t}updateBefore(e){if(!1===this.bounces&&Qy)return!1;Qy=!0;const{scene:t,camera:r,renderer:s,material:i}=e,{target:n}=this,a=this.getVirtualCamera(r),o=this.getRenderTarget(a);s.getDrawingBufferSize(Xy),this._updateResolution(o,s),Gy.setFromMatrixPosition(n.matrixWorld),ky.setFromMatrixPosition(r.matrixWorld),zy.extractRotation(n.matrixWorld),Oy.set(0,0,1),Oy.applyMatrix4(zy),Wy.subVectors(Gy,ky);let u=!1;if(!0===Wy.dot(Oy)>0&&!1===this.forceUpdate){if(!1===this.hasOutput)return void(Qy=!1);u=!0}Wy.reflect(Oy).negate(),Wy.add(Gy),zy.extractRotation(r.matrixWorld),$y.set(0,0,-1),$y.applyMatrix4(zy),$y.add(ky),qy.subVectors(Gy,$y),qy.reflect(Oy).negate(),qy.add(Gy),a.coordinateSystem=r.coordinateSystem,a.position.copy(Wy),a.up.set(0,1,0),a.up.applyMatrix4(zy),a.up.reflect(Oy),a.lookAt(qy),a.near=r.near,a.far=r.far,a.updateMatrixWorld(),a.projectionMatrix.copy(r.projectionMatrix),Vy.setFromNormalAndCoplanarPoint(Oy,Gy),Vy.applyMatrix4(a.matrixWorldInverse),Hy.set(Vy.normal.x,Vy.normal.y,Vy.normal.z,Vy.constant);const l=a.projectionMatrix;jy.x=(Math.sign(Hy.x)+l.elements[8])/l.elements[0],jy.y=(Math.sign(Hy.y)+l.elements[9])/l.elements[5],jy.z=-1,jy.w=(1+l.elements[10])/l.elements[14],Hy.multiplyScalar(1/Hy.dot(jy));l.elements[2]=Hy.x,l.elements[6]=Hy.y,l.elements[10]=s.coordinateSystem===d?Hy.z-0:Hy.z+1-0,l.elements[14]=Hy.w,this.textureNode.value=o.texture,!0===this.depth&&(this.textureNode.getDepthNode().value=o.depthTexture),i.visible=!1;const c=s.getRenderTarget(),h=s.getMRT(),p=s.autoClear;s.setMRT(null),s.setRenderTarget(o),s.autoClear=!0,u?(s.clear(),this.hasOutput=!1):(s.render(t,a),this.hasOutput=!0),s.setMRT(h),s.setRenderTarget(c),s.autoClear=p,i.visible=!0,Qy=!1,this.forceUpdate=!1}get resolution(){return Be('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale}set resolution(e){Be('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale=e}}const eb=new ae(-1,1,1,-1,0,1);class tb extends pe{constructor(e=!1){super();const t=!1===e?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Fe([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Fe(t,2))}}const rb=new tb;class sb extends X{constructor(e=null){super(rb,e),this.camera=eb,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,eb)}render(e){e.render(this,eb)}}const ib=new t;class nb extends ll{static get type(){return"RTTNode"}constructor(e,t=null,r=null,s={type:ce}){const i=new ue(t,r,s);super(i.texture,sl()),this.isRTTNode=!0,this.node=e,this.width=t,this.height=r,this.pixelRatio=1,this.renderTarget=i,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new sb(new Sp),this.updateBeforeType=ks.RENDER}get autoResize(){return null===this.width}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const r=e*this.pixelRatio,s=t*this.pixelRatio;this.renderTarget.setSize(r,s),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(!1===this.textureNeedsUpdate&&!1===this.autoUpdate)return;if(this.textureNeedsUpdate=!1,!0===this.autoResize){const t=e.getPixelRatio(),r=e.getSize(ib),s=r.width*t,i=r.height*t;s===this.renderTarget.width&&i===this.renderTarget.height||(this.renderTarget.setSize(s,i),this.textureNeedsUpdate=!0)}this._quadMesh.material.fragmentNode=this._rttNode;const t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(t)}clone(){const e=new ll(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const ab=(e,...t)=>Gi(new nb(Gi(e),...t)),ob=Ki(([e,t,r],s)=>{let i;s.renderer.coordinateSystem===d?(e=an(e.x,e.y.oneMinus()).mul(2).sub(1),i=gn(dn(e,t),1)):i=gn(dn(e.x,e.y.oneMinus(),t).mul(2).sub(1),1);const n=gn(r.mul(i));return n.xyz.div(n.w)}),ub=Ki(([e,t])=>{const r=t.mul(gn(e,1)),s=r.xy.div(r.w).mul(.5).add(.5).toVar();return an(s.x,s.y.oneMinus())}),lb=Ki(([e,t,r])=>{const s=nl(hl(t)),i=on(e.mul(s)).toVar(),n=hl(t,i).toVar(),a=hl(t,i.sub(on(2,0))).toVar(),o=hl(t,i.sub(on(1,0))).toVar(),u=hl(t,i.add(on(1,0))).toVar(),l=hl(t,i.add(on(2,0))).toVar(),d=hl(t,i.add(on(0,2))).toVar(),c=hl(t,i.add(on(0,1))).toVar(),h=hl(t,i.sub(on(0,1))).toVar(),p=hl(t,i.sub(on(0,2))).toVar(),g=go(ya(tn(2).mul(o).sub(a),n)).toVar(),m=go(ya(tn(2).mul(u).sub(l),n)).toVar(),f=go(ya(tn(2).mul(c).sub(d),n)).toVar(),y=go(ya(tn(2).mul(h).sub(p),n)).toVar(),b=ob(e,n,r).toVar(),x=g.lessThan(m).select(b.sub(ob(e.sub(an(tn(1).div(s.x),0)),o,r)),b.negate().add(ob(e.add(an(tn(1).div(s.x),0)),u,r))),T=f.lessThan(y).select(b.sub(ob(e.add(an(0,tn(1).div(s.y))),c,r)),b.negate().add(ob(e.sub(an(0,tn(1).div(s.y))),h,r)));return no(Do(x,T))});class db extends Ys{static get type(){return"SampleNode"}constructor(e,t=null){super(),this.callback=e,this.uvNode=t,this.isSampleNode=!0}setup(){return this.sample(sl())}sample(e){return this.callback(e)}}class cb extends Ys{static get type(){return"EventNode"}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===cb.OBJECT?this.updateType=ks.OBJECT:e===cb.MATERIAL&&(this.updateType=ks.RENDER)}update(e){this.callback(e)}}cb.OBJECT="object",cb.MATERIAL="material";const hb=(e,t)=>Gi(new cb(e,t)).toStack();class pb extends L{constructor(e,t,r=Float32Array){super(ArrayBuffer.isView(e)?e:new r(e*t),t),this.isStorageInstancedBufferAttribute=!0}}class gb extends ge{constructor(e,t,r=Float32Array){super(ArrayBuffer.isView(e)?e:new r(e*t),t),this.isStorageBufferAttribute=!0}}class mb extends Ys{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const fb=Wi(mb),yb=new R,bb=new a;class xb extends Ys{static get type(){return"SceneNode"}constructor(e=xb.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,r=null!==this.scene?this.scene:e.scene;let s;return t===xb.BACKGROUND_BLURRINESS?s=jd("backgroundBlurriness","float",r):t===xb.BACKGROUND_INTENSITY?s=jd("backgroundIntensity","float",r):t===xb.BACKGROUND_ROTATION?s=oa("mat4").setName("backgroundRotation").setGroup(ia).onRenderUpdate(()=>{const e=r.background;return null!==e&&e.isTexture&&e.mapping!==Ie?(yb.copy(r.backgroundRotation),yb.x*=-1,yb.y*=-1,yb.z*=-1,bb.makeRotationFromEuler(yb)):bb.identity(),bb}):console.error("THREE.SceneNode: Unknown scope:",t),s}}xb.BACKGROUND_BLURRINESS="backgroundBlurriness",xb.BACKGROUND_INTENSITY="backgroundIntensity",xb.BACKGROUND_ROTATION="backgroundRotation";const Tb=Wi(xb,xb.BACKGROUND_BLURRINESS),_b=Wi(xb,xb.BACKGROUND_INTENSITY),vb=Wi(xb,xb.BACKGROUND_ROTATION);class Nb extends ll{static get type(){return"StorageTextureNode"}constructor(e,t,r=null){super(e,t),this.storeNode=r,this.isStorageTextureNode=!0,this.access=$s.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);return t.storeNode=this.storeNode,t}setAccess(e){return this.access=e,this}generate(e,t){let r;return r=null!==this.storeNode?this.generateStore(e):super.generate(e,t),r}toReadWrite(){return this.setAccess($s.READ_WRITE)}toReadOnly(){return this.setAccess($s.READ_ONLY)}toWriteOnly(){return this.setAccess($s.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:r,storeNode:s,depthNode:i}=t,n=super.generate(e,"property"),a=r.build(e,!0===this.value.is3DTexture?"uvec3":"uvec2"),o=s.build(e,"vec4"),u=i?i.build(e,"int"):null,l=e.generateTextureStore(e,n,a,u,o);e.addLineFlowCode(l,this)}clone(){const e=super.clone();return e.storeNode=this.storeNode,e}}const Sb=Hi(Nb).setParameterLength(1,3),Eb=Ki(({texture:e,uv:t})=>{const r=1e-4,s=dn().toVar();return Zi(t.x.lessThan(r),()=>{s.assign(dn(1,0,0))}).ElseIf(t.y.lessThan(r),()=>{s.assign(dn(0,1,0))}).ElseIf(t.z.lessThan(r),()=>{s.assign(dn(0,0,1))}).ElseIf(t.x.greaterThan(.9999),()=>{s.assign(dn(-1,0,0))}).ElseIf(t.y.greaterThan(.9999),()=>{s.assign(dn(0,-1,0))}).ElseIf(t.z.greaterThan(.9999),()=>{s.assign(dn(0,0,-1))}).Else(()=>{const r=.01,i=e.sample(t.add(dn(-.01,0,0))).r.sub(e.sample(t.add(dn(r,0,0))).r),n=e.sample(t.add(dn(0,-.01,0))).r.sub(e.sample(t.add(dn(0,r,0))).r),a=e.sample(t.add(dn(0,0,-.01))).r.sub(e.sample(t.add(dn(0,0,r))).r);s.assign(dn(i,n,a))}),s.normalize()});class Rb extends ll{static get type(){return"Texture3DNode"}constructor(e,t=null,r=null){super(e,t,r),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return dn(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const r=this.value;return!e.isFlipY()||!0!==r.isRenderTargetTexture&&!0!==r.isFramebufferTexture||(t=this.sampler?t.flipY():t.setY(rn(nl(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}generateOffset(e,t){return t.build(e,"ivec3")}normal(e){return Eb({texture:this,uv:e})}}const Ab=Hi(Rb).setParameterLength(1,3);class wb extends qd{static get type(){return"UserDataNode"}constructor(e,t,r=null){super(e,t,r),this.userData=r}updateReference(e){return this.reference=null!==this.userData?this.userData:e.object.userData,this.reference}}const Cb=new WeakMap;class Mb extends Js{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=ks.OBJECT,this.updateAfterType=ks.OBJECT,this.previousModelWorldMatrix=oa(new a),this.previousProjectionMatrix=oa(new a).setGroup(ia),this.previousCameraViewMatrix=oa(new a)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:r}){const s=Bb(r);this.previousModelWorldMatrix.value.copy(s);const i=Pb(t);i.frameId!==e&&(i.frameId=e,void 0===i.previousProjectionMatrix?(i.previousProjectionMatrix=new a,i.previousCameraViewMatrix=new a,i.currentProjectionMatrix=new a,i.currentCameraViewMatrix=new a,i.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),i.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(i.previousProjectionMatrix.copy(i.currentProjectionMatrix),i.previousCameraViewMatrix.copy(i.currentCameraViewMatrix)),i.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),i.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(i.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(i.previousCameraViewMatrix))}updateAfter({object:e}){Bb(e).copy(e.matrixWorld)}setup(){const e=null===this.projectionMatrix?Fl:oa(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),r=e.mul(id).mul(ld),s=this.previousProjectionMatrix.mul(t).mul(dd),i=r.xy.div(r.w),n=s.xy.div(s.w);return ya(i,n)}}function Pb(e){let t=Cb.get(e);return void 0===t&&(t={},Cb.set(e,t)),t}function Bb(e,t=0){const r=Pb(e);let s=r[t];return void 0===s&&(r[t]=s=new a,r[t].copy(e.matrixWorld)),s}const Lb=Wi(Mb),Fb=Ki(([e])=>Vb(e.rgb)),Ib=Ki(([e,t=tn(1)])=>t.mix(Vb(e.rgb),e.rgb)),Db=Ki(([e,t=tn(1)])=>{const r=fa(e.r,e.g,e.b).div(3),s=e.r.max(e.g.max(e.b)),i=s.sub(r).mul(t).mul(-3);return Ho(e.rgb,s,i)}),Ub=Ki(([e,t=tn(1)])=>{const r=dn(.57735,.57735,.57735),s=t.cos();return dn(e.rgb.mul(s).add(r.cross(e.rgb).mul(t.sin()).add(r.mul(Io(r,e.rgb).mul(s.oneMinus())))))}),Vb=(e,t=dn(c.getLuminanceCoefficients(new r)))=>Io(e,t),Ob=Ki(([e,t=dn(1),s=dn(0),i=dn(1),n=tn(1),a=dn(c.getLuminanceCoefficients(new r,le))])=>{const o=e.rgb.dot(dn(a)),u=Mo(e.rgb.mul(t).add(s),0).toVar(),l=u.pow(i).toVar();return Zi(u.r.greaterThan(0),()=>{u.r.assign(l.r)}),Zi(u.g.greaterThan(0),()=>{u.g.assign(l.g)}),Zi(u.b.greaterThan(0),()=>{u.b.assign(l.b)}),u.assign(o.add(u.sub(o).mul(n))),gn(u.rgb,e.a)});class Gb extends Js{static get type(){return"PosterizeNode"}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}const kb=Hi(Gb).setParameterLength(2),zb=new t;class $b extends ll{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class Hb extends $b{static get type(){return"PassMultipleTextureNode"}constructor(e,t,r=!1){super(e,null),this.textureName=t,this.previousTexture=r}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}class Wb extends Js{static get type(){return"PassNode"}constructor(e,t,r,s={}){super("vec4"),this.scope=e,this.scene=t,this.camera=r,this.options=s,this._pixelRatio=1,this._width=1,this._height=1;const i=new V;i.isRenderTargetTexture=!0,i.name="depth";const n=new ue(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:ce,...s});n.texture.name="output",n.depthTexture=i,this.renderTarget=n,this._textures={output:n.texture,depth:i},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=oa(0),this._cameraFar=oa(0),this._mrt=null,this._layers=null,this._resolution=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=ks.FRAME,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];if(void 0===t){t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)}return t}getPreviousTexture(e){let t=this._previousTextures[e];return void 0===t&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(void 0!==t){const r=this._textures[e],s=this.renderTarget.textures.indexOf(r);this.renderTarget.textures[s]=t,this._textures[e]=t,this._previousTextures[e]=r,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return void 0===t&&(t=Gi(new Hb(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return void 0===t&&(void 0===this._textureNodes[e]&&this.getTextureNode(e),t=Gi(new Hb(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(void 0===t){const r=this._cameraNear,s=this._cameraFar;this._viewZNodes[e]=t=np(this.getTextureNode(e),r,s)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(void 0===t){const r=this._cameraNear,s=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=sp(i,r,s)}return t}async compileAsync(e){const t=e.getRenderTarget(),r=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(r)}setup({renderer:e}){return this.renderTarget.samples=void 0===this.options.samples?e.samples:this.options.samples,this.renderTarget.texture.type=e.getColorBufferType(),this.scope===Wb.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:r}=this;let s,i;const n=t.getOutputRenderTarget();n&&!0===n.isXRRenderTarget?(i=1,s=t.xr.getCamera(),t.xr.updateCamera(s),zb.set(n.width,n.height)):(s=this.camera,i=t.getPixelRatio(),t.getSize(zb)),this._pixelRatio=i,this.setSize(zb.width,zb.height);const a=t.getRenderTarget(),o=t.getMRT(),u=s.layers.mask;this._cameraNear.value=s.near,this._cameraFar.value=s.far,null!==this._layers&&(s.layers.mask=this._layers.mask);for(const e in this._previousTextures)this.toggleTexture(e);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(r,s),t.setRenderTarget(a),t.setMRT(o),s.layers.mask=u}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio*this._resolution,s=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(r,s),null!==this._scissor&&this.renderTarget.scissor.copy(this._scissor),null!==this._viewport&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,r,i){null===e?this._scissor=null:(null===this._scissor&&(this._scissor=new s),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,r,i),this._scissor.multiplyScalar(this._pixelRatio*this._resolution).floor())}setViewport(e,t,r,i){null===e?this._viewport=null:(null===this._viewport&&(this._viewport=new s),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,r,i),this._viewport.multiplyScalar(this._pixelRatio*this._resolution).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}Wb.COLOR="color",Wb.DEPTH="depth";class qb extends Wb{static get type(){return"ToonOutlinePassNode"}constructor(e,t,r,s,i){super(Wb.COLOR,e,t),this.colorNode=r,this.thicknessNode=s,this.alphaNode=i,this._materialCache=new WeakMap}updateBefore(e){const{renderer:t}=e,r=t.getRenderObjectFunction();t.setRenderObjectFunction((e,r,s,i,n,a,o,u)=>{if((n.isMeshToonMaterial||n.isMeshToonNodeMaterial)&&!1===n.wireframe){const l=this._getOutlineMaterial(n);t.renderObject(e,r,s,i,l,a,o,u)}t.renderObject(e,r,s,i,n,a,o,u)}),super.updateBefore(e),t.setRenderObjectFunction(r)}_createMaterial(){const e=new Sp;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=S;const t=Td.negate(),r=Fl.mul(id),s=tn(1),i=r.mul(gn(ld,1)),n=r.mul(gn(ld.add(t),1)),a=no(i.sub(n));return e.vertexNode=i.add(a.mul(this.thicknessNode).mul(i.w).mul(s)),e.colorNode=gn(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return void 0===t&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const jb=Ki(([e,t])=>e.mul(t).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Xb=Ki(([e,t])=>(e=e.mul(t)).div(e.add(1)).clamp()).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Kb=Ki(([e,t])=>{const r=(e=(e=e.mul(t)).sub(.004).max(0)).mul(e.mul(6.2).add(.5)),s=e.mul(e.mul(6.2).add(1.7)).add(.06);return r.div(s).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Yb=Ki(([e])=>{const t=e.mul(e.add(.0245786)).sub(90537e-9),r=e.mul(e.add(.432951).mul(.983729)).add(.238081);return t.div(r)}),Qb=Ki(([e,t])=>{const r=xn(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),s=xn(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return e=e.mul(t).div(.6),e=r.mul(e),e=Yb(e),(e=s.mul(e)).clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Zb=xn(dn(1.6605,-.1246,-.0182),dn(-.5876,1.1329,-.1006),dn(-.0728,-.0083,1.1187)),Jb=xn(dn(.6274,.0691,.0164),dn(.3293,.9195,.088),dn(.0433,.0113,.8956)),ex=Ki(([e])=>{const t=dn(e).toVar(),r=dn(t.mul(t)).toVar(),s=dn(r.mul(r)).toVar();return tn(15.5).mul(s.mul(r)).sub(ba(40.14,s.mul(t))).add(ba(31.96,s).sub(ba(6.868,r.mul(t))).add(ba(.4298,r).add(ba(.1191,t).sub(.00232))))}),tx=Ki(([e,t])=>{const r=dn(e).toVar(),s=xn(dn(.856627153315983,.137318972929847,.11189821299995),dn(.0951212405381588,.761241990602591,.0767994186031903),dn(.0482516061458583,.101439036467562,.811302368396859)),i=xn(dn(1.1271005818144368,-.1413297634984383,-.14132976349843826),dn(-.11060664309660323,1.157823702216272,-.11060664309660294),dn(-.016493938717834573,-.016493938717834257,1.2519364065950405)),n=tn(-12.47393),a=tn(4.026069);return r.mulAssign(t),r.assign(Jb.mul(r)),r.assign(s.mul(r)),r.assign(Mo(r,1e-10)),r.assign(eo(r)),r.assign(r.sub(n).div(a.sub(n))),r.assign(Wo(r,0,1)),r.assign(ex(r)),r.assign(i.mul(r)),r.assign(Uo(Mo(dn(0),r),dn(2.2))),r.assign(Zb.mul(r)),r.assign(Wo(r,0,1)),r}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),rx=Ki(([e,t])=>{const r=tn(.76),s=tn(.15);e=e.mul(t);const i=Co(e.r,Co(e.g,e.b)),n=iu(i.lessThan(.08),i.sub(ba(6.25,i.mul(i))),.04);e.subAssign(n);const a=Mo(e.r,Mo(e.g,e.b));Zi(a.lessThan(r),()=>e);const o=ya(1,r),u=ya(1,o.mul(o).div(a.add(o.sub(r))));e.mulAssign(u.div(a));const l=ya(1,xa(1,s.mul(a.sub(u)).add(1)));return Ho(e,dn(u),l)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class sx extends Ys{static get type(){return"CodeNode"}constructor(e="",t=[],r=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=r}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const r=e.getCodeFromNode(this,this.getNodeType(e));return r.code=this.code,r.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const ix=Hi(sx).setParameterLength(1,3);class nx extends sx{static get type(){return"FunctionNode"}constructor(e="",t=[],r=""){super(e,t,r)}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,t){const r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let r=t.nodeFunction;return void 0===r&&(r=e.parser.parseFunction(this.code),t.nodeFunction=r),r}generate(e,t){super.generate(e);const r=this.getNodeFunction(e),s=r.name,i=r.type,n=e.getCodeFromNode(this,i);""!==s&&(n.name=s);const a=e.getPropertyName(n),o=this.getNodeFunction(e).getCode(a);return n.code=o+"\n","property"===t?a:e.format(`${a}()`,i,t)}}const ax=(e,t=[],r="")=>{for(let e=0;e<t.length;e++){const r=t[e];"function"==typeof r&&(t[e]=r.functionNode)}const s=Gi(new nx(e,t,r)),i=(...e)=>s.call(...e);return i.functionNode=s,i};class ox extends Ys{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new o,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return null!==this.outputType}set value(e){this._value!==e&&(this._cache&&"URL"===this.inputType&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&null===this._cache&&"URL"===this.inputType&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&null!==e.value&&void 0!==e.value&&(("URL"===this.inputType||"String"===this.inputType)&&"string"==typeof e.value||"Number"===this.inputType&&"number"==typeof e.value||"Vector2"===this.inputType&&e.value.isVector2||"Vector3"===this.inputType&&e.value.isVector3||"Vector4"===this.inputType&&e.value.isVector4||"Color"===this.inputType&&e.value.isColor||"Matrix3"===this.inputType&&e.value.isMatrix3||"Matrix4"===this.inputType&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:tn()}serialize(e){super.serialize(e),null!==this.value?"ArrayBuffer"===this.inputType?e.value=Us(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;null!==e.value&&(t="ArrayBuffer"===e.inputType?Vs(e.value):"Texture"===e.inputType?e.meta.textures[e.value]:e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const ux=Hi(ox).setParameterLength(1);class lx extends Map{get(e,t=null,...r){if(this.has(e))return super.get(e);if(null!==t){const s=t(...r);return this.set(e,s),s}}}class dx{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const cx=new lx;class hx extends Ys{static get type(){return"ScriptableNode"}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new lx,this._output=ux(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const r=this._outputs;return void 0===r[e]?r[e]=ux(t):r[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const r=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),r[e]=t,r[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),r[e]=t,r[e].events.addEventListener("refresh",this.onRefresh)):void 0===r[e]?(r[e]=ux(t),r[e].events.addEventListener("refresh",this.onRefresh)):r[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...t){const r=this.getObject()[e];if("function"==typeof r)return r(...t)}async callAsync(e,...t){const r=this.getObject()[e];if("function"==typeof r)return"AsyncFunction"===r.constructor.name?await r(...t):r(...t)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){null!==e?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),null!==this._object)return this._object;const e=new dx(this),t=cx.get("THREE"),r=cx.get("TSL"),s=this.getMethod(),i=[e,this._local,cx,()=>this.refresh(),(e,t)=>this.setOutput(e,t),t,r];this._object=s(...i);const n=this._object.layout;if(n&&(!1===n.cache&&this._local.clear(),this._output.outputType=n.outputType||null,Array.isArray(n.elements)))for(const e of n.elements){const t=e.id||e.name;e.inputType&&(void 0===this.getParameter(t)&&this.setParameter(t,null),this.getParameter(t).inputType=e.inputType),e.outputType&&(void 0===this.getOutput(t)&&this.setOutput(t,null),this.getOutput(t).outputType=e.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const e in this.parameters){let t=this.parameters[e];t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:tn()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),null!==this._method)return this._method;const e=["layout","init","main","dispose"].join(", "),t="\nreturn { ...output, "+e+" };",r="var "+e+"; var output = {};\n"+this.codeNode.code+t;return this._method=new Function(...["parameters","local","global","refresh","setOutput","THREE","TSL"],r),this._method}dispose(){null!==this._method&&(this._object&&"function"==typeof this._object.dispose&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[vs(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const r in this.parameters)t.push(this.parameters[r].getCacheKey(e));return Ns(t)}set needsUpdate(e){!0===e&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return null===this.codeNode||(!0===this._needsOutputUpdate&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value),this}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const px=Hi(hx).setParameterLength(1,2);function gx(e){let t;const r=e.context.getViewZ;return void 0!==r&&(t=r(this)),(t||pd.z).negate()}const mx=Ki(([e,t],r)=>{const s=gx(r);return Xo(e,t,s)}),fx=Ki(([e],t)=>{const r=gx(t);return e.mul(e,r,r).negate().exp().oneMinus()}),yx=Ki(([e,t])=>gn(t.toFloat().mix(Hn.rgb,e.toVec3()),Hn.a));let bx=null,xx=null;class Tx extends Ys{static get type(){return"RangeNode"}constructor(e=tn(),t=tn()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength(Fs(this.minNode.value)),r=e.getTypeLength(Fs(this.maxNode.value));return t>r?t:r}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let r=null;if(t.count>1){const i=this.minNode.value,n=this.maxNode.value,a=e.getTypeLength(Fs(i)),o=e.getTypeLength(Fs(n));bx=bx||new s,xx=xx||new s,bx.setScalar(0),xx.setScalar(0),1===a?bx.setScalar(i):i.isColor?bx.set(i.r,i.g,i.b,1):bx.set(i.x,i.y,i.z||0,i.w||0),1===o?xx.setScalar(n):n.isColor?xx.set(n.r,n.g,n.b,1):xx.set(n.x,n.y,n.z||0,n.w||0);const l=4,d=l*t.count,c=new Float32Array(d);for(let e=0;e<d;e++){const t=e%l,r=bx.getComponent(t),s=xx.getComponent(t);c[e]=u.lerp(r,s,Math.random())}const h=this.getNodeType(e);if(t.count<=4096)r=gl(c,"vec4",t.count).element(bh).convert(h);else{const t=new L(c,4);e.geometry.setAttribute("__range"+this.id,t),r=Du(t).convert(h)}}else r=tn(0);return r}}const _x=Hi(Tx).setParameterLength(2);class vx extends Ys{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const r=this.getBuiltinName(e),s=this.getNodeType(e);return"compute"===e.shaderStage?e.format(r,s,t):(console.warn(`ComputeBuiltinNode: Compute built-in value ${r} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(s))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const Nx=(e,t)=>Gi(new vx(e,t)),Sx=Nx("numWorkgroups","uvec3"),Ex=Nx("workgroupId","uvec3"),Rx=Nx("globalId","uvec3"),Ax=Nx("localId","uvec3"),wx=Nx("subgroupSize","uint");const Cx=Hi(class extends Ys{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:r}=e;!0===r.backend.isWebGLBackend?e.addFlowCode(`\t// ${t}Barrier \n`):e.addLineFlowCode(`${t}Barrier()`,this)}});class Mx extends Qs{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let r;const s=e.context.assign;if(r=super.generate(e),!0!==s){const s=this.getNodeType(e);r=e.format(r,s,t)}return r}}class Px extends Ys{constructor(e,t,r=0){super(t),this.bufferType=t,this.bufferCount=r,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e,this.name=""}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return Gi(new Mx(this,e))}generate(e){const t=""!==this.name?this.name:`${this.scope}Array_${this.id}`;return e.getScopedArray(t,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}class Bx extends Ys{static get type(){return"AtomicFunctionNode"}constructor(e,t,r){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=r,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),r=t.parents,s=this.method,i=this.getNodeType(e),n=this.getInputType(e),a=this.pointerNode,o=this.valueNode,u=[];u.push(`&${a.build(e,n)}`),null!==o&&u.push(o.build(e,n));const l=`${e.getMethod(s,i)}( ${u.join(", ")} )`;if(!(!!r&&(1===r.length&&!0===r[0].isStackNode)))return void 0===t.constNode&&(t.constNode=Ku(l,i).toConst()),t.constNode.build(e);e.addLineFlowCode(l,this)}}Bx.ATOMIC_LOAD="atomicLoad",Bx.ATOMIC_STORE="atomicStore",Bx.ATOMIC_ADD="atomicAdd",Bx.ATOMIC_SUB="atomicSub",Bx.ATOMIC_MAX="atomicMax",Bx.ATOMIC_MIN="atomicMin",Bx.ATOMIC_AND="atomicAnd",Bx.ATOMIC_OR="atomicOr",Bx.ATOMIC_XOR="atomicXor";const Lx=Hi(Bx),Fx=(e,t,r)=>Lx(e,t,r).toStack();class Ix extends Js{static get type(){return"SubgroupFunctionNode"}constructor(e,t=null,r=null){super(),this.method=e,this.aNode=t,this.bNode=r}getInputType(e){const t=this.aNode?this.aNode.getNodeType(e):null,r=this.bNode?this.bNode.getNodeType(e):null;return(e.isMatrix(t)?0:e.getTypeLength(t))>(e.isMatrix(r)?0:e.getTypeLength(r))?t:r}getNodeType(e){const t=this.method;return t===Ix.SUBGROUP_ELECT?"bool":t===Ix.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,t){const r=this.method,s=this.getNodeType(e),i=this.getInputType(e),n=this.aNode,a=this.bNode,o=[];if(r===Ix.SUBGROUP_BROADCAST||r===Ix.SUBGROUP_SHUFFLE||r===Ix.QUAD_BROADCAST){const t=a.getNodeType(e);o.push(n.build(e,s),a.build(e,"float"===t?"int":s))}else r===Ix.SUBGROUP_SHUFFLE_XOR||r===Ix.SUBGROUP_SHUFFLE_DOWN||r===Ix.SUBGROUP_SHUFFLE_UP?o.push(n.build(e,s),a.build(e,"uint")):(null!==n&&o.push(n.build(e,i)),null!==a&&o.push(a.build(e,i)));const u=0===o.length?"()":`( ${o.join(", ")} )`;return e.format(`${e.getMethod(r,s)}${u}`,s,t)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Ix.SUBGROUP_ELECT="subgroupElect",Ix.SUBGROUP_BALLOT="subgroupBallot",Ix.SUBGROUP_ADD="subgroupAdd",Ix.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd",Ix.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd",Ix.SUBGROUP_MUL="subgroupMul",Ix.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul",Ix.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul",Ix.SUBGROUP_AND="subgroupAnd",Ix.SUBGROUP_OR="subgroupOr",Ix.SUBGROUP_XOR="subgroupXor",Ix.SUBGROUP_MIN="subgroupMin",Ix.SUBGROUP_MAX="subgroupMax",Ix.SUBGROUP_ALL="subgroupAll",Ix.SUBGROUP_ANY="subgroupAny",Ix.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst",Ix.QUAD_SWAP_X="quadSwapX",Ix.QUAD_SWAP_Y="quadSwapY",Ix.QUAD_SWAP_DIAGONAL="quadSwapDiagonal",Ix.SUBGROUP_BROADCAST="subgroupBroadcast",Ix.SUBGROUP_SHUFFLE="subgroupShuffle",Ix.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor",Ix.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp",Ix.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown",Ix.QUAD_BROADCAST="quadBroadcast";const Dx=qi(Ix,Ix.SUBGROUP_ELECT).setParameterLength(0),Ux=qi(Ix,Ix.SUBGROUP_BALLOT).setParameterLength(1),Vx=qi(Ix,Ix.SUBGROUP_ADD).setParameterLength(1),Ox=qi(Ix,Ix.SUBGROUP_INCLUSIVE_ADD).setParameterLength(1),Gx=qi(Ix,Ix.SUBGROUP_EXCLUSIVE_AND).setParameterLength(1),kx=qi(Ix,Ix.SUBGROUP_MUL).setParameterLength(1),zx=qi(Ix,Ix.SUBGROUP_INCLUSIVE_MUL).setParameterLength(1),$x=qi(Ix,Ix.SUBGROUP_EXCLUSIVE_MUL).setParameterLength(1),Hx=qi(Ix,Ix.SUBGROUP_AND).setParameterLength(1),Wx=qi(Ix,Ix.SUBGROUP_OR).setParameterLength(1),qx=qi(Ix,Ix.SUBGROUP_XOR).setParameterLength(1),jx=qi(Ix,Ix.SUBGROUP_MIN).setParameterLength(1),Xx=qi(Ix,Ix.SUBGROUP_MAX).setParameterLength(1),Kx=qi(Ix,Ix.SUBGROUP_ALL).setParameterLength(0),Yx=qi(Ix,Ix.SUBGROUP_ANY).setParameterLength(0),Qx=qi(Ix,Ix.SUBGROUP_BROADCAST_FIRST).setParameterLength(2),Zx=qi(Ix,Ix.QUAD_SWAP_X).setParameterLength(1),Jx=qi(Ix,Ix.QUAD_SWAP_Y).setParameterLength(1),eT=qi(Ix,Ix.QUAD_SWAP_DIAGONAL).setParameterLength(1),tT=qi(Ix,Ix.SUBGROUP_BROADCAST).setParameterLength(2),rT=qi(Ix,Ix.SUBGROUP_SHUFFLE).setParameterLength(2),sT=qi(Ix,Ix.SUBGROUP_SHUFFLE_XOR).setParameterLength(2),iT=qi(Ix,Ix.SUBGROUP_SHUFFLE_UP).setParameterLength(2),nT=qi(Ix,Ix.SUBGROUP_SHUFFLE_DOWN).setParameterLength(2),aT=qi(Ix,Ix.QUAD_BROADCAST).setParameterLength(1);let oT;function uT(e){oT=oT||new WeakMap;let t=oT.get(e);return void 0===t&&oT.set(e,t={}),t}function lT(e){const t=uT(e);return t.shadowMatrix||(t.shadowMatrix=oa("mat4").setGroup(ia).onRenderUpdate(t=>(!0===e.castShadow&&!1!==t.renderer.shadowMap.enabled||e.shadow.updateMatrices(e),e.shadow.matrix)))}function dT(e,t=cd){const r=lT(e).mul(t);return r.xyz.div(r.w)}function cT(e){const t=uT(e);return t.position||(t.position=oa(new r).setGroup(ia).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(e.matrixWorld)))}function hT(e){const t=uT(e);return t.targetPosition||(t.targetPosition=oa(new r).setGroup(ia).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(e.target.matrixWorld)))}function pT(e){const t=uT(e);return t.viewPosition||(t.viewPosition=oa(new r).setGroup(ia).onRenderUpdate(({camera:t},s)=>{s.value=s.value||new r,s.value.setFromMatrixPosition(e.matrixWorld),s.value.applyMatrix4(t.matrixWorldInverse)}))}const gT=e=>Dl.transformDirection(cT(e).sub(hT(e))),mT=(e,t)=>{for(const r of t)if(r.isAnalyticLightNode&&r.light.id===e)return r;return null},fT=new WeakMap,yT=[];class bT extends Ys{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Sn("vec3","totalDiffuse"),this.totalSpecularNode=Sn("vec3","totalSpecular"),this.outgoingLightNode=Sn("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let t=0;t<e.length;t++){const r=e[t];if(yT.push(r.id),yT.push(r.castShadow?1:0),!0===r.isSpotLight){const e=null!==r.map?r.map.id:-1,t=r.colorNode?r.colorNode.getCacheKey():-1;yT.push(e,t)}}const t=Ns(yT);return yT.length=0,t}getHash(e){if(null===this._lightNodesHash){null===this._lightNodes&&this.setupLightsNode(e);const t=[];for(const e of this._lightNodes)t.push(e.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const r of t.nodes)r.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],r=this._lightNodes,s=(e=>e.sort((e,t)=>e.id-t.id))(this._lights),i=e.renderer.library;for(const e of s)if(e.isNode)t.push(Gi(e));else{let s=null;if(null!==r&&(s=mT(e.id,r)),null===s){const r=i.getLightNodeClass(e.constructor);if(null===r){console.warn(`LightsNode.setupNodeLights: Light node not found for ${e.constructor.name}`);continue}let s=null;fT.has(e)?s=fT.get(e):(s=Gi(new r(e)),fT.set(e,s)),t.push(s)}}this._lightNodes=t}setupDirectLight(e,t,r){const{lightingModel:s,reflectedLight:i}=e.context;s.direct({...r,lightNode:t,reflectedLight:i},e)}setupDirectRectAreaLight(e,t,r){const{lightingModel:s,reflectedLight:i}=e.context;s.directRectArea({...r,lightNode:t,reflectedLight:i},e)}setupLights(e,t){for(const r of t)r.build(e)}getLightNodes(e){return null===this._lightNodes&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let r=this.outgoingLightNode;const s=e.context,i=s.lightingModel,n=e.getNodeProperties(this);if(i){const{totalDiffuseNode:t,totalSpecularNode:a}=this;s.outgoingLight=r;const o=e.addStack();n.nodes=o.nodes,i.start(e);const{backdrop:u,backdropAlpha:l}=s,{directDiffuse:d,directSpecular:c,indirectDiffuse:h,indirectSpecular:p}=s.reflectedLight;let g=d.add(h);null!==u&&(g=dn(null!==l?l.mix(g,u):u),s.material.transparent=!0),t.assign(g),a.assign(c.add(p)),r.assign(t.add(a)),i.finish(e),r=r.bypass(e.removeStack())}else n.nodes=[];return e.lightsNode=t,r}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class xT extends Ys{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=ks.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){TT.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||cd)}}const TT=Sn("vec3","shadowPositionWorld");function _T(t,r={}){return r.toneMapping=t.toneMapping,r.toneMappingExposure=t.toneMappingExposure,r.outputColorSpace=t.outputColorSpace,r.renderTarget=t.getRenderTarget(),r.activeCubeFace=t.getActiveCubeFace(),r.activeMipmapLevel=t.getActiveMipmapLevel(),r.renderObjectFunction=t.getRenderObjectFunction(),r.pixelRatio=t.getPixelRatio(),r.mrt=t.getMRT(),r.clearColor=t.getClearColor(r.clearColor||new e),r.clearAlpha=t.getClearAlpha(),r.autoClear=t.autoClear,r.scissorTest=t.getScissorTest(),r}function vT(e,t){return t=_T(e,t),e.setMRT(null),e.setRenderObjectFunction(null),e.setClearColor(0,1),e.autoClear=!0,t}function NT(e,t){e.toneMapping=t.toneMapping,e.toneMappingExposure=t.toneMappingExposure,e.outputColorSpace=t.outputColorSpace,e.setRenderTarget(t.renderTarget,t.activeCubeFace,t.activeMipmapLevel),e.setRenderObjectFunction(t.renderObjectFunction),e.setPixelRatio(t.pixelRatio),e.setMRT(t.mrt),e.setClearColor(t.clearColor,t.clearAlpha),e.autoClear=t.autoClear,e.setScissorTest(t.scissorTest)}function ST(e,t={}){return t.background=e.background,t.backgroundNode=e.backgroundNode,t.overrideMaterial=e.overrideMaterial,t}function ET(e,t){return t=ST(e,t),e.background=null,e.backgroundNode=null,e.overrideMaterial=null,t}function RT(e,t){e.background=t.background,e.backgroundNode=t.backgroundNode,e.overrideMaterial=t.overrideMaterial}function AT(e,t,r){return r=ET(t,r=vT(e,r))}function wT(e,t,r){NT(e,r),RT(t,r)}var CT=Object.freeze({__proto__:null,resetRendererAndSceneState:AT,resetRendererState:vT,resetSceneState:ET,restoreRendererAndSceneState:wT,restoreRendererState:NT,restoreSceneState:RT,saveRendererAndSceneState:function(e,t,r={}){return r=ST(t,r=_T(e,r))},saveRendererState:_T,saveSceneState:ST});const MT=new WeakMap,PT=Ki(({depthTexture:e,shadowCoord:t,depthLayer:r})=>{let s=cl(e,t.xy).setName("t_basic");return e.isArrayTexture&&(s=s.depth(r)),s.compare(t.z)}),BT=Ki(({depthTexture:e,shadowCoord:t,shadow:r,depthLayer:s})=>{const i=(t,r)=>{let i=cl(e,t);return e.isArrayTexture&&(i=i.depth(s)),i.compare(r)},n=jd("mapSize","vec2",r).setGroup(ia),a=jd("radius","float",r).setGroup(ia),o=an(1).div(n),u=o.x.negate().mul(a),l=o.y.negate().mul(a),d=o.x.mul(a),c=o.y.mul(a),h=u.div(2),p=l.div(2),g=d.div(2),m=c.div(2);return fa(i(t.xy.add(an(u,l)),t.z),i(t.xy.add(an(0,l)),t.z),i(t.xy.add(an(d,l)),t.z),i(t.xy.add(an(h,p)),t.z),i(t.xy.add(an(0,p)),t.z),i(t.xy.add(an(g,p)),t.z),i(t.xy.add(an(u,0)),t.z),i(t.xy.add(an(h,0)),t.z),i(t.xy,t.z),i(t.xy.add(an(g,0)),t.z),i(t.xy.add(an(d,0)),t.z),i(t.xy.add(an(h,m)),t.z),i(t.xy.add(an(0,m)),t.z),i(t.xy.add(an(g,m)),t.z),i(t.xy.add(an(u,c)),t.z),i(t.xy.add(an(0,c)),t.z),i(t.xy.add(an(d,c)),t.z)).mul(1/17)}),LT=Ki(({depthTexture:e,shadowCoord:t,shadow:r,depthLayer:s})=>{const i=(t,r)=>{let i=cl(e,t);return e.isArrayTexture&&(i=i.depth(s)),i.compare(r)},n=jd("mapSize","vec2",r).setGroup(ia),a=an(1).div(n),o=a.x,u=a.y,l=t.xy,d=ao(l.mul(n).add(.5));return l.subAssign(d.mul(a)),fa(i(l,t.z),i(l.add(an(o,0)),t.z),i(l.add(an(0,u)),t.z),i(l.add(a),t.z),Ho(i(l.add(an(o.negate(),0)),t.z),i(l.add(an(o.mul(2),0)),t.z),d.x),Ho(i(l.add(an(o.negate(),u)),t.z),i(l.add(an(o.mul(2),u)),t.z),d.x),Ho(i(l.add(an(0,u.negate())),t.z),i(l.add(an(0,u.mul(2))),t.z),d.y),Ho(i(l.add(an(o,u.negate())),t.z),i(l.add(an(o,u.mul(2))),t.z),d.y),Ho(Ho(i(l.add(an(o.negate(),u.negate())),t.z),i(l.add(an(o.mul(2),u.negate())),t.z),d.x),Ho(i(l.add(an(o.negate(),u.mul(2))),t.z),i(l.add(an(o.mul(2),u.mul(2))),t.z),d.x),d.y)).mul(1/9)}),FT=Ki(({depthTexture:e,shadowCoord:t,depthLayer:r})=>{const s=tn(1).toVar();let i=cl(e).sample(t.xy);e.isArrayTexture&&(i=i.depth(r)),i=i.rg;const n=Po(t.z,i.x);return Zi(n.notEqual(tn(1)),()=>{const e=t.z.sub(i.x),r=Mo(0,i.y.mul(i.y));let a=r.div(r.add(e.mul(e)));a=Wo(ya(a,.3).div(.95-.3)),s.assign(Wo(Mo(n,a)))}),s}),IT=Ki(([e,t,r])=>{let s=cd.sub(e).length();return s=s.sub(t).div(r.sub(t)),s=s.saturate(),s}),DT=e=>{let t=MT.get(e);if(void 0===t){const r=e.isPointLight?(e=>{const t=e.shadow.camera,r=jd("near","float",t).setGroup(ia),s=jd("far","float",t).setGroup(ia),i=Wl(e);return IT(i,r,s)})(e):null;t=new Sp,t.colorNode=gn(0,0,0,1),t.depthNode=r,t.isShadowPassMaterial=!0,t.name="ShadowMaterial",t.fog=!1,MT.set(e,t)}return t},UT=new Nf,VT=[],OT=(e,t,r,s)=>{VT[0]=e,VT[1]=t;let i=UT.get(VT);return void 0!==i&&i.shadowType===r&&i.useVelocity===s||(i=(i,n,a,o,u,l,...d)=>{(!0===i.castShadow||i.receiveShadow&&r===De)&&(s&&(Ds(i).useVelocity=!0),i.onBeforeShadow(e,i,a,t.camera,o,n.overrideMaterial,l),e.renderObject(i,n,a,o,u,l,...d),i.onAfterShadow(e,i,a,t.camera,o,n.overrideMaterial,l))},i.shadowType=r,i.useVelocity=s,UT.set(VT,i)),VT[0]=null,VT[1]=null,i},GT=Ki(({samples:e,radius:t,size:r,shadowPass:s,depthLayer:i})=>{const n=tn(0).toVar("meanVertical"),a=tn(0).toVar("squareMeanVertical"),o=e.lessThanEqual(tn(1)).select(tn(0),tn(2).div(e.sub(1))),u=e.lessThanEqual(tn(1)).select(tn(0),tn(-1));Uh({start:rn(0),end:rn(e),type:"int",condition:"<"},({i:e})=>{const l=u.add(tn(e).mul(o));let d=s.sample(fa(El.xy,an(0,l).mul(t)).div(r));s.value.isArrayTexture&&(d=d.depth(i)),d=d.x,n.addAssign(d),a.addAssign(d.mul(d))}),n.divAssign(e),a.divAssign(e);const l=to(a.sub(n.mul(n)));return an(n,l)}),kT=Ki(({samples:e,radius:t,size:r,shadowPass:s,depthLayer:i})=>{const n=tn(0).toVar("meanHorizontal"),a=tn(0).toVar("squareMeanHorizontal"),o=e.lessThanEqual(tn(1)).select(tn(0),tn(2).div(e.sub(1))),u=e.lessThanEqual(tn(1)).select(tn(0),tn(-1));Uh({start:rn(0),end:rn(e),type:"int",condition:"<"},({i:e})=>{const l=u.add(tn(e).mul(o));let d=s.sample(fa(El.xy,an(l,0).mul(t)).div(r));s.value.isArrayTexture&&(d=d.depth(i)),n.addAssign(d.x),a.addAssign(fa(d.y.mul(d.y),d.x.mul(d.x)))}),n.divAssign(e),a.divAssign(e);const l=to(a.sub(n.mul(n)));return an(n,l)}),zT=[PT,BT,LT,FT];let $T;const HT=new sb;class WT extends xT{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:r,shadowCoord:s,shadow:i,depthLayer:n}){const a=s.x.greaterThanEqual(0).and(s.x.lessThanEqual(1)).and(s.y.greaterThanEqual(0)).and(s.y.lessThanEqual(1)).and(s.z.lessThanEqual(1)),o=t({depthTexture:r,shadowCoord:s,shadow:i,depthLayer:n});return a.select(o,tn(1))}setupShadowCoord(e,t){const{shadow:r}=this,{renderer:s}=e,i=jd("bias","float",r).setGroup(ia);let n,a=t;if(r.camera.isOrthographicCamera||!0!==s.logarithmicDepthBuffer)a=a.xyz.div(a.w),n=a.z,s.coordinateSystem===d&&(n=n.mul(2).sub(1));else{const e=a.w;a=a.xy.div(e);const t=jd("near","float",r.camera).setGroup(ia),s=jd("far","float",r.camera).setGroup(ia);n=ap(e.negate(),t,s)}return a=dn(a.x,a.y.oneMinus(),n.add(i)),a}getShadowFilterFn(e){return zT[e]}setupRenderTarget(e,t){const r=new V(e.mapSize.width,e.mapSize.height);r.name="ShadowDepthTexture",r.compareFunction=Ue;const s=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return s.texture.name="ShadowMap",s.texture.type=e.mapType,s.depthTexture=r,{shadowMap:s,depthTexture:r}}setupShadow(e){const{renderer:t}=e,{light:r,shadow:s}=this,i=t.shadowMap.type,{depthTexture:n,shadowMap:a}=this.setupRenderTarget(s,e);if(s.camera.updateProjectionMatrix(),i===De&&!0!==s.isPointLightShadow){n.compareFunction=null,a.depth>1?(a._vsmShadowMapVertical||(a._vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=a._vsmShadowMapVertical,a._vsmShadowMapHorizontal||(a._vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=a._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depthBuffer:!1}));let t=cl(n);n.isArrayTexture&&(t=t.depth(this.depthLayer));let r=cl(this.vsmShadowMapVertical.texture);n.isArrayTexture&&(r=r.depth(this.depthLayer));const i=jd("blurSamples","float",s).setGroup(ia),o=jd("radius","float",s).setGroup(ia),u=jd("mapSize","vec2",s).setGroup(ia);let l=this.vsmMaterialVertical||(this.vsmMaterialVertical=new Sp);l.fragmentNode=GT({samples:i,radius:o,size:u,shadowPass:t,depthLayer:this.depthLayer}).context(e.getSharedContext()),l.name="VSMVertical",l=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new Sp),l.fragmentNode=kT({samples:i,radius:o,size:u,shadowPass:r,depthLayer:this.depthLayer}).context(e.getSharedContext()),l.name="VSMHorizontal"}const o=jd("intensity","float",s).setGroup(ia),u=jd("normalBias","float",s).setGroup(ia),l=lT(r).mul(TT.add(Ed.mul(u))),d=this.setupShadowCoord(e,l),c=s.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(null===c)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const h=i===De&&!0!==s.isPointLightShadow?this.vsmShadowMapHorizontal.texture:n,p=this.setupShadowFilter(e,{filterFn:c,shadowTexture:a.texture,depthTexture:h,shadowCoord:d,shadow:s,depthLayer:this.depthLayer});let g=cl(a.texture,d);n.isArrayTexture&&(g=g.depth(this.depthLayer));const m=Ho(1,p.rgb.mix(g,1),o.mul(g.a)).toVar();return this.shadowMap=a,this.shadow.map=a,m}setup(e){if(!1!==e.renderer.shadowMap.enabled)return Ki(()=>{let t=this._node;return this.setupShadowPosition(e),null===t&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:r,light:s}=this,{renderer:i,scene:n}=e;t.updateMatrices(s),r.setSize(t.mapSize.width,t.mapSize.height,r.depth),i.render(n,t.camera)}updateShadow(e){const{shadowMap:t,light:r,shadow:s}=this,{renderer:i,scene:n,camera:a}=e,o=i.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u;const l=s.camera.layers.mask;4294967294&s.camera.layers.mask||(s.camera.layers.mask=a.layers.mask);const d=i.getRenderObjectFunction(),c=i.getMRT(),h=!!c&&c.has("velocity");$T=AT(i,n,$T),n.overrideMaterial=DT(r),i.setRenderObjectFunction(OT(i,s,o,h)),i.setClearColor(0,0),i.setRenderTarget(t),this.renderShadow(e),i.setRenderObjectFunction(d),o===De&&!0!==s.isPointLightShadow&&this.vsmPass(i),s.camera.layers.mask=l,wT(i,n,$T)}vsmPass(e){const{shadow:t}=this,r=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,r),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,r),e.setRenderTarget(this.vsmShadowMapVertical),HT.material=this.vsmMaterialVertical,HT.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),HT.material=this.vsmMaterialHorizontal,HT.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,null!==this.vsmShadowMapVertical&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),null!==this.vsmShadowMapHorizontal&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let r=t.needsUpdate||t.autoUpdate;r&&(this._cameraFrameId[e.camera]===e.frameId&&(r=!1),this._cameraFrameId[e.camera]=e.frameId),r&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const qT=(e,t)=>Gi(new WT(e,t)),jT=new e,XT=Ki(([e,t])=>{const r=e.toVar(),s=go(r),i=xa(1,Mo(s.x,Mo(s.y,s.z)));s.mulAssign(i),r.mulAssign(i.mul(t.mul(2).oneMinus()));const n=an(r.xy).toVar(),a=t.mul(1.5).oneMinus();return Zi(s.z.greaterThanEqual(a),()=>{Zi(r.z.greaterThan(0),()=>{n.x.assign(ya(4,r.x))})}).ElseIf(s.x.greaterThanEqual(a),()=>{const e=mo(r.x);n.x.assign(r.z.mul(e).add(e.mul(2)))}).ElseIf(s.y.greaterThanEqual(a),()=>{const e=mo(r.y);n.x.assign(r.x.add(e.mul(2)).add(2)),n.y.assign(r.z.mul(e).sub(2))}),an(.125,.25).mul(n).add(an(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),KT=Ki(({depthTexture:e,bd3D:t,dp:r,texelSize:s})=>cl(e,XT(t,s.y)).compare(r)),YT=Ki(({depthTexture:e,bd3D:t,dp:r,texelSize:s,shadow:i})=>{const n=jd("radius","float",i).setGroup(ia),a=an(-1,1).mul(n).mul(s.y);return cl(e,XT(t.add(a.xyy),s.y)).compare(r).add(cl(e,XT(t.add(a.yyy),s.y)).compare(r)).add(cl(e,XT(t.add(a.xyx),s.y)).compare(r)).add(cl(e,XT(t.add(a.yyx),s.y)).compare(r)).add(cl(e,XT(t,s.y)).compare(r)).add(cl(e,XT(t.add(a.xxy),s.y)).compare(r)).add(cl(e,XT(t.add(a.yxy),s.y)).compare(r)).add(cl(e,XT(t.add(a.xxx),s.y)).compare(r)).add(cl(e,XT(t.add(a.yxx),s.y)).compare(r)).mul(1/9)}),QT=Ki(({filterFn:e,depthTexture:t,shadowCoord:r,shadow:s})=>{const i=r.xyz.toVar(),n=i.length(),a=oa("float").setGroup(ia).onRenderUpdate(()=>s.camera.near),o=oa("float").setGroup(ia).onRenderUpdate(()=>s.camera.far),u=jd("bias","float",s).setGroup(ia),l=oa(s.mapSize).setGroup(ia),d=tn(1).toVar();return Zi(n.sub(o).lessThanEqual(0).and(n.sub(a).greaterThanEqual(0)),()=>{const r=n.sub(a).div(o.sub(a)).toVar();r.addAssign(u);const c=i.normalize(),h=an(1).div(l.mul(an(4,2)));d.assign(e({depthTexture:t,bd3D:c,dp:r,texelSize:h,shadow:s}))}),d}),ZT=new s,JT=new t,e_=new t;class t_ extends WT{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===Oe?KT:YT}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:r,depthTexture:s,shadowCoord:i,shadow:n}){return QT({filterFn:t,shadowTexture:r,depthTexture:s,shadowCoord:i,shadow:n})}renderShadow(e){const{shadow:t,shadowMap:r,light:s}=this,{renderer:i,scene:n}=e,a=t.getFrameExtents();e_.copy(t.mapSize),e_.multiply(a),r.setSize(e_.width,e_.height),JT.copy(t.mapSize);const o=i.autoClear,u=i.getClearColor(jT),l=i.getClearAlpha();i.autoClear=!1,i.setClearColor(t.clearColor,t.clearAlpha),i.clear();const d=t.getViewportCount();for(let e=0;e<d;e++){const a=t.getViewport(e),o=JT.x*a.x,u=e_.y-JT.y-JT.y*a.y;ZT.set(o,u,JT.x*a.z,JT.y*a.w),r.viewport.copy(ZT),t.updateMatrices(s,e),i.render(n,t.camera)}i.autoClear=o,i.setClearColor(u,l)}}const r_=(e,t)=>Gi(new t_(e,t));class s_ extends Hh{static get type(){return"AnalyticLightNode"}constructor(t=null){super(),this.light=t,this.color=new e,this.colorNode=t&&t.colorNode||oa(this.color).setGroup(ia),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=ks.FRAME}getHash(){return this.light.uuid}getLightVector(e){return pT(this.light).sub(e.context.positionView||pd)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return qT(this.light)}setupShadow(e){const{renderer:t}=e;if(!1===t.shadowMap.enabled)return;let r=this.shadowColorNode;if(null===r){const e=this.light.shadow.shadowNode;let t;t=void 0!==e?Gi(e):this.setupShadowNode(),this.shadowNode=t,this.shadowColorNode=r=this.colorNode.mul(t),this.baseColorNode=this.colorNode}this.colorNode=r}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):null!==this.shadowNode&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),r=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),r&&e.lightsNode.setupDirectRectAreaLight(e,this,r)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const i_=Ki(({lightDistance:e,cutoffDistance:t,decayExponent:r})=>{const s=e.pow(r).max(.01).reciprocal();return t.greaterThan(0).select(s.mul(e.div(t).pow4().oneMinus().clamp().pow2()),s)}),n_=({color:e,lightVector:t,cutoffDistance:r,decayExponent:s})=>{const i=t.normalize(),n=t.length(),a=i_({lightDistance:n,cutoffDistance:r,decayExponent:s});return{lightDirection:i,lightColor:e.mul(a)}};class a_ extends s_{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=oa(0).setGroup(ia),this.decayExponentNode=oa(2).setGroup(ia)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return r_(this.light)}setupDirect(e){return n_({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const o_=Ki(([e=sl()])=>{const t=e.mul(2),r=t.x.floor(),s=t.y.floor();return r.add(s).mod(2).sign()}),u_=Ki(([e=sl()],{renderer:t,material:r})=>{const s=$o(e.mul(2).sub(1));let i;if(r.alphaToCoverage&&t.samples>1){const e=tn(s.fwidth()).toVar();i=Xo(e.oneMinus(),e.add(1),s).oneMinus()}else i=iu(s.greaterThan(1),0,1);return i}),l_=Ki(([e,t,r])=>{const s=tn(r).toVar(),i=tn(t).toVar(),n=nn(e).toVar();return iu(n,i,s)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),d_=Ki(([e,t])=>{const r=nn(t).toVar(),s=tn(e).toVar();return iu(r,s.negate(),s)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),c_=Ki(([e])=>{const t=tn(e).toVar();return rn(so(t))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),h_=Ki(([e,t])=>{const r=tn(e).toVar();return t.assign(c_(r)),r.sub(tn(t))}),p_=Ay([Ki(([e,t,r,s,i,n])=>{const a=tn(n).toVar(),o=tn(i).toVar(),u=tn(s).toVar(),l=tn(r).toVar(),d=tn(t).toVar(),c=tn(e).toVar(),h=tn(ya(1,o)).toVar();return ya(1,a).mul(c.mul(h).add(d.mul(o))).add(a.mul(l.mul(h).add(u.mul(o))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),Ki(([e,t,r,s,i,n])=>{const a=tn(n).toVar(),o=tn(i).toVar(),u=dn(s).toVar(),l=dn(r).toVar(),d=dn(t).toVar(),c=dn(e).toVar(),h=tn(ya(1,o)).toVar();return ya(1,a).mul(c.mul(h).add(d.mul(o))).add(a.mul(l.mul(h).add(u.mul(o))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]})]),g_=Ay([Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=tn(d).toVar(),h=tn(l).toVar(),p=tn(u).toVar(),g=tn(o).toVar(),m=tn(a).toVar(),f=tn(n).toVar(),y=tn(i).toVar(),b=tn(s).toVar(),x=tn(r).toVar(),T=tn(t).toVar(),_=tn(e).toVar(),v=tn(ya(1,p)).toVar(),N=tn(ya(1,h)).toVar();return tn(ya(1,c)).toVar().mul(N.mul(_.mul(v).add(T.mul(p))).add(h.mul(x.mul(v).add(b.mul(p))))).add(c.mul(N.mul(y.mul(v).add(f.mul(p))).add(h.mul(m.mul(v).add(g.mul(p))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=tn(d).toVar(),h=tn(l).toVar(),p=tn(u).toVar(),g=dn(o).toVar(),m=dn(a).toVar(),f=dn(n).toVar(),y=dn(i).toVar(),b=dn(s).toVar(),x=dn(r).toVar(),T=dn(t).toVar(),_=dn(e).toVar(),v=tn(ya(1,p)).toVar(),N=tn(ya(1,h)).toVar();return tn(ya(1,c)).toVar().mul(N.mul(_.mul(v).add(T.mul(p))).add(h.mul(x.mul(v).add(b.mul(p))))).add(c.mul(N.mul(y.mul(v).add(f.mul(p))).add(h.mul(m.mul(v).add(g.mul(p))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]})]),m_=Ki(([e,t,r])=>{const s=tn(r).toVar(),i=tn(t).toVar(),n=sn(e).toVar(),a=sn(n.bitAnd(sn(7))).toVar(),o=tn(l_(a.lessThan(sn(4)),i,s)).toVar(),u=tn(ba(2,l_(a.lessThan(sn(4)),s,i))).toVar();return d_(o,nn(a.bitAnd(sn(1)))).add(d_(u,nn(a.bitAnd(sn(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),f_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=tn(t).toVar(),o=sn(e).toVar(),u=sn(o.bitAnd(sn(15))).toVar(),l=tn(l_(u.lessThan(sn(8)),a,n)).toVar(),d=tn(l_(u.lessThan(sn(4)),n,l_(u.equal(sn(12)).or(u.equal(sn(14))),a,i))).toVar();return d_(l,nn(u.bitAnd(sn(1)))).add(d_(d,nn(u.bitAnd(sn(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),y_=Ay([m_,f_]),b_=Ki(([e,t,r])=>{const s=tn(r).toVar(),i=tn(t).toVar(),n=hn(e).toVar();return dn(y_(n.x,i,s),y_(n.y,i,s),y_(n.z,i,s))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),x_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=tn(t).toVar(),o=hn(e).toVar();return dn(y_(o.x,a,n,i),y_(o.y,a,n,i),y_(o.z,a,n,i))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),T_=Ay([b_,x_]),__=Ki(([e])=>{const t=tn(e).toVar();return ba(.6616,t)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),v_=Ki(([e])=>{const t=tn(e).toVar();return ba(.982,t)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),N_=Ay([__,Ki(([e])=>{const t=dn(e).toVar();return ba(.6616,t)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]})]),S_=Ay([v_,Ki(([e])=>{const t=dn(e).toVar();return ba(.982,t)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]})]),E_=Ki(([e,t])=>{const r=rn(t).toVar(),s=sn(e).toVar();return s.shiftLeft(r).bitOr(s.shiftRight(rn(32).sub(r)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),R_=Ki(([e,t,r])=>{e.subAssign(r),e.bitXorAssign(E_(r,rn(4))),r.addAssign(t),t.subAssign(e),t.bitXorAssign(E_(e,rn(6))),e.addAssign(r),r.subAssign(t),r.bitXorAssign(E_(t,rn(8))),t.addAssign(e),e.subAssign(r),e.bitXorAssign(E_(r,rn(16))),r.addAssign(t),t.subAssign(e),t.bitXorAssign(E_(e,rn(19))),e.addAssign(r),r.subAssign(t),r.bitXorAssign(E_(t,rn(4))),t.addAssign(e)}),A_=Ki(([e,t,r])=>{const s=sn(r).toVar(),i=sn(t).toVar(),n=sn(e).toVar();return s.bitXorAssign(i),s.subAssign(E_(i,rn(14))),n.bitXorAssign(s),n.subAssign(E_(s,rn(11))),i.bitXorAssign(n),i.subAssign(E_(n,rn(25))),s.bitXorAssign(i),s.subAssign(E_(i,rn(16))),n.bitXorAssign(s),n.subAssign(E_(s,rn(4))),i.bitXorAssign(n),i.subAssign(E_(n,rn(14))),s.bitXorAssign(i),s.subAssign(E_(i,rn(24))),s}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),w_=Ki(([e])=>{const t=sn(e).toVar();return tn(t).div(tn(sn(rn(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),C_=Ki(([e])=>{const t=tn(e).toVar();return t.mul(t).mul(t).mul(t.mul(t.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),M_=Ay([Ki(([e])=>{const t=rn(e).toVar(),r=sn(sn(1)).toVar(),s=sn(sn(rn(3735928559)).add(r.shiftLeft(sn(2))).add(sn(13))).toVar();return A_(s.add(sn(t)),s,s)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),Ki(([e,t])=>{const r=rn(t).toVar(),s=rn(e).toVar(),i=sn(sn(2)).toVar(),n=sn().toVar(),a=sn().toVar(),o=sn().toVar();return n.assign(a.assign(o.assign(sn(rn(3735928559)).add(i.shiftLeft(sn(2))).add(sn(13))))),n.addAssign(sn(s)),a.addAssign(sn(r)),A_(n,a,o)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Ki(([e,t,r])=>{const s=rn(r).toVar(),i=rn(t).toVar(),n=rn(e).toVar(),a=sn(sn(3)).toVar(),o=sn().toVar(),u=sn().toVar(),l=sn().toVar();return o.assign(u.assign(l.assign(sn(rn(3735928559)).add(a.shiftLeft(sn(2))).add(sn(13))))),o.addAssign(sn(n)),u.addAssign(sn(i)),l.addAssign(sn(s)),A_(o,u,l)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),Ki(([e,t,r,s])=>{const i=rn(s).toVar(),n=rn(r).toVar(),a=rn(t).toVar(),o=rn(e).toVar(),u=sn(sn(4)).toVar(),l=sn().toVar(),d=sn().toVar(),c=sn().toVar();return l.assign(d.assign(c.assign(sn(rn(3735928559)).add(u.shiftLeft(sn(2))).add(sn(13))))),l.addAssign(sn(o)),d.addAssign(sn(a)),c.addAssign(sn(n)),R_(l,d,c),l.addAssign(sn(i)),A_(l,d,c)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),Ki(([e,t,r,s,i])=>{const n=rn(i).toVar(),a=rn(s).toVar(),o=rn(r).toVar(),u=rn(t).toVar(),l=rn(e).toVar(),d=sn(sn(5)).toVar(),c=sn().toVar(),h=sn().toVar(),p=sn().toVar();return c.assign(h.assign(p.assign(sn(rn(3735928559)).add(d.shiftLeft(sn(2))).add(sn(13))))),c.addAssign(sn(l)),h.addAssign(sn(u)),p.addAssign(sn(o)),R_(c,h,p),c.addAssign(sn(a)),h.addAssign(sn(n)),A_(c,h,p)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]})]),P_=Ay([Ki(([e,t])=>{const r=rn(t).toVar(),s=rn(e).toVar(),i=sn(M_(s,r)).toVar(),n=hn().toVar();return n.x.assign(i.bitAnd(rn(255))),n.y.assign(i.shiftRight(rn(8)).bitAnd(rn(255))),n.z.assign(i.shiftRight(rn(16)).bitAnd(rn(255))),n}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Ki(([e,t,r])=>{const s=rn(r).toVar(),i=rn(t).toVar(),n=rn(e).toVar(),a=sn(M_(n,i,s)).toVar(),o=hn().toVar();return o.x.assign(a.bitAnd(rn(255))),o.y.assign(a.shiftRight(rn(8)).bitAnd(rn(255))),o.z.assign(a.shiftRight(rn(16)).bitAnd(rn(255))),o}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]})]),B_=Ay([Ki(([e])=>{const t=an(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=tn(h_(t.x,r)).toVar(),n=tn(h_(t.y,s)).toVar(),a=tn(C_(i)).toVar(),o=tn(C_(n)).toVar(),u=tn(p_(y_(M_(r,s),i,n),y_(M_(r.add(rn(1)),s),i.sub(1),n),y_(M_(r,s.add(rn(1))),i,n.sub(1)),y_(M_(r.add(rn(1)),s.add(rn(1))),i.sub(1),n.sub(1)),a,o)).toVar();return N_(u)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=rn().toVar(),n=tn(h_(t.x,r)).toVar(),a=tn(h_(t.y,s)).toVar(),o=tn(h_(t.z,i)).toVar(),u=tn(C_(n)).toVar(),l=tn(C_(a)).toVar(),d=tn(C_(o)).toVar(),c=tn(g_(y_(M_(r,s,i),n,a,o),y_(M_(r.add(rn(1)),s,i),n.sub(1),a,o),y_(M_(r,s.add(rn(1)),i),n,a.sub(1),o),y_(M_(r.add(rn(1)),s.add(rn(1)),i),n.sub(1),a.sub(1),o),y_(M_(r,s,i.add(rn(1))),n,a,o.sub(1)),y_(M_(r.add(rn(1)),s,i.add(rn(1))),n.sub(1),a,o.sub(1)),y_(M_(r,s.add(rn(1)),i.add(rn(1))),n,a.sub(1),o.sub(1)),y_(M_(r.add(rn(1)),s.add(rn(1)),i.add(rn(1))),n.sub(1),a.sub(1),o.sub(1)),u,l,d)).toVar();return S_(c)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]})]),L_=Ay([Ki(([e])=>{const t=an(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=tn(h_(t.x,r)).toVar(),n=tn(h_(t.y,s)).toVar(),a=tn(C_(i)).toVar(),o=tn(C_(n)).toVar(),u=dn(p_(T_(P_(r,s),i,n),T_(P_(r.add(rn(1)),s),i.sub(1),n),T_(P_(r,s.add(rn(1))),i,n.sub(1)),T_(P_(r.add(rn(1)),s.add(rn(1))),i.sub(1),n.sub(1)),a,o)).toVar();return N_(u)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=rn().toVar(),n=tn(h_(t.x,r)).toVar(),a=tn(h_(t.y,s)).toVar(),o=tn(h_(t.z,i)).toVar(),u=tn(C_(n)).toVar(),l=tn(C_(a)).toVar(),d=tn(C_(o)).toVar(),c=dn(g_(T_(P_(r,s,i),n,a,o),T_(P_(r.add(rn(1)),s,i),n.sub(1),a,o),T_(P_(r,s.add(rn(1)),i),n,a.sub(1),o),T_(P_(r.add(rn(1)),s.add(rn(1)),i),n.sub(1),a.sub(1),o),T_(P_(r,s,i.add(rn(1))),n,a,o.sub(1)),T_(P_(r.add(rn(1)),s,i.add(rn(1))),n.sub(1),a,o.sub(1)),T_(P_(r,s.add(rn(1)),i.add(rn(1))),n,a.sub(1),o.sub(1)),T_(P_(r.add(rn(1)),s.add(rn(1)),i.add(rn(1))),n.sub(1),a.sub(1),o.sub(1)),u,l,d)).toVar();return S_(c)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]})]),F_=Ay([Ki(([e])=>{const t=tn(e).toVar(),r=rn(c_(t)).toVar();return w_(M_(r))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),Ki(([e])=>{const t=an(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar();return w_(M_(r,s))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar();return w_(M_(r,s,i))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),Ki(([e])=>{const t=gn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar(),n=rn(c_(t.w)).toVar();return w_(M_(r,s,i,n))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]})]),I_=Ay([Ki(([e])=>{const t=tn(e).toVar(),r=rn(c_(t)).toVar();return dn(w_(M_(r,rn(0))),w_(M_(r,rn(1))),w_(M_(r,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),Ki(([e])=>{const t=an(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar();return dn(w_(M_(r,s,rn(0))),w_(M_(r,s,rn(1))),w_(M_(r,s,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar();return dn(w_(M_(r,s,i,rn(0))),w_(M_(r,s,i,rn(1))),w_(M_(r,s,i,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Ki(([e])=>{const t=gn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar(),n=rn(c_(t.w)).toVar();return dn(w_(M_(r,s,i,n,rn(0))),w_(M_(r,s,i,n,rn(1))),w_(M_(r,s,i,n,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]})]),D_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar(),u=tn(0).toVar(),l=tn(1).toVar();return Uh(a,()=>{u.addAssign(l.mul(B_(o))),l.mulAssign(i),o.mulAssign(n)}),u}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),U_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar(),u=dn(0).toVar(),l=tn(1).toVar();return Uh(a,()=>{u.addAssign(l.mul(L_(o))),l.mulAssign(i),o.mulAssign(n)}),u}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),V_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar();return an(D_(o,a,n,i),D_(o.add(dn(rn(19),rn(193),rn(17))),a,n,i))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),O_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar(),u=dn(U_(o,a,n,i)).toVar(),l=tn(D_(o.add(dn(rn(19),rn(193),rn(17))),a,n,i)).toVar();return gn(u,l)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),G_=Ay([Ki(([e,t,r,s,i,n,a])=>{const o=rn(a).toVar(),u=tn(n).toVar(),l=rn(i).toVar(),d=rn(s).toVar(),c=rn(r).toVar(),h=rn(t).toVar(),p=an(e).toVar(),g=dn(I_(an(h.add(d),c.add(l)))).toVar(),m=an(g.x,g.y).toVar();m.subAssign(.5),m.mulAssign(u),m.addAssign(.5);const f=an(an(tn(h),tn(c)).add(m)).toVar(),y=an(f.sub(p)).toVar();return Zi(o.equal(rn(2)),()=>go(y.x).add(go(y.y))),Zi(o.equal(rn(3)),()=>Mo(go(y.x),go(y.y))),Io(y,y)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Ki(([e,t,r,s,i,n,a,o,u])=>{const l=rn(u).toVar(),d=tn(o).toVar(),c=rn(a).toVar(),h=rn(n).toVar(),p=rn(i).toVar(),g=rn(s).toVar(),m=rn(r).toVar(),f=rn(t).toVar(),y=dn(e).toVar(),b=dn(I_(dn(f.add(p),m.add(h),g.add(c)))).toVar();b.subAssign(.5),b.mulAssign(d),b.addAssign(.5);const x=dn(dn(tn(f),tn(m),tn(g)).add(b)).toVar(),T=dn(x.sub(y)).toVar();return Zi(l.equal(rn(2)),()=>go(T.x).add(go(T.y)).add(go(T.z))),Zi(l.equal(rn(3)),()=>Mo(go(T.x),go(T.y),go(T.z))),Io(T,T)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),k_=Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=an(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=an(h_(n.x,a),h_(n.y,o)).toVar(),l=tn(1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{const r=tn(G_(u,e,t,a,o,i,s)).toVar();l.assign(Co(l,r))})}),Zi(s.equal(rn(0)),()=>{l.assign(to(l))}),l}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),z_=Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=an(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=an(h_(n.x,a),h_(n.y,o)).toVar(),l=an(1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{const r=tn(G_(u,e,t,a,o,i,s)).toVar();Zi(r.lessThan(l.x),()=>{l.y.assign(l.x),l.x.assign(r)}).ElseIf(r.lessThan(l.y),()=>{l.y.assign(r)})})}),Zi(s.equal(rn(0)),()=>{l.assign(to(l))}),l}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),$_=Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=an(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=an(h_(n.x,a),h_(n.y,o)).toVar(),l=dn(1e6,1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{const r=tn(G_(u,e,t,a,o,i,s)).toVar();Zi(r.lessThan(l.x),()=>{l.z.assign(l.y),l.y.assign(l.x),l.x.assign(r)}).ElseIf(r.lessThan(l.y),()=>{l.z.assign(l.y),l.y.assign(r)}).ElseIf(r.lessThan(l.z),()=>{l.z.assign(r)})})}),Zi(s.equal(rn(0)),()=>{l.assign(to(l))}),l}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),H_=Ay([k_,Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=dn(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=rn().toVar(),l=dn(h_(n.x,a),h_(n.y,o),h_(n.z,u)).toVar(),d=tn(1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{Uh({start:-1,end:rn(1),name:"z",condition:"<="},({z:r})=>{const n=tn(G_(l,e,t,r,a,o,u,i,s)).toVar();d.assign(Co(d,n))})})}),Zi(s.equal(rn(0)),()=>{d.assign(to(d))}),d}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),W_=Ay([z_,Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=dn(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=rn().toVar(),l=dn(h_(n.x,a),h_(n.y,o),h_(n.z,u)).toVar(),d=an(1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{Uh({start:-1,end:rn(1),name:"z",condition:"<="},({z:r})=>{const n=tn(G_(l,e,t,r,a,o,u,i,s)).toVar();Zi(n.lessThan(d.x),()=>{d.y.assign(d.x),d.x.assign(n)}).ElseIf(n.lessThan(d.y),()=>{d.y.assign(n)})})})}),Zi(s.equal(rn(0)),()=>{d.assign(to(d))}),d}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),q_=Ay([$_,Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=dn(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=rn().toVar(),l=dn(h_(n.x,a),h_(n.y,o),h_(n.z,u)).toVar(),d=dn(1e6,1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{Uh({start:-1,end:rn(1),name:"z",condition:"<="},({z:r})=>{const n=tn(G_(l,e,t,r,a,o,u,i,s)).toVar();Zi(n.lessThan(d.x),()=>{d.z.assign(d.y),d.y.assign(d.x),d.x.assign(n)}).ElseIf(n.lessThan(d.y),()=>{d.z.assign(d.y),d.y.assign(n)}).ElseIf(n.lessThan(d.z),()=>{d.z.assign(n)})})})}),Zi(s.equal(rn(0)),()=>{d.assign(to(d))}),d}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),j_=Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=rn(e).toVar(),h=an(t).toVar(),p=an(r).toVar(),g=an(s).toVar(),m=tn(i).toVar(),f=tn(n).toVar(),y=tn(a).toVar(),b=nn(o).toVar(),x=rn(u).toVar(),T=tn(l).toVar(),_=tn(d).toVar(),v=h.mul(p).add(g),N=tn(0).toVar();return Zi(c.equal(rn(0)),()=>{N.assign(L_(v))}),Zi(c.equal(rn(1)),()=>{N.assign(I_(v))}),Zi(c.equal(rn(2)),()=>{N.assign(q_(v,m,rn(0)))}),Zi(c.equal(rn(3)),()=>{N.assign(U_(dn(v,0),x,T,_))}),N.assign(N.mul(y.sub(f)).add(f)),Zi(b,()=>{N.assign(Wo(N,f,y))}),N}).setLayout({name:"mx_unifiednoise2d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"texcoord",type:"vec2"},{name:"freq",type:"vec2"},{name:"offset",type:"vec2"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),X_=Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=rn(e).toVar(),h=dn(t).toVar(),p=dn(r).toVar(),g=dn(s).toVar(),m=tn(i).toVar(),f=tn(n).toVar(),y=tn(a).toVar(),b=nn(o).toVar(),x=rn(u).toVar(),T=tn(l).toVar(),_=tn(d).toVar(),v=h.mul(p).add(g),N=tn(0).toVar();return Zi(c.equal(rn(0)),()=>{N.assign(L_(v))}),Zi(c.equal(rn(1)),()=>{N.assign(I_(v))}),Zi(c.equal(rn(2)),()=>{N.assign(q_(v,m,rn(0)))}),Zi(c.equal(rn(3)),()=>{N.assign(U_(v,x,T,_))}),N.assign(N.mul(y.sub(f)).add(f)),Zi(b,()=>{N.assign(Wo(N,f,y))}),N}).setLayout({name:"mx_unifiednoise3d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"position",type:"vec3"},{name:"freq",type:"vec3"},{name:"offset",type:"vec3"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),K_=Ki(([e])=>{const t=e.y,r=e.z,s=dn().toVar();return Zi(t.lessThan(1e-4),()=>{s.assign(dn(r,r,r))}).Else(()=>{let i=e.x;i=i.sub(so(i)).mul(6).toVar();const n=rn(No(i)),a=i.sub(tn(n)),o=r.mul(t.oneMinus()),u=r.mul(t.mul(a).oneMinus()),l=r.mul(t.mul(a.oneMinus()).oneMinus());Zi(n.equal(rn(0)),()=>{s.assign(dn(r,l,o))}).ElseIf(n.equal(rn(1)),()=>{s.assign(dn(u,r,o))}).ElseIf(n.equal(rn(2)),()=>{s.assign(dn(o,r,l))}).ElseIf(n.equal(rn(3)),()=>{s.assign(dn(o,u,r))}).ElseIf(n.equal(rn(4)),()=>{s.assign(dn(l,o,r))}).Else(()=>{s.assign(dn(r,o,u))})}),s}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),Y_=Ki(([e])=>{const t=dn(e).toVar(),r=tn(t.x).toVar(),s=tn(t.y).toVar(),i=tn(t.z).toVar(),n=tn(Co(r,Co(s,i))).toVar(),a=tn(Mo(r,Mo(s,i))).toVar(),o=tn(a.sub(n)).toVar(),u=tn().toVar(),l=tn().toVar(),d=tn().toVar();return d.assign(a),Zi(a.greaterThan(0),()=>{l.assign(o.div(a))}).Else(()=>{l.assign(0)}),Zi(l.lessThanEqual(0),()=>{u.assign(0)}).Else(()=>{Zi(r.greaterThanEqual(a),()=>{u.assign(s.sub(i).div(o))}).ElseIf(s.greaterThanEqual(a),()=>{u.assign(fa(2,i.sub(r).div(o)))}).Else(()=>{u.assign(fa(4,r.sub(s).div(o)))}),u.mulAssign(1/6),Zi(u.lessThan(0),()=>{u.addAssign(1)})}),dn(u,l,d)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),Q_=Ki(([e])=>{const t=dn(e).toVar(),r=pn(Sa(t,dn(.04045))).toVar(),s=dn(t.div(12.92)).toVar(),i=dn(Uo(Mo(t.add(dn(.055)),dn(0)).div(1.055),dn(2.4))).toVar();return Ho(s,i,r)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Z_=(e,t)=>{e=tn(e),t=tn(t);const r=an(t.dFdx(),t.dFdy()).length().mul(.7071067811865476);return Xo(e.sub(r),e.add(r),t)},J_=(e,t,r,s)=>Ho(e,t,r[s].clamp()),ev=(e,t,r,s,i)=>Ho(e,t,Z_(r,s[i])),tv=Ki(([e,t,r])=>{const s=no(e).toVar(),i=ya(tn(.5).mul(t.sub(r)),cd).div(s).toVar(),n=ya(tn(-.5).mul(t.sub(r)),cd).div(s).toVar(),a=dn().toVar();a.x=s.x.greaterThan(tn(0)).select(i.x,n.x),a.y=s.y.greaterThan(tn(0)).select(i.y,n.y),a.z=s.z.greaterThan(tn(0)).select(i.z,n.z);const o=Co(a.x,a.y,a.z).toVar();return cd.add(s.mul(o)).toVar().sub(r)}),rv=Ki(([e,t])=>{const r=e.x,s=e.y,i=e.z;let n=t.element(0).mul(.886227);return n=n.add(t.element(1).mul(1.023328).mul(s)),n=n.add(t.element(2).mul(1.023328).mul(i)),n=n.add(t.element(3).mul(1.023328).mul(r)),n=n.add(t.element(4).mul(.858086).mul(r).mul(s)),n=n.add(t.element(5).mul(.858086).mul(s).mul(i)),n=n.add(t.element(6).mul(i.mul(i).mul(.743125).sub(.247708))),n=n.add(t.element(7).mul(.858086).mul(r).mul(i)),n=n.add(t.element(8).mul(.429043).mul(ba(r,r).sub(ba(s,s)))),n});var sv=Object.freeze({__proto__:null,BRDF_GGX:hg,BRDF_Lambert:Qp,BasicPointShadowFilter:KT,BasicShadowFilter:PT,Break:Vh,Const:pu,Continue:()=>Ku("continue").toStack(),DFGApprox:pg,D_GGX:lg,Discard:Yu,EPSILON:$a,F_Schlick:Yp,Fn:Ki,INFINITY:Ha,If:Zi,Loop:Uh,NodeAccess:$s,NodeShaderStage:Gs,NodeType:zs,NodeUpdateType:ks,OnMaterialUpdate:e=>hb(cb.MATERIAL,e),OnObjectUpdate:e=>hb(cb.OBJECT,e),PCFShadowFilter:BT,PCFSoftShadowFilter:LT,PI:Wa,PI2:qa,PointShadowFilter:YT,Return:()=>Ku("return").toStack(),Schlick_to_F0:mg,ScriptableNodeResources:cx,ShaderNode:Oi,Stack:Ji,Switch:(...e)=>li.Switch(...e),TBNViewMatrix:Tc,VSMShadowFilter:FT,V_GGX_SmithCorrelated:og,Var:hu,VarIntent:gu,abs:go,acesFilmicToneMapping:Qb,acos:ho,add:fa,addMethodChaining:ci,addNodeElement:function(e){console.warn("THREE.TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",e)},agxToneMapping:tx,all:ja,alphaT:Un,and:Aa,anisotropy:Vn,anisotropyB:Gn,anisotropyT:On,any:Xa,append:e=>(console.warn("THREE.TSL: append() has been renamed to Stack()."),Ji(e)),array:la,arrayBuffer:e=>Gi(new oi(e,"ArrayBuffer")),asin:co,assign:ca,atan:po,atan2:eu,atomicAdd:(e,t)=>Fx(Bx.ATOMIC_ADD,e,t),atomicAnd:(e,t)=>Fx(Bx.ATOMIC_AND,e,t),atomicFunc:Fx,atomicLoad:e=>Fx(Bx.ATOMIC_LOAD,e,null),atomicMax:(e,t)=>Fx(Bx.ATOMIC_MAX,e,t),atomicMin:(e,t)=>Fx(Bx.ATOMIC_MIN,e,t),atomicOr:(e,t)=>Fx(Bx.ATOMIC_OR,e,t),atomicStore:(e,t)=>Fx(Bx.ATOMIC_STORE,e,t),atomicSub:(e,t)=>Fx(Bx.ATOMIC_SUB,e,t),atomicXor:(e,t)=>Fx(Bx.ATOMIC_XOR,e,t),attenuationColor:Zn,attenuationDistance:Qn,attribute:rl,attributeArray:(e,t="float")=>{let r,s;!0===t.isStruct?(r=t.layout.getLength(),s=Ms("float")):(r=Ps(t),s=Ms(t));const i=new gb(e,r,s);return Bh(i,t,e)},backgroundBlurriness:Tb,backgroundIntensity:_b,backgroundRotation:vb,batch:wh,bentNormalView:vc,billboarding:Ly,bitAnd:Pa,bitNot:Ba,bitOr:La,bitXor:Fa,bitangentGeometry:fc,bitangentLocal:yc,bitangentView:bc,bitangentWorld:xc,bitcast:xy,blendBurn:yp,blendColor:_p,blendDodge:bp,blendOverlay:Tp,blendScreen:xp,blur:mm,bool:nn,buffer:gl,bufferAttribute:Fu,builtin:bl,bumpMap:wc,burn:(...e)=>(console.warn('THREE.TSL: "burn" has been renamed. Use "blendBurn" instead.'),yp(e)),bvec2:ln,bvec3:pn,bvec4:yn,bypass:Hu,cache:zu,call:pa,cameraFar:Ll,cameraIndex:Pl,cameraNear:Bl,cameraNormalMatrix:Vl,cameraPosition:Ol,cameraProjectionMatrix:Fl,cameraProjectionMatrixInverse:Il,cameraViewMatrix:Dl,cameraViewport:Gl,cameraWorldMatrix:Ul,cbrt:zo,cdl:Ob,ceil:io,checker:o_,cineonToneMapping:Kb,clamp:Wo,clearcoat:Mn,clearcoatNormalView:Rd,clearcoatRoughness:Pn,code:ix,color:en,colorSpaceToWorking:Eu,colorToDirection:e=>Gi(e).mul(2).sub(1),compute:Gu,computeKernel:Ou,computeSkinning:(e,t=null)=>{const r=new Fh(e);return r.positionNode=Bh(new L(e.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(bh).toVar(),r.skinIndexNode=Bh(new L(new Uint32Array(e.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(bh).toVar(),r.skinWeightNode=Bh(new L(e.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(bh).toVar(),r.bindMatrixNode=oa(e.bindMatrix,"mat4"),r.bindMatrixInverseNode=oa(e.bindMatrixInverse,"mat4"),r.boneMatricesNode=gl(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length),r.toPositionNode=t,Gi(r)},context:au,convert:vn,convertColorSpace:(e,t,r)=>Gi(new Nu(Gi(e),t,r)),convertToTexture:(e,...t)=>e.isSampleNode||e.isTextureNode?e:e.isPassNode?e.getTextureNode():ab(e,...t),cos:uo,cross:Do,cubeTexture:Hd,cubeTextureBase:$d,cubeToUV:XT,dFdx:xo,dFdy:To,dashSize:Wn,debug:el,decrement:Ga,decrementBefore:Va,defaultBuildStages:Ws,defaultShaderStages:Hs,defined:Ui,degrees:Ya,deltaTime:Cy,densityFog:function(e,t){return console.warn('THREE.TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),yx(e,fx(t))},densityFogFactor:fx,depth:up,depthPass:(e,t,r)=>Gi(new Wb(Wb.DEPTH,e,t,r)),determinant:Ro,difference:Fo,diffuseColor:Rn,directPointLight:n_,directionToColor:Fp,directionToFaceDirection:bd,dispersion:Jn,distance:Lo,div:xa,dodge:(...e)=>(console.warn('THREE.TSL: "dodge" has been renamed. Use "blendDodge" instead.'),bp(e)),dot:Io,drawIndex:vh,dynamicBufferAttribute:Iu,element:_n,emissive:An,equal:_a,equals:wo,equirectUV:Up,exp:Qa,exp2:Za,expression:Ku,faceDirection:yd,faceForward:Ko,faceforward:tu,float:tn,floatBitsToInt:e=>new by(e,"int","float"),floatBitsToUint:e=>new by(e,"uint","float"),floor:so,fog:yx,fract:ao,frameGroup:sa,frameId:My,frontFacing:fd,fwidth:So,gain:(e,t)=>e.lessThan(.5)?_y(e.mul(2),t).div(2):ya(1,_y(ba(ya(1,e),2),t).div(2)),gapSize:qn,getConstNodeType:Vi,getCurrentStack:Qi,getDirection:cm,getDistanceAttenuation:i_,getGeometryRoughness:ng,getNormalFromDepth:lb,getParallaxCorrectNormal:tv,getRoughness:ag,getScreenPosition:ub,getShIrradianceAt:rv,getShadowMaterial:DT,getShadowRenderObjectFunction:OT,getTextureIndex:my,getViewPosition:ob,globalId:Rx,glsl:(e,t)=>ix(e,t,"glsl"),glslFn:(e,t)=>ax(e,t,"glsl"),grayscale:Fb,greaterThan:Sa,greaterThanEqual:Ra,hash:Ty,highpModelNormalViewMatrix:od,highpModelViewMatrix:ad,hue:Ub,increment:Oa,incrementBefore:Ua,instance:Sh,instanceIndex:bh,instancedArray:(e,t="float")=>{let r,s;!0===t.isStruct?(r=t.layout.getLength(),s=Ms("float")):(r=Ps(t),s=Ms(t));const i=new pb(e,r,s);return Bh(i,t,e)},instancedBufferAttribute:Du,instancedDynamicBufferAttribute:Uu,instancedMesh:Rh,int:rn,intBitsToFloat:e=>new by(e,"float","int"),inverse:Ao,inverseSqrt:ro,inversesqrt:ru,invocationLocalIndex:_h,invocationSubgroupIndex:Th,ior:Xn,iridescence:Fn,iridescenceIOR:In,iridescenceThickness:Dn,ivec2:on,ivec3:cn,ivec4:mn,js:(e,t)=>ix(e,t,"js"),label:lu,length:fo,lengthSq:$o,lessThan:Na,lessThanEqual:Ea,lightPosition:cT,lightProjectionUV:dT,lightShadowMatrix:lT,lightTargetDirection:gT,lightTargetPosition:hT,lightViewPosition:pT,lightingContext:jh,lights:(e=[])=>Gi(new bT).setLights(e),linearDepth:lp,linearToneMapping:jb,localId:Ax,log:Ja,log2:eo,logarithmicDepthToViewZ:(e,t,r)=>{const s=e.mul(Ja(r.div(t)));return tn(Math.E).pow(s).mul(t).negate()},luminance:Vb,mat2:bn,mat3:xn,mat4:Tn,matcapUV:rf,materialAO:ph,materialAlphaTest:Pc,materialAnisotropy:Yc,materialAnisotropyVector:gh,materialAttenuationColor:ih,materialAttenuationDistance:sh,materialClearcoat:Hc,materialClearcoatNormal:qc,materialClearcoatRoughness:Wc,materialColor:Bc,materialDispersion:ch,materialEmissive:Fc,materialEnvIntensity:Id,materialEnvRotation:Dd,materialIOR:rh,materialIridescence:Qc,materialIridescenceIOR:Zc,materialIridescenceThickness:Jc,materialLightMap:hh,materialLineDashOffset:lh,materialLineDashSize:ah,materialLineGapSize:oh,materialLineScale:nh,materialLineWidth:uh,materialMetalness:zc,materialNormal:$c,materialOpacity:Ic,materialPointSize:dh,materialReference:Yd,materialReflectivity:Gc,materialRefractionRatio:Fd,materialRotation:jc,materialRoughness:kc,materialSheen:Xc,materialSheenRoughness:Kc,materialShininess:Lc,materialSpecular:Dc,materialSpecularColor:Vc,materialSpecularIntensity:Uc,materialSpecularStrength:Oc,materialThickness:th,materialTransmission:eh,max:Mo,maxMipLevel:ol,mediumpModelViewMatrix:nd,metalness:Cn,min:Co,mix:Ho,mixElement:Qo,mod:Ta,modInt:ka,modelDirection:Yl,modelNormalMatrix:rd,modelPosition:Zl,modelRadius:td,modelScale:Jl,modelViewMatrix:id,modelViewPosition:ed,modelViewProjection:mh,modelWorldMatrix:Ql,modelWorldMatrixInverse:sd,morphReference:$h,mrt:yy,mul:ba,mx_aastep:Z_,mx_add:(e,t=tn(0))=>fa(e,t),mx_atan2:(e=tn(0),t=tn(1))=>po(e,t),mx_cell_noise_float:(e=sl())=>F_(e.convert("vec2|vec3")),mx_contrast:(e,t=1,r=.5)=>tn(e).sub(r).mul(t).add(r),mx_divide:(e,t=tn(1))=>xa(e,t),mx_fractal_noise_float:(e=sl(),t=3,r=2,s=.5,i=1)=>D_(e,rn(t),r,s).mul(i),mx_fractal_noise_vec2:(e=sl(),t=3,r=2,s=.5,i=1)=>V_(e,rn(t),r,s).mul(i),mx_fractal_noise_vec3:(e=sl(),t=3,r=2,s=.5,i=1)=>U_(e,rn(t),r,s).mul(i),mx_fractal_noise_vec4:(e=sl(),t=3,r=2,s=.5,i=1)=>O_(e,rn(t),r,s).mul(i),mx_frame:()=>My,mx_heighttonormal:(e,t)=>(e=dn(e),t=tn(t),wc(e,t)),mx_hsvtorgb:K_,mx_ifequal:(e,t,r,s)=>e.equal(t).mix(r,s),mx_ifgreater:(e,t,r,s)=>e.greaterThan(t).mix(r,s),mx_ifgreatereq:(e,t,r,s)=>e.greaterThanEqual(t).mix(r,s),mx_invert:(e,t=tn(1))=>ya(t,e),mx_modulo:(e,t=tn(1))=>Ta(e,t),mx_multiply:(e,t=tn(1))=>ba(e,t),mx_noise_float:(e=sl(),t=1,r=0)=>B_(e.convert("vec2|vec3")).mul(t).add(r),mx_noise_vec3:(e=sl(),t=1,r=0)=>L_(e.convert("vec2|vec3")).mul(t).add(r),mx_noise_vec4:(e=sl(),t=1,r=0)=>{e=e.convert("vec2|vec3");return gn(L_(e),B_(e.add(an(19,73)))).mul(t).add(r)},mx_place2d:(e,t=an(.5,.5),r=an(1,1),s=tn(0),i=an(0,0))=>{let n=e;if(t&&(n=n.sub(t)),r&&(n=n.mul(r)),s){const e=s.mul(Math.PI/180),t=e.cos(),r=e.sin();n=an(n.x.mul(t).sub(n.y.mul(r)),n.x.mul(r).add(n.y.mul(t)))}return t&&(n=n.add(t)),i&&(n=n.add(i)),n},mx_power:(e,t=tn(1))=>Uo(e,t),mx_ramp4:(e,t,r,s,i=sl())=>{const n=i.x.clamp(),a=i.y.clamp(),o=Ho(e,t,n),u=Ho(r,s,n);return Ho(o,u,a)},mx_ramplr:(e,t,r=sl())=>J_(e,t,r,"x"),mx_ramptb:(e,t,r=sl())=>J_(e,t,r,"y"),mx_rgbtohsv:Y_,mx_rotate2d:(e,t)=>{e=an(e);const r=(t=tn(t)).mul(Math.PI/180);return of(e,r)},mx_rotate3d:(e,t,r)=>{e=dn(e),t=tn(t),r=dn(r);const s=t.mul(Math.PI/180),i=r.normalize(),n=s.cos(),a=s.sin(),o=tn(1).sub(n);return e.mul(n).add(i.cross(e).mul(a)).add(i.mul(i.dot(e)).mul(o))},mx_safepower:(e,t=1)=>(e=tn(e)).abs().pow(t).mul(e.sign()),mx_separate:(e,t=null)=>{if("string"==typeof t){const r={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3},s=t.replace(/^out/,"").toLowerCase();if(void 0!==r[s])return e.element(r[s])}if("number"==typeof t)return e.element(t);if("string"==typeof t&&1===t.length){const r={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};if(void 0!==r[t])return e.element(r[t])}return e},mx_splitlr:(e,t,r,s=sl())=>ev(e,t,r,s,"x"),mx_splittb:(e,t,r,s=sl())=>ev(e,t,r,s,"y"),mx_srgb_texture_to_lin_rec709:Q_,mx_subtract:(e,t=tn(0))=>ya(e,t),mx_timer:()=>wy,mx_transform_uv:(e=1,t=0,r=sl())=>r.mul(e).add(t),mx_unifiednoise2d:(e,t=sl(),r=an(1,1),s=an(0,0),i=1,n=0,a=1,o=!1,u=1,l=2,d=.5)=>j_(e,t.convert("vec2|vec3"),r,s,i,n,a,o,u,l,d),mx_unifiednoise3d:(e,t=sl(),r=an(1,1),s=an(0,0),i=1,n=0,a=1,o=!1,u=1,l=2,d=.5)=>X_(e,t.convert("vec2|vec3"),r,s,i,n,a,o,u,l,d),mx_worley_noise_float:(e=sl(),t=1)=>H_(e.convert("vec2|vec3"),t,rn(1)),mx_worley_noise_vec2:(e=sl(),t=1)=>W_(e.convert("vec2|vec3"),t,rn(1)),mx_worley_noise_vec3:(e=sl(),t=1)=>q_(e.convert("vec2|vec3"),t,rn(1)),negate:yo,neutralToneMapping:rx,nodeArray:$i,nodeImmutable:Wi,nodeObject:Gi,nodeObjectIntent:ki,nodeObjects:zi,nodeProxy:Hi,nodeProxyIntent:qi,normalFlat:_d,normalGeometry:xd,normalLocal:Td,normalMap:Sc,normalView:Sd,normalViewGeometry:vd,normalWorld:Ed,normalWorldGeometry:Nd,normalize:no,not:Ca,notEqual:va,numWorkgroups:Sx,objectDirection:$l,objectGroup:na,objectPosition:Wl,objectRadius:Xl,objectScale:ql,objectViewPosition:jl,objectWorldMatrix:Hl,oneMinus:bo,or:wa,orthographicDepthToViewZ:(e,t,r)=>t.sub(r).mul(e).sub(t),oscSawtooth:(e=wy)=>e.fract(),oscSine:(e=wy)=>e.add(.75).mul(2*Math.PI).sin().mul(.5).add(.5),oscSquare:(e=wy)=>e.fract().round(),oscTriangle:(e=wy)=>e.add(.5).fract().mul(2).sub(1).abs(),output:Hn,outputStruct:gy,overlay:(...e)=>(console.warn('THREE.TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),Tp(e)),overloadingFn:Ay,parabola:_y,parallaxDirection:_c,parallaxUV:(e,t)=>e.sub(_c.mul(t)),parameter:(e,t)=>Gi(new uy(e,t)),pass:(e,t,r)=>Gi(new Wb(Wb.COLOR,e,t,r)),passTexture:(e,t)=>Gi(new $b(e,t)),pcurve:(e,t,r)=>Uo(xa(Uo(e,t),fa(Uo(e,t),Uo(ya(1,e),r))),1/t),perspectiveDepthToViewZ:np,pmremTexture:km,pointShadow:r_,pointUV:fb,pointWidth:jn,positionGeometry:ud,positionLocal:ld,positionPrevious:dd,positionView:pd,positionViewDirection:gd,positionWorld:cd,positionWorldDirection:hd,posterize:kb,pow:Uo,pow2:Vo,pow3:Oo,pow4:Go,premultiplyAlpha:vp,property:Sn,quadBroadcast:aT,quadSwapDiagonal:eT,quadSwapX:Zx,quadSwapY:Jx,radians:Ka,rand:Yo,range:_x,rangeFog:function(e,t,r){return console.warn('THREE.TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),yx(e,mx(t,r))},rangeFogFactor:mx,reciprocal:vo,reference:jd,referenceBuffer:Xd,reflect:Bo,reflectVector:Od,reflectView:Ud,reflector:e=>Gi(new Zy(e)),refract:jo,refractVector:Gd,refractView:Vd,reinhardToneMapping:Xb,remap:qu,remapClamp:ju,renderGroup:ia,renderOutput:Zu,rendererReference:Cu,rotate:of,rotateUV:Py,roughness:wn,round:_o,rtt:ab,sRGBTransferEOTF:Tu,sRGBTransferOETF:_u,sample:(e,t=null)=>Gi(new db(e,Gi(t))),sampler:e=>(!0===e.isNode?e:cl(e)).convert("sampler"),samplerComparison:e=>(!0===e.isNode?e:cl(e)).convert("samplerComparison"),saturate:qo,saturation:Ib,screen:(...e)=>(console.warn('THREE.TSL: "screen" has been renamed. Use "blendScreen" instead.'),xp(e)),screenCoordinate:El,screenDPR:vl,screenSize:Sl,screenUV:Nl,scriptable:px,scriptableValue:ux,select:iu,setCurrentStack:Yi,setName:uu,shaderStages:qs,shadow:qT,shadowPositionWorld:TT,shapeCircle:u_,sharedUniformGroup:ra,sheen:Bn,sheenRoughness:Ln,shiftLeft:Ia,shiftRight:Da,shininess:$n,sign:mo,sin:oo,sinc:(e,t)=>oo(Wa.mul(t.mul(e).sub(1))).div(Wa.mul(t.mul(e).sub(1))),skinning:Ih,smoothstep:Xo,smoothstepElement:Zo,specularColor:kn,specularF90:zn,spherizeUV:By,split:(e,t)=>Gi(new ri(Gi(e),t)),spritesheetUV:Dy,sqrt:to,stack:dy,step:Po,stepElement:Jo,storage:Bh,storageBarrier:()=>Cx("storage").toStack(),storageObject:(e,t,r)=>(console.warn('THREE.TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),Bh(e,t,r).setPBO(!0)),storageTexture:Sb,string:(e="")=>Gi(new oi(e,"string")),struct:(e,t=null)=>{const r=new cy(e,t),s=(...t)=>{let s=null;if(t.length>0)if(t[0].isNode){s={};const r=Object.keys(e);for(let e=0;e<t.length;e++)s[r[e]]=t[e]}else s=t[0];return Gi(new hy(r,s))};return s.layout=r,s.isStruct=!0,s},sub:ya,subBuild:fu,subgroupAdd:Vx,subgroupAll:Kx,subgroupAnd:Hx,subgroupAny:Yx,subgroupBallot:Ux,subgroupBroadcast:tT,subgroupBroadcastFirst:Qx,subgroupElect:Dx,subgroupExclusiveAdd:Gx,subgroupExclusiveMul:$x,subgroupInclusiveAdd:Ox,subgroupInclusiveMul:zx,subgroupIndex:xh,subgroupMax:Xx,subgroupMin:jx,subgroupMul:kx,subgroupOr:Wx,subgroupShuffle:rT,subgroupShuffleDown:nT,subgroupShuffleUp:iT,subgroupShuffleXor:sT,subgroupSize:wx,subgroupXor:qx,tan:lo,tangentGeometry:cc,tangentLocal:hc,tangentView:pc,tangentWorld:gc,texture:cl,texture3D:Ab,textureBarrier:()=>Cx("texture").toStack(),textureBicubic:Ig,textureBicubicLevel:Fg,textureCubeUV:hm,textureLoad:hl,textureSize:nl,textureStore:(e,t,r)=>{const s=Sb(e,t,r);return null!==r&&s.toStack(),s},thickness:Yn,time:wy,toneMapping:Pu,toneMappingExposure:Bu,toonOutlinePass:(t,r,s=new e(0,0,0),i=.003,n=1)=>Gi(new qb(t,r,Gi(s),Gi(i),Gi(n))),transformDirection:ko,transformNormal:Ad,transformNormalToView:wd,transformedClearcoatNormalView:Pd,transformedNormalView:Cd,transformedNormalWorld:Md,transmission:Kn,transpose:Eo,triNoise3D:Sy,triplanarTexture:(...e)=>Uy(...e),triplanarTextures:Uy,trunc:No,uint:sn,uintBitsToFloat:e=>new by(e,"float","uint"),uniform:oa,uniformArray:yl,uniformCubeTexture:(e=kd)=>$d(e),uniformFlow:ou,uniformGroup:ta,uniformTexture:(e=ul)=>cl(e),unpremultiplyAlpha:Np,userData:(e,t,r)=>Gi(new wb(e,t,r)),uv:sl,uvec2:un,uvec3:hn,uvec4:fn,varying:bu,varyingProperty:En,vec2:an,vec3:dn,vec4:gn,vectorComponents:js,velocity:Lb,vertexColor:fp,vertexIndex:yh,vertexStage:xu,vibrance:Db,viewZToLogarithmicDepth:ap,viewZToOrthographicDepth:sp,viewZToPerspectiveDepth:ip,viewport:Rl,viewportCoordinate:wl,viewportDepthTexture:tp,viewportLinearDepth:dp,viewportMipTexture:Zh,viewportResolution:Ml,viewportSafeUV:Fy,viewportSharedTexture:Pp,viewportSize:Al,viewportTexture:Qh,viewportUV:Cl,wgsl:(e,t)=>ix(e,t,"wgsl"),wgslFn:(e,t)=>ax(e,t,"wgsl"),workgroupArray:(e,t)=>Gi(new Px("Workgroup",e,t)),workgroupBarrier:()=>Cx("workgroup").toStack(),workgroupId:Ex,workingToColorSpace:Su,xor:Ma});const iv=new oy;class nv extends wf{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,r){const s=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background;let n=!1;if(null===i)s._clearColor.getRGB(iv),iv.a=s._clearColor.a;else if(!0===i.isColor)i.getRGB(iv),iv.a=1,n=!0;else if(!0===i.isNode){const o=this.get(e),u=i;iv.copy(s._clearColor);let l=o.backgroundMesh;if(void 0===l){const c=au(gn(u).mul(_b),{getUV:()=>vb.mul(Nd),getTextureLevel:()=>Tb});let h=mh;h=h.setZ(h.w);const p=new Sp;function g(){i.removeEventListener("dispose",g),l.material.dispose(),l.geometry.dispose()}p.name="Background.material",p.side=S,p.depthTest=!1,p.depthWrite=!1,p.allowOverride=!1,p.fog=!1,p.lights=!1,p.vertexNode=h,p.colorNode=c,o.backgroundMeshNode=c,o.backgroundMesh=l=new X(new Ge(1,32,32),p),l.frustumCulled=!1,l.name="Background.mesh",l.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},i.addEventListener("dispose",g)}const d=u.getCacheKey();o.backgroundCacheKey!==d&&(o.backgroundMeshNode.node=gn(u).mul(_b),o.backgroundMeshNode.needsUpdate=!0,l.material.needsUpdate=!0,o.backgroundCacheKey=d),t.unshift(l,l.geometry,l.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);const a=s.xr.getEnvironmentBlendMode();if("additive"===a?iv.set(0,0,0,1):"alpha-blend"===a&&iv.set(0,0,0,0),!0===s.autoClear||!0===n){const m=r.clearColorValue;m.r=iv.r,m.g=iv.g,m.b=iv.b,m.a=iv.a,!0!==s.backend.isWebGLBackend&&!0!==s.alpha||(m.r*=m.a,m.g*=m.a,m.b*=m.a),r.depthClearValue=s._clearDepth,r.stencilClearValue=s._clearStencil,r.clearColor=!0===s.autoClearColor,r.clearDepth=!0===s.autoClearDepth,r.clearStencil=!0===s.autoClearStencil}else r.clearColor=!1,r.clearDepth=!1,r.clearStencil=!1}}let av=0;class ov{constructor(e="",t=[],r=0,s=[]){this.name=e,this.bindings=t,this.index=r,this.bindingsReference=s,this.id=av++}}class uv{constructor(e,t,r,s,i,n,a,o,u,l=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=r,this.transforms=l,this.nodeAttributes=s,this.bindings=i,this.updateNodes=n,this.updateBeforeNodes=a,this.updateAfterNodes=o,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings){if(!0!==t.bindings[0].groupNode.shared){const r=new ov(t.name,[],t.index,t.bindingsReference);e.push(r);for(const e of t.bindings)r.bindings.push(e.clone())}else e.push(t)}return e}}class lv{constructor(e,t,r=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=r}}class dv{constructor(e,t,r){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=r}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class cv{constructor(e,t,r=!1,s=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=r,this.count=s}}class hv extends cv{constructor(e,t,r=null,s=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=r,this.interpolationSampling=s}}class pv{constructor(e,t,r=""){this.name=e,this.type=t,this.code=r,Object.defineProperty(this,"isNodeCode",{value:!0})}}let gv=0;class mv{constructor(e=null){this.id=gv++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return void 0===t&&null!==this.parent&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class fv{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class yv{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class bv extends yv{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class xv extends yv{constructor(e,r=new t){super(e,r),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class Tv extends yv{constructor(e,t=new r){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class _v extends yv{constructor(e,t=new s){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class vv extends yv{constructor(t,r=new e){super(t,r),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class Nv extends yv{constructor(e,t=new i){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class Sv extends yv{constructor(e,t=new n){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class Ev extends yv{constructor(e,t=new a){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class Rv extends bv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Av extends xv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class wv extends Tv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Cv extends _v{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Mv extends vv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Pv extends Nv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Bv extends Sv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Lv extends Ev{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const Fv=new WeakMap,Iv=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),Dv=e=>/e/g.test(e)?String(e).replace(/\+/g,""):(e=Number(e))+(e%1?"":".0");class Uv{constructor(e,t,r){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=r,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=dy(),this.stacks=[],this.tab="\t",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new mv,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.currentStack=null,this.subBuildFn=null}getBindGroupsCache(){let e=Fv.get(this.renderer);return void 0===e&&(e=new Nf,Fv.set(this.renderer,e)),e}createRenderTarget(e,t,r){return new ue(e,t,r)}createCubeRenderTarget(e,t){return new Vp(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const r=this.getBindGroupsCache(),s=[];let i,n=!0;for(const e of t)s.push(e),n=n&&!0!==e.groupNode.shared;return n?(i=r.get(s),void 0===i&&(i=new ov(e,s,this.bindingsIndexes[e].group,s),r.set(s,i))):i=new ov(e,s,this.bindingsIndexes[e].group,s),i}getBindGroupArray(e,t){const r=this.bindings[t];let s=r[e];return void 0===s&&(void 0===this.bindingsIndexes[e]&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),r[e]=s=[]),s}getBindings(){let e=this.bindGroups;if(null===e){const t={},r=this.bindings;for(const e of qs)for(const s in r[e]){const i=r[e][s];(t[s]||(t[s]=[])).push(...i)}e=[];for(const r in t){const s=t[r],i=this._getBindGroup(r,s);e.push(i)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((e,t)=>e.bindings[0].groupNode.order-t.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const r=e[t];this.bindingsIndexes[r.name].group=t,r.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){!1===this.nodes.includes(e)&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){!1===this.sequentialNodes.includes(e)&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes){e.getUpdateType()!==ks.NONE&&this.updateNodes.push(e)}for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),r=e.getUpdateAfterType();t!==ks.NONE&&this.updateBeforeNodes.push(e),r!==ks.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Y||e.magFilter===ke||e.magFilter===ze||e.magFilter===U||e.minFilter===Y||e.minFilter===ke||e.minFilter===ze||e.minFilter===U}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return this.context,this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const r=this.getDataFromNode(e);return void 0===r.cache&&(r.cache=new mv(t?this.getCache():null)),r.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=void 0===t.usageCount?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,r=null){let s=this.generateArrayDeclaration(e,t)+"( ";for(let i=0;i<t;i++){const n=r?r[i]:null;s+=null!==n?n.build(this,e):this.generateConst(e),i<t-1&&(s+=", ")}return s+=" )",s}generateStruct(e,t,r=null){const s=[];for(const e of t){const{name:t,type:i}=e;r&&r[t]&&r[t].isNode?s.push(r[t].build(this,i)):s.push(this.generateConst(i))}return e+"( "+s.join(", ")+" )"}generateConst(i,n=null){if(null===n&&("float"===i||"int"===i||"uint"===i?n=0:"bool"===i?n=!1:"color"===i?n=new e:"vec2"===i?n=new t:"vec3"===i?n=new r:"vec4"===i&&(n=new s)),"float"===i)return Dv(n);if("int"===i)return`${Math.round(n)}`;if("uint"===i)return n>=0?`${Math.round(n)}u`:"0u";if("bool"===i)return n?"true":"false";if("color"===i)return`${this.getType("vec3")}( ${Dv(n.r)}, ${Dv(n.g)}, ${Dv(n.b)} )`;const a=this.getTypeLength(i),o=this.getComponentType(i),u=e=>this.generateConst(o,e);if(2===a)return`${this.getType(i)}( ${u(n.x)}, ${u(n.y)} )`;if(3===a)return`${this.getType(i)}( ${u(n.x)}, ${u(n.y)}, ${u(n.z)} )`;if(4===a&&"mat2"!==i)return`${this.getType(i)}( ${u(n.x)}, ${u(n.y)}, ${u(n.z)}, ${u(n.w)} )`;if(a>=4&&n&&(n.isMatrix2||n.isMatrix3||n.isMatrix4))return`${this.getType(i)}( ${n.elements.map(u).join(", ")} )`;if(a>4)return`${this.getType(i)}()`;throw new Error(`NodeBuilder: Type '${i}' not found in generate constant attempt.`)}getType(e){return"color"===e?"vec3":e}hasGeometryAttribute(e){return this.geometry&&void 0!==this.geometry.getAttribute(e)}getAttribute(e,t){const r=this.attributes;for(const t of r)if(t.name===e)return t;const s=new lv(e,t);return this.registerDeclaration(s),r.push(s),s}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return"void"===e||"property"===e||"sampler"===e||"samplerComparison"===e||"texture"===e||"cubeTexture"===e||"storageTexture"===e||"depthTexture"===e||"texture3D"===e}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===_)return"int";if(t===T)return"uint"}return"float"}getElementType(e){return"mat2"===e?"vec2":"mat3"===e?"vec3":"mat4"===e?"vec4":this.getComponentType(e)}getComponentType(e){if("float"===(e=this.getVectorType(e))||"bool"===e||"int"===e||"uint"===e)return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return null===t?null:"b"===t[1]?"bool":"i"===t[1]?"int":"u"===t[1]?"uint":"float"}getVectorType(e){return"color"===e?"vec3":"texture"===e||"cubeTexture"===e||"storageTexture"===e||"texture3D"===e?"vec4":e}getTypeFromLength(e,t="float"){if(1===e)return t;let r=Cs(e);const s="float"===t?"":t[0];return!0===/mat2/.test(t)&&(r=r.replace("vec","mat")),s+r}getTypeFromArray(e){return Iv.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const r=t.array,s=e.itemSize,i=e.normalized;let n;return e instanceof $e||!0===i||(n=this.getTypeFromArray(r)),this.getTypeFromLength(s,n)}getTypeLength(e){const t=this.getVectorType(e),r=/vec([2-4])/.exec(t);return null!==r?Number(r[1]):"float"===t||"bool"===t||"int"===t||"uint"===t?1:!0===/mat2/.test(e)?4:!0===/mat3/.test(e)?9:!0===/mat4/.test(e)?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return"int"===t||"uint"===t?e:this.changeComponentType(e,"int")}addStack(){this.stack=dy(this.stack);const e=Qi();return this.stacks.push(e),Yi(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,Yi(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,r=null){let s=(r=null===r?e.isGlobal(this)?this.globalCache:this.cache:r).getData(e);void 0===s&&(s={},r.setData(e,s)),void 0===s[t]&&(s[t]={});let i=s[t];const n=s.any?s.any.subBuilds:null,a=this.getClosestSubBuild(n);return a&&(void 0===i.subBuildsCache&&(i.subBuildsCache={}),i=i.subBuildsCache[a]||(i.subBuildsCache[a]={}),i.subBuilds=n),i}getNodeProperties(e,t="any"){const r=this.getDataFromNode(e,t);return r.properties||(r.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const r=this.getDataFromNode(e);let s=r.bufferAttribute;if(void 0===s){const i=this.uniforms.index++;s=new lv("nodeAttribute"+i,t,e),this.bufferAttributes.push(s),r.bufferAttribute=s}return s}getStructTypeNode(e,t=this.shaderStage){return this.types[t][e]||null}getStructTypeFromNode(e,t,r=null,s=this.shaderStage){const i=this.getDataFromNode(e,s,this.globalCache);let n=i.structType;if(void 0===n){const a=this.structs.index++;null===r&&(r="StructType"+a),n=new fv(r,t),this.structs[s].push(n),this.types[s][r]=e,i.structType=n}return n}getOutputStructTypeFromNode(e,t){const r=this.getStructTypeFromNode(e,t,"OutputType","fragment");return r.output=!0,r}getUniformFromNode(e,t,r=this.shaderStage,s=null){const i=this.getDataFromNode(e,r,this.globalCache);let n=i.uniform;if(void 0===n){const a=this.uniforms.index++;n=new dv(s||"nodeUniform"+a,t,e),this.uniforms[r].push(n),this.registerDeclaration(n),i.uniform=n}return n}getVarFromNode(e,t=null,r=e.getNodeType(this),s=this.shaderStage,i=!1){const n=this.getDataFromNode(e,s),a=this.getSubBuildProperty("variable",n.subBuilds);let o=n[a];if(void 0===o){const u=i?"_const":"_var",l=this.vars[s]||(this.vars[s]=[]),d=this.vars[u]||(this.vars[u]=0);null===t&&(t=(i?"nodeConst":"nodeVar")+d,this.vars[u]++),"variable"!==a&&(t=this.getSubBuildProperty(t,n.subBuilds));const c=e.getArrayCount(this);o=new cv(t,r,i,c),i||l.push(o),this.registerDeclaration(o),n[a]=o}return o}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode))&&(!e.cNode||this.isDeterministic(e.cNode));if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode));if(e.isArrayNode){if(null!==e.values)for(const t of e.values)if(!this.isDeterministic(t))return!1;return!0}return!!e.isConstNode}getVaryingFromNode(e,t=null,r=e.getNodeType(this),s=null,i=null){const n=this.getDataFromNode(e,"any"),a=this.getSubBuildProperty("varying",n.subBuilds);let o=n[a];if(void 0===o){const e=this.varyings,u=e.length;null===t&&(t="nodeVarying"+u),"varying"!==a&&(t=this.getSubBuildProperty(t,n.subBuilds)),o=new hv(t,r,s,i),e.push(o),this.registerDeclaration(o),n[a]=o}return o}registerDeclaration(e){const t=this.shaderStage,r=this.declarations[t]||(this.declarations[t]={}),s=this.getPropertyName(e);let i=1,n=s;for(;void 0!==r[n];)n=s+"_"+i++;i>1&&(e.name=n,console.warn(`THREE.TSL: Declaration name '${s}' of '${e.type}' already in use. Renamed to '${n}'.`)),r[n]=e}getCodeFromNode(e,t,r=this.shaderStage){const s=this.getDataFromNode(e);let i=s.code;if(void 0===i){const e=this.codes[r]||(this.codes[r]=[]),n=e.length;i=new pv("nodeCode"+n,t),e.push(i),s.code=i}return i}addFlowCodeHierarchy(e,t){const{flowCodes:r,flowCodeBlock:s}=this.getDataFromNode(e);let i=!0,n=t;for(;n;){if(!0===s.get(n)){i=!1;break}n=this.getDataFromNode(n).parentNodeBlock}if(i)for(const e of r)this.addLineFlowCode(e)}addLineFlowCodeBlock(e,t,r){const s=this.getDataFromNode(e),i=s.flowCodes||(s.flowCodes=[]),n=s.flowCodeBlock||(s.flowCodeBlock=new WeakMap);i.push(t),n.set(r,!0)}addLineFlowCode(e,t=null){return""===e||(null!==t&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e+=";\n"),this.flow.code+=e),this}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="\t",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),r=this.flowChildNode(e,t);return this.flowsData.set(e,r),r}addInclude(e){null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new nx,r=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=r,t}flowShaderNode(e){const t=e.layout,r={[Symbol.iterator](){let e=0;const t=Object.values(this);return{next:()=>({value:t[e],done:e++>=t.length})}}};for(const e of t.inputs)r[e.name]=new uy(e.type,e.name);e.layout=null;const s=e.call(r),i=this.flowStagesNode(s,t.type);return e.layout=t,i}flowBuildStage(e,t,r=null){const s=this.getBuildStage();this.setBuildStage(t);const i=e.build(this,r);return this.setBuildStage(s),i}flowStagesNode(e,t=null){const r=this.flow,s=this.vars,i=this.declarations,n=this.cache,a=this.buildStage,o=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new mv,this.stack=dy();for(const r of Ws)this.setBuildStage(r),u.result=e.build(this,t);return u.vars=this.getVars(this.shaderStage),this.flow=r,this.vars=s,this.declarations=i,this.cache=n,this.stack=o,this.setBuildStage(a),u}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const r=this.flow,s={code:""};return this.flow=s,s.result=e.build(this,t),this.flow=r,s}flowNodeFromShaderStage(e,t,r=null,s=null){const i=this.tab,n=this.cache,a=this.shaderStage,o=this.context;this.setShaderStage(e);const u={...this.context};delete u.nodeBlock,this.cache=this.globalCache,this.tab="\t",this.context=u;let l=null;if("generate"===this.buildStage){const i=this.flowChildNode(t,r);null!==s&&(i.code+=`${this.tab+s} = ${i.result};\n`),this.flowCode[e]=this.flowCode[e]+i.code,l=i}else l=t.build(this);return this.setShaderStage(a),this.cache=n,this.tab=i,this.context=o,l}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,r=null){return`${null!==r?this.generateArrayDeclaration(e,r):this.getType(e)} ${t}`}getVars(e){let t="";const r=this.vars[e];if(void 0!==r)for(const e of r)t+=`${this.getVar(e.type,e.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let r="";if(void 0!==t)for(const e of t)r+=e.code+"\n";return r}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(t=e&&e.isNode?e.isShaderCallNodeInternal?e.shaderNode.subBuilds:e.isStackNode?[e.subBuild]:this.getDataFromNode(e,"any").subBuilds:e instanceof Set?[...e]:e,!t)return null;const r=this.subBuildLayers;for(let e=t.length-1;e>=0;e--){const s=t[e];if(r.includes(s))return s}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",t=null){let r,s;return r=null!==t?this.getClosestSubBuild(t):this.subBuildFn,s=r?e?r+"_"+e:r:e,s}build(){const{object:e,material:t,renderer:r}=this;if(null!==t){let e=r.library.fromMaterial(t);null===e&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),e=new Sp),e.build(this)}else this.addFlow("compute",e);for(const e of Ws){this.setBuildStage(e),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const t of qs){this.setShaderStage(t);const r=this.flowNodes[t];for(const t of r)"generate"===e?this.flowNode(t):t.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if("float"===t||"int"===t||"uint"===t)return new Rv(e);if("vec2"===t||"ivec2"===t||"uvec2"===t)return new Av(e);if("vec3"===t||"ivec3"===t||"uvec3"===t)return new wv(e);if("vec4"===t||"ivec4"===t||"uvec4"===t)return new Cv(e);if("color"===t)return new Mv(e);if("mat2"===t)return new Pv(e);if("mat3"===t)return new Bv(e);if("mat4"===t)return new Lv(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,r){if((t=this.getVectorType(t))===(r=this.getVectorType(r))||null===r||this.isReference(r))return e;const s=this.getTypeLength(t),i=this.getTypeLength(r);return 16===s&&9===i?`${this.getType(r)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:9===s&&4===i?`${this.getType(r)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:s>4||i>4||0===i?e:s===i?`${this.getType(r)}( ${e} )`:s>i?(e="bool"===r?`all( ${e} )`:`${e}.${"xyz".slice(0,i)}`,this.format(e,this.getTypeFromLength(i,this.getComponentType(t)),r)):4===i&&s>1?`${this.getType(r)}( ${this.format(e,t,"vec3")}, 1.0 )`:2===s?`${this.getType(r)}( ${this.format(e,t,"vec2")}, 0.0 )`:(1===s&&i>1&&t!==this.getComponentType(r)&&(e=`${this.getType(this.getComponentType(r))}( ${e} )`),`${this.getType(r)}( ${e} )`)}getSignature(){return`// Three.js r${He} - Node System\n`}}class Vv{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let r=e.get(t);return void 0===r&&(r={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,r)),r}updateBeforeNode(e){const t=e.getUpdateBeforeType(),r=e.updateReference(this);if(t===ks.FRAME){const{frameMap:t}=this._getMaps(this.updateBeforeMap,r);t.get(r)!==this.frameId&&!1!==e.updateBefore(this)&&t.set(r,this.frameId)}else if(t===ks.RENDER){const{renderMap:t}=this._getMaps(this.updateBeforeMap,r);t.get(r)!==this.renderId&&!1!==e.updateBefore(this)&&t.set(r,this.renderId)}else t===ks.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),r=e.updateReference(this);if(t===ks.FRAME){const{frameMap:t}=this._getMaps(this.updateAfterMap,r);t.get(r)!==this.frameId&&!1!==e.updateAfter(this)&&t.set(r,this.frameId)}else if(t===ks.RENDER){const{renderMap:t}=this._getMaps(this.updateAfterMap,r);t.get(r)!==this.renderId&&!1!==e.updateAfter(this)&&t.set(r,this.renderId)}else t===ks.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),r=e.updateReference(this);if(t===ks.FRAME){const{frameMap:t}=this._getMaps(this.updateMap,r);t.get(r)!==this.frameId&&!1!==e.update(this)&&t.set(r,this.frameId)}else if(t===ks.RENDER){const{renderMap:t}=this._getMaps(this.updateMap,r);t.get(r)!==this.renderId&&!1!==e.update(this)&&t.set(r,this.renderId)}else t===ks.OBJECT&&e.update(this)}update(){this.frameId++,void 0===this.lastTime&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class Ov{constructor(e,t,r=null,s="",i=!1){this.type=e,this.name=t,this.count=r,this.qualifier=s,this.isConst=i}}Ov.isNodeFunctionInput=!0;class Gv extends s_{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:gT(this.light),lightColor:e}}}const kv=new a,zv=new a;let $v=null;class Hv extends s_{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=oa(new r).setGroup(ia),this.halfWidth=oa(new r).setGroup(ia),this.updateType=ks.RENDER}update(e){super.update(e);const{light:t}=this,r=e.camera.matrixWorldInverse;zv.identity(),kv.copy(t.matrixWorld),kv.premultiply(r),zv.extractRotation(kv),this.halfWidth.value.set(.5*t.width,0,0),this.halfHeight.value.set(0,.5*t.height,0),this.halfWidth.value.applyMatrix4(zv),this.halfHeight.value.applyMatrix4(zv)}setupDirectRectArea(e){let t,r;e.isAvailable("float32Filterable")?(t=cl($v.LTC_FLOAT_1),r=cl($v.LTC_FLOAT_2)):(t=cl($v.LTC_HALF_1),r=cl($v.LTC_HALF_2));const{colorNode:s,light:i}=this;return{lightColor:s,lightPosition:pT(i),halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:r}}static setLTC(e){$v=e}}class Wv extends s_{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=oa(0).setGroup(ia),this.penumbraCosNode=oa(0).setGroup(ia),this.cutoffDistanceNode=oa(0).setGroup(ia),this.decayExponentNode=oa(0).setGroup(ia),this.colorNode=oa(this.color).setGroup(ia)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:r,penumbraCosNode:s}=this;return Xo(r,s,t)}getLightCoord(e){const t=e.getNodeProperties(this);let r=t.projectionUV;return void 0===r&&(r=dT(this.light,e.context.positionWorld),t.projectionUV=r),r}setupDirect(e){const{colorNode:t,cutoffDistanceNode:r,decayExponentNode:s,light:i}=this,n=this.getLightVector(e),a=n.normalize(),o=a.dot(gT(i)),u=this.getSpotAttenuation(e,o),l=n.length(),d=i_({lightDistance:l,cutoffDistance:r,decayExponent:s});let c,h,p=t.mul(u).mul(d);if(i.colorNode?(h=this.getLightCoord(e),c=i.colorNode(h)):i.map&&(h=this.getLightCoord(e),c=cl(i.map,h.xy).onRenderUpdate(()=>i.map)),c){p=h.mul(2).sub(1).abs().lessThan(1).all().select(p.mul(c),p)}return{lightColor:p,lightDirection:a}}}class qv extends Wv{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const r=this.light.iesMap;let s=null;if(r&&!0===r.isTexture){const e=t.acos().mul(1/Math.PI);s=cl(r,an(e,0),0).r}else s=super.getSpotAttenuation(t);return s}}const jv=Ki(([e,t])=>{const r=e.abs().sub(t);return fo(Mo(r,0)).add(Co(Mo(r.x,r.y),0))});class Xv extends Wv{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),null===t.aspect){let e=1;null!==t.map&&(e=t.map.width/t.map.height),t.shadow.aspect=e}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=tn(0),r=this.penumbraCosNode,s=lT(this.light).mul(e.context.positionWorld||cd);return Zi(s.w.greaterThan(0),()=>{const e=s.xyz.div(s.w),i=jv(e.xy.sub(an(.5)),an(.5)),n=xa(-1,ya(1,ho(r)).sub(1));t.assign(qo(i.mul(-2).mul(n)))}),t}}class Kv extends s_{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class Yv extends s_{static get type(){return"HemisphereLightNode"}constructor(t=null){super(t),this.lightPositionNode=cT(t),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=oa(new e).setGroup(ia)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:r,lightDirectionNode:s}=this,i=Ed.dot(s).mul(.5).add(.5),n=Ho(r,t,i);e.context.irradiance.addAssign(n)}}class Qv extends s_{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let e=0;e<9;e++)t.push(new r);this.lightProbe=yl(t)}update(e){const{light:t}=this;super.update(e);for(let e=0;e<9;e++)this.lightProbe.array[e].copy(t.sh.coefficients[e]).multiplyScalar(t.intensity)}setup(e){const t=rv(Ed,this.lightProbe);e.context.irradiance.addAssign(t)}}class Zv{parseFunction(){console.warn("Abstract function.")}}class Jv{constructor(e,t,r="",s=""){this.type=e,this.inputs=t,this.name=r,this.precision=s}getCode(){console.warn("Abstract function.")}}Jv.isNodeFunction=!0;const eN=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,tN=/[a-z_0-9]+/gi,rN="#pragma main";class sN extends Jv{constructor(e){const{type:t,inputs:r,name:s,precision:i,inputsCode:n,blockCode:a,headerCode:o}=(e=>{const t=(e=e.trim()).indexOf(rN),r=-1!==t?e.slice(t+12):e,s=r.match(eN);if(null!==s&&5===s.length){const i=s[4],n=[];let a=null;for(;null!==(a=tN.exec(i));)n.push(a);const o=[];let u=0;for(;u<n.length;){const e="const"===n[u][0];!0===e&&u++;let t=n[u][0];"in"===t||"out"===t||"inout"===t?u++:t="";const r=n[u++][0];let s=Number.parseInt(n[u][0]);!1===Number.isNaN(s)?u++:s=null;const i=n[u++][0];o.push(new Ov(r,i,s,t,e))}const l=r.substring(s[0].length),d=void 0!==s[3]?s[3]:"";return{type:s[2],inputs:o,name:d,precision:void 0!==s[1]?s[1]:"",inputsCode:i,blockCode:l,headerCode:-1!==t?e.slice(0,t):""}}throw new Error("FunctionNode: Function is not a GLSL code.")})(e);super(t,r,s,i),this.inputsCode=n,this.blockCode=a,this.headerCode=o}getCode(e=this.name){let t;const r=this.blockCode;if(""!==r){const{type:s,inputsCode:i,headerCode:n,precision:a}=this;let o=`${s} ${e} ( ${i.trim()} )`;""!==a&&(o=`${a} ${o}`),t=n+o+r}else t="";return t}}class iN extends Zv{parseFunction(e){return new sN(e)}}const nN=new WeakMap,aN=[],oN=[];class uN extends wf{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new Vv,this.nodeBuilderCache=new Map,this.callHashCache=new Nf,this.groupsData=new Nf,this.cacheLib={}}updateGroup(e){const t=e.groupNode,r=t.name;if(r===na.name)return!0;if(r===ia.name){const t=this.get(e),r=this.nodeFrame.renderId;return t.renderId!==r&&(t.renderId=r,!0)}if(r===sa.name){const t=this.get(e),r=this.nodeFrame.frameId;return t.frameId!==r&&(t.frameId=r,!0)}aN[0]=t,aN[1]=e;let s=this.groupsData.get(aN);return void 0===s&&this.groupsData.set(aN,s={}),aN.length=0,s.version!==t.version&&(s.version=t.version,!0)}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let r=t.nodeBuilderState;if(void 0===r){const{nodeBuilderCache:s}=this,i=this.getForRenderCacheKey(e);if(r=s.get(i),void 0===r){const t=this.backend.createNodeBuilder(e.object,this.renderer);t.scene=e.scene,t.material=e.material,t.camera=e.camera,t.context.material=e.material,t.lightsNode=e.lightsNode,t.environmentNode=this.getEnvironmentNode(e.scene),t.fogNode=this.getFogNode(e.scene),t.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&t.enableMultiview(),t.build(),r=this._createNodeBuilderState(t),s.set(i,r)}r.usedTimes++,t.nodeBuilderState=r}return r}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,0===t.usedTimes&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let r=t.nodeBuilderState;if(void 0===r){const s=this.backend.createNodeBuilder(e,this.renderer);s.build(),r=this._createNodeBuilderState(s),t.nodeBuilderState=r}return r}_createNodeBuilderState(e){return new uv(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const r=this.get(e);r.environmentNode&&(t=r.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const r=this.get(e);r.backgroundNode&&(t=r.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){aN[0]=e,aN[1]=t;const r=this.renderer.info.calls,s=this.callHashCache.get(aN)||{};if(s.callId!==r){const i=this.getEnvironmentNode(e),n=this.getFogNode(e);t&&oN.push(t.getCacheKey(!0)),i&&oN.push(i.getCacheKey()),n&&oN.push(n.getCacheKey()),oN.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),oN.push(this.renderer.shadowMap.enabled?1:0),s.callId=r,s.cacheKey=Ns(oN),this.callHashCache.set(aN,s),oN.length=0}return aN.length=0,s.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),r=e.background;if(r){const s=0===e.backgroundBlurriness&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&0===t.backgroundBlurriness;if(t.background!==r||s){const i=this.getCacheNode("background",r,()=>{if(!0===r.isCubeTexture||r.mapping===Z||r.mapping===J||r.mapping===he){if(e.backgroundBlurriness>0||r.mapping===he)return km(r);{let e;return e=!0===r.isCubeTexture?Hd(r):cl(r),$p(e)}}if(!0===r.isTexture)return cl(r,Nl.flipY()).setUpdateMatrix(!0);!0!==r.isColor&&console.error("WebGPUNodes: Unsupported background configuration.",r)},s);t.backgroundNode=i,t.background=r,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,r,s=!1){const i=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let n=i.get(t);return(void 0===n||s)&&(n=r(),i.set(t,n)),n}updateFog(e){const t=this.get(e),r=e.fog;if(r){if(t.fog!==r){const e=this.getCacheNode("fog",r,()=>{if(r.isFogExp2){const e=jd("color","color",r).setGroup(ia),t=jd("density","float",r).setGroup(ia);return yx(e,fx(t))}if(r.isFog){const e=jd("color","color",r).setGroup(ia),t=jd("near","float",r).setGroup(ia),s=jd("far","float",r).setGroup(ia);return yx(e,mx(t,s))}console.error("THREE.Renderer: Unsupported fog configuration.",r)});t.fogNode=e,t.fog=r}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),r=e.environment;if(r){if(t.environment!==r){const e=this.getCacheNode("environment",r,()=>!0===r.isCubeTexture?Hd(r):!0===r.isTexture?cl(r):void console.error("Nodes: Unsupported environment configuration.",r));t.environmentNode=e,t.environment=r}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,r=null,s=null,i=null){const n=this.nodeFrame;return n.renderer=e,n.scene=t,n.object=r,n.camera=s,n.material=i,n}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return nN.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,r=this.getOutputCacheKey(),s=e.isArrayTexture?Ab(e,dn(Nl,bl("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):cl(e,Nl).renderOutput(t.toneMapping,t.currentColorSpace);return nN.set(e,r),s}updateBefore(e){const t=e.getNodeBuilderState();for(const r of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(r)}updateAfter(e){const t=e.getNodeBuilderState();for(const r of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(r)}updateForCompute(e){const t=this.getNodeFrame(),r=this.getForCompute(e);for(const e of r.updateNodes)t.updateNode(e)}updateForRender(e){const t=this.getNodeFrameForRender(e),r=e.getNodeBuilderState();for(const e of r.updateNodes)t.updateNode(e)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new Vv,this.nodeBuilderCache=new Map,this.cacheLib={}}}const lN=new Me;class dN{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new n,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,null!==e&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,r){const s=e.length;for(let i=0;i<s;i++){lN.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const s=t[r+i],n=lN.normal;s.x=-n.x,s.y=-n.y,s.z=-n.z,s.w=lN.constant}}updateGlobal(e,t){this.shadowPass=null!==e.overrideMaterial&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let r=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const i=t.clippingPlanes,n=i.length;let a,o;if(this.clipIntersection?(a=this.intersectionPlanes,o=e.intersectionPlanes.length):(a=this.unionPlanes,o=e.unionPlanes.length),a.length!==o+n){a.length=o+n;for(let e=0;e<n;e++)a[o+e]=new s;r=!0}this.projectPlanes(i,a,o),r&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return void 0===t&&(t=new dN(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class cN{constructor(e,t){this.bundleGroup=e,this.camera=t}}const hN=[];class pN{constructor(){this.bundles=new Nf}get(e,t){const r=this.bundles;hN[0]=e,hN[1]=t;let s=r.get(hN);return void 0===s&&(s=new cN(e,t),r.set(hN,s)),hN.length=0,s}dispose(){this.bundles=new Nf}}class gN{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const r=this.getMaterialNodeClass(e.type);if(null!==r){t=new r;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,r){if(r.has(t))console.warn(`Redefinition of node ${t}`);else{if("function"!=typeof e)throw new Error(`Node class ${e.name} is not a class.`);if("function"==typeof t||"object"==typeof t)throw new Error(`Base class ${t} is not a class.`);r.set(t,e)}}addClass(e,t,r){if(r.has(t))console.warn(`Redefinition of node ${t.name}`);else{if("function"!=typeof e)throw new Error(`Node class ${e.name} is not a class.`);if("function"!=typeof t)throw new Error(`Base class ${t.name} is not a class.`);r.set(t,e)}}}const mN=new bT,fN=[];class yN extends Nf{constructor(){super()}createNode(e=[]){return(new bT).setLights(e)}getNode(e,t){if(e.isQuadMesh)return mN;fN[0]=e,fN[1]=t;let r=this.get(fN);return void 0===r&&(r=this.createNode(),this.set(fN,r)),fN.length=0,r}}class bN extends ue{constructor(e=1,t=1,r={}){super(e,t,r),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const xN=new r,TN=new r;class _N extends o{constructor(e,r=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new oe,this._cameraL.viewport=new s,this._cameraR=new oe,this._cameraR.viewport=new s,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new We,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding="undefined"!=typeof XRWebGLBinding,this._frameBufferTargets=null,this._createXRLayer=RN.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new t,this._onSessionEvent=NN.bind(this),this._onSessionEnd=SN.bind(this),this._onInputSourcesChange=EN.bind(this),this._onAnimationFrame=AN.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=r,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(null!==this._glProjLayer||null!==this._glBaseLayer)return this._foveation}setFoveation(e){this._foveation=e,null!==this._glProjLayer&&(this._glProjLayer.fixedFoveation=e),null!==this._glBaseLayer&&void 0!==this._glBaseLayer.fixedFoveation&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(null!==this._session)return this._session.environmentBlendMode}getBinding(){return null===this._glBinding&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,r,s,i,n,a,o={}){const u=new qe(e,t),l=new bN(i,n,{format:de,type:Ce,depthTexture:new V(i,n,o.stencil?we:T,void 0,void 0,void 0,void 0,void 0,void 0,o.stencil?Re:Ae),stencilBuffer:o.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});l._autoAllocateDepthBuffer=!0;const d=new se({color:16777215,side:je});d.map=l.texture,d.map.offset.y=1,d.map.repeat.y=-1;const c=new X(u,d);c.position.copy(r),c.quaternion.copy(s);const h={type:"quad",width:e,height:t,translation:r,quaternion:s,pixelwidth:i,pixelheight:n,plane:c,material:d,rendercall:a,renderTarget:l};if(this._layers.push(h),null!==this._session){h.plane.material=new se({color:16777215,side:je}),h.plane.material.blending=Xe,h.plane.material.blendEquation=Ke,h.plane.material.blendSrc=Ye,h.plane.material.blendDst=Ye,h.xrlayer=this._createXRLayer(h);const e=this._session.renderState.layers;e.unshift(h.xrlayer),this._session.updateRenderState({layers:e})}else l.isXRRenderTarget=!1;return c}createCylinderLayer(e,t,r,s,i,n,a,o,u={}){const l=new Qe(e,e,e*t/r,64,64,!0,Math.PI-t/2,t),d=new bN(n,a,{format:de,type:Ce,depthTexture:new V(n,a,u.stencil?we:T,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?Re:Ae),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});d._autoAllocateDepthBuffer=!0;const c=new se({color:16777215,side:S});c.map=d.texture,c.map.offset.y=1,c.map.repeat.y=-1;const h=new X(l,c);h.position.copy(s),h.quaternion.copy(i);const p={type:"cylinder",radius:e,centralAngle:t,aspectratio:r,translation:s,quaternion:i,pixelwidth:n,pixelheight:a,plane:h,material:c,rendercall:o,renderTarget:d};if(this._layers.push(p),null!==this._session){p.plane.material=new se({color:16777215,side:S}),p.plane.material.blending=Xe,p.plane.material.blendEquation=Ke,p.plane.material.blendSrc=Ye,p.plane.material.blendDst=Ye,p.xrlayer=this._createXRLayer(p);const e=this._session.renderState.layers;e.unshift(p.xrlayer),this._session.updateRenderState({layers:e})}else d.isXRRenderTarget=!1;return h}renderLayers(){const e=new r,s=new Ze,i=this._renderer,n=this.isPresenting,a=i.getOutputRenderTarget(),o=i._frameBufferTarget;this.isPresenting=!1;const u=new t;i.getSize(u);const l=i._quad;for(const t of this._layers)if(t.renderTarget.isXRRenderTarget=null!==this._session,t.renderTarget._hasExternalTextures=t.renderTarget.isXRRenderTarget,t.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){t.xrlayer.transform=new XRRigidTransform(t.plane.getWorldPosition(e),t.plane.getWorldQuaternion(s));const r=this._glBinding.getSubImage(t.xrlayer,this._xrFrame);i.backend.setXRRenderTargetTextures(t.renderTarget,r.colorTexture,void 0),i._setXRLayerSize(t.renderTarget.width,t.renderTarget.height),i.setOutputRenderTarget(t.renderTarget),i.setRenderTarget(null),i._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:n,quad:a}=this._frameBufferTargets.get(t.renderTarget)||{frameBufferTarget:null,quad:null};n?(i._frameBufferTarget=n,i._quad=a):(i._quad=new sb(new Sp),this._frameBufferTargets.set(t.renderTarget,{frameBufferTarget:i._getFrameBufferTarget(),quad:i._quad})),t.rendercall(),i._frameBufferTarget=null}else i.setRenderTarget(t.renderTarget),t.rendercall();i.setRenderTarget(null),i.setOutputRenderTarget(a),i._frameBufferTarget=o,i._setXRLayerSize(u.x,u.y),i._quad=l,this.isPresenting=n}getSession(){return this._session}async setSession(e){const t=this._renderer,r=t.backend;this._gl=t.getContext();const s=this._gl,i=s.getContextAttributes();if(this._session=e,null!==e){if(!0===r.isWebGPUBackend)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await r.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),!0===this._supportsLayers){let r=null,n=null,a=null;t.depth&&(a=t.stencil?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24,r=t.stencil?Re:Ae,n=t.stencil?we:T);const o={colorFormat:s.RGBA8,depthFormat:a,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(o.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();const u=this._glBinding.createProjectionLayer(o),l=[u];this._glProjLayer=u,t.setPixelRatio(1),t._setXRLayerSize(u.textureWidth,u.textureHeight);const d=this._useMultiview?2:1,c=new V(u.textureWidth,u.textureHeight,n,void 0,void 0,void 0,void 0,void 0,void 0,r,d);if(this._xrRenderTarget=new bN(u.textureWidth,u.textureHeight,{format:de,type:Ce,colorSpace:t.outputColorSpace,depthTexture:c,stencilBuffer:t.stencil,samples:i.antialias?4:0,resolveDepthBuffer:!1===u.ignoreDepthValues,resolveStencilBuffer:!1===u.ignoreDepthValues,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(const e of this._layers)e.plane.material=new se({color:16777215,side:"cylinder"===e.type?S:je}),e.plane.material.blending=Xe,e.plane.material.blendEquation=Ke,e.plane.material.blendSrc=Ye,e.plane.material.blendDst=Ye,e.xrlayer=this._createXRLayer(e),l.unshift(e.xrlayer);e.updateRenderState({layers:l})}else{const r={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},i=new XRWebGLLayer(e,s,r);this._glBaseLayer=i,e.updateRenderState({baseLayer:i}),t.setPixelRatio(1),t._setXRLayerSize(i.framebufferWidth,i.framebufferHeight),this._xrRenderTarget=new bN(i.framebufferWidth,i.framebufferHeight,{format:de,type:Ce,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:!1===i.ignoreDepthValues,resolveStencilBuffer:!1===i.ignoreDepthValues}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(null===t)return;const r=e.near,s=e.far,i=this._cameraXR,n=this._cameraL,a=this._cameraR;i.near=a.near=n.near=r,i.far=a.far=n.far=s,i.isMultiViewCamera=this._useMultiview,this._currentDepthNear===i.near&&this._currentDepthFar===i.far||(t.updateRenderState({depthNear:i.near,depthFar:i.far}),this._currentDepthNear=i.near,this._currentDepthFar=i.far),i.layers.mask=6|e.layers.mask,n.layers.mask=3&i.layers.mask,a.layers.mask=5&i.layers.mask;const o=e.parent,u=i.cameras;vN(i,o);for(let e=0;e<u.length;e++)vN(u[e],o);2===u.length?function(e,t,r){xN.setFromMatrixPosition(t.matrixWorld),TN.setFromMatrixPosition(r.matrixWorld);const s=xN.distanceTo(TN),i=t.projectionMatrix.elements,n=r.projectionMatrix.elements,a=i[14]/(i[10]-1),o=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],d=(i[8]-1)/i[0],c=(n[8]+1)/n[0],h=a*d,p=a*c,g=s/(-d+c),m=g*-d;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(g),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=a+g,r=o+g,i=h-m,n=p+(s-m),d=u*o/r*t,c=l*o/r*t;e.projectionMatrix.makePerspective(i,n,d,c,t,r),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(i,n,a):i.projectionMatrix.copy(n.projectionMatrix),function(e,t,r){null===r?e.matrix.copy(t.matrixWorld):(e.matrix.copy(r.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*et*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,i,o)}_getController(e){let t=this._controllers[e];return void 0===t&&(t=new Je,this._controllers[e]=t),t}}function vN(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}function NN(e){const t=this._controllerInputSources.indexOf(e.inputSource);if(-1===t)return;const r=this._controllers[t];if(void 0!==r){const t=this.getReferenceSpace();r.update(e.inputSource,e.frame,t),r.dispatchEvent({type:e.type,data:e.inputSource})}}function SN(){const e=this._session,t=this._renderer;e.removeEventListener("select",this._onSessionEvent),e.removeEventListener("selectstart",this._onSessionEvent),e.removeEventListener("selectend",this._onSessionEvent),e.removeEventListener("squeeze",this._onSessionEvent),e.removeEventListener("squeezestart",this._onSessionEvent),e.removeEventListener("squeezeend",this._onSessionEvent),e.removeEventListener("end",this._onSessionEnd),e.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let e=0;e<this._controllers.length;e++){const t=this._controllerInputSources[e];null!==t&&(this._controllerInputSources[e]=null,this._controllers[e].disconnect(t))}if(this._currentDepthNear=null,this._currentDepthFar=null,t._resetXRState(),this._session=null,this._xrRenderTarget=null,!0===this._sessionUsesLayers)for(const e of this._layers)e.renderTarget=new bN(e.pixelwidth,e.pixelheight,{format:de,type:Ce,depthTexture:new V(e.pixelwidth,e.pixelheight,e.stencilBuffer?we:T,void 0,void 0,void 0,void 0,void 0,void 0,e.stencilBuffer?Re:Ae),stencilBuffer:e.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),e.renderTarget.isXRRenderTarget=!1,e.plane.material=e.material,e.material.map=e.renderTarget.texture,e.material.map.offset.y=1,e.material.map.repeat.y=-1,delete e.xrlayer;this.isPresenting=!1,this._useMultiview=!1,t._animation.stop(),t._animation.setAnimationLoop(this._currentAnimationLoop),t._animation.setContext(this._currentAnimationContext),t._animation.start(),t.setPixelRatio(this._currentPixelRatio),t.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function EN(e){const t=this._controllers,r=this._controllerInputSources;for(let s=0;s<e.removed.length;s++){const i=e.removed[s],n=r.indexOf(i);n>=0&&(r[n]=null,t[n].disconnect(i))}for(let s=0;s<e.added.length;s++){const i=e.added[s];let n=r.indexOf(i);if(-1===n){for(let e=0;e<t.length;e++){if(e>=r.length){r.push(i),n=e;break}if(null===r[e]){r[e]=i,n=e;break}}if(-1===n)break}const a=t[n];a&&a.connect(i)}}function RN(e){return"quad"===e.type?this._glBinding.createQuadLayer({transform:new XRRigidTransform(e.translation,e.quaternion),width:e.width/2,height:e.height/2,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(e.translation,e.quaternion),radius:e.radius,centralAngle:e.centralAngle,aspectRatio:e.aspectRatio,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight,clearOnAccess:!1})}function AN(e,t){if(void 0===t)return;const r=this._cameraXR,i=this._renderer,n=i.backend,a=this._glBaseLayer,o=this.getReferenceSpace(),u=t.getViewerPose(o);if(this._xrFrame=t,null!==u){const e=u.views;null!==this._glBaseLayer&&n.setXRTarget(a.framebuffer);let t=!1;e.length!==r.cameras.length&&(r.cameras.length=0,t=!0);for(let i=0;i<e.length;i++){const o=e[i];let u;if(!0===this._supportsLayers){const e=this._glBinding.getViewSubImage(this._glProjLayer,o);u=e.viewport,0===i&&n.setXRRenderTargetTextures(this._xrRenderTarget,e.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:e.depthStencilTexture)}else u=a.getViewport(o);let l=this._cameras[i];void 0===l&&(l=new oe,l.layers.enable(i),l.viewport=new s,this._cameras[i]=l),l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.quaternion,l.scale),l.projectionMatrix.fromArray(o.projectionMatrix),l.projectionMatrixInverse.copy(l.projectionMatrix).invert(),l.viewport.set(u.x,u.y,u.width,u.height),0===i&&(r.matrix.copy(l.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),!0===t&&r.cameras.push(l)}i.setOutputRenderTarget(this._xrRenderTarget)}for(let e=0;e<this._controllers.length;e++){const r=this._controllerInputSources[e],s=this._controllers[e];null!==r&&void 0!==s&&s.update(r,t,o)}this._currentAnimationLoop&&this._currentAnimationLoop(e,t),t.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:t}),this._xrFrame=null}const wN=new K,CN=new t,MN=new s,PN=new st,BN=new rt,LN=new a,FN=new s;class IN{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:r=!1,alpha:i=!0,depth:n=!0,stencil:a=!1,antialias:o=!1,samples:u=0,getFallback:l=null,colorBufferType:d=ce,multiview:c=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=u||!0===o?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=i,this.logarithmicDepthBuffer=r,this.outputColorSpace=W,this.toneMapping=p,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=n,this.stencil=a,this.info=new Vf,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new gN,this.lighting=new yN,this._getFallback=l,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new s(0,0,this._width,this._height),this._scissor=new s(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new sb(new Sp),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const h=!0===this.alpha?0:1;this._clearColor=new oy(0,0,0,h),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=d,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:tt},this.xr=new _N(this,c),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(e,t,r)=>{await this.compileAsync(e,t);const s=this._renderLists.get(e,t),i=this._renderContexts.get(e,t,this._renderTarget),n=e.overrideMaterial||r.material,a=this._objects.get(r,n,e,t,s.lightsNode,i,i.clippingContext),{fragmentShader:o,vertexShader:u}=a.getNodeBuilderState();return{fragmentShader:o,vertexShader:u}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return null!==this._initPromise||(this._initPromise=new Promise(async(e,t)=>{let r=this.backend;try{await r.init(this)}catch(e){if(null===this._getFallback)return void t(e);try{this.backend=r=this._getFallback(e),await r.init(this)}catch(e){return void t(e)}}this._nodes=new uN(this,r),this._animation=new vf(this._nodes,this.info),this._attributes=new Ff(r),this._background=new nv(this,this._nodes),this._geometries=new Uf(this._attributes,this.info),this._textures=new ay(this,r,this.info),this._pipelines=new Hf(r,this._nodes),this._bindings=new Wf(r,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new Af(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new Qf(this.lighting),this._bundles=new pN,this._renderContexts=new iy,this._animation.start(),this._initialized=!0,e(this)})),this._initPromise}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,r=null){if(!0===this._isDeviceLost)return;!1===this._initialized&&await this.init();const s=this._nodes.nodeFrame,i=s.renderId,n=this._currentRenderContext,a=this._currentRenderObjectFunction,o=this._compilationPromises,u=!0===e.isScene?e:wN;null===r&&(r=e);const l=this._renderTarget,d=this._renderContexts.get(r,t,l),c=this._activeMipmapLevel,h=[];this._currentRenderContext=d,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=h,s.renderId++,s.update(),d.depth=this.depth,d.stencil=this.stencil,d.clippingContext||(d.clippingContext=new dN),d.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,l);const p=this._renderLists.get(e,t);if(p.begin(),this._projectObject(e,t,0,p,d.clippingContext),r!==e&&r.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&p.pushLight(e)}),p.finish(),null!==l){this._textures.updateRenderTarget(l,c);const e=this._textures.get(l);d.textures=e.textures,d.depthTexture=e.depthTexture}else d.textures=null,d.depthTexture=null;this._background.update(u,p,d);const g=p.opaque,m=p.transparent,f=p.transparentDoublePass,y=p.lightsNode;!0===this.opaque&&g.length>0&&this._renderObjects(g,t,u,y),!0===this.transparent&&m.length>0&&this._renderTransparents(m,f,t,u,y),s.renderId=i,this._currentRenderContext=n,this._currentRenderObjectFunction=a,this._compilationPromises=o,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(h)}async renderAsync(e,t){!1===this._initialized&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){!0===e?(this.overrideNodes.modelViewMatrix=ad,this.overrideNodes.modelNormalViewMatrix=od):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===ad&&this.overrideNodes.modelNormalViewMatrix===od}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:\n\nMessage: ${e.message}`;e.reason&&(t+=`\nReason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,r){const{bundleGroup:s,camera:i,renderList:n}=e,a=this._currentRenderContext,o=this._bundles.get(s,i),u=this.backend.get(o);void 0===u.renderContexts&&(u.renderContexts=new Set);const l=s.version!==u.version,d=!1===u.renderContexts.has(a)||l;if(u.renderContexts.add(a),d){this.backend.beginBundle(a),(void 0===u.renderObjects||l)&&(u.renderObjects=[]),this._currentRenderBundle=o;const{transparentDoublePass:e,transparent:d,opaque:c}=n;!0===this.opaque&&c.length>0&&this._renderObjects(c,i,t,r),!0===this.transparent&&d.length>0&&this._renderTransparents(d,e,i,t,r),this._currentRenderBundle=null,this.backend.finishBundle(a,o),u.version=s.version}else{const{renderObjects:e}=u;for(let t=0,r=e.length;t<r;t++){const r=e[t];this._nodes.needsRefresh(r)&&(this._nodes.updateBefore(r),this._nodes.updateForRender(r),this._bindings.updateForRender(r),this._nodes.updateAfter(r))}}this.backend.addBundle(a,o)}render(e,t){if(!1===this._initialized)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this,r=e!==p,s=t!==c.workingColorSpace;if(!1===r&&!1===s)return null;const{width:i,height:n}=this.getDrawingBufferSize(CN),{depth:a,stencil:o}=this;let u=this._frameBufferTarget;null===u&&(u=new ue(i,n,{depthBuffer:a,stencilBuffer:o,type:this._colorBufferType,format:de,colorSpace:c.workingColorSpace,generateMipmaps:!1,minFilter:Y,magFilter:Y,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const l=this.getOutputRenderTarget();return u.depthBuffer=a,u.stencilBuffer=o,null!==l?u.setSize(l.width,l.height,l.depth):u.setSize(i,n,1),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u.multiview=null!==l&&l.multiview,u.resolveDepthBuffer=null===l||l.resolveDepthBuffer,u._autoAllocateDepthBuffer=null!==l&&l._autoAllocateDepthBuffer,u}_renderScene(e,t,r=!0){if(!0===this._isDeviceLost)return;const s=r?this._getFrameBufferTarget():null,i=this._nodes.nodeFrame,n=i.renderId,a=this._currentRenderContext,o=this._currentRenderObjectFunction,u=!0===e.isScene?e:wN,l=this._renderTarget||this._outputRenderTarget,d=this._activeCubeFace,c=this._activeMipmapLevel;let h;null!==s?(h=s,this.setRenderTarget(h)):h=l;const p=this._renderContexts.get(e,t,h);this._currentRenderContext=p,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,i.renderId=this.info.calls;const g=this.coordinateSystem,m=this.xr;if(t.coordinateSystem!==g&&!1===m.isPresenting&&(t.coordinateSystem=g,t.updateProjectionMatrix(),t.isArrayCamera))for(const e of t.cameras)e.coordinateSystem=g,e.updateProjectionMatrix();!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===m.enabled&&!0===m.isPresenting&&(!0===m.cameraAutoUpdate&&m.updateCamera(t),t=m.getCamera());let f=this._viewport,y=this._scissor,b=this._pixelRatio;null!==h&&(f=h.viewport,y=h.scissor,b=1),this.getDrawingBufferSize(CN),MN.set(0,0,CN.width,CN.height);const x=void 0===f.minDepth?0:f.minDepth,T=void 0===f.maxDepth?1:f.maxDepth;p.viewportValue.copy(f).multiplyScalar(b).floor(),p.viewportValue.width>>=c,p.viewportValue.height>>=c,p.viewportValue.minDepth=x,p.viewportValue.maxDepth=T,p.viewport=!1===p.viewportValue.equals(MN),p.scissorValue.copy(y).multiplyScalar(b).floor(),p.scissor=this._scissorTest&&!1===p.scissorValue.equals(MN),p.scissorValue.width>>=c,p.scissorValue.height>>=c,p.clippingContext||(p.clippingContext=new dN),p.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,h);const _=t.isArrayCamera?BN:PN;t.isArrayCamera||(LN.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),_.setFromProjectionMatrix(LN,t.coordinateSystem,t.reversedDepth));const v=this._renderLists.get(e,t);if(v.begin(),this._projectObject(e,t,0,v,p.clippingContext),v.finish(),!0===this.sortObjects&&v.sort(this._opaqueSort,this._transparentSort),null!==h){this._textures.updateRenderTarget(h,c);const e=this._textures.get(h);p.textures=e.textures,p.depthTexture=e.depthTexture,p.width=e.width,p.height=e.height,p.renderTarget=h,p.depth=h.depthBuffer,p.stencil=h.stencilBuffer}else p.textures=null,p.depthTexture=null,p.width=CN.width,p.height=CN.height,p.depth=this.depth,p.stencil=this.stencil;p.width>>=c,p.height>>=c,p.activeCubeFace=d,p.activeMipmapLevel=c,p.occlusionQueryCount=v.occlusionQueryCount,p.scissorValue.max(FN.set(0,0,0,0)),p.scissorValue.x+p.scissorValue.width>p.width&&(p.scissorValue.width=Math.max(p.width-p.scissorValue.x,0)),p.scissorValue.y+p.scissorValue.height>p.height&&(p.scissorValue.height=Math.max(p.height-p.scissorValue.y,0)),this._background.update(u,v,p),p.camera=t,this.backend.beginRender(p);const{bundles:N,lightsNode:S,transparentDoublePass:E,transparent:R,opaque:A}=v;return N.length>0&&this._renderBundles(N,u,S),!0===this.opaque&&A.length>0&&this._renderObjects(A,t,u,S),!0===this.transparent&&R.length>0&&this._renderTransparents(R,E,t,u,S),this.backend.finishRender(p),i.renderId=n,this._currentRenderContext=a,this._currentRenderObjectFunction=o,null!==s&&(this.setRenderTarget(l,d,c),this._renderOutput(h)),u.onAfterRender(this,e,t,h),p}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const r=this.autoClear,s=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=r,this.xr.enabled=s}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){!1===this._initialized&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,r){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=r,this.domElement.width=Math.floor(e*r),this.domElement.height=Math.floor(t*r),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,r=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),!0===r&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,r,s){const i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,r,s)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,r,s,i=0,n=1){const a=this._viewport;e.isVector4?a.copy(e):a.set(e,t,r,s),a.minDepth=i,a.maxDepth=n}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,r=!0){if(!1===this._initialized)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,r);const s=this._renderTarget||this._getFrameBufferTarget();let i=null;if(null!==s){this._textures.updateRenderTarget(s);const e=this._textures.get(s);i=this._renderContexts.getForClear(s),i.textures=e.textures,i.depthTexture=e.depthTexture,i.width=e.width,i.height=e.height,i.renderTarget=s,i.depth=s.depthBuffer,i.stencil=s.stencilBuffer,i.clearColorValue=this.backend.getClearColor(),i.activeCubeFace=this.getActiveCubeFace(),i.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,r,i),null!==s&&null===this._renderTarget&&this._renderOutput(s)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,r=!0){!1===this._initialized&&await this.init(),this.clear(e,t,r)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:p}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:c.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||null===this._renderTarget}dispose(){!0===this._initialized&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),null!==this._frameBufferTarget&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{null!==e&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,r=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=r}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e,t=null){if(!0===this._isDeviceLost)return;if(!1===this._initialized)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const r=this._nodes.nodeFrame,s=r.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,r.renderId=this.info.calls;const i=this.backend,n=this._pipelines,a=this._bindings,o=this._nodes,u=Array.isArray(e)?e:[e];if(void 0===u[0]||!0!==u[0].isComputeNode)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");i.beginCompute(e);for(const r of u){if(!1===n.has(r)){const e=()=>{r.removeEventListener("dispose",e),n.delete(r),a.delete(r),o.delete(r)};r.addEventListener("dispose",e);const t=r.onInitFunction;null!==t&&t.call(r,{renderer:this})}o.updateForCompute(r),a.updateForCompute(r);const s=a.getForCompute(r),u=n.getForCompute(r,s);i.compute(e,r,s,u,t)}i.finishCompute(e),r.renderId=s}async computeAsync(e,t=null){!1===this._initialized&&await this.init(),this.compute(e,t)}async hasFeatureAsync(e){return!1===this._initialized&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return!1===this._initialized&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return!1===this._initialized?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){!1===this._initialized&&await this.init(),this._textures.updateTexture(e)}initTexture(e){!1===this._initialized&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(null!==t)if(t.isVector2)t=FN.set(t.x,t.y,e.image.width,e.image.height).floor();else{if(!t.isVector4)return void console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");t=FN.copy(t).floor()}else t=FN.set(0,0,e.image.width,e.image.height);let r,s=this._currentRenderContext;null!==s?r=s.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),null!==r&&(this._textures.updateRenderTarget(r),s=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,s,t)}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,r,s,i,n)}async readRenderTargetPixelsAsync(e,t,r,s,i,n=0,a=0){return this.backend.copyTextureToBuffer(e.textures[n],t,r,s,i,a)}_projectObject(e,t,r,s,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)r=e.renderOrder,e.isClippingGroup&&e.enabled&&(i=i.getGroupContext(e));else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)s.pushLight(e);else if(e.isSprite){const n=t.isArrayCamera?BN:PN;if(!e.frustumCulled||n.intersectsSprite(e,t)){!0===this.sortObjects&&FN.setFromMatrixPosition(e.matrixWorld).applyMatrix4(LN);const{geometry:t,material:n}=e;n.visible&&s.push(e,t,n,r,FN.z,null,i)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const n=t.isArrayCamera?BN:PN;if(!e.frustumCulled||n.intersectsObject(e,t)){const{geometry:t,material:n}=e;if(!0===this.sortObjects&&(null===t.boundingSphere&&t.computeBoundingSphere(),FN.copy(t.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(LN)),Array.isArray(n)){const a=t.groups;for(let o=0,u=a.length;o<u;o++){const u=a[o],l=n[u.materialIndex];l&&l.visible&&s.push(e,t,l,r,FN.z,u,i)}}else n.visible&&s.push(e,t,n,r,FN.z,null,i)}}if(!0===e.isBundleGroup&&void 0!==this.backend.beginBundle){const r=s;(s=this._renderLists.get(e,t)).begin(),r.pushBundle({bundleGroup:e,camera:t,renderList:s}),s.finish()}const n=e.children;for(let e=0,a=n.length;e<a;e++)this._projectObject(n[e],t,r,s,i)}_renderBundles(e,t,r){for(const s of e)this._renderBundle(s,t,r)}_renderTransparents(e,t,r,s,i){if(t.length>0){for(const{material:e}of t)e.side=S;this._renderObjects(t,r,s,i,"backSide");for(const{material:e}of t)e.side=je;this._renderObjects(e,r,s,i);for(const{material:e}of t)e.side=E}else this._renderObjects(e,r,s,i)}_renderObjects(e,t,r,s,i=null){for(let n=0,a=e.length;n<a;n++){const{object:a,geometry:o,material:u,group:l,clippingContext:d}=e[n];this._currentRenderObjectFunction(a,r,t,o,u,l,s,d,i)}}renderObject(e,t,r,s,i,n,a,o=null,u=null){let l,d,c;if(e.onBeforeRender(this,t,r,s,i,n),!0===i.allowOverride&&null!==t.overrideMaterial){const e=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(l=e.positionNode,e.positionNode=i.positionNode),e.alphaTest=i.alphaTest,e.alphaMap=i.alphaMap,e.transparent=i.transparent||i.transmission>0,e.isShadowPassMaterial&&(e.side=null===i.shadowSide?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(c=e.depthNode,e.depthNode=i.depthNode),i.castShadowNode&&i.castShadowNode.isNode&&(d=e.colorNode,e.colorNode=i.castShadowNode),i.castShadowPositionNode&&i.castShadowPositionNode.isNode&&(l=e.positionNode,e.positionNode=i.castShadowPositionNode)),i=e}!0===i.transparent&&i.side===E&&!1===i.forceSinglePass?(i.side=S,this._handleObjectFunction(e,i,t,r,a,n,o,"backSide"),i.side=je,this._handleObjectFunction(e,i,t,r,a,n,o,u),i.side=E):this._handleObjectFunction(e,i,t,r,a,n,o,u),void 0!==l&&(t.overrideMaterial.positionNode=l),void 0!==c&&(t.overrideMaterial.depthNode=c),void 0!==d&&(t.overrideMaterial.colorNode=d),e.onAfterRender(this,t,r,s,i,n)}_renderObjectDirect(e,t,r,s,i,n,a,o){const u=this._objects.get(e,t,r,s,i,this._currentRenderContext,a,o);u.drawRange=e.geometry.drawRange,u.group=n;const l=this._nodes.needsRefresh(u);if(l&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),null!==this._currentRenderBundle){this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup}this.backend.draw(u,this.info),l&&this._nodes.updateAfter(u)}_createObjectPipeline(e,t,r,s,i,n,a,o){const u=this._objects.get(e,t,r,s,i,this._currentRenderContext,a,o);u.drawRange=e.geometry.drawRange,u.group=n,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class DN{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}class UN extends DN{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return(e=this._buffer.byteLength)+(Lf-e%Lf)%Lf;var e}get buffer(){return this._buffer}update(){return!0}}class VN extends UN{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let ON=0;class GN extends VN{constructor(e,t){super("UniformBuffer_"+ON++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class kN extends VN{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}get values(){return null===this._values&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(null===e){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let r=0,s=this.uniforms.length;r<s;r++){const s=this.uniforms[r],i=s.boundary,n=s.itemSize*e,a=t%Lf,o=a%i,u=a+o;t+=o,0!==u&&Lf-u<n&&(t+=Lf-u),s.offset=t/e,t+=n}return Math.ceil(t/Lf)*Lf}update(){let e=!1;for(const t of this.uniforms)!0===this.updateByType(t)&&(e=!0);return e}updateByType(e){return e.isNumberUniform?this.updateNumber(e):e.isVector2Uniform?this.updateVector2(e):e.isVector3Uniform?this.updateVector3(e):e.isVector4Uniform?this.updateVector4(e):e.isColorUniform?this.updateColor(e):e.isMatrix3Uniform?this.updateMatrix3(e):e.isMatrix4Uniform?this.updateMatrix4(e):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i]!==s){this._getBufferForType(n)[i]=r[i]=s,t=!0}return t}updateVector2(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i+0]!==s.x||r[i+1]!==s.y){const e=this._getBufferForType(n);e[i+0]=r[i+0]=s.x,e[i+1]=r[i+1]=s.y,t=!0}return t}updateVector3(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i+0]!==s.x||r[i+1]!==s.y||r[i+2]!==s.z){const e=this._getBufferForType(n);e[i+0]=r[i+0]=s.x,e[i+1]=r[i+1]=s.y,e[i+2]=r[i+2]=s.z,t=!0}return t}updateVector4(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i+0]!==s.x||r[i+1]!==s.y||r[i+2]!==s.z||r[i+4]!==s.w){const e=this._getBufferForType(n);e[i+0]=r[i+0]=s.x,e[i+1]=r[i+1]=s.y,e[i+2]=r[i+2]=s.z,e[i+3]=r[i+3]=s.w,t=!0}return t}updateColor(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset;if(r[i+0]!==s.r||r[i+1]!==s.g||r[i+2]!==s.b){const e=this.buffer;e[i+0]=r[i+0]=s.r,e[i+1]=r[i+1]=s.g,e[i+2]=r[i+2]=s.b,t=!0}return t}updateMatrix3(e){let t=!1;const r=this.values,s=e.getValue().elements,i=e.offset;if(r[i+0]!==s[0]||r[i+1]!==s[1]||r[i+2]!==s[2]||r[i+4]!==s[3]||r[i+5]!==s[4]||r[i+6]!==s[5]||r[i+8]!==s[6]||r[i+9]!==s[7]||r[i+10]!==s[8]){const e=this.buffer;e[i+0]=r[i+0]=s[0],e[i+1]=r[i+1]=s[1],e[i+2]=r[i+2]=s[2],e[i+4]=r[i+4]=s[3],e[i+5]=r[i+5]=s[4],e[i+6]=r[i+6]=s[5],e[i+8]=r[i+8]=s[6],e[i+9]=r[i+9]=s[7],e[i+10]=r[i+10]=s[8],t=!0}return t}updateMatrix4(e){let t=!1;const r=this.values,s=e.getValue().elements,i=e.offset;if(!1===function(e,t,r){for(let s=0,i=t.length;s<i;s++)if(e[r+s]!==t[s])return!1;return!0}(r,s,i)){this.buffer.set(s,i),function(e,t,r){for(let s=0,i=t.length;s<i;s++)e[r+s]=t[s]}(r,s,i),t=!0}return t}_getBufferForType(e){return"int"===e||"ivec2"===e||"ivec3"===e||"ivec4"===e?new Int32Array(this.buffer.buffer):"uint"===e||"uvec2"===e||"uvec3"===e||"uvec4"===e?new Uint32Array(this.buffer.buffer):this.buffer}}let zN=0;class $N extends kN{constructor(e,t){super(e),this.id=zN++,this.groupNode=t,this.isNodeUniformsGroup=!0}}class HN extends DN{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.generation=null,this.isSampler=!0}set texture(e){if(this._texture===e)return;const t=()=>{this._texture=null,this.generation=null,this.version=0};this._texture&&this._texture.removeEventListener("dispose",t),this._texture=e,this.generation=null,this.version=0,this._texture&&this._texture.addEventListener("dispose",t)}get texture(){return this._texture}update(){const{texture:e,version:t}=this;return t!==e.version&&(this.version=e.version,!0)}clone(){const e=super.clone();return e._texture=null,e.texture=this.texture,e}}let WN=0;class qN extends HN{constructor(e,t){super(e,t),this.id=WN++,this.store=!1,this.isSampledTexture=!0}}class jN extends qN{constructor(e,t,r,s=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r,this.access=s}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class XN extends jN{constructor(e,t,r,s=null){super(e,t,r,s),this.isSampledCubeTexture=!0}}class KN extends jN{constructor(e,t,r,s=null){super(e,t,r,s),this.isSampledTexture3D=!0}}const YN={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint"},QN={low:"lowp",medium:"mediump",high:"highp"},ZN={swizzleAssign:!0,storageBuffer:!1},JN={perspective:"smooth",linear:"noperspective"},eS={centroid:"centroid"},tS="\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\nprecision lowp sampler2DArrayShadow;\nprecision lowp samplerCubeShadow;\n";class rS extends Uv{constructor(e,t){super(e,t,new iN),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return!0===e.isVideoTexture&&e.colorSpace!==b}getMethod(e){return YN[e]||e}getBitcastMethod(e,t){return YN[`bitcast_${t}_${e}`]}getTernary(e,t,r){return`${e} ? ${t} : ${r}`}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,r=this.flowShaderNode(e),s=[];for(const e of t.inputs)s.push(this.getType(e.type)+" "+e.name);return`${this.getType(t.type)} ${t.name}( ${s.join(", ")} ) {\n\n\t${r.vars}\n\n${r.code}\n\treturn ${r.result};\n\n}`}setupPBO(e){const t=e.value;if(void 0===t.pbo){const e=t.array,r=t.count*t.itemSize,{itemSize:s}=t,i=t.array.constructor.name.toLowerCase().includes("int");let n=i?nt:at;2===s?n=i?dt:Ve:3===s?n=i?ct:ht:4===s&&(n=i?pt:de);const a={Float32Array:I,Uint8Array:Ce,Uint16Array:lt,Uint32Array:T,Int8Array:ut,Int16Array:ot,Int32Array:_,Uint8ClampedArray:Ce},o=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let u=Math.ceil(r/s/o);o*u*s<r&&u++;const l=o*u*s,d=new e.constructor(l);d.set(e,0),t.array=d;const c=new it(t.array,o,u,n,a[t.array.constructor.name]||I);c.needsUpdate=!0,c.isPBOTexture=!0;const h=new ll(c,null,null);h.setPrecision("high"),t.pboNode=h,t.pbo=h.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&!0!==e.node.isTextureNode&&!0!==e.node.isBufferNode?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:r}=e,s=t.value;if(this.renderer.backend.has(s)){this.renderer.backend.get(s).pbo=s.pbo}const i=this.getUniformFromNode(s.pboNode,"texture",this.shaderStage,this.context.nodeName),n=this.getPropertyName(i);this.increaseUsage(r);const a=r.build(this,"uint"),o=this.getDataFromNode(e);let u=o.propertyName;if(void 0===u){const r=this.getVarFromNode(e);u=this.getPropertyName(r);const i=this.getDataFromNode(t);let l=i.propertySizeName;void 0===l&&(l=u+"Size",this.getVarFromNode(t,l,"uint"),this.addLineFlowCode(`${l} = uint( textureSize( ${n}, 0 ).x )`,e),i.propertySizeName=l);const{itemSize:d}=s,c="."+js.join("").slice(0,d),h=`ivec2(${a} % ${l}, ${a} / ${l})`,p=this.generateTextureLoad(null,n,h,null,null,"0");let g="vec4";s.pbo.type===T?g="uvec4":s.pbo.type===_&&(g="ivec4"),this.addLineFlowCode(`${u} = ${g}(${p})${c}`,e),o.propertyName=u}return u}generateTextureLoad(e,t,r,s,i,n="0"){let a;return a=s?i?`texelFetchOffset( ${t}, ivec3( ${r}, ${s} ), ${n}, ${i} )`:`texelFetch( ${t}, ivec3( ${r}, ${s} ), ${n} )`:i?`texelFetchOffset( ${t}, ${r}, ${n}, ${i} )`:`texelFetch( ${t}, ${r}, ${n} )`,null!==e&&e.isDepthTexture&&(a+=".x"),a}generateTexture(e,t,r,s,i){return s&&(r=`vec3( ${r}, ${s} )`),e.isDepthTexture?i?`textureOffset( ${t}, ${r}, ${i} ).x`:`texture( ${t}, ${r} ).x`:i?`textureOffset( ${t}, ${r}, ${i} )`:`texture( ${t}, ${r} )`}generateTextureLevel(e,t,r,s,i){return i?`textureLodOffset( ${t}, ${r}, ${s}, ${i} )`:`textureLod( ${t}, ${r}, ${s} )`}generateTextureBias(e,t,r,s,i){return i?`textureOffset( ${t}, ${r}, ${i}, ${s} )`:`texture( ${t}, ${r}, ${s} )`}generateTextureGrad(e,t,r,s,i){return i?`textureGradOffset( ${t}, ${r}, ${s[0]}, ${s[1]}, ${i} )`:`textureGrad( ${t}, ${r}, ${s[0]}, ${s[1]} )`}generateTextureCompare(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return i?n?`textureOffset( ${t}, vec4( ${r}, ${i}, ${s} ), ${n} )`:`texture( ${t}, vec4( ${r}, ${i}, ${s} ) )`:n?`textureOffset( ${t}, vec3( ${r}, ${s} ), ${n} )`:`texture( ${t}, vec3( ${r}, ${s} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}getVars(e){const t=[],r=this.vars[e];if(void 0!==r)for(const e of r)t.push(`${this.getVar(e.type,e.name,e.count)};`);return t.join("\n\t")}getUniforms(e){const t=this.uniforms[e],r=[],s={};for(const i of t){let t=null,n=!1;if("texture"===i.type||"texture3D"===i.type){const e=i.node.value;let r="";!0!==e.isDataTexture&&!0!==e.isData3DTexture||(e.type===T?r="u":e.type===_&&(r="i")),t="texture3D"===i.type&&!1===e.isArrayTexture?`${r}sampler3D ${i.name};`:e.compareFunction?!0===e.isArrayTexture?`sampler2DArrayShadow ${i.name};`:`sampler2DShadow ${i.name};`:!0===e.isArrayTexture||!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?`${r}sampler2DArray ${i.name};`:`${r}sampler2D ${i.name};`}else if("cubeTexture"===i.type)t=`samplerCube ${i.name};`;else if("buffer"===i.type){const e=i.node,r=this.getType(e.bufferType),s=e.bufferCount,n=s>0?s:"";t=`${e.name} {\n\t${r} ${i.name}[${n}];\n};\n`}else{t=`${this.getVectorType(i.type)} ${this.getPropertyName(i,e)};`,n=!0}const a=i.node.precision;if(null!==a&&(t=QN[a]+" "+t),n){t="\t"+t;const e=i.groupNode.name;(s[e]||(s[e]=[])).push(t)}else t="uniform "+t,r.push(t)}let i="";for(const t in s){const r=s[t];i+=this._getGLSLUniformStruct(e+"_"+t,r.join("\n"))+"\n"}return i+=r.join("\n"),i}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==_){let r=e;e.isInterleavedBufferAttribute&&(r=e.data);const s=r.array;!1==(s instanceof Uint32Array||s instanceof Int32Array)&&(t=t.slice(1))}return t}getAttributes(e){let t="";if("vertex"===e||"compute"===e){const e=this.getAttributesArray();let r=0;for(const s of e)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};\n`}return t}getStructMembers(e){const t=[];for(const r of e.members)t.push(`\t${r.type} ${r.name};`);return t.join("\n")}getStructs(e){const t=[],r=this.structs[e],s=[];for(const e of r)if(e.output)for(const t of e.members)s.push(`layout( location = ${t.index} ) out ${t.type} ${t.name};`);else{let r="struct "+e.name+" {\n";r+=this.getStructMembers(e),r+="\n};\n",t.push(r)}return 0===s.length&&s.push("layout( location = 0 ) out vec4 fragColor;"),"\n"+s.join("\n")+"\n\n"+t.join("\n")}getVaryings(e){let t="";const r=this.varyings;if("vertex"===e||"compute"===e)for(const s of r){"compute"===e&&(s.needsInterpolation=!0);const r=this.getType(s.type);if(s.needsInterpolation)if(s.interpolationType){t+=`${JN[s.interpolationType]||s.interpolationType} ${eS[s.interpolationSampling]||""} out ${r} ${s.name};\n`}else{t+=`${r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":""}out ${r} ${s.name};\n`}else t+=`${r} ${s.name};\n`}else if("fragment"===e)for(const e of r)if(e.needsInterpolation){const r=this.getType(e.type);if(e.interpolationType){t+=`${JN[e.interpolationType]||e.interpolationType} ${eS[e.interpolationSampling]||""} in ${r} ${e.name};\n`}else{t+=`${r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":""}in ${r} ${e.name};\n`}}for(const r of this.builtins[e])t+=`${r};\n`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((e,t)=>e*t,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,r=this.shaderStage){const s=this.extensions[r]||(this.extensions[r]=new Map);!1===s.has(e)&&s.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if("vertex"===e){const t=this.renderer.backend.extensions;this.object.isBatchedMesh&&t.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const r=this.extensions[e];if(void 0!==r)for(const{name:e,behavior:s}of r.values())t.push(`#extension ${e} : ${s}`);return t.join("\n")}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=ZN[e];if(void 0===t){let r;switch(t=!1,e){case"float32Filterable":r="OES_texture_float_linear";break;case"clipDistance":r="WEBGL_clip_cull_distance"}if(void 0!==r){const e=this.renderer.backend.extensions;e.has(r)&&(e.get(r),t=!0)}ZN[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let r=0;r<e.length;r++){const s=e[r],i=this.getPropertyName(s.attributeNode);i&&(t+=`${s.varyingName} = ${i};\n\t`)}return t}_getGLSLUniformStruct(e,t){return`\nlayout( std140 ) uniform ${e} {\n${t}\n};`}_getGLSLVertexCode(e){return`#version 300 es\n\n${this.getSignature()}\n\n// extensions\n${e.extensions}\n\n// precision\n${tS}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\n\n// attributes\n${e.attributes}\n\n// codes\n${e.codes}\n\nvoid main() {\n\n\t// vars\n\t${e.vars}\n\n\t// transforms\n\t${e.transforms}\n\n\t// flow\n\t${e.flow}\n\n\tgl_PointSize = 1.0;\n\n}\n`}_getGLSLFragmentCode(e){return`#version 300 es\n\n${this.getSignature()}\n\n// extensions\n${e.extensions}\n\n// precision\n${tS}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\n\n// codes\n${e.codes}\n\n// structs\n${e.structs}\n\nvoid main() {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let r="// code\n\n";r+=this.flowCode[t];const s=this.flowNodes[t],i=s[s.length-1];for(const e of s){const s=this.getFlowData(e),n=e.name;n&&(r.length>0&&(r+="\n"),r+=`\t// flow -> ${n}\n\t`),r+=`${s.code}\n\t`,e===i&&"compute"!==t&&(r+="// result\n\t","vertex"===t?(r+="gl_Position = ",r+=`${s.result};`):"fragment"===t&&(e.outputNode.isOutputStructNode||(r+="fragColor = ",r+=`${s.result};`)))}const n=e[t];n.extensions=this.getExtensions(t),n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.vars=this.getVars(t),n.structs=this.getStructs(t),n.codes=this.getCodes(t),n.transforms=this.getTransforms(t),n.flow=r}null!==this.material?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,r,s=null){const i=super.getUniformFromNode(e,t,r,s),n=this.getDataFromNode(e,r,this.globalCache);let a=n.uniformGPU;if(void 0===a){const s=e.groupNode,o=s.name,u=this.getBindGroupArray(o,r);if("texture"===t)a=new jN(i.name,i.node,s),u.push(a);else if("cubeTexture"===t)a=new XN(i.name,i.node,s),u.push(a);else if("texture3D"===t)a=new KN(i.name,i.node,s),u.push(a);else if("buffer"===t){e.name=`NodeBuffer_${e.id}`,i.name=`buffer${e.id}`;const t=new GN(e,s);t.name=e.name,u.push(t),a=t}else{const e=this.uniformGroups[r]||(this.uniformGroups[r]={});let n=e[o];void 0===n&&(n=new $N(r+"_"+o,s),e[o]=n,u.push(n)),a=this.getNodeUniform(i,t),n.addUniform(a)}n.uniformGPU=a}return i}}let sS=null,iS=null;class nS{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=!0===e.trackTimestamp}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}getTimestampUID(e){const t=this.get(e);let r=!0===e.isComputeNode?"c":"r";return r+=":"+t.frameCalls+":"+e.id,r}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp)return void Be("WebGPURenderer: Timestamp tracking is disabled.");const t=this.timestampQueryPool[e];if(!t)return void Be(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);const r=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=r,r}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return sS=sS||new t,this.renderer.getDrawingBufferSize(sS)}setScissorTest(){}getClearColor(){const e=this.renderer;return iS=iS||new oy,e.getClearColor(iS),iS.getRGB(iS),iS}getDomElement(){let e=this.domElement;return null===e&&(e=void 0!==this.parameters.canvas?this.parameters.canvas:gt(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${He} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let aS,oS,uS=0;class lS{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[1^this.activeBufferIndex]}switchBuffers(){this.activeBufferIndex^=1}}class dS{constructor(e){this.backend=e}createAttribute(e,t){const r=this.backend,{gl:s}=r,i=e.array,n=e.usage||s.STATIC_DRAW,a=e.isInterleavedBufferAttribute?e.data:e,o=r.get(a);let u,l=o.bufferGPU;if(void 0===l&&(l=this._createBuffer(s,t,i,n),o.bufferGPU=l,o.bufferType=t,o.version=a.version),i instanceof Float32Array)u=s.FLOAT;else if("undefined"!=typeof Float16Array&&i instanceof Float16Array)u=s.HALF_FLOAT;else if(i instanceof Uint16Array)u=e.isFloat16BufferAttribute?s.HALF_FLOAT:s.UNSIGNED_SHORT;else if(i instanceof Int16Array)u=s.SHORT;else if(i instanceof Uint32Array)u=s.UNSIGNED_INT;else if(i instanceof Int32Array)u=s.INT;else if(i instanceof Int8Array)u=s.BYTE;else if(i instanceof Uint8Array)u=s.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+i);u=s.UNSIGNED_BYTE}let d={bufferGPU:l,bufferType:t,type:u,byteLength:i.byteLength,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:u===s.INT||u===s.UNSIGNED_INT||e.gpuType===_,id:uS++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const e=this._createBuffer(s,t,i,n);d=new lS(d,e)}r.set(e,d)}updateAttribute(e){const t=this.backend,{gl:r}=t,s=e.array,i=e.isInterleavedBufferAttribute?e.data:e,n=t.get(i),a=n.bufferType,o=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(r.bindBuffer(a,n.bufferGPU),0===o.length)r.bufferSubData(a,0,s);else{for(let e=0,t=o.length;e<t;e++){const t=o[e];r.bufferSubData(a,t.start*s.BYTES_PER_ELEMENT,s,t.start,t.count)}i.clearUpdateRanges()}r.bindBuffer(a,null),n.version=i.version}destroyAttribute(e){const t=this.backend,{gl:r}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const s=t.get(e);r.deleteBuffer(s.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:r}=t,s=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:i}=t.get(s),n=e.array,a=n.byteLength;r.bindBuffer(r.COPY_READ_BUFFER,i);const o=r.createBuffer();r.bindBuffer(r.COPY_WRITE_BUFFER,o),r.bufferData(r.COPY_WRITE_BUFFER,a,r.STREAM_READ),r.copyBufferSubData(r.COPY_READ_BUFFER,r.COPY_WRITE_BUFFER,0,0,a),await t.utils._clientWaitAsync();const u=new e.array.constructor(n.length);return r.bindBuffer(r.COPY_WRITE_BUFFER,o),r.getBufferSubData(r.COPY_WRITE_BUFFER,0,u),r.deleteBuffer(o),r.bindBuffer(r.COPY_READ_BUFFER,null),r.bindBuffer(r.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,t,r,s){const i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,r,s),e.bindBuffer(t,null),i}}class cS{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;aS={[Ke]:e.FUNC_ADD,[ft]:e.FUNC_SUBTRACT,[mt]:e.FUNC_REVERSE_SUBTRACT},oS={[Ye]:e.ZERO,[Rt]:e.ONE,[Et]:e.SRC_COLOR,[St]:e.SRC_ALPHA,[Nt]:e.SRC_ALPHA_SATURATE,[vt]:e.DST_COLOR,[_t]:e.DST_ALPHA,[Tt]:e.ONE_MINUS_SRC_COLOR,[xt]:e.ONE_MINUS_SRC_ALPHA,[bt]:e.ONE_MINUS_DST_COLOR,[yt]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),r=e.getParameter(e.VIEWPORT);this.currentScissor=(new s).fromArray(t),this.currentViewport=(new s).fromArray(r),this._tempVec4=new s}enable(e){const{enabled:t}=this;!0!==t[e]&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;!1!==t[e]&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==At?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===wt?t.cullFace(t.BACK):e===Ct?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:r}=this;e!==t&&(r.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,r,s,i,n,a,o){const{gl:u}=this;if(e!==$){if(!1===this.currentBlendingEnabled&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e===Xe)i=i||t,n=n||r,a=a||s,t===this.currentBlendEquation&&i===this.currentBlendEquationAlpha||(u.blendEquationSeparate(aS[t],aS[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),r===this.currentBlendSrc&&s===this.currentBlendDst&&n===this.currentBlendSrcAlpha&&a===this.currentBlendDstAlpha||(u.blendFuncSeparate(oS[r],oS[s],oS[n],oS[a]),this.currentBlendSrc=r,this.currentBlendDst=s,this.currentBlendSrcAlpha=n,this.currentBlendDstAlpha=a),this.currentBlending=e,this.currentPremultipledAlpha=!1;else if(e!==this.currentBlending||o!==this.currentPremultipledAlpha){if(this.currentBlendEquation===Ke&&this.currentBlendEquationAlpha===Ke||(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=Ke,this.currentBlendEquationAlpha=Ke),o)switch(e){case G:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Bt:u.blendFunc(u.ONE,u.ONE);break;case Pt:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Mt:u.blendFuncSeparate(u.DST_COLOR,u.ONE_MINUS_SRC_ALPHA,u.ZERO,u.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case G:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Bt:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE,u.ONE,u.ONE);break;case Pt:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Mt:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=o}}else!0===this.currentBlendingEnabled&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1)}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case Gt:t.depthFunc(t.NEVER);break;case Ot:t.depthFunc(t.ALWAYS);break;case Vt:t.depthFunc(t.LESS);break;case Ut:t.depthFunc(t.LEQUAL);break;case Dt:t.depthFunc(t.EQUAL);break;case It:t.depthFunc(t.GEQUAL);break;case Ft:t.depthFunc(t.GREATER);break;case Lt:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,r,s){const i=this._tempVec4.set(e,t,r,s);if(!1===this.currentScissor.equals(i)){const{gl:e}=this;e.scissor(i.x,i.y,i.z,i.w),this.currentScissor.copy(i)}}viewport(e,t,r,s){const i=this._tempVec4.set(e,t,r,s);if(!1===this.currentViewport.equals(i)){const{gl:e}=this;e.viewport(i.x,i.y,i.z,i.w),this.currentViewport.copy(i)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,r){this.currentStencilFunc===e&&this.currentStencilRef===t&&this.currentStencilFuncMask===r||(this.gl.stencilFunc(e,t,r),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=r)}setStencilOp(e,t,r){this.currentStencilFail===e&&this.currentStencilZFail===t&&this.currentStencilZPass===r||(this.gl.stencilOp(e,t,r),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=r)}setMaterial(e,t,r){const{gl:s}=this;e.side===E?this.disable(s.CULL_FACE):this.enable(s.CULL_FACE);let i=e.side===S;t&&(i=!i),this.setFlipSided(i),e.blending===G&&!1===e.transparent?this.setBlending($):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const n=e.stencilWrite;if(this.setStencilTest(n),n&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage&&this.backend.renderer.samples>1?this.enable(s.SAMPLE_ALPHA_TO_COVERAGE):this.disable(s.SAMPLE_ALPHA_TO_COVERAGE),r>0&&this.currentClippingPlanes!==r){const e=12288;for(let t=0;t<8;t++)t<r?this.enable(e+t):this.disable(e+t)}}setPolygonOffset(e,t,r){const{gl:s}=this;e?(this.enable(s.POLYGON_OFFSET_FILL),this.currentPolygonOffsetFactor===t&&this.currentPolygonOffsetUnits===r||(s.polygonOffset(t,r),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=r)):this.disable(s.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e&&(this.gl.useProgram(e),this.currentProgram=e,!0)}setVertexState(e,t=null){const r=this.gl;return(this.currentVAO!==e||this.currentIndex!==t)&&(r.bindVertexArray(e),null!==t&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0)}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:r,currentBoundFramebuffers:s}=this;return s[e]!==t&&(r.bindFramebuffer(e,t),s[e]=t,e===r.DRAW_FRAMEBUFFER&&(s[r.FRAMEBUFFER]=t),e===r.FRAMEBUFFER&&(s[r.DRAW_FRAMEBUFFER]=t),!0)}drawBuffers(e,t){const{gl:r}=this;let s=[],i=!1;if(null!==e.textures){s=this.currentDrawbuffers.get(t),void 0===s&&(s=[],this.currentDrawbuffers.set(t,s));const n=e.textures;if(s.length!==n.length||s[0]!==r.COLOR_ATTACHMENT0){for(let e=0,t=n.length;e<t;e++)s[e]=r.COLOR_ATTACHMENT0+e;s.length=n.length,i=!0}}else s[0]!==r.BACK&&(s[0]=r.BACK,i=!0);i&&r.drawBuffers(s)}activeTexture(e){const{gl:t,currentTextureSlot:r,maxTextures:s}=this;void 0===e&&(e=t.TEXTURE0+s-1),r!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,r){const{gl:s,currentTextureSlot:i,currentBoundTextures:n,maxTextures:a}=this;void 0===r&&(r=null===i?s.TEXTURE0+a-1:i);let o=n[r];void 0===o&&(o={type:void 0,texture:void 0},n[r]=o),o.type===e&&o.texture===t||(i!==r&&(s.activeTexture(r),this.currentTextureSlot=r),s.bindTexture(e,t),o.type=e,o.texture=t)}bindBufferBase(e,t,r){const{gl:s}=this,i=`${e}-${t}`;return this.currentBoundBufferBases[i]!==r&&(s.bindBufferBase(e,t,r),this.currentBoundBufferBases[i]=r,!0)}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:r}=this,s=r[t];void 0!==s&&void 0!==s.type&&(e.bindTexture(s.type,null),s.type=void 0,s.texture=void 0)}}class hS{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=b){const{gl:r,extensions:s}=this;let i;const n=c.getTransfer(t);if(e===Ce)return r.UNSIGNED_BYTE;if(e===kt)return r.UNSIGNED_SHORT_4_4_4_4;if(e===zt)return r.UNSIGNED_SHORT_5_5_5_1;if(e===$t)return r.UNSIGNED_INT_5_9_9_9_REV;if(e===Ht)return r.UNSIGNED_INT_10F_11F_11F_REV;if(e===ut)return r.BYTE;if(e===ot)return r.SHORT;if(e===lt)return r.UNSIGNED_SHORT;if(e===_)return r.INT;if(e===T)return r.UNSIGNED_INT;if(e===I)return r.FLOAT;if(e===ce)return r.HALF_FLOAT;if(e===Wt)return r.ALPHA;if(e===ht)return r.RGB;if(e===de)return r.RGBA;if(e===Ae)return r.DEPTH_COMPONENT;if(e===Re)return r.DEPTH_STENCIL;if(e===at)return r.RED;if(e===nt)return r.RED_INTEGER;if(e===Ve)return r.RG;if(e===dt)return r.RG_INTEGER;if(e===pt)return r.RGBA_INTEGER;if(e===qt||e===jt||e===Xt||e===Kt)if(n===h){if(i=s.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(e===qt)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===jt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Xt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Kt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=s.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(e===qt)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===jt)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Xt)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Kt)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===Yt||e===Qt||e===Zt||e===Jt){if(i=s.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(e===Yt)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Qt)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Zt)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Jt)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===er||e===tr||e===rr){if(i=s.get("WEBGL_compressed_texture_etc"),null===i)return null;if(e===er||e===tr)return n===h?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===rr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(e===sr||e===ir||e===nr||e===ar||e===or||e===ur||e===lr||e===dr||e===cr||e===hr||e===pr||e===gr||e===mr||e===fr){if(i=s.get("WEBGL_compressed_texture_astc"),null===i)return null;if(e===sr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===ir)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===nr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===ar)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===or)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===ur)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===lr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===dr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===cr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===hr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===pr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===gr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===mr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===fr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===yr){if(i=s.get("EXT_texture_compression_bptc"),null===i)return null;if(e===yr)return n===h?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(e===br||e===xr||e===Tr||e===_r){if(i=s.get("EXT_texture_compression_rgtc"),null===i)return null;if(e===br)return i.COMPRESSED_RED_RGTC1_EXT;if(e===xr)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===Tr)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===_r)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return e===we?r.UNSIGNED_INT_24_8:void 0!==r[e]?r[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((r,s)=>{!function i(){const n=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(n===e.WAIT_FAILED)return e.deleteSync(t),void s();n!==e.TIMEOUT_EXPIRED?(e.deleteSync(t),r()):requestAnimationFrame(i)}()})}}let pS,gS,mS,fS=!1;class yS{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},!1===fS&&(this._init(),fS=!0)}_init(){const e=this.gl;pS={[Sr]:e.REPEAT,[Nr]:e.CLAMP_TO_EDGE,[vr]:e.MIRRORED_REPEAT},gS={[v]:e.NEAREST,[Er]:e.NEAREST_MIPMAP_NEAREST,[ze]:e.NEAREST_MIPMAP_LINEAR,[Y]:e.LINEAR,[ke]:e.LINEAR_MIPMAP_NEAREST,[U]:e.LINEAR_MIPMAP_LINEAR},mS={[Br]:e.NEVER,[Pr]:e.ALWAYS,[Ue]:e.LESS,[Mr]:e.LEQUAL,[Cr]:e.EQUAL,[wr]:e.GEQUAL,[Ar]:e.GREATER,[Rr]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let r;return r=!0===e.isCubeTexture?t.TEXTURE_CUBE_MAP:!0===e.isArrayTexture||!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:!0===e.isData3DTexture?t.TEXTURE_3D:t.TEXTURE_2D,r}getInternalFormat(e,t,r,s,i=!1){const{gl:n,extensions:a}=this;if(null!==e){if(void 0!==n[e])return n[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let o=t;if(t===n.RED&&(r===n.FLOAT&&(o=n.R32F),r===n.HALF_FLOAT&&(o=n.R16F),r===n.UNSIGNED_BYTE&&(o=n.R8),r===n.UNSIGNED_SHORT&&(o=n.R16),r===n.UNSIGNED_INT&&(o=n.R32UI),r===n.BYTE&&(o=n.R8I),r===n.SHORT&&(o=n.R16I),r===n.INT&&(o=n.R32I)),t===n.RED_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.R8UI),r===n.UNSIGNED_SHORT&&(o=n.R16UI),r===n.UNSIGNED_INT&&(o=n.R32UI),r===n.BYTE&&(o=n.R8I),r===n.SHORT&&(o=n.R16I),r===n.INT&&(o=n.R32I)),t===n.RG&&(r===n.FLOAT&&(o=n.RG32F),r===n.HALF_FLOAT&&(o=n.RG16F),r===n.UNSIGNED_BYTE&&(o=n.RG8),r===n.UNSIGNED_SHORT&&(o=n.RG16),r===n.UNSIGNED_INT&&(o=n.RG32UI),r===n.BYTE&&(o=n.RG8I),r===n.SHORT&&(o=n.RG16I),r===n.INT&&(o=n.RG32I)),t===n.RG_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.RG8UI),r===n.UNSIGNED_SHORT&&(o=n.RG16UI),r===n.UNSIGNED_INT&&(o=n.RG32UI),r===n.BYTE&&(o=n.RG8I),r===n.SHORT&&(o=n.RG16I),r===n.INT&&(o=n.RG32I)),t===n.RGB){const e=i?Lr:c.getTransfer(s);r===n.FLOAT&&(o=n.RGB32F),r===n.HALF_FLOAT&&(o=n.RGB16F),r===n.UNSIGNED_BYTE&&(o=n.RGB8),r===n.UNSIGNED_SHORT&&(o=n.RGB16),r===n.UNSIGNED_INT&&(o=n.RGB32UI),r===n.BYTE&&(o=n.RGB8I),r===n.SHORT&&(o=n.RGB16I),r===n.INT&&(o=n.RGB32I),r===n.UNSIGNED_BYTE&&(o=e===h?n.SRGB8:n.RGB8),r===n.UNSIGNED_SHORT_5_6_5&&(o=n.RGB565),r===n.UNSIGNED_SHORT_5_5_5_1&&(o=n.RGB5_A1),r===n.UNSIGNED_SHORT_4_4_4_4&&(o=n.RGB4),r===n.UNSIGNED_INT_5_9_9_9_REV&&(o=n.RGB9_E5),r===n.UNSIGNED_INT_10F_11F_11F_REV&&(o=n.R11F_G11F_B10F)}if(t===n.RGB_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.RGB8UI),r===n.UNSIGNED_SHORT&&(o=n.RGB16UI),r===n.UNSIGNED_INT&&(o=n.RGB32UI),r===n.BYTE&&(o=n.RGB8I),r===n.SHORT&&(o=n.RGB16I),r===n.INT&&(o=n.RGB32I)),t===n.RGBA){const e=i?Lr:c.getTransfer(s);r===n.FLOAT&&(o=n.RGBA32F),r===n.HALF_FLOAT&&(o=n.RGBA16F),r===n.UNSIGNED_BYTE&&(o=n.RGBA8),r===n.UNSIGNED_SHORT&&(o=n.RGBA16),r===n.UNSIGNED_INT&&(o=n.RGBA32UI),r===n.BYTE&&(o=n.RGBA8I),r===n.SHORT&&(o=n.RGBA16I),r===n.INT&&(o=n.RGBA32I),r===n.UNSIGNED_BYTE&&(o=e===h?n.SRGB8_ALPHA8:n.RGBA8),r===n.UNSIGNED_SHORT_4_4_4_4&&(o=n.RGBA4),r===n.UNSIGNED_SHORT_5_5_5_1&&(o=n.RGB5_A1)}return t===n.RGBA_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.RGBA8UI),r===n.UNSIGNED_SHORT&&(o=n.RGBA16UI),r===n.UNSIGNED_INT&&(o=n.RGBA32UI),r===n.BYTE&&(o=n.RGBA8I),r===n.SHORT&&(o=n.RGBA16I),r===n.INT&&(o=n.RGBA32I)),t===n.DEPTH_COMPONENT&&(r===n.UNSIGNED_SHORT&&(o=n.DEPTH_COMPONENT16),r===n.UNSIGNED_INT&&(o=n.DEPTH_COMPONENT24),r===n.FLOAT&&(o=n.DEPTH_COMPONENT32F)),t===n.DEPTH_STENCIL&&r===n.UNSIGNED_INT_24_8&&(o=n.DEPTH24_STENCIL8),o!==n.R16F&&o!==n.R32F&&o!==n.RG16F&&o!==n.RG32F&&o!==n.RGBA16F&&o!==n.RGBA32F||a.get("EXT_color_buffer_float"),o}setTextureParameters(e,t){const{gl:r,extensions:s,backend:i}=this,n=c.getPrimaries(c.workingColorSpace),a=t.colorSpace===b?null:c.getPrimaries(t.colorSpace),o=t.colorSpace===b||n===a?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,t.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,o),r.texParameteri(e,r.TEXTURE_WRAP_S,pS[t.wrapS]),r.texParameteri(e,r.TEXTURE_WRAP_T,pS[t.wrapT]),e!==r.TEXTURE_3D&&e!==r.TEXTURE_2D_ARRAY||t.isArrayTexture||r.texParameteri(e,r.TEXTURE_WRAP_R,pS[t.wrapR]),r.texParameteri(e,r.TEXTURE_MAG_FILTER,gS[t.magFilter]);const u=void 0!==t.mipmaps&&t.mipmaps.length>0,l=t.minFilter===Y&&u?U:t.minFilter;if(r.texParameteri(e,r.TEXTURE_MIN_FILTER,gS[l]),t.compareFunction&&(r.texParameteri(e,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(e,r.TEXTURE_COMPARE_FUNC,mS[t.compareFunction])),!0===s.has("EXT_texture_filter_anisotropic")){if(t.magFilter===v)return;if(t.minFilter!==ze&&t.minFilter!==U)return;if(t.type===I&&!1===s.has("OES_texture_float_linear"))return;if(t.anisotropy>1){const n=s.get("EXT_texture_filter_anisotropic");r.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:r,defaultTextures:s}=this,i=this.getGLTextureType(e);let n=s[i];void 0===n&&(n=t.createTexture(),r.state.bindTexture(i,n),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),s[i]=n),r.set(e,{textureGPU:n,glTextureType:i,isDefault:!0})}createTexture(e,t){const{gl:r,backend:s}=this,{levels:i,width:n,height:a,depth:o}=t,u=s.utils.convert(e.format,e.colorSpace),l=s.utils.convert(e.type),d=this.getInternalFormat(e.internalFormat,u,l,e.colorSpace,e.isVideoTexture),c=r.createTexture(),h=this.getGLTextureType(e);s.state.bindTexture(h,c),this.setTextureParameters(h,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?r.texStorage3D(r.TEXTURE_2D_ARRAY,i,d,n,a,o):e.isData3DTexture?r.texStorage3D(r.TEXTURE_3D,i,d,n,a,o):e.isVideoTexture||r.texStorage2D(h,i,d,n,a),s.set(e,{textureGPU:c,glTextureType:h,glFormat:u,glType:l,glInternalFormat:d})}copyBufferToTexture(e,t){const{gl:r,backend:s}=this,{textureGPU:i,glTextureType:n,glFormat:a,glType:o}=s.get(t),{width:u,height:l}=t.source.data;r.bindBuffer(r.PIXEL_UNPACK_BUFFER,e),s.state.bindTexture(n,i),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.texSubImage2D(n,0,0,0,u,l,a,o,0),r.bindBuffer(r.PIXEL_UNPACK_BUFFER,null),s.state.unbindTexture()}updateTexture(e,t){const{gl:r}=this,{width:s,height:i}=t,{textureGPU:n,glTextureType:a,glFormat:o,glType:u,glInternalFormat:l}=this.backend.get(e);if(!e.isRenderTargetTexture&&void 0!==n)if(this.backend.state.bindTexture(a,n),this.setTextureParameters(a,e),e.isCompressedTexture){const s=e.mipmaps,i=t.image;for(let t=0;t<s.length;t++){const n=s[t];e.isCompressedArrayTexture?e.format!==r.RGBA?null!==o?r.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,t,0,0,0,n.width,n.height,i.depth,o,n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texSubImage3D(r.TEXTURE_2D_ARRAY,t,0,0,0,n.width,n.height,i.depth,o,u,n.data):null!==o?r.compressedTexSubImage2D(r.TEXTURE_2D,t,0,0,n.width,n.height,o,n.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const n=t.images,a=e.mipmaps;for(let e=0;e<6;e++){const t=bS(n[e]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,s,i,o,u,t);for(let t=0;t<a.length;t++){const s=bS(a[t].images[e]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+e,t+1,0,0,s.width,s.height,o,u,s)}}}else if(e.isDataArrayTexture||e.isArrayTexture){const s=t.image;if(e.layerUpdates.size>0){const t=Fr(s.width,s.height,e.format,e.type);for(const i of e.layerUpdates){const e=s.data.subarray(i*t/s.data.BYTES_PER_ELEMENT,(i+1)*t/s.data.BYTES_PER_ELEMENT);r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,i,s.width,s.height,1,o,u,e)}e.clearLayerUpdates()}else r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,s.width,s.height,s.depth,o,u,s.data)}else if(e.isData3DTexture){const e=t.image;r.texSubImage3D(r.TEXTURE_3D,0,0,0,0,e.width,e.height,e.depth,o,u,e.data)}else if(e.isVideoTexture)e.update(),r.texImage2D(a,0,l,o,u,t.image);else{const n=e.mipmaps;if(n.length>0)for(let e=0,t=n.length;e<t;e++){const t=n[e],s=bS(t);r.texSubImage2D(a,e,0,0,t.width,t.height,o,u,s)}else{const e=bS(t.image);r.texSubImage2D(a,0,0,0,s,i,o,u,e)}}}generateMipmaps(e){const{gl:t,backend:r}=this,{textureGPU:s,glTextureType:i}=r.get(e);r.state.bindTexture(i,s),t.generateMipmap(i)}deallocateRenderBuffers(e){const{gl:t,backend:r}=this;if(e){const s=r.get(e);if(s.renderBufferStorageSetup=void 0,s.framebuffers){for(const e in s.framebuffers)t.deleteFramebuffer(s.framebuffers[e]);delete s.framebuffers}if(s.depthRenderbuffer&&(t.deleteRenderbuffer(s.depthRenderbuffer),delete s.depthRenderbuffer),s.stencilRenderbuffer&&(t.deleteRenderbuffer(s.stencilRenderbuffer),delete s.stencilRenderbuffer),s.msaaFrameBuffer&&(t.deleteFramebuffer(s.msaaFrameBuffer),delete s.msaaFrameBuffer),s.msaaRenderbuffers){for(let e=0;e<s.msaaRenderbuffers.length;e++)t.deleteRenderbuffer(s.msaaRenderbuffers[e]);delete s.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:r}=this,{textureGPU:s,renderTarget:i}=r.get(e);this.deallocateRenderBuffers(i),t.deleteTexture(s),r.delete(e)}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){const{gl:a,backend:o}=this,{state:u}=this.backend,{textureGPU:l,glTextureType:d,glType:c,glFormat:h}=o.get(t);let p,g,m,f,y,b,x,T,_;u.bindTexture(d,l);const v=e.isCompressedTexture?e.mipmaps[n]:e.image;if(null!==r)p=r.max.x-r.min.x,g=r.max.y-r.min.y,m=r.isBox3?r.max.z-r.min.z:1,f=r.min.x,y=r.min.y,b=r.isBox3?r.min.z:0;else{const t=Math.pow(2,-i);p=Math.floor(v.width*t),g=Math.floor(v.height*t),m=e.isDataArrayTexture||e.isArrayTexture?v.depth:e.isData3DTexture?Math.floor(v.depth*t):1,f=0,y=0,b=0}null!==s?(x=s.x,T=s.y,_=s.z):(x=0,T=0,_=0),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,t.unpackAlignment);const N=a.getParameter(a.UNPACK_ROW_LENGTH),S=a.getParameter(a.UNPACK_IMAGE_HEIGHT),E=a.getParameter(a.UNPACK_SKIP_PIXELS),R=a.getParameter(a.UNPACK_SKIP_ROWS),A=a.getParameter(a.UNPACK_SKIP_IMAGES);a.pixelStorei(a.UNPACK_ROW_LENGTH,v.width),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,v.height),a.pixelStorei(a.UNPACK_SKIP_PIXELS,f),a.pixelStorei(a.UNPACK_SKIP_ROWS,y),a.pixelStorei(a.UNPACK_SKIP_IMAGES,b);const w=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const r=o.get(e),s=o.get(t),i=o.get(r.renderTarget),n=o.get(s.renderTarget),l=i.framebuffers[r.cacheKey],d=n.framebuffers[s.cacheKey];u.bindFramebuffer(a.READ_FRAMEBUFFER,l),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,d);let c=a.COLOR_BUFFER_BIT;e.isDepthTexture&&(c=a.DEPTH_BUFFER_BIT),a.blitFramebuffer(f,y,p,g,x,T,p,g,c,a.NEAREST),u.bindFramebuffer(a.READ_FRAMEBUFFER,null),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,null)}else w?e.isDataTexture||e.isData3DTexture?a.texSubImage3D(d,n,x,T,_,p,g,m,h,c,v.data):t.isCompressedArrayTexture?a.compressedTexSubImage3D(d,n,x,T,_,p,g,m,h,v.data):a.texSubImage3D(d,n,x,T,_,p,g,m,h,c,v):e.isDataTexture?a.texSubImage2D(d,n,x,T,p,g,h,c,v.data):e.isCompressedTexture?a.compressedTexSubImage2D(d,n,x,T,v.width,v.height,h,v.data):a.texSubImage2D(d,n,x,T,p,g,h,c,v);a.pixelStorei(a.UNPACK_ROW_LENGTH,N),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,S),a.pixelStorei(a.UNPACK_SKIP_PIXELS,E),a.pixelStorei(a.UNPACK_SKIP_ROWS,R),a.pixelStorei(a.UNPACK_SKIP_IMAGES,A),0===n&&t.generateMipmaps&&a.generateMipmap(d),u.unbindTexture()}copyFramebufferToTexture(e,t,r){const{gl:s}=this,{state:i}=this.backend,{textureGPU:n}=this.backend.get(e),{x:a,y:o,z:u,w:l}=r,d=!0===e.isDepthTexture||t.renderTarget&&t.renderTarget.samples>0,c=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(d){const r=0!==a||0!==o;let d,h;if(!0===e.isDepthTexture?(d=s.DEPTH_BUFFER_BIT,h=s.DEPTH_ATTACHMENT,t.stencil&&(d|=s.STENCIL_BUFFER_BIT)):(d=s.COLOR_BUFFER_BIT,h=s.COLOR_ATTACHMENT0),r){const e=this.backend.get(t.renderTarget),r=e.framebuffers[t.getCacheKey()],h=e.msaaFrameBuffer;i.bindFramebuffer(s.DRAW_FRAMEBUFFER,r),i.bindFramebuffer(s.READ_FRAMEBUFFER,h);const p=c-o-l;s.blitFramebuffer(a,p,a+u,p+l,a,p,a+u,p+l,d,s.NEAREST),i.bindFramebuffer(s.READ_FRAMEBUFFER,r),i.bindTexture(s.TEXTURE_2D,n),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,a,p,u,l),i.unbindTexture()}else{const e=s.createFramebuffer();i.bindFramebuffer(s.DRAW_FRAMEBUFFER,e),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,h,s.TEXTURE_2D,n,0),s.blitFramebuffer(0,0,u,l,0,0,u,l,d,s.NEAREST),s.deleteFramebuffer(e)}}else i.bindTexture(s.TEXTURE_2D,n),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,a,c-l-o,u,l),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,r,s=!1){const{gl:i}=this,n=t.renderTarget,{depthTexture:a,depthBuffer:o,stencilBuffer:u,width:l,height:d}=n;if(i.bindRenderbuffer(i.RENDERBUFFER,e),o&&!u){let t=i.DEPTH_COMPONENT24;if(!0===s){this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(i.RENDERBUFFER,n.samples,t,l,d)}else r>0?(a&&a.isDepthTexture&&a.type===i.FLOAT&&(t=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,r,t,l,d)):i.renderbufferStorage(i.RENDERBUFFER,t,l,d);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else o&&u&&(r>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,r,i.DEPTH24_STENCIL8,l,d):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,l,d),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e));i.bindRenderbuffer(i.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,r,s,i,n){const{backend:a,gl:o}=this,{textureGPU:u,glFormat:l,glType:d}=this.backend.get(e),c=o.createFramebuffer();o.bindFramebuffer(o.READ_FRAMEBUFFER,c);const h=e.isCubeTexture?o.TEXTURE_CUBE_MAP_POSITIVE_X+n:o.TEXTURE_2D;o.framebufferTexture2D(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,h,u,0);const p=this._getTypedArrayType(d),g=s*i*this._getBytesPerTexel(d,l),m=o.createBuffer();o.bindBuffer(o.PIXEL_PACK_BUFFER,m),o.bufferData(o.PIXEL_PACK_BUFFER,g,o.STREAM_READ),o.readPixels(t,r,s,i,l,d,0),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),await a.utils._clientWaitAsync();const f=new p(g/p.BYTES_PER_ELEMENT);return o.bindBuffer(o.PIXEL_PACK_BUFFER,m),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,f),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),o.deleteFramebuffer(c),f}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_5_5_1)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_6_5)return Uint16Array;if(e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:r}=this;let s=0;return e===r.UNSIGNED_BYTE&&(s=1),e!==r.UNSIGNED_SHORT_4_4_4_4&&e!==r.UNSIGNED_SHORT_5_5_5_1&&e!==r.UNSIGNED_SHORT_5_6_5&&e!==r.UNSIGNED_SHORT&&e!==r.HALF_FLOAT||(s=2),e!==r.UNSIGNED_INT&&e!==r.FLOAT||(s=4),t===r.RGBA?4*s:t===r.RGB?3*s:t===r.ALPHA?s:void 0}}function bS(e){return e.isDataTexture?e.image.data:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?e:e.data}class xS{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return void 0===t&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class TS{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(null!==this.maxAnisotropy)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(!0===t.has("EXT_texture_filter_anisotropic")){const r=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const _S={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class vS{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:r,mode:s,object:i,type:n,info:a,index:o}=this;0!==o?r.drawElements(s,t,n,e):r.drawArrays(s,e,t),a.update(i,t,1)}renderInstances(e,t,r){const{gl:s,mode:i,type:n,index:a,object:o,info:u}=this;0!==r&&(0!==a?s.drawElementsInstanced(i,t,n,e,r):s.drawArraysInstanced(i,e,t,r),u.update(o,t,r))}renderMultiDraw(e,t,r){const{extensions:s,mode:i,object:n,info:a}=this;if(0===r)return;const o=s.get("WEBGL_multi_draw");if(null===o)for(let s=0;s<r;s++)this.render(e[s],t[s]);else{0!==this.index?o.multiDrawElementsWEBGL(i,t,0,this.type,e,0,r):o.multiDrawArraysWEBGL(i,e,0,t,0,r);let s=0;for(let e=0;e<r;e++)s+=t[e];a.update(n,s,1)}}renderMultiDrawInstances(e,t,r,s){const{extensions:i,mode:n,object:a,info:o}=this;if(0===r)return;const u=i.get("WEBGL_multi_draw");if(null===u)for(let i=0;i<r;i++)this.renderInstances(e[i],t[i],s[i]);else{0!==this.index?u.multiDrawElementsInstancedWEBGL(n,t,0,this.type,e,0,s,0,r):u.multiDrawArraysInstancedWEBGL(n,e,0,t,0,s,0,r);let i=0;for(let e=0;e<r;e++)i+=t[e]*s[e];o.update(a,i,1)}}}class NS{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class SS extends NS{constructor(e,t,r=2048){if(super(r),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext)return console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),void(this.trackTimestamp=!1);this.queries=[];for(let t=0;t<this.maxQueries;t++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Be(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(null==t)return;if(null!==this.activeQuery)return;const r=this.queries[t];if(r)try{"inactive"===this.queryStates.get(t)&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,r),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(e){console.error("Error in beginQuery:",e),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(null!=t&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(e){console.error("Error in endQuery:",e),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[t,r]of this.queryStates)if("ended"===r){const r=this.queries[t];e.push(this.resolveQuery(r))}if(0===e.length)return this.lastValue;const t=(await Promise.all(e)).reduce((e,t)=>e+t,0);return this.lastValue=t,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,t}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed)return void t(this.lastValue);let r,s=!1;const i=e=>{s||(s=!0,r&&(clearTimeout(r),r=null),t(e))},n=()=>{if(this.isDisposed)i(this.lastValue);else try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT))return void i(this.lastValue);if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE))return void(r=setTimeout(n,1));const s=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(s)/1e6)}catch(e){console.error("Error checking query:",e),t(this.lastValue)}};n()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class ES extends nS{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,r={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},s=void 0!==t.context?t.context:e.domElement.getContext("webgl2",r);function i(t){t.preventDefault();const r={api:"WebGL",message:t.statusMessage||"Unknown reason",reason:null,originalEvent:t};e.onDeviceLost(r)}this._onContextLost=i,e.domElement.addEventListener("webglcontextlost",i,!1),this.gl=s,this.extensions=new xS(this),this.capabilities=new TS(this),this.attributeUtils=new dS(this),this.textureUtils=new yS(this),this.bufferRenderer=new vS(this),this.state=new cS(this),this.utils=new hS(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return l}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){!0!==this.gl.getContextAttributes().xrCompatible&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,r=null){const s=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:s.RGBA8}),null!==r){const t=e.stencilBuffer?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:r,glInternalFormat:t}),!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&!0===e._autoAllocateDepthBuffer&&!1===e.multiview&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new SS(this.gl,e,2048));const r=this.timestampQueryPool[e];null!==r.allocateQueriesForContext(t)&&r.beginQuery(t)}prepareTimestampBuffer(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e].endQuery(t)}getContext(){return this.gl}beginRender(e){const{state:t}=this,r=this.get(e);if(r.frameCalls=this.renderer.info.render.frameCalls,e.viewport)this.updateViewport(e);else{const{width:e,height:r}=this.getDrawingBufferSize();t.viewport(0,0,e,r)}if(e.scissor){const{x:r,y:s,width:i,height:n}=e.scissorValue;t.scissor(r,e.height-n-s,i,n)}this.initTimestampQuery(Ir.RENDER,this.getTimestampUID(e)),r.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const s=e.occlusionQueryCount;s>0&&(r.currentOcclusionQueries=r.occlusionQueries,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,r.lastOcclusionObject=null,r.occlusionQueries=new Array(s),r.occlusionQueryObjects=new Array(s),r.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:r}=this,s=this.get(e),i=s.previousContext;r.resetVertexState();const n=e.occlusionQueryCount;n>0&&(n>s.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const a=e.textures;if(null!==a)for(let e=0;e<a.length;e++){const t=a[e];t.generateMipmaps&&this.generateMipmaps(t)}if(this._currentContext=i,this._resolveRenderTarget(e),null!==i)if(this._setFramebuffer(i),i.viewport)this.updateViewport(i);else{const{width:e,height:t}=this.getDrawingBufferSize();r.viewport(0,0,e,t)}this.prepareTimestampBuffer(Ir.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:r,currentOcclusionQueryObjects:s}=t;if(r&&s){const e=new WeakSet,{gl:i}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const n=()=>{let a=0;for(let t=0;t<r.length;t++){const n=r[t];null!==n&&(i.getQueryParameter(n,i.QUERY_RESULT_AVAILABLE)&&(0===i.getQueryParameter(n,i.QUERY_RESULT)&&e.add(s[t]),r[t]=null,i.deleteQuery(n),a++))}a<r.length?requestAnimationFrame(n):t.occluded=e};n()}}isOccluded(e,t){const r=this.get(e);return r.occluded&&r.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:r,y:s,width:i,height:n}=e.viewportValue;t.viewport(r,e.height-n-s,i,n)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,r,s=null,i=!0,n=!0){const{gl:a,renderer:o}=this;if(null===s){s={textures:null,clearColorValue:this.getClearColor()}}let u=0;if(e&&(u|=a.COLOR_BUFFER_BIT),t&&(u|=a.DEPTH_BUFFER_BIT),r&&(u|=a.STENCIL_BUFFER_BIT),0!==u){let l;l=s.clearColorValue?s.clearColorValue:this.getClearColor();const d=o.getClearDepth(),c=o.getClearStencil();if(t&&this.state.setDepthMask(!0),null===s.textures)a.clearColor(l.r,l.g,l.b,l.a),a.clear(u);else{if(i&&this._setFramebuffer(s),e)for(let e=0;e<s.textures.length;e++)0===e?a.clearBufferfv(a.COLOR,e,[l.r,l.g,l.b,l.a]):a.clearBufferfv(a.COLOR,e,[0,0,0,1]);t&&r?a.clearBufferfi(a.DEPTH_STENCIL,0,d,c):t?a.clearBufferfv(a.DEPTH,0,[d]):r&&a.clearBufferiv(a.STENCIL,0,[c]),i&&n&&this._resolveRenderTarget(s)}}}beginCompute(e){const{state:t,gl:r}=this;this.get(e).frameCalls=this.renderer.info.compute.frameCalls,t.bindFramebuffer(r.FRAMEBUFFER,null),this.initTimestampQuery(Ir.COMPUTE,this.getTimestampUID(e))}compute(e,t,r,s,i=null){const{state:n,gl:a}=this;!1===this.discard&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:o,transformBuffers:u,attributes:l}=this.get(s),d=this._getVaoKey(l),c=this.vaoCache[d];void 0===c?this.vaoCache[d]=this._createVao(l):n.setVertexState(c),n.useProgram(o),this._bindUniforms(r);const h=this._getTransformFeedback(u);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,h),a.beginTransformFeedback(a.POINTS),i=null!==i?i:t.count,Array.isArray(i)&&(Be("WebGLBackend.compute(): The count parameter must be a single number, not an array."),i=i[0]),l[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,i):a.drawArrays(a.POINTS,0,i),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(let e=0;e<u.length;e++){const t=u[e];t.pbo&&this.has(t.pbo)&&this.textureUtils.copyBufferToTexture(t.transformBuffer,t.pbo),t.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(Ir.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:r,material:s,context:i,hardwareClippingPlanes:n}=e,{programGPU:a}=this.get(r),{gl:o,state:u}=this,l=this.get(i),d=e.getDrawParameters();if(null===d)return;this._bindUniforms(e.getBindings());const c=t.isMesh&&t.matrixWorld.determinant()<0;u.setMaterial(s,c,n),u.useProgram(a);const h=e.getAttributes(),p=this.get(h);let g=p.vaoGPU;if(void 0===g){const e=this._getVaoKey(h);g=this.vaoCache[e],void 0===g&&(g=this._createVao(h),this.vaoCache[e]=g,p.vaoGPU=g)}const m=e.getIndex(),f=null!==m?this.get(m).bufferGPU:null;u.setVertexState(g,f);const y=l.lastOcclusionObject;if(y!==t&&void 0!==y){if(null!==y&&!0===y.occlusionTest&&(o.endQuery(o.ANY_SAMPLES_PASSED),l.occlusionQueryIndex++),!0===t.occlusionTest){const e=o.createQuery();o.beginQuery(o.ANY_SAMPLES_PASSED,e),l.occlusionQueries[l.occlusionQueryIndex]=e,l.occlusionQueryObjects[l.occlusionQueryIndex]=t}l.lastOcclusionObject=t}const b=this.bufferRenderer;t.isPoints?b.mode=o.POINTS:t.isLineSegments?b.mode=o.LINES:t.isLine?b.mode=o.LINE_STRIP:t.isLineLoop?b.mode=o.LINE_LOOP:!0===s.wireframe?(u.setLineWidth(s.wireframeLinewidth*this.renderer.getPixelRatio()),b.mode=o.LINES):b.mode=o.TRIANGLES;const{vertexCount:x,instanceCount:T}=d;let{firstVertex:_}=d;if(b.object=t,null!==m){_*=m.array.BYTES_PER_ELEMENT;const e=this.get(m);b.index=m.count,b.type=e.type}else b.index=0;const v=()=>{t.isBatchedMesh?null!==t._multiDrawInstances?(Be("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),b.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?b.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):Be("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):T>1?b.renderInstances(_,x,T):b.render(_,x)};if(!0===e.camera.isArrayCamera&&e.camera.cameras.length>0&&!1===e.camera.isMultiViewCamera){const r=this.get(e.camera),s=e.camera.cameras,i=e.getBindingGroup("cameraIndex").bindings[0];if(void 0===r.indexesGPU||r.indexesGPU.length!==s.length){const e=new Uint32Array([0,0,0,0]),t=[];for(let r=0,i=s.length;r<i;r++){const s=o.createBuffer();e[0]=r,o.bindBuffer(o.UNIFORM_BUFFER,s),o.bufferData(o.UNIFORM_BUFFER,e,o.STATIC_DRAW),t.push(s)}r.indexesGPU=t}const n=this.get(i),a=this.renderer.getPixelRatio(),l=this._currentContext.renderTarget,d=this._isRenderCameraDepthArray(this._currentContext),c=this._currentContext.activeCubeFace;if(d){const e=this.get(l.depthTexture);if(e.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){e.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:t}=l;for(let e=0,r=s.length;e<r;e++)this.renderer._activeCubeFace=e,this._currentContext.activeCubeFace=e,this._setFramebuffer(this._currentContext),this.clear(!1,!0,t,this._currentContext,!1,!1);this.renderer._activeCubeFace=c,this._currentContext.activeCubeFace=c}}for(let i=0,l=s.length;i<l;i++){const l=s[i];if(t.layers.test(l.layers)){d&&(this.renderer._activeCubeFace=i,this._currentContext.activeCubeFace=i,this._setFramebuffer(this._currentContext));const t=l.viewport;if(void 0!==t){const r=t.x*a,s=t.y*a,i=t.width*a,n=t.height*a;u.viewport(Math.floor(r),Math.floor(e.context.height-n-s),Math.floor(i),Math.floor(n))}u.bindBufferBase(o.UNIFORM_BUFFER,n.index,r.indexesGPU[i]),v()}this._currentContext.activeCubeFace=c,this.renderer._activeCubeFace=c}}else v()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,s,i,n){return this.textureUtils.copyTextureToBuffer(e,t,r,s,i,n)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new rS(e,t)}createProgram(e){const t=this.gl,{stage:r,code:s}=e,i="fragment"===r?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,s),t.compileShader(i),this.set(e,{shaderGPU:i})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const r=this.gl,s=e.pipeline,{fragmentProgram:i,vertexProgram:n}=s,a=r.createProgram(),o=this.get(i).shaderGPU,u=this.get(n).shaderGPU;if(r.attachShader(a,o),r.attachShader(a,u),r.linkProgram(a),this.set(s,{programGPU:a,fragmentShader:o,vertexShader:u}),null!==t&&this.parallel){const i=new Promise(t=>{const i=this.parallel,n=()=>{r.getProgramParameter(a,i.COMPLETION_STATUS_KHR)?(this._completeCompile(e,s),t()):requestAnimationFrame(n)};n()});return void t.push(i)}this._completeCompile(e,s)}_handleSource(e,t){const r=e.split("\n"),s=[],i=Math.max(t-6,0),n=Math.min(t+6,r.length);for(let e=i;e<n;e++){const i=e+1;s.push(`${i===t?">":" "} ${i}: ${r[e]}`)}return s.join("\n")}_getShaderErrors(e,t,r){const s=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(s&&""===i)return"";const n=/ERROR: 0:(\d+)/.exec(i);if(n){const s=parseInt(n[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+this._handleSource(e.getShaderSource(t),s)}return i}_logProgramError(e,t,r){if(this.renderer.debug.checkShaderErrors){const s=this.gl,i=(s.getProgramInfoLog(e)||"").trim();if(!1===s.getProgramParameter(e,s.LINK_STATUS))if("function"==typeof this.renderer.debug.onShaderError)this.renderer.debug.onShaderError(s,e,r,t);else{const n=this._getShaderErrors(s,r,"vertex"),a=this._getShaderErrors(s,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(e,s.VALIDATE_STATUS)+"\n\nProgram Info Log: "+i+"\n"+n+"\n"+a)}else""!==i&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}_completeCompile(e,t){const{state:r,gl:s}=this,i=this.get(t),{programGPU:n,fragmentShader:a,vertexShader:o}=i;!1===s.getProgramParameter(n,s.LINK_STATUS)&&this._logProgramError(n,a,o),r.useProgram(n);const u=e.getBindings();this._setupBindings(u,n),this.set(t,{programGPU:n})}createComputePipeline(e,t){const{state:r,gl:s}=this,i={stage:"fragment",code:"#version 300 es\nprecision highp float;\nvoid main() {}"};this.createProgram(i);const{computeProgram:n}=e,a=s.createProgram(),o=this.get(i).shaderGPU,u=this.get(n).shaderGPU,l=n.transforms,d=[],c=[];for(let e=0;e<l.length;e++){const t=l[e];d.push(t.varyingName),c.push(t.attributeNode)}s.attachShader(a,o),s.attachShader(a,u),s.transformFeedbackVaryings(a,d,s.SEPARATE_ATTRIBS),s.linkProgram(a),!1===s.getProgramParameter(a,s.LINK_STATUS)&&this._logProgramError(a,o,u),r.useProgram(a),this._setupBindings(t,a);const h=n.attributes,p=[],g=[];for(let e=0;e<h.length;e++){const t=h[e].node.attribute;p.push(t),this.has(t)||this.attributeUtils.createAttribute(t,s.ARRAY_BUFFER)}for(let e=0;e<c.length;e++){const t=c[e].attribute;this.has(t)||this.attributeUtils.createAttribute(t,s.ARRAY_BUFFER);const r=this.get(t);g.push(r)}this.set(e,{programGPU:a,transformBuffers:g,attributes:p})}createBindings(e,t){if(!1===this._knownBindings.has(t)){this._knownBindings.add(t);let e=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:e});for(const t of s.bindings)t.isUniformBuffer&&e++,t.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,r=this.get(e);let s=r.uniformBuffers,i=r.textures;for(const r of e.bindings){const e=this.get(r);if(r.isUniformsGroup||r.isUniformBuffer){const i=r.buffer;let{bufferGPU:n}=this.get(i);void 0===n?(n=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW),this.set(i,{bufferGPU:n})):(t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferSubData(t.UNIFORM_BUFFER,0,i)),e.index=s++,e.bufferGPU=n,this.set(r,e)}else if(r.isSampledTexture){const{textureGPU:t,glTextureType:s}=this.get(r.texture);e.index=i++,e.textureGPU=t,e.glTextureType=s,this.set(r,e)}}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(_S).filter(t=>_S[t]===e),r=this.extensions;for(let e=0;e<t.length;e++)if(r.has(t[e]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){this.textureUtils.copyTextureToTexture(e,t,r,s,i,n)}copyFramebufferToTexture(e,t,r){this.textureUtils.copyFramebufferToTexture(e,t,r)}_setFramebuffer(e){const{gl:t,state:r}=this;let s=null;if(null!==e.textures){const i=e.renderTarget,n=this.get(i),{samples:a,depthBuffer:o,stencilBuffer:u}=i,l=!0===i.isWebGLCubeRenderTarget,d=!0===i.isRenderTarget3D,c=i.depth>1,h=!0===i.isXRRenderTarget,p=!0===h&&!0===i._hasExternalTextures;let g=n.msaaFrameBuffer,m=n.depthRenderbuffer;const f=this.extensions.get("WEBGL_multisampled_render_to_texture"),y=this.extensions.get("OVR_multiview2"),b=this._useMultisampledExtension(i),x=ey(e);let T;if(l?(n.cubeFramebuffers||(n.cubeFramebuffers={}),T=n.cubeFramebuffers[x]):h&&!1===p?T=this._xrFramebuffer:(n.framebuffers||(n.framebuffers={}),T=n.framebuffers[x]),void 0===T){T=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,T);const s=e.textures,o=[];if(l){n.cubeFramebuffers[x]=T;const{textureGPU:e}=this.get(s[0]),r=this.renderer._activeCubeFace,i=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+r,e,i)}else{n.framebuffers[x]=T;for(let r=0;r<s.length;r++){const n=s[r],o=this.get(n);o.renderTarget=e.renderTarget,o.cacheKey=x;const u=t.COLOR_ATTACHMENT0+r;if(i.multiview)y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,u,o.textureGPU,0,a,0,2);else if(d||c){const e=this.renderer._activeCubeFace,r=this.renderer._activeMipmapLevel;t.framebufferTextureLayer(t.FRAMEBUFFER,u,o.textureGPU,r,e)}else if(b)f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,u,t.TEXTURE_2D,o.textureGPU,0,a);else{const e=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,u,t.TEXTURE_2D,o.textureGPU,e)}}}const h=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(!0===i._autoAllocateDepthBuffer){const r=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(r,e,0,b),n.xrDepthRenderbuffer=r,o.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,h,t.RENDERBUFFER,r)}else if(null!==e.depthTexture){o.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const r=this.get(e.depthTexture);if(r.renderTarget=e.renderTarget,r.cacheKey=x,i.multiview)y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,h,r.textureGPU,0,a,0,2);else if(p&&b)f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,h,t.TEXTURE_2D,r.textureGPU,0,a);else if(e.depthTexture.isArrayTexture){const e=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,h,r.textureGPU,0,e)}else t.framebufferTexture2D(t.FRAMEBUFFER,h,t.TEXTURE_2D,r.textureGPU,0)}n.depthInvalidationArray=o}else{if(this._isRenderCameraDepthArray(e)){r.bindFramebuffer(t.FRAMEBUFFER,T);const s=this.renderer._activeCubeFace,i=this.get(e.depthTexture),n=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,n,i.textureGPU,0,s)}if((h||b||i.multiview)&&!0!==i._isOpaqueFramebuffer){r.bindFramebuffer(t.FRAMEBUFFER,T);const s=this.get(e.textures[0]);i.multiview?y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,s.textureGPU,0,a,0,2):b?f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s.textureGPU,0);const o=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(!0===i._autoAllocateDepthBuffer){const e=n.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,o,t.RENDERBUFFER,e)}else{const r=this.get(e.depthTexture);i.multiview?y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,o,r.textureGPU,0,a,0,2):b?f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,o,t.TEXTURE_2D,r.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,o,t.TEXTURE_2D,r.textureGPU,0)}}}if(a>0&&!1===b&&!i.multiview){if(void 0===g){const s=[];g=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,g);const i=[],l=e.textures;for(let r=0;r<l.length;r++){i[r]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,i[r]),s.push(t.COLOR_ATTACHMENT0+r);const n=e.textures[r],o=this.get(n);t.renderbufferStorageMultisample(t.RENDERBUFFER,a,o.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+r,t.RENDERBUFFER,i[r])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),n.msaaFrameBuffer=g,n.msaaRenderbuffers=i,o&&void 0===m){m=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(m,e,a),n.depthRenderbuffer=m;const r=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;s.push(r)}n.invalidationArray=s}s=n.msaaFrameBuffer}else s=T;r.drawBuffers(e,T)}r.bindFramebuffer(t.FRAMEBUFFER,s)}_getVaoKey(e){let t="";for(let r=0;r<e.length;r++){t+=":"+this.get(e[r]).id}return t}_createVao(e){const{gl:t}=this,r=t.createVertexArray();t.bindVertexArray(r);for(let r=0;r<e.length;r++){const s=e[r],i=this.get(s);let n,a;t.bindBuffer(t.ARRAY_BUFFER,i.bufferGPU),t.enableVertexAttribArray(r),!0===s.isInterleavedBufferAttribute?(n=s.data.stride*i.bytesPerElement,a=s.offset*i.bytesPerElement):(n=0,a=0),i.isInteger?t.vertexAttribIPointer(r,s.itemSize,i.type,n,a):t.vertexAttribPointer(r,s.itemSize,i.type,s.normalized,n,a),s.isInstancedBufferAttribute&&!s.isInterleavedBufferAttribute?t.vertexAttribDivisor(r,s.meshPerAttribute):s.isInterleavedBufferAttribute&&s.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(r,s.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),r}_getTransformFeedback(e){let t="";for(let r=0;r<e.length;r++)t+=":"+e[r].id;let r=this.transformFeedbackCache[t];if(void 0!==r)return r;const{gl:s}=this;r=s.createTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,r);for(let t=0;t<e.length;t++){const r=e[t];s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,t,r.transformBuffer)}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=r,r}_setupBindings(e,t){const r=this.gl;for(const s of e)for(const e of s.bindings){const s=this.get(e).index;if(e.isUniformsGroup||e.isUniformBuffer){const i=r.getUniformBlockIndex(t,e.name);r.uniformBlockBinding(t,i,s)}else if(e.isSampledTexture){const i=r.getUniformLocation(t,e.name);r.uniform1i(i,s)}}}_bindUniforms(e){const{gl:t,state:r}=this;for(const s of e)for(const e of s.bindings){const s=this.get(e),i=s.index;e.isUniformsGroup||e.isUniformBuffer?r.bindBufferBase(t.UNIFORM_BUFFER,i,s.bufferGPU):e.isSampledTexture&&r.bindTexture(s.glTextureType,s.textureGPU,t.TEXTURE0+i)}}_resolveRenderTarget(e){const{gl:t,state:r}=this,s=e.renderTarget;if(null!==e.textures&&s){const i=this.get(s);if(s.samples>0&&!1===this._useMultisampledExtension(s)){const n=i.framebuffers[e.getCacheKey()];let a=t.COLOR_BUFFER_BIT;s.resolveDepthBuffer&&(s.depthBuffer&&(a|=t.DEPTH_BUFFER_BIT),s.stencilBuffer&&s.resolveStencilBuffer&&(a|=t.STENCIL_BUFFER_BIT));const o=i.msaaFrameBuffer,u=i.msaaRenderbuffers,l=e.textures,d=l.length>1;if(r.bindFramebuffer(t.READ_FRAMEBUFFER,o),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,n),d)for(let e=0;e<l.length;e++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);for(let r=0;r<l.length;r++){if(d){const{textureGPU:e}=this.get(l[r]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,u[r]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}if(e.scissor){const{x:r,y:s,width:i,height:n}=e.scissorValue,o=e.height-n-s;t.blitFramebuffer(r,o,r+i,o+n,r,o,r+i,o+n,a,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,a,t.NEAREST)}if(d)for(let e=0;e<l.length;e++){const{textureGPU:r}=this.get(l[e]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,u[e]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,r,0)}!0===this._supportsInvalidateFramebuffer&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,i.invalidationArray)}else if(!1===s.resolveDepthBuffer&&i.framebuffers){const s=i.framebuffers[e.getCacheKey()];r.bindFramebuffer(t.DRAW_FRAMEBUFFER,s),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,i.depthInvalidationArray)}}}_useMultisampledExtension(e){return!0===e.multiview||e.samples>0&&!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&!1!==e._autoAllocateDepthBuffer}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const RS="point-list",AS="line-list",wS="line-strip",CS="triangle-list",MS="triangle-strip",PS="never",BS="less",LS="equal",FS="less-equal",IS="greater",DS="not-equal",US="greater-equal",VS="always",OS="store",GS="load",kS="clear",zS="ccw",$S="cw",HS="none",WS="back",qS="uint16",jS="uint32",XS="r8unorm",KS="r8snorm",YS="r8uint",QS="r8sint",ZS="r16uint",JS="r16sint",eE="r16float",tE="rg8unorm",rE="rg8snorm",sE="rg8uint",iE="rg8sint",nE="r32uint",aE="r32sint",oE="r32float",uE="rg16uint",lE="rg16sint",dE="rg16float",cE="rgba8unorm",hE="rgba8unorm-srgb",pE="rgba8snorm",gE="rgba8uint",mE="rgba8sint",fE="bgra8unorm",yE="bgra8unorm-srgb",bE="rgb9e5ufloat",xE="rgb10a2unorm",TE="rg11b10ufloat",_E="rg32uint",vE="rg32sint",NE="rg32float",SE="rgba16uint",EE="rgba16sint",RE="rgba16float",AE="rgba32uint",wE="rgba32sint",CE="rgba32float",ME="depth16unorm",PE="depth24plus",BE="depth24plus-stencil8",LE="depth32float",FE="depth32float-stencil8",IE="bc1-rgba-unorm",DE="bc1-rgba-unorm-srgb",UE="bc2-rgba-unorm",VE="bc2-rgba-unorm-srgb",OE="bc3-rgba-unorm",GE="bc3-rgba-unorm-srgb",kE="bc4-r-unorm",zE="bc4-r-snorm",$E="bc5-rg-unorm",HE="bc5-rg-snorm",WE="bc6h-rgb-ufloat",qE="bc6h-rgb-float",jE="bc7-rgba-unorm",XE="bc7-rgba-unorm-srgb",KE="etc2-rgb8unorm",YE="etc2-rgb8unorm-srgb",QE="etc2-rgb8a1unorm",ZE="etc2-rgb8a1unorm-srgb",JE="etc2-rgba8unorm",eR="etc2-rgba8unorm-srgb",tR="eac-r11unorm",rR="eac-r11snorm",sR="eac-rg11unorm",iR="eac-rg11snorm",nR="astc-4x4-unorm",aR="astc-4x4-unorm-srgb",oR="astc-5x4-unorm",uR="astc-5x4-unorm-srgb",lR="astc-5x5-unorm",dR="astc-5x5-unorm-srgb",cR="astc-6x5-unorm",hR="astc-6x5-unorm-srgb",pR="astc-6x6-unorm",gR="astc-6x6-unorm-srgb",mR="astc-8x5-unorm",fR="astc-8x5-unorm-srgb",yR="astc-8x6-unorm",bR="astc-8x6-unorm-srgb",xR="astc-8x8-unorm",TR="astc-8x8-unorm-srgb",_R="astc-10x5-unorm",vR="astc-10x5-unorm-srgb",NR="astc-10x6-unorm",SR="astc-10x6-unorm-srgb",ER="astc-10x8-unorm",RR="astc-10x8-unorm-srgb",AR="astc-10x10-unorm",wR="astc-10x10-unorm-srgb",CR="astc-12x10-unorm",MR="astc-12x10-unorm-srgb",PR="astc-12x12-unorm",BR="astc-12x12-unorm-srgb",LR="clamp-to-edge",FR="repeat",IR="mirror-repeat",DR="linear",UR="nearest",VR="zero",OR="one",GR="src",kR="one-minus-src",zR="src-alpha",$R="one-minus-src-alpha",HR="dst",WR="one-minus-dst",qR="dst-alpha",jR="one-minus-dst-alpha",XR="src-alpha-saturated",KR="constant",YR="one-minus-constant",QR="add",ZR="subtract",JR="reverse-subtract",eA="min",tA="max",rA=0,sA=15,iA="keep",nA="zero",aA="replace",oA="invert",uA="increment-clamp",lA="decrement-clamp",dA="increment-wrap",cA="decrement-wrap",hA="storage",pA="read-only-storage",gA="write-only",mA="read-only",fA="read-write",yA="non-filtering",bA="comparison",xA="float",TA="unfilterable-float",_A="depth",vA="sint",NA="uint",SA="2d",EA="3d",RA="2d",AA="2d-array",wA="cube",CA="3d",MA="all",PA="vertex",BA="instance",LA={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"};class FA extends HN{constructor(e,t,r){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r}update(){this.texture=this.textureNode.value}}class IA extends UN{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let DA=0;class UA extends IA{constructor(e,t){super("StorageBuffer_"+DA++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:$s.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class VA extends wf{constructor(e){super(),this.device=e;this.mipmapSampler=e.createSampler({minFilter:DR}),this.flipYSampler=e.createSampler({minFilter:UR}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:"\nstruct VarysStruct {\n\t@builtin( position ) Position: vec4<f32>,\n\t@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n\tvar Varys : VarysStruct;\n\n\tvar pos = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( -1.0,  1.0 ),\n\t\tvec2<f32>(  1.0,  1.0 ),\n\t\tvec2<f32>( -1.0, -1.0 ),\n\t\tvec2<f32>(  1.0, -1.0 )\n\t);\n\n\tvar tex = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( 0.0, 0.0 ),\n\t\tvec2<f32>( 1.0, 0.0 ),\n\t\tvec2<f32>( 0.0, 1.0 ),\n\t\tvec2<f32>( 1.0, 1.0 )\n\t);\n\n\tVarys.vTex = tex[ vertexIndex ];\n\tVarys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n\treturn Varys;\n\n}\n"}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vTex );\n\n}\n"}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n"})}getTransferPipeline(e){let t=this.transferPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:MS,stripIndexFormat:jS},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:MS,stripIndexFormat:jS},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,r=0){const s=t.format,{width:i,height:n}=t.size,a=this.getTransferPipeline(s),o=this.getFlipYPipeline(s),u=this.device.createTexture({size:{width:i,height:n,depthOrArrayLayers:1},format:s,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),l=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:RA,baseArrayLayer:r}),d=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:RA,baseArrayLayer:0}),c=this.device.createCommandEncoder({}),h=(e,t,r)=>{const s=e.getBindGroupLayout(0),i=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:t}]}),n=c.beginRenderPass({colorAttachments:[{view:r,loadOp:kS,storeOp:OS,clearValue:[0,0,0,0]}]});n.setPipeline(e),n.setBindGroup(0,i),n.draw(4,1,0,0),n.end()};h(a,l,d),h(o,d,l),this.device.queue.submit([c.finish()]),u.destroy()}generateMipmaps(e,t,r=0){const s=this.get(e);void 0===s.useCount&&(s.useCount=0,s.layers=[]);const i=s.layers[r]||this._mipmapCreateBundles(e,t,r),n=this.device.createCommandEncoder({});this._mipmapRunBundles(n,i),this.device.queue.submit([n.finish()]),0!==s.useCount&&(s.layers[r]=i),s.useCount++}_mipmapCreateBundles(e,t,r){const s=this.getTransferPipeline(t.format),i=s.getBindGroupLayout(0);let n=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:RA,baseArrayLayer:r});const a=[];for(let o=1;o<t.mipLevelCount;o++){const u=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:n}]}),l=e.createView({baseMipLevel:o,mipLevelCount:1,dimension:RA,baseArrayLayer:r}),d={colorAttachments:[{view:l,loadOp:kS,storeOp:OS,clearValue:[0,0,0,0]}]},c=this.device.createRenderBundleEncoder({colorFormats:[t.format]});c.setPipeline(s),c.setBindGroup(0,u),c.draw(4,1,0,0),a.push({renderBundles:[c.finish()],passDescriptor:d}),n=l}return a}_mipmapRunBundles(e,t){const r=t.length;for(let s=0;s<r;s++){const r=t[s],i=e.beginRenderPass(r.passDescriptor);i.executeBundles(r.renderBundles),i.end()}}}const OA={[Br]:"never",[Ue]:"less",[Cr]:"equal",[Mr]:"less-equal",[Ar]:"greater",[wr]:"greater-equal",[Pr]:"always",[Rr]:"not-equal"},GA=[0,1,3,2,4,5];class kA{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new V,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,r=t.device,s=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===DR&&i.minFilter===DR&&i.mipmapFilter===DR&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&null!==e.compareFunction&&(i.compare=OA[e.compareFunction]),s.sampler=r.createSampler(i)}createDefaultTexture(e){let t;const r=zA(e);t=e.isCubeTexture?this._getDefaultCubeTextureGPU(r):this._getDefaultTextureGPU(r),this.backend.get(e).texture=t}createTexture(e,t={}){const r=this.backend,s=r.get(e);if(s.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture)return s.texture=e.sourceTexture,void(s.initialized=!0);void 0===t.needsMipmaps&&(t.needsMipmaps=!1),void 0===t.levels&&(t.levels=1),void 0===t.depth&&(t.depth=1);const{width:i,height:n,depth:a,levels:o}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),l=e.internalFormat||t.format||zA(e,r.device);s.format=l;const{samples:d,primarySamples:c,isMSAA:h}=r.utils.getTextureSampleData(e);let p=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;!0===e.isStorageTexture&&(p|=GPUTextureUsage.STORAGE_BINDING),!0!==e.isCompressedTexture&&!0!==e.isCompressedArrayTexture&&l!==bE&&(p|=GPUTextureUsage.RENDER_ATTACHMENT);const g={label:e.name,size:{width:i,height:n,depthOrArrayLayers:a},mipLevelCount:o,sampleCount:c,dimension:u,format:l,usage:p};if(void 0===l)return console.warn("WebGPURenderer: Texture format not supported."),void this.createDefaultTexture(e);if(e.isCubeTexture&&(g.textureBindingViewDimension=wA),s.texture=r.device.createTexture(g),h){const e=Object.assign({},g);e.label=e.label+"-msaa",e.sampleCount=d,e.mipLevelCount=1,s.msaaTexture=r.device.createTexture(e)}s.initialized=!0,s.textureDescriptorGPU=g}destroyTexture(e){const t=this.backend,r=t.get(e);void 0!==r.texture&&r.texture.destroy(),void 0!==r.msaaTexture&&r.msaaTexture.destroy(),t.delete(e)}destroySampler(e){delete this.backend.get(e).sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let e=0;e<6;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e);else{const r=e.image.depth||1;for(let e=0;e<r;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:r}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const r=this.backend,{width:s,height:i}=r.getDrawingBufferSize(),n=this.depthTexture,a=r.get(n).texture;let o,u;if(t?(o=Re,u=we):e&&(o=Ae,u=T),void 0!==a){if(n.image.width===s&&n.image.height===i&&n.format===o&&n.type===u)return a;this.destroyTexture(n)}return n.name="depthBuffer",n.format=o,n.type=u,n.image.width=s,n.image.height=i,this.createTexture(n,{width:s,height:i}),r.get(n).texture}updateTexture(e,t){const r=this.backend.get(e),s=e.mipmaps,{textureDescriptorGPU:i}=r;if(!e.isRenderTargetTexture&&void 0!==i){if(e.isDataTexture)if(s.length>0)for(let t=0,n=s.length;t<n;t++){const n=s[t];this._copyBufferToTexture(n,r.texture,i,0,e.flipY,0,t)}else this._copyBufferToTexture(t.image,r.texture,i,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let s=0;s<t.image.depth;s++)this._copyBufferToTexture(t.image,r.texture,i,s,e.flipY,s);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,r.texture,i);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,r.texture,i);else if(s.length>0)for(let t=0,n=s.length;t<n;t++){const n=s[t];this._copyImageToTexture(n,r.texture,i,0,e.flipY,e.premultiplyAlpha,t)}else this._copyImageToTexture(t.image,r.texture,i,0,e.flipY,e.premultiplyAlpha);r.version=e.version}}async copyTextureToBuffer(e,t,r,s,i,n){const a=this.backend.device,o=this.backend.get(e),u=o.texture,l=o.textureDescriptorGPU.format,d=this._getBytesPerTexel(l);let c=s*d;c=256*Math.ceil(c/256);const h=a.createBuffer({size:(i-1)*c+s*d,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),p=a.createCommandEncoder();p.copyTextureToBuffer({texture:u,origin:{x:t,y:r,z:n}},{buffer:h,bytesPerRow:c},{width:s,height:i});const g=this._getTypedArrayType(l);a.queue.submit([p.finish()]),await h.mapAsync(GPUMapMode.READ);return new g(h.getMappedRange())}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const r=new x;r.minFilter=v,r.magFilter=v,this.createTexture(r,{width:1,height:1,format:e}),this.defaultTexture[e]=t=r}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const r=new A;r.minFilter=v,r.magFilter=v,this.createTexture(r,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=r}return this.backend.get(t).texture}_copyCubeMapToTexture(e,t,r){const s=e.images,i=e.mipmaps;for(let n=0;n<6;n++){const a=s[n],o=!0===e.flipY?GA[n]:n;a.isDataTexture?this._copyBufferToTexture(a.image,t,r,o,e.flipY):this._copyImageToTexture(a,t,r,o,e.flipY,e.premultiplyAlpha);for(let s=0;s<i.length;s++){const a=i[s].images[n];a.isDataTexture?this._copyBufferToTexture(a.image,t,r,o,e.flipY,0,s+1):this._copyImageToTexture(a,t,r,o,e.flipY,e.premultiplyAlpha,s+1)}}}_copyImageToTexture(e,t,r,s,i,n,a=0){const o=this.backend.device,u=a>0?e.width:r.size.width,l=a>0?e.height:r.size.height;o.queue.copyExternalImageToTexture({source:e,flipY:i},{texture:t,mipLevel:a,origin:{x:0,y:0,z:s},premultipliedAlpha:n},{width:u,height:l,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return null===e&&(this._passUtils=e=new VA(this.backend.device)),e}_generateMipmaps(e,t,r=0){this._getPassUtils().generateMipmaps(e,t,r)}_flipY(e,t,r=0){this._getPassUtils().flipY(e,t,r)}_copyBufferToTexture(e,t,r,s,i,n=0,a=0){const o=this.backend.device,u=e.data,l=this._getBytesPerTexel(r.format),d=e.width*l;o.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:s}},u,{offset:e.width*e.height*l*n,bytesPerRow:d},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===i&&this._flipY(t,r,s)}_copyCompressedBufferToTexture(e,t,r){const s=this.backend.device,i=this._getBlockData(r.format),n=r.size.depthOrArrayLayers>1;for(let a=0;a<e.length;a++){const o=e[a],u=o.width,l=o.height,d=n?r.size.depthOrArrayLayers:1,c=Math.ceil(u/i.width)*i.byteLength,h=c*Math.ceil(l/i.height);for(let e=0;e<d;e++)s.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:e}},o.data,{offset:e*h,bytesPerRow:c,rowsPerImage:Math.ceil(l/i.height)},{width:Math.ceil(u/i.width)*i.width,height:Math.ceil(l/i.height)*i.height,depthOrArrayLayers:1})}}_getBlockData(e){return e===IE||e===DE?{byteLength:8,width:4,height:4}:e===UE||e===VE||e===OE||e===GE?{byteLength:16,width:4,height:4}:e===kE||e===zE?{byteLength:8,width:4,height:4}:e===$E||e===HE||e===WE||e===qE||e===jE||e===XE?{byteLength:16,width:4,height:4}:e===KE||e===YE||e===QE||e===ZE?{byteLength:8,width:4,height:4}:e===JE||e===eR?{byteLength:16,width:4,height:4}:e===tR||e===rR?{byteLength:8,width:4,height:4}:e===sR||e===iR||e===nR||e===aR?{byteLength:16,width:4,height:4}:e===oR||e===uR?{byteLength:16,width:5,height:4}:e===lR||e===dR?{byteLength:16,width:5,height:5}:e===cR||e===hR?{byteLength:16,width:6,height:5}:e===pR||e===gR?{byteLength:16,width:6,height:6}:e===mR||e===fR?{byteLength:16,width:8,height:5}:e===yR||e===bR?{byteLength:16,width:8,height:6}:e===xR||e===TR?{byteLength:16,width:8,height:8}:e===_R||e===vR?{byteLength:16,width:10,height:5}:e===NR||e===SR?{byteLength:16,width:10,height:6}:e===ER||e===RR?{byteLength:16,width:10,height:8}:e===AR||e===wR?{byteLength:16,width:10,height:10}:e===CR||e===MR?{byteLength:16,width:12,height:10}:e===PR||e===BR?{byteLength:16,width:12,height:12}:void 0}_convertAddressMode(e){let t=LR;return e===Sr?t=FR:e===vr&&(t=IR),t}_convertFilterMode(e){let t=DR;return e!==v&&e!==Er&&e!==ze||(t=UR),t}_getBytesPerTexel(e){return e===XS||e===KS||e===YS||e===QS?1:e===ZS||e===JS||e===eE||e===tE||e===rE||e===sE||e===iE?2:e===nE||e===aE||e===oE||e===uE||e===lE||e===dE||e===cE||e===hE||e===pE||e===gE||e===mE||e===fE||e===yE||e===bE||e===xE||e===TE||e===LE||e===PE||e===BE||e===FE?4:e===_E||e===vE||e===NE||e===SE||e===EE||e===RE?8:e===AE||e===wE||e===CE?16:void 0}_getTypedArrayType(e){return e===YS?Uint8Array:e===QS?Int8Array:e===XS?Uint8Array:e===KS?Int8Array:e===sE?Uint8Array:e===iE?Int8Array:e===tE?Uint8Array:e===rE?Int8Array:e===gE?Uint8Array:e===mE?Int8Array:e===cE||e===hE?Uint8Array:e===pE?Int8Array:e===ZS?Uint16Array:e===JS?Int16Array:e===uE?Uint16Array:e===lE?Int16Array:e===SE?Uint16Array:e===EE?Int16Array:e===eE||e===dE||e===RE?Uint16Array:e===nE?Uint32Array:e===aE?Int32Array:e===oE?Float32Array:e===_E?Uint32Array:e===vE?Int32Array:e===NE?Float32Array:e===AE?Uint32Array:e===wE?Int32Array:e===CE?Float32Array:e===fE||e===yE?Uint8Array:e===xE||e===bE||e===TE?Uint32Array:e===LE?Float32Array:e===PE||e===BE?Uint32Array:e===FE?Float32Array:void 0}_getDimension(e){let t;return t=e.is3DTexture||e.isData3DTexture?EA:SA,t}}function zA(e,t=null){const r=e.format,s=e.type,i=e.colorSpace,n=c.getTransfer(i);let a;if(!0===e.isCompressedTexture||!0===e.isCompressedArrayTexture)switch(r){case qt:case jt:a=n===h?DE:IE;break;case Xt:a=n===h?VE:UE;break;case Kt:a=n===h?GE:OE;break;case br:a=kE;break;case xr:a=zE;break;case Tr:a=$E;break;case _r:a=HE;break;case yr:a=n===h?XE:jE;break;case tr:case er:a=n===h?YE:KE;break;case rr:a=n===h?eR:JE;break;case sr:a=n===h?aR:nR;break;case ir:a=n===h?uR:oR;break;case nr:a=n===h?dR:lR;break;case ar:a=n===h?hR:cR;break;case or:a=n===h?gR:pR;break;case ur:a=n===h?fR:mR;break;case lr:a=n===h?bR:yR;break;case dr:a=n===h?TR:xR;break;case cr:a=n===h?vR:_R;break;case hr:a=n===h?SR:NR;break;case pr:a=n===h?RR:ER;break;case gr:a=n===h?wR:AR;break;case mr:a=n===h?MR:CR;break;case fr:a=n===h?BR:PR;break;case de:a=n===h?hE:cE;break;default:console.error("WebGPURenderer: Unsupported texture format.",r)}else switch(r){case de:switch(s){case ut:a=pE;break;case ot:a=EE;break;case lt:a=SE;break;case T:a=AE;break;case _:a=wE;break;case Ce:a=n===h?hE:cE;break;case ce:a=RE;break;case I:a=CE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",s)}break;case ht:switch(s){case $t:a=bE;break;case Ht:a=TE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",s)}break;case at:switch(s){case ut:a=KS;break;case ot:a=JS;break;case lt:a=ZS;break;case T:a=nE;break;case _:a=aE;break;case Ce:a=XS;break;case ce:a=eE;break;case I:a=oE;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",s)}break;case Ve:switch(s){case ut:a=rE;break;case ot:a=lE;break;case lt:a=uE;break;case T:a=_E;break;case _:a=vE;break;case Ce:a=tE;break;case ce:a=dE;break;case I:a=NE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",s)}break;case Ae:switch(s){case lt:a=ME;break;case T:a=PE;break;case I:a=LE;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",s)}break;case Re:switch(s){case we:a=BE;break;case I:t&&!1===t.features.has(LA.Depth32FloatStencil8)&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),a=FE;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",s)}break;case nt:switch(s){case _:a=aE;break;case T:a=nE;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",s)}break;case dt:switch(s){case _:a=vE;break;case T:a=_E;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",s)}break;case pt:switch(s){case _:a=wE;break;case T:a=AE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",s)}break;default:console.error("WebGPURenderer: Unsupported texture format.",r)}return a}const $A=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,HA=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/gi,WA={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"};class qA extends Jv{constructor(e){const{type:t,inputs:r,name:s,inputsCode:i,blockCode:n,outputType:a}=(e=>{const t=(e=e.trim()).match($A);if(null!==t&&4===t.length){const r=t[2],s=[];let i=null;for(;null!==(i=HA.exec(r));)s.push({name:i[1],type:i[2]});const n=[];for(let e=0;e<s.length;e++){const{name:t,type:r}=s[e];let i=r;i.startsWith("ptr")?i="pointer":(i.startsWith("texture")&&(i=r.split("<")[0]),i=WA[i]),n.push(new Ov(i,t))}const a=e.substring(t[0].length),o=t[3]||"void",u=void 0!==t[1]?t[1]:"";return{type:WA[o]||o,inputs:n,name:u,inputsCode:r,blockCode:a,outputType:o}}throw new Error("FunctionNode: Function is not a WGSL code.")})(e);super(t,r,s),this.inputsCode=i,this.blockCode=n,this.outputType=a}getCode(e=this.name){const t="void"!==this.outputType?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class jA extends Zv{parseFunction(e){return new qA(e)}}const XA="undefined"!=typeof self?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},KA={[$s.READ_ONLY]:"read",[$s.WRITE_ONLY]:"write",[$s.READ_WRITE]:"read_write"},YA={[Sr]:"repeat",[Nr]:"clamp",[vr]:"mirror"},QA={vertex:XA?XA.VERTEX:1,fragment:XA?XA.FRAGMENT:2,compute:XA?XA.COMPUTE:4},ZA={instance:!0,swizzleAssign:!1,storageBuffer:!0},JA={"^^":"tsl_xor"},ew={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},tw={},rw={tsl_xor:new sx("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new sx("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new sx("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new sx("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new sx("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new sx("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new sx("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new sx("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new sx("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new sx("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new sx("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new sx("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new sx("\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {\n\n\tlet res = vec2f( iRes );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n\tlet rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n\tlet rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n\tlet rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n")},sw={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};let iw="";!0!==("undefined"!=typeof navigator&&/Firefox|Deno/g.test(navigator.userAgent))&&(iw+="diagnostic( off, derivative_uniformity );\n");class nw extends Uv{constructor(e,t){super(e,t,new jA),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}_generateTextureSample(e,t,r,s,i,n=this.shaderStage){return"fragment"===n?s?i?`textureSample( ${t}, ${t}_sampler, ${r}, ${s}, ${i} )`:`textureSample( ${t}, ${t}_sampler, ${r}, ${s} )`:i?`textureSample( ${t}, ${t}_sampler, ${r}, ${i} )`:`textureSample( ${t}, ${t}_sampler, ${r} )`:this.generateTextureSampleLevel(e,t,r,"0",s)}generateTextureSampleLevel(e,t,r,s,i,n){return!1===this.isUnfilterable(e)?n?`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,n,s):this.generateTextureLod(e,t,r,i,n,s)}generateWrapFunction(e){const t=`tsl_coord_${YA[e.wrapS]}S_${YA[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let r=tw[t];if(void 0===r){const s=[],i=e.isData3DTexture?"vec3f":"vec2f";let n=`fn ${t}( coord : ${i} ) -> ${i} {\n\n\treturn ${i}(\n`;const a=(e,t)=>{e===Sr?(s.push(rw.repeatWrapping_float),n+=`\t\ttsl_repeatWrapping_float( coord.${t} )`):e===Nr?(s.push(rw.clampWrapping_float),n+=`\t\ttsl_clampWrapping_float( coord.${t} )`):e===vr?(s.push(rw.mirrorWrapping_float),n+=`\t\ttsl_mirrorWrapping_float( coord.${t} )`):(n+=`\t\tcoord.${t}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${e}" for vertex shader.`))};a(e.wrapS,"x"),n+=",\n",a(e.wrapT,"y"),e.isData3DTexture&&(n+=",\n",a(e.wrapR,"z")),n+="\n\t);\n\n}\n",tw[t]=r=new sx(n,s)}return r.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,r){const s=this.getDataFromNode(e,this.shaderStage,this.globalCache);void 0===s.dimensionsSnippet&&(s.dimensionsSnippet={});let i=s.dimensionsSnippet[r];if(void 0===s.dimensionsSnippet[r]){let n,a;const{primarySamples:o}=this.renderer.backend.utils.getTextureSampleData(e),u=o>1;a=e.isData3DTexture?"vec3<u32>":"vec2<u32>",n=u||e.isStorageTexture?t:`${t}${r?`, u32( ${r} )`:""}`,i=new du(new Xu(`textureDimensions( ${n} )`,a)),s.dimensionsSnippet[r]=i,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(s.arrayLayerCount=new du(new Xu(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(s.cubeFaceCount=new du(new Xu("6u","u32")))}return i.build(this)}generateFilteredTexture(e,t,r,s,i="0u"){this._include("biquadraticTexture");const n=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,i);return s&&(r=`${r} + vec2<f32>(${s}) / ${a}`),`tsl_biquadraticTexture( ${t}, ${n}( ${r} ), ${a}, u32( ${i} ) )`}generateTextureLod(e,t,r,s,i,n="0u"){const a=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,n),u=e.isData3DTexture?"vec3":"vec2";i&&(r=`${r} + ${u}<f32>(${i}) / ${u}<f32>( ${o} )`);const l=`${u}<u32>( ${a}( ${r} ) * ${u}<f32>( ${o} ) )`;return this.generateTextureLoad(e,t,l,s,null,n)}generateTextureLoad(e,t,r,s,i,n="0u"){let a;return i&&(r=`${r} + ${i}`),s?a=`textureLoad( ${t}, ${r}, ${s}, u32( ${n} ) )`:(a=`textureLoad( ${t}, ${r}, u32( ${n} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,t,r,s,i){let n;return n=s?`textureStore( ${t}, ${r}, ${s}, ${i} )`:`textureStore( ${t}, ${r}, ${i} )`,n}isSampleCompare(e){return!0===e.isDepthTexture&&null!==e.compareFunction}isUnfilterable(e){return"float"!==this.getComponentTypeFromTexture(e)||!this.isAvailable("float32Filterable")&&!0===e.isDataTexture&&e.type===I||!1===this.isSampleCompare(e)&&e.minFilter===v&&e.magFilter===v||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,r,s,i,n=this.shaderStage){let a=null;return a=this.isUnfilterable(e)?this.generateTextureLod(e,t,r,s,i,"0",n):this._generateTextureSample(e,t,r,s,i,n),a}generateTextureGrad(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return n?`textureSampleGrad( ${t}, ${t}_sampler, ${r},  ${s[0]}, ${s[1]}, ${n} )`:`textureSampleGrad( ${t}, ${t}_sampler, ${r},  ${s[0]}, ${s[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${a} shader.`)}generateTextureCompare(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return!0===e.isDepthTexture&&!0===e.isArrayTexture?n?`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${i}, ${s}, ${n} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${i}, ${s} )`:n?`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${s} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}generateTextureLevel(e,t,r,s,i,n){return!1===this.isUnfilterable(e)?n?`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,n,s):this.generateTextureLod(e,t,r,i,n,s)}generateTextureBias(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return n?`textureSampleBias( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleBias( ${t}, ${t}_sampler, ${r}, ${s} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${a} shader.`)}getPropertyName(e,t=this.shaderStage){if(!0===e.isNodeVarying&&!0===e.needsInterpolation){if("vertex"===t)return`varyings.${e.name}`}else if(!0===e.isNodeUniform){const t=e.name,r=e.type;return"texture"===r||"cubeTexture"===r||"storageTexture"===r||"texture3D"===r?t:"buffer"===r||"storageBuffer"===r||"indirectStorageBuffer"===r?this.isCustomStruct(e)?t:t+".value":e.groupNode.name+"."+t}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=JA[e];return void 0!==t?(this._include(t),t):null}getNodeAccess(e,t){return"compute"!==t?!0===e.isAtomic?(console.warn("WebGPURenderer: Atomic operations are only supported in compute shaders."),$s.READ_WRITE):$s.READ_ONLY:e.access}getStorageAccess(e,t){return KA[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,r,s=null){const i=super.getUniformFromNode(e,t,r,s),n=this.getDataFromNode(e,r,this.globalCache);if(void 0===n.uniformGPU){let a;const o=e.groupNode,u=o.name,l=this.getBindGroupArray(u,r);if("texture"===t||"cubeTexture"===t||"storageTexture"===t||"texture3D"===t){let s=null;const n=this.getNodeAccess(e,r);if("texture"===t||"storageTexture"===t?s=!0===e.value.is3DTexture?new KN(i.name,i.node,o,n):new jN(i.name,i.node,o,n):"cubeTexture"===t?s=new XN(i.name,i.node,o,n):"texture3D"===t&&(s=new KN(i.name,i.node,o,n)),s.store=!0===e.isStorageTextureNode,s.setVisibility(QA[r]),!1===this.isUnfilterable(e.value)&&!1===s.store){const e=new FA(`${i.name}_sampler`,i.node,o);e.setVisibility(QA[r]),l.push(e,s),a=[e,s]}else l.push(s),a=[s]}else if("buffer"===t||"storageBuffer"===t||"indirectStorageBuffer"===t){const n=new("buffer"===t?GN:UA)(e,o);n.setVisibility(QA[r]),l.push(n),a=n,i.name=s||"NodeBuffer_"+i.id}else{const e=this.uniformGroups[r]||(this.uniformGroups[r]={});let s=e[u];void 0===s&&(s=new $N(u,o),s.setVisibility(QA[r]),e[u]=s,l.push(s)),a=this.getNodeUniform(i,t),s.addUniform(a)}n.uniformGPU=a}return i}getBuiltin(e,t,r,s=this.shaderStage){const i=this.builtins[s]||(this.builtins[s]=new Map);return!1===i.has(e)&&i.set(e,{name:e,property:t,type:r}),t}hasBuiltin(e,t=this.shaderStage){return void 0!==this.builtins[t]&&this.builtins[t].has(e)}getVertexIndex(){return"vertex"===this.shaderStage?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,r=this.flowShaderNode(e),s=[];for(const e of t.inputs)s.push(e.name+" : "+this.getType(e.type));let i=`fn ${t.name}( ${s.join(", ")} ) -> ${this.getType(t.type)} {\n${r.vars}\n${r.code}\n`;return r.result&&(i+=`\treturn ${r.result};\n`),i+="\n}\n",i}getInstanceIndex(){return"vertex"===this.shaderStage?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],r=this.directives[e];if(void 0!==r)for(const e of r)t.push(`enable ${e};`);return t.join("\n")}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],r=this.builtins[e];if(void 0!==r)for(const{name:e,property:s,type:i}of r.values())t.push(`@builtin( ${e} ) ${s} : ${i}`);return t.join(",\n\t")}getScopedArray(e,t,r,s){return!1===this.scopedArrays.has(e)&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:r,bufferCount:s}),e}getScopedArrays(e){if("compute"!==e)return;const t=[];for(const{name:e,scope:r,bufferType:s,bufferCount:i}of this.scopedArrays.values()){const n=this.getType(s);t.push(`var<${r}> ${e}: array< ${n}, ${i} >;`)}return t.join("\n")}getAttributes(e){const t=[];if("compute"===e&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),"vertex"===e||"compute"===e){const e=this.getBuiltins("attribute");e&&t.push(e);const r=this.getAttributesArray();for(let e=0,s=r.length;e<s;e++){const s=r[e],i=s.name,n=this.getType(s.type);t.push(`@location( ${e} ) ${i} : ${n}`)}}return t.join(",\n\t")}getStructMembers(e){const t=[];for(const r of e.members){const s=e.output?"@location( "+r.index+" ) ":"";let i=this.getType(r.type);r.atomic&&(i="atomic< "+i+" >"),t.push(`\t${s+r.name} : ${i}`)}return e.output&&t.push(`\t${this.getBuiltins("output")}`),t.join(",\n")}getStructs(e){let t="";const r=this.structs[e];if(r.length>0){const e=[];for(const t of r){let r=`struct ${t.name} {\n`;r+=this.getStructMembers(t),r+="\n};",e.push(r)}t="\n"+e.join("\n\n")+"\n"}return t}getVar(e,t,r=null){let s=`var ${t} : `;return s+=null!==r?this.generateArrayDeclaration(e,r):this.getType(e),s}getVars(e){const t=[],r=this.vars[e];if(void 0!==r)for(const e of r)t.push(`\t${this.getVar(e.type,e.name,e.count)};`);return`\n${t.join("\n")}\n`}getVaryings(e){const t=[];if("vertex"===e&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),"vertex"===e||"fragment"===e){const r=this.varyings,s=this.vars[e];for(let i=0;i<r.length;i++){const n=r[i];if(n.needsInterpolation){let e=`@location( ${i} )`;if(n.interpolationType){const t=null!==n.interpolationSampling?`, ${n.interpolationSampling} )`:" )";e+=` @interpolate( ${n.interpolationType}${t}`}else/^(int|uint|ivec|uvec)/.test(n.type)&&(e+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${e} ${n.name} : ${this.getType(n.type)}`)}else"vertex"===e&&!1===s.includes(n)&&s.push(n)}}const r=this.getBuiltins(e);r&&t.push(r);const s=t.join(",\n\t");return"vertex"===e?this._getWGSLStruct("VaryingsStruct","\t"+s):s}isCustomStruct(e){const t=e.value,r=e.node,s=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&null!==r.structTypeNode,i=r.value&&r.value.array&&"number"==typeof r.value.itemSize&&r.value.array.length>r.value.itemSize;return s&&!i}getUniforms(e){const t=this.uniforms[e],r=[],s=[],i=[],n={};for(const i of t){const t=i.groupNode.name,a=this.bindingsIndexes[t];if("texture"===i.type||"cubeTexture"===i.type||"storageTexture"===i.type||"texture3D"===i.type){const t=i.node.value;let s;!1===this.isUnfilterable(t)&&!0!==i.node.isStorageTextureNode&&(this.isSampleCompare(t)?r.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var ${i.name}_sampler : sampler_comparison;`):r.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var ${i.name}_sampler : sampler;`));let n="";const{primarySamples:o}=this.renderer.backend.utils.getTextureSampleData(t);if(o>1&&(n="_multisampled"),!0===t.isCubeTexture)s="texture_cube<f32>";else if(!0===t.isDepthTexture)s=this.renderer.backend.compatibilityMode&&null===t.compareFunction?`texture${n}_2d<f32>`:`texture_depth${n}_2d${!0===t.isArrayTexture?"_array":""}`;else if(!0===i.node.isStorageTextureNode){const r=zA(t),n=this.getStorageAccess(i.node,e),a=i.node.value.is3DTexture,o=i.node.value.isArrayTexture;s=`texture_storage_${a?"3d":"2d"+(o?"_array":"")}<${r}, ${n}>`}else if(!0===t.isArrayTexture||!0===t.isDataArrayTexture||!0===t.isCompressedArrayTexture)s="texture_2d_array<f32>";else if(!0===t.is3DTexture||!0===t.isData3DTexture)s="texture_3d<f32>";else{s=`texture${n}_2d<${this.getComponentTypeFromTexture(t).charAt(0)}32>`}r.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var ${i.name} : ${s};`)}else if("buffer"===i.type||"storageBuffer"===i.type||"indirectStorageBuffer"===i.type){const t=i.node,r=this.getType(t.getNodeType(this)),n=t.bufferCount,o=n>0&&"buffer"===i.type?", "+n:"",u=t.isStorageBufferNode?`storage, ${this.getStorageAccess(t,e)}`:"uniform";if(this.isCustomStruct(i))s.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var<${u}> ${i.name} : ${r};`);else{const e=`\tvalue : array< ${t.isAtomic?`atomic<${r}>`:`${r}`}${o} >`;s.push(this._getWGSLStructBinding(i.name,e,u,a.binding++,a.group))}}else{const e=this.getType(this.getVectorType(i.type)),t=i.groupNode.name;(n[t]||(n[t]={index:a.binding++,id:a.group,snippets:[]})).snippets.push(`\t${i.name} : ${e}`)}}for(const e in n){const t=n[e];i.push(this._getWGSLStructBinding(e,t.snippets.join(",\n"),"uniform",t.index,t.id))}let a=r.join("\n");return a+=s.join("\n"),a+=i.join("\n"),a}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const r=e[t];r.uniforms=this.getUniforms(t),r.attributes=this.getAttributes(t),r.varyings=this.getVaryings(t),r.structs=this.getStructs(t),r.vars=this.getVars(t),r.codes=this.getCodes(t),r.directives=this.getDirectives(t),r.scopedArrays=this.getScopedArrays(t);let s="// code\n\n";s+=this.flowCode[t];const i=this.flowNodes[t],n=i[i.length-1],a=n.outputNode,o=void 0!==a&&!0===a.isOutputStructNode;for(const e of i){const i=this.getFlowData(e),u=e.name;if(u&&(s.length>0&&(s+="\n"),s+=`\t// flow -> ${u}\n`),s+=`${i.code}\n\t`,e===n&&"compute"!==t)if(s+="// result\n\n\t","vertex"===t)s+=`varyings.Vertex = ${i.result};`;else if("fragment"===t)if(o)r.returnType=a.getNodeType(this),r.structs+="var<private> output : "+r.returnType+";",s+=`return ${i.result};`;else{let e="\t@location(0) color: vec4<f32>";const t=this.getBuiltins("output");t&&(e+=",\n\t"+t),r.returnType="OutputStruct",r.structs+=this._getWGSLStruct("OutputStruct",e),r.structs+="\nvar<private> output : OutputStruct;",s+=`output.color = ${i.result};\n\n\treturn output;`}}r.flow=s}if(this.shaderStage=null,null!==this.material)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{const t=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,t)}}getMethod(e,t=null){let r;return null!==t&&(r=this._getWGSLMethod(e+"_"+t)),void 0===r&&(r=this._getWGSLMethod(e)),r||e}getBitcastMethod(e){return`bitcast<${this.getType(e)}>`}getTernary(e,t,r){return`select( ${r}, ${t}, ${e} )`}getType(e){return ew[e]||e}isAvailable(e){let t=ZA[e];return void 0===t&&("float32Filterable"===e?t=this.renderer.hasFeature("float32-filterable"):"clipDistance"===e&&(t=this.renderer.hasFeature("clip-distances")),ZA[e]=t),t}_getWGSLMethod(e){return void 0!==rw[e]&&this._include(e),sw[e]}_include(e){const t=rw[e];return t.build(this),null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}\n// directives\n${e.directives}\n\n// structs\n${e.structs}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\nvar<private> varyings : VaryingsStruct;\n\n// codes\n${e.codes}\n\n@vertex\nfn main( ${e.attributes} ) -> VaryingsStruct {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n\treturn varyings;\n\n}\n`}_getWGSLFragmentCode(e){return`${this.getSignature()}\n// global\n${iw}\n\n// structs\n${e.structs}\n\n// uniforms\n${e.uniforms}\n\n// codes\n${e.codes}\n\n@fragment\nfn main( ${e.varyings} ) -> ${e.returnType} {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}_getWGSLComputeCode(e,t){const[r,s,i]=t;return`${this.getSignature()}\n// directives\n${e.directives}\n\n// system\nvar<private> instanceIndex : u32;\n\n// locals\n${e.scopedArrays}\n\n// structs\n${e.structs}\n\n// uniforms\n${e.uniforms}\n\n// codes\n${e.codes}\n\n@compute @workgroup_size( ${r}, ${s}, ${i} )\nfn main( ${e.attributes} ) {\n\n\t// system\n\tinstanceIndex = globalId.x\n\t\t+ globalId.y * ( ${r} * numWorkgroups.x )\n\t\t+ globalId.z * ( ${r} * numWorkgroups.x ) * ( ${s} * numWorkgroups.y );\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}_getWGSLStruct(e,t){return`\nstruct ${e} {\n${t}\n};`}_getWGSLStructBinding(e,t,r,s=0,i=0){const n=e+"Struct";return`${this._getWGSLStruct(n,t)}\n@binding( ${s} ) @group( ${i} )\nvar<${r}> ${e} : ${n};`}}class aw{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return null!==e.depthTexture?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=BE:e.depth&&(t=PE),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const e=this.backend.renderer,r=e.getRenderTarget();t=r?r.samples:e.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const r=t>1&&null!==e.renderTarget&&!0!==e.isDepthTexture&&!0!==e.isFramebufferTexture;return{samples:t,primarySamples:r?1:t,isMSAA:r}}getCurrentColorFormat(e){let t;return t=null!==e.textures?this.getTextureFormatGPU(e.textures[0]):this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return null!==e.textures?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){return e.isPoints?RS:e.isLineSegments||e.isMesh&&!0===t.wireframe?AS:e.isLine?wS:e.isMesh?CS:void 0}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return null!==e.textures?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(void 0===e)return navigator.gpu.getPreferredCanvasFormat();if(e===Ce)return fE;if(e===ce)return RE;throw new Error("Unsupported outputType")}}const ow=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);"undefined"!=typeof Float16Array&&ow.set(Float16Array,["float16"]);const uw=new Map([[$e,["float16"]]]),lw=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class dw{constructor(e){this.backend=e}createAttribute(e,t){const r=this._getBufferAttribute(e),s=this.backend,i=s.get(r);let n=i.buffer;if(void 0===n){const a=s.device;let o=r.array;if(!1===e.normalized)if(o.constructor===Int16Array||o.constructor===Int8Array)o=new Int32Array(o);else if((o.constructor===Uint16Array||o.constructor===Uint8Array)&&(o=new Uint32Array(o),t&GPUBufferUsage.INDEX))for(let e=0;e<o.length;e++)65535===o[e]&&(o[e]=4294967295);if(r.array=o,(r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute)&&3===r.itemSize){o=new o.constructor(4*r.count);for(let e=0;e<r.count;e++)o.set(r.array.subarray(3*e,3*e+3),4*e);r.itemSize=4,r.array=o,i._force3to4BytesAlignment=!0}const u=o.byteLength,l=u+(4-u%4)%4;n=a.createBuffer({label:r.name,size:l,usage:t,mappedAtCreation:!0}),new o.constructor(n.getMappedRange()).set(o),n.unmap(),i.buffer=n}}updateAttribute(e){const t=this._getBufferAttribute(e),r=this.backend,s=r.device,i=r.get(t),n=r.get(t).buffer;let a=t.array;if(!0===i._force3to4BytesAlignment){a=new a.constructor(4*t.count);for(let e=0;e<t.count;e++)a.set(t.array.subarray(3*e,3*e+3),4*e);t.array=a}const o=this._isTypedArray(a),u=t.updateRanges;if(0===u.length)s.queue.writeBuffer(n,0,a,0);else{const e=o?1:a.BYTES_PER_ELEMENT;for(let t=0,r=u.length;t<r;t++){const r=u[t];let l,d;if(!0===i._force3to4BytesAlignment){l=4*Math.floor(r.start/3)*e,d=4*Math.ceil(r.count/3)*e}else l=r.start*e,d=r.count*e;const c=l*(o?a.BYTES_PER_ELEMENT:1);s.queue.writeBuffer(n,c,a,l,d)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),r=new Map;for(let e=0;e<t.length;e++){const s=t[e],i=s.array.BYTES_PER_ELEMENT,n=this._getBufferAttribute(s);let a=r.get(n);if(void 0===a){let e,t;!0===s.isInterleavedBufferAttribute?(e=s.data.stride*i,t=s.data.isInstancedInterleavedBuffer?BA:PA):(e=s.itemSize*i,t=s.isInstancedBufferAttribute?BA:PA),!1!==s.normalized||s.array.constructor!==Int16Array&&s.array.constructor!==Uint16Array||(e=4),a={arrayStride:e,attributes:[],stepMode:t},r.set(n,a)}const o=this._getVertexFormat(s),u=!0===s.isInterleavedBufferAttribute?s.offset*i:0;a.attributes.push({shaderLocation:e,offset:u,format:o})}return Array.from(r.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,r=t.device,s=t.get(this._getBufferAttribute(e)).buffer,i=s.size,n=r.createBuffer({label:`${e.name}_readback`,size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),a=r.createCommandEncoder({label:`readback_encoder_${e.name}`});a.copyBufferToBuffer(s,0,n,0,i);const o=a.finish();r.queue.submit([o]),await n.mapAsync(GPUMapMode.READ);const u=n.getMappedRange(),l=new e.array.constructor(u.slice(0));return n.unmap(),l.buffer}_getVertexFormat(e){const{itemSize:t,normalized:r}=e,s=e.array.constructor,i=e.constructor;let n;if(1===t)n=lw.get(s);else{const e=(uw.get(i)||ow.get(s))[r?1:0];if(e){const r=s.BYTES_PER_ELEMENT*t,i=4*Math.floor((r+3)/4)/s.BYTES_PER_ELEMENT;if(i%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");n=`${e}x${i}`}}return n||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),n}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class cw{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,r=t.device,s=[];let i=0;for(const r of e.bindings){const e={binding:i++,visibility:r.visibility};if(r.isUniformBuffer||r.isStorageBuffer){const t={};r.isStorageBuffer&&(4&r.visibility&&(r.access===$s.READ_WRITE||r.access===$s.WRITE_ONLY)?t.type=hA:t.type=pA),e.buffer=t}else if(r.isSampledTexture&&r.store){const t={};t.format=this.backend.get(r.texture).texture.format;const s=r.access;t.access=s===$s.READ_WRITE?fA:s===$s.WRITE_ONLY?gA:mA,r.texture.isArrayTexture?t.viewDimension=AA:r.texture.is3DTexture&&(t.viewDimension=CA),e.storageTexture=t}else if(r.isSampledTexture){const s={},{primarySamples:i}=t.utils.getTextureSampleData(r.texture);if(i>1&&(s.multisampled=!0,r.texture.isDepthTexture||(s.sampleType=TA)),r.texture.isDepthTexture)t.compatibilityMode&&null===r.texture.compareFunction?s.sampleType=TA:s.sampleType=_A;else if(r.texture.isDataTexture||r.texture.isDataArrayTexture||r.texture.isData3DTexture){const e=r.texture.type;e===_?s.sampleType=vA:e===T?s.sampleType=NA:e===I&&(this.backend.hasFeature("float32-filterable")?s.sampleType=xA:s.sampleType=TA)}r.isSampledCubeTexture?s.viewDimension=wA:r.texture.isArrayTexture||r.texture.isDataArrayTexture||r.texture.isCompressedArrayTexture?s.viewDimension=AA:r.isSampledTexture3D&&(s.viewDimension=CA),e.texture=s}else if(r.isSampler){const s={};r.texture.isDepthTexture&&(null!==r.texture.compareFunction?s.type=bA:t.compatibilityMode&&(s.type=yA)),e.sampler=s}else console.error(`WebGPUBindingUtils: Unsupported binding "${r}".`);s.push(e)}return r.createBindGroupLayout({entries:s})}createBindings(e,t,r,s=0){const{backend:i,bindGroupLayoutCache:n}=this,a=i.get(e);let o,u=n.get(e.bindingsReference);void 0===u&&(u=this.createBindingsLayout(e),n.set(e.bindingsReference,u)),r>0&&(void 0===a.groups&&(a.groups=[],a.versions=[]),a.versions[r]===s&&(o=a.groups[r])),void 0===o&&(o=this.createBindGroup(e,u),r>0&&(a.groups[r]=o,a.versions[r]=s)),a.group=o,a.layout=u}updateBinding(e){const t=this.backend,r=t.device,s=e.buffer,i=t.get(e).buffer;r.queue.writeBuffer(i,0,s,0)}createBindGroupIndex(e,t){const r=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,i=e[0],n=r.createBuffer({label:"bindingCameraIndex_"+i,size:16,usage:s});r.queue.writeBuffer(n,0,e,0);const a=[{binding:0,resource:{buffer:n}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+i,layout:t,entries:a})}createBindGroup(e,t){const r=this.backend,s=r.device;let i=0;const n=[];for(const t of e.bindings){if(t.isUniformBuffer){const e=r.get(t);if(void 0===e.buffer){const r=t.byteLength,i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,n=s.createBuffer({label:"bindingBuffer_"+t.name,size:r,usage:i});e.buffer=n}n.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isStorageBuffer){const e=r.get(t);if(void 0===e.buffer){const s=t.attribute;e.buffer=r.get(s).buffer}n.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isSampledTexture){const e=r.get(t.texture);let a;if(void 0!==e.externalTexture)a=s.importExternalTexture({source:e.externalTexture});else{const r=t.store?1:e.texture.mipLevelCount;let s=`view-${e.texture.width}-${e.texture.height}`;if(e.texture.depthOrArrayLayers>1&&(s+=`-${e.texture.depthOrArrayLayers}`),s+=`-${r}`,a=e[s],void 0===a){const i=MA;let n;n=t.isSampledCubeTexture?wA:t.isSampledTexture3D?CA:t.texture.isArrayTexture||t.texture.isDataArrayTexture||t.texture.isCompressedArrayTexture?AA:RA,a=e[s]=e.texture.createView({aspect:i,dimension:n,mipLevelCount:r})}}n.push({binding:i,resource:a})}else if(t.isSampler){const e=r.get(t.texture);n.push({binding:i,resource:e.sampler})}i++}return s.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:n})}}class hw{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:r,material:s,geometry:i,pipeline:n}=e,{vertexProgram:a,fragmentProgram:o}=n,u=this.backend,l=u.device,d=u.utils,c=u.get(n),h=[];for(const t of e.getBindings()){const e=u.get(t);h.push(e.layout)}const p=u.attributeUtils.createShaderVertexBuffers(e);let g;s.blending===$||s.blending===G&&!1===s.transparent||(g=this._getBlending(s));let m={};!0===s.stencilWrite&&(m={compare:this._getStencilCompare(s),failOp:this._getStencilOperation(s.stencilFail),depthFailOp:this._getStencilOperation(s.stencilZFail),passOp:this._getStencilOperation(s.stencilZPass)});const f=this._getColorWriteMask(s),y=[];if(null!==e.context.textures){const t=e.context.textures;for(let e=0;e<t.length;e++){const r=d.getTextureFormatGPU(t[e]);y.push({format:r,blend:g,writeMask:f})}}else{const t=d.getCurrentColorFormat(e.context);y.push({format:t,blend:g,writeMask:f})}const b=u.get(a).module,x=u.get(o).module,T=this._getPrimitiveState(r,i,s),_=this._getDepthCompare(s),v=d.getCurrentDepthStencilFormat(e.context),N=this._getSampleCount(e.context),S={label:`renderPipeline_${s.name||s.type}_${s.id}`,vertex:Object.assign({},b,{buffers:p}),fragment:Object.assign({},x,{targets:y}),primitive:T,multisample:{count:N,alphaToCoverageEnabled:s.alphaToCoverage&&N>1},layout:l.createPipelineLayout({bindGroupLayouts:h})},E={},R=e.context.depth,A=e.context.stencil;if(!0!==R&&!0!==A||(!0===R&&(E.format=v,E.depthWriteEnabled=s.depthWrite,E.depthCompare=_),!0===A&&(E.stencilFront=m,E.stencilBack={},E.stencilReadMask=s.stencilFuncMask,E.stencilWriteMask=s.stencilWriteMask),!0===s.polygonOffset&&(E.depthBias=s.polygonOffsetUnits,E.depthBiasSlopeScale=s.polygonOffsetFactor,E.depthBiasClamp=0),S.depthStencil=E),null===t)c.pipeline=l.createRenderPipeline(S);else{const e=new Promise(e=>{l.createRenderPipelineAsync(S).then(t=>{c.pipeline=t,e()})});t.push(e)}}createBundleEncoder(e,t="renderBundleEncoder"){const r=this.backend,{utils:s,device:i}=r,n=s.getCurrentDepthStencilFormat(e),a={label:t,colorFormats:[s.getCurrentColorFormat(e)],depthStencilFormat:n,sampleCount:this._getSampleCount(e)};return i.createRenderBundleEncoder(a)}createComputePipeline(e,t){const r=this.backend,s=r.device,i=r.get(e.computeProgram).module,n=r.get(e),a=[];for(const e of t){const t=r.get(e);a.push(t.layout)}n.pipeline=s.createComputePipeline({compute:i,layout:s.createPipelineLayout({bindGroupLayouts:a})})}_getBlending(e){let t,r;const s=e.blending,i=e.blendSrc,n=e.blendDst,a=e.blendEquation;if(s===Xe){const s=null!==e.blendSrcAlpha?e.blendSrcAlpha:i,o=null!==e.blendDstAlpha?e.blendDstAlpha:n,u=null!==e.blendEquationAlpha?e.blendEquationAlpha:a;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(n),operation:this._getBlendOperation(a)},r={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(u)}}else{const i=(e,s,i,n)=>{t={srcFactor:e,dstFactor:s,operation:QR},r={srcFactor:i,dstFactor:n,operation:QR}};if(e.premultipliedAlpha)switch(s){case G:i(OR,$R,OR,$R);break;case Bt:i(OR,OR,OR,OR);break;case Pt:i(VR,kR,VR,OR);break;case Mt:i(HR,$R,VR,OR)}else switch(s){case G:i(zR,$R,OR,$R);break;case Bt:i(zR,OR,OR,OR);break;case Pt:console.error("THREE.WebGPURenderer: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Mt:console.error("THREE.WebGPURenderer: MultiplyBlending requires material.premultipliedAlpha = true")}}if(void 0!==t&&void 0!==r)return{color:t,alpha:r};console.error("THREE.WebGPURenderer: Invalid blending: ",s)}_getBlendFactor(e){let t;switch(e){case Ye:t=VR;break;case Rt:t=OR;break;case Et:t=GR;break;case Tt:t=kR;break;case St:t=zR;break;case xt:t=$R;break;case vt:t=HR;break;case bt:t=WR;break;case _t:t=qR;break;case yt:t=jR;break;case Nt:t=XR;break;case 211:t=KR;break;case 212:t=YR;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const r=e.stencilFunc;switch(r){case $r:t=PS;break;case zr:t=VS;break;case kr:t=BS;break;case Gr:t=FS;break;case Or:t=LS;break;case Vr:t=US;break;case Ur:t=IS;break;case Dr:t=DS;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",r)}return t}_getStencilOperation(e){let t;switch(e){case Qr:t=iA;break;case Yr:t=nA;break;case Kr:t=aA;break;case Xr:t=oA;break;case jr:t=uA;break;case qr:t=lA;break;case Wr:t=dA;break;case Hr:t=cA;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case Ke:t=QR;break;case ft:t=ZR;break;case mt:t=JR;break;case Jr:t=eA;break;case Zr:t=tA;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,r){const s={},i=this.backend.utils;s.topology=i.getPrimitiveTopology(e,r),null!==t.index&&!0===e.isLine&&!0!==e.isLineSegments&&(s.stripIndexFormat=t.index.array instanceof Uint16Array?qS:jS);let n=r.side===S;return e.isMesh&&e.matrixWorld.determinant()<0&&(n=!n),s.frontFace=!0===n?$S:zS,s.cullMode=r.side===E?HS:WS,s}_getColorWriteMask(e){return!0===e.colorWrite?sA:rA}_getDepthCompare(e){let t;if(!1===e.depthTest)t=VS;else{const r=e.depthFunc;switch(r){case Gt:t=PS;break;case Ot:t=VS;break;case Vt:t=BS;break;case Ut:t=FS;break;case Dt:t=LS;break;case It:t=US;break;case Ft:t=IS;break;case Lt:t=DS;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",r)}}return t}}class pw extends NS{constructor(e,t,r=2048){super(r),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const s=8*this.maxQueries;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Be(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||0===this.currentQueryIndex||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if("unmapped"!==this.resultBuffer.mapState)return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,r=8*t;this.currentQueryIndex=0,this.queryOffsets.clear();const s=this.device.createCommandEncoder();s.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),s.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,r);const i=s.finish();if(this.device.queue.submit([i]),"unmapped"!==this.resultBuffer.mapState)return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,r),this.isDisposed)return"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),this.lastValue;const n=new BigUint64Array(this.resultBuffer.getMappedRange(0,r));let a=0;for(const[,t]of e){const e=n[t],r=n[t+1];a+=Number(r-e)/1e6}return this.resultBuffer.unmap(),this.lastValue=a,a}catch(e){return console.error("Error resolving queries:",e),"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&"mapped"===this.resultBuffer.mapState)try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class gw extends nS{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=void 0===e.alpha||e.alpha,this.parameters.compatibilityMode=void 0!==e.compatibilityMode&&e.compatibilityMode,this.parameters.requiredLimits=void 0===e.requiredLimits?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new aw(this),this.attributeUtils=new dw(this),this.bindingUtils=new cw(this),this.pipelineUtils=new hw(this),this.textureUtils=new kA(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let r;if(void 0===t.device){const e={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},s="undefined"!=typeof navigator?await navigator.gpu.requestAdapter(e):null;if(null===s)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const i=Object.values(LA),n=[];for(const e of i)s.features.has(e)&&n.push(e);const a={requiredFeatures:n,requiredLimits:t.requiredLimits};r=await s.requestDevice(a)}else r=t.device;r.lost.then(t=>{const r={api:"WebGPU",message:t.message||"Unknown reason",reason:t.reason||null,originalEvent:t};e.onDeviceLost(r)});const s=void 0!==t.context?t.context:e.domElement.getContext("webgpu");this.device=r,this.context=s;const i=t.alpha?"premultiplied":"opaque",n=c.getToneMappingMode(this.renderer.outputColorSpace);this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:i,toneMapping:{mode:n}}),this.trackTimestamp=this.trackTimestamp&&this.hasFeature(LA.TimestampQuery),this.updateSize()}get coordinateSystem(){return d}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(null===e){const t=this.renderer;e={colorAttachments:[{view:null}]},!0!==this.renderer.depth&&!0!==this.renderer.stencil||(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(t.depth,t.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const r=e.renderTarget,s=this.get(r);let i=s.descriptors;void 0!==i&&s.width===r.width&&s.height===r.height&&s.samples===r.samples||(i={},s.descriptors=i);const n=e.getCacheKey();let a=i[n];if(void 0===a){const t=e.textures,o=[];let u;const l=this._isRenderCameraDepthArray(e);for(let s=0;s<t.length;s++){const i=this.get(t[s]),n={label:`colorAttachment_${s}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:RA};if(r.isRenderTarget3D)u=e.activeCubeFace,n.baseArrayLayer=0,n.dimension=CA,n.depthOrArrayLayers=t[s].image.depth;else if(r.isRenderTarget&&t[s].image.depth>1)if(!0===l){const t=e.camera.cameras;for(let e=0;e<t.length;e++){const t={...n,baseArrayLayer:e,arrayLayerCount:1,dimension:RA},r=i.texture.createView(t);o.push({view:r,resolveTarget:void 0,depthSlice:void 0})}}else n.dimension=AA,n.depthOrArrayLayers=t[s].image.depth;if(!0!==l){const e=i.texture.createView(n);let t,r;void 0!==i.msaaTexture?(t=i.msaaTexture.createView(),r=e):(t=e,r=void 0),o.push({view:t,resolveTarget:r,depthSlice:u})}}if(a={textureViews:o},e.depth){const t=this.get(e.depthTexture),r={};e.depthTexture.isArrayTexture&&(r.dimension=RA,r.arrayLayerCount=1,r.baseArrayLayer=e.activeCubeFace),a.depthStencilView=t.texture.createView(r)}i[n]=a,s.width=r.width,s.height=r.height,s.samples=r.samples,s.activeMipmapLevel=e.activeMipmapLevel,s.activeCubeFace=e.activeCubeFace}const o={colorAttachments:[]};for(let e=0;e<a.textureViews.length;e++){const r=a.textureViews[e];let s={r:0,g:0,b:0,a:1};0===e&&t.clearValue&&(s=t.clearValue),o.colorAttachments.push({view:r.view,depthSlice:r.depthSlice,resolveTarget:r.resolveTarget,loadOp:t.loadOp||GS,storeOp:t.storeOp||OS,clearValue:s})}return a.depthStencilView&&(o.depthStencilAttachment={view:a.depthStencilView}),o}beginRender(e){const t=this.get(e);t.frameCalls=this.renderer.info.render.frameCalls;const r=this.device,s=e.occlusionQueryCount;let i,n;s>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,i=r.createQuerySet({type:"occlusion",count:s,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=i,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(s),t.lastOcclusionObject=null),n=null===e.textures?this._getDefaultRenderPassDescriptor():this._getRenderPassDescriptor(e,{loadOp:GS}),this.initTimestampQuery(Ir.RENDER,this.getTimestampUID(e),n),n.occlusionQuerySet=i;const a=n.depthStencilAttachment;if(null!==e.textures){const t=n.colorAttachments;for(let r=0;r<t.length;r++){const s=t[r];e.clearColor?(s.clearValue=0===r?e.clearColorValue:{r:0,g:0,b:0,a:1},s.loadOp=kS):s.loadOp=GS,s.storeOp=OS}}else{const t=n.colorAttachments[0];e.clearColor?(t.clearValue=e.clearColorValue,t.loadOp=kS):t.loadOp=GS,t.storeOp=OS}e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=kS):a.depthLoadOp=GS,a.depthStoreOp=OS),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=kS):a.stencilLoadOp=GS,a.stencilStoreOp=OS);const o=r.createCommandEncoder({label:"renderContext_"+e.id});if(!0===this._isRenderCameraDepthArray(e)){const r=e.camera.cameras;t.layerDescriptors&&t.layerDescriptors.length===r.length?this._updateDepthLayerDescriptors(e,t,r):this._createDepthLayerDescriptors(e,t,n,r),t.bundleEncoders=[],t.bundleSets=[];for(let s=0;s<r.length;s++){const r=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+s),i={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(r),t.bundleSets.push(i)}t.currentPass=null}else{const r=o.beginRenderPass(n);if(t.currentPass=r,e.viewport&&this.updateViewport(e),e.scissor){const{x:t,y:s,width:i,height:n}=e.scissorValue;r.setScissorRect(t,s,i,n)}}t.descriptor=n,t.encoder=o,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,r,s){const i=r.depthStencilAttachment;t.layerDescriptors=[];const n=this.get(e.depthTexture);n.viewCache||(n.viewCache=[]);for(let a=0;a<s.length;a++){const s={...r,colorAttachments:[{...r.colorAttachments[0],view:r.colorAttachments[a].view}]};if(r.depthStencilAttachment){const t=a;n.viewCache[t]||(n.viewCache[t]=n.texture.createView({dimension:RA,baseArrayLayer:a,arrayLayerCount:1})),s.depthStencilAttachment={view:n.viewCache[t],depthLoadOp:i.depthLoadOp||kS,depthStoreOp:i.depthStoreOp||OS,depthClearValue:i.depthClearValue||1},e.stencil&&(s.depthStencilAttachment.stencilLoadOp=i.stencilLoadOp,s.depthStencilAttachment.stencilStoreOp=i.stencilStoreOp,s.depthStencilAttachment.stencilClearValue=i.stencilClearValue)}else s.depthStencilAttachment={...i};t.layerDescriptors.push(s)}}_updateDepthLayerDescriptors(e,t,r){for(let s=0;s<r.length;s++){const r=t.layerDescriptors[s];if(r.depthStencilAttachment){const t=r.depthStencilAttachment;e.depth&&(e.clearDepth?(t.depthClearValue=e.clearDepthValue,t.depthLoadOp=kS):t.depthLoadOp=GS),e.stencil&&(e.clearStencil?(t.stencilClearValue=e.clearStencilValue,t.stencilLoadOp=kS):t.stencilLoadOp=GS)}}}finishRender(e){const t=this.get(e),r=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),r>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const s=t.encoder;if(!0===this._isRenderCameraDepthArray(e)){const r=[];for(let e=0;e<t.bundleEncoders.length;e++){const s=t.bundleEncoders[e];r.push(s.finish())}for(let i=0;i<t.layerDescriptors.length;i++)if(i<r.length){const n=t.layerDescriptors[i],a=s.beginRenderPass(n);if(e.viewport){const{x:t,y:r,width:s,height:i,minDepth:n,maxDepth:o}=e.viewportValue;a.setViewport(t,r,s,i,n,o)}if(e.scissor){const{x:t,y:r,width:s,height:i}=e.scissorValue;a.setScissorRect(t,r,s,i)}a.executeBundles([r[i]]),a.end()}}else t.currentPass&&t.currentPass.end();if(r>0){const s=8*r;let i=this.occludedResolveCache.get(s);void 0===i&&(i=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,i));const n=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,r,i,0),t.encoder.copyBufferToBuffer(i,0,n,0,s),t.occlusionQueryBuffer=n,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),null!==e.textures){const t=e.textures;for(let e=0;e<t.length;e++){const r=t[e];!0===r.generateMipmaps&&this.textureUtils.generateMipmaps(r)}}}isOccluded(e,t){const r=this.get(e);return r.occluded&&r.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:r,currentOcclusionQueryObjects:s}=t;if(r&&s){const e=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await r.mapAsync(GPUMapMode.READ);const i=r.getMappedRange(),n=new BigUint64Array(i);for(let t=0;t<s.length;t++)n[t]===BigInt(0)&&e.add(s[t]);r.destroy(),t.occluded=e}}updateViewport(e){const{currentPass:t}=this.get(e),{x:r,y:s,width:i,height:n,minDepth:a,maxDepth:o}=e.viewportValue;t.setViewport(r,s,i,n,a,o)}getClearColor(){const e=super.getClearColor();return!0===this.renderer.alpha&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,r,s=null){const i=this.device,n=this.renderer;let a,o,u,l,d=[];if(e){const e=this.getClearColor();o={r:e.r,g:e.g,b:e.b,a:e.a}}if(null===s){u=n.depth,l=n.stencil;const t=this._getDefaultRenderPassDescriptor();if(e){d=t.colorAttachments;const e=d[0];e.clearValue=o,e.loadOp=kS,e.storeOp=OS}(u||l)&&(a=t.depthStencilAttachment)}else{u=s.depth,l=s.stencil;const i={loadOp:e?kS:GS,clearValue:e?o:void 0};u&&(i.depthLoadOp=t?kS:GS,i.depthClearValue=t?n.getClearDepth():void 0,i.depthStoreOp=OS),l&&(i.stencilLoadOp=r?kS:GS,i.stencilClearValue=r?n.getClearStencil():void 0,i.stencilStoreOp=OS);const c=this._getRenderPassDescriptor(s,i);d=c.colorAttachments,a=c.depthStencilAttachment}u&&a&&(t?(a.depthLoadOp=kS,a.depthClearValue=n.getClearDepth(),a.depthStoreOp=OS):(a.depthLoadOp=GS,a.depthStoreOp=OS)),l&&a&&(r?(a.stencilLoadOp=kS,a.stencilClearValue=n.getClearStencil(),a.stencilStoreOp=OS):(a.stencilLoadOp=GS,a.stencilStoreOp=OS));const c=i.createCommandEncoder({label:"clear"});c.beginRenderPass({colorAttachments:d,depthStencilAttachment:a}).end(),i.queue.submit([c.finish()])}beginCompute(e){const t=this.get(e);t.frameCalls=this.renderer.info.compute.frameCalls;const r={label:"computeGroup_"+e.id};this.initTimestampQuery(Ir.COMPUTE,this.getTimestampUID(e),r),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(r)}compute(e,t,r,s,i=null){const n=this.get(t),{passEncoderGPU:a}=this.get(e),o=this.get(s).pipeline;this.pipelineUtils.setPipeline(a,o);for(let e=0,t=r.length;e<t;e++){const t=r[e],s=this.get(t);a.setBindGroup(e,s.group)}let u;if(null===i&&(i=t.count),"number"==typeof i){const e=i;if(void 0===n.dispatchSize||n.count!==e){n.dispatchSize=[0,1,1],n.count=e;const r=t.workgroupSize;let s=r[0];for(let e=1;e<r.length;e++)s*=r[e];const i=Math.ceil(e/s),a=this.device.limits.maxComputeWorkgroupsPerDimension;u=[i,1,1],i>a&&(u[0]=Math.min(i,a),u[1]=Math.ceil(i/a)),n.dispatchSize=u}u=n.dispatchSize}else u=i;a.dispatchWorkgroups(u[0],u[1]||1,u[2]||1)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:r,material:s,context:i,pipeline:n}=e,a=e.getBindings(),o=this.get(i),u=this.get(n).pipeline,l=e.getIndex(),d=null!==l,c=e.getDrawParameters();if(null===c)return;const h=(t,r)=>{this.pipelineUtils.setPipeline(t,u),r.pipeline=u;const n=r.bindingGroups;for(let e=0,r=a.length;e<r;e++){const r=a[e],s=this.get(r);n[r.index]!==r.id&&(t.setBindGroup(r.index,s.group),n[r.index]=r.id)}if(!0===d&&r.index!==l){const e=this.get(l).buffer,s=l.array instanceof Uint16Array?qS:jS;t.setIndexBuffer(e,s),r.index=l}const c=e.getVertexBuffers();for(let e=0,s=c.length;e<s;e++){const s=c[e];if(r.attributes[e]!==s){const i=this.get(s).buffer;t.setVertexBuffer(e,i),r.attributes[e]=s}}!0===i.stencil&&!0===s.stencilWrite&&o.currentStencilRef!==s.stencilRef&&(t.setStencilReference(s.stencilRef),o.currentStencilRef=s.stencilRef)},p=(s,i)=>{if(h(s,i),!0===r.isBatchedMesh){const e=r._multiDrawStarts,i=r._multiDrawCounts,n=r._multiDrawCount,a=r._multiDrawInstances;null!==a&&Be("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let o=0;o<n;o++){const n=a?a[o]:1,u=n>1?0:o;!0===d?s.drawIndexed(i[o],n,e[o]/l.array.BYTES_PER_ELEMENT,0,u):s.draw(i[o],n,e[o],u),t.update(r,i[o],n)}}else if(!0===d){const{vertexCount:i,instanceCount:n,firstVertex:a}=c,o=e.getIndirect();if(null!==o){const e=this.get(o).buffer;s.drawIndexedIndirect(e,0)}else s.drawIndexed(i,n,a,0,0);t.update(r,i,n)}else{const{vertexCount:i,instanceCount:n,firstVertex:a}=c,o=e.getIndirect();if(null!==o){const e=this.get(o).buffer;s.drawIndirect(e,0)}else s.draw(i,n,a,0);t.update(r,i,n)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const t=this.get(e.camera),s=e.camera.cameras,n=e.getBindingGroup("cameraIndex");if(void 0===t.indexesGPU||t.indexesGPU.length!==s.length){const e=this.get(n),r=[],i=new Uint32Array([0,0,0,0]);for(let t=0,n=s.length;t<n;t++){i[0]=t;const s=this.bindingUtils.createBindGroupIndex(i,e.layout);r.push(s)}t.indexesGPU=r}const a=this.renderer.getPixelRatio();for(let e=0,u=s.length;e<u;e++){const u=s[e];if(r.layers.test(u.layers)){const r=u.viewport;let s=o.currentPass,l=o.currentSets;if(o.bundleEncoders){s=o.bundleEncoders[e],l=o.bundleSets[e]}r&&s.setViewport(Math.floor(r.x*a),Math.floor(r.y*a),Math.floor(r.width*a),Math.floor(r.height*a),i.viewportValue.minDepth,i.viewportValue.maxDepth),n&&t.indexesGPU&&(s.setBindGroup(n.index,t.indexesGPU[e]),l.bindingGroups[n.index]=n.id),p(s,l)}}}else if(o.currentPass){if(void 0!==o.occlusionQuerySet){const e=o.lastOcclusionObject;e!==r&&(null!==e&&!0===e.occlusionTest&&(o.currentPass.endOcclusionQuery(),o.occlusionQueryIndex++),!0===r.occlusionTest&&(o.currentPass.beginOcclusionQuery(o.occlusionQueryIndex),o.occlusionQueryObjects[o.occlusionQueryIndex]=r),o.lastOcclusionObject=r)}p(o.currentPass,o.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:r,material:s}=e,i=this.utils,n=i.getSampleCountRenderContext(e.context),a=i.getCurrentColorSpace(e.context),o=i.getCurrentColorFormat(e.context),u=i.getCurrentDepthStencilFormat(e.context),l=i.getPrimitiveTopology(r,s);let d=!1;return t.material===s&&t.materialVersion===s.version&&t.transparent===s.transparent&&t.blending===s.blending&&t.premultipliedAlpha===s.premultipliedAlpha&&t.blendSrc===s.blendSrc&&t.blendDst===s.blendDst&&t.blendEquation===s.blendEquation&&t.blendSrcAlpha===s.blendSrcAlpha&&t.blendDstAlpha===s.blendDstAlpha&&t.blendEquationAlpha===s.blendEquationAlpha&&t.colorWrite===s.colorWrite&&t.depthWrite===s.depthWrite&&t.depthTest===s.depthTest&&t.depthFunc===s.depthFunc&&t.stencilWrite===s.stencilWrite&&t.stencilFunc===s.stencilFunc&&t.stencilFail===s.stencilFail&&t.stencilZFail===s.stencilZFail&&t.stencilZPass===s.stencilZPass&&t.stencilFuncMask===s.stencilFuncMask&&t.stencilWriteMask===s.stencilWriteMask&&t.side===s.side&&t.alphaToCoverage===s.alphaToCoverage&&t.sampleCount===n&&t.colorSpace===a&&t.colorFormat===o&&t.depthStencilFormat===u&&t.primitiveTopology===l&&t.clippingContextCacheKey===e.clippingContextCacheKey||(t.material=s,t.materialVersion=s.version,t.transparent=s.transparent,t.blending=s.blending,t.premultipliedAlpha=s.premultipliedAlpha,t.blendSrc=s.blendSrc,t.blendDst=s.blendDst,t.blendEquation=s.blendEquation,t.blendSrcAlpha=s.blendSrcAlpha,t.blendDstAlpha=s.blendDstAlpha,t.blendEquationAlpha=s.blendEquationAlpha,t.colorWrite=s.colorWrite,t.depthWrite=s.depthWrite,t.depthTest=s.depthTest,t.depthFunc=s.depthFunc,t.stencilWrite=s.stencilWrite,t.stencilFunc=s.stencilFunc,t.stencilFail=s.stencilFail,t.stencilZFail=s.stencilZFail,t.stencilZPass=s.stencilZPass,t.stencilFuncMask=s.stencilFuncMask,t.stencilWriteMask=s.stencilWriteMask,t.side=s.side,t.alphaToCoverage=s.alphaToCoverage,t.sampleCount=n,t.colorSpace=a,t.colorFormat=o,t.depthStencilFormat=u,t.primitiveTopology=l,t.clippingContextCacheKey=e.clippingContextCacheKey,d=!0),d}getRenderCacheKey(e){const{object:t,material:r}=e,s=this.utils,i=e.context,n=t.isMesh&&t.matrixWorld.determinant()<0;return[r.transparent,r.blending,r.premultipliedAlpha,r.blendSrc,r.blendDst,r.blendEquation,r.blendSrcAlpha,r.blendDstAlpha,r.blendEquationAlpha,r.colorWrite,r.depthWrite,r.depthTest,r.depthFunc,r.stencilWrite,r.stencilFunc,r.stencilFail,r.stencilZFail,r.stencilZPass,r.stencilFuncMask,r.stencilWriteMask,r.side,n,s.getSampleCountRenderContext(i),s.getCurrentColorSpace(i),s.getCurrentColorFormat(i),s.getCurrentDepthStencilFormat(i),s.getPrimitiveTopology(t,r),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,s,i,n){return this.textureUtils.copyTextureToBuffer(e,t,r,s,i,n)}initTimestampQuery(e,t,r){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new pw(this.device,e,2048));const s=this.timestampQueryPool[e],i=s.allocateQueriesForContext(t);r.timestampWrites={querySet:s.querySet,beginningOfPassWriteIndex:i,endOfPassWriteIndex:i+1}}createNodeBuilder(e,t){return new nw(e,t)}createProgram(e){this.get(e).module={module:this.device.createShaderModule({code:e.code,label:e.stage+(""!==e.name?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const r=this.get(e),s=r.currentPass.finish();this.get(t).bundleGPU=s,r.currentSets=r._currentSets,r.currentPass=r._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,r,s){this.bindingUtils.createBindings(e,t,r,s)}updateBindings(e,t,r,s){this.bindingUtils.createBindings(e,t,r,s)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){let a=0,o=0,u=0,l=0,d=0,c=0,h=e.image.width,p=e.image.height,g=1;null!==r&&(!0===r.isBox3?(l=r.min.x,d=r.min.y,c=r.min.z,h=r.max.x-r.min.x,p=r.max.y-r.min.y,g=r.max.z-r.min.z):(l=r.min.x,d=r.min.y,h=r.max.x-r.min.x,p=r.max.y-r.min.y,g=1)),null!==s&&(a=s.x,o=s.y,u=s.z||0);const m=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),f=this.get(e).texture,y=this.get(t).texture;m.copyTextureToTexture({texture:f,mipLevel:i,origin:{x:l,y:d,z:c}},{texture:y,mipLevel:n,origin:{x:a,y:o,z:u}},[h,p,g]),this.device.queue.submit([m.finish()]),0===n&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,r){const s=this.get(t);let i=null;i=t.renderTarget?e.isDepthTexture?this.get(t.depthTexture).texture:this.get(t.textures[0]).texture:e.isDepthTexture?this.textureUtils.getDepthBuffer(t.depth,t.stencil):this.context.getCurrentTexture();const n=this.get(e).texture;if(i.format!==n.format)return void console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",i.format,n.format);let a;if(s.currentPass?(s.currentPass.end(),a=s.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:i,origin:[r.x,r.y,0]},{texture:n},[r.z,r.w]),s.currentPass){const{descriptor:e}=s;for(let t=0;t<e.colorAttachments.length;t++)e.colorAttachments[t].loadOp=GS;if(t.depth&&(e.depthStencilAttachment.depthLoadOp=GS),t.stencil&&(e.depthStencilAttachment.stencilLoadOp=GS),s.currentPass=a.beginRenderPass(e),s.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:e,y:r,width:i,height:n}=t.scissorValue;s.currentPass.setScissorRect(e,r,i,n)}}else this.device.queue.submit([a.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}}class mw extends es{constructor(e,t,r,s,i,n){super(e,t,r,s,i,n),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class fw extends es{constructor(e,t,r,s,i,n){super(e,t,r,s,i,n),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class yw extends gN{constructor(){super(),this.addMaterial(ig,"MeshPhongMaterial"),this.addMaterial(jm,"MeshStandardMaterial"),this.addMaterial(Km,"MeshPhysicalMaterial"),this.addMaterial(tf,"MeshToonMaterial"),this.addMaterial(Kp,"MeshBasicMaterial"),this.addMaterial(rg,"MeshLambertMaterial"),this.addMaterial(Dp,"MeshNormalMaterial"),this.addMaterial(nf,"MeshMatcapMaterial"),this.addMaterial(Rp,"LineBasicMaterial"),this.addMaterial(wp,"LineDashedMaterial"),this.addMaterial(hf,"PointsMaterial"),this.addMaterial(lf,"SpriteMaterial"),this.addMaterial(ff,"ShadowMaterial"),this.addLight(a_,ts),this.addLight(Gv,rs),this.addLight(Hv,ss),this.addLight(Wv,es),this.addLight(Kv,is),this.addLight(Yv,ns),this.addLight(Qv,as),this.addLight(qv,mw),this.addLight(Xv,fw),this.addToneMapping(jb,os),this.addToneMapping(Xb,us),this.addToneMapping(Kb,ls),this.addToneMapping(Qb,ds),this.addToneMapping(tx,cs),this.addToneMapping(rx,hs)}}class bw extends IN{constructor(e={}){let t;e.forceWebGL?t=ES:(t=gw,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new ES(e)));super(new t(e),e),this.library=new yw,this.isWebGPURenderer=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class xw extends ps{constructor(){super(),this.isBundleGroup=!0,this.type="BundleGroup",this.static=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}}class Tw{constructor(e,t=gn(0,0,1,1)){this.renderer=e,this.outputNode=t,this.outputColorTransform=!0,this.needsUpdate=!0;const r=new Sp;r.name="PostProcessing",this._quadMesh=new sb(r),this._context=null}render(){const e=this.renderer;this._update(),null!==this._context.onBeforePostProcessing&&this._context.onBeforePostProcessing();const t=e.toneMapping,r=e.outputColorSpace;e.toneMapping=p,e.outputColorSpace=c.workingColorSpace;const s=e.xr.enabled;e.xr.enabled=!1,this._quadMesh.render(e),e.xr.enabled=s,e.toneMapping=t,e.outputColorSpace=r,null!==this._context.onAfterPostProcessing&&this._context.onAfterPostProcessing()}get context(){return this._context}dispose(){this._quadMesh.material.dispose()}_update(){if(!0===this.needsUpdate){const e=this.renderer,t=e.toneMapping,r=e.outputColorSpace,s={postProcessing:this,onBeforePostProcessing:null,onAfterPostProcessing:null};let i=this.outputNode;!0===this.outputColorTransform?(i=i.context(s),i=Zu(i,t,r)):(s.toneMapping=t,s.outputColorSpace=r,i=i.context(s)),this._context=s,this._quadMesh.material.fragmentNode=i,this._quadMesh.material.needsUpdate=!0,this.needsUpdate=!1}}async renderAsync(){this._update(),null!==this._context.onBeforePostProcessing&&this._context.onBeforePostProcessing();const e=this.renderer,t=e.toneMapping,r=e.outputColorSpace;e.toneMapping=p,e.outputColorSpace=c.workingColorSpace;const s=e.xr.enabled;e.xr.enabled=!1,await this._quadMesh.renderAsync(e),e.xr.enabled=s,e.toneMapping=t,e.outputColorSpace=r,null!==this._context.onAfterPostProcessing&&this._context.onAfterPostProcessing()}}class _w extends x{constructor(e=1,t=1){super(),this.image={width:e,height:t},this.magFilter=Y,this.minFilter=Y,this.isStorageTexture=!0}setSize(e,t){this.image.width===e&&this.image.height===t||(this.image.width=e,this.image.height=t,this.dispose())}}class vw extends x{constructor(e=1,t=1,r=1){super(),this.isArrayTexture=!1,this.image={width:e,height:t,depth:r},this.magFilter=Y,this.minFilter=Y,this.wrapR=Nr,this.isStorageTexture=!0,this.is3DTexture=!0}setSize(e,t,r){this.image.width===e&&this.image.height===t&&this.image.depth===r||(this.image.width=e,this.image.height=t,this.image.depth=r,this.dispose())}}class Nw extends x{constructor(e=1,t=1,r=1){super(),this.isArrayTexture=!0,this.image={width:e,height:t,depth:r},this.magFilter=Y,this.minFilter=Y,this.isStorageTexture=!0}setSize(e,t,r){this.image.width===e&&this.image.height===t&&this.image.depth===r||(this.image.width=e,this.image.height=t,this.image.depth=r,this.dispose())}}class Sw extends gb{constructor(e,t){super(e,t,Uint32Array),this.isIndirectStorageBufferAttribute=!0}}class Ew extends gs{constructor(e){super(e),this.textures={},this.nodes={}}load(e,t,r,s){const i=new ms(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,r=>{try{t(this.parse(JSON.parse(r)))}catch(t){s?s(t):console.error(t),this.manager.itemError(e)}},r,s)}parseNodes(e){const t={};if(void 0!==e){for(const r of e){const{uuid:e,type:s}=r;t[e]=this.createNodeFromType(s),t[e].uuid=e}const r={nodes:t,textures:this.textures};for(const s of e){s.meta=r;t[s.uuid].deserialize(s),delete s.meta}}return t}parse(e){const t=this.createNodeFromType(e.type);t.uuid=e.uuid;const r={nodes:this.parseNodes(e.nodes),textures:this.textures};return e.meta=r,t.deserialize(e),delete e.meta,t}setTextures(e){return this.textures=e,this}setNodes(e){return this.nodes=e,this}createNodeFromType(e){return void 0===this.nodes[e]?(console.error("THREE.NodeLoader: Node type not found:",e),tn()):Gi(new this.nodes[e])}}class Rw extends fs{constructor(e){super(e),this.nodes={},this.nodeMaterials={}}parse(e){const t=super.parse(e),r=this.nodes,s=e.inputNodes;for(const e in s){const i=s[e];t[e]=r[i]}return t}setNodes(e){return this.nodes=e,this}setNodeMaterials(e){return this.nodeMaterials=e,this}createMaterialFromType(e){const t=this.nodeMaterials[e];return void 0!==t?new t:super.createMaterialFromType(e)}}class Aw extends ys{constructor(e){super(e),this.nodes={},this.nodeMaterials={},this._nodesJSON=null}setNodes(e){return this.nodes=e,this}setNodeMaterials(e){return this.nodeMaterials=e,this}parse(e,t){this._nodesJSON=e.nodes;const r=super.parse(e,t);return this._nodesJSON=null,r}parseNodes(e,t){if(void 0!==e){const r=new Ew;return r.setNodes(this.nodes),r.setTextures(t),r.parseNodes(e)}return{}}parseMaterials(e,t){const r={};if(void 0!==e){const s=this.parseNodes(this._nodesJSON,t),i=new Rw;i.setTextures(t),i.setNodes(s),i.setNodeMaterials(this.nodeMaterials);for(let t=0,s=e.length;t<s;t++){const s=e[t];r[s.uuid]=i.parse(s)}}return r}}class ww extends ps{constructor(){super(),this.isClippingGroup=!0,this.clippingPlanes=[],this.enabled=!0,this.clipIntersection=!1,this.clipShadows=!1}}export{ds as ACESFilmicToneMapping,Wh as AONode,Ke as AddEquation,ee as AddOperation,Bt as AdditiveBlending,cs as AgXToneMapping,Wt as AlphaFormat,Pr as AlwaysCompare,Ot as AlwaysDepth,zr as AlwaysStencilFunc,is as AmbientLight,Kv as AmbientLightNode,s_ as AnalyticLightNode,We as ArrayCamera,Qs as ArrayElementNode,ua as ArrayNode,da as AssignNode,tl as AttributeNode,S as BackSide,Hp as BasicEnvironmentNode,Oe as BasicShadowMap,Ah as BatchNode,by as BitcastNode,j as BoxGeometry,ge as BufferAttribute,Lu as BufferAttributeNode,pe as BufferGeometry,pl as BufferNode,Ac as BumpMapNode,xw as BundleGroup,$u as BypassNode,ut as ByteType,ku as CacheNode,Ee as Camera,ls as CineonToneMapping,Nr as ClampToEdgeWrapping,ww as ClippingGroup,sx as CodeNode,e as Color,c as ColorManagement,Nu as ColorSpaceNode,Vu as ComputeNode,oi as ConstNode,nu as ContextNode,Zs as ConvertNode,Q as CubeCamera,w as CubeReflectionMapping,C as CubeRefractionMapping,A as CubeTexture,zd as CubeTextureNode,he as CubeUVReflectionMapping,wt as CullFaceBack,Ct as CullFaceFront,At as CullFaceNone,Xe as CustomBlending,Qe as CylinderGeometry,F as DataArrayTexture,it as DataTexture,Ju as DebugNode,qr as DecrementStencilOp,Hr as DecrementWrapStencilOp,Ae as DepthFormat,Re as DepthStencilFormat,V as DepthTexture,rs as DirectionalLight,Gv as DirectionalLightNode,E as DoubleSide,_t as DstAlphaFactor,vt as DstColorFactor,y as DynamicDrawUsage,$m as EnvironmentNode,Cr as EqualCompare,Dt as EqualDepth,Or as EqualStencilFunc,Z as EquirectangularReflectionMapping,J as EquirectangularRefractionMapping,R as Euler,o as EventDispatcher,cb as EventNode,Xu as ExpressionNode,ms as FileLoader,$e as Float16BufferAttribute,Fe as Float32BufferAttribute,I as FloatType,D as FramebufferTexture,md as FrontFacingNode,je as FrontSide,st as Frustum,rt as FrustumArray,ha as FunctionCallNode,nx as FunctionNode,Ey as FunctionOverloadingNode,iN as GLSLNodeParser,Ar as GreaterCompare,Ft as GreaterDepth,wr as GreaterEqualCompare,It as GreaterEqualDepth,Vr as GreaterEqualStencilFunc,Ur as GreaterStencilFunc,ps as Group,ce as HalfFloatType,ns as HemisphereLight,Yv as HemisphereLightNode,mw as IESSpotLight,qv as IESSpotLightNode,jr as IncrementStencilOp,Wr as IncrementWrapStencilOp,fh as IndexNode,Sw as IndirectStorageBufferAttribute,Nh as InstanceNode,L as InstancedBufferAttribute,B as InstancedInterleavedBuffer,Eh as InstancedMeshNode,_ as IntType,m as InterleavedBuffer,f as InterleavedBufferAttribute,Xr as InvertStencilOp,Xh as IrradianceNode,ei as JoinNode,Qr as KeepStencilOp,Ue as LessCompare,Vt as LessDepth,Mr as LessEqualCompare,Ut as LessEqualDepth,Gr as LessEqualStencilFunc,kr as LessStencilFunc,as as LightProbe,Qv as LightProbeNode,yN as Lighting,qh as LightingContextNode,qp as LightingModel,Hh as LightingNode,bT as LightsNode,Lp as Line2NodeMaterial,k as LineBasicMaterial,Rp as LineBasicNodeMaterial,z as LineDashedMaterial,wp as LineDashedNodeMaterial,Y as LinearFilter,Le as LinearMipMapLinearFilter,U as LinearMipmapLinearFilter,ke as LinearMipmapNearestFilter,le as LinearSRGBColorSpace,os as LinearToneMapping,Lr as LinearTransfer,gs as Loader,Dh as LoopNode,fy as MRTNode,O as Material,fs as MaterialLoader,Mc as MaterialNode,Kd as MaterialReferenceNode,u as MathUtils,i as Matrix2,n as Matrix3,a as Matrix4,Zr as MaxEquation,al as MaxMipLevelNode,ui as MemberNode,X as Mesh,se as MeshBasicMaterial,Kp as MeshBasicNodeMaterial,ie as MeshLambertMaterial,rg as MeshLambertNodeMaterial,be as MeshMatcapMaterial,nf as MeshMatcapNodeMaterial,H as MeshNormalMaterial,Dp as MeshNormalNodeMaterial,ne as MeshPhongMaterial,ig as MeshPhongNodeMaterial,fe as MeshPhysicalMaterial,Km as MeshPhysicalNodeMaterial,Qm as MeshSSSNodeMaterial,me as MeshStandardMaterial,jm as MeshStandardNodeMaterial,ye as MeshToonMaterial,tf as MeshToonNodeMaterial,Jr as MinEquation,vr as MirroredRepeatWrapping,te as MixOperation,Kl as ModelNode,zh as MorphNode,Mt as MultiplyBlending,re as MultiplyOperation,v as NearestFilter,ze as NearestMipmapLinearFilter,Er as NearestMipmapNearestFilter,hs as NeutralToneMapping,Br as NeverCompare,Gt as NeverDepth,$r as NeverStencilFunc,$ as NoBlending,b as NoColorSpace,p as NoToneMapping,Ys as Node,$s as NodeAccess,lv as NodeAttribute,Uv as NodeBuilder,mv as NodeCache,pv as NodeCode,Vv as NodeFrame,Ov as NodeFunctionInput,Ew as NodeLoader,Sp as NodeMaterial,Rw as NodeMaterialLoader,Ts as NodeMaterialObserver,Aw as NodeObjectLoader,Gs as NodeShaderStage,zs as NodeType,dv as NodeUniform,ks as NodeUpdateType,Os as NodeUtils,cv as NodeVar,hv as NodeVarying,G as NormalBlending,Nc as NormalMapNode,Rr as NotEqualCompare,Lt as NotEqualDepth,Dr as NotEqualStencilFunc,Pe as Object3D,zl as Object3DNode,ys as ObjectLoader,P as ObjectSpaceNormalMap,Rt as OneFactor,yt as OneMinusDstAlphaFactor,bt as OneMinusDstColorFactor,xt as OneMinusSrcAlphaFactor,Tt as OneMinusSrcColorFactor,ae as OrthographicCamera,py as OutputStructNode,tt as PCFShadowMap,Bm as PMREMGenerator,Gm as PMREMNode,uy as ParameterNode,Wb as PassNode,oe as PerspectiveCamera,eg as PhongLightingModel,Kg as PhysicalLightingModel,Me as Plane,qe as PlaneGeometry,ts as PointLight,a_ as PointLightNode,mb as PointUVNode,Te as PointsMaterial,hf as PointsNodeMaterial,Tw as PostProcessing,Gb as PosterizeNode,fw as ProjectorLight,Xv as ProjectorLightNode,Nn as PropertyNode,sb as QuadMesh,Ze as Quaternion,Tr as RED_GREEN_RGTC2_Format,br as RED_RGTC1_Format,He as REVISION,de as RGBAFormat,pt as RGBAIntegerFormat,gr as RGBA_ASTC_10x10_Format,cr as RGBA_ASTC_10x5_Format,hr as RGBA_ASTC_10x6_Format,pr as RGBA_ASTC_10x8_Format,mr as RGBA_ASTC_12x10_Format,fr as RGBA_ASTC_12x12_Format,sr as RGBA_ASTC_4x4_Format,ir as RGBA_ASTC_5x4_Format,nr as RGBA_ASTC_5x5_Format,ar as RGBA_ASTC_6x5_Format,or as RGBA_ASTC_6x6_Format,ur as RGBA_ASTC_8x5_Format,lr as RGBA_ASTC_8x6_Format,dr as RGBA_ASTC_8x8_Format,yr as RGBA_BPTC_Format,rr as RGBA_ETC2_EAC_Format,Jt as RGBA_PVRTC_2BPPV1_Format,Zt as RGBA_PVRTC_4BPPV1_Format,jt as RGBA_S3TC_DXT1_Format,Xt as RGBA_S3TC_DXT3_Format,Kt as RGBA_S3TC_DXT5_Format,ht as RGBFormat,ct as RGBIntegerFormat,er as RGB_ETC1_Format,tr as RGB_ETC2_Format,Qt as RGB_PVRTC_2BPPV1_Format,Yt as RGB_PVRTC_4BPPV1_Format,qt as RGB_S3TC_DXT1_Format,Ve as RGFormat,dt as RGIntegerFormat,nb as RTTNode,Tx as RangeNode,ss as RectAreaLight,Hv as RectAreaLightNode,at as RedFormat,nt as RedIntegerFormat,qd as ReferenceNode,Zy as ReflectorNode,us as ReinhardToneMapping,Wu as RemapNode,Qu as RenderOutputNode,ue as RenderTarget,wu as RendererReferenceNode,CT as RendererUtils,Sr as RepeatWrapping,Kr as ReplaceStencilOp,mt as ReverseSubtractEquation,af as RotateNode,_r as SIGNED_RED_GREEN_RGTC2_Format,xr as SIGNED_RED_RGTC1_Format,W as SRGBColorSpace,h as SRGBTransfer,K as Scene,xb as SceneNode,_l as ScreenNode,hx as ScriptableNode,ox as ScriptableValueNode,si as SetNode,xT as ShadowBaseNode,_e as ShadowMaterial,WT as ShadowNode,ff as ShadowNodeMaterial,ot as ShortType,Fh as SkinningNode,N as Sphere,Ge as SphereGeometry,ri as SplitNode,es as SpotLight,Wv as SpotLightNode,xe as SpriteMaterial,lf as SpriteNodeMaterial,Iy as SpriteSheetUVNode,St as SrcAlphaFactor,Nt as SrcAlphaSaturateFactor,Et as SrcColorFactor,ly as StackNode,g as StaticDrawUsage,vw as Storage3DTexture,Ch as StorageArrayElementNode,Nw as StorageArrayTexture,gb as StorageBufferAttribute,Ph as StorageBufferNode,pb as StorageInstancedBufferAttribute,_w as StorageTexture,Nb as StorageTextureNode,hy as StructNode,cy as StructTypeNode,mu as SubBuildNode,ft as SubtractEquation,Pt as SubtractiveBlending,sv as TSL,M as TangentSpaceNormalMap,Js as TempNode,x as Texture,Rb as Texture3DNode,ll as TextureNode,il as TextureSizeNode,Ir as TimestampQuery,Mu as ToneMappingNode,qb as ToonOutlinePassNode,Ie as UVMapping,Ne as Uint16BufferAttribute,ve as Uint32BufferAttribute,fl as UniformArrayNode,ea as UniformGroupNode,aa as UniformNode,Ce as UnsignedByteType,Ht as UnsignedInt101111Type,we as UnsignedInt248Type,$t as UnsignedInt5999Type,T as UnsignedIntType,kt as UnsignedShort4444Type,zt as UnsignedShort5551Type,lt as UnsignedShortType,wb as UserDataNode,De as VSMShadowMap,du as VarNode,yu as VaryingNode,t as Vector2,r as Vector3,s as Vector4,mp as VertexColorNode,rp as ViewportDepthNode,ep as ViewportDepthTextureNode,Mp as ViewportSharedTextureNode,Yh as ViewportTextureNode,_f as VolumeNodeMaterial,l as WebGLCoordinateSystem,q as WebGLCubeRenderTarget,d as WebGPUCoordinateSystem,bw as WebGPURenderer,Je as WebXRController,Ye as ZeroFactor,Yr as ZeroStencilOp,gt as createCanvasElement,Ws as defaultBuildStages,Hs as defaultShaderStages,qs as shaderStages,js as vectorComponents};
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		// Use getUV context to avoid side effects from nodes overwriting getUV in the context (e.g. EnvironmentNode)
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		// Use getUV context to avoid side effects from nodes overwriting getUV in the context (e.g. EnvironmentNode)
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	setupEnvironment( /*builder*/ ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		const envNode = this.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js: * `BasicEnvironmentNode` is intended for non-PBR materials like {@link MeshBasicNodeMaterial}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:class BasicEnvironmentNode extends LightingNode {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		return 'BasicEnvironmentNode';
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js: * diffuse color. Environment mapping is supported. Used in {@link MeshBasicNodeMaterial}.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * Overwritten since this type of material uses {@link BasicEnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * @return {?BasicEnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		const envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		return envNode ? new BasicEnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:const EnvironmentBRDF = /*@__PURE__*/ Fn( ( inputs ) => {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	const F = vec3( EnvironmentBRDF( { // n, v, specularColor, specularF90, roughness
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:			const clearcoatEnv = EnvironmentBRDF( {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js: * This class generates a Prefiltered, Mipmapped Radiance Environment Map
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js: * `EnvironmentNode` is intended for PBR materials like {@link MeshStandardNodeMaterial}.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:class EnvironmentNode extends LightingNode {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		return 'EnvironmentNode';
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * Overwritten since this type of material uses {@link EnvironmentNode}
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	 * @return {?EnvironmentNode<vec3>} The environment node.
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	setupEnvironment( builder ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		let envNode = super.setupEnvironment( builder );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		return envNode ? new EnvironmentNode( envNode ) : null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		const environmentBlendMode = renderer.xr.getEnvironmentBlendMode();
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:				nodeBuilder.environmentNode = this.getEnvironmentNode( renderObject.scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	getEnvironmentNode( scene ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:		this.updateEnvironment( scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:			const environmentNode = this.getEnvironmentNode( scene );
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	updateEnvironment( scene ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:	getEnvironmentBlendMode() {
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.js:export { ACESFilmicToneMapping, AONode, AddEquation, AddOperation, AdditiveBlending, AgXToneMapping, AlphaFormat, AlwaysCompare, AlwaysDepth, AlwaysStencilFunc, AmbientLight, AmbientLightNode, AnalyticLightNode, ArrayCamera, ArrayElementNode, ArrayNode, AssignNode, AttributeNode, BackSide, BasicEnvironmentNode, BasicShadowMap, BatchNode, BitcastNode, BoxGeometry, BufferAttribute, BufferAttributeNode, BufferGeometry, BufferNode, BumpMapNode, BundleGroup, BypassNode, ByteType, CacheNode, Camera, CineonToneMapping, ClampToEdgeWrapping, ClippingGroup, CodeNode, Color, ColorManagement, ColorSpaceNode, ComputeNode, ConstNode, ContextNode, ConvertNode, CubeCamera, CubeReflectionMapping, CubeRefractionMapping, CubeTexture, CubeTextureNode, CubeUVReflectionMapping, CullFaceBack, CullFaceFront, CullFaceNone, CustomBlending, CylinderGeometry, DataArrayTexture, DataTexture, DebugNode, DecrementStencilOp, DecrementWrapStencilOp, DepthFormat, DepthStencilFormat, DepthTexture, DirectionalLight, DirectionalLightNode, DoubleSide, DstAlphaFactor, DstColorFactor, DynamicDrawUsage, EnvironmentNode, EqualCompare, EqualDepth, EqualStencilFunc, EquirectangularReflectionMapping, EquirectangularRefractionMapping, Euler, EventDispatcher, EventNode, ExpressionNode, FileLoader, Float16BufferAttribute, Float32BufferAttribute, FloatType, FramebufferTexture, FrontFacingNode, FrontSide, Frustum, FrustumArray, FunctionCallNode, FunctionNode, FunctionOverloadingNode, GLSLNodeParser, GreaterCompare, GreaterDepth, GreaterEqualCompare, GreaterEqualDepth, GreaterEqualStencilFunc, GreaterStencilFunc, Group, HalfFloatType, HemisphereLight, HemisphereLightNode, IESSpotLight, IESSpotLightNode, IncrementStencilOp, IncrementWrapStencilOp, IndexNode, IndirectStorageBufferAttribute, InstanceNode, InstancedBufferAttribute, InstancedInterleavedBuffer, InstancedMeshNode, IntType, InterleavedBuffer, InterleavedBufferAttribute, InvertStencilOp, IrradianceNode, JoinNode, KeepStencilOp, LessCompare, LessDepth, LessEqualCompare, LessEqualDepth, LessEqualStencilFunc, LessStencilFunc, LightProbe, LightProbeNode, Lighting, LightingContextNode, LightingModel, LightingNode, LightsNode, Line2NodeMaterial, LineBasicMaterial, LineBasicNodeMaterial, LineDashedMaterial, LineDashedNodeMaterial, LinearFilter, LinearMipMapLinearFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, LinearSRGBColorSpace, LinearToneMapping, LinearTransfer, Loader, LoopNode, MRTNode, Material, MaterialLoader, MaterialNode, MaterialReferenceNode, MathUtils, Matrix2, Matrix3, Matrix4, MaxEquation, MaxMipLevelNode, MemberNode, Mesh, MeshBasicMaterial, MeshBasicNodeMaterial, MeshLambertMaterial, MeshLambertNodeMaterial, MeshMatcapMaterial, MeshMatcapNodeMaterial, MeshNormalMaterial, MeshNormalNodeMaterial, MeshPhongMaterial, MeshPhongNodeMaterial, MeshPhysicalMaterial, MeshPhysicalNodeMaterial, MeshSSSNodeMaterial, MeshStandardMaterial, MeshStandardNodeMaterial, MeshToonMaterial, MeshToonNodeMaterial, MinEquation, MirroredRepeatWrapping, MixOperation, ModelNode, MorphNode, MultiplyBlending, MultiplyOperation, NearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, NeutralToneMapping, NeverCompare, NeverDepth, NeverStencilFunc, NoBlending, NoColorSpace, NoToneMapping, Node, NodeAccess, NodeAttribute, NodeBuilder, NodeCache, NodeCode, NodeFrame, NodeFunctionInput, NodeLoader, NodeMaterial, NodeMaterialLoader, NodeMaterialObserver, NodeObjectLoader, NodeShaderStage, NodeType, NodeUniform, NodeUpdateType, NodeUtils, NodeVar, NodeVarying, NormalBlending, NormalMapNode, NotEqualCompare, NotEqualDepth, NotEqualStencilFunc, Object3D, Object3DNode, ObjectLoader, ObjectSpaceNormalMap, OneFactor, OneMinusDstAlphaFactor, OneMinusDstColorFactor, OneMinusSrcAlphaFactor, OneMinusSrcColorFactor, OrthographicCamera, OutputStructNode, PCFShadowMap, PMREMGenerator, PMREMNode, ParameterNode, PassNode, PerspectiveCamera, PhongLightingModel, PhysicalLightingModel, Plane, PlaneGeometry, PointLight, PointLightNode, PointUVNode, PointsMaterial, PointsNodeMaterial, PostProcessing, PosterizeNode, ProjectorLight, ProjectorLightNode, PropertyNode, QuadMesh, Quaternion, RED_GREEN_RGTC2_Format, RED_RGTC1_Format, REVISION, RGBAFormat, RGBAIntegerFormat, RGBA_ASTC_10x10_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_BPTC_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGBFormat, RGBIntegerFormat, RGB_ETC1_Format, RGB_ETC2_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGB_S3TC_DXT1_Format, RGFormat, RGIntegerFormat, RTTNode, RangeNode, RectAreaLight, RectAreaLightNode, RedFormat, RedIntegerFormat, ReferenceNode, ReflectorNode, ReinhardToneMapping, RemapNode, RenderOutputNode, RenderTarget, RendererReferenceNode, RendererUtils, RepeatWrapping, ReplaceStencilOp, ReverseSubtractEquation, RotateNode, SIGNED_RED_GREEN_RGTC2_Format, SIGNED_RED_RGTC1_Format, SRGBColorSpace, SRGBTransfer, Scene, SceneNode, ScreenNode, ScriptableNode, ScriptableValueNode, SetNode, ShadowBaseNode, ShadowMaterial, ShadowNode, ShadowNodeMaterial, ShortType, SkinningNode, Sphere, SphereGeometry, SplitNode, SpotLight, SpotLightNode, SpriteMaterial, SpriteNodeMaterial, SpriteSheetUVNode, SrcAlphaFactor, SrcAlphaSaturateFactor, SrcColorFactor, StackNode, StaticDrawUsage, StorageArrayElementNode, StorageBufferAttribute, StorageBufferNode, StorageInstancedBufferAttribute, StorageTexture, StorageTextureNode, StructNode, StructTypeNode, SubBuildNode, SubtractEquation, SubtractiveBlending, TSL, TangentSpaceNormalMap, TempNode, Texture, Texture3DNode, TextureNode, TextureSizeNode, TimestampQuery, ToneMappingNode, ToonOutlinePassNode, UVMapping, Uint16BufferAttribute, Uint32BufferAttribute, UniformArrayNode, UniformGroupNode, UniformNode, UnsignedByteType, UnsignedInt101111Type, UnsignedInt248Type, UnsignedInt5999Type, UnsignedIntType, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedShortType, UserDataNode, VSMShadowMap, VarNode, VaryingNode, Vector2, Vector3, Vector4, VertexColorNode, ViewportDepthNode, ViewportDepthTextureNode, ViewportSharedTextureNode, ViewportTextureNode, VolumeNodeMaterial, WebGLCoordinateSystem, WebGLCubeRenderTarget, WebGPUCoordinateSystem, WebGPURenderer, WebXRController, ZeroFactor, ZeroStencilOp, createCanvasElement, defaultBuildStages, defaultShaderStages, shaderStages, vectorComponents };
./node_modules/.pnpm/three@0.180.0/node_modules/three/build/three.webgpu.nodes.min.js:import{Color as e,Vector2 as t,Vector3 as r,Vector4 as s,Matrix2 as i,Matrix3 as n,Matrix4 as a,EventDispatcher as o,MathUtils as u,WebGLCoordinateSystem as l,WebGPUCoordinateSystem as d,ColorManagement as c,SRGBTransfer as h,NoToneMapping as p,StaticDrawUsage as g,InterleavedBuffer as m,InterleavedBufferAttribute as f,DynamicDrawUsage as y,NoColorSpace as b,Texture as x,UnsignedIntType as T,IntType as _,NearestFilter as v,Sphere as N,BackSide as S,DoubleSide as E,Euler as R,CubeTexture as A,CubeReflectionMapping as w,CubeRefractionMapping as C,TangentSpaceNormalMap as M,ObjectSpaceNormalMap as P,InstancedInterleavedBuffer as B,InstancedBufferAttribute as L,DataArrayTexture as F,FloatType as I,FramebufferTexture as D,LinearMipmapLinearFilter as U,DepthTexture as V,Material as O,NormalBlending as G,LineBasicMaterial as k,LineDashedMaterial as z,NoBlending as $,MeshNormalMaterial as H,SRGBColorSpace as W,WebGLCubeRenderTarget as q,BoxGeometry as j,Mesh as X,Scene as K,LinearFilter as Y,CubeCamera as Q,EquirectangularReflectionMapping as Z,EquirectangularRefractionMapping as J,AddOperation as ee,MixOperation as te,MultiplyOperation as re,MeshBasicMaterial as se,MeshLambertMaterial as ie,MeshPhongMaterial as ne,OrthographicCamera as ae,PerspectiveCamera as oe,RenderTarget as ue,LinearSRGBColorSpace as le,RGBAFormat as de,HalfFloatType as ce,CubeUVReflectionMapping as he,BufferGeometry as pe,BufferAttribute as ge,MeshStandardMaterial as me,MeshPhysicalMaterial as fe,MeshToonMaterial as ye,MeshMatcapMaterial as be,SpriteMaterial as xe,PointsMaterial as Te,ShadowMaterial as _e,Uint32BufferAttribute as ve,Uint16BufferAttribute as Ne,arrayNeedsUint32 as Se,Camera as Ee,DepthStencilFormat as Re,DepthFormat as Ae,UnsignedInt248Type as we,UnsignedByteType as Ce,Plane as Me,Object3D as Pe,warnOnce as Be,LinearMipMapLinearFilter as Le,Float32BufferAttribute as Fe,UVMapping as Ie,VSMShadowMap as De,LessCompare as Ue,RGFormat as Ve,BasicShadowMap as Oe,SphereGeometry as Ge,LinearMipmapNearestFilter as ke,NearestMipmapLinearFilter as ze,Float16BufferAttribute as $e,REVISION as He,ArrayCamera as We,PlaneGeometry as qe,FrontSide as je,CustomBlending as Xe,AddEquation as Ke,ZeroFactor as Ye,CylinderGeometry as Qe,Quaternion as Ze,WebXRController as Je,RAD2DEG as et,PCFShadowMap as tt,FrustumArray as rt,Frustum as st,DataTexture as it,RedIntegerFormat as nt,RedFormat as at,ShortType as ot,ByteType as ut,UnsignedShortType as lt,RGIntegerFormat as dt,RGBIntegerFormat as ct,RGBFormat as ht,RGBAIntegerFormat as pt,createCanvasElement as gt,ReverseSubtractEquation as mt,SubtractEquation as ft,OneMinusDstAlphaFactor as yt,OneMinusDstColorFactor as bt,OneMinusSrcAlphaFactor as xt,OneMinusSrcColorFactor as Tt,DstAlphaFactor as _t,DstColorFactor as vt,SrcAlphaSaturateFactor as Nt,SrcAlphaFactor as St,SrcColorFactor as Et,OneFactor as Rt,CullFaceNone as At,CullFaceBack as wt,CullFaceFront as Ct,MultiplyBlending as Mt,SubtractiveBlending as Pt,AdditiveBlending as Bt,NotEqualDepth as Lt,GreaterDepth as Ft,GreaterEqualDepth as It,EqualDepth as Dt,LessEqualDepth as Ut,LessDepth as Vt,AlwaysDepth as Ot,NeverDepth as Gt,UnsignedShort4444Type as kt,UnsignedShort5551Type as zt,UnsignedInt5999Type as $t,UnsignedInt101111Type as Ht,AlphaFormat as Wt,RGB_S3TC_DXT1_Format as qt,RGBA_S3TC_DXT1_Format as jt,RGBA_S3TC_DXT3_Format as Xt,RGBA_S3TC_DXT5_Format as Kt,RGB_PVRTC_4BPPV1_Format as Yt,RGB_PVRTC_2BPPV1_Format as Qt,RGBA_PVRTC_4BPPV1_Format as Zt,RGBA_PVRTC_2BPPV1_Format as Jt,RGB_ETC1_Format as er,RGB_ETC2_Format as tr,RGBA_ETC2_EAC_Format as rr,RGBA_ASTC_4x4_Format as sr,RGBA_ASTC_5x4_Format as ir,RGBA_ASTC_5x5_Format as nr,RGBA_ASTC_6x5_Format as ar,RGBA_ASTC_6x6_Format as or,RGBA_ASTC_8x5_Format as ur,RGBA_ASTC_8x6_Format as lr,RGBA_ASTC_8x8_Format as dr,RGBA_ASTC_10x5_Format as cr,RGBA_ASTC_10x6_Format as hr,RGBA_ASTC_10x8_Format as pr,RGBA_ASTC_10x10_Format as gr,RGBA_ASTC_12x10_Format as mr,RGBA_ASTC_12x12_Format as fr,RGBA_BPTC_Format as yr,RED_RGTC1_Format as br,SIGNED_RED_RGTC1_Format as xr,RED_GREEN_RGTC2_Format as Tr,SIGNED_RED_GREEN_RGTC2_Format as _r,MirroredRepeatWrapping as vr,ClampToEdgeWrapping as Nr,RepeatWrapping as Sr,NearestMipmapNearestFilter as Er,NotEqualCompare as Rr,GreaterCompare as Ar,GreaterEqualCompare as wr,EqualCompare as Cr,LessEqualCompare as Mr,AlwaysCompare as Pr,NeverCompare as Br,LinearTransfer as Lr,getByteLength as Fr,TimestampQuery as Ir,NotEqualStencilFunc as Dr,GreaterStencilFunc as Ur,GreaterEqualStencilFunc as Vr,EqualStencilFunc as Or,LessEqualStencilFunc as Gr,LessStencilFunc as kr,AlwaysStencilFunc as zr,NeverStencilFunc as $r,DecrementWrapStencilOp as Hr,IncrementWrapStencilOp as Wr,DecrementStencilOp as qr,IncrementStencilOp as jr,InvertStencilOp as Xr,ReplaceStencilOp as Kr,ZeroStencilOp as Yr,KeepStencilOp as Qr,MaxEquation as Zr,MinEquation as Jr,SpotLight as es,PointLight as ts,DirectionalLight as rs,RectAreaLight as ss,AmbientLight as is,HemisphereLight as ns,LightProbe as as,LinearToneMapping as os,ReinhardToneMapping as us,CineonToneMapping as ls,ACESFilmicToneMapping as ds,AgXToneMapping as cs,NeutralToneMapping as hs,Group as ps,Loader as gs,FileLoader as ms,MaterialLoader as fs,ObjectLoader as ys}from"./three.core.min.js";export{AdditiveAnimationBlendMode,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BasicDepthPacking,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxHelper,BufferGeometryLoader,Cache,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CircleGeometry,Clock,ColorKeyframeTrack,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,Controls,CubeTextureLoader,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceFrontBack,Curve,CurvePath,CustomToneMapping,Cylindrical,Data3DTexture,DataTextureLoader,DataUtils,DefaultLoadingManager,DetachedBindMode,DirectionalLightHelper,DiscreteInterpolant,DodecahedronGeometry,DynamicCopyUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,ExternalTexture,ExtrudeGeometry,Fog,FogExp2,GLBufferAttribute,GLSL1,GLSL3,GridHelper,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,InstancedBufferGeometry,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InterpolationSamplingMode,InterpolationSamplingType,KeyframeTrack,LOD,LatheGeometry,Layers,Light,Line,Line3,LineCurve,LineCurve3,LineLoop,LineSegments,LinearInterpolant,LinearMipMapNearestFilter,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,MOUSE,MeshDepthMaterial,MeshDistanceMaterial,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NormalAnimationBlendMode,NumberKeyframeTrack,OctahedronGeometry,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,PCFSoftShadowMap,Path,PlaneHelper,PointLightHelper,Points,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RGBADepthPacking,RGBDepthPacking,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGDepthPacking,RawShaderMaterial,Ray,Raycaster,RenderTarget3D,RingGeometry,ShaderMaterial,Shape,ShapeGeometry,ShapePath,ShapeUtils,Skeleton,SkeletonHelper,SkinnedMesh,Source,Spherical,SphericalHarmonics3,SplineCurve,SpotLightHelper,Sprite,StaticCopyUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,TOUCH,TetrahedronGeometry,TextureLoader,TextureUtils,Timer,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,VectorKeyframeTrack,VideoFrameTexture,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLRenderTarget,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroSlopeEnding}from"./three.core.min.js";const bs=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],xs=new WeakMap;class Ts{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=!0===e.object.isSkinnedMesh,this.refreshUniforms=bs,this.renderId=0}firstInitialization(e){return!1===this.renderObjects.has(e)&&(this.getRenderObjectData(e),!0)}needsVelocity(e){const t=e.getMRT();return null!==t&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(void 0===t){const{geometry:r,material:s,object:i}=e;if(t={material:this.getMaterialData(s),geometry:{id:r.id,attributes:this.getAttributesData(r.attributes),indexVersion:r.index?r.index.version:null,drawRange:{start:r.drawRange.start,count:r.drawRange.count}},worldMatrix:i.matrixWorld.clone()},i.center&&(t.center=i.center.clone()),i.morphTargetInfluences&&(t.morphTargetInfluences=i.morphTargetInfluences.slice()),null!==e.bundle&&(t.version=e.bundle.version),t.material.transmission>0){const{width:r,height:s}=e.context;t.bufferWidth=r,t.bufferHeight=s}t.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const r in e){const s=e[r];t[r]={version:s.version}}return t}containsNode(e){const t=e.material;for(const e in t)if(t[e]&&t[e].isNode)return!0;return null!==e.renderer.overrideNodes.modelViewMatrix||null!==e.renderer.overrideNodes.modelNormalViewMatrix}getMaterialData(e){const t={};for(const r of this.refreshUniforms){const s=e[r];null!=s&&("object"==typeof s&&void 0!==s.clone?!0===s.isTexture?t[r]={id:s.id,version:s.version}:t[r]=s.clone():t[r]=s)}return t}equals(e,t){const{object:r,material:s,geometry:i}=e,n=this.getRenderObjectData(e);if(!0!==n.worldMatrix.equals(r.matrixWorld))return n.worldMatrix.copy(r.matrixWorld),!1;const a=n.material;for(const e in a){const t=a[e],r=s[e];if(void 0!==t.equals){if(!1===t.equals(r))return t.copy(r),!1}else if(!0===r.isTexture){if(t.id!==r.id||t.version!==r.version)return t.id=r.id,t.version=r.version,!1}else if(t!==r)return a[e]=r,!1}if(a.transmission>0){const{width:t,height:r}=e.context;if(n.bufferWidth!==t||n.bufferHeight!==r)return n.bufferWidth=t,n.bufferHeight=r,!1}const o=n.geometry,u=i.attributes,l=o.attributes,d=Object.keys(l),c=Object.keys(u);if(o.id!==i.id)return o.id=i.id,!1;if(d.length!==c.length)return n.geometry.attributes=this.getAttributesData(u),!1;for(const e of d){const t=l[e],r=u[e];if(void 0===r)return delete l[e],!1;if(t.version!==r.version)return t.version=r.version,!1}const h=i.index,p=o.indexVersion,g=h?h.version:null;if(p!==g)return o.indexVersion=g,!1;if(o.drawRange.start!==i.drawRange.start||o.drawRange.count!==i.drawRange.count)return o.drawRange.start=i.drawRange.start,o.drawRange.count=i.drawRange.count,!1;if(n.morphTargetInfluences){let e=!1;for(let t=0;t<n.morphTargetInfluences.length;t++)n.morphTargetInfluences[t]!==r.morphTargetInfluences[t]&&(e=!0);if(e)return!0}if(n.lights)for(let e=0;e<t.length;e++)if(n.lights[e].map!==t[e].map)return!1;return n.center&&!1===n.center.equals(r.center)?(n.center.copy(r.center),!0):(null!==e.bundle&&(n.version=e.bundle.version),!0)}getLightsData(e){const t=[];for(const r of e)!0===r.isSpotLight&&null!==r.map&&t.push({map:r.map.version});return t}getLights(e,t){if(xs.has(e)){const r=xs.get(e);if(r.renderId===t)return r.lightsData}const r=this.getLightsData(e.getLights());return xs.set(e,{renderId:t,lightsData:r}),r}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:r}=t;if(this.renderId!==r)return this.renderId=r,!0;const s=!0===e.object.static,i=null!==e.bundle&&!0===e.bundle.static&&this.getRenderObjectData(e).version===e.bundle.version;if(s||i)return!1;const n=this.getLights(e.lightsNode,r);return!0!==this.equals(e,n)}}function _s(e,t=0){let r=3735928559^t,s=1103547991^t;if(e instanceof Array)for(let t,i=0;i<e.length;i++)t=e[i],r=Math.imul(r^t,2654435761),s=Math.imul(s^t,1597334677);else for(let t,i=0;i<e.length;i++)t=e.charCodeAt(i),r=Math.imul(r^t,2654435761),s=Math.imul(s^t,1597334677);return r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507),s^=Math.imul(r^r>>>13,3266489909),4294967296*(2097151&s)+(r>>>0)}const vs=e=>_s(e),Ns=e=>_s(e),Ss=(...e)=>_s(e);function Es(e,t=!1){const r=[];!0===e.isNode&&r.push(e.id);for(const{property:s,childNode:i}of Rs(e))r.push(_s(s.slice(0,-4)),i.getCacheKey(t));return _s(r)}function*Rs(e,t=!1){for(const r of Object.getOwnPropertyNames(e)){if(!0===r.startsWith("_"))continue;const s=e[r];if(!0===Array.isArray(s))for(let e=0;e<s.length;e++){const i=s[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:r,index:e,childNode:i})}else if(s&&!0===s.isNode)yield{property:r,childNode:s};else if(s&&Object.getPrototypeOf(s)===Object.prototype)for(const e in s){if(!0===e.startsWith("_"))continue;const i=s[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:r,index:e,childNode:i})}}}const As=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),ws=new WeakMap;function Cs(e){return As.get(e)}function Ms(e){if(/[iu]?vec\d/.test(e))return e.startsWith("ivec")?Int32Array:e.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(e))return Float32Array;if(/float/.test(e))return Float32Array;if(/uint/.test(e))return Uint32Array;if(/int/.test(e))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${e}`)}function Ps(e){return/float|int|uint/.test(e)?1:/vec2/.test(e)?2:/vec3/.test(e)?3:/vec4/.test(e)||/mat2/.test(e)?4:/mat3/.test(e)?9:/mat4/.test(e)?16:void console.error("THREE.TSL: Unsupported type:",e)}function Bs(e){return/float|int|uint/.test(e)?1:/vec2/.test(e)?2:/vec3/.test(e)?3:/vec4/.test(e)||/mat2/.test(e)?4:/mat3/.test(e)?12:/mat4/.test(e)?16:void console.error("THREE.TSL: Unsupported type:",e)}function Ls(e){return/float|int|uint/.test(e)?4:/vec2/.test(e)?8:/vec3/.test(e)||/vec4/.test(e)?16:/mat2/.test(e)?8:/mat3/.test(e)?48:/mat4/.test(e)?64:void console.error("THREE.TSL: Unsupported type:",e)}function Fs(e){if(null==e)return null;const t=typeof e;return!0===e.isNode?"node":"number"===t?"float":"boolean"===t?"bool":"string"===t?"string":"function"===t?"shader":!0===e.isVector2?"vec2":!0===e.isVector3?"vec3":!0===e.isVector4?"vec4":!0===e.isMatrix2?"mat2":!0===e.isMatrix3?"mat3":!0===e.isMatrix4?"mat4":!0===e.isColor?"color":e instanceof ArrayBuffer?"ArrayBuffer":null}function Is(o,...u){const l=o?o.slice(-4):void 0;return 1===u.length&&("vec2"===l?u=[u[0],u[0]]:"vec3"===l?u=[u[0],u[0],u[0]]:"vec4"===l&&(u=[u[0],u[0],u[0],u[0]])),"color"===o?new e(...u):"vec2"===l?new t(...u):"vec3"===l?new r(...u):"vec4"===l?new s(...u):"mat2"===l?new i(...u):"mat3"===l?new n(...u):"mat4"===l?new a(...u):"bool"===o?u[0]||!1:"float"===o||"int"===o||"uint"===o?u[0]||0:"string"===o?u[0]||"":"ArrayBuffer"===o?Vs(u[0]):null}function Ds(e){let t=ws.get(e);return void 0===t&&(t={},ws.set(e,t)),t}function Us(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return btoa(t)}function Vs(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0)).buffer}var Os=Object.freeze({__proto__:null,arrayBufferToBase64:Us,base64ToArrayBuffer:Vs,getByteBoundaryFromType:Ls,getCacheKey:Es,getDataFromObject:Ds,getLengthFromType:Ps,getMemoryLengthFromType:Bs,getNodeChildren:Rs,getTypeFromLength:Cs,getTypedArrayFromType:Ms,getValueFromType:Is,getValueType:Fs,hash:Ss,hashArray:Ns,hashString:vs});const Gs={VERTEX:"vertex",FRAGMENT:"fragment"},ks={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},zs={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},$s={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},Hs=["fragment","vertex"],Ws=["setup","analyze","generate"],qs=[...Hs,"compute"],js=["x","y","z","w"],Xs={analyze:"setup",generate:"analyze"};let Ks=0;class Ys extends o{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=ks.NONE,this.updateBeforeType=ks.NONE,this.updateAfterType=ks.NONE,this.uuid=u.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:Ks++})}set needsUpdate(e){!0===e&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,ks.FRAME)}onRenderUpdate(e){return this.onUpdate(e,ks.RENDER)}onObjectUpdate(e){return this.onUpdate(e,ks.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of Rs(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return!0!==(e=e||this.version!==this._cacheKeyVersion)&&null!==this._cacheKey||(this._cacheKey=Ss(Es(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){const t=e.getNodeProperties(this);let r=0;for(const e of this.getChildren())t["node"+r++]=e;return t.outputNode||null}analyze(e,t=null){const r=e.increaseUsage(this);if(!0===this.parents){const r=e.getDataFromNode(this,"any");r.stages=r.stages||{},r.stages[e.shaderStage]=r.stages[e.shaderStage]||[],r.stages[e.shaderStage].push(t)}if(1===r){const t=e.getNodeProperties(this);for(const r of Object.values(t))r&&!0===r.isNode&&r.build(e,this)}}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);if(r&&!0===r.isNode)return r.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const r=this.getShared(e);if(this!==r)return r.build(e,t);const s=e.getDataFromNode(this);s.buildStages=s.buildStages||{},s.buildStages[e.buildStage]=!0;const i=Xs[e.buildStage];if(i&&!0!==s.buildStages[i]){const t=e.getBuildStage();e.setBuildStage(i),this.build(e),e.setBuildStage(t)}e.addNode(this),e.addChain(this);let n=null;const a=e.getBuildStage();if("setup"===a){this.updateReference(e);const t=e.getNodeProperties(this);if(!0!==t.initialized){t.initialized=!0,t.outputNode=this.setup(e)||t.outputNode||null;for(const r of Object.values(t))if(r&&!0===r.isNode){if(!0===r.parents){const t=e.getNodeProperties(r);t.parents=t.parents||[],t.parents.push(this)}r.build(e)}}n=t.outputNode}else if("analyze"===a)this.analyze(e,t);else if("generate"===a){if(1===this.generate.length){const r=this.getNodeType(e),s=e.getDataFromNode(this);n=s.snippet,void 0===n?void 0===s.generated?(s.generated=!0,n=this.generate(e)||"",s.snippet=n):(console.warn("THREE.Node: Recursion detected.",this),n="/* Recursion detected. */"):void 0!==s.flowCodes&&void 0!==e.context.nodeBlock&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),n=e.format(n,r,t)}else n=this.generate(e,t)||"";""===n&&null!==t&&"void"!==t&&"OutputType"!==t&&(console.error(`THREE.TSL: Invalid generated code, expected a "${t}".`),n=e.generateConst(t))}return e.removeChain(this),e.addSequentialNode(this),n}getSerializeChildren(){return Rs(this)}serialize(e){const t=this.getSerializeChildren(),r={};for(const{property:s,index:i,childNode:n}of t)void 0!==i?(void 0===r[s]&&(r[s]=Number.isInteger(i)?[]:{}),r[s][i]=n.toJSON(e.meta).uuid):r[s]=n.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(void 0!==e.inputNodes){const t=e.meta.nodes;for(const r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){const s=[];for(const i of e.inputNodes[r])s.push(t[i]);this[r]=s}else if("object"==typeof e.inputNodes[r]){const s={};for(const i in e.inputNodes[r]){const n=e.inputNodes[r][i];s[i]=t[n]}this[r]=s}else{const s=e.inputNodes[r];this[r]=t[s]}}}toJSON(e){const{uuid:t,type:r}=this,s=void 0===e||"string"==typeof e;s&&(e={textures:{},images:{},nodes:{}});let i=e.nodes[t];function n(e){const t=[];for(const r in e){const s=e[r];delete s.metadata,t.push(s)}return t}if(void 0===i&&(i={uuid:t,type:r,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},!0!==s&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta),s){const t=n(e.textures),r=n(e.images),s=n(e.nodes);t.length>0&&(i.textures=t),r.length>0&&(i.images=r),s.length>0&&(i.nodes=s)}return i}}class Qs extends Ys{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e);return`${this.node.build(e)}[ ${this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint")} ]`}}class Zs extends Ys{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let r=null;for(const s of this.convertTo.split("|"))null!==r&&e.getTypeLength(t)!==e.getTypeLength(s)||(r=s);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const r=this.node,s=this.getNodeType(e),i=r.build(e,s);return e.format(i,s,t)}}class Js extends Ys{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if("generate"===e.getBuildStage()){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(void 0!==s.propertyName)return e.format(s.propertyName,r,t);if("void"!==r&&"void"!==t&&this.hasDependencies(e)){const i=super.build(e,r),n=e.getVarFromNode(this,null,r),a=e.getPropertyName(n);return e.addLineFlowCode(`${a} = ${i}`,this),s.snippet=i,s.propertyName=a,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class ei extends Js{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,r)=>t+e.getTypeLength(r.getNodeType(e)),0))}generate(e,t){const r=this.getNodeType(e),s=e.getTypeLength(r),i=this.nodes,n=e.getComponentType(r),a=[];let o=0;for(const t of i){if(o>=s){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${r}()' type.`);break}let i,u=t.getNodeType(e),l=e.getTypeLength(u);o+l>s&&(console.error(`THREE.TSL: Length of '${r}()' data exceeds maximum length of output type.`),l=s-o,u=e.getTypeFromLength(l)),o+=l,i=t.build(e,u);if(e.getComponentType(u)!==n){const t=e.getTypeFromLength(l,n);i=e.format(i,u,t)}a.push(i)}const u=`${e.getType(r)}( ${a.join(", ")} )`;return e.format(u,r,t)}}const ti=js.join("");class ri extends Ys{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(js.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){const r=this.node,s=e.getTypeLength(r.getNodeType(e));let i=null;if(s>1){let n=null;this.getVectorLength()>=s&&(n=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const a=r.build(e,n);i=this.components.length===s&&this.components===ti.slice(0,this.components.length)?e.format(a,n,t):e.format(`${a}.${this.components}`,this.getNodeType(e),t)}else i=r.build(e,t);return i}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class si extends Js{static get type(){return"SetNode"}constructor(e,t,r){super(),this.sourceNode=e,this.components=t,this.targetNode=r}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:r,targetNode:s}=this,i=this.getNodeType(e),n=e.getComponentType(s.getNodeType(e)),a=e.getTypeFromLength(r.length,n),o=s.build(e,a),u=t.build(e,i),l=e.getTypeLength(i),d=[];for(let e=0;e<l;e++){const t=js[e];t===r[0]?(d.push(o),e+=r.length-1):d.push(u+"."+t)}return`${e.getType(i)}( ${d.join(", ")} )`}}class ii extends Js{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:r}=this,s=this.getNodeType(e),i=r.build(e),n=e.getVarFromNode(this),a=e.getPropertyName(n);e.addLineFlowCode(a+" = "+i,this);const o=e.getTypeLength(s),u=[];let l=0;for(let e=0;e<o;e++){const r=js[e];r===t[l]?(u.push("1.0 - "+a+"."+r),l++):u.push(a+"."+r)}return`${e.getType(s)}( ${u.join(", ")} )`}}class ni extends Ys{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return null===this.nodeType?Fs(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Fs(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=Us(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?Is(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const ai=/float|u?int/;class oi extends ni{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const r=this.getNodeType(e);return ai.test(r)&&ai.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),r,t)}}class ui extends Ys{static get type(){return"MemberNode"}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}hasMember(e){return(!this.structNode.isMemberNode||!1!==this.structNode.hasMember(e))&&"void"!==this.structNode.getMemberType(e,this.property)}getNodeType(e){return!1===this.hasMember(e)?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(!1===this.hasMember(e))return"float";const r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}generate(e){if(!1===this.hasMember(e)){console.warn(`THREE.TSL: Member "${this.property}" does not exist in struct.`);const t=this.getNodeType(e);return e.generateConst(t)}return this.structNode.build(e)+"."+this.property}}let li=null;const di=new Map;function ci(e,t){if(di.has(e))console.warn(`THREE.TSL: Redefinition of method chaining '${e}'.`);else{if("function"!=typeof t)throw new Error(`THREE.TSL: Node element ${e} is not a function`);di.set(e,t),"assign"!==e&&(Ys.prototype[e]=function(...e){return this.isStackNode?this.add(t(...e)):t(this,...e)},Ys.prototype[e+"Assign"]=function(...e){return this.isStackNode?this.assign(e[0],t(...e)):this.assign(t(this,...e))})}}const hi=e=>(e=>e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"))(e).split("").sort().join("");Ys.prototype.assign=function(...e){if(!0!==this.isStackNode)return null!==li?li.assign(this,...e):console.error("THREE.TSL: No stack defined for assign operation. Make sure the assign is inside a Fn()."),this;{const t=di.get("assign");return this.add(t(...e))}},Ys.prototype.toVarIntent=function(){return this},Ys.prototype.get=function(e){return new ui(this,e)};const pi={};function gi(e,t,r){pi[e]=pi[t]=pi[r]={get(){this._cache=this._cache||{};let t=this._cache[e];return void 0===t&&(t=new ri(this,e),this._cache[e]=t),t},set(t){this[e].assign(Gi(t))}};const s=e.toUpperCase(),i=t.toUpperCase(),n=r.toUpperCase();Ys.prototype["set"+s]=Ys.prototype["set"+i]=Ys.prototype["set"+n]=function(t){const r=hi(e);return new si(this,r,Gi(t))},Ys.prototype["flip"+s]=Ys.prototype["flip"+i]=Ys.prototype["flip"+n]=function(){const t=hi(e);return new ii(this,t)}}const mi=["x","y","z","w"],fi=["r","g","b","a"],yi=["s","t","p","q"];for(let e=0;e<4;e++){let t=mi[e],r=fi[e],s=yi[e];gi(t,r,s);for(let i=0;i<4;i++){t=mi[e]+mi[i],r=fi[e]+fi[i],s=yi[e]+yi[i],gi(t,r,s);for(let n=0;n<4;n++){t=mi[e]+mi[i]+mi[n],r=fi[e]+fi[i]+fi[n],s=yi[e]+yi[i]+yi[n],gi(t,r,s);for(let a=0;a<4;a++)t=mi[e]+mi[i]+mi[n]+mi[a],r=fi[e]+fi[i]+fi[n]+fi[a],s=yi[e]+yi[i]+yi[n]+yi[a],gi(t,r,s)}}}for(let e=0;e<32;e++)pi[e]={get(){this._cache=this._cache||{};let t=this._cache[e];return void 0===t&&(t=new Qs(this,new oi(e,"uint")),this._cache[e]=t),t},set(t){this[e].assign(Gi(t))}};Object.defineProperties(Ys.prototype,pi);const bi=new WeakMap,xi=function(e,t=null){for(const r in e)e[r]=Gi(e[r],t);return e},Ti=function(e,t=null){const r=e.length;for(let s=0;s<r;s++)e[s]=Gi(e[s],t);return e},_i=function(e,t=null,r=null,s=null){function i(e){return null!==s?(e=Gi(Object.assign(e,s)),!0===s.intent&&(e=e.toVarIntent())):e=Gi(e),e}let n,a,o,u=t;function l(t){let r;return r=u?/[a-z]/i.test(u)?u+"()":u:e.type,void 0!==a&&t.length<a?(console.error(`THREE.TSL: "${r}" parameter length is less than minimum required.`),t.concat(new Array(a-t.length).fill(0))):void 0!==o&&t.length>o?(console.error(`THREE.TSL: "${r}" parameter length exceeds limit.`),t.slice(0,o)):t}return null===t?n=(...t)=>i(new e(...$i(l(t)))):null!==r?(r=Gi(r),n=(...s)=>i(new e(t,...$i(l(s)),r))):n=(...r)=>i(new e(t,...$i(l(r)))),n.setParameterLength=(...e)=>(1===e.length?a=o=e[0]:2===e.length&&([a,o]=e),n),n.setName=e=>(u=e,n),n},vi=function(e,...t){return Gi(new e(...$i(t)))};class Ni extends Ys{constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,rawInputs:r}=this,s=e.getNodeProperties(t),i=e.getClosestSubBuild(t.subBuilds)||"",n=i||"default";if(s[n])return s[n];const a=e.subBuildFn;e.subBuildFn=i;let o=null;if(t.layout){let s=bi.get(e.constructor);void 0===s&&(s=new WeakMap,bi.set(e.constructor,s));let i=s.get(t);void 0===i&&(i=Gi(e.buildFunctionNode(t)),s.set(t,i)),e.addInclude(i);const n=r?function(e){let t;zi(e);t=e[0]&&(e[0].isNode||Object.getPrototypeOf(e[0])!==Object.prototype)?[...e]:e[0];return t}(r):null;o=Gi(i.call(n))}else{const s=new Proxy(e,{get:(e,t,r)=>{let s;return s=Symbol.iterator===t?function*(){yield}:Reflect.get(e,t,r),s}}),i=r?function(e){let t=0;return zi(e),new Proxy(e,{get:(r,s,i)=>{let n;if("length"===s)return n=e.length,n;if(Symbol.iterator===s)n=function*(){for(const t of e)yield Gi(t)};else{if(e.length>0)if(Object.getPrototypeOf(e[0])===Object.prototype){const r=e[0];n=void 0===r[s]?r[t++]:Reflect.get(r,s,i)}else e[0]instanceof Ys&&(n=void 0===e[s]?e[t++]:Reflect.get(e,s,i));else n=Reflect.get(r,s,i);n=Gi(n)}return n}})}(r):null,n=Array.isArray(r)?r.length>0:null!==r,a=t.jsFunc,u=n||a.length>1?a(i,s):a(s);o=Gi(u)}return e.subBuildFn=a,t.once&&(s[n]=o),o}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),r=e.getSubBuildOutput(this);return t[r]=t[r]||this.setupOutput(e),t[r].subBuild=e.getClosestSubBuild(this),t[r]}build(e,t=null){let r=null;const s=e.getBuildStage(),i=e.getNodeProperties(this),n=e.getSubBuildOutput(this),a=this.getOutputNode(e);if("setup"===s){const t=e.getSubBuildProperty("initialized",this);if(!0!==i[t]&&(i[t]=!0,i[n]=this.getOutputNode(e),i[n].build(e),this.shaderNode.subBuilds))for(const t of e.chaining){const r=e.getDataFromNode(t,"any");r.subBuilds=r.subBuilds||new Set;for(const e of this.shaderNode.subBuilds)r.subBuilds.add(e)}r=i[n]}else"analyze"===s?a.build(e,t):"generate"===s&&(r=a.build(e,t)||"");return r}}class Si extends Ys{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return Gi(new Ni(this,e))}setup(){return this.call()}}const Ei=[!1,!0],Ri=[0,1,2,3],Ai=[-1,-2],wi=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],Ci=new Map;for(const e of Ei)Ci.set(e,new oi(e));const Mi=new Map;for(const e of Ri)Mi.set(e,new oi(e,"uint"));const Pi=new Map([...Mi].map(e=>new oi(e.value,"int")));for(const e of Ai)Pi.set(e,new oi(e,"int"));const Bi=new Map([...Pi].map(e=>new oi(e.value)));for(const e of wi)Bi.set(e,new oi(e));for(const e of wi)Bi.set(-e,new oi(-e));const Li={bool:Ci,uint:Mi,ints:Pi,float:Bi},Fi=new Map([...Ci,...Bi]),Ii=(e,t)=>Fi.has(e)?Fi.get(e):!0===e.isNode?e:new oi(e,t),Di=function(e,t=null){return(...r)=>{for(const t of r)if(void 0===t)return console.error(`THREE.TSL: Invalid parameter for the type "${e}".`),Gi(new oi(0,e));if((0===r.length||!["bool","float","int","uint"].includes(e)&&r.every(e=>{const t=typeof e;return"object"!==t&&"function"!==t}))&&(r=[Is(e,...r)]),1===r.length&&null!==t&&t.has(r[0]))return ki(t.get(r[0]));if(1===r.length){const t=Ii(r[0],e);return t.nodeType===e?ki(t):ki(new Zs(t,e))}const s=r.map(e=>Ii(e));return ki(new ei(s,e))}},Ui=e=>"object"==typeof e&&null!==e?e.value:e,Vi=e=>null!=e?e.nodeType||e.convertTo||("string"==typeof e?e:null):null;function Oi(e,t){return new Si(e,t)}const Gi=(e,t=null)=>function(e,t=null){const r=Fs(e);return"node"===r?e:null===t&&("float"===r||"boolean"===r)||r&&"shader"!==r&&"string"!==r?Gi(Ii(e,t)):"shader"===r?e.isFn?e:Ki(e):e}(e,t),ki=(e,t=null)=>Gi(e,t).toVarIntent(),zi=(e,t=null)=>new xi(e,t),$i=(e,t=null)=>new Ti(e,t),Hi=(e,t=null,r=null,s=null)=>new _i(e,t,r,s),Wi=(e,...t)=>new vi(e,...t),qi=(e,t=null,r=null,s={})=>new _i(e,t,r,{intent:!0,...s});let ji=0;class Xi extends Ys{constructor(e,t=null){super();let r=null;null!==t&&("object"==typeof t?r=t.return:("string"==typeof t?r=t:console.error("THREE.TSL: Invalid layout type."),t=null)),this.shaderNode=new Oi(e,r),null!==t&&this.setLayout(t),this.isFn=!0}setLayout(e){const t=this.shaderNode.nodeType;if("object"!=typeof e.inputs){const r={name:"fn"+ji++,type:t,inputs:[]};for(const t in e)"return"!==t&&r.inputs.push({name:t,type:e[t]});e=r}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const t=this.shaderNode.call(e);return"void"===this.shaderNode.nodeType&&t.toStack(),t.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const t=this.getNodeType(e);return console.error('THREE.TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".'),e.generateConst(t)}}function Ki(e,t=null){const r=new Xi(e,t);return new Proxy(()=>{},{apply:(e,t,s)=>r.call(...s),get:(e,t,s)=>Reflect.get(r,t,s),set:(e,t,s,i)=>Reflect.set(r,t,s,i)})}const Yi=e=>{li=e},Qi=()=>li,Zi=(...e)=>li.If(...e);function Ji(e){return li&&li.add(e),e}ci("toStack",Ji);const en=new Di("color"),tn=new Di("float",Li.float),rn=new Di("int",Li.ints),sn=new Di("uint",Li.uint),nn=new Di("bool",Li.bool),an=new Di("vec2"),on=new Di("ivec2"),un=new Di("uvec2"),ln=new Di("bvec2"),dn=new Di("vec3"),cn=new Di("ivec3"),hn=new Di("uvec3"),pn=new Di("bvec3"),gn=new Di("vec4"),mn=new Di("ivec4"),fn=new Di("uvec4"),yn=new Di("bvec4"),bn=new Di("mat2"),xn=new Di("mat3"),Tn=new Di("mat4");ci("toColor",en),ci("toFloat",tn),ci("toInt",rn),ci("toUint",sn),ci("toBool",nn),ci("toVec2",an),ci("toIVec2",on),ci("toUVec2",un),ci("toBVec2",ln),ci("toVec3",dn),ci("toIVec3",cn),ci("toUVec3",hn),ci("toBVec3",pn),ci("toVec4",gn),ci("toIVec4",mn),ci("toUVec4",fn),ci("toBVec4",yn),ci("toMat2",bn),ci("toMat3",xn),ci("toMat4",Tn);const _n=Hi(Qs).setParameterLength(2),vn=(e,t)=>Gi(new Zs(Gi(e),t));ci("element",_n),ci("convert",vn);ci("append",e=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),Ji(e)));class Nn extends Ys{static get type(){return"PropertyNode"}constructor(e,t=null,r=!1){super(e),this.name=t,this.varying=r,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const Sn=(e,t)=>Gi(new Nn(e,t)),En=(e,t)=>Gi(new Nn(e,t,!0)),Rn=Wi(Nn,"vec4","DiffuseColor"),An=Wi(Nn,"vec3","EmissiveColor"),wn=Wi(Nn,"float","Roughness"),Cn=Wi(Nn,"float","Metalness"),Mn=Wi(Nn,"float","Clearcoat"),Pn=Wi(Nn,"float","ClearcoatRoughness"),Bn=Wi(Nn,"vec3","Sheen"),Ln=Wi(Nn,"float","SheenRoughness"),Fn=Wi(Nn,"float","Iridescence"),In=Wi(Nn,"float","IridescenceIOR"),Dn=Wi(Nn,"float","IridescenceThickness"),Un=Wi(Nn,"float","AlphaT"),Vn=Wi(Nn,"float","Anisotropy"),On=Wi(Nn,"vec3","AnisotropyT"),Gn=Wi(Nn,"vec3","AnisotropyB"),kn=Wi(Nn,"color","SpecularColor"),zn=Wi(Nn,"float","SpecularF90"),$n=Wi(Nn,"float","Shininess"),Hn=Wi(Nn,"vec4","Output"),Wn=Wi(Nn,"float","dashSize"),qn=Wi(Nn,"float","gapSize"),jn=Wi(Nn,"float","pointWidth"),Xn=Wi(Nn,"float","IOR"),Kn=Wi(Nn,"float","Transmission"),Yn=Wi(Nn,"float","Thickness"),Qn=Wi(Nn,"float","AttenuationDistance"),Zn=Wi(Nn,"color","AttenuationColor"),Jn=Wi(Nn,"float","Dispersion");class ea extends Ys{static get type(){return"UniformGroupNode"}constructor(e,t=!1,r=1){super("string"),this.name=e,this.shared=t,this.order=r,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const ta=e=>new ea(e),ra=(e,t=0)=>new ea(e,!0,t),sa=ra("frame"),ia=ra("render"),na=ta("object");class aa extends ni{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=na}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(t=>{const r=e(t,this);void 0!==r&&(this.value=r)},t)}getInputType(e){let t=super.getInputType(e);return"bool"===t&&(t="uint"),t}generate(e,t){const r=this.getNodeType(e),s=this.getUniformHash(e);let i=e.getNodeFromHash(s);void 0===i&&(e.setHashNode(this,s),i=this);const n=i.getInputType(e),a=e.getUniformFromNode(i,n,e.shaderStage,this.name||e.context.nodeName),o=e.getPropertyName(a);void 0!==e.context.nodeName&&delete e.context.nodeName;let u=o;if("bool"===r){const t=e.getDataFromNode(this);let s=t.propertyName;if(void 0===s){const i=e.getVarFromNode(this,null,"bool");s=e.getPropertyName(i),t.propertyName=s,u=e.format(o,n,r),e.addLineFlowCode(`${s} = ${u}`,this)}u=s}return e.format(u,r,t)}}const oa=(e,t)=>{const r=Vi(t||e);return r===e&&(e=Is(r)),e=e&&!0===e.isNode?e.node&&e.node.value||e.value:e,Gi(new aa(e,r))};class ua extends Js{static get type(){return"ArrayNode"}constructor(e,t,r=null){super(e),this.count=t,this.values=r,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return null===this.nodeType&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const la=(...e)=>{let t;if(1===e.length){const r=e[0];t=new ua(null,r.length,r)}else{const r=e[0],s=e[1];t=new ua(r,s)}return Gi(t)};ci("toArray",(e,t)=>la(Array(t).fill(e)));class da extends Js{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){const r=e.getTypeLength(t.node.getNodeType(e));return js.join("").slice(0,r)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:r}=this,s=t.getScope();e.getNodeProperties(s).assign=!0;const i=e.getNodeProperties(this);i.sourceNode=r,i.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:r,sourceNode:s}=e.getNodeProperties(this),i=this.needsSplitAssign(e),n=r.build(e),a=r.getNodeType(e),o=s.build(e,a),u=s.getNodeType(e),l=e.getDataFromNode(this);let d;if(!0===l.initialized)"void"!==t&&(d=n);else if(i){const s=e.getVarFromNode(this,null,a),i=e.getPropertyName(s);e.addLineFlowCode(`${i} = ${o}`,this);const u=r.node,l=u.node.context({assign:!0}).build(e);for(let t=0;t<u.components.length;t++){const r=u.components[t];e.addLineFlowCode(`${l}.${r} = ${i}[ ${t} ]`,this)}"void"!==t&&(d=n)}else d=`${n} = ${o}`,"void"!==t&&"void"!==u||(e.addLineFlowCode(d,this),"void"!==t&&(d=n));return l.initialized=!0,e.format(d,a,t)}}const ca=Hi(da).setParameterLength(2);ci("assign",ca);class ha extends Js{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){const t=[],r=this.functionNode,s=r.getInputs(e),i=this.parameters,n=(t,r)=>{const s=r.type;let i;return i="pointer"===s?"&"+t.build(e):t.build(e,s),i};if(Array.isArray(i)){if(i.length>s.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),i.length=s.length;else if(i.length<s.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");i.length<s.length;)i.push(tn(0));for(let e=0;e<i.length;e++)t.push(n(i[e],s[e]))}else for(const e of s){const r=i[e.name];void 0!==r?t.push(n(r,e)):(console.error(`THREE.TSL: Input '${e.name}' not found in 'Fn()'.`),t.push(n(tn(0),e)))}return`${r.build(e,"property")}( ${t.join(", ")} )`}}const pa=(e,...t)=>(t=t.length>1||t[0]&&!0===t[0].isNode?$i(t):zi(t[0]),Gi(new ha(Gi(e),t)));ci("call",pa);const ga={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class ma extends Js{static get type(){return"OperatorNode"}constructor(e,t,r,...s){if(super(),s.length>0){let i=new ma(e,t,r);for(let t=0;t<s.length-1;t++)i=new ma(e,i,s[t]);t=i,r=s[s.length-1]}this.op=e,this.aNode=t,this.bNode=r,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(ga[this.op],t)}getNodeType(e,t=null){const r=this.op,s=this.aNode,i=this.bNode,n=s.getNodeType(e),a=i?i.getNodeType(e):null;if("void"===n||"void"===a)return t||"void";if("%"===r)return n;if("~"===r||"&"===r||"|"===r||"^"===r||">>"===r||"<<"===r)return e.getIntegerType(n);if("!"===r||"&&"===r||"||"===r||"^^"===r)return"bool";if("=="===r||"!="===r||"<"===r||">"===r||"<="===r||">="===r){const t=Math.max(e.getTypeLength(n),e.getTypeLength(a));return t>1?`bvec${t}`:"bool"}if(e.isMatrix(n)){if("float"===a)return n;if(e.isVector(a))return e.getVectorFromMatrix(n);if(e.isMatrix(a))return n}else if(e.isMatrix(a)){if("float"===n)return a;if(e.isVector(n))return e.getVectorFromMatrix(a)}return e.getTypeLength(a)>e.getTypeLength(n)?a:n}generate(e,t){const r=this.op,{aNode:s,bNode:i}=this,n=this.getNodeType(e,t);let a=null,o=null;"void"!==n?(a=s.getNodeType(e),o=i?i.getNodeType(e):null,"<"===r||">"===r||"<="===r||">="===r||"=="===r||"!="===r?e.isVector(a)?o=a:e.isVector(o)?a=o:a!==o&&(a=o="float"):">>"===r||"<<"===r?(a=n,o=e.changeComponentType(o,"uint")):"%"===r?(a=n,o=e.isInteger(a)&&e.isInteger(o)?o:a):e.isMatrix(a)?"float"===o?o="float":e.isVector(o)?o=e.getVectorFromMatrix(a):e.isMatrix(o)||(a=o=n):a=e.isMatrix(o)?"float"===a?"float":e.isVector(a)?e.getVectorFromMatrix(o):o=n:o=n):a=o=n;const u=s.build(e,a),d=i?i.build(e,o):null,c=e.getFunctionOperator(r);if("void"!==t){const s=e.renderer.coordinateSystem===l;if("=="===r||"!="===r||"<"===r||">"===r||"<="===r||">="===r)return s&&e.isVector(a)?e.format(`${this.getOperatorMethod(e,t)}( ${u}, ${d} )`,n,t):e.format(`( ${u} ${r} ${d} )`,n,t);if("%"===r)return e.isInteger(o)?e.format(`( ${u} % ${d} )`,n,t):e.format(`${this.getOperatorMethod(e,n)}( ${u}, ${d} )`,n,t);if("!"===r||"~"===r)return e.format(`(${r}${u})`,a,t);if(c)return e.format(`${c}( ${u}, ${d} )`,n,t);if(e.isMatrix(a)&&"float"===o)return e.format(`( ${d} ${r} ${u} )`,n,t);if("float"===a&&e.isMatrix(o))return e.format(`${u} ${r} ${d}`,n,t);{let i=`( ${u} ${r} ${d} )`;return!s&&"bool"===n&&e.isVector(a)&&e.isVector(o)&&(i=`all${i}`),e.format(i,n,t)}}if("void"!==a)return c?e.format(`${c}( ${u}, ${d} )`,n,t):e.isMatrix(a)&&"float"===o?e.format(`${d} ${r} ${u}`,n,t):e.format(`${u} ${r} ${d}`,n,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const fa=qi(ma,"+").setParameterLength(2,1/0).setName("add"),ya=qi(ma,"-").setParameterLength(2,1/0).setName("sub"),ba=qi(ma,"*").setParameterLength(2,1/0).setName("mul"),xa=qi(ma,"/").setParameterLength(2,1/0).setName("div"),Ta=qi(ma,"%").setParameterLength(2).setName("mod"),_a=qi(ma,"==").setParameterLength(2).setName("equal"),va=qi(ma,"!=").setParameterLength(2).setName("notEqual"),Na=qi(ma,"<").setParameterLength(2).setName("lessThan"),Sa=qi(ma,">").setParameterLength(2).setName("greaterThan"),Ea=qi(ma,"<=").setParameterLength(2).setName("lessThanEqual"),Ra=qi(ma,">=").setParameterLength(2).setName("greaterThanEqual"),Aa=qi(ma,"&&").setParameterLength(2,1/0).setName("and"),wa=qi(ma,"||").setParameterLength(2,1/0).setName("or"),Ca=qi(ma,"!").setParameterLength(1).setName("not"),Ma=qi(ma,"^^").setParameterLength(2).setName("xor"),Pa=qi(ma,"&").setParameterLength(2).setName("bitAnd"),Ba=qi(ma,"~").setParameterLength(2).setName("bitNot"),La=qi(ma,"|").setParameterLength(2).setName("bitOr"),Fa=qi(ma,"^").setParameterLength(2).setName("bitXor"),Ia=qi(ma,"<<").setParameterLength(2).setName("shiftLeft"),Da=qi(ma,">>").setParameterLength(2).setName("shiftRight"),Ua=Ki(([e])=>(e.addAssign(1),e)),Va=Ki(([e])=>(e.subAssign(1),e)),Oa=Ki(([e])=>{const t=rn(e).toConst();return e.addAssign(1),t}),Ga=Ki(([e])=>{const t=rn(e).toConst();return e.subAssign(1),t});ci("add",fa),ci("sub",ya),ci("mul",ba),ci("div",xa),ci("mod",Ta),ci("equal",_a),ci("notEqual",va),ci("lessThan",Na),ci("greaterThan",Sa),ci("lessThanEqual",Ea),ci("greaterThanEqual",Ra),ci("and",Aa),ci("or",wa),ci("not",Ca),ci("xor",Ma),ci("bitAnd",Pa),ci("bitNot",Ba),ci("bitOr",La),ci("bitXor",Fa),ci("shiftLeft",Ia),ci("shiftRight",Da),ci("incrementBefore",Ua),ci("decrementBefore",Va),ci("increment",Oa),ci("decrement",Ga);const ka=(e,t)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),Ta(rn(e),rn(t)));ci("modInt",ka);class za extends Js{static get type(){return"MathNode"}constructor(e,t,r=null,s=null){if(super(),(e===za.MAX||e===za.MIN)&&arguments.length>3){let i=new za(e,t,r);for(let t=2;t<arguments.length-1;t++)i=new za(e,i,arguments[t]);t=i,r=arguments[arguments.length-1],s=null}this.method=e,this.aNode=t,this.bNode=r,this.cNode=s,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,s=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),n=e.isMatrix(r)?0:e.getTypeLength(r),a=e.isMatrix(s)?0:e.getTypeLength(s);return i>n&&i>a?t:n>a?r:a>i?s:t}getNodeType(e){const t=this.method;return t===za.LENGTH||t===za.DISTANCE||t===za.DOT?"float":t===za.CROSS?"vec3":t===za.ALL||t===za.ANY?"bool":t===za.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:r,method:s}=this;let i=null;if(s===za.ONE_MINUS)i=ya(1,t);else if(s===za.RECIPROCAL)i=xa(1,t);else if(s===za.DIFFERENCE)i=go(ya(t,r));else if(s===za.TRANSFORM_DIRECTION){let s=t,n=r;e.isMatrix(s.getNodeType(e))?n=gn(dn(n),0):s=gn(dn(s),0);const a=ba(s,n).xyz;i=no(a)}return null!==i?i:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let r=this.method;const s=this.getNodeType(e),i=this.getInputType(e),n=this.aNode,a=this.bNode,o=this.cNode,u=e.renderer.coordinateSystem;if(r===za.NEGATE)return e.format("( - "+n.build(e,i)+" )",s,t);{const c=[];return r===za.CROSS?c.push(n.build(e,s),a.build(e,s)):u===l&&r===za.STEP?c.push(n.build(e,1===e.getTypeLength(n.getNodeType(e))?"float":i),a.build(e,i)):u!==l||r!==za.MIN&&r!==za.MAX?r===za.REFRACT?c.push(n.build(e,i),a.build(e,i),o.build(e,"float")):r===za.MIX?c.push(n.build(e,i),a.build(e,i),o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":i)):(u===d&&r===za.ATAN&&null!==a&&(r="atan2"),"fragment"===e.shaderStage||r!==za.DFDX&&r!==za.DFDY||(console.warn(`THREE.TSL: '${r}' is not supported in the ${e.shaderStage} stage.`),r="/*"+r+"*/"),c.push(n.build(e,i)),null!==a&&c.push(a.build(e,i)),null!==o&&c.push(o.build(e,i))):c.push(n.build(e,i),a.build(e,1===e.getTypeLength(a.getNodeType(e))?"float":i)),e.format(`${e.getMethod(r,s)}( ${c.join(", ")} )`,s,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}za.ALL="all",za.ANY="any",za.RADIANS="radians",za.DEGREES="degrees",za.EXP="exp",za.EXP2="exp2",za.LOG="log",za.LOG2="log2",za.SQRT="sqrt",za.INVERSE_SQRT="inversesqrt",za.FLOOR="floor",za.CEIL="ceil",za.NORMALIZE="normalize",za.FRACT="fract",za.SIN="sin",za.COS="cos",za.TAN="tan",za.ASIN="asin",za.ACOS="acos",za.ATAN="atan",za.ABS="abs",za.SIGN="sign",za.LENGTH="length",za.NEGATE="negate",za.ONE_MINUS="oneMinus",za.DFDX="dFdx",za.DFDY="dFdy",za.ROUND="round",za.RECIPROCAL="reciprocal",za.TRUNC="trunc",za.FWIDTH="fwidth",za.TRANSPOSE="transpose",za.DETERMINANT="determinant",za.INVERSE="inverse",za.EQUALS="equals",za.MIN="min",za.MAX="max",za.STEP="step",za.REFLECT="reflect",za.DISTANCE="distance",za.DIFFERENCE="difference",za.DOT="dot",za.CROSS="cross",za.POW="pow",za.TRANSFORM_DIRECTION="transformDirection",za.MIX="mix",za.CLAMP="clamp",za.REFRACT="refract",za.SMOOTHSTEP="smoothstep",za.FACEFORWARD="faceforward";const $a=tn(1e-6),Ha=tn(1e6),Wa=tn(Math.PI),qa=tn(2*Math.PI),ja=qi(za,za.ALL).setParameterLength(1),Xa=qi(za,za.ANY).setParameterLength(1),Ka=qi(za,za.RADIANS).setParameterLength(1),Ya=qi(za,za.DEGREES).setParameterLength(1),Qa=qi(za,za.EXP).setParameterLength(1),Za=qi(za,za.EXP2).setParameterLength(1),Ja=qi(za,za.LOG).setParameterLength(1),eo=qi(za,za.LOG2).setParameterLength(1),to=qi(za,za.SQRT).setParameterLength(1),ro=qi(za,za.INVERSE_SQRT).setParameterLength(1),so=qi(za,za.FLOOR).setParameterLength(1),io=qi(za,za.CEIL).setParameterLength(1),no=qi(za,za.NORMALIZE).setParameterLength(1),ao=qi(za,za.FRACT).setParameterLength(1),oo=qi(za,za.SIN).setParameterLength(1),uo=qi(za,za.COS).setParameterLength(1),lo=qi(za,za.TAN).setParameterLength(1),co=qi(za,za.ASIN).setParameterLength(1),ho=qi(za,za.ACOS).setParameterLength(1),po=qi(za,za.ATAN).setParameterLength(1,2),go=qi(za,za.ABS).setParameterLength(1),mo=qi(za,za.SIGN).setParameterLength(1),fo=qi(za,za.LENGTH).setParameterLength(1),yo=qi(za,za.NEGATE).setParameterLength(1),bo=qi(za,za.ONE_MINUS).setParameterLength(1),xo=qi(za,za.DFDX).setParameterLength(1),To=qi(za,za.DFDY).setParameterLength(1),_o=qi(za,za.ROUND).setParameterLength(1),vo=qi(za,za.RECIPROCAL).setParameterLength(1),No=qi(za,za.TRUNC).setParameterLength(1),So=qi(za,za.FWIDTH).setParameterLength(1),Eo=qi(za,za.TRANSPOSE).setParameterLength(1),Ro=qi(za,za.DETERMINANT).setParameterLength(1),Ao=qi(za,za.INVERSE).setParameterLength(1),wo=(e,t)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),_a(e,t)),Co=qi(za,za.MIN).setParameterLength(2,1/0),Mo=qi(za,za.MAX).setParameterLength(2,1/0),Po=qi(za,za.STEP).setParameterLength(2),Bo=qi(za,za.REFLECT).setParameterLength(2),Lo=qi(za,za.DISTANCE).setParameterLength(2),Fo=qi(za,za.DIFFERENCE).setParameterLength(2),Io=qi(za,za.DOT).setParameterLength(2),Do=qi(za,za.CROSS).setParameterLength(2),Uo=qi(za,za.POW).setParameterLength(2),Vo=e=>ba(e,e),Oo=e=>ba(e,e,e),Go=e=>ba(e,e,e,e),ko=qi(za,za.TRANSFORM_DIRECTION).setParameterLength(2),zo=e=>ba(mo(e),Uo(go(e),1/3)),$o=e=>Io(e,e),Ho=qi(za,za.MIX).setParameterLength(3),Wo=(e,t=0,r=1)=>Gi(new za(za.CLAMP,Gi(e),Gi(t),Gi(r))),qo=e=>Wo(e),jo=qi(za,za.REFRACT).setParameterLength(3),Xo=qi(za,za.SMOOTHSTEP).setParameterLength(3),Ko=qi(za,za.FACEFORWARD).setParameterLength(3),Yo=Ki(([e])=>{const t=Io(e.xy,an(12.9898,78.233)),r=Ta(t,Wa);return ao(oo(r).mul(43758.5453))}),Qo=(e,t,r)=>Ho(t,r,e),Zo=(e,t,r)=>Xo(t,r,e),Jo=(e,t)=>Po(t,e),eu=(e,t)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),po(e,t)),tu=Ko,ru=ro;ci("all",ja),ci("any",Xa),ci("equals",wo),ci("radians",Ka),ci("degrees",Ya),ci("exp",Qa),ci("exp2",Za),ci("log",Ja),ci("log2",eo),ci("sqrt",to),ci("inverseSqrt",ro),ci("floor",so),ci("ceil",io),ci("normalize",no),ci("fract",ao),ci("sin",oo),ci("cos",uo),ci("tan",lo),ci("asin",co),ci("acos",ho),ci("atan",po),ci("abs",go),ci("sign",mo),ci("length",fo),ci("lengthSq",$o),ci("negate",yo),ci("oneMinus",bo),ci("dFdx",xo),ci("dFdy",To),ci("round",_o),ci("reciprocal",vo),ci("trunc",No),ci("fwidth",So),ci("atan2",eu),ci("min",Co),ci("max",Mo),ci("step",Jo),ci("reflect",Bo),ci("distance",Lo),ci("dot",Io),ci("cross",Do),ci("pow",Uo),ci("pow2",Vo),ci("pow3",Oo),ci("pow4",Go),ci("transformDirection",ko),ci("mix",Qo),ci("clamp",Wo),ci("refract",jo),ci("smoothstep",Zo),ci("faceForward",Ko),ci("difference",Fo),ci("saturate",qo),ci("cbrt",zo),ci("transpose",Eo),ci("determinant",Ro),ci("inverse",Ao),ci("rand",Yo);class su extends Ys{static get type(){return"ConditionalNode"}constructor(e,t,r=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=r}getNodeType(e){const{ifNode:t,elseNode:r}=e.getNodeProperties(this);if(void 0===t)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const s=t.getNodeType(e);if(null!==r){const t=r.getNodeType(e);if(e.getTypeLength(t)>e.getTypeLength(s))return t}return s}setup(e){const t=this.condNode.cache(),r=this.ifNode.cache(),s=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(r).parentNodeBlock=i,null!==s&&(e.getDataFromNode(s).parentNodeBlock=i);const n=e.context.uniformFlow,a=e.getNodeProperties(this);a.condNode=t,a.ifNode=n?r:r.context({nodeBlock:r}),a.elseNode=s?n?s:s.context({nodeBlock:s}):null}generate(e,t){const r=this.getNodeType(e),s=e.getDataFromNode(this);if(void 0!==s.nodeProperty)return s.nodeProperty;const{condNode:i,ifNode:n,elseNode:a}=e.getNodeProperties(this),o=e.currentFunctionNode,u="void"!==t,l=u?Sn(r).build(e):"";s.nodeProperty=l;const d=i.build(e,"bool");if(e.context.uniformFlow&&null!==a){const s=n.build(e,r),i=a.build(e,r),o=e.getTernary(d,s,i);return e.format(o,r,t)}e.addFlowCode(`\n${e.tab}if ( ${d} ) {\n\n`).addFlowTab();let c=n.build(e,r);if(c&&(u?c=l+" = "+c+";":(c="return "+c+";",null===o&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),c="// "+c))),e.removeFlowTab().addFlowCode(e.tab+"\t"+c+"\n\n"+e.tab+"}"),null!==a){e.addFlowCode(" else {\n\n").addFlowTab();let t=a.build(e,r);t&&(u?t=l+" = "+t+";":(t="return "+t+";",null===o&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),t="// "+t))),e.removeFlowTab().addFlowCode(e.tab+"\t"+t+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(l,r,t)}}const iu=Hi(su).setParameterLength(2,3);ci("select",iu);class nu extends Ys{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const r=e.getContext();e.setContext({...e.context,...this.value});const s=this.node.build(e,t);return e.setContext(r),s}}const au=Hi(nu).setParameterLength(1,2),ou=e=>au(e,{uniformFlow:!0}),uu=(e,t)=>au(e,{nodeName:t});function lu(e,t){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),uu(e,t)}ci("context",au),ci("label",lu),ci("uniformFlow",ou),ci("setName",uu);class du extends Ys{static get type(){return"VarNode"}constructor(e,t=null,r=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=r,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}build(...e){if(!0===this.intent){if(!0!==e[0].getNodeProperties(this).assign)return this.node.build(...e)}return super.build(...e)}generate(e){const{node:t,name:r,readOnly:s}=this,{renderer:i}=e,n=!0===i.backend.isWebGPUBackend;let a=!1,o=!1;s&&(a=e.isDeterministic(t),o=n?s:a);const u=e.getVectorType(this.getNodeType(e)),l=t.build(e,u),d=e.getVarFromNode(this,r,u,void 0,o),c=e.getPropertyName(d);let h=c;if(o)if(n)h=a?`const ${c}`:`let ${c}`;else{const r=t.getArrayCount(e);h=`const ${e.getVar(d.type,c,r)}`}return e.addLineFlowCode(`${h} = ${l}`,this),c}}const cu=Hi(du),hu=(e,t=null)=>cu(e,t).toStack(),pu=(e,t=null)=>cu(e,t,!0).toStack(),gu=e=>null===Qi()?e:cu(e).setIntent(!0).toStack();ci("toVar",hu),ci("toConst",pu),ci("toVarIntent",gu);class mu extends Ys{static get type(){return"SubBuild"}constructor(e,t,r=null){super(r),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(null!==this.nodeType)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const r=this.node.build(e,...t);return e.removeSubBuild(),r}}const fu=(e,t,r=null)=>Gi(new mu(Gi(e),t,r));class yu extends Ys{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let r=t.varying;if(void 0===r){const s=this.name,i=this.getNodeType(e),n=this.interpolationType,a=this.interpolationSampling;t.varying=r=e.getVaryingFromNode(this,s,i,n,a),t.node=fu(this.node,"VERTEX")}return r.needsInterpolation||(r.needsInterpolation="fragment"===e.shaderStage),r}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(Gs.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(Gs.VERTEX,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),r=e.getNodeProperties(this),s=this.setupVarying(e);if(void 0===r[t]){const i=this.getNodeType(e),n=e.getPropertyName(s,Gs.VERTEX);e.flowNodeFromShaderStage(Gs.VERTEX,r.node,i,n),r[t]=n}return e.getPropertyName(s)}}const bu=Hi(yu).setParameterLength(1,2),xu=e=>bu(e);ci("toVarying",bu),ci("toVertexStage",xu),ci("varying",(...e)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),bu(...e))),ci("vertexStage",(...e)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),bu(...e)));const Tu=Ki(([e])=>{const t=e.mul(.9478672986).add(.0521327014).pow(2.4),r=e.mul(.0773993808),s=e.lessThanEqual(.04045);return Ho(t,r,s)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),_u=Ki(([e])=>{const t=e.pow(.41666).mul(1.055).sub(.055),r=e.mul(12.92),s=e.lessThanEqual(.0031308);return Ho(t,r,s)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),vu="WorkingColorSpace";class Nu extends Js{static get type(){return"ColorSpaceNode"}constructor(e,t,r){super("vec4"),this.colorNode=e,this.source=t,this.target=r}resolveColorSpace(e,t){return t===vu?c.workingColorSpace:"OutputColorSpace"===t?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,r=this.resolveColorSpace(e,this.source),s=this.resolveColorSpace(e,this.target);let i=t;return!1!==c.enabled&&r!==s&&r&&s?(c.getTransfer(r)===h&&(i=gn(Tu(i.rgb),i.a)),c.getPrimaries(r)!==c.getPrimaries(s)&&(i=gn(xn(c._getMatrix(new n,r,s)).mul(i.rgb),i.a)),c.getTransfer(s)===h&&(i=gn(_u(i.rgb),i.a)),i):i}}const Su=(e,t)=>Gi(new Nu(Gi(e),vu,t)),Eu=(e,t)=>Gi(new Nu(Gi(e),t,vu));ci("workingToColorSpace",Su),ci("colorSpaceToWorking",Eu);let Ru=class extends Qs{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),r=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(t,r,s)}};class Au extends Ys{static get type(){return"ReferenceBaseNode"}constructor(e,t,r=null,s=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=s,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.updateType=ks.OBJECT}setGroup(e){return this.group=e,this}element(e){return Gi(new Ru(this,Gi(e)))}setNodeType(e){const t=oa(null,e);null!==this.group&&t.setGroup(this.group),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let r=e[t[0]];for(let e=1;e<t.length;e++)r=r[t[e]];return r}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}class wu extends Au{static get type(){return"RendererReferenceNode"}constructor(e,t,r=null){super(e,t,r),this.renderer=r,this.setGroup(ia)}updateReference(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}}const Cu=(e,t,r=null)=>Gi(new wu(e,t,r));class Mu extends Js{static get type(){return"ToneMappingNode"}constructor(e,t=Bu,r=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=r}customCacheKey(){return Ss(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,r=this.toneMapping;if(r===p)return t;let s=null;const i=e.renderer.library.getToneMappingFunction(r);return null!==i?s=gn(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",r),s=t),s}}const Pu=(e,t,r)=>Gi(new Mu(e,Gi(t),Gi(r))),Bu=Cu("toneMappingExposure","float");ci("toneMapping",(e,t,r)=>Pu(t,r,e));class Lu extends ni{static get type(){return"BufferAttributeNode"}constructor(e,t=null,r=0,s=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=r,this.bufferOffset=s,this.usage=g,this.instanced=!1,this.attribute=null,this.global=!0,e&&!0===e.isBufferAttribute&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(0===this.bufferStride&&0===this.bufferOffset){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(null!==this.attribute)return;const t=this.getNodeType(e),r=this.value,s=e.getTypeLength(t),i=this.bufferStride||s,n=this.bufferOffset,a=!0===r.isInterleavedBuffer?r:new m(r,i),o=new f(a,s,n);a.setUsage(this.usage),this.attribute=o,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),r=e.getBufferAttributeFromNode(this,t),s=e.getPropertyName(r);let i=null;if("vertex"===e.shaderStage||"compute"===e.shaderStage)this.name=s,i=s;else{i=bu(this).build(e,t)}return i}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&!0===this.attribute.isBufferAttribute&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const Fu=(e,t=null,r=0,s=0)=>Gi(new Lu(e,t,r,s)),Iu=(e,t=null,r=0,s=0)=>Fu(e,t,r,s).setUsage(y),Du=(e,t=null,r=0,s=0)=>Fu(e,t,r,s).setInstanced(!0),Uu=(e,t=null,r=0,s=0)=>Iu(e,t,r,s).setInstanced(!0);ci("toAttribute",e=>Fu(e.value));class Vu extends Ys{static get type(){return"ComputeNode"}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=ks.OBJECT,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){e.getNodeProperties(this).outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:r}=e;if("compute"===r){const t=this.computeNode.build(e,"void");""!==t&&e.addLineFlowCode(t,this)}else{const r=e.getNodeProperties(this).outputComputeNode;if(r)return r.build(e,t)}}}const Ou=(e,t=[64])=>{(0===t.length||t.length>3)&&console.error("THREE.TSL: compute() workgroupSize must have 1, 2, or 3 elements");for(let e=0;e<t.length;e++){const r=t[e];("number"!=typeof r||r<=0||!Number.isInteger(r))&&console.error(`THREE.TSL: compute() workgroupSize element at index [ ${e} ] must be a positive integer`)}for(;t.length<3;)t.push(1);return Gi(new Vu(Gi(e),t))},Gu=(e,t,r)=>Ou(e,r).setCount(t);ci("compute",Gu),ci("computeKernel",Ou);class ku extends Ys{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.getNodeType(e);return e.setCache(t),s}build(e,...t){const r=e.getCache(),s=e.getCacheFromNode(this,this.parent);e.setCache(s);const i=this.node.build(e,...t);return e.setCache(r),i}}const zu=(e,t)=>Gi(new ku(Gi(e),t));ci("cache",zu);class $u extends Ys{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const Hu=Hi($u).setParameterLength(2);ci("bypass",Hu);class Wu extends Ys{static get type(){return"RemapNode"}constructor(e,t,r,s=tn(0),i=tn(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=r,this.outLowNode=s,this.outHighNode=i,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:r,outLowNode:s,outHighNode:i,doClamp:n}=this;let a=e.sub(t).div(r.sub(t));return!0===n&&(a=a.clamp()),a.mul(i.sub(s)).add(s)}}const qu=Hi(Wu,null,null,{doClamp:!1}).setParameterLength(3,5),ju=Hi(Wu).setParameterLength(3,5);ci("remap",qu),ci("remapClamp",ju);class Xu extends Ys{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const r=this.getNodeType(e),s=this.snippet;if("void"!==r)return e.format(s,r,t);e.addLineFlowCode(s,this)}}const Ku=Hi(Xu).setParameterLength(1,2),Yu=e=>(e?iu(e,Ku("discard")):Ku("discard")).toStack();ci("discard",Yu);class Qu extends Js{static get type(){return"RenderOutputNode"}constructor(e,t,r){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=r,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const r=(null!==this.toneMapping?this.toneMapping:e.toneMapping)||p,s=(null!==this.outputColorSpace?this.outputColorSpace:e.outputColorSpace)||b;return r!==p&&(t=t.toneMapping(r)),s!==b&&s!==c.workingColorSpace&&(t=t.workingToColorSpace(s)),t}}const Zu=(e,t=null,r=null)=>Gi(new Qu(Gi(e),t,r));ci("renderOutput",Zu);class Ju extends Js{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,r=this.node.build(e),s="--- TSL debug - "+e.shaderStage+" shader ---",i="-".repeat(s.length);let n="";return n+="// #"+s+"#\n",n+=e.flow.code.replace(/^\t/gm,"")+"\n",n+="/* ... */ "+r+" /* ... */\n",n+="// #"+i+"#\n",null!==t?t(e,n):console.log(n),r}}const el=(e,t=null)=>Gi(new Ju(Gi(e),t)).toStack();ci("debug",el);class tl extends Ys{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(null===t){const r=this.getAttributeName(e);if(e.hasGeometryAttribute(r)){const s=e.geometry.getAttribute(r);t=e.getTypeFromAttribute(s)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),r=this.getNodeType(e);if(!0===e.hasGeometryAttribute(t)){const s=e.geometry.getAttribute(t),i=e.getTypeFromAttribute(s),n=e.getAttribute(t,i);if("vertex"===e.shaderStage)return e.format(n.name,i,r);return bu(this).build(e,r)}return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(r)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const rl=(e,t=null)=>Gi(new tl(e,t)),sl=(e=0)=>rl("uv"+(e>0?e:""),"vec2");class il extends Ys{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const r=this.textureNode.build(e,"property"),s=null===this.levelNode?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${r}, ${s} )`,this.getNodeType(e),t)}}const nl=Hi(il).setParameterLength(1,2);class al extends aa{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=ks.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,r=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(r&&void 0!==r.width){const{width:e,height:t}=r;this.value=Math.log2(Math.max(e,t))}}}const ol=Hi(al).setParameterLength(1),ul=new x;class ll extends aa{static get type(){return"TextureNode"}constructor(e=ul,t=null,r=null,s=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=r,this.biasNode=s,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=ks.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(null===t)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return!0===this.value.isDepthTexture?"float":this.value.type===T?"uvec4":this.value.type===_?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return sl(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return null===this._matrixUniform&&(this._matrixUniform=oa(this.value.matrix)),this._matrixUniform.mul(dn(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?ks.OBJECT:ks.NONE,this}setupUV(e,t){const r=this.value;return e.isFlipY()&&(r.image instanceof ImageBitmap&&!0===r.flipY||!0===r.isRenderTargetTexture||!0===r.isFramebufferTexture||!0===r.isDepthTexture)&&(t=this.sampler?t.flipY():t.setY(rn(nl(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const r=this.value;if(!r||!0!==r.isTexture)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let s=this.uvNode;null!==s&&!0!==e.context.forceUVContext||!e.context.getUV||(s=e.context.getUV(this,e)),s||(s=this.getDefaultUV()),!0===this.updateMatrix&&(s=this.getTransformedUV(s)),s=this.setupUV(e,s);let i=this.levelNode;null===i&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),t.uvNode=s,t.levelNode=i,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,r,s,i,n,a,o,u){const l=this.value;let d;return d=s?e.generateTextureLevel(l,t,r,s,n,u):i?e.generateTextureBias(l,t,r,i,n,u):o?e.generateTextureGrad(l,t,r,o,n,u):a?e.generateTextureCompare(l,t,r,a,n,u):!1===this.sampler?e.generateTextureLoad(l,t,r,n,u):e.generateTexture(l,t,r,n,u),d}generate(e,t){const r=this.value,s=e.getNodeProperties(this),i=super.generate(e,"property");if(/^sampler/.test(t))return i+"_sampler";if(e.isReference(t))return i;{const n=e.getDataFromNode(this);let a=n.propertyName;if(void 0===a){const{uvNode:t,levelNode:r,biasNode:o,compareNode:u,depthNode:l,gradNode:d,offsetNode:c}=s,h=this.generateUV(e,t),p=r?r.build(e,"float"):null,g=o?o.build(e,"float"):null,m=l?l.build(e,"int"):null,f=u?u.build(e,"float"):null,y=d?[d[0].build(e,"vec2"),d[1].build(e,"vec2")]:null,b=c?this.generateOffset(e,c):null,x=e.getVarFromNode(this);a=e.getPropertyName(x);const T=this.generateSnippet(e,i,h,p,g,m,f,y,b);e.addLineFlowCode(`${a} = ${T}`,this),n.snippet=T,n.propertyName=a}let o=a;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(o=Eu(Ku(o,u),r.colorSpace).setup(e).build(e,u)),e.format(o,u,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){const t=this.clone();t.biasNode=Gi(e).mul(ol(t)),t.referenceNode=this.getBase();const r=t.value;return!1===t.generateMipmaps&&(r&&!1===r.generateMipmaps||r.minFilter===v||r.magFilter===v)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),Gi(t)}level(e){const t=this.clone();return t.levelNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}size(e){return nl(this,e)}bias(e){const t=this.clone();return t.biasNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const t=this.clone();return t.compareNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}grad(e,t){const r=this.clone();return r.gradNode=[Gi(e),Gi(t)],r.referenceNode=this.getBase(),Gi(r)}depth(e){const t=this.clone();return t.depthNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}offset(e){const t=this.clone();return t.offsetNode=Gi(e),t.referenceNode=this.getBase(),Gi(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;null!==t&&(t.value=e.matrix),!0===e.matrixAutoUpdate&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const dl=Hi(ll).setParameterLength(1,4).setName("texture"),cl=(e=ul,t=null,r=null,s=null)=>{let i;return e&&!0===e.isTextureNode?(i=Gi(e.clone()),i.referenceNode=e.getBase(),null!==t&&(i.uvNode=Gi(t)),null!==r&&(i.levelNode=Gi(r)),null!==s&&(i.biasNode=Gi(s))):i=dl(e,t,r,s),i},hl=(...e)=>cl(...e).setSampler(!1);class pl extends aa{static get type(){return"BufferNode"}constructor(e,t,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=r}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const gl=(e,t,r)=>Gi(new pl(e,t,r));class ml extends Qs{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),r=this.getNodeType(),s=this.node.getPaddedType();return e.format(t,s,r)}}class fl extends pl{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=null===t?Fs(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=ks.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return"mat2"===e?t="mat2":!0===/mat/.test(e)?t="mat4":"i"===e.charAt(0)?t="ivec4":"u"===e.charAt(0)&&(t="uvec4"),t}update(){const{array:e,value:t}=this,r=this.elementType;if("float"===r||"int"===r||"uint"===r)for(let r=0;r<e.length;r++){t[4*r]=e[r]}else if("color"===r)for(let r=0;r<e.length;r++){const s=4*r,i=e[r];t[s]=i.r,t[s+1]=i.g,t[s+2]=i.b||0}else if("mat2"===r)for(let r=0;r<e.length;r++){const s=4*r,i=e[r];t[s]=i.elements[0],t[s+1]=i.elements[1],t[s+2]=i.elements[2],t[s+3]=i.elements[3]}else if("mat3"===r)for(let r=0;r<e.length;r++){const s=16*r,i=e[r];t[s]=i.elements[0],t[s+1]=i.elements[1],t[s+2]=i.elements[2],t[s+4]=i.elements[3],t[s+5]=i.elements[4],t[s+6]=i.elements[5],t[s+8]=i.elements[6],t[s+9]=i.elements[7],t[s+10]=i.elements[8],t[s+15]=1}else if("mat4"===r)for(let r=0;r<e.length;r++){const s=16*r,i=e[r];for(let e=0;e<i.elements.length;e++)t[s+e]=i.elements[e]}else for(let r=0;r<e.length;r++){const s=4*r,i=e[r];t[s]=i.x,t[s+1]=i.y,t[s+2]=i.z||0,t[s+3]=i.w||0}}setup(e){const t=this.array.length,r=this.elementType;let s=Float32Array;const i=this.paddedType,n=e.getTypeLength(i);return"i"===r.charAt(0)&&(s=Int32Array),"u"===r.charAt(0)&&(s=Uint32Array),this.value=new s(t*n),this.bufferCount=t,this.bufferType=i,super.setup(e)}element(e){return Gi(new ml(this,Gi(e)))}}const yl=(e,t)=>Gi(new fl(e,t));const bl=Hi(class extends Ys{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}).setParameterLength(1);let xl,Tl;class _l extends Ys{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===_l.DPR?"float":this.scope===_l.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=ks.NONE;return this.scope!==_l.SIZE&&this.scope!==_l.VIEWPORT&&this.scope!==_l.DPR||(e=ks.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===_l.VIEWPORT?null!==t?Tl.copy(t.viewport):(e.getViewport(Tl),Tl.multiplyScalar(e.getPixelRatio())):this.scope===_l.DPR?this._output.value=e.getPixelRatio():null!==t?(xl.width=t.width,xl.height=t.height):e.getDrawingBufferSize(xl)}setup(){const e=this.scope;let r=null;return r=e===_l.SIZE?oa(xl||(xl=new t)):e===_l.VIEWPORT?oa(Tl||(Tl=new s)):e===_l.DPR?oa(1):an(El.div(Sl)),this._output=r,r}generate(e){if(this.scope===_l.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const r=e.getNodeProperties(Sl).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${r}.y - ${t}.y )`}return t}return super.generate(e)}}_l.COORDINATE="coordinate",_l.VIEWPORT="viewport",_l.SIZE="size",_l.UV="uv",_l.DPR="dpr";const vl=Wi(_l,_l.DPR),Nl=Wi(_l,_l.UV),Sl=Wi(_l,_l.SIZE),El=Wi(_l,_l.COORDINATE),Rl=Wi(_l,_l.VIEWPORT),Al=Rl.zw,wl=El.sub(Rl.xy),Cl=wl.div(Al),Ml=Ki(()=>(console.warn('THREE.TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),Sl),"vec2").once()(),Pl=oa(0,"uint").setName("u_cameraIndex").setGroup(ra("cameraIndex")).toVarying("v_cameraIndex"),Bl=oa("float").setName("cameraNear").setGroup(ia).onRenderUpdate(({camera:e})=>e.near),Ll=oa("float").setName("cameraFar").setGroup(ia).onRenderUpdate(({camera:e})=>e.far),Fl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.projectionMatrix);t=yl(r).setGroup(ia).setName("cameraProjectionMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraProjectionMatrix")}else t=oa("mat4").setName("cameraProjectionMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.projectionMatrix);return t}).once()(),Il=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.projectionMatrixInverse);t=yl(r).setGroup(ia).setName("cameraProjectionMatricesInverse").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraProjectionMatrixInverse")}else t=oa("mat4").setName("cameraProjectionMatrixInverse").setGroup(ia).onRenderUpdate(({camera:e})=>e.projectionMatrixInverse);return t}).once()(),Dl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.matrixWorldInverse);t=yl(r).setGroup(ia).setName("cameraViewMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraViewMatrix")}else t=oa("mat4").setName("cameraViewMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.matrixWorldInverse);return t}).once()(),Ul=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.matrixWorld);t=yl(r).setGroup(ia).setName("cameraWorldMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraWorldMatrix")}else t=oa("mat4").setName("cameraWorldMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.matrixWorld);return t}).once()(),Vl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.normalMatrix);t=yl(r).setGroup(ia).setName("cameraNormalMatrices").element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraNormalMatrix")}else t=oa("mat3").setName("cameraNormalMatrix").setGroup(ia).onRenderUpdate(({camera:e})=>e.normalMatrix);return t}).once()(),Ol=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const s=[];for(let t=0,i=e.cameras.length;t<i;t++)s.push(new r);const i=yl(s).setGroup(ia).setName("cameraPositions").onRenderUpdate(({camera:e},t)=>{const r=e.cameras,s=t.array;for(let e=0,t=r.length;e<t;e++)s[e].setFromMatrixPosition(r[e].matrixWorld)});t=i.element(e.isMultiViewCamera?bl("gl_ViewID_OVR"):Pl).toConst("cameraPosition")}else t=oa(new r).setName("cameraPosition").setGroup(ia).onRenderUpdate(({camera:e},t)=>t.value.setFromMatrixPosition(e.matrixWorld));return t}).once()(),Gl=Ki(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const r=[];for(const t of e.cameras)r.push(t.viewport);t=yl(r,"vec4").setGroup(ia).setName("cameraViewports").element(Pl).toConst("cameraViewport")}else t=gn(0,0,Sl.x,Sl.y).toConst("cameraViewport");return t}).once()(),kl=new N;class zl extends Ys{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=ks.OBJECT,this.uniformNode=new aa(null)}getNodeType(){const e=this.scope;return e===zl.WORLD_MATRIX?"mat4":e===zl.POSITION||e===zl.VIEW_POSITION||e===zl.DIRECTION||e===zl.SCALE?"vec3":e===zl.RADIUS?"float":void 0}update(e){const t=this.object3d,s=this.uniformNode,i=this.scope;if(i===zl.WORLD_MATRIX)s.value=t.matrixWorld;else if(i===zl.POSITION)s.value=s.value||new r,s.value.setFromMatrixPosition(t.matrixWorld);else if(i===zl.SCALE)s.value=s.value||new r,s.value.setFromMatrixScale(t.matrixWorld);else if(i===zl.DIRECTION)s.value=s.value||new r,t.getWorldDirection(s.value);else if(i===zl.VIEW_POSITION){const i=e.camera;s.value=s.value||new r,s.value.setFromMatrixPosition(t.matrixWorld),s.value.applyMatrix4(i.matrixWorldInverse)}else if(i===zl.RADIUS){const r=e.object.geometry;null===r.boundingSphere&&r.computeBoundingSphere(),kl.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),s.value=kl.radius}}generate(e){const t=this.scope;return t===zl.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===zl.POSITION||t===zl.VIEW_POSITION||t===zl.DIRECTION||t===zl.SCALE?this.uniformNode.nodeType="vec3":t===zl.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}zl.WORLD_MATRIX="worldMatrix",zl.POSITION="position",zl.SCALE="scale",zl.VIEW_POSITION="viewPosition",zl.DIRECTION="direction",zl.RADIUS="radius";const $l=Hi(zl,zl.DIRECTION).setParameterLength(1),Hl=Hi(zl,zl.WORLD_MATRIX).setParameterLength(1),Wl=Hi(zl,zl.POSITION).setParameterLength(1),ql=Hi(zl,zl.SCALE).setParameterLength(1),jl=Hi(zl,zl.VIEW_POSITION).setParameterLength(1),Xl=Hi(zl,zl.RADIUS).setParameterLength(1);class Kl extends zl{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const Yl=Wi(Kl,Kl.DIRECTION),Ql=Wi(Kl,Kl.WORLD_MATRIX),Zl=Wi(Kl,Kl.POSITION),Jl=Wi(Kl,Kl.SCALE),ed=Wi(Kl,Kl.VIEW_POSITION),td=Wi(Kl,Kl.RADIUS),rd=oa(new n).onObjectUpdate(({object:e},t)=>t.value.getNormalMatrix(e.matrixWorld)),sd=oa(new a).onObjectUpdate(({object:e},t)=>t.value.copy(e.matrixWorld).invert()),id=Ki(e=>e.renderer.overrideNodes.modelViewMatrix||nd).once()().toVar("modelViewMatrix"),nd=Dl.mul(Ql),ad=Ki(e=>(e.context.isHighPrecisionModelViewMatrix=!0,oa("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),od=Ki(e=>{const t=e.context.isHighPrecisionModelViewMatrix;return oa("mat3").onObjectUpdate(({object:e,camera:r})=>(!0!==t&&e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),ud=rl("position","vec3"),ld=ud.toVarying("positionLocal"),dd=ud.toVarying("positionPrevious"),cd=Ki(e=>Ql.mul(ld).xyz.toVarying(e.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),hd=Ki(()=>ld.transformDirection(Ql).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),pd=Ki(e=>e.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),gd=pd.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class md extends Ys{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if("fragment"!==e.shaderStage)return"true";const{material:t}=e;return t.side===S?"false":e.getFrontFacing()}}const fd=Wi(md),yd=tn(fd).mul(2).sub(1),bd=Ki(([e],{material:t})=>{const r=t.side;return r===S?e=e.mul(-1):r===E&&(e=e.mul(yd)),e}),xd=rl("normal","vec3"),Td=Ki(e=>!1===e.geometry.hasAttribute("normal")?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),dn(0,1,0)):xd,"vec3").once()().toVar("normalLocal"),_d=pd.dFdx().cross(pd.dFdy()).normalize().toVar("normalFlat"),vd=Ki(e=>{let t;return t=!0===e.material.flatShading?_d:wd(Td).toVarying("v_normalViewGeometry").normalize(),t},"vec3").once()().toVar("normalViewGeometry"),Nd=Ki(e=>{let t=vd.transformDirection(Dl);return!0!==e.material.flatShading&&(t=t.toVarying("v_normalWorldGeometry")),t.normalize().toVar("normalWorldGeometry")},"vec3").once()(),Sd=Ki(({subBuildFn:e,material:t,context:r})=>{let s;return"NORMAL"===e||"VERTEX"===e?(s=vd,!0!==t.flatShading&&(s=bd(s))):s=r.setupNormal().context({getUV:null}),s},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),Ed=Sd.transformDirection(Dl).toVar("normalWorld"),Rd=Ki(({subBuildFn:e,context:t})=>{let r;return r="NORMAL"===e||"VERTEX"===e?Sd:t.setupClearcoatNormal().context({getUV:null}),r},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),Ad=Ki(([e,t=Ql])=>{const r=xn(t),s=e.div(dn(r[0].dot(r[0]),r[1].dot(r[1]),r[2].dot(r[2])));return r.mul(s).xyz}),wd=Ki(([e],t)=>{const r=t.renderer.overrideNodes.modelNormalViewMatrix;if(null!==r)return r.transformDirection(e);const s=rd.mul(e);return Dl.transformDirection(s)}),Cd=Ki(()=>(console.warn('THREE.TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),Sd)).once(["NORMAL","VERTEX"])(),Md=Ki(()=>(console.warn('THREE.TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),Ed)).once(["NORMAL","VERTEX"])(),Pd=Ki(()=>(console.warn('THREE.TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),Rd)).once(["NORMAL","VERTEX"])(),Bd=new R,Ld=new a,Fd=oa(0).onReference(({material:e})=>e).onObjectUpdate(({material:e})=>e.refractionRatio),Id=oa(1).onReference(({material:e})=>e).onObjectUpdate(function({material:e,scene:t}){return e.envMap?e.envMapIntensity:t.environmentIntensity}),Dd=oa(new a).onReference(function(e){return e.material}).onObjectUpdate(function({material:e,scene:t}){const r=null!==t.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation;return r?(Bd.copy(r),Ld.makeRotationFromEuler(Bd)):Ld.identity(),Ld}),Ud=gd.negate().reflect(Sd),Vd=gd.negate().refract(Sd,Fd),Od=Ud.transformDirection(Dl).toVar("reflectVector"),Gd=Vd.transformDirection(Dl).toVar("reflectVector"),kd=new A;class zd extends ll{static get type(){return"CubeTextureNode"}constructor(e,t=null,r=null,s=null){super(e,t,r,s),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===w?Od:e.mapping===C?Gd:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),dn(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const r=this.value;return e.renderer.coordinateSystem!==d&&r.isRenderTargetTexture||(t=dn(t.x.negate(),t.yz)),Dd.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const $d=Hi(zd).setParameterLength(1,4).setName("cubeTexture"),Hd=(e=kd,t=null,r=null,s=null)=>{let i;return e&&!0===e.isCubeTextureNode?(i=Gi(e.clone()),i.referenceNode=e,null!==t&&(i.uvNode=Gi(t)),null!==r&&(i.levelNode=Gi(r)),null!==s&&(i.biasNode=Gi(s))):i=$d(e,t,r,s),i};class Wd extends Qs{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),r=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(t,r,s)}}class qd extends Ys{static get type(){return"ReferenceNode"}constructor(e,t,r=null,s=null){super(),this.property=e,this.uniformType=t,this.object=r,this.count=s,this.properties=e.split("."),this.reference=r,this.node=null,this.group=null,this.name=null,this.updateType=ks.OBJECT}element(e){return Gi(new Wd(this,Gi(e)))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let t=null;t=null!==this.count?gl(null,e,this.count):Array.isArray(this.getValueFromReference())?yl(null,e):"texture"===e?cl(null):"cubeTexture"===e?Hd(null):oa(null,e),null!==this.group&&t.setGroup(this.group),null!==this.name&&t.setName(this.name),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let r=e[t[0]];for(let e=1;e<t.length;e++)r=r[t[e]];return r}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const jd=(e,t,r)=>Gi(new qd(e,t,r)),Xd=(e,t,r,s)=>Gi(new qd(e,t,s,r));class Kd extends qd{static get type(){return"MaterialReferenceNode"}constructor(e,t,r=null){super(e,t,r),this.material=r,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=null!==this.material?this.material:e.material,this.reference}}const Yd=(e,t,r=null)=>Gi(new Kd(e,t,r)),Qd=sl(),Zd=pd.dFdx(),Jd=pd.dFdy(),ec=Qd.dFdx(),tc=Qd.dFdy(),rc=Sd,sc=Jd.cross(rc),ic=rc.cross(Zd),nc=sc.mul(ec.x).add(ic.mul(tc.x)),ac=sc.mul(ec.y).add(ic.mul(tc.y)),oc=nc.dot(nc).max(ac.dot(ac)),uc=oc.equal(0).select(0,oc.inverseSqrt()),lc=nc.mul(uc).toVar("tangentViewFrame"),dc=ac.mul(uc).toVar("bitangentViewFrame"),cc=Ki(e=>(!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents(),rl("tangent","vec4")))(),hc=cc.xyz.toVar("tangentLocal"),pc=Ki(({subBuildFn:e,geometry:t,material:r})=>{let s;return s="VERTEX"===e||t.hasAttribute("tangent")?id.mul(gn(hc,0)).xyz.toVarying("v_tangentView").normalize():lc,!0!==r.flatShading&&(s=bd(s)),s},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),gc=pc.transformDirection(Dl).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),mc=Ki(([e,t],{subBuildFn:r,material:s})=>{let i=e.mul(cc.w).xyz;return"NORMAL"===r&&!0!==s.flatShading&&(i=i.toVarying(t)),i}).once(["NORMAL"]),fc=mc(xd.cross(cc),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),yc=mc(Td.cross(hc),"v_bitangentLocal").normalize().toVar("bitangentLocal"),bc=Ki(({subBuildFn:e,geometry:t,material:r})=>{let s;return s="VERTEX"===e||t.hasAttribute("tangent")?mc(Sd.cross(pc),"v_bitangentView").normalize():dc,!0!==r.flatShading&&(s=bd(s)),s},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),xc=mc(Ed.cross(gc),"v_bitangentWorld").normalize().toVar("bitangentWorld"),Tc=xn(pc,bc,Sd).toVar("TBNViewMatrix"),_c=gd.mul(Tc),vc=Ki(()=>{let e=Gn.cross(gd);return e=e.cross(Gn).normalize(),e=Ho(e,Sd,Vn.mul(wn.oneMinus()).oneMinus().pow2().pow2()).normalize(),e}).once()();class Nc extends Js{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=M}setup({material:e}){const{normalMapType:t,scaleNode:r}=this;let s=this.node.mul(2).sub(1);if(null!==r){let t=r;!0===e.flatShading&&(t=bd(t)),s=dn(s.xy.mul(t),s.z)}let i=null;return t===P?i=wd(s):t===M?i=Tc.mul(s).normalize():(console.error(`THREE.NodeMaterial: Unsupported normal map type: ${t}`),i=Sd),i}}const Sc=Hi(Nc).setParameterLength(1,2),Ec=Ki(({textureNode:e,bumpScale:t})=>{const r=t=>e.cache().context({getUV:e=>t(e.uvNode||sl()),forceUVContext:!0}),s=tn(r(e=>e));return an(tn(r(e=>e.add(e.dFdx()))).sub(s),tn(r(e=>e.add(e.dFdy()))).sub(s)).mul(t)}),Rc=Ki(e=>{const{surf_pos:t,surf_norm:r,dHdxy:s}=e,i=t.dFdx().normalize(),n=r,a=t.dFdy().normalize().cross(n),o=n.cross(i),u=i.dot(a).mul(yd),l=u.sign().mul(s.x.mul(a).add(s.y.mul(o)));return u.abs().mul(r).sub(l).normalize()});class Ac extends Js{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=null!==this.scaleNode?this.scaleNode:1,t=Ec({textureNode:this.textureNode,bumpScale:e});return Rc({surf_pos:pd,surf_norm:Sd,dHdxy:t})}}const wc=Hi(Ac).setParameterLength(1,2),Cc=new Map;class Mc extends Ys{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let r=Cc.get(e);return void 0===r&&(r=Yd(e,t),Cc.set(e,r)),r}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache("map"===e?"map":e+"Map","texture")}setup(e){const t=e.context.material,r=this.scope;let s=null;if(r===Mc.COLOR){const e=void 0!==t.color?this.getColor(r):dn();s=t.map&&!0===t.map.isTexture?e.mul(this.getTexture("map")):e}else if(r===Mc.OPACITY){const e=this.getFloat(r);s=t.alphaMap&&!0===t.alphaMap.isTexture?e.mul(this.getTexture("alpha")):e}else if(r===Mc.SPECULAR_STRENGTH)s=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture("specular").r:tn(1);else if(r===Mc.SPECULAR_INTENSITY){const e=this.getFloat(r);s=t.specularIntensityMap&&!0===t.specularIntensityMap.isTexture?e.mul(this.getTexture(r).a):e}else if(r===Mc.SPECULAR_COLOR){const e=this.getColor(r);s=t.specularColorMap&&!0===t.specularColorMap.isTexture?e.mul(this.getTexture(r).rgb):e}else if(r===Mc.ROUGHNESS){const e=this.getFloat(r);s=t.roughnessMap&&!0===t.roughnessMap.isTexture?e.mul(this.getTexture(r).g):e}else if(r===Mc.METALNESS){const e=this.getFloat(r);s=t.metalnessMap&&!0===t.metalnessMap.isTexture?e.mul(this.getTexture(r).b):e}else if(r===Mc.EMISSIVE){const e=this.getFloat("emissiveIntensity"),i=this.getColor(r).mul(e);s=t.emissiveMap&&!0===t.emissiveMap.isTexture?i.mul(this.getTexture(r)):i}else if(r===Mc.NORMAL)t.normalMap?(s=Sc(this.getTexture("normal"),this.getCache("normalScale","vec2")),s.normalMapType=t.normalMapType):s=t.bumpMap?wc(this.getTexture("bump").r,this.getFloat("bumpScale")):Sd;else if(r===Mc.CLEARCOAT){const e=this.getFloat(r);s=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?e.mul(this.getTexture(r).r):e}else if(r===Mc.CLEARCOAT_ROUGHNESS){const e=this.getFloat(r);s=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?e.mul(this.getTexture(r).r):e}else if(r===Mc.CLEARCOAT_NORMAL)s=t.clearcoatNormalMap?Sc(this.getTexture(r),this.getCache(r+"Scale","vec2")):Sd;else if(r===Mc.SHEEN){const e=this.getColor("sheenColor").mul(this.getFloat("sheen"));s=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?e.mul(this.getTexture("sheenColor").rgb):e}else if(r===Mc.SHEEN_ROUGHNESS){const e=this.getFloat(r);s=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?e.mul(this.getTexture(r).a):e,s=s.clamp(.07,1)}else if(r===Mc.ANISOTROPY)if(t.anisotropyMap&&!0===t.anisotropyMap.isTexture){const e=this.getTexture(r);s=bn(gh.x,gh.y,gh.y.negate(),gh.x).mul(e.rg.mul(2).sub(an(1)).normalize().mul(e.b))}else s=gh;else if(r===Mc.IRIDESCENCE_THICKNESS){const e=jd("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const i=jd("0","float",t.iridescenceThicknessRange);s=e.sub(i).mul(this.getTexture(r).g).add(i)}else s=e}else if(r===Mc.TRANSMISSION){const e=this.getFloat(r);s=t.transmissionMap?e.mul(this.getTexture(r).r):e}else if(r===Mc.THICKNESS){const e=this.getFloat(r);s=t.thicknessMap?e.mul(this.getTexture(r).g):e}else if(r===Mc.IOR)s=this.getFloat(r);else if(r===Mc.LIGHT_MAP)s=this.getTexture(r).rgb.mul(this.getFloat("lightMapIntensity"));else if(r===Mc.AO)s=this.getTexture(r).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(r===Mc.LINE_DASH_OFFSET)s=t.dashOffset?this.getFloat(r):tn(0);else{const t=this.getNodeType(e);s=this.getCache(r,t)}return s}}Mc.ALPHA_TEST="alphaTest",Mc.COLOR="color",Mc.OPACITY="opacity",Mc.SHININESS="shininess",Mc.SPECULAR="specular",Mc.SPECULAR_STRENGTH="specularStrength",Mc.SPECULAR_INTENSITY="specularIntensity",Mc.SPECULAR_COLOR="specularColor",Mc.REFLECTIVITY="reflectivity",Mc.ROUGHNESS="roughness",Mc.METALNESS="metalness",Mc.NORMAL="normal",Mc.CLEARCOAT="clearcoat",Mc.CLEARCOAT_ROUGHNESS="clearcoatRoughness",Mc.CLEARCOAT_NORMAL="clearcoatNormal",Mc.EMISSIVE="emissive",Mc.ROTATION="rotation",Mc.SHEEN="sheen",Mc.SHEEN_ROUGHNESS="sheenRoughness",Mc.ANISOTROPY="anisotropy",Mc.IRIDESCENCE="iridescence",Mc.IRIDESCENCE_IOR="iridescenceIOR",Mc.IRIDESCENCE_THICKNESS="iridescenceThickness",Mc.IOR="ior",Mc.TRANSMISSION="transmission",Mc.THICKNESS="thickness",Mc.ATTENUATION_DISTANCE="attenuationDistance",Mc.ATTENUATION_COLOR="attenuationColor",Mc.LINE_SCALE="scale",Mc.LINE_DASH_SIZE="dashSize",Mc.LINE_GAP_SIZE="gapSize",Mc.LINE_WIDTH="linewidth",Mc.LINE_DASH_OFFSET="dashOffset",Mc.POINT_SIZE="size",Mc.DISPERSION="dispersion",Mc.LIGHT_MAP="light",Mc.AO="ao";const Pc=Wi(Mc,Mc.ALPHA_TEST),Bc=Wi(Mc,Mc.COLOR),Lc=Wi(Mc,Mc.SHININESS),Fc=Wi(Mc,Mc.EMISSIVE),Ic=Wi(Mc,Mc.OPACITY),Dc=Wi(Mc,Mc.SPECULAR),Uc=Wi(Mc,Mc.SPECULAR_INTENSITY),Vc=Wi(Mc,Mc.SPECULAR_COLOR),Oc=Wi(Mc,Mc.SPECULAR_STRENGTH),Gc=Wi(Mc,Mc.REFLECTIVITY),kc=Wi(Mc,Mc.ROUGHNESS),zc=Wi(Mc,Mc.METALNESS),$c=Wi(Mc,Mc.NORMAL),Hc=Wi(Mc,Mc.CLEARCOAT),Wc=Wi(Mc,Mc.CLEARCOAT_ROUGHNESS),qc=Wi(Mc,Mc.CLEARCOAT_NORMAL),jc=Wi(Mc,Mc.ROTATION),Xc=Wi(Mc,Mc.SHEEN),Kc=Wi(Mc,Mc.SHEEN_ROUGHNESS),Yc=Wi(Mc,Mc.ANISOTROPY),Qc=Wi(Mc,Mc.IRIDESCENCE),Zc=Wi(Mc,Mc.IRIDESCENCE_IOR),Jc=Wi(Mc,Mc.IRIDESCENCE_THICKNESS),eh=Wi(Mc,Mc.TRANSMISSION),th=Wi(Mc,Mc.THICKNESS),rh=Wi(Mc,Mc.IOR),sh=Wi(Mc,Mc.ATTENUATION_DISTANCE),ih=Wi(Mc,Mc.ATTENUATION_COLOR),nh=Wi(Mc,Mc.LINE_SCALE),ah=Wi(Mc,Mc.LINE_DASH_SIZE),oh=Wi(Mc,Mc.LINE_GAP_SIZE),uh=Wi(Mc,Mc.LINE_WIDTH),lh=Wi(Mc,Mc.LINE_DASH_OFFSET),dh=Wi(Mc,Mc.POINT_SIZE),ch=Wi(Mc,Mc.DISPERSION),hh=Wi(Mc,Mc.LIGHT_MAP),ph=Wi(Mc,Mc.AO),gh=oa(new t).onReference(function(e){return e.material}).onRenderUpdate(function({material:e}){this.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation))}),mh=Ki(e=>e.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class fh extends Ys{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),r=this.scope;let s,i;if(r===fh.VERTEX)s=e.getVertexIndex();else if(r===fh.INSTANCE)s=e.getInstanceIndex();else if(r===fh.DRAW)s=e.getDrawIndex();else if(r===fh.INVOCATION_LOCAL)s=e.getInvocationLocalIndex();else if(r===fh.INVOCATION_SUBGROUP)s=e.getInvocationSubgroupIndex();else{if(r!==fh.SUBGROUP)throw new Error("THREE.IndexNode: Unknown scope: "+r);s=e.getSubgroupIndex()}if("vertex"===e.shaderStage||"compute"===e.shaderStage)i=s;else{i=bu(this).build(e,t)}return i}}fh.VERTEX="vertex",fh.INSTANCE="instance",fh.SUBGROUP="subgroup",fh.INVOCATION_LOCAL="invocationLocal",fh.INVOCATION_SUBGROUP="invocationSubgroup",fh.DRAW="draw";const yh=Wi(fh,fh.VERTEX),bh=Wi(fh,fh.INSTANCE),xh=Wi(fh,fh.SUBGROUP),Th=Wi(fh,fh.INVOCATION_SUBGROUP),_h=Wi(fh,fh.INVOCATION_LOCAL),vh=Wi(fh,fh.DRAW);class Nh extends Ys{static get type(){return"InstanceNode"}constructor(e,t,r=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=r,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=ks.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{instanceMatrix:t,instanceColor:r}=this,{count:s}=t;let{instanceMatrixNode:i,instanceColorNode:n}=this;if(null===i){if(s<=1e3)i=gl(t.array,"mat4",Math.max(s,1)).element(bh);else{const e=new B(t.array,16,1);this.buffer=e;const r=t.usage===y?Uu:Du,s=[r(e,"vec4",16,0),r(e,"vec4",16,4),r(e,"vec4",16,8),r(e,"vec4",16,12)];i=Tn(...s)}this.instanceMatrixNode=i}if(r&&null===n){const e=new L(r.array,3),t=r.usage===y?Uu:Du;this.bufferColor=e,n=dn(t(e,"vec3",3,0)),this.instanceColorNode=n}const a=i.mul(ld).xyz;if(ld.assign(a),e.hasGeometryAttribute("normal")){const e=Ad(Td,i);Td.assign(e)}null!==this.instanceColorNode&&En("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==y&&null!==this.buffer&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==y&&null!==this.bufferColor&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}const Sh=Hi(Nh).setParameterLength(2,3);class Eh extends Nh{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:r,instanceColor:s}=e;super(t,r,s),this.instancedMesh=e}}const Rh=Hi(Eh).setParameterLength(1);class Ah extends Ys{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){null===this.batchingIdNode&&(null===e.getDrawIndex()?this.batchingIdNode=bh:this.batchingIdNode=vh);const t=Ki(([e])=>{const t=rn(nl(hl(this.batchMesh._indirectTexture),0).x),r=rn(e).mod(t),s=rn(e).div(t);return hl(this.batchMesh._indirectTexture,on(r,s)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]}),r=t(rn(this.batchingIdNode)),s=this.batchMesh._matricesTexture,i=rn(nl(hl(s),0).x),n=tn(r).mul(4).toInt().toVar(),a=n.mod(i),o=n.div(i),u=Tn(hl(s,on(a,o)),hl(s,on(a.add(1),o)),hl(s,on(a.add(2),o)),hl(s,on(a.add(3),o))),l=this.batchMesh._colorsTexture;if(null!==l){const e=Ki(([e])=>{const t=rn(nl(hl(l),0).x),r=e,s=r.mod(t),i=r.div(t);return hl(l,on(s,i)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]}),t=e(r);En("vec3","vBatchColor").assign(t)}const d=xn(u);ld.assign(u.mul(ld));const c=Td.div(dn(d[0].dot(d[0]),d[1].dot(d[1]),d[2].dot(d[2]))),h=d.mul(c).xyz;Td.assign(h),e.hasGeometryAttribute("tangent")&&hc.mulAssign(d)}}const wh=Hi(Ah).setParameterLength(1);class Ch extends Qs{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const r=this.storageBufferNode.structTypeNode;return r?r.getMemberType(e,t):"void"}setup(e){return!1===e.isAvailable("storageBuffer")&&!0===this.node.isPBO&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let r;const s=e.context.assign;if(r=!1===e.isAvailable("storageBuffer")?!0!==this.node.isPBO||!0===s||!this.node.value.isInstancedBufferAttribute&&"compute"===e.shaderStage?this.node.build(e):e.generatePBO(this):super.generate(e),!0!==s){const s=this.getNodeType(e);r=e.format(r,s,t)}return r}}const Mh=Hi(Ch).setParameterLength(2);class Ph extends pl{static get type(){return"StorageBufferNode"}constructor(e,t=null,r=0){let s,i=null;t&&t.isStruct?(s="struct",i=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(r=e.count)):null===t&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(s=Cs(e.itemSize),r=e.count):s=t,super(e,s,r),this.isStorageBufferNode=!0,this.structTypeNode=i,this.access=$s.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,!0!==e.isStorageBufferAttribute&&!0!==e.isStorageInstancedBufferAttribute&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(0===this.bufferCount){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return Mh(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess($s.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return null===this._attribute&&(this._attribute=Fu(this.value),this._varying=bu(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(null!==this.structTypeNode)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return null!==this.structTypeNode?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(null!==this.structTypeNode&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:r}=this.getAttributeData(),s=r.build(e);return e.registerTransform(s,t),s}}const Bh=(e,t=null,r=0)=>Gi(new Ph(e,t,r)),Lh=new WeakMap;class Fh extends Ys{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=ks.OBJECT,this.skinIndexNode=rl("skinIndex","uvec4"),this.skinWeightNode=rl("skinWeight","vec4"),this.bindMatrixNode=jd("bindMatrix","mat4"),this.bindMatrixInverseNode=jd("bindMatrixInverse","mat4"),this.boneMatricesNode=Xd("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=ld,this.toPositionNode=ld,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:r,skinWeightNode:s,bindMatrixNode:i,bindMatrixInverseNode:n}=this,a=e.element(r.x),o=e.element(r.y),u=e.element(r.z),l=e.element(r.w),d=i.mul(t),c=fa(a.mul(s.x).mul(d),o.mul(s.y).mul(d),u.mul(s.z).mul(d),l.mul(s.w).mul(d));return n.mul(c).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=Td){const{skinIndexNode:r,skinWeightNode:s,bindMatrixNode:i,bindMatrixInverseNode:n}=this,a=e.element(r.x),o=e.element(r.y),u=e.element(r.z),l=e.element(r.w);let d=fa(s.x.mul(a),s.y.mul(o),s.z.mul(u),s.w.mul(l));return d=n.mul(d).mul(i),d.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return null===this.previousBoneMatricesNode&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=Xd("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,dd)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||!0===Ds(e.object).useVelocity}setup(e){this.needsPreviousBoneMatrices(e)&&dd.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const t=this.getSkinnedNormal();Td.assign(t),e.hasGeometryAttribute("tangent")&&hc.assign(t)}return t}generate(e,t){if("void"!==t)return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;Lh.get(t)!==e.frameId&&(Lh.set(t,e.frameId),null!==this.previousBoneMatricesNode&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}const Ih=e=>Gi(new Fh(e));class Dh extends Ys{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode("i".charCodeAt(0)+e)}getProperties(e){const t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;const r={};for(let e=0,t=this.params.length-1;e<t;e++){const t=this.params[e],s=!0!==t.isNode&&t.name||this.getVarName(e),i=!0!==t.isNode&&t.type||"int";r[s]=Ku(s,i)}const s=e.addStack();t.returnsNode=this.params[this.params.length-1](r,e),t.stackNode=s;const i=this.params[0];return!0!==i.isNode&&"function"==typeof i.update&&(t.updateNode=Ki(this.params[0].update)(r)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),r=this.params,s=t.stackNode;for(let s=0,i=r.length-1;s<i;s++){const i=r[s];let n,a=!1,o=null,u=null,l=null,d=null,c=null,h=null;if(i.isNode?"bool"===i.getNodeType(e)?(a=!0,d="bool",u=i.build(e,d)):(d="int",l=this.getVarName(s),o="0",u=i.build(e,d),c="<"):(d=i.type||"int",l=i.name||this.getVarName(s),o=i.start,u=i.end,c=i.condition,h=i.update,"number"==typeof o?o=e.generateConst(d,o):o&&o.isNode&&(o=o.build(e,d)),"number"==typeof u?u=e.generateConst(d,u):u&&u.isNode&&(u=u.build(e,d)),void 0!==o&&void 0===u?(o+=" - 1",u="0",c=">="):void 0!==u&&void 0===o&&(o="0",c="<"),void 0===c&&(c=Number(o)>Number(u)?">=":"<")),a)n=`while ( ${u} )`;else{const r={start:o,end:u},s=r.start,i=r.end;let a;const p=()=>c.includes("<")?"+=":"-=";if(null!=h)switch(typeof h){case"function":a=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":a=l+" "+p()+" "+e.generateConst(d,h);break;case"string":a=l+" "+h;break;default:h.isNode?a=l+" "+p()+" "+h.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),a="break /* invalid update */")}else h="int"===d||"uint"===d?c.includes("<")?"++":"--":p()+" 1.",a=l+" "+h;n=`for ( ${e.getVar(d,l)+" = "+s}; ${l+" "+c+" "+i}; ${a} )`}e.addFlowCode((0===s?"\n":"")+e.tab+n+" {\n\n").addFlowTab()}const i=s.build(e,"void"),n=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+i);for(let t=0,r=this.params.length-1;t<r;t++)e.addFlowCode((0===t?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),n}}const Uh=(...e)=>Gi(new Dh($i(e,"int"))).toStack(),Vh=()=>Ku("break").toStack(),Oh=new WeakMap,Gh=new s,kh=Ki(({bufferMap:e,influence:t,stride:r,width:s,depth:i,offset:n})=>{const a=rn(yh).mul(r).add(n),o=a.div(s),u=a.sub(o.mul(s));return hl(e,on(u,o)).depth(i).xyz.mul(t)});class zh extends Ys{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=oa(1),this.updateType=ks.OBJECT}setup(e){const{geometry:r}=e,s=void 0!==r.morphAttributes.position,i=r.hasAttribute("normal")&&void 0!==r.morphAttributes.normal,n=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,a=void 0!==n?n.length:0,{texture:o,stride:u,size:l}=function(e){const r=void 0!==e.morphAttributes.position,s=void 0!==e.morphAttributes.normal,i=void 0!==e.morphAttributes.color,n=e.morphAttributes.position||e.morphAttributes.normal||e.morphAttributes.color,a=void 0!==n?n.length:0;let o=Oh.get(e);if(void 0===o||o.count!==a){void 0!==o&&o.texture.dispose();const u=e.morphAttributes.position||[],l=e.morphAttributes.normal||[],d=e.morphAttributes.color||[];let c=0;!0===r&&(c=1),!0===s&&(c=2),!0===i&&(c=3);let h=e.attributes.position.count*c,p=1;const g=4096;h>g&&(p=Math.ceil(h/g),h=g);const m=new Float32Array(h*p*4*a),f=new F(m,h,p,a);f.type=I,f.needsUpdate=!0;const y=4*c;for(let x=0;x<a;x++){const T=u[x],_=l[x],v=d[x],N=h*p*4*x;for(let S=0;S<T.count;S++){const E=S*y;!0===r&&(Gh.fromBufferAttribute(T,S),m[N+E+0]=Gh.x,m[N+E+1]=Gh.y,m[N+E+2]=Gh.z,m[N+E+3]=0),!0===s&&(Gh.fromBufferAttribute(_,S),m[N+E+4]=Gh.x,m[N+E+5]=Gh.y,m[N+E+6]=Gh.z,m[N+E+7]=0),!0===i&&(Gh.fromBufferAttribute(v,S),m[N+E+8]=Gh.x,m[N+E+9]=Gh.y,m[N+E+10]=Gh.z,m[N+E+11]=4===v.itemSize?Gh.w:1)}}function b(){f.dispose(),Oh.delete(e),e.removeEventListener("dispose",b)}o={count:a,texture:f,stride:c,size:new t(h,p)},Oh.set(e,o),e.addEventListener("dispose",b)}return o}(r);!0===s&&ld.mulAssign(this.morphBaseInfluence),!0===i&&Td.mulAssign(this.morphBaseInfluence);const d=rn(l.width);Uh(a,({i:e})=>{const t=tn(0).toVar();this.mesh.count>1&&null!==this.mesh.morphTexture&&void 0!==this.mesh.morphTexture?t.assign(hl(this.mesh.morphTexture,on(rn(e).add(1),rn(bh))).r):t.assign(jd("morphTargetInfluences","float").element(e).toVar()),Zi(t.notEqual(0),()=>{!0===s&&ld.addAssign(kh({bufferMap:o,influence:t,stride:u,width:d,depth:e,offset:rn(0)})),!0===i&&Td.addAssign(kh({bufferMap:o,influence:t,stride:u,width:d,depth:e,offset:rn(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((e,t)=>e+t,0)}}const $h=Hi(zh).setParameterLength(1);class Hh extends Ys{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class Wh extends Hh{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class qh extends nu{static get type(){return"LightingContextNode"}constructor(e,t=null,r=null,s=null){super(e),this.lightingModel=t,this.backdropNode=r,this.backdropAlphaNode=s,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,r={directDiffuse:dn().toVar("directDiffuse"),directSpecular:dn().toVar("directSpecular"),indirectDiffuse:dn().toVar("indirectDiffuse"),indirectSpecular:dn().toVar("indirectSpecular")};return{radiance:dn().toVar("radiance"),irradiance:dn().toVar("irradiance"),iblIrradiance:dn().toVar("iblIrradiance"),ambientOcclusion:tn(1).toVar("ambientOcclusion"),reflectedLight:r,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const jh=Hi(qh);class Xh extends Hh{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}const Kh=new t;class Yh extends ll{static get type(){return"ViewportTextureNode"}constructor(e=Nl,t=null,r=null){let s=null;null===r?(s=new D,s.minFilter=U,r=s):s=r,super(r,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=s,this.isOutputTextureNode=!0,this.updateBeforeType=ks.FRAME,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let t,r;if(this.referenceNode?(t=this.referenceNode.defaultFramebuffer,r=this.referenceNode._cacheTextures):(t=this.defaultFramebuffer,r=this._cacheTextures),null===e)return t;if(!1===r.has(e)){const s=t.clone();r.set(e,s)}return r.get(e)}updateReference(e){const t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){const t=e.renderer,r=t.getRenderTarget();null===r?t.getDrawingBufferSize(Kh):Kh.set(r.width,r.height);const s=this.getTextureForReference(r);s.image.width===Kh.width&&s.image.height===Kh.height||(s.image.width=Kh.width,s.image.height=Kh.height,s.needsUpdate=!0);const i=s.generateMipmaps;s.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(s),s.generateMipmaps=i}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const Qh=Hi(Yh).setParameterLength(0,3),Zh=Hi(Yh,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let Jh=null;class ep extends Yh{static get type(){return"ViewportDepthTextureNode"}constructor(e=Nl,t=null){null===Jh&&(Jh=new V),super(e,t,Jh)}getTextureForReference(){return Jh}}const tp=Hi(ep).setParameterLength(0,2);class rp extends Ys{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===rp.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,r=this.valueNode;let s=null;if(t===rp.DEPTH_BASE)null!==r&&(s=op().assign(r));else if(t===rp.DEPTH)s=e.isPerspectiveCamera?ip(pd.z,Bl,Ll):sp(pd.z,Bl,Ll);else if(t===rp.LINEAR_DEPTH)if(null!==r)if(e.isPerspectiveCamera){const e=np(r,Bl,Ll);s=sp(e,Bl,Ll)}else s=r;else s=sp(pd.z,Bl,Ll);return s}}rp.DEPTH_BASE="depthBase",rp.DEPTH="depth",rp.LINEAR_DEPTH="linearDepth";const sp=(e,t,r)=>e.add(t).div(t.sub(r)),ip=(e,t,r)=>t.add(e).mul(r).div(r.sub(t).mul(e)),np=(e,t,r)=>t.mul(r).div(r.sub(t).mul(e).sub(r)),ap=(e,t,r)=>{t=t.max(1e-6).toVar();const s=eo(e.negate().div(t)),i=eo(r.div(t));return s.div(i)},op=Hi(rp,rp.DEPTH_BASE),up=Wi(rp,rp.DEPTH),lp=Hi(rp,rp.LINEAR_DEPTH).setParameterLength(0,1),dp=lp(tp());up.assign=e=>op(e);class cp extends Ys{static get type(){return"ClippingNode"}constructor(e=cp.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:r,unionPlanes:s}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===cp.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(r,s):this.scope===cp.HARDWARE?this.setupHardwareClipping(s,e):this.setupDefault(r,s)}setupAlphaToCoverage(e,t){return Ki(()=>{const r=tn().toVar("distanceToPlane"),s=tn().toVar("distanceToGradient"),i=tn(1).toVar("clipOpacity"),n=t.length;if(!1===this.hardwareClipping&&n>0){const e=yl(t).setGroup(ia);Uh(n,({i:t})=>{const n=e.element(t);r.assign(pd.dot(n.xyz).negate().add(n.w)),s.assign(r.fwidth().div(2)),i.mulAssign(Xo(s.negate(),s,r))})}const a=e.length;if(a>0){const t=yl(e).setGroup(ia),n=tn(1).toVar("intersectionClipOpacity");Uh(a,({i:e})=>{const i=t.element(e);r.assign(pd.dot(i.xyz).negate().add(i.w)),s.assign(r.fwidth().div(2)),n.mulAssign(Xo(s.negate(),s,r).oneMinus())}),i.mulAssign(n.oneMinus())}Rn.a.mulAssign(i),Rn.a.equal(0).discard()})()}setupDefault(e,t){return Ki(()=>{const r=t.length;if(!1===this.hardwareClipping&&r>0){const e=yl(t).setGroup(ia);Uh(r,({i:t})=>{const r=e.element(t);pd.dot(r.xyz).greaterThan(r.w).discard()})}const s=e.length;if(s>0){const t=yl(e).setGroup(ia),r=nn(!0).toVar("clipped");Uh(s,({i:e})=>{const s=t.element(e);r.assign(pd.dot(s.xyz).greaterThan(s.w).and(r))}),r.discard()}})()}setupHardwareClipping(e,t){const r=e.length;return t.enableHardwareClipping(r),Ki(()=>{const s=yl(e).setGroup(ia),i=bl(t.getClipDistance());Uh(r,({i:e})=>{const t=s.element(e),r=pd.dot(t.xyz).sub(t.w).negate();i.element(e).assign(r)})})()}}cp.ALPHA_TO_COVERAGE="alphaToCoverage",cp.DEFAULT="default",cp.HARDWARE="hardware";const hp=Ki(([e])=>ao(ba(1e4,oo(ba(17,e.x).add(ba(.1,e.y)))).mul(fa(.1,go(oo(ba(13,e.y).add(e.x))))))),pp=Ki(([e])=>hp(an(hp(e.xy),e.z))),gp=Ki(([e])=>{const t=Mo(fo(xo(e.xyz)),fo(To(e.xyz))),r=tn(1).div(tn(.05).mul(t)).toVar("pixScale"),s=an(Za(so(eo(r))),Za(io(eo(r)))),i=an(pp(so(s.x.mul(e.xyz))),pp(so(s.y.mul(e.xyz)))),n=ao(eo(r)),a=fa(ba(n.oneMinus(),i.x),ba(n,i.y)),o=Co(n,n.oneMinus()),u=dn(a.mul(a).div(ba(2,o).mul(ya(1,o))),a.sub(ba(.5,o)).div(ya(1,o)),ya(1,ya(1,a).mul(ya(1,a)).div(ba(2,o).mul(ya(1,o))))),l=a.lessThan(o.oneMinus()).select(a.lessThan(o).select(u.x,u.y),u.z);return Wo(l,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class mp extends tl{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e);let r;return r=!0===e.hasGeometryAttribute(t)?super.generate(e):e.generateConst(this.nodeType,new s(1,1,1,1)),r}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const fp=(e=0)=>Gi(new mp(e)),yp=Ki(([e,t])=>Co(1,e.oneMinus().div(t)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),bp=Ki(([e,t])=>Co(e.div(t.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),xp=Ki(([e,t])=>e.oneMinus().mul(t.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),Tp=Ki(([e,t])=>Ho(e.mul(2).mul(t),e.oneMinus().mul(2).mul(t.oneMinus()).oneMinus(),Po(.5,e))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),_p=Ki(([e,t])=>{const r=t.a.add(e.a.mul(t.a.oneMinus()));return gn(t.rgb.mul(t.a).add(e.rgb.mul(e.a).mul(t.a.oneMinus())).div(r),r)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),vp=Ki(([e])=>gn(e.rgb.mul(e.a),e.a),{color:"vec4",return:"vec4"}),Np=Ki(([e])=>(Zi(e.a.equal(0),()=>gn(0)),gn(e.rgb.div(e.a),e.a)),{color:"vec4",return:"vec4"});class Sp extends O{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+Es(this)}build(e){this.setup(e)}setupObserver(e){return new Ts(e)}setup(e){e.context.setupNormal=()=>fu(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,r=t.getRenderTarget();e.addStack();const s=fu(this.setupVertex(e),"VERTEX"),i=this.vertexNode||s;let n;e.stack.outputNode=i,this.setupHardwareClipping(e),null!==this.geometryNode&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();const a=this.setupClipping(e);if(!0!==this.depthWrite&&!0!==this.depthTest||(null!==r?!0===r.depthBuffer&&this.setupDepth(e):!0===t.depth&&this.setupDepth(e)),null===this.fragmentNode){this.setupDiffuseColor(e),this.setupVariants(e);const s=this.setupLighting(e);null!==a&&e.stack.add(a);const i=gn(s,Rn.a).max(0);n=this.setupOutput(e,i),Hn.assign(n);const o=null!==this.outputNode;if(o&&(n=this.outputNode),null!==r){const e=t.getMRT(),r=this.mrtNode;null!==e?(o&&Hn.assign(n),n=e,null!==r&&(n=e.merge(r))):null!==r&&(n=r)}}else{let t=this.fragmentNode;!0!==t.isOutputStructNode&&(t=gn(t)),n=this.setupOutput(e,t)}e.stack.outputNode=n,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(null===e.clippingContext)return null;const{unionPlanes:t,intersectionPlanes:r}=e.clippingContext;let s=null;if(t.length>0||r.length>0){const t=e.renderer.samples;this.alphaToCoverage&&t>1?s=Gi(new cp(cp.ALPHA_TO_COVERAGE)):e.stack.add(Gi(new cp))}return s}setupHardwareClipping(e){if(this.hardwareClipping=!1,null===e.clippingContext)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.add(Gi(new cp(cp.HARDWARE))),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:r}=e;let s=this.depthNode;if(null===s){const e=t.getMRT();e&&e.has("depth")?s=e.get("depth"):!0===t.logarithmicDepthBuffer&&(s=r.isPerspectiveCamera?ap(pd.z,Bl,Ll):sp(pd.z,Bl,Ll))}null!==s&&up.assign(s).toStack()}setupPositionView(){return id.mul(ld).xyz}setupModelViewProjection(){return Fl.mul(pd)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),mh}setupPosition(e){const{object:t,geometry:r}=e;if((r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color)&&$h(t).toStack(),!0===t.isSkinnedMesh&&Ih(t).toStack(),this.displacementMap){const e=Yd("displacementMap","texture"),t=Yd("displacementScale","float"),r=Yd("displacementBias","float");ld.addAssign(Td.normalize().mul(e.x.mul(t).add(r)))}return t.isBatchedMesh&&wh(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&!0===t.instanceMatrix.isInstancedBufferAttribute&&Rh(t).toStack(),null!==this.positionNode&&ld.assign(fu(this.positionNode,"POSITION","vec3")),ld}setupDiffuseColor({object:e,geometry:t}){null!==this.maskNode&&nn(this.maskNode).not().discard();let r=this.colorNode?gn(this.colorNode):Bc;if(!0===this.vertexColors&&t.hasAttribute("color")&&(r=r.mul(fp())),e.instanceColor){r=En("vec3","vInstanceColor").mul(r)}if(e.isBatchedMesh&&e._colorsTexture){r=En("vec3","vBatchColor").mul(r)}Rn.assign(r);const s=this.opacityNode?tn(this.opacityNode):Ic;Rn.a.assign(Rn.a.mul(s));let i=null;(null!==this.alphaTestNode||this.alphaTest>0)&&(i=null!==this.alphaTestNode?tn(this.alphaTestNode):Pc,Rn.a.lessThanEqual(i).discard()),!0===this.alphaHash&&Rn.a.lessThan(gp(ld)).discard();!1===this.transparent&&this.blending===G&&!1===this.alphaToCoverage?Rn.a.assign(1):null===i&&Rn.a.lessThanEqual(0).discard()}setupVariants(){}setupOutgoingLight(){return!0===this.lights?dn(0):Rn.rgb}setupNormal(){return this.normalNode?dn(this.normalNode):$c}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?Yd("envMap","cubeTexture"):Yd("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Xh(hh)),t}setupLights(e){const t=[],r=this.setupEnvironment(e);r&&r.isLightingNode&&t.push(r);const s=this.setupLightMap(e);if(s&&s.isLightingNode&&t.push(s),null!==this.aoNode||e.material.aoMap){const e=null!==this.aoNode?this.aoNode:ph;t.push(new Wh(e))}let i=this.lightsNode||e.lightsNode;return t.length>0&&(i=e.renderer.lighting.createNode([...i.getLights(),...t])),i}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:r,backdropAlphaNode:s,emissiveNode:i}=this,n=!0===this.lights||null!==this.lightsNode?this.setupLights(e):null;let a=this.setupOutgoingLight(e);if(n&&n.getScope().hasLights){const t=this.setupLightingModel(e)||null;a=jh(n,t,r,s)}else null!==r&&(a=dn(null!==s?Ho(a,r,s):r));return(i&&!0===i.isNode||t.emissive&&!0===t.emissive.isColor)&&(An.assign(dn(i||Fc)),a=a.add(An)),a}setupFog(e,t){const r=e.fogNode;return r&&(Hn.assign(t),t=gn(r.toVar())),t}setupPremultipliedAlpha(e,t){return vp(t)}setupOutput(e,t){return!0===this.fog&&(t=this.setupFog(e,t)),!0===this.premultipliedAlpha&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(const t in e){const r=e[t];void 0===this[t]&&(this[t]=r,r&&r.clone&&(this[t]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const e in t)void 0===Object.getOwnPropertyDescriptor(this.constructor.prototype,e)&&void 0!==t[e].get&&Object.defineProperty(this.constructor.prototype,e,t[e])}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{},nodes:{}});const r=O.prototype.toJSON.call(this,e),s=Rs(this);r.inputNodes={};for(const{property:t,childNode:i}of s)r.inputNodes[t]=i.toJSON(e).uuid;function i(e){const t=[];for(const r in e){const s=e[r];delete s.metadata,t.push(s)}return t}if(t){const t=i(e.textures),s=i(e.images),n=i(e.nodes);t.length>0&&(r.textures=t),s.length>0&&(r.images=s),n.length>0&&(r.nodes=n)}return r}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const Ep=new k;class Rp extends Sp{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(Ep),this.setValues(e)}}const Ap=new z;class wp extends Sp{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(Ap),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?tn(this.offsetNode):lh,t=this.dashScaleNode?tn(this.dashScaleNode):nh,r=this.dashSizeNode?tn(this.dashSizeNode):ah,s=this.gapSizeNode?tn(this.gapSizeNode):oh;Wn.assign(r),qn.assign(s);const i=bu(rl("lineDistance").mul(t));(e?i.add(e):i).mod(Wn.add(qn)).greaterThan(Wn).discard()}}let Cp=null;class Mp extends Yh{static get type(){return"ViewportSharedTextureNode"}constructor(e=Nl,t=null){null===Cp&&(Cp=new D),super(e,t,Cp)}getTextureForReference(){return Cp}updateReference(){return this}}const Pp=Hi(Mp).setParameterLength(0,2),Bp=new z;class Lp extends Sp{static get type(){return"Line2NodeMaterial"}constructor(e={}){super(),this.isLine2NodeMaterial=!0,this.setDefaultValues(Bp),this.useColor=e.vertexColors,this.dashOffset=0,this.lineColorNode=null,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.blending=$,this._useDash=e.dashed,this._useAlphaToCoverage=!0,this._useWorldUnits=!1,this.setValues(e)}setup(e){const{renderer:t}=e,r=this._useAlphaToCoverage,s=this.useColor,i=this._useDash,n=this._useWorldUnits,a=Ki(({start:e,end:t})=>{const r=Fl.element(2).element(2),s=Fl.element(3).element(2).mul(-.5).div(r).sub(e.z).div(t.z.sub(e.z));return gn(Ho(e.xyz,t.xyz,s),t.w)}).setLayout({name:"trimSegment",type:"vec4",inputs:[{name:"start",type:"vec4"},{name:"end",type:"vec4"}]});this.vertexNode=Ki(()=>{const e=rl("instanceStart"),t=rl("instanceEnd"),r=gn(id.mul(gn(e,1))).toVar("start"),s=gn(id.mul(gn(t,1))).toVar("end");if(i){const e=this.dashScaleNode?tn(this.dashScaleNode):nh,t=this.offsetNode?tn(this.offsetNode):lh,r=rl("instanceDistanceStart"),s=rl("instanceDistanceEnd");let i=ud.y.lessThan(.5).select(e.mul(r),e.mul(s));i=i.add(t),En("float","lineDistance").assign(i)}n&&(En("vec3","worldStart").assign(r.xyz),En("vec3","worldEnd").assign(s.xyz));const o=Rl.z.div(Rl.w),u=Fl.element(2).element(3).equal(-1);Zi(u,()=>{Zi(r.z.lessThan(0).and(s.z.greaterThan(0)),()=>{s.assign(a({start:r,end:s}))}).ElseIf(s.z.lessThan(0).and(r.z.greaterThanEqual(0)),()=>{r.assign(a({start:s,end:r}))})});const l=Fl.mul(r),d=Fl.mul(s),c=l.xyz.div(l.w),h=d.xyz.div(d.w),p=h.xy.sub(c.xy).toVar();p.x.assign(p.x.mul(o)),p.assign(p.normalize());const g=gn().toVar();if(n){const e=s.xyz.sub(r.xyz).normalize(),t=Ho(r.xyz,s.xyz,.5).normalize(),n=e.cross(t).normalize(),a=e.cross(n),o=En("vec4","worldPos");o.assign(ud.y.lessThan(.5).select(r,s));const u=uh.mul(.5);o.addAssign(gn(ud.x.lessThan(0).select(n.mul(u),n.mul(u).negate()),0)),i||(o.addAssign(gn(ud.y.lessThan(.5).select(e.mul(u).negate(),e.mul(u)),0)),o.addAssign(gn(a.mul(u),0)),Zi(ud.y.greaterThan(1).or(ud.y.lessThan(0)),()=>{o.subAssign(gn(a.mul(2).mul(u),0))})),g.assign(Fl.mul(o));const l=dn().toVar();l.assign(ud.y.lessThan(.5).select(c,h)),g.z.assign(l.z.mul(g.w))}else{const e=an(p.y,p.x.negate()).toVar("offset");p.x.assign(p.x.div(o)),e.x.assign(e.x.div(o)),e.assign(ud.x.lessThan(0).select(e.negate(),e)),Zi(ud.y.lessThan(0),()=>{e.assign(e.sub(p))}).ElseIf(ud.y.greaterThan(1),()=>{e.assign(e.add(p))}),e.assign(e.mul(uh)),e.assign(e.div(Rl.w)),g.assign(ud.y.lessThan(.5).select(l,d)),e.assign(e.mul(g.w)),g.assign(g.add(gn(e,0,0)))}return g})();const o=Ki(({p1:e,p2:t,p3:r,p4:s})=>{const i=e.sub(r),n=s.sub(r),a=t.sub(e),o=i.dot(n),u=n.dot(a),l=i.dot(a),d=n.dot(n),c=a.dot(a).mul(d).sub(u.mul(u)),h=o.mul(u).sub(l.mul(d)).div(c).clamp(),p=o.add(u.mul(h)).div(d).clamp();return an(h,p)});if(this.colorNode=Ki(()=>{const e=sl();if(i){const t=this.dashSizeNode?tn(this.dashSizeNode):ah,r=this.gapSizeNode?tn(this.gapSizeNode):oh;Wn.assign(t),qn.assign(r);const s=En("float","lineDistance");e.y.lessThan(-1).or(e.y.greaterThan(1)).discard(),s.mod(Wn.add(qn)).greaterThan(Wn).discard()}const a=tn(1).toVar("alpha");if(n){const e=En("vec3","worldStart"),s=En("vec3","worldEnd"),n=En("vec4","worldPos").xyz.normalize().mul(1e5),u=s.sub(e),l=o({p1:e,p2:s,p3:dn(0,0,0),p4:n}),d=e.add(u.mul(l.x)),c=n.mul(l.y),h=d.sub(c).length().div(uh);if(!i)if(r&&t.samples>1){const e=h.fwidth();a.assign(Xo(e.negate().add(.5),e.add(.5),h).oneMinus())}else h.greaterThan(.5).discard()}else if(r&&t.samples>1){const t=e.x,r=e.y.greaterThan(0).select(e.y.sub(1),e.y.add(1)),s=t.mul(t).add(r.mul(r)),i=tn(s.fwidth()).toVar("dlen");Zi(e.y.abs().greaterThan(1),()=>{a.assign(Xo(i.oneMinus(),i.add(1),s).oneMinus())})}else Zi(e.y.abs().greaterThan(1),()=>{const t=e.x,r=e.y.greaterThan(0).select(e.y.sub(1),e.y.add(1));t.mul(t).add(r.mul(r)).greaterThan(1).discard()});let u;if(this.lineColorNode)u=this.lineColorNode;else if(s){const e=rl("instanceColorStart"),t=rl("instanceColorEnd");u=ud.y.lessThan(.5).select(e,t).mul(Bc)}else u=Bc;return gn(u,a)})(),this.transparent){const e=this.opacityNode?tn(this.opacityNode):Ic;this.outputNode=gn(this.colorNode.rgb.mul(e).add(Pp().rgb.mul(e.oneMinus())),this.colorNode.a)}super.setup(e)}get worldUnits(){return this._useWorldUnits}set worldUnits(e){this._useWorldUnits!==e&&(this._useWorldUnits=e,this.needsUpdate=!0)}get dashed(){return this._useDash}set dashed(e){this._useDash!==e&&(this._useDash=e,this.needsUpdate=!0)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const Fp=e=>Gi(e).mul(.5).add(.5),Ip=new H;class Dp extends Sp{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Ip),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?tn(this.opacityNode):Ic;Rn.assign(Eu(gn(Fp(Sd),e),W))}}const Up=Ki(([e=hd])=>{const t=e.z.atan(e.x).mul(1/(2*Math.PI)).add(.5),r=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return an(t,r)});class Vp extends q{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const r=t.minFilter,s=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i=new j(5,5,5),n=Up(hd),a=new Sp;a.colorNode=cl(t,n,0),a.side=S,a.blending=$;const o=new X(i,a),u=new K;u.add(o),t.minFilter===U&&(t.minFilter=Y);const l=new Q(1,10,this),d=e.getMRT();return e.setMRT(null),l.update(e,u),e.setMRT(d),t.minFilter=r,t.currentGenerateMipmaps=s,o.geometry.dispose(),o.material.dispose(),this}}const Op=new WeakMap;class Gp extends Js{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=Hd(null);const t=new A;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=ks.RENDER}updateBefore(e){const{renderer:t,material:r}=e,s=this.envNode;if(s.isTextureNode||s.isMaterialReferenceNode){const e=s.isTextureNode?s.value:r[s.property];if(e&&e.isTexture){const r=e.mapping;if(r===Z||r===J){if(Op.has(e)){const t=Op.get(e);zp(t,e.mapping),this._cubeTexture=t}else{const r=e.image;if(function(e){return null!=e&&e.height>0}(r)){const s=new Vp(r.height);s.fromEquirectangularTexture(t,e),zp(s.texture,e.mapping),this._cubeTexture=s.texture,Op.set(e,s.texture),e.addEventListener("dispose",kp)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function kp(e){const t=e.target;t.removeEventListener("dispose",kp);const r=Op.get(t);void 0!==r&&(Op.delete(t),r.dispose())}function zp(e,t){t===Z?e.mapping=w:t===J&&(e.mapping=C)}const $p=Hi(Gp).setParameterLength(1);class Hp extends Hh{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=$p(this.envNode)}}class Wp extends Hh{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=tn(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class qp{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class jp extends qp{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,r=e.reflectedLight,s=e.irradianceLightMap;r.indirectDiffuse.assign(gn(0)),s?r.indirectDiffuse.addAssign(s):r.indirectDiffuse.addAssign(gn(1,1,1,0)),r.indirectDiffuse.mulAssign(t),r.indirectDiffuse.mulAssign(Rn.rgb)}finish(e){const{material:t,context:r}=e,s=r.outgoingLight,i=e.context.environment;if(i)switch(t.combine){case re:s.rgb.assign(Ho(s.rgb,s.rgb.mul(i.rgb),Oc.mul(Gc)));break;case te:s.rgb.assign(Ho(s.rgb,i.rgb,Oc.mul(Gc)));break;case ee:s.rgb.addAssign(i.rgb.mul(Oc.mul(Gc)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",t.combine)}}}const Xp=new se;class Kp extends Sp{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Xp),this.setValues(e)}setupNormal(){return bd(vd)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Hp(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Wp(hh)),t}setupOutgoingLight(){return Rn.rgb}setupLightingModel(){return new jp}}const Yp=Ki(({f0:e,f90:t,dotVH:r})=>{const s=r.mul(-5.55473).sub(6.98316).mul(r).exp2();return e.mul(s.oneMinus()).add(t.mul(s))}),Qp=Ki(e=>e.diffuseColor.mul(1/Math.PI)),Zp=Ki(({dotNH:e})=>$n.mul(tn(.5)).add(1).mul(tn(1/Math.PI)).mul(e.pow($n))),Jp=Ki(({lightDirection:e})=>{const t=e.add(gd).normalize(),r=Sd.dot(t).clamp(),s=gd.dot(t).clamp(),i=Yp({f0:kn,f90:1,dotVH:s}),n=tn(.25),a=Zp({dotNH:r});return i.mul(n).mul(a)});class eg extends jp{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:r}){const s=Sd.dot(e).clamp().mul(t);r.directDiffuse.addAssign(s.mul(Qp({diffuseColor:Rn.rgb}))),!0===this.specular&&r.directSpecular.addAssign(s.mul(Jp({lightDirection:e})).mul(Oc))}indirect(e){const{ambientOcclusion:t,irradiance:r,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(r.mul(Qp({diffuseColor:Rn}))),s.indirectDiffuse.mulAssign(t)}}const tg=new ie;class rg extends Sp{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(tg),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Hp(t):null}setupLightingModel(){return new eg(!1)}}const sg=new ne;class ig extends Sp{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(sg),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Hp(t):null}setupLightingModel(){return new eg}setupVariants(){const e=(this.shininessNode?tn(this.shininessNode):Lc).max(1e-4);$n.assign(e);const t=this.specularNode||Dc;kn.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const ng=Ki(e=>{if(!1===e.geometry.hasAttribute("normal"))return tn(0);const t=vd.dFdx().abs().max(vd.dFdy().abs());return t.x.max(t.y).max(t.z)}),ag=Ki(e=>{const{roughness:t}=e,r=ng();let s=t.max(.0525);return s=s.add(r),s=s.min(1),s}),og=Ki(({alpha:e,dotNL:t,dotNV:r})=>{const s=e.pow2(),i=t.mul(s.add(s.oneMinus().mul(r.pow2())).sqrt()),n=r.mul(s.add(s.oneMinus().mul(t.pow2())).sqrt());return xa(.5,i.add(n).max($a))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),ug=Ki(({alphaT:e,alphaB:t,dotTV:r,dotBV:s,dotTL:i,dotBL:n,dotNV:a,dotNL:o})=>{const u=o.mul(dn(e.mul(r),t.mul(s),a).length()),l=a.mul(dn(e.mul(i),t.mul(n),o).length());return xa(.5,u.add(l)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),lg=Ki(({alpha:e,dotNH:t})=>{const r=e.pow2(),s=t.pow2().mul(r.oneMinus()).oneMinus();return r.div(s.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),dg=tn(1/Math.PI),cg=Ki(({alphaT:e,alphaB:t,dotNH:r,dotTH:s,dotBH:i})=>{const n=e.mul(t),a=dn(t.mul(s),e.mul(i),n.mul(r)),o=a.dot(a),u=n.div(o);return dg.mul(n.mul(u.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),hg=Ki(({lightDirection:e,f0:t,f90:r,roughness:s,f:i,normalView:n=Sd,USE_IRIDESCENCE:a,USE_ANISOTROPY:o})=>{const u=s.pow2(),l=e.add(gd).normalize(),d=n.dot(e).clamp(),c=n.dot(gd).clamp(),h=n.dot(l).clamp(),p=gd.dot(l).clamp();let g,m,f=Yp({f0:t,f90:r,dotVH:p});if(Ui(a)&&(f=Fn.mix(f,i)),Ui(o)){const t=On.dot(e),r=On.dot(gd),s=On.dot(l),i=Gn.dot(e),n=Gn.dot(gd),a=Gn.dot(l);g=ug({alphaT:Un,alphaB:u,dotTV:r,dotBV:n,dotTL:t,dotBL:i,dotNV:c,dotNL:d}),m=cg({alphaT:Un,alphaB:u,dotNH:h,dotTH:s,dotBH:a})}else g=og({alpha:u,dotNL:d,dotNV:c}),m=lg({alpha:u,dotNH:h});return f.mul(g).mul(m)}),pg=Ki(({roughness:e,dotNV:t})=>{const r=gn(-1,-.0275,-.572,.022),s=gn(1,.0425,1.04,-.04),i=e.mul(r).add(s),n=i.x.mul(i.x).min(t.mul(-9.28).exp2()).mul(i.x).add(i.y);return an(-1.04,1.04).mul(n).add(i.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),gg=Ki(e=>{const{dotNV:t,specularColor:r,specularF90:s,roughness:i}=e,n=pg({dotNV:t,roughness:i});return r.mul(n.x).add(s.mul(n.y))}),mg=Ki(({f:e,f90:t,dotVH:r})=>{const s=r.oneMinus().saturate(),i=s.mul(s),n=s.mul(i,i).clamp(0,.9999);return e.sub(dn(t).mul(n)).div(n.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),fg=Ki(({roughness:e,dotNH:t})=>{const r=e.pow2(),s=tn(1).div(r),i=t.pow2().oneMinus().max(.0078125);return tn(2).add(s).mul(i.pow(s.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),yg=Ki(({dotNV:e,dotNL:t})=>tn(1).div(tn(4).mul(t.add(e).sub(t.mul(e))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),bg=Ki(({lightDirection:e})=>{const t=e.add(gd).normalize(),r=Sd.dot(e).clamp(),s=Sd.dot(gd).clamp(),i=Sd.dot(t).clamp(),n=fg({roughness:Ln,dotNH:i}),a=yg({dotNV:s,dotNL:r});return Bn.mul(n).mul(a)}),xg=Ki(({N:e,V:t,roughness:r})=>{const s=e.dot(t).saturate(),i=an(r,s.oneMinus().sqrt());return i.assign(i.mul(.984375).add(.0078125)),i}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),Tg=Ki(({f:e})=>{const t=e.length();return Mo(t.mul(t).add(e.z).div(t.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),_g=Ki(({v1:e,v2:t})=>{const r=e.dot(t),s=r.abs().toVar(),i=s.mul(.0145206).add(.4965155).mul(s).add(.8543985).toVar(),n=s.add(4.1616724).mul(s).add(3.417594).toVar(),a=i.div(n),o=r.greaterThan(0).select(a,Mo(r.mul(r).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return e.cross(t).mul(o)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),vg=Ki(({N:e,V:t,P:r,mInv:s,p0:i,p1:n,p2:a,p3:o})=>{const u=n.sub(i).toVar(),l=o.sub(i).toVar(),d=u.cross(l),c=dn().toVar();return Zi(d.dot(r.sub(i)).greaterThanEqual(0),()=>{const u=t.sub(e.mul(t.dot(e))).normalize(),l=e.cross(u).negate(),d=s.mul(xn(u,l,e).transpose()).toVar(),h=d.mul(i.sub(r)).normalize().toVar(),p=d.mul(n.sub(r)).normalize().toVar(),g=d.mul(a.sub(r)).normalize().toVar(),m=d.mul(o.sub(r)).normalize().toVar(),f=dn(0).toVar();f.addAssign(_g({v1:h,v2:p})),f.addAssign(_g({v1:p,v2:g})),f.addAssign(_g({v1:g,v2:m})),f.addAssign(_g({v1:m,v2:h})),c.assign(dn(Tg({f:f})))}),c}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),Ng=Ki(({P:e,p0:t,p1:r,p2:s,p3:i})=>{const n=r.sub(t).toVar(),a=i.sub(t).toVar(),o=n.cross(a),u=dn().toVar();return Zi(o.dot(e.sub(t)).greaterThanEqual(0),()=>{const n=t.sub(e).normalize().toVar(),a=r.sub(e).normalize().toVar(),o=s.sub(e).normalize().toVar(),l=i.sub(e).normalize().toVar(),d=dn(0).toVar();d.addAssign(_g({v1:n,v2:a})),d.addAssign(_g({v1:a,v2:o})),d.addAssign(_g({v1:o,v2:l})),d.addAssign(_g({v1:l,v2:n})),u.assign(dn(Tg({f:d.abs()})))}),u}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"P",type:"vec3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),Sg=1/6,Eg=e=>ba(Sg,ba(e,ba(e,e.negate().add(3)).sub(3)).add(1)),Rg=e=>ba(Sg,ba(e,ba(e,ba(3,e).sub(6))).add(4)),Ag=e=>ba(Sg,ba(e,ba(e,ba(-3,e).add(3)).add(3)).add(1)),wg=e=>ba(Sg,Uo(e,3)),Cg=e=>Eg(e).add(Rg(e)),Mg=e=>Ag(e).add(wg(e)),Pg=e=>fa(-1,Rg(e).div(Eg(e).add(Rg(e)))),Bg=e=>fa(1,wg(e).div(Ag(e).add(wg(e)))),Lg=(e,t,r)=>{const s=e.uvNode,i=ba(s,t.zw).add(.5),n=so(i),a=ao(i),o=Cg(a.x),u=Mg(a.x),l=Pg(a.x),d=Bg(a.x),c=Pg(a.y),h=Bg(a.y),p=an(n.x.add(l),n.y.add(c)).sub(.5).mul(t.xy),g=an(n.x.add(d),n.y.add(c)).sub(.5).mul(t.xy),m=an(n.x.add(l),n.y.add(h)).sub(.5).mul(t.xy),f=an(n.x.add(d),n.y.add(h)).sub(.5).mul(t.xy),y=Cg(a.y).mul(fa(o.mul(e.sample(p).level(r)),u.mul(e.sample(g).level(r)))),b=Mg(a.y).mul(fa(o.mul(e.sample(m).level(r)),u.mul(e.sample(f).level(r))));return y.add(b)},Fg=Ki(([e,t])=>{const r=an(e.size(rn(t))),s=an(e.size(rn(t.add(1)))),i=xa(1,r),n=xa(1,s),a=Lg(e,gn(i,r),so(t)),o=Lg(e,gn(n,s),io(t));return ao(t).mix(a,o)}),Ig=Ki(([e,t])=>{const r=t.mul(ol(e));return Fg(e,r)}),Dg=Ki(([e,t,r,s,i])=>{const n=dn(jo(t.negate(),no(e),xa(1,s))),a=dn(fo(i[0].xyz),fo(i[1].xyz),fo(i[2].xyz));return no(n).mul(r.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),Ug=Ki(([e,t])=>e.mul(Wo(t.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),Vg=Zh(),Og=Zh(),Gg=Ki(([e,t,r],{material:s})=>{const i=(s.side===S?Vg:Og).sample(e),n=eo(Sl.x).mul(Ug(t,r));return Fg(i,n)}),kg=Ki(([e,t,r])=>(Zi(r.notEqual(0),()=>{const s=Ja(t).negate().div(r);return Qa(s.negate().mul(e))}),dn(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),zg=Ki(([e,t,r,s,i,n,a,o,u,l,d,c,h,p,g])=>{let m,f;if(g){m=gn().toVar(),f=dn().toVar();const i=d.sub(1).mul(g.mul(.025)),n=dn(d.sub(i),d,d.add(i));Uh({start:0,end:3},({i:i})=>{const d=n.element(i),g=Dg(e,t,c,d,o),y=a.add(g),b=l.mul(u.mul(gn(y,1))),x=an(b.xy.div(b.w)).toVar();x.addAssign(1),x.divAssign(2),x.assign(an(x.x,x.y.oneMinus()));const T=Gg(x,r,d);m.element(i).assign(T.element(i)),m.a.addAssign(T.a),f.element(i).assign(s.element(i).mul(kg(fo(g),h,p).element(i)))}),m.a.divAssign(3)}else{const i=Dg(e,t,c,d,o),n=a.add(i),g=l.mul(u.mul(gn(n,1))),y=an(g.xy.div(g.w)).toVar();y.addAssign(1),y.divAssign(2),y.assign(an(y.x,y.y.oneMinus())),m=Gg(y,r,d),f=s.mul(kg(fo(i),h,p))}const y=f.rgb.mul(m.rgb),b=e.dot(t).clamp(),x=dn(gg({dotNV:b,specularColor:i,specularF90:n,roughness:r})),T=f.r.add(f.g,f.b).div(3);return gn(x.oneMinus().mul(y),m.a.oneMinus().mul(T).oneMinus())}),$g=xn(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),Hg=(e,t)=>e.sub(t).div(e.add(t)).pow2(),Wg=Ki(({outsideIOR:e,eta2:t,cosTheta1:r,thinFilmThickness:s,baseF0:i})=>{const n=Ho(e,t,Xo(0,.03,s)),a=e.div(n).pow2().mul(r.pow2().oneMinus()).oneMinus();Zi(a.lessThan(0),()=>dn(1));const o=a.sqrt(),u=Hg(n,e),l=Yp({f0:u,f90:1,dotVH:r}),d=l.oneMinus(),c=n.lessThan(e).select(Math.PI,0),h=tn(Math.PI).sub(c),p=(e=>{const t=e.sqrt();return dn(1).add(t).div(dn(1).sub(t))})(i.clamp(0,.9999)),g=Hg(p,n.toVec3()),m=Yp({f0:g,f90:1,dotVH:o}),f=dn(p.x.lessThan(n).select(Math.PI,0),p.y.lessThan(n).select(Math.PI,0),p.z.lessThan(n).select(Math.PI,0)),y=n.mul(s,o,2),b=dn(h).add(f),x=l.mul(m).clamp(1e-5,.9999),T=x.sqrt(),_=d.pow2().mul(m).div(dn(1).sub(x)),v=l.add(_).toVar(),N=_.sub(d).toVar();return Uh({start:1,end:2,condition:"<=",name:"m"},({m:e})=>{N.mulAssign(T);const t=((e,t)=>{const r=e.mul(2*Math.PI*1e-9),s=dn(54856e-17,44201e-17,52481e-17),i=dn(1681e3,1795300,2208400),n=dn(43278e5,93046e5,66121e5),a=tn(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(r.mul(2239900).add(t.x).cos()).mul(r.pow2().mul(-45282e5).exp());let o=s.mul(n.mul(2*Math.PI).sqrt()).mul(i.mul(r).add(t).cos()).mul(r.pow2().negate().mul(n).exp());return o=dn(o.x.add(a),o.y,o.z).div(1.0685e-7),$g.mul(o)})(tn(e).mul(y),tn(e).mul(b)).mul(2);v.addAssign(N.mul(t))}),v.max(dn(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),qg=Ki(({normal:e,viewDir:t,roughness:r})=>{const s=e.dot(t).saturate(),i=r.pow2(),n=iu(r.lessThan(.25),tn(-339.2).mul(i).add(tn(161.4).mul(r)).sub(25.9),tn(-8.48).mul(i).add(tn(14.3).mul(r)).sub(9.95)),a=iu(r.lessThan(.25),tn(44).mul(i).sub(tn(23.7).mul(r)).add(3.26),tn(1.97).mul(i).sub(tn(3.27).mul(r)).add(.72));return iu(r.lessThan(.25),0,tn(.1).mul(r).sub(.025)).add(n.mul(s).add(a).exp()).mul(1/Math.PI).saturate()}),jg=dn(.04),Xg=tn(1);class Kg extends qp{constructor(e=!1,t=!1,r=!1,s=!1,i=!1,n=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=r,this.anisotropy=s,this.transmission=i,this.dispersion=n,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(!0===this.clearcoat&&(this.clearcoatRadiance=dn().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=dn().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=dn().toVar("clearcoatSpecularIndirect")),!0===this.sheen&&(this.sheenSpecularDirect=dn().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=dn().toVar("sheenSpecularIndirect")),!0===this.iridescence){const e=Sd.dot(gd).clamp();this.iridescenceFresnel=Wg({outsideIOR:tn(1),eta2:In,cosTheta1:e,thinFilmThickness:Dn,baseF0:kn}),this.iridescenceF0=mg({f:this.iridescenceFresnel,f90:1,dotVH:e})}if(!0===this.transmission){const t=cd,r=Ol.sub(cd).normalize(),s=Ed,i=e.context;i.backdrop=zg(s,r,wn,Rn,kn,zn,t,Ql,Dl,Fl,Xn,Yn,Zn,Qn,this.dispersion?Jn:null),i.backdropAlpha=Kn,Rn.a.mulAssign(Ho(1,i.backdrop.a,Kn))}super.start(e)}computeMultiscattering(e,t,r){const s=Sd.dot(gd).clamp(),i=pg({roughness:wn,dotNV:s}),n=(this.iridescenceF0?Fn.mix(kn,this.iridescenceF0):kn).mul(i.x).add(r.mul(i.y)),a=i.x.add(i.y).oneMinus(),o=kn.add(kn.oneMinus().mul(.047619)),u=n.mul(o).div(a.mul(o).oneMinus());e.addAssign(n),t.addAssign(u.mul(a))}direct({lightDirection:e,lightColor:t,reflectedLight:r}){const s=Sd.dot(e).clamp().mul(t);if(!0===this.sheen&&this.sheenSpecularDirect.addAssign(s.mul(bg({lightDirection:e}))),!0===this.clearcoat){const r=Rd.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(r.mul(hg({lightDirection:e,f0:jg,f90:Xg,roughness:Pn,normalView:Rd})))}r.directDiffuse.addAssign(s.mul(Qp({diffuseColor:Rn.rgb}))),r.directSpecular.addAssign(s.mul(hg({lightDirection:e,f0:kn,f90:1,roughness:wn,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:r,halfHeight:s,reflectedLight:i,ltc_1:n,ltc_2:a}){const o=t.add(r).sub(s),u=t.sub(r).sub(s),l=t.sub(r).add(s),d=t.add(r).add(s),c=Sd,h=gd,p=pd.toVar(),g=xg({N:c,V:h,roughness:wn}),m=n.sample(g).toVar(),f=a.sample(g).toVar(),y=xn(dn(m.x,0,m.y),dn(0,1,0),dn(m.z,0,m.w)).toVar(),b=kn.mul(f.x).add(kn.oneMinus().mul(f.y)).toVar();i.directSpecular.addAssign(e.mul(b).mul(vg({N:c,V:h,P:p,mInv:y,p0:o,p1:u,p2:l,p3:d}))),i.directDiffuse.addAssign(e.mul(Rn).mul(vg({N:c,V:h,P:p,mInv:xn(1,0,0,0,1,0,0,0,1),p0:o,p1:u,p2:l,p3:d})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:r}=e.context;r.indirectDiffuse.addAssign(t.mul(Qp({diffuseColor:Rn})))}indirectSpecular(e){const{radiance:t,iblIrradiance:r,reflectedLight:s}=e.context;if(!0===this.sheen&&this.sheenSpecularIndirect.addAssign(r.mul(Bn,qg({normal:Sd,viewDir:gd,roughness:Ln}))),!0===this.clearcoat){const e=Rd.dot(gd).clamp(),t=gg({dotNV:e,specularColor:jg,specularF90:Xg,roughness:Pn});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(t))}const i=dn().toVar("singleScattering"),n=dn().toVar("multiScattering"),a=r.mul(1/Math.PI);this.computeMultiscattering(i,n,zn);const o=i.add(n),u=Rn.mul(o.r.max(o.g).max(o.b).oneMinus());s.indirectSpecular.addAssign(t.mul(i)),s.indirectSpecular.addAssign(n.mul(a)),s.indirectDiffuse.addAssign(u.mul(a))}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:r}=e.context,s=Sd.dot(gd).clamp().add(t),i=wn.mul(-16).oneMinus().negate().exp2(),n=t.sub(s.pow(i).oneMinus()).clamp();!0===this.clearcoat&&this.clearcoatSpecularIndirect.mulAssign(t),!0===this.sheen&&this.sheenSpecularIndirect.mulAssign(t),r.indirectDiffuse.mulAssign(t),r.indirectSpecular.mulAssign(n)}finish({context:e}){const{outgoingLight:t}=e;if(!0===this.clearcoat){const e=Rd.dot(gd).clamp(),r=Yp({dotVH:e,f0:jg,f90:Xg}),s=t.mul(Mn.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(Mn));t.assign(s)}if(!0===this.sheen){const e=Bn.r.max(Bn.g).max(Bn.b).mul(.157).oneMinus(),r=t.mul(e).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const Yg=tn(1),Qg=tn(-2),Zg=tn(.8),Jg=tn(-1),em=tn(.4),tm=tn(2),rm=tn(.305),sm=tn(3),im=tn(.21),nm=tn(4),am=tn(4),om=tn(16),um=Ki(([e])=>{const t=dn(go(e)).toVar(),r=tn(-1).toVar();return Zi(t.x.greaterThan(t.z),()=>{Zi(t.x.greaterThan(t.y),()=>{r.assign(iu(e.x.greaterThan(0),0,3))}).Else(()=>{r.assign(iu(e.y.greaterThan(0),1,4))})}).Else(()=>{Zi(t.z.greaterThan(t.y),()=>{r.assign(iu(e.z.greaterThan(0),2,5))}).Else(()=>{r.assign(iu(e.y.greaterThan(0),1,4))})}),r}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),lm=Ki(([e,t])=>{const r=an().toVar();return Zi(t.equal(0),()=>{r.assign(an(e.z,e.y).div(go(e.x)))}).ElseIf(t.equal(1),()=>{r.assign(an(e.x.negate(),e.z.negate()).div(go(e.y)))}).ElseIf(t.equal(2),()=>{r.assign(an(e.x.negate(),e.y).div(go(e.z)))}).ElseIf(t.equal(3),()=>{r.assign(an(e.z.negate(),e.y).div(go(e.x)))}).ElseIf(t.equal(4),()=>{r.assign(an(e.x.negate(),e.z).div(go(e.y)))}).Else(()=>{r.assign(an(e.x,e.y).div(go(e.z)))}),ba(.5,r.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),dm=Ki(([e])=>{const t=tn(0).toVar();return Zi(e.greaterThanEqual(Zg),()=>{t.assign(Yg.sub(e).mul(Jg.sub(Qg)).div(Yg.sub(Zg)).add(Qg))}).ElseIf(e.greaterThanEqual(em),()=>{t.assign(Zg.sub(e).mul(tm.sub(Jg)).div(Zg.sub(em)).add(Jg))}).ElseIf(e.greaterThanEqual(rm),()=>{t.assign(em.sub(e).mul(sm.sub(tm)).div(em.sub(rm)).add(tm))}).ElseIf(e.greaterThanEqual(im),()=>{t.assign(rm.sub(e).mul(nm.sub(sm)).div(rm.sub(im)).add(sm))}).Else(()=>{t.assign(tn(-2).mul(eo(ba(1.16,e))))}),t}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),cm=Ki(([e,t])=>{const r=e.toVar();r.assign(ba(2,r).sub(1));const s=dn(r,1).toVar();return Zi(t.equal(0),()=>{s.assign(s.zyx)}).ElseIf(t.equal(1),()=>{s.assign(s.xzy),s.xz.mulAssign(-1)}).ElseIf(t.equal(2),()=>{s.x.mulAssign(-1)}).ElseIf(t.equal(3),()=>{s.assign(s.zyx),s.xz.mulAssign(-1)}).ElseIf(t.equal(4),()=>{s.assign(s.xzy),s.xy.mulAssign(-1)}).ElseIf(t.equal(5),()=>{s.z.mulAssign(-1)}),s}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),hm=Ki(([e,t,r,s,i,n])=>{const a=tn(r),o=dn(t),u=Wo(dm(a),Qg,n),l=ao(u),d=so(u),c=dn(pm(e,o,d,s,i,n)).toVar();return Zi(l.notEqual(0),()=>{const t=dn(pm(e,o,d.add(1),s,i,n)).toVar();c.assign(Ho(c,t,l))}),c}),pm=Ki(([e,t,r,s,i,n])=>{const a=tn(r).toVar(),o=dn(t),u=tn(um(o)).toVar(),l=tn(Mo(am.sub(a),0)).toVar();a.assign(Mo(a,am));const d=tn(Za(a)).toVar(),c=an(lm(o,u).mul(d.sub(2)).add(1)).toVar();return Zi(u.greaterThan(2),()=>{c.y.addAssign(d),u.subAssign(3)}),c.x.addAssign(u.mul(d)),c.x.addAssign(l.mul(ba(3,om))),c.y.addAssign(ba(4,Za(n).sub(d))),c.x.mulAssign(s),c.y.mulAssign(i),e.sample(c).grad(an(),an())}),gm=Ki(({envMap:e,mipInt:t,outputDirection:r,theta:s,axis:i,CUBEUV_TEXEL_WIDTH:n,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:o})=>{const u=uo(s),l=r.mul(u).add(i.cross(r).mul(oo(s))).add(i.mul(i.dot(r).mul(u.oneMinus())));return pm(e,l,t,n,a,o)}),mm=Ki(({n:e,latitudinal:t,poleAxis:r,outputDirection:s,weights:i,samples:n,dTheta:a,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c})=>{const h=dn(iu(t,r,Do(r,s))).toVar();Zi(h.equal(dn(0)),()=>{h.assign(dn(s.z,0,s.x.negate()))}),h.assign(no(h));const p=dn().toVar();return p.addAssign(i.element(0).mul(gm({theta:0,axis:h,outputDirection:s,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c}))),Uh({start:rn(1),end:e},({i:e})=>{Zi(e.greaterThanEqual(n),()=>{Vh()});const t=tn(a.mul(tn(e))).toVar();p.addAssign(i.element(e).mul(gm({theta:t.mul(-1),axis:h,outputDirection:s,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c}))),p.addAssign(i.element(e).mul(gm({theta:t,axis:h,outputDirection:s,mipInt:o,envMap:u,CUBEUV_TEXEL_WIDTH:l,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:c})))}),gn(p,1)}),fm=[.125,.215,.35,.446,.526,.582],ym=20,bm=new ae(-1,1,1,-1,0,1),xm=new oe(90,1),Tm=new e;let _m=null,vm=0,Nm=0;const Sm=(1+Math.sqrt(5))/2,Em=1/Sm,Rm=[new r(-Sm,Em,0),new r(Sm,Em,0),new r(-Em,0,Sm),new r(Em,0,Sm),new r(0,Sm,-Em),new r(0,Sm,Em),new r(-1,1,-1),new r(1,1,-1),new r(-1,1,1),new r(1,1,1)],Am=new r,wm=new WeakMap,Cm=[3,1,5,0,4,2],Mm=cm(sl(),rl("faceIndex")).normalize(),Pm=dn(Mm.x,Mm.y,Mm.z);class Bm{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,r=.1,s=100,i={}){const{size:n=256,position:a=Am,renderTarget:o=null}=i;if(this._setSize(n),!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const n=o||this._allocateTarget();return i.renderTarget=n,this.fromSceneAsync(e,t,r,s,i),n}_m=this._renderer.getRenderTarget(),vm=this._renderer.getActiveCubeFace(),Nm=this._renderer.getActiveMipmapLevel();const u=o||this._allocateTarget();return u.depthBuffer=!0,this._init(u),this._sceneToCubeUV(e,r,s,u,a),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,t=0,r=.1,s=100,i={}){return!1===this._hasInitialized&&await this._renderer.init(),this.fromScene(e,t,r,s,i)}fromEquirectangular(e,t=null){if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const r=t||this._allocateTarget();return this.fromEquirectangularAsync(e,r),r}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return!1===this._hasInitialized&&await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(!1===this._hasInitialized){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const r=t||this._allocateTarget();return this.fromCubemapAsync(e,t),r}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return!1===this._hasInitialized&&await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Dm(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Um(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===w||e.mapping===C?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_m,vm,Nm),e.scissorTest=!1,Fm(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),_m=this._renderer.getRenderTarget(),vm=this._renderer.getActiveCubeFace(),Nm=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTarget();return this._init(r),this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTarget(){return Lm(3*Math.max(this._cubeSize,112),4*this._cubeSize)}_init(e){if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Lm(e.width,e.height);const{_lodMax:t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=function(e){const t=[],r=[],s=[],i=[];let n=e;const a=e-4+1+fm.length;for(let o=0;o<a;o++){const a=Math.pow(2,n);r.push(a);let u=1/a;o>e-4?u=fm[o-e+4-1]:0===o&&(u=0),s.push(u);const l=1/(a-2),d=-l,c=1+l,h=[d,d,c,d,c,c,d,d,c,c,d,c],p=6,g=6,m=3,f=2,y=1,b=new Float32Array(m*g*p),x=new Float32Array(f*g*p),T=new Float32Array(y*g*p);for(let e=0;e<p;e++){const t=e%3*2/3-1,r=e>2?0:-1,s=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0],i=Cm[e];b.set(s,m*g*i),x.set(h,f*g*i);const n=[i,i,i,i,i,i];T.set(n,y*g*i)}const _=new pe;_.setAttribute("position",new ge(b,m)),_.setAttribute("uv",new ge(x,f)),_.setAttribute("faceIndex",new ge(T,y)),t.push(_),i.push(new X(_,null)),n>4&&n--}return{lodPlanes:t,sizeLods:r,sigmas:s,lodMeshes:i}}(t)),this._blurMaterial=function(e,t,s){const i=yl(new Array(ym).fill(0)),n=oa(new r(0,1,0)),a=oa(0),o=tn(ym),u=oa(0),l=oa(1),d=cl(null),c=oa(0),h=tn(1/t),p=tn(1/s),g=tn(e),m={n:o,latitudinal:u,weights:i,poleAxis:n,outputDirection:Pm,dTheta:a,samples:l,envMap:d,mipInt:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:p,CUBEUV_MAX_MIP:g},f=Im("blur");return f.fragmentNode=mm({...m,latitudinal:u.equal(1)}),wm.set(f,m),f}(t,e.width,e.height)}}async _compileMaterial(e){const t=new X(this._lodPlanes[0],e);await this._renderer.compile(t,bm)}_sceneToCubeUV(e,t,r,s,i){const n=xm;n.near=t,n.far=r;const a=[1,1,1,1,-1,1],o=[1,-1,1,-1,1,-1],u=this._renderer,l=u.autoClear;u.getClearColor(Tm),u.autoClear=!1;let d=this._backgroundBox;if(null===d){const e=new se({name:"PMREM.Background",side:S,depthWrite:!1,depthTest:!1});d=new X(new j,e)}let c=!1;const h=e.background;h?h.isColor&&(d.material.color.copy(h),e.background=null,c=!0):(d.material.color.copy(Tm),c=!0),u.setRenderTarget(s),u.clear(),c&&u.render(d,n);for(let t=0;t<6;t++){const r=t%3;0===r?(n.up.set(0,a[t],0),n.position.set(i.x,i.y,i.z),n.lookAt(i.x+o[t],i.y,i.z)):1===r?(n.up.set(0,0,a[t]),n.position.set(i.x,i.y,i.z),n.lookAt(i.x,i.y+o[t],i.z)):(n.up.set(0,a[t],0),n.position.set(i.x,i.y,i.z),n.lookAt(i.x,i.y,i.z+o[t]));const l=this._cubeSize;Fm(s,r*l,t>2?l:0,l,l),u.render(e,n)}u.autoClear=l,e.background=h}_textureToCubeUV(e,t){const r=this._renderer,s=e.mapping===w||e.mapping===C;s?null===this._cubemapMaterial&&(this._cubemapMaterial=Dm(e)):null===this._equirectMaterial&&(this._equirectMaterial=Um(e));const i=s?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;const n=this._lodMeshes[0];n.material=i;const a=this._cubeSize;Fm(t,0,0,3*a,2*a),r.setRenderTarget(t),r.render(n,bm)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let t=1;t<s;t++){const r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=Rm[(s-t-1)%Rm.length];this._blur(e,t-1,t,r,i)}t.autoClear=r}_blur(e,t,r,s,i){const n=this._pingPongRenderTarget;this._halfBlur(e,n,t,r,s,"latitudinal",i),this._halfBlur(n,e,r,r,s,"longitudinal",i)}_halfBlur(e,t,r,s,i,n,a){const o=this._renderer,u=this._blurMaterial;"latitudinal"!==n&&"longitudinal"!==n&&console.error("blur direction must be either latitudinal or longitudinal!");const l=this._lodMeshes[s];l.material=u;const d=wm.get(u),c=this._sizeLods[r]-1,h=isFinite(i)?Math.PI/(2*c):2*Math.PI/39,p=i/h,g=isFinite(i)?1+Math.floor(3*p):ym;g>ym&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const m=[];let f=0;for(let e=0;e<ym;++e){const t=e/p,r=Math.exp(-t*t/2);m.push(r),0===e?f+=r:e<g&&(f+=2*r)}for(let e=0;e<m.length;e++)m[e]=m[e]/f;e.texture.frame=(e.texture.frame||0)+1,d.envMap.value=e.texture,d.samples.value=g,d.weights.array=m,d.latitudinal.value="latitudinal"===n?1:0,a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=h,d.mipInt.value=y-r;const b=this._sizeLods[s];Fm(t,3*b*(s>y-4?s-y+4:0),4*(this._cubeSize-b),3*b,2*b),o.setRenderTarget(t),o.render(l,bm)}}function Lm(e,t){const r=new ue(e,t,{magFilter:Y,minFilter:Y,generateMipmaps:!1,type:ce,format:de,colorSpace:le});return r.texture.mapping=he,r.texture.name="PMREM.cubeUv",r.texture.isPMREMTexture=!0,r.scissorTest=!0,r}function Fm(e,t,r,s,i){e.viewport.set(t,r,s,i),e.scissor.set(t,r,s,i)}function Im(e){const t=new Sp;return t.depthTest=!1,t.depthWrite=!1,t.blending=$,t.name=`PMREM_${e}`,t}function Dm(e){const t=Im("cubemap");return t.fragmentNode=Hd(e,Pm),t}function Um(e){const t=Im("equirect");return t.fragmentNode=cl(e,Up(Pm),0),t}const Vm=new WeakMap;function Om(e,t,r){const s=function(e){let t=Vm.get(e);void 0===t&&(t=new WeakMap,Vm.set(e,t));return t}(t);let i=s.get(e);if((void 0!==i?i.pmremVersion:-1)!==e.pmremVersion){const t=e.image;if(e.isCubeTexture){if(!function(e){if(null==e)return!1;let t=0;const r=6;for(let s=0;s<r;s++)void 0!==e[s]&&t++;return t===r}(t))return null;i=r.fromCubemap(e,i)}else{if(!function(e){return null!=e&&e.height>0}(t))return null;i=r.fromEquirectangular(e,i)}i.pmremVersion=e.pmremVersion,s.set(e,i)}return i.texture}class Gm extends Js{static get type(){return"PMREMNode"}constructor(e,t=null,r=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=r,this._generator=null;const s=new x;s.isRenderTargetTexture=!0,this._texture=cl(s),this._width=oa(0),this._height=oa(0),this._maxMip=oa(0),this.updateBeforeType=ks.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=function(e){const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const r=t?t.pmremVersion:-1,s=this._value;r!==s.pmremVersion&&(t=!0===s.isPMREMTexture?s:Om(s,e.renderer,this._generator),null!==t&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){null===this._generator&&(this._generator=new Bm(e.renderer)),this.updateBefore(e);let t=this.uvNode;null===t&&e.context.getUV&&(t=e.context.getUV(this)),t=Dd.mul(dn(t.x,t.y.negate(),t.z));let r=this.levelNode;return null===r&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),hm(this._texture,t,r,this._width,this._height,this._maxMip)}dispose(){super.dispose(),null!==this._generator&&this._generator.dispose()}}const km=Hi(Gm).setParameterLength(1,3),zm=new WeakMap;class $m extends Hh{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const e=r.isTextureNode?r.value:t[r.property];let s=zm.get(e);void 0===s&&(s=km(e),zm.set(e,s)),r=s}const s=!0===t.useAnisotropy||t.anisotropy>0?vc:Sd,i=r.context(Hm(wn,s)).mul(Id),n=r.context(Wm(Ed)).mul(Math.PI).mul(Id),a=zu(i),o=zu(n);e.context.radiance.addAssign(a),e.context.iblIrradiance.addAssign(o);const u=e.context.lightingModel.clearcoatRadiance;if(u){const e=r.context(Hm(Pn,Rd)).mul(Id),t=zu(e);u.addAssign(t)}}}const Hm=(e,t)=>{let r=null;return{getUV:()=>(null===r&&(r=gd.negate().reflect(t),r=e.mul(e).mix(r,t).normalize(),r=r.transformDirection(Dl)),r),getTextureLevel:()=>e}},Wm=e=>({getUV:()=>e,getTextureLevel:()=>tn(1)}),qm=new me;class jm extends Sp{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(qm),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return null===t&&e.environmentNode&&(t=e.environmentNode),t?new $m(t):null}setupLightingModel(){return new Kg}setupSpecular(){const e=Ho(dn(.04),Rn.rgb,Cn);kn.assign(e),zn.assign(1)}setupVariants(){const e=this.metalnessNode?tn(this.metalnessNode):zc;Cn.assign(e);let t=this.roughnessNode?tn(this.roughnessNode):kc;t=ag({roughness:t}),wn.assign(t),this.setupSpecular(),Rn.assign(gn(Rn.rgb.mul(e.oneMinus()),Rn.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Xm=new fe;class Km extends jm{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Xm),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||null!==this.clearcoatNode}get useIridescence(){return this.iridescence>0||null!==this.iridescenceNode}get useSheen(){return this.sheen>0||null!==this.sheenNode}get useAnisotropy(){return this.anisotropy>0||null!==this.anisotropyNode}get useTransmission(){return this.transmission>0||null!==this.transmissionNode}get useDispersion(){return this.dispersion>0||null!==this.dispersionNode}setupSpecular(){const e=this.iorNode?tn(this.iorNode):rh;Xn.assign(e),kn.assign(Ho(Co(Vo(Xn.sub(1).div(Xn.add(1))).mul(Vc),dn(1)).mul(Uc),Rn.rgb,Cn)),zn.assign(Ho(Uc,1,Cn))}setupLightingModel(){return new Kg(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const e=this.clearcoatNode?tn(this.clearcoatNode):Hc,t=this.clearcoatRoughnessNode?tn(this.clearcoatRoughnessNode):Wc;Mn.assign(e),Pn.assign(ag({roughness:t}))}if(this.useSheen){const e=this.sheenNode?dn(this.sheenNode):Xc,t=this.sheenRoughnessNode?tn(this.sheenRoughnessNode):Kc;Bn.assign(e),Ln.assign(t)}if(this.useIridescence){const e=this.iridescenceNode?tn(this.iridescenceNode):Qc,t=this.iridescenceIORNode?tn(this.iridescenceIORNode):Zc,r=this.iridescenceThicknessNode?tn(this.iridescenceThicknessNode):Jc;Fn.assign(e),In.assign(t),Dn.assign(r)}if(this.useAnisotropy){const e=(this.anisotropyNode?an(this.anisotropyNode):Yc).toVar();Vn.assign(e.length()),Zi(Vn.equal(0),()=>{e.assign(an(1,0))}).Else(()=>{e.divAssign(an(Vn)),Vn.assign(Vn.saturate())}),Un.assign(Vn.pow2().mix(wn.pow2(),1)),On.assign(Tc[0].mul(e.x).add(Tc[1].mul(e.y))),Gn.assign(Tc[1].mul(e.x).sub(Tc[0].mul(e.y)))}if(this.useTransmission){const e=this.transmissionNode?tn(this.transmissionNode):eh,t=this.thicknessNode?tn(this.thicknessNode):th,r=this.attenuationDistanceNode?tn(this.attenuationDistanceNode):sh,s=this.attenuationColorNode?dn(this.attenuationColorNode):ih;if(Kn.assign(e),Yn.assign(t),Qn.assign(r),Zn.assign(s),this.useDispersion){const e=this.dispersionNode?tn(this.dispersionNode):ch;Jn.assign(e)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?dn(this.clearcoatNormalNode):qc}setup(e){e.context.setupClearcoatNormal=()=>fu(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}class Ym extends Kg{constructor(e=!1,t=!1,r=!1,s=!1,i=!1,n=!1,a=!1){super(e,t,r,s,i,n),this.useSSS=a}direct({lightDirection:e,lightColor:t,reflectedLight:r},s){if(!0===this.useSSS){const i=s.material,{thicknessColorNode:n,thicknessDistortionNode:a,thicknessAmbientNode:o,thicknessAttenuationNode:u,thicknessPowerNode:l,thicknessScaleNode:d}=i,c=e.add(Sd.mul(a)).normalize(),h=tn(gd.dot(c.negate()).saturate().pow(l).mul(d)),p=dn(h.add(o).mul(n));r.directDiffuse.addAssign(p.mul(u.mul(t)))}super.direct({lightDirection:e,lightColor:t,reflectedLight:r},s)}}class Qm extends Km{static get type(){return"MeshSSSNodeMaterial"}constructor(e){super(e),this.thicknessColorNode=null,this.thicknessDistortionNode=tn(.1),this.thicknessAmbientNode=tn(0),this.thicknessAttenuationNode=tn(.1),this.thicknessPowerNode=tn(2),this.thicknessScaleNode=tn(10)}get useSSS(){return null!==this.thicknessColorNode}setupLightingModel(){return new Ym(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion,this.useSSS)}copy(e){return this.thicknessColorNode=e.thicknessColorNode,this.thicknessDistortionNode=e.thicknessDistortionNode,this.thicknessAmbientNode=e.thicknessAmbientNode,this.thicknessAttenuationNode=e.thicknessAttenuationNode,this.thicknessPowerNode=e.thicknessPowerNode,this.thicknessScaleNode=e.thicknessScaleNode,super.copy(e)}}const Zm=Ki(({normal:e,lightDirection:t,builder:r})=>{const s=e.dot(t),i=an(s.mul(.5).add(.5),0);if(r.material.gradientMap){const e=Yd("gradientMap","texture").context({getUV:()=>i});return dn(e.r)}{const e=i.fwidth().mul(.5);return Ho(dn(.7),dn(1),Xo(tn(.7).sub(e.x),tn(.7).add(e.x),i.x))}});class Jm extends qp{direct({lightDirection:e,lightColor:t,reflectedLight:r},s){const i=Zm({normal:xd,lightDirection:e,builder:s}).mul(t);r.directDiffuse.addAssign(i.mul(Qp({diffuseColor:Rn.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:r,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(r.mul(Qp({diffuseColor:Rn}))),s.indirectDiffuse.mulAssign(t)}}const ef=new ye;class tf extends Sp{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(ef),this.setValues(e)}setupLightingModel(){return new Jm}}const rf=Ki(()=>{const e=dn(gd.z,0,gd.x.negate()).normalize(),t=gd.cross(e);return an(e.dot(Sd),t.dot(Sd)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),sf=new be;class nf extends Sp{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(sf),this.setValues(e)}setupVariants(e){const t=rf;let r;r=e.material.matcap?Yd("matcap","texture").context({getUV:()=>t}):dn(Ho(.2,.8,t.y)),Rn.rgb.mulAssign(r.rgb)}}class af extends Js{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:r}=this;if("vec2"===this.getNodeType(e)){const e=t.cos(),s=t.sin();return bn(e,s,s.negate(),e).mul(r)}{const e=t,s=Tn(gn(1,0,0,0),gn(0,uo(e.x),oo(e.x).negate(),0),gn(0,oo(e.x),uo(e.x),0),gn(0,0,0,1)),i=Tn(gn(uo(e.y),0,oo(e.y),0),gn(0,1,0,0),gn(oo(e.y).negate(),0,uo(e.y),0),gn(0,0,0,1)),n=Tn(gn(uo(e.z),oo(e.z).negate(),0,0),gn(oo(e.z),uo(e.z),0,0),gn(0,0,1,0),gn(0,0,0,1));return s.mul(i).mul(n).mul(gn(r,1)).xyz}}}const of=Hi(af).setParameterLength(2),uf=new xe;class lf extends Sp{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(uf),this.setValues(e)}setupPositionView(e){const{object:t,camera:r}=e,{positionNode:s,rotationNode:i,scaleNode:n,sizeAttenuation:a}=this,o=id.mul(dn(s||0));let u=an(Ql[0].xyz.length(),Ql[1].xyz.length());null!==n&&(u=u.mul(an(n))),r.isPerspectiveCamera&&!1===a&&(u=u.mul(o.z.negate()));let l=ud.xy;if(t.center&&!0===t.center.isVector2){const e=((e,t,r)=>Gi(new Au(e,t,r)))("center","vec2",t);l=l.sub(e.sub(.5))}l=l.mul(u);const d=tn(i||jc),c=of(l,d);return gn(o.xy.add(c),o.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const df=new Te,cf=new t;class hf extends lf{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(df),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return id.mul(dn(e||ld)).xyz}setupVertexSprite(e){const{material:t,camera:r}=e,{rotationNode:s,scaleNode:i,sizeNode:n,sizeAttenuation:a}=this;let o=super.setupVertex(e);if(!0!==t.isNodeMaterial)return o;let u=null!==n?an(n):dh;u=u.mul(vl),r.isPerspectiveCamera&&!0===a&&(u=u.mul(pf.div(pd.z.negate()))),i&&i.isNode&&(u=u.mul(an(i)));let l=ud.xy;if(s&&s.isNode){const e=tn(s);l=of(l,e)}return l=l.mul(u),l=l.div(Al.div(2)),l=l.mul(o.w),o=o.add(gn(l,0,0)),o}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const pf=oa(1).onFrameUpdate(function({renderer:e}){const t=e.getSize(cf);this.value=.5*t.y});class gf extends qp{constructor(){super(),this.shadowNode=tn(1).toVar("shadowMask")}direct({lightNode:e}){null!==e.shadowNode&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){Rn.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(Rn.rgb)}}const mf=new _e;class ff extends Sp{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(mf),this.setValues(e)}setupLightingModel(){return new gf}}const yf=Sn("vec3"),bf=Sn("vec3"),xf=Sn("vec3");class Tf extends qp{constructor(){super()}start(e){const{material:t,context:r}=e,s=Sn("vec3"),i=Sn("vec3");Zi(Ol.sub(cd).length().greaterThan(td.mul(2)),()=>{s.assign(Ol),i.assign(cd)}).Else(()=>{s.assign(cd),i.assign(Ol)});const n=i.sub(s),a=oa("int").onRenderUpdate(({material:e})=>e.steps),o=n.length().div(a).toVar(),u=n.normalize().toVar(),l=tn(0).toVar(),d=dn(1).toVar();t.offsetNode&&l.addAssign(t.offsetNode.mul(o)),Uh(a,()=>{const i=s.add(u.mul(l)),n=Dl.mul(gn(i,1)).xyz;let a;null!==t.depthNode&&(bf.assign(lp(ip(n.z,Bl,Ll))),r.sceneDepthNode=lp(t.depthNode).toVar()),r.positionWorld=i,r.shadowPositionWorld=i,r.positionView=n,yf.assign(0),t.scatteringNode&&(a=t.scatteringNode({positionRay:i})),super.start(e),a&&yf.mulAssign(a);const c=yf.mul(.01).negate().mul(o).exp();d.mulAssign(c),l.addAssign(o)}),xf.addAssign(d.saturate().oneMinus())}scatteringLight(e,t){const r=t.context.sceneDepthNode;r?Zi(r.greaterThanEqual(bf),()=>{yf.addAssign(e)}):yf.addAssign(e)}direct({lightNode:e,lightColor:t},r){if(void 0===e.light.distance)return;const s=t.xyz.toVar();s.mulAssign(e.shadowNode),this.scatteringLight(s,r)}directRectArea({lightColor:e,lightPosition:t,halfWidth:r,halfHeight:s},i){const n=t.add(r).sub(s),a=t.sub(r).sub(s),o=t.sub(r).add(s),u=t.add(r).add(s),l=i.context.positionView,d=e.xyz.mul(Ng({P:l,p0:n,p1:a,p2:o,p3:u})).pow(1.5);this.scatteringLight(d,i)}finish(e){e.context.outgoingLight.assign(xf)}}class _f extends Sp{static get type(){return"VolumeNodeMaterial"}constructor(e){super(),this.isVolumeNodeMaterial=!0,this.steps=25,this.offsetNode=null,this.scatteringNode=null,this.lights=!0,this.transparent=!0,this.side=S,this.depthTest=!1,this.depthWrite=!1,this.setValues(e)}setupLightingModel(){return new Tf}}class vf{constructor(e,t){this.nodes=e,this.info=t,this._context="undefined"!=typeof self?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,r)=>{this._requestId=this._context.requestAnimationFrame(e),!0===this.info.autoReset&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,null!==this._animationLoop&&this._animationLoop(t,r)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class Nf{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(t=t.get(e[r]),void 0===t)return;return t.get(e[e.length-1])}set(e,t){let r=this.weakMap;for(let t=0;t<e.length-1;t++){const s=e[t];!1===r.has(s)&&r.set(s,new WeakMap),r=r.get(s)}return r.set(e[e.length-1],t),this}delete(e){let t=this.weakMap;for(let r=0;r<e.length-1;r++)if(t=t.get(e[r]),void 0===t)return!1;return t.delete(e[e.length-1])}}let Sf=0;class Ef{constructor(e,t,r,s,i,n,a,o,u,l){this.id=Sf++,this._nodes=e,this._geometries=t,this.renderer=r,this.object=s,this.material=i,this.scene=n,this.camera=a,this.lightsNode=o,this.context=u,this.geometry=s.geometry,this.version=i.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=l,this.clippingContextCacheKey=null!==l?l.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return null!==this.clippingContext&&this.clippingContext.cacheKey!==this.clippingContextCacheKey&&(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return!0===this.material.hardwareClipping?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(null!==this.attributes)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,r=[],s=new Set,i={};for(const n of e){let e;if(n.node&&n.node.attribute?e=n.node.attribute:(e=t.getAttribute(n.name),i[n.name]=e.version),void 0===e)continue;r.push(e);const a=e.isInterleavedBufferAttribute?e.data:e;s.add(a)}return this.attributes=r,this.attributesId=i,this.vertexBuffers=Array.from(s.values()),r}getVertexBuffers(){return null===this.vertexBuffers&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:r,group:s,drawRange:i}=this,n=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),a=this.getIndex(),o=null!==a;let u=1;if(!0===r.isInstancedBufferGeometry?u=r.instanceCount:void 0!==e.count&&(u=Math.max(0,e.count)),0===u)return null;if(n.instanceCount=u,!0===e.isBatchedMesh)return n;let l=1;!0!==t.wireframe||e.isPoints||e.isLineSegments||e.isLine||e.isLineLoop||(l=2);let d=i.start*l,c=(i.start+i.count)*l;null!==s&&(d=Math.max(d,s.start*l),c=Math.min(c,(s.start+s.count)*l));const h=r.attributes.position;let p=1/0;o?p=a.count:null!=h&&(p=h.count),d=Math.max(d,0),c=Math.min(c,p);const g=c-d;return g<0||g===1/0?null:(n.vertexCount=g,n.firstVertex=d,n)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const r of Object.keys(e.attributes).sort()){const s=e.attributes[r];t+=r+",",s.data&&(t+=s.data.stride+","),s.offset&&(t+=s.offset+","),s.itemSize&&(t+=s.itemSize+","),s.normalized&&(t+="n,")}for(const r of Object.keys(e.morphAttributes).sort()){const s=e.morphAttributes[r];t+="morph-"+r+",";for(let e=0,r=s.length;e<r;e++){t+=s[e].id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t,renderer:r}=this;let s=t.customProgramCacheKey();for(const e of function(e){const t=Object.keys(e);let r=Object.getPrototypeOf(e);for(;r;){const e=Object.getOwnPropertyDescriptors(r);for(const r in e)if(void 0!==e[r]){const s=e[r];s&&"function"==typeof s.get&&t.push(r)}r=Object.getPrototypeOf(r)}return t}(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(e))continue;const i=t[e];let n;if(null!==i){const e=typeof i;"number"===e?n=0!==i?"1":"0":"object"===e?(n="{",i.isTexture&&(n+=i.mapping,!0===r.backend.isWebGPUBackend&&(n+=i.magFilter,n+=i.minFilter,n+=i.wrapS,n+=i.wrapT,n+=i.wrapR)),n+="}"):n=String(i)}else n=String(i);s+=n+","}return s+=this.clippingContextCacheKey+",",e.geometry&&(s+=this.getGeometryCacheKey()),e.skeleton&&(s+=e.skeleton.bones.length+","),e.isBatchedMesh&&(s+=e._matricesTexture.uuid+",",null!==e._colorsTexture&&(s+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1)&&(s+=e.uuid+","),s+=e.receiveShadow+",",vs(s)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(null!==this.attributes){const e=this.attributesId;for(const t in e){const r=this.geometry.getAttribute(t);if(void 0===r||e[t]!==r.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return!0!==this.material.isShadowPassMaterial&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=Ss(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=Ss(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const Rf=[];class Af{constructor(e,t,r,s,i,n){this.renderer=e,this.nodes=t,this.geometries=r,this.pipelines=s,this.bindings=i,this.info=n,this.chainMaps={}}get(e,t,r,s,i,n,a,o){const u=this.getChainMap(o);Rf[0]=e,Rf[1]=t,Rf[2]=n,Rf[3]=i;let l=u.get(Rf);return void 0===l?(l=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,r,s,i,n,a,o),u.set(Rf,l)):(l.updateClipping(a),l.needsGeometryUpdate&&l.setGeometry(e.geometry),(l.version!==t.version||l.needsUpdate)&&(l.initialCacheKey!==l.getCacheKey()?(l.dispose(),l=this.get(e,t,r,s,i,n,a,o)):l.version=t.version)),Rf.length=0,l}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new Nf)}dispose(){this.chainMaps={}}createRenderObject(e,t,r,s,i,n,a,o,u,l,d){const c=this.getChainMap(d),h=new Ef(e,t,r,s,i,n,a,o,u,l);return h.onDispose=()=>{this.pipelines.delete(h),this.bindings.delete(h),this.nodes.delete(h),c.delete(h.getChainArray())},h}}class wf{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const Cf=1,Mf=2,Pf=3,Bf=4,Lf=16;class Ff extends wf{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return null!==t&&this.backend.destroyAttribute(e),t}update(e,t){const r=this.get(e);if(void 0===r.version)t===Cf?this.backend.createAttribute(e):t===Mf?this.backend.createIndexAttribute(e):t===Pf?this.backend.createStorageAttribute(e):t===Bf&&this.backend.createIndirectStorageAttribute(e),r.version=this._getBufferAttribute(e).version;else{const t=this._getBufferAttribute(e);(r.version<t.version||t.usage===y)&&(this.backend.updateAttribute(e),r.version=t.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function If(e){return null!==e.index?e.index.version:e.attributes.position.version}function Df(e){const t=[],r=e.index,s=e.attributes.position;if(null!==r){const e=r.array;for(let r=0,s=e.length;r<s;r+=3){const s=e[r+0],i=e[r+1],n=e[r+2];t.push(s,i,i,n,n,s)}}else{for(let e=0,r=s.array.length/3-1;e<r;e+=3){const r=e+0,s=e+1,i=e+2;t.push(r,s,s,i,i,r)}}const i=new(Se(t)?ve:Ne)(t,1);return i.version=If(e),i}class Uf extends wf{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&!0===this.get(t).initialized}updateForRender(e){!1===this.has(e)&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry;this.get(t).initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,i=e.getAttributes();null!==s&&this.attributes.delete(s);for(const e of i)this.attributes.delete(e);const n=this.wireframes.get(t);void 0!==n&&this.attributes.delete(n),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const e of t)e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute?this.updateAttribute(e,Pf):this.updateAttribute(e,Cf);const r=this.getIndex(e);null!==r&&this.updateAttribute(r,Mf);const s=e.geometry.indirect;null!==s&&this.updateAttribute(s,Bf)}updateAttribute(e,t){const r=this.info.render.calls;e.isInterleavedBufferAttribute?void 0===this.attributeCall.get(e)?(this.attributes.update(e,t),this.attributeCall.set(e,r)):this.attributeCall.get(e.data)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e.data,r),this.attributeCall.set(e,r)):this.attributeCall.get(e)!==r&&(this.attributes.update(e,t),this.attributeCall.set(e,r))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:r}=e;let s=t.index;if(!0===r.wireframe){const e=this.wireframes;let r=e.get(t);void 0===r?(r=Df(t),e.set(t,r)):r.version!==If(t)&&(this.attributes.delete(r),r=Df(t),e.set(t,r)),s=r}return s}}class Vf{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,r){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=r*(t/3):e.isPoints?this.render.points+=r*t:e.isLineSegments?this.render.lines+=r*(t/2):e.isLine?this.render.lines+=r*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class Of{constructor(e){this.cacheKey=e,this.usedTimes=0}}class Gf extends Of{constructor(e,t,r){super(e),this.vertexProgram=t,this.fragmentProgram=r}}class kf extends Of{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let zf=0;class $f{constructor(e,t,r,s=null,i=null){this.id=zf++,this.code=e,this.stage=t,this.name=r,this.transforms=s,this.attributes=i,this.usedTimes=0}}class Hf extends wf{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:r}=this,s=this.get(e);if(this._needsComputeUpdate(e)){const i=s.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);const n=this.nodes.getForCompute(e);let a=this.programs.compute.get(n.computeShader);void 0===a&&(i&&0===i.computeProgram.usedTimes&&this._releaseProgram(i.computeProgram),a=new $f(n.computeShader,"compute",e.name,n.transforms,n.nodeAttributes),this.programs.compute.set(n.computeShader,a),r.createProgram(a));const o=this._getComputeCacheKey(e,a);let u=this.caches.get(o);void 0===u&&(i&&0===i.usedTimes&&this._releasePipeline(i),u=this._getComputePipeline(e,a,o,t)),u.usedTimes++,a.usedTimes++,s.version=e.version,s.pipeline=u}return s.pipeline}getForRender(e,t=null){const{backend:r}=this,s=this.get(e);if(this._needsRenderUpdate(e)){const i=s.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);const n=e.getNodeBuilderState(),a=e.material?e.material.name:"";let o=this.programs.vertex.get(n.vertexShader);void 0===o&&(i&&0===i.vertexProgram.usedTimes&&this._releaseProgram(i.vertexProgram),o=new $f(n.vertexShader,"vertex",a),this.programs.vertex.set(n.vertexShader,o),r.createProgram(o));let u=this.programs.fragment.get(n.fragmentShader);void 0===u&&(i&&0===i.fragmentProgram.usedTimes&&this._releaseProgram(i.fragmentProgram),u=new $f(n.fragmentShader,"fragment",a),this.programs.fragment.set(n.fragmentShader,u),r.createProgram(u));const l=this._getRenderCacheKey(e,o,u);let d=this.caches.get(l);void 0===d?(i&&0===i.usedTimes&&this._releasePipeline(i),d=this._getRenderPipeline(e,o,u,l,t)):e.pipeline=d,d.usedTimes++,o.usedTimes++,u.usedTimes++,s.pipeline=d}return s.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,0===t.usedTimes&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,0===t.computeProgram.usedTimes&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,0===t.vertexProgram.usedTimes&&this._releaseProgram(t.vertexProgram),0===t.fragmentProgram.usedTimes&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,r,s){r=r||this._getComputeCacheKey(e,t);let i=this.caches.get(r);return void 0===i&&(i=new kf(r,t),this.caches.set(r,i),this.backend.createComputePipeline(i,s)),i}_getRenderPipeline(e,t,r,s,i){s=s||this._getRenderCacheKey(e,t,r);let n=this.caches.get(s);return void 0===n&&(n=new Gf(s,t,r),this.caches.set(s,n),e.pipeline=n,this.backend.createRenderPipeline(e,i)),n}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,r){return t.id+","+r.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,r=e.stage;this.programs[r].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return void 0===t.pipeline||t.version!==e.version}_needsRenderUpdate(e){return void 0===this.get(e).pipeline||this.backend.needsRenderUpdate(e)}}class Wf extends wf{constructor(e,t,r,s,i,n){super(),this.backend=e,this.textures=r,this.pipelines=i,this.attributes=s,this.nodes=t,this.info=n,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const e of t){const r=this.get(e);void 0===r.bindGroup&&(this._init(e),this.backend.createBindings(e,t,0),r.bindGroup=e)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const e of t){const r=this.get(e);void 0===r.bindGroup&&(this._init(e),this.backend.createBindings(e,t,0),r.bindGroup=e)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const e=t.attribute,r=e.isIndirectStorageBufferAttribute?Bf:Pf;this.attributes.update(e,r)}}_update(e,t){const{backend:r}=this;let s=!1,i=!0,n=0,a=0;for(const t of e.bindings){if(t.isNodeUniformsGroup){if(!1===this.nodes.updateGroup(t))continue}if(t.isStorageBuffer){const e=t.attribute,r=e.isIndirectStorageBufferAttribute?Bf:Pf;this.attributes.update(e,r)}if(t.isUniformBuffer){t.update()&&r.updateBinding(t)}else if(t.isSampledTexture){const e=t.update(),o=t.texture,u=this.textures.get(o);e&&(this.textures.updateTexture(o),t.generation!==u.generation&&(t.generation=u.generation,s=!0,i=!1));if(void 0!==r.get(o).externalTexture||u.isDefaultTexture?i=!1:(n=10*n+o.id,a+=o.version),!0===o.isStorageTexture){const e=this.get(o);!0===t.store?e.needsMipmap=!0:this.textures.needsMipmaps(o)&&!0===e.needsMipmap&&(this.backend.generateMipmaps(o),e.needsMipmap=!1)}}else t.isSampler&&t.update()}!0===s&&this.backend.updateBindings(e,t,i?n:0,a)}}function qf(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?e.z-t.z:e.id-t.id}function jf(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Xf(e){return(e.transmission>0||e.transmissionNode)&&e.side===E&&!1===e.forceSinglePass}class Kf{constructor(e,t,r){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,r),this.lightsArray=[],this.scene=t,this.camera=r,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,r,s,i,n,a){let o=this.renderItems[this.renderItemsIndex];return void 0===o?(o={id:e.id,object:e,geometry:t,material:r,groupOrder:s,renderOrder:e.renderOrder,z:i,group:n,clippingContext:a},this.renderItems[this.renderItemsIndex]=o):(o.id=e.id,o.object=e,o.geometry=t,o.material=r,o.groupOrder=s,o.renderOrder=e.renderOrder,o.z=i,o.group=n,o.clippingContext=a),this.renderItemsIndex++,o}push(e,t,r,s,i,n,a){const o=this.getNextRenderItem(e,t,r,s,i,n,a);!0===e.occlusionTest&&this.occlusionQueryCount++,!0===r.transparent||r.transmission>0?(Xf(r)&&this.transparentDoublePass.push(o),this.transparent.push(o)):this.opaque.push(o)}unshift(e,t,r,s,i,n,a){const o=this.getNextRenderItem(e,t,r,s,i,n,a);!0===r.transparent||r.transmission>0?(Xf(r)&&this.transparentDoublePass.unshift(o),this.transparent.unshift(o)):this.opaque.unshift(o)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||qf),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||jf),this.transparent.length>1&&this.transparent.sort(t||jf)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const t=this.renderItems[e];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.groupOrder=null,t.renderOrder=null,t.z=null,t.group=null,t.clippingContext=null}}}const Yf=[];class Qf{constructor(e){this.lighting=e,this.lists=new Nf}get(e,t){const r=this.lists;Yf[0]=e,Yf[1]=t;let s=r.get(Yf);return void 0===s&&(s=new Kf(this.lighting,e,t),r.set(Yf,s)),Yf.length=0,s}dispose(){this.lists=new Nf}}let Zf=0;class Jf{constructor(){this.id=Zf++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new s,this.scissor=!1,this.scissorValue=new s,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return ey(this)}}function ey(e){const{textures:t,activeCubeFace:r,activeMipmapLevel:s}=e,i=[r,s];for(const e of t)i.push(e.id);return Ns(i)}const ty=[],ry=new K,sy=new Ee;class iy{constructor(){this.chainMaps={}}get(e,t,r=null){let s;if(ty[0]=e,ty[1]=t,null===r)s="default";else{const e=r.texture.format;s=`${r.textures.length}:${e}:${r.samples}:${r.depthBuffer}:${r.stencilBuffer}`}const i=this._getChainMap(s);let n=i.get(ty);return void 0===n&&(n=new Jf,i.set(ty,n)),ty.length=0,null!==r&&(n.sampleCount=0===r.samples?1:r.samples),n}getForClear(e=null){return this.get(ry,sy,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new Nf)}dispose(){this.chainMaps={}}}const ny=new r;class ay extends wf{constructor(e,t,r){super(),this.renderer=e,this.backend=t,this.info=r}updateRenderTarget(e,t=0){const r=this.get(e),s=0===e.samples?1:e.samples,i=r.depthTextureMips||(r.depthTextureMips={}),n=e.textures,a=this.getSize(n[0]),o=a.width>>t,u=a.height>>t;let l=e.depthTexture||i[t];const d=!0===e.depthBuffer||!0===e.stencilBuffer;let c=!1;void 0===l&&d&&(l=new V,l.format=e.stencilBuffer?Re:Ae,l.type=e.stencilBuffer?we:T,l.image.width=o,l.image.height=u,l.image.depth=a.depth,l.isArrayTexture=!0===e.multiview&&a.depth>1,i[t]=l),r.width===a.width&&a.height===r.height||(c=!0,l&&(l.needsUpdate=!0,l.image.width=o,l.image.height=u,l.image.depth=l.isArrayTexture?l.image.depth:1)),r.width=a.width,r.height=a.height,r.textures=n,r.depthTexture=l||null,r.depth=e.depthBuffer,r.stencil=e.stencilBuffer,r.renderTarget=e,r.sampleCount!==s&&(c=!0,l&&(l.needsUpdate=!0),r.sampleCount=s);const h={sampleCount:s};if(!0!==e.isXRRenderTarget){for(let e=0;e<n.length;e++){const t=n[e];c&&(t.needsUpdate=!0),this.updateTexture(t,h)}l&&this.updateTexture(l,h)}if(!0!==r.initialized){r.initialized=!0;const t=()=>{e.removeEventListener("dispose",t);for(let e=0;e<n.length;e++)this._destroyTexture(n[e]);l&&this._destroyTexture(l),this.delete(e),this.backend.delete(e)};e.addEventListener("dispose",t)}}updateTexture(e,t={}){const r=this.get(e);if(!0===r.initialized&&r.version===e.version)return;const s=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,i=this.backend;if(s&&!0===r.initialized&&(i.destroySampler(e),i.destroyTexture(e)),e.isFramebufferTexture){const t=this.renderer.getRenderTarget();e.type=t?t.texture.type:Ce}const{width:n,height:a,depth:o}=this.getSize(e);if(t.width=n,t.height=a,t.depth=o,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,n,a):1,e.isCubeTexture&&e.mipmaps.length>0&&t.levels++,s||!0===e.isStorageTexture||!0===e.isExternalTexture)i.createSampler(e),i.createTexture(e,t),r.generation=e.version;else{if(!0!==r.initialized&&i.createSampler(e),e.version>0){const s=e.image;if(void 0===s)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(!1===s.complete)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const r=[];for(const t of e.images)r.push(t);t.images=r}else t.image=s;void 0!==r.isDefaultTexture&&!0!==r.isDefaultTexture||(i.createTexture(e,t),r.isDefaultTexture=!1,r.generation=e.version),!0===e.source.dataReady&&i.updateTexture(e,t),t.needsMipmaps&&0===e.mipmaps.length&&i.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}else i.createDefaultTexture(e),r.isDefaultTexture=!0,r.generation=e.version}if(!0!==r.initialized){r.initialized=!0,r.generation=e.version,this.info.memory.textures++,e.isVideoTexture&&c.getTransfer(e.colorSpace)!==h&&console.warn("WebGPURenderer: Video textures must use a color space with a sRGB transfer function, e.g. SRGBColorSpace.");const t=()=>{e.removeEventListener("dispose",t),this._destroyTexture(e)};e.addEventListener("dispose",t)}r.version=e.version}getSize(e,t=ny){let r=e.images?e.images[0]:e.image;return r?(void 0!==r.image&&(r=r.image),"undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement?(t.width=r.videoWidth||1,t.height=r.videoHeight||1,t.depth=1):r instanceof VideoFrame?(t.width=r.displayWidth||1,t.height=r.displayHeight||1,t.depth=1):(t.width=r.width||1,t.height=r.height||1,t.depth=e.isCubeTexture?6:r.depth||1)):t.width=t.height=t.depth=1,t}getMipLevels(e,t,r){let s;return s=e.mipmaps.length>0?e.mipmaps.length:!0===e.isCompressedTexture?1:Math.floor(Math.log2(Math.max(t,r)))+1,s}needsMipmaps(e){return!0===e.generateMipmaps||e.mipmaps.length>0}_destroyTexture(e){!0===this.has(e)&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class oy extends e{constructor(e,t,r,s=1){super(e,t,r),this.a=s}set(e,t,r,s=1){return this.a=s,super.set(e,t,r)}copy(e){return void 0!==e.a&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class uy extends Nn{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class ly extends Ys{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.hasOutput?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.hasOutput?this.outputNode.getMemberType(e,t):"void"}add(e){return!0!==e.isNode?(console.error("THREE.TSL: Invalid node added to stack."),this):(this.nodes.push(e),this)}If(e,t){const r=new Oi(t);return this._currentCond=iu(e,r),this.add(this._currentCond)}ElseIf(e,t){const r=new Oi(t),s=iu(e,r);return this._currentCond.elseNode=s,this._currentCond=s,this}Else(e){return this._currentCond.elseNode=new Oi(e),this}Switch(e){return this._expressionNode=Gi(e),this}Case(...e){const t=[];if(e.length>=2)for(let r=0;r<e.length-1;r++)t.push(this._expressionNode.equal(Gi(e[r])));else console.error("THREE.TSL: Invalid parameter length. Case() requires at least two parameters.");const r=new Oi(e[e.length-1]);let s=t[0];for(let e=1;e<t.length;e++)s=s.or(t[e]);const i=iu(s,r);return null===this._currentCond?(this._currentCond=i,this.add(this._currentCond)):(this._currentCond.elseNode=i,this._currentCond=i,this)}Default(e){return this.Else(e),this}setup(e){const t=e.getNodeProperties(this);let r=0;for(const s of this.getChildren()){if(s.isVarNode&&!0===s.intent){if(!0!==e.getNodeProperties(s).assign)continue}t["node"+r++]=s}return t.outputNode||null}get hasOutput(){return this.outputNode&&this.outputNode.isNode}build(e,...t){const r=e.currentStack,s=Qi();Yi(this),e.currentStack=this;const i=e.buildStage;for(const t of this.nodes){if(t.isVarNode&&!0===t.intent){if(!0!==e.getNodeProperties(t).assign)continue}if("setup"===i)t.build(e);else if("analyze"===i)t.build(e,this);else if("generate"===i){const r=e.getDataFromNode(t,"any").stages,s=r&&r[e.shaderStage];if(t.isVarNode&&s&&1===s.length&&s[0]&&s[0].isStackNode)continue;t.build(e,"void")}}let n;return n=this.hasOutput?this.outputNode.build(e,...t):super.build(e,...t),Yi(s),e.currentStack=r,n}}const dy=Hi(ly).setParameterLength(0,1);class cy extends Ys{static get type(){return"StructTypeNode"}constructor(e,t=null){var r;super("struct"),this.membersLayout=(r=e,Object.entries(r).map(([e,t])=>"string"==typeof t?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})),this.name=t,this.isStructLayoutNode=!0}getLength(){const e=Float32Array.BYTES_PER_ELEMENT;let t=0;for(const r of this.membersLayout){const s=r.type,i=Bs(s)*e,n=t%8,a=n%Ls(s),o=n+a;t+=a,0!==o&&8-o<i&&(t+=8-o),t+=i}return 8*Math.ceil(t/8)/e}getMemberType(e,t){const r=this.membersLayout.find(e=>e.name===t);return r?r.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.getStructTypeFromNode(this,this.membersLayout,this.name),e.addInclude(this)}generate(e){return this.getNodeType(e)}}class hy extends Ys{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structTypeNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structTypeNode.getNodeType(e)}getMemberType(e,t){return this.structTypeNode.getMemberType(e,t)}generate(e){const t=e.getVarFromNode(this),r=t.type,s=e.getPropertyName(t);return e.addLineFlowCode(`${s} = ${e.generateStruct(r,this.structTypeNode.membersLayout,this.values)}`,this),t.name}}class py extends Ys{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const t=e.getNodeProperties(this);if(void 0===t.membersLayout){const r=this.members,s=[];for(let t=0;t<r.length;t++){const i="m"+t,n=r[t].getNodeType(e);s.push({name:i,type:n,index:t})}t.membersLayout=s,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){const t=e.getOutputStructName(),r=this.members,s=""!==t?t+".":"";for(let t=0;t<r.length;t++){const i=r[t].build(e);e.addLineFlowCode(`${s}m${t} = ${i}`,this)}return t}}const gy=Hi(py);function my(e,t){for(let r=0;r<e.length;r++)if(e[r].name===t)return r;return-1}class fy extends py{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return void 0!==this.outputNodes[e]}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes};return yy(t)}setup(e){const t=this.outputNodes,r=[],s=e.renderer.getRenderTarget().textures;for(const e in t){r[my(s,e)]=gn(t[e])}return this.members=r,super.setup(e)}}const yy=Hi(fy);class by extends Js{static get type(){return"BitcastNode"}constructor(e,t,r=null){super(),this.valueNode=e,this.conversionType=t,this.inputType=r,this.isBitcastNode=!0}getNodeType(e){if(null!==this.inputType){const t=this.valueNode.getNodeType(e),r=e.getTypeLength(t);return e.getTypeFromLength(r,this.conversionType)}return this.conversionType}generate(e){const t=this.getNodeType(e);let r="";if(null!==this.inputType){const t=this.valueNode.getNodeType(e);r=1===e.getTypeLength(t)?this.inputType:e.changeComponentType(t,this.inputType)}else r=this.valueNode.getNodeType(e);return`${e.getBitcastMethod(t,r)}( ${this.valueNode.build(e,r)} )`}}const xy=qi(by).setParameterLength(2),Ty=Ki(([e])=>{const t=e.toUint().mul(747796405).add(2891336453),r=t.shiftRight(t.shiftRight(28).add(4)).bitXor(t).mul(277803737);return r.shiftRight(22).bitXor(r).toFloat().mul(1/2**32)}),_y=(e,t)=>Uo(ba(4,e.mul(ya(1,e))),t),vy=Ki(([e])=>e.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),Ny=Ki(([e])=>dn(vy(e.z.add(vy(e.y.mul(1)))),vy(e.z.add(vy(e.x.mul(1)))),vy(e.y.add(vy(e.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Sy=Ki(([e,t,r])=>{const s=dn(e).toVar(),i=tn(1.4).toVar(),n=tn(0).toVar(),a=dn(s).toVar();return Uh({start:tn(0),end:tn(3),type:"float",condition:"<="},()=>{const e=dn(Ny(a.mul(2))).toVar();s.addAssign(e.add(r.mul(tn(.1).mul(t)))),a.mulAssign(1.8),i.mulAssign(1.5),s.mulAssign(1.2);const o=tn(vy(s.z.add(vy(s.x.add(vy(s.y)))))).toVar();n.addAssign(o.div(i)),a.addAssign(.14)}),n}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class Ey extends Ys{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFnCall=null,this.global=!0}getNodeType(){return this.functionNodes[0].shaderNode.layout.type}setup(e){const t=this.parametersNodes;let r=this._candidateFnCall;if(null===r){let s=null,i=-1;for(const r of this.functionNodes){const n=r.shaderNode.layout;if(null===n)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const a=n.inputs;if(t.length===a.length){let n=0;for(let r=0;r<t.length;r++){const s=t[r],i=a[r];s.getNodeType(e)===i.type?n++:n=0}n>i&&(s=r,i=n)}}this._candidateFnCall=r=s(...t)}return r}}const Ry=Hi(Ey),Ay=e=>(...t)=>Ry(e,...t),wy=oa(0).setGroup(ia).onRenderUpdate(e=>e.time),Cy=oa(0).setGroup(ia).onRenderUpdate(e=>e.deltaTime),My=oa(0,"uint").setGroup(ia).onRenderUpdate(e=>e.frameId),Py=Ki(([e,t,r=an(.5)])=>of(e.sub(r),t).add(r)),By=Ki(([e,t,r=an(.5)])=>{const s=e.sub(r),i=s.dot(s),n=i.mul(i).mul(t);return e.add(s.mul(n))}),Ly=Ki(({position:e=null,horizontal:t=!0,vertical:r=!1})=>{let s;null!==e?(s=Ql.toVar(),s[3][0]=e.x,s[3][1]=e.y,s[3][2]=e.z):s=Ql;const i=Dl.mul(s);return Ui(t)&&(i[0][0]=Ql[0].length(),i[0][1]=0,i[0][2]=0),Ui(r)&&(i[1][0]=0,i[1][1]=Ql[1].length(),i[1][2]=0),i[2][0]=0,i[2][1]=0,i[2][2]=1,Fl.mul(i).mul(ld)}),Fy=Ki(([e=null])=>{const t=lp();return lp(tp(e)).sub(t).lessThan(0).select(Nl,e)});class Iy extends Ys{static get type(){return"SpriteSheetUVNode"}constructor(e,t=sl(),r=tn(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=r}setup(){const{frameNode:e,uvNode:t,countNode:r}=this,{width:s,height:i}=r,n=e.mod(s.mul(i)).floor(),a=n.mod(s),o=i.sub(n.add(1).div(s).ceil()),u=r.reciprocal(),l=an(a,o);return t.add(l).mul(u)}}const Dy=Hi(Iy).setParameterLength(3),Uy=Ki(([e,t=null,r=null,s=tn(1),i=ld,n=Td])=>{let a=n.abs().normalize();a=a.div(a.dot(dn(1)));const o=i.yz.mul(s),u=i.zx.mul(s),l=i.xy.mul(s),d=e.value,c=null!==t?t.value:d,h=null!==r?r.value:d,p=cl(d,o).mul(a.x),g=cl(c,u).mul(a.y),m=cl(h,l).mul(a.z);return fa(p,g,m)}),Vy=new Me,Oy=new r,Gy=new r,ky=new r,zy=new a,$y=new r(0,0,-1),Hy=new s,Wy=new r,qy=new r,jy=new s,Xy=new t,Ky=new ue,Yy=Nl.flipX();Ky.depthTexture=new V(1,1);let Qy=!1;class Zy extends ll{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||Ky.texture,Yy),this._reflectorBaseNode=e.reflector||new Jy(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(null===this._depthNode){if(!0!==this._reflectorBaseNode.depth)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=Gi(new Zy({defaultTexture:Ky.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class Jy extends Ys{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:r=new Pe,resolutionScale:s=1,generateMipmaps:i=!1,bounces:n=!0,depth:a=!1,samples:o=0}=t;this.textureNode=e,this.target=r,this.resolutionScale=s,void 0!==t.resolution&&(Be('THREE.ReflectorNode: The "resolution" parameter has been renamed to "resolutionScale".'),this.resolutionScale=t.resolution),this.generateMipmaps=i,this.bounces=n,this.depth=a,this.samples=o,this.updateBeforeType=n?ks.RENDER:ks.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}_updateResolution(e,t){const r=this.resolutionScale;t.getDrawingBufferSize(Xy),e.setSize(Math.round(Xy.width*r),Math.round(Xy.height*r))}setup(e){return this._updateResolution(Ky,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return void 0===t&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return void 0===t&&(t=new ue(0,0,{type:ce,samples:this.samples}),!0===this.generateMipmaps&&(t.texture.minFilter=Le,t.texture.generateMipmaps=!0),!0===this.depth&&(t.depthTexture=new V),this.renderTargets.set(e,t)),t}updateBefore(e){if(!1===this.bounces&&Qy)return!1;Qy=!0;const{scene:t,camera:r,renderer:s,material:i}=e,{target:n}=this,a=this.getVirtualCamera(r),o=this.getRenderTarget(a);s.getDrawingBufferSize(Xy),this._updateResolution(o,s),Gy.setFromMatrixPosition(n.matrixWorld),ky.setFromMatrixPosition(r.matrixWorld),zy.extractRotation(n.matrixWorld),Oy.set(0,0,1),Oy.applyMatrix4(zy),Wy.subVectors(Gy,ky);let u=!1;if(!0===Wy.dot(Oy)>0&&!1===this.forceUpdate){if(!1===this.hasOutput)return void(Qy=!1);u=!0}Wy.reflect(Oy).negate(),Wy.add(Gy),zy.extractRotation(r.matrixWorld),$y.set(0,0,-1),$y.applyMatrix4(zy),$y.add(ky),qy.subVectors(Gy,$y),qy.reflect(Oy).negate(),qy.add(Gy),a.coordinateSystem=r.coordinateSystem,a.position.copy(Wy),a.up.set(0,1,0),a.up.applyMatrix4(zy),a.up.reflect(Oy),a.lookAt(qy),a.near=r.near,a.far=r.far,a.updateMatrixWorld(),a.projectionMatrix.copy(r.projectionMatrix),Vy.setFromNormalAndCoplanarPoint(Oy,Gy),Vy.applyMatrix4(a.matrixWorldInverse),Hy.set(Vy.normal.x,Vy.normal.y,Vy.normal.z,Vy.constant);const l=a.projectionMatrix;jy.x=(Math.sign(Hy.x)+l.elements[8])/l.elements[0],jy.y=(Math.sign(Hy.y)+l.elements[9])/l.elements[5],jy.z=-1,jy.w=(1+l.elements[10])/l.elements[14],Hy.multiplyScalar(1/Hy.dot(jy));l.elements[2]=Hy.x,l.elements[6]=Hy.y,l.elements[10]=s.coordinateSystem===d?Hy.z-0:Hy.z+1-0,l.elements[14]=Hy.w,this.textureNode.value=o.texture,!0===this.depth&&(this.textureNode.getDepthNode().value=o.depthTexture),i.visible=!1;const c=s.getRenderTarget(),h=s.getMRT(),p=s.autoClear;s.setMRT(null),s.setRenderTarget(o),s.autoClear=!0,u?(s.clear(),this.hasOutput=!1):(s.render(t,a),this.hasOutput=!0),s.setMRT(h),s.setRenderTarget(c),s.autoClear=p,i.visible=!0,Qy=!1,this.forceUpdate=!1}get resolution(){return Be('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale}set resolution(e){Be('THREE.ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale=e}}const eb=new ae(-1,1,1,-1,0,1);class tb extends pe{constructor(e=!1){super();const t=!1===e?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Fe([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Fe(t,2))}}const rb=new tb;class sb extends X{constructor(e=null){super(rb,e),this.camera=eb,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,eb)}render(e){e.render(this,eb)}}const ib=new t;class nb extends ll{static get type(){return"RTTNode"}constructor(e,t=null,r=null,s={type:ce}){const i=new ue(t,r,s);super(i.texture,sl()),this.isRTTNode=!0,this.node=e,this.width=t,this.height=r,this.pixelRatio=1,this.renderTarget=i,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new sb(new Sp),this.updateBeforeType=ks.RENDER}get autoResize(){return null===this.width}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const r=e*this.pixelRatio,s=t*this.pixelRatio;this.renderTarget.setSize(r,s),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(!1===this.textureNeedsUpdate&&!1===this.autoUpdate)return;if(this.textureNeedsUpdate=!1,!0===this.autoResize){const t=e.getPixelRatio(),r=e.getSize(ib),s=r.width*t,i=r.height*t;s===this.renderTarget.width&&i===this.renderTarget.height||(this.renderTarget.setSize(s,i),this.textureNeedsUpdate=!0)}this._quadMesh.material.fragmentNode=this._rttNode;const t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(t)}clone(){const e=new ll(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const ab=(e,...t)=>Gi(new nb(Gi(e),...t)),ob=Ki(([e,t,r],s)=>{let i;s.renderer.coordinateSystem===d?(e=an(e.x,e.y.oneMinus()).mul(2).sub(1),i=gn(dn(e,t),1)):i=gn(dn(e.x,e.y.oneMinus(),t).mul(2).sub(1),1);const n=gn(r.mul(i));return n.xyz.div(n.w)}),ub=Ki(([e,t])=>{const r=t.mul(gn(e,1)),s=r.xy.div(r.w).mul(.5).add(.5).toVar();return an(s.x,s.y.oneMinus())}),lb=Ki(([e,t,r])=>{const s=nl(hl(t)),i=on(e.mul(s)).toVar(),n=hl(t,i).toVar(),a=hl(t,i.sub(on(2,0))).toVar(),o=hl(t,i.sub(on(1,0))).toVar(),u=hl(t,i.add(on(1,0))).toVar(),l=hl(t,i.add(on(2,0))).toVar(),d=hl(t,i.add(on(0,2))).toVar(),c=hl(t,i.add(on(0,1))).toVar(),h=hl(t,i.sub(on(0,1))).toVar(),p=hl(t,i.sub(on(0,2))).toVar(),g=go(ya(tn(2).mul(o).sub(a),n)).toVar(),m=go(ya(tn(2).mul(u).sub(l),n)).toVar(),f=go(ya(tn(2).mul(c).sub(d),n)).toVar(),y=go(ya(tn(2).mul(h).sub(p),n)).toVar(),b=ob(e,n,r).toVar(),x=g.lessThan(m).select(b.sub(ob(e.sub(an(tn(1).div(s.x),0)),o,r)),b.negate().add(ob(e.add(an(tn(1).div(s.x),0)),u,r))),T=f.lessThan(y).select(b.sub(ob(e.add(an(0,tn(1).div(s.y))),c,r)),b.negate().add(ob(e.sub(an(0,tn(1).div(s.y))),h,r)));return no(Do(x,T))});class db extends Ys{static get type(){return"SampleNode"}constructor(e,t=null){super(),this.callback=e,this.uvNode=t,this.isSampleNode=!0}setup(){return this.sample(sl())}sample(e){return this.callback(e)}}class cb extends Ys{static get type(){return"EventNode"}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===cb.OBJECT?this.updateType=ks.OBJECT:e===cb.MATERIAL&&(this.updateType=ks.RENDER)}update(e){this.callback(e)}}cb.OBJECT="object",cb.MATERIAL="material";const hb=(e,t)=>Gi(new cb(e,t)).toStack();class pb extends L{constructor(e,t,r=Float32Array){super(ArrayBuffer.isView(e)?e:new r(e*t),t),this.isStorageInstancedBufferAttribute=!0}}class gb extends ge{constructor(e,t,r=Float32Array){super(ArrayBuffer.isView(e)?e:new r(e*t),t),this.isStorageBufferAttribute=!0}}class mb extends Ys{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const fb=Wi(mb),yb=new R,bb=new a;class xb extends Ys{static get type(){return"SceneNode"}constructor(e=xb.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,r=null!==this.scene?this.scene:e.scene;let s;return t===xb.BACKGROUND_BLURRINESS?s=jd("backgroundBlurriness","float",r):t===xb.BACKGROUND_INTENSITY?s=jd("backgroundIntensity","float",r):t===xb.BACKGROUND_ROTATION?s=oa("mat4").setName("backgroundRotation").setGroup(ia).onRenderUpdate(()=>{const e=r.background;return null!==e&&e.isTexture&&e.mapping!==Ie?(yb.copy(r.backgroundRotation),yb.x*=-1,yb.y*=-1,yb.z*=-1,bb.makeRotationFromEuler(yb)):bb.identity(),bb}):console.error("THREE.SceneNode: Unknown scope:",t),s}}xb.BACKGROUND_BLURRINESS="backgroundBlurriness",xb.BACKGROUND_INTENSITY="backgroundIntensity",xb.BACKGROUND_ROTATION="backgroundRotation";const Tb=Wi(xb,xb.BACKGROUND_BLURRINESS),_b=Wi(xb,xb.BACKGROUND_INTENSITY),vb=Wi(xb,xb.BACKGROUND_ROTATION);class Nb extends ll{static get type(){return"StorageTextureNode"}constructor(e,t,r=null){super(e,t),this.storeNode=r,this.isStorageTextureNode=!0,this.access=$s.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);return t.storeNode=this.storeNode,t}setAccess(e){return this.access=e,this}generate(e,t){let r;return r=null!==this.storeNode?this.generateStore(e):super.generate(e,t),r}toReadWrite(){return this.setAccess($s.READ_WRITE)}toReadOnly(){return this.setAccess($s.READ_ONLY)}toWriteOnly(){return this.setAccess($s.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:r,storeNode:s,depthNode:i}=t,n=super.generate(e,"property"),a=r.build(e,!0===this.value.is3DTexture?"uvec3":"uvec2"),o=s.build(e,"vec4"),u=i?i.build(e,"int"):null,l=e.generateTextureStore(e,n,a,u,o);e.addLineFlowCode(l,this)}clone(){const e=super.clone();return e.storeNode=this.storeNode,e}}const Sb=Hi(Nb).setParameterLength(1,3),Eb=Ki(({texture:e,uv:t})=>{const r=1e-4,s=dn().toVar();return Zi(t.x.lessThan(r),()=>{s.assign(dn(1,0,0))}).ElseIf(t.y.lessThan(r),()=>{s.assign(dn(0,1,0))}).ElseIf(t.z.lessThan(r),()=>{s.assign(dn(0,0,1))}).ElseIf(t.x.greaterThan(.9999),()=>{s.assign(dn(-1,0,0))}).ElseIf(t.y.greaterThan(.9999),()=>{s.assign(dn(0,-1,0))}).ElseIf(t.z.greaterThan(.9999),()=>{s.assign(dn(0,0,-1))}).Else(()=>{const r=.01,i=e.sample(t.add(dn(-.01,0,0))).r.sub(e.sample(t.add(dn(r,0,0))).r),n=e.sample(t.add(dn(0,-.01,0))).r.sub(e.sample(t.add(dn(0,r,0))).r),a=e.sample(t.add(dn(0,0,-.01))).r.sub(e.sample(t.add(dn(0,0,r))).r);s.assign(dn(i,n,a))}),s.normalize()});class Rb extends ll{static get type(){return"Texture3DNode"}constructor(e,t=null,r=null){super(e,t,r),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return dn(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const r=this.value;return!e.isFlipY()||!0!==r.isRenderTargetTexture&&!0!==r.isFramebufferTexture||(t=this.sampler?t.flipY():t.setY(rn(nl(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,"vec3")}generateOffset(e,t){return t.build(e,"ivec3")}normal(e){return Eb({texture:this,uv:e})}}const Ab=Hi(Rb).setParameterLength(1,3);class wb extends qd{static get type(){return"UserDataNode"}constructor(e,t,r=null){super(e,t,r),this.userData=r}updateReference(e){return this.reference=null!==this.userData?this.userData:e.object.userData,this.reference}}const Cb=new WeakMap;class Mb extends Js{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=ks.OBJECT,this.updateAfterType=ks.OBJECT,this.previousModelWorldMatrix=oa(new a),this.previousProjectionMatrix=oa(new a).setGroup(ia),this.previousCameraViewMatrix=oa(new a)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:r}){const s=Bb(r);this.previousModelWorldMatrix.value.copy(s);const i=Pb(t);i.frameId!==e&&(i.frameId=e,void 0===i.previousProjectionMatrix?(i.previousProjectionMatrix=new a,i.previousCameraViewMatrix=new a,i.currentProjectionMatrix=new a,i.currentCameraViewMatrix=new a,i.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),i.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(i.previousProjectionMatrix.copy(i.currentProjectionMatrix),i.previousCameraViewMatrix.copy(i.currentCameraViewMatrix)),i.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),i.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(i.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(i.previousCameraViewMatrix))}updateAfter({object:e}){Bb(e).copy(e.matrixWorld)}setup(){const e=null===this.projectionMatrix?Fl:oa(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),r=e.mul(id).mul(ld),s=this.previousProjectionMatrix.mul(t).mul(dd),i=r.xy.div(r.w),n=s.xy.div(s.w);return ya(i,n)}}function Pb(e){let t=Cb.get(e);return void 0===t&&(t={},Cb.set(e,t)),t}function Bb(e,t=0){const r=Pb(e);let s=r[t];return void 0===s&&(r[t]=s=new a,r[t].copy(e.matrixWorld)),s}const Lb=Wi(Mb),Fb=Ki(([e])=>Vb(e.rgb)),Ib=Ki(([e,t=tn(1)])=>t.mix(Vb(e.rgb),e.rgb)),Db=Ki(([e,t=tn(1)])=>{const r=fa(e.r,e.g,e.b).div(3),s=e.r.max(e.g.max(e.b)),i=s.sub(r).mul(t).mul(-3);return Ho(e.rgb,s,i)}),Ub=Ki(([e,t=tn(1)])=>{const r=dn(.57735,.57735,.57735),s=t.cos();return dn(e.rgb.mul(s).add(r.cross(e.rgb).mul(t.sin()).add(r.mul(Io(r,e.rgb).mul(s.oneMinus())))))}),Vb=(e,t=dn(c.getLuminanceCoefficients(new r)))=>Io(e,t),Ob=Ki(([e,t=dn(1),s=dn(0),i=dn(1),n=tn(1),a=dn(c.getLuminanceCoefficients(new r,le))])=>{const o=e.rgb.dot(dn(a)),u=Mo(e.rgb.mul(t).add(s),0).toVar(),l=u.pow(i).toVar();return Zi(u.r.greaterThan(0),()=>{u.r.assign(l.r)}),Zi(u.g.greaterThan(0),()=>{u.g.assign(l.g)}),Zi(u.b.greaterThan(0),()=>{u.b.assign(l.b)}),u.assign(o.add(u.sub(o).mul(n))),gn(u.rgb,e.a)});class Gb extends Js{static get type(){return"PosterizeNode"}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}const kb=Hi(Gb).setParameterLength(2),zb=new t;class $b extends ll{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class Hb extends $b{static get type(){return"PassMultipleTextureNode"}constructor(e,t,r=!1){super(e,null),this.textureName=t,this.previousTexture=r}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}class Wb extends Js{static get type(){return"PassNode"}constructor(e,t,r,s={}){super("vec4"),this.scope=e,this.scene=t,this.camera=r,this.options=s,this._pixelRatio=1,this._width=1,this._height=1;const i=new V;i.isRenderTargetTexture=!0,i.name="depth";const n=new ue(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:ce,...s});n.texture.name="output",n.depthTexture=i,this.renderTarget=n,this._textures={output:n.texture,depth:i},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=oa(0),this._cameraFar=oa(0),this._mrt=null,this._layers=null,this._resolution=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=ks.FRAME,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];if(void 0===t){t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)}return t}getPreviousTexture(e){let t=this._previousTextures[e];return void 0===t&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(void 0!==t){const r=this._textures[e],s=this.renderTarget.textures.indexOf(r);this.renderTarget.textures[s]=t,this._textures[e]=t,this._previousTextures[e]=r,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return void 0===t&&(t=Gi(new Hb(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return void 0===t&&(void 0===this._textureNodes[e]&&this.getTextureNode(e),t=Gi(new Hb(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(void 0===t){const r=this._cameraNear,s=this._cameraFar;this._viewZNodes[e]=t=np(this.getTextureNode(e),r,s)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(void 0===t){const r=this._cameraNear,s=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=sp(i,r,s)}return t}async compileAsync(e){const t=e.getRenderTarget(),r=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(r)}setup({renderer:e}){return this.renderTarget.samples=void 0===this.options.samples?e.samples:this.options.samples,this.renderTarget.texture.type=e.getColorBufferType(),this.scope===Wb.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:r}=this;let s,i;const n=t.getOutputRenderTarget();n&&!0===n.isXRRenderTarget?(i=1,s=t.xr.getCamera(),t.xr.updateCamera(s),zb.set(n.width,n.height)):(s=this.camera,i=t.getPixelRatio(),t.getSize(zb)),this._pixelRatio=i,this.setSize(zb.width,zb.height);const a=t.getRenderTarget(),o=t.getMRT(),u=s.layers.mask;this._cameraNear.value=s.near,this._cameraFar.value=s.far,null!==this._layers&&(s.layers.mask=this._layers.mask);for(const e in this._previousTextures)this.toggleTexture(e);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(r,s),t.setRenderTarget(a),t.setMRT(o),s.layers.mask=u}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio*this._resolution,s=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(r,s),null!==this._scissor&&this.renderTarget.scissor.copy(this._scissor),null!==this._viewport&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,r,i){null===e?this._scissor=null:(null===this._scissor&&(this._scissor=new s),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,r,i),this._scissor.multiplyScalar(this._pixelRatio*this._resolution).floor())}setViewport(e,t,r,i){null===e?this._viewport=null:(null===this._viewport&&(this._viewport=new s),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,r,i),this._viewport.multiplyScalar(this._pixelRatio*this._resolution).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}Wb.COLOR="color",Wb.DEPTH="depth";class qb extends Wb{static get type(){return"ToonOutlinePassNode"}constructor(e,t,r,s,i){super(Wb.COLOR,e,t),this.colorNode=r,this.thicknessNode=s,this.alphaNode=i,this._materialCache=new WeakMap}updateBefore(e){const{renderer:t}=e,r=t.getRenderObjectFunction();t.setRenderObjectFunction((e,r,s,i,n,a,o,u)=>{if((n.isMeshToonMaterial||n.isMeshToonNodeMaterial)&&!1===n.wireframe){const l=this._getOutlineMaterial(n);t.renderObject(e,r,s,i,l,a,o,u)}t.renderObject(e,r,s,i,n,a,o,u)}),super.updateBefore(e),t.setRenderObjectFunction(r)}_createMaterial(){const e=new Sp;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=S;const t=Td.negate(),r=Fl.mul(id),s=tn(1),i=r.mul(gn(ld,1)),n=r.mul(gn(ld.add(t),1)),a=no(i.sub(n));return e.vertexNode=i.add(a.mul(this.thicknessNode).mul(i.w).mul(s)),e.colorNode=gn(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return void 0===t&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const jb=Ki(([e,t])=>e.mul(t).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Xb=Ki(([e,t])=>(e=e.mul(t)).div(e.add(1)).clamp()).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Kb=Ki(([e,t])=>{const r=(e=(e=e.mul(t)).sub(.004).max(0)).mul(e.mul(6.2).add(.5)),s=e.mul(e.mul(6.2).add(1.7)).add(.06);return r.div(s).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Yb=Ki(([e])=>{const t=e.mul(e.add(.0245786)).sub(90537e-9),r=e.mul(e.add(.432951).mul(.983729)).add(.238081);return t.div(r)}),Qb=Ki(([e,t])=>{const r=xn(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),s=xn(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return e=e.mul(t).div(.6),e=r.mul(e),e=Yb(e),(e=s.mul(e)).clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Zb=xn(dn(1.6605,-.1246,-.0182),dn(-.5876,1.1329,-.1006),dn(-.0728,-.0083,1.1187)),Jb=xn(dn(.6274,.0691,.0164),dn(.3293,.9195,.088),dn(.0433,.0113,.8956)),ex=Ki(([e])=>{const t=dn(e).toVar(),r=dn(t.mul(t)).toVar(),s=dn(r.mul(r)).toVar();return tn(15.5).mul(s.mul(r)).sub(ba(40.14,s.mul(t))).add(ba(31.96,s).sub(ba(6.868,r.mul(t))).add(ba(.4298,r).add(ba(.1191,t).sub(.00232))))}),tx=Ki(([e,t])=>{const r=dn(e).toVar(),s=xn(dn(.856627153315983,.137318972929847,.11189821299995),dn(.0951212405381588,.761241990602591,.0767994186031903),dn(.0482516061458583,.101439036467562,.811302368396859)),i=xn(dn(1.1271005818144368,-.1413297634984383,-.14132976349843826),dn(-.11060664309660323,1.157823702216272,-.11060664309660294),dn(-.016493938717834573,-.016493938717834257,1.2519364065950405)),n=tn(-12.47393),a=tn(4.026069);return r.mulAssign(t),r.assign(Jb.mul(r)),r.assign(s.mul(r)),r.assign(Mo(r,1e-10)),r.assign(eo(r)),r.assign(r.sub(n).div(a.sub(n))),r.assign(Wo(r,0,1)),r.assign(ex(r)),r.assign(i.mul(r)),r.assign(Uo(Mo(dn(0),r),dn(2.2))),r.assign(Zb.mul(r)),r.assign(Wo(r,0,1)),r}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),rx=Ki(([e,t])=>{const r=tn(.76),s=tn(.15);e=e.mul(t);const i=Co(e.r,Co(e.g,e.b)),n=iu(i.lessThan(.08),i.sub(ba(6.25,i.mul(i))),.04);e.subAssign(n);const a=Mo(e.r,Mo(e.g,e.b));Zi(a.lessThan(r),()=>e);const o=ya(1,r),u=ya(1,o.mul(o).div(a.add(o.sub(r))));e.mulAssign(u.div(a));const l=ya(1,xa(1,s.mul(a.sub(u)).add(1)));return Ho(e,dn(u),l)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class sx extends Ys{static get type(){return"CodeNode"}constructor(e="",t=[],r=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=r}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const r=e.getCodeFromNode(this,this.getNodeType(e));return r.code=this.code,r.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const ix=Hi(sx).setParameterLength(1,3);class nx extends sx{static get type(){return"FunctionNode"}constructor(e="",t=[],r=""){super(e,t,r)}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,t){const r=this.getNodeType(e);return e.getStructTypeNode(r).getMemberType(e,t)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let r=t.nodeFunction;return void 0===r&&(r=e.parser.parseFunction(this.code),t.nodeFunction=r),r}generate(e,t){super.generate(e);const r=this.getNodeFunction(e),s=r.name,i=r.type,n=e.getCodeFromNode(this,i);""!==s&&(n.name=s);const a=e.getPropertyName(n),o=this.getNodeFunction(e).getCode(a);return n.code=o+"\n","property"===t?a:e.format(`${a}()`,i,t)}}const ax=(e,t=[],r="")=>{for(let e=0;e<t.length;e++){const r=t[e];"function"==typeof r&&(t[e]=r.functionNode)}const s=Gi(new nx(e,t,r)),i=(...e)=>s.call(...e);return i.functionNode=s,i};class ox extends Ys{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new o,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return null!==this.outputType}set value(e){this._value!==e&&(this._cache&&"URL"===this.inputType&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&null===this._cache&&"URL"===this.inputType&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&null!==e.value&&void 0!==e.value&&(("URL"===this.inputType||"String"===this.inputType)&&"string"==typeof e.value||"Number"===this.inputType&&"number"==typeof e.value||"Vector2"===this.inputType&&e.value.isVector2||"Vector3"===this.inputType&&e.value.isVector3||"Vector4"===this.inputType&&e.value.isVector4||"Color"===this.inputType&&e.value.isColor||"Matrix3"===this.inputType&&e.value.isMatrix3||"Matrix4"===this.inputType&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:tn()}serialize(e){super.serialize(e),null!==this.value?"ArrayBuffer"===this.inputType?e.value=Us(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;null!==e.value&&(t="ArrayBuffer"===e.inputType?Vs(e.value):"Texture"===e.inputType?e.meta.textures[e.value]:e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const ux=Hi(ox).setParameterLength(1);class lx extends Map{get(e,t=null,...r){if(this.has(e))return super.get(e);if(null!==t){const s=t(...r);return this.set(e,s),s}}}class dx{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const cx=new lx;class hx extends Ys{static get type(){return"ScriptableNode"}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new lx,this._output=ux(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const r=this._outputs;return void 0===r[e]?r[e]=ux(t):r[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const r=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),r[e]=t,r[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),r[e]=t,r[e].events.addEventListener("refresh",this.onRefresh)):void 0===r[e]?(r[e]=ux(t),r[e].events.addEventListener("refresh",this.onRefresh)):r[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...t){const r=this.getObject()[e];if("function"==typeof r)return r(...t)}async callAsync(e,...t){const r=this.getObject()[e];if("function"==typeof r)return"AsyncFunction"===r.constructor.name?await r(...t):r(...t)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){null!==e?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),null!==this._object)return this._object;const e=new dx(this),t=cx.get("THREE"),r=cx.get("TSL"),s=this.getMethod(),i=[e,this._local,cx,()=>this.refresh(),(e,t)=>this.setOutput(e,t),t,r];this._object=s(...i);const n=this._object.layout;if(n&&(!1===n.cache&&this._local.clear(),this._output.outputType=n.outputType||null,Array.isArray(n.elements)))for(const e of n.elements){const t=e.id||e.name;e.inputType&&(void 0===this.getParameter(t)&&this.setParameter(t,null),this.getParameter(t).inputType=e.inputType),e.outputType&&(void 0===this.getOutput(t)&&this.setOutput(t,null),this.getOutput(t).outputType=e.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const e in this.parameters){let t=this.parameters[e];t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:tn()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),null!==this._method)return this._method;const e=["layout","init","main","dispose"].join(", "),t="\nreturn { ...output, "+e+" };",r="var "+e+"; var output = {};\n"+this.codeNode.code+t;return this._method=new Function(...["parameters","local","global","refresh","setOutput","THREE","TSL"],r),this._method}dispose(){null!==this._method&&(this._object&&"function"==typeof this._object.dispose&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[vs(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const r in this.parameters)t.push(this.parameters[r].getCacheKey(e));return Ns(t)}set needsUpdate(e){!0===e&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return null===this.codeNode||(!0===this._needsOutputUpdate&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value),this}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const px=Hi(hx).setParameterLength(1,2);function gx(e){let t;const r=e.context.getViewZ;return void 0!==r&&(t=r(this)),(t||pd.z).negate()}const mx=Ki(([e,t],r)=>{const s=gx(r);return Xo(e,t,s)}),fx=Ki(([e],t)=>{const r=gx(t);return e.mul(e,r,r).negate().exp().oneMinus()}),yx=Ki(([e,t])=>gn(t.toFloat().mix(Hn.rgb,e.toVec3()),Hn.a));let bx=null,xx=null;class Tx extends Ys{static get type(){return"RangeNode"}constructor(e=tn(),t=tn()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=e.getTypeLength(Fs(this.minNode.value)),r=e.getTypeLength(Fs(this.maxNode.value));return t>r?t:r}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}setup(e){const t=e.object;let r=null;if(t.count>1){const i=this.minNode.value,n=this.maxNode.value,a=e.getTypeLength(Fs(i)),o=e.getTypeLength(Fs(n));bx=bx||new s,xx=xx||new s,bx.setScalar(0),xx.setScalar(0),1===a?bx.setScalar(i):i.isColor?bx.set(i.r,i.g,i.b,1):bx.set(i.x,i.y,i.z||0,i.w||0),1===o?xx.setScalar(n):n.isColor?xx.set(n.r,n.g,n.b,1):xx.set(n.x,n.y,n.z||0,n.w||0);const l=4,d=l*t.count,c=new Float32Array(d);for(let e=0;e<d;e++){const t=e%l,r=bx.getComponent(t),s=xx.getComponent(t);c[e]=u.lerp(r,s,Math.random())}const h=this.getNodeType(e);if(t.count<=4096)r=gl(c,"vec4",t.count).element(bh).convert(h);else{const t=new L(c,4);e.geometry.setAttribute("__range"+this.id,t),r=Du(t).convert(h)}}else r=tn(0);return r}}const _x=Hi(Tx).setParameterLength(2);class vx extends Ys{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const r=this.getBuiltinName(e),s=this.getNodeType(e);return"compute"===e.shaderStage?e.format(r,s,t):(console.warn(`ComputeBuiltinNode: Compute built-in value ${r} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(s))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const Nx=(e,t)=>Gi(new vx(e,t)),Sx=Nx("numWorkgroups","uvec3"),Ex=Nx("workgroupId","uvec3"),Rx=Nx("globalId","uvec3"),Ax=Nx("localId","uvec3"),wx=Nx("subgroupSize","uint");const Cx=Hi(class extends Ys{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:r}=e;!0===r.backend.isWebGLBackend?e.addFlowCode(`\t// ${t}Barrier \n`):e.addLineFlowCode(`${t}Barrier()`,this)}});class Mx extends Qs{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let r;const s=e.context.assign;if(r=super.generate(e),!0!==s){const s=this.getNodeType(e);r=e.format(r,s,t)}return r}}class Px extends Ys{constructor(e,t,r=0){super(t),this.bufferType=t,this.bufferCount=r,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e,this.name=""}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return Gi(new Mx(this,e))}generate(e){const t=""!==this.name?this.name:`${this.scope}Array_${this.id}`;return e.getScopedArray(t,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}class Bx extends Ys{static get type(){return"AtomicFunctionNode"}constructor(e,t,r){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=r,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),r=t.parents,s=this.method,i=this.getNodeType(e),n=this.getInputType(e),a=this.pointerNode,o=this.valueNode,u=[];u.push(`&${a.build(e,n)}`),null!==o&&u.push(o.build(e,n));const l=`${e.getMethod(s,i)}( ${u.join(", ")} )`;if(!(!!r&&(1===r.length&&!0===r[0].isStackNode)))return void 0===t.constNode&&(t.constNode=Ku(l,i).toConst()),t.constNode.build(e);e.addLineFlowCode(l,this)}}Bx.ATOMIC_LOAD="atomicLoad",Bx.ATOMIC_STORE="atomicStore",Bx.ATOMIC_ADD="atomicAdd",Bx.ATOMIC_SUB="atomicSub",Bx.ATOMIC_MAX="atomicMax",Bx.ATOMIC_MIN="atomicMin",Bx.ATOMIC_AND="atomicAnd",Bx.ATOMIC_OR="atomicOr",Bx.ATOMIC_XOR="atomicXor";const Lx=Hi(Bx),Fx=(e,t,r)=>Lx(e,t,r).toStack();class Ix extends Js{static get type(){return"SubgroupFunctionNode"}constructor(e,t=null,r=null){super(),this.method=e,this.aNode=t,this.bNode=r}getInputType(e){const t=this.aNode?this.aNode.getNodeType(e):null,r=this.bNode?this.bNode.getNodeType(e):null;return(e.isMatrix(t)?0:e.getTypeLength(t))>(e.isMatrix(r)?0:e.getTypeLength(r))?t:r}getNodeType(e){const t=this.method;return t===Ix.SUBGROUP_ELECT?"bool":t===Ix.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,t){const r=this.method,s=this.getNodeType(e),i=this.getInputType(e),n=this.aNode,a=this.bNode,o=[];if(r===Ix.SUBGROUP_BROADCAST||r===Ix.SUBGROUP_SHUFFLE||r===Ix.QUAD_BROADCAST){const t=a.getNodeType(e);o.push(n.build(e,s),a.build(e,"float"===t?"int":s))}else r===Ix.SUBGROUP_SHUFFLE_XOR||r===Ix.SUBGROUP_SHUFFLE_DOWN||r===Ix.SUBGROUP_SHUFFLE_UP?o.push(n.build(e,s),a.build(e,"uint")):(null!==n&&o.push(n.build(e,i)),null!==a&&o.push(a.build(e,i)));const u=0===o.length?"()":`( ${o.join(", ")} )`;return e.format(`${e.getMethod(r,s)}${u}`,s,t)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Ix.SUBGROUP_ELECT="subgroupElect",Ix.SUBGROUP_BALLOT="subgroupBallot",Ix.SUBGROUP_ADD="subgroupAdd",Ix.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd",Ix.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd",Ix.SUBGROUP_MUL="subgroupMul",Ix.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul",Ix.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul",Ix.SUBGROUP_AND="subgroupAnd",Ix.SUBGROUP_OR="subgroupOr",Ix.SUBGROUP_XOR="subgroupXor",Ix.SUBGROUP_MIN="subgroupMin",Ix.SUBGROUP_MAX="subgroupMax",Ix.SUBGROUP_ALL="subgroupAll",Ix.SUBGROUP_ANY="subgroupAny",Ix.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst",Ix.QUAD_SWAP_X="quadSwapX",Ix.QUAD_SWAP_Y="quadSwapY",Ix.QUAD_SWAP_DIAGONAL="quadSwapDiagonal",Ix.SUBGROUP_BROADCAST="subgroupBroadcast",Ix.SUBGROUP_SHUFFLE="subgroupShuffle",Ix.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor",Ix.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp",Ix.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown",Ix.QUAD_BROADCAST="quadBroadcast";const Dx=qi(Ix,Ix.SUBGROUP_ELECT).setParameterLength(0),Ux=qi(Ix,Ix.SUBGROUP_BALLOT).setParameterLength(1),Vx=qi(Ix,Ix.SUBGROUP_ADD).setParameterLength(1),Ox=qi(Ix,Ix.SUBGROUP_INCLUSIVE_ADD).setParameterLength(1),Gx=qi(Ix,Ix.SUBGROUP_EXCLUSIVE_AND).setParameterLength(1),kx=qi(Ix,Ix.SUBGROUP_MUL).setParameterLength(1),zx=qi(Ix,Ix.SUBGROUP_INCLUSIVE_MUL).setParameterLength(1),$x=qi(Ix,Ix.SUBGROUP_EXCLUSIVE_MUL).setParameterLength(1),Hx=qi(Ix,Ix.SUBGROUP_AND).setParameterLength(1),Wx=qi(Ix,Ix.SUBGROUP_OR).setParameterLength(1),qx=qi(Ix,Ix.SUBGROUP_XOR).setParameterLength(1),jx=qi(Ix,Ix.SUBGROUP_MIN).setParameterLength(1),Xx=qi(Ix,Ix.SUBGROUP_MAX).setParameterLength(1),Kx=qi(Ix,Ix.SUBGROUP_ALL).setParameterLength(0),Yx=qi(Ix,Ix.SUBGROUP_ANY).setParameterLength(0),Qx=qi(Ix,Ix.SUBGROUP_BROADCAST_FIRST).setParameterLength(2),Zx=qi(Ix,Ix.QUAD_SWAP_X).setParameterLength(1),Jx=qi(Ix,Ix.QUAD_SWAP_Y).setParameterLength(1),eT=qi(Ix,Ix.QUAD_SWAP_DIAGONAL).setParameterLength(1),tT=qi(Ix,Ix.SUBGROUP_BROADCAST).setParameterLength(2),rT=qi(Ix,Ix.SUBGROUP_SHUFFLE).setParameterLength(2),sT=qi(Ix,Ix.SUBGROUP_SHUFFLE_XOR).setParameterLength(2),iT=qi(Ix,Ix.SUBGROUP_SHUFFLE_UP).setParameterLength(2),nT=qi(Ix,Ix.SUBGROUP_SHUFFLE_DOWN).setParameterLength(2),aT=qi(Ix,Ix.QUAD_BROADCAST).setParameterLength(1);let oT;function uT(e){oT=oT||new WeakMap;let t=oT.get(e);return void 0===t&&oT.set(e,t={}),t}function lT(e){const t=uT(e);return t.shadowMatrix||(t.shadowMatrix=oa("mat4").setGroup(ia).onRenderUpdate(t=>(!0===e.castShadow&&!1!==t.renderer.shadowMap.enabled||e.shadow.updateMatrices(e),e.shadow.matrix)))}function dT(e,t=cd){const r=lT(e).mul(t);return r.xyz.div(r.w)}function cT(e){const t=uT(e);return t.position||(t.position=oa(new r).setGroup(ia).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(e.matrixWorld)))}function hT(e){const t=uT(e);return t.targetPosition||(t.targetPosition=oa(new r).setGroup(ia).onRenderUpdate((t,r)=>r.value.setFromMatrixPosition(e.target.matrixWorld)))}function pT(e){const t=uT(e);return t.viewPosition||(t.viewPosition=oa(new r).setGroup(ia).onRenderUpdate(({camera:t},s)=>{s.value=s.value||new r,s.value.setFromMatrixPosition(e.matrixWorld),s.value.applyMatrix4(t.matrixWorldInverse)}))}const gT=e=>Dl.transformDirection(cT(e).sub(hT(e))),mT=(e,t)=>{for(const r of t)if(r.isAnalyticLightNode&&r.light.id===e)return r;return null},fT=new WeakMap,yT=[];class bT extends Ys{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Sn("vec3","totalDiffuse"),this.totalSpecularNode=Sn("vec3","totalSpecular"),this.outgoingLightNode=Sn("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let t=0;t<e.length;t++){const r=e[t];if(yT.push(r.id),yT.push(r.castShadow?1:0),!0===r.isSpotLight){const e=null!==r.map?r.map.id:-1,t=r.colorNode?r.colorNode.getCacheKey():-1;yT.push(e,t)}}const t=Ns(yT);return yT.length=0,t}getHash(e){if(null===this._lightNodesHash){null===this._lightNodes&&this.setupLightsNode(e);const t=[];for(const e of this._lightNodes)t.push(e.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const r of t.nodes)r.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],r=this._lightNodes,s=(e=>e.sort((e,t)=>e.id-t.id))(this._lights),i=e.renderer.library;for(const e of s)if(e.isNode)t.push(Gi(e));else{let s=null;if(null!==r&&(s=mT(e.id,r)),null===s){const r=i.getLightNodeClass(e.constructor);if(null===r){console.warn(`LightsNode.setupNodeLights: Light node not found for ${e.constructor.name}`);continue}let s=null;fT.has(e)?s=fT.get(e):(s=Gi(new r(e)),fT.set(e,s)),t.push(s)}}this._lightNodes=t}setupDirectLight(e,t,r){const{lightingModel:s,reflectedLight:i}=e.context;s.direct({...r,lightNode:t,reflectedLight:i},e)}setupDirectRectAreaLight(e,t,r){const{lightingModel:s,reflectedLight:i}=e.context;s.directRectArea({...r,lightNode:t,reflectedLight:i},e)}setupLights(e,t){for(const r of t)r.build(e)}getLightNodes(e){return null===this._lightNodes&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let r=this.outgoingLightNode;const s=e.context,i=s.lightingModel,n=e.getNodeProperties(this);if(i){const{totalDiffuseNode:t,totalSpecularNode:a}=this;s.outgoingLight=r;const o=e.addStack();n.nodes=o.nodes,i.start(e);const{backdrop:u,backdropAlpha:l}=s,{directDiffuse:d,directSpecular:c,indirectDiffuse:h,indirectSpecular:p}=s.reflectedLight;let g=d.add(h);null!==u&&(g=dn(null!==l?l.mix(g,u):u),s.material.transparent=!0),t.assign(g),a.assign(c.add(p)),r.assign(t.add(a)),i.finish(e),r=r.bypass(e.removeStack())}else n.nodes=[];return e.lightsNode=t,r}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class xT extends Ys{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=ks.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){TT.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||cd)}}const TT=Sn("vec3","shadowPositionWorld");function _T(t,r={}){return r.toneMapping=t.toneMapping,r.toneMappingExposure=t.toneMappingExposure,r.outputColorSpace=t.outputColorSpace,r.renderTarget=t.getRenderTarget(),r.activeCubeFace=t.getActiveCubeFace(),r.activeMipmapLevel=t.getActiveMipmapLevel(),r.renderObjectFunction=t.getRenderObjectFunction(),r.pixelRatio=t.getPixelRatio(),r.mrt=t.getMRT(),r.clearColor=t.getClearColor(r.clearColor||new e),r.clearAlpha=t.getClearAlpha(),r.autoClear=t.autoClear,r.scissorTest=t.getScissorTest(),r}function vT(e,t){return t=_T(e,t),e.setMRT(null),e.setRenderObjectFunction(null),e.setClearColor(0,1),e.autoClear=!0,t}function NT(e,t){e.toneMapping=t.toneMapping,e.toneMappingExposure=t.toneMappingExposure,e.outputColorSpace=t.outputColorSpace,e.setRenderTarget(t.renderTarget,t.activeCubeFace,t.activeMipmapLevel),e.setRenderObjectFunction(t.renderObjectFunction),e.setPixelRatio(t.pixelRatio),e.setMRT(t.mrt),e.setClearColor(t.clearColor,t.clearAlpha),e.autoClear=t.autoClear,e.setScissorTest(t.scissorTest)}function ST(e,t={}){return t.background=e.background,t.backgroundNode=e.backgroundNode,t.overrideMaterial=e.overrideMaterial,t}function ET(e,t){return t=ST(e,t),e.background=null,e.backgroundNode=null,e.overrideMaterial=null,t}function RT(e,t){e.background=t.background,e.backgroundNode=t.backgroundNode,e.overrideMaterial=t.overrideMaterial}function AT(e,t,r){return r=ET(t,r=vT(e,r))}function wT(e,t,r){NT(e,r),RT(t,r)}var CT=Object.freeze({__proto__:null,resetRendererAndSceneState:AT,resetRendererState:vT,resetSceneState:ET,restoreRendererAndSceneState:wT,restoreRendererState:NT,restoreSceneState:RT,saveRendererAndSceneState:function(e,t,r={}){return r=ST(t,r=_T(e,r))},saveRendererState:_T,saveSceneState:ST});const MT=new WeakMap,PT=Ki(({depthTexture:e,shadowCoord:t,depthLayer:r})=>{let s=cl(e,t.xy).setName("t_basic");return e.isArrayTexture&&(s=s.depth(r)),s.compare(t.z)}),BT=Ki(({depthTexture:e,shadowCoord:t,shadow:r,depthLayer:s})=>{const i=(t,r)=>{let i=cl(e,t);return e.isArrayTexture&&(i=i.depth(s)),i.compare(r)},n=jd("mapSize","vec2",r).setGroup(ia),a=jd("radius","float",r).setGroup(ia),o=an(1).div(n),u=o.x.negate().mul(a),l=o.y.negate().mul(a),d=o.x.mul(a),c=o.y.mul(a),h=u.div(2),p=l.div(2),g=d.div(2),m=c.div(2);return fa(i(t.xy.add(an(u,l)),t.z),i(t.xy.add(an(0,l)),t.z),i(t.xy.add(an(d,l)),t.z),i(t.xy.add(an(h,p)),t.z),i(t.xy.add(an(0,p)),t.z),i(t.xy.add(an(g,p)),t.z),i(t.xy.add(an(u,0)),t.z),i(t.xy.add(an(h,0)),t.z),i(t.xy,t.z),i(t.xy.add(an(g,0)),t.z),i(t.xy.add(an(d,0)),t.z),i(t.xy.add(an(h,m)),t.z),i(t.xy.add(an(0,m)),t.z),i(t.xy.add(an(g,m)),t.z),i(t.xy.add(an(u,c)),t.z),i(t.xy.add(an(0,c)),t.z),i(t.xy.add(an(d,c)),t.z)).mul(1/17)}),LT=Ki(({depthTexture:e,shadowCoord:t,shadow:r,depthLayer:s})=>{const i=(t,r)=>{let i=cl(e,t);return e.isArrayTexture&&(i=i.depth(s)),i.compare(r)},n=jd("mapSize","vec2",r).setGroup(ia),a=an(1).div(n),o=a.x,u=a.y,l=t.xy,d=ao(l.mul(n).add(.5));return l.subAssign(d.mul(a)),fa(i(l,t.z),i(l.add(an(o,0)),t.z),i(l.add(an(0,u)),t.z),i(l.add(a),t.z),Ho(i(l.add(an(o.negate(),0)),t.z),i(l.add(an(o.mul(2),0)),t.z),d.x),Ho(i(l.add(an(o.negate(),u)),t.z),i(l.add(an(o.mul(2),u)),t.z),d.x),Ho(i(l.add(an(0,u.negate())),t.z),i(l.add(an(0,u.mul(2))),t.z),d.y),Ho(i(l.add(an(o,u.negate())),t.z),i(l.add(an(o,u.mul(2))),t.z),d.y),Ho(Ho(i(l.add(an(o.negate(),u.negate())),t.z),i(l.add(an(o.mul(2),u.negate())),t.z),d.x),Ho(i(l.add(an(o.negate(),u.mul(2))),t.z),i(l.add(an(o.mul(2),u.mul(2))),t.z),d.x),d.y)).mul(1/9)}),FT=Ki(({depthTexture:e,shadowCoord:t,depthLayer:r})=>{const s=tn(1).toVar();let i=cl(e).sample(t.xy);e.isArrayTexture&&(i=i.depth(r)),i=i.rg;const n=Po(t.z,i.x);return Zi(n.notEqual(tn(1)),()=>{const e=t.z.sub(i.x),r=Mo(0,i.y.mul(i.y));let a=r.div(r.add(e.mul(e)));a=Wo(ya(a,.3).div(.95-.3)),s.assign(Wo(Mo(n,a)))}),s}),IT=Ki(([e,t,r])=>{let s=cd.sub(e).length();return s=s.sub(t).div(r.sub(t)),s=s.saturate(),s}),DT=e=>{let t=MT.get(e);if(void 0===t){const r=e.isPointLight?(e=>{const t=e.shadow.camera,r=jd("near","float",t).setGroup(ia),s=jd("far","float",t).setGroup(ia),i=Wl(e);return IT(i,r,s)})(e):null;t=new Sp,t.colorNode=gn(0,0,0,1),t.depthNode=r,t.isShadowPassMaterial=!0,t.name="ShadowMaterial",t.fog=!1,MT.set(e,t)}return t},UT=new Nf,VT=[],OT=(e,t,r,s)=>{VT[0]=e,VT[1]=t;let i=UT.get(VT);return void 0!==i&&i.shadowType===r&&i.useVelocity===s||(i=(i,n,a,o,u,l,...d)=>{(!0===i.castShadow||i.receiveShadow&&r===De)&&(s&&(Ds(i).useVelocity=!0),i.onBeforeShadow(e,i,a,t.camera,o,n.overrideMaterial,l),e.renderObject(i,n,a,o,u,l,...d),i.onAfterShadow(e,i,a,t.camera,o,n.overrideMaterial,l))},i.shadowType=r,i.useVelocity=s,UT.set(VT,i)),VT[0]=null,VT[1]=null,i},GT=Ki(({samples:e,radius:t,size:r,shadowPass:s,depthLayer:i})=>{const n=tn(0).toVar("meanVertical"),a=tn(0).toVar("squareMeanVertical"),o=e.lessThanEqual(tn(1)).select(tn(0),tn(2).div(e.sub(1))),u=e.lessThanEqual(tn(1)).select(tn(0),tn(-1));Uh({start:rn(0),end:rn(e),type:"int",condition:"<"},({i:e})=>{const l=u.add(tn(e).mul(o));let d=s.sample(fa(El.xy,an(0,l).mul(t)).div(r));s.value.isArrayTexture&&(d=d.depth(i)),d=d.x,n.addAssign(d),a.addAssign(d.mul(d))}),n.divAssign(e),a.divAssign(e);const l=to(a.sub(n.mul(n)));return an(n,l)}),kT=Ki(({samples:e,radius:t,size:r,shadowPass:s,depthLayer:i})=>{const n=tn(0).toVar("meanHorizontal"),a=tn(0).toVar("squareMeanHorizontal"),o=e.lessThanEqual(tn(1)).select(tn(0),tn(2).div(e.sub(1))),u=e.lessThanEqual(tn(1)).select(tn(0),tn(-1));Uh({start:rn(0),end:rn(e),type:"int",condition:"<"},({i:e})=>{const l=u.add(tn(e).mul(o));let d=s.sample(fa(El.xy,an(l,0).mul(t)).div(r));s.value.isArrayTexture&&(d=d.depth(i)),n.addAssign(d.x),a.addAssign(fa(d.y.mul(d.y),d.x.mul(d.x)))}),n.divAssign(e),a.divAssign(e);const l=to(a.sub(n.mul(n)));return an(n,l)}),zT=[PT,BT,LT,FT];let $T;const HT=new sb;class WT extends xT{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:r,shadowCoord:s,shadow:i,depthLayer:n}){const a=s.x.greaterThanEqual(0).and(s.x.lessThanEqual(1)).and(s.y.greaterThanEqual(0)).and(s.y.lessThanEqual(1)).and(s.z.lessThanEqual(1)),o=t({depthTexture:r,shadowCoord:s,shadow:i,depthLayer:n});return a.select(o,tn(1))}setupShadowCoord(e,t){const{shadow:r}=this,{renderer:s}=e,i=jd("bias","float",r).setGroup(ia);let n,a=t;if(r.camera.isOrthographicCamera||!0!==s.logarithmicDepthBuffer)a=a.xyz.div(a.w),n=a.z,s.coordinateSystem===d&&(n=n.mul(2).sub(1));else{const e=a.w;a=a.xy.div(e);const t=jd("near","float",r.camera).setGroup(ia),s=jd("far","float",r.camera).setGroup(ia);n=ap(e.negate(),t,s)}return a=dn(a.x,a.y.oneMinus(),n.add(i)),a}getShadowFilterFn(e){return zT[e]}setupRenderTarget(e,t){const r=new V(e.mapSize.width,e.mapSize.height);r.name="ShadowDepthTexture",r.compareFunction=Ue;const s=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return s.texture.name="ShadowMap",s.texture.type=e.mapType,s.depthTexture=r,{shadowMap:s,depthTexture:r}}setupShadow(e){const{renderer:t}=e,{light:r,shadow:s}=this,i=t.shadowMap.type,{depthTexture:n,shadowMap:a}=this.setupRenderTarget(s,e);if(s.camera.updateProjectionMatrix(),i===De&&!0!==s.isPointLightShadow){n.compareFunction=null,a.depth>1?(a._vsmShadowMapVertical||(a._vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=a._vsmShadowMapVertical,a._vsmShadowMapHorizontal||(a._vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depth:a.depth,depthBuffer:!1}),a._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=a._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:Ve,type:ce,depthBuffer:!1}));let t=cl(n);n.isArrayTexture&&(t=t.depth(this.depthLayer));let r=cl(this.vsmShadowMapVertical.texture);n.isArrayTexture&&(r=r.depth(this.depthLayer));const i=jd("blurSamples","float",s).setGroup(ia),o=jd("radius","float",s).setGroup(ia),u=jd("mapSize","vec2",s).setGroup(ia);let l=this.vsmMaterialVertical||(this.vsmMaterialVertical=new Sp);l.fragmentNode=GT({samples:i,radius:o,size:u,shadowPass:t,depthLayer:this.depthLayer}).context(e.getSharedContext()),l.name="VSMVertical",l=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new Sp),l.fragmentNode=kT({samples:i,radius:o,size:u,shadowPass:r,depthLayer:this.depthLayer}).context(e.getSharedContext()),l.name="VSMHorizontal"}const o=jd("intensity","float",s).setGroup(ia),u=jd("normalBias","float",s).setGroup(ia),l=lT(r).mul(TT.add(Ed.mul(u))),d=this.setupShadowCoord(e,l),c=s.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(null===c)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const h=i===De&&!0!==s.isPointLightShadow?this.vsmShadowMapHorizontal.texture:n,p=this.setupShadowFilter(e,{filterFn:c,shadowTexture:a.texture,depthTexture:h,shadowCoord:d,shadow:s,depthLayer:this.depthLayer});let g=cl(a.texture,d);n.isArrayTexture&&(g=g.depth(this.depthLayer));const m=Ho(1,p.rgb.mix(g,1),o.mul(g.a)).toVar();return this.shadowMap=a,this.shadow.map=a,m}setup(e){if(!1!==e.renderer.shadowMap.enabled)return Ki(()=>{let t=this._node;return this.setupShadowPosition(e),null===t&&(this._node=t=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(t=e.material.receivedShadowNode(t)),t})()}renderShadow(e){const{shadow:t,shadowMap:r,light:s}=this,{renderer:i,scene:n}=e;t.updateMatrices(s),r.setSize(t.mapSize.width,t.mapSize.height,r.depth),i.render(n,t.camera)}updateShadow(e){const{shadowMap:t,light:r,shadow:s}=this,{renderer:i,scene:n,camera:a}=e,o=i.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u;const l=s.camera.layers.mask;4294967294&s.camera.layers.mask||(s.camera.layers.mask=a.layers.mask);const d=i.getRenderObjectFunction(),c=i.getMRT(),h=!!c&&c.has("velocity");$T=AT(i,n,$T),n.overrideMaterial=DT(r),i.setRenderObjectFunction(OT(i,s,o,h)),i.setClearColor(0,0),i.setRenderTarget(t),this.renderShadow(e),i.setRenderObjectFunction(d),o===De&&!0!==s.isPointLightShadow&&this.vsmPass(i),s.camera.layers.mask=l,wT(i,n,$T)}vsmPass(e){const{shadow:t}=this,r=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,r),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,r),e.setRenderTarget(this.vsmShadowMapVertical),HT.material=this.vsmMaterialVertical,HT.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),HT.material=this.vsmMaterialHorizontal,HT.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,null!==this.vsmShadowMapVertical&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),null!==this.vsmShadowMapHorizontal&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:t}=this;let r=t.needsUpdate||t.autoUpdate;r&&(this._cameraFrameId[e.camera]===e.frameId&&(r=!1),this._cameraFrameId[e.camera]=e.frameId),r&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const qT=(e,t)=>Gi(new WT(e,t)),jT=new e,XT=Ki(([e,t])=>{const r=e.toVar(),s=go(r),i=xa(1,Mo(s.x,Mo(s.y,s.z)));s.mulAssign(i),r.mulAssign(i.mul(t.mul(2).oneMinus()));const n=an(r.xy).toVar(),a=t.mul(1.5).oneMinus();return Zi(s.z.greaterThanEqual(a),()=>{Zi(r.z.greaterThan(0),()=>{n.x.assign(ya(4,r.x))})}).ElseIf(s.x.greaterThanEqual(a),()=>{const e=mo(r.x);n.x.assign(r.z.mul(e).add(e.mul(2)))}).ElseIf(s.y.greaterThanEqual(a),()=>{const e=mo(r.y);n.x.assign(r.x.add(e.mul(2)).add(2)),n.y.assign(r.z.mul(e).sub(2))}),an(.125,.25).mul(n).add(an(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),KT=Ki(({depthTexture:e,bd3D:t,dp:r,texelSize:s})=>cl(e,XT(t,s.y)).compare(r)),YT=Ki(({depthTexture:e,bd3D:t,dp:r,texelSize:s,shadow:i})=>{const n=jd("radius","float",i).setGroup(ia),a=an(-1,1).mul(n).mul(s.y);return cl(e,XT(t.add(a.xyy),s.y)).compare(r).add(cl(e,XT(t.add(a.yyy),s.y)).compare(r)).add(cl(e,XT(t.add(a.xyx),s.y)).compare(r)).add(cl(e,XT(t.add(a.yyx),s.y)).compare(r)).add(cl(e,XT(t,s.y)).compare(r)).add(cl(e,XT(t.add(a.xxy),s.y)).compare(r)).add(cl(e,XT(t.add(a.yxy),s.y)).compare(r)).add(cl(e,XT(t.add(a.xxx),s.y)).compare(r)).add(cl(e,XT(t.add(a.yxx),s.y)).compare(r)).mul(1/9)}),QT=Ki(({filterFn:e,depthTexture:t,shadowCoord:r,shadow:s})=>{const i=r.xyz.toVar(),n=i.length(),a=oa("float").setGroup(ia).onRenderUpdate(()=>s.camera.near),o=oa("float").setGroup(ia).onRenderUpdate(()=>s.camera.far),u=jd("bias","float",s).setGroup(ia),l=oa(s.mapSize).setGroup(ia),d=tn(1).toVar();return Zi(n.sub(o).lessThanEqual(0).and(n.sub(a).greaterThanEqual(0)),()=>{const r=n.sub(a).div(o.sub(a)).toVar();r.addAssign(u);const c=i.normalize(),h=an(1).div(l.mul(an(4,2)));d.assign(e({depthTexture:t,bd3D:c,dp:r,texelSize:h,shadow:s}))}),d}),ZT=new s,JT=new t,e_=new t;class t_ extends WT{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===Oe?KT:YT}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,shadowTexture:r,depthTexture:s,shadowCoord:i,shadow:n}){return QT({filterFn:t,shadowTexture:r,depthTexture:s,shadowCoord:i,shadow:n})}renderShadow(e){const{shadow:t,shadowMap:r,light:s}=this,{renderer:i,scene:n}=e,a=t.getFrameExtents();e_.copy(t.mapSize),e_.multiply(a),r.setSize(e_.width,e_.height),JT.copy(t.mapSize);const o=i.autoClear,u=i.getClearColor(jT),l=i.getClearAlpha();i.autoClear=!1,i.setClearColor(t.clearColor,t.clearAlpha),i.clear();const d=t.getViewportCount();for(let e=0;e<d;e++){const a=t.getViewport(e),o=JT.x*a.x,u=e_.y-JT.y-JT.y*a.y;ZT.set(o,u,JT.x*a.z,JT.y*a.w),r.viewport.copy(ZT),t.updateMatrices(s,e),i.render(n,t.camera)}i.autoClear=o,i.setClearColor(u,l)}}const r_=(e,t)=>Gi(new t_(e,t));class s_ extends Hh{static get type(){return"AnalyticLightNode"}constructor(t=null){super(),this.light=t,this.color=new e,this.colorNode=t&&t.colorNode||oa(this.color).setGroup(ia),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=ks.FRAME}getHash(){return this.light.uuid}getLightVector(e){return pT(this.light).sub(e.context.positionView||pd)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return qT(this.light)}setupShadow(e){const{renderer:t}=e;if(!1===t.shadowMap.enabled)return;let r=this.shadowColorNode;if(null===r){const e=this.light.shadow.shadowNode;let t;t=void 0!==e?Gi(e):this.setupShadowNode(),this.shadowNode=t,this.shadowColorNode=r=this.colorNode.mul(t),this.baseColorNode=this.colorNode}this.colorNode=r}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):null!==this.shadowNode&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),r=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),r&&e.lightsNode.setupDirectRectAreaLight(e,this,r)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const i_=Ki(({lightDistance:e,cutoffDistance:t,decayExponent:r})=>{const s=e.pow(r).max(.01).reciprocal();return t.greaterThan(0).select(s.mul(e.div(t).pow4().oneMinus().clamp().pow2()),s)}),n_=({color:e,lightVector:t,cutoffDistance:r,decayExponent:s})=>{const i=t.normalize(),n=t.length(),a=i_({lightDistance:n,cutoffDistance:r,decayExponent:s});return{lightDirection:i,lightColor:e.mul(a)}};class a_ extends s_{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=oa(0).setGroup(ia),this.decayExponentNode=oa(2).setGroup(ia)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return r_(this.light)}setupDirect(e){return n_({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const o_=Ki(([e=sl()])=>{const t=e.mul(2),r=t.x.floor(),s=t.y.floor();return r.add(s).mod(2).sign()}),u_=Ki(([e=sl()],{renderer:t,material:r})=>{const s=$o(e.mul(2).sub(1));let i;if(r.alphaToCoverage&&t.samples>1){const e=tn(s.fwidth()).toVar();i=Xo(e.oneMinus(),e.add(1),s).oneMinus()}else i=iu(s.greaterThan(1),0,1);return i}),l_=Ki(([e,t,r])=>{const s=tn(r).toVar(),i=tn(t).toVar(),n=nn(e).toVar();return iu(n,i,s)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),d_=Ki(([e,t])=>{const r=nn(t).toVar(),s=tn(e).toVar();return iu(r,s.negate(),s)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),c_=Ki(([e])=>{const t=tn(e).toVar();return rn(so(t))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),h_=Ki(([e,t])=>{const r=tn(e).toVar();return t.assign(c_(r)),r.sub(tn(t))}),p_=Ay([Ki(([e,t,r,s,i,n])=>{const a=tn(n).toVar(),o=tn(i).toVar(),u=tn(s).toVar(),l=tn(r).toVar(),d=tn(t).toVar(),c=tn(e).toVar(),h=tn(ya(1,o)).toVar();return ya(1,a).mul(c.mul(h).add(d.mul(o))).add(a.mul(l.mul(h).add(u.mul(o))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),Ki(([e,t,r,s,i,n])=>{const a=tn(n).toVar(),o=tn(i).toVar(),u=dn(s).toVar(),l=dn(r).toVar(),d=dn(t).toVar(),c=dn(e).toVar(),h=tn(ya(1,o)).toVar();return ya(1,a).mul(c.mul(h).add(d.mul(o))).add(a.mul(l.mul(h).add(u.mul(o))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]})]),g_=Ay([Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=tn(d).toVar(),h=tn(l).toVar(),p=tn(u).toVar(),g=tn(o).toVar(),m=tn(a).toVar(),f=tn(n).toVar(),y=tn(i).toVar(),b=tn(s).toVar(),x=tn(r).toVar(),T=tn(t).toVar(),_=tn(e).toVar(),v=tn(ya(1,p)).toVar(),N=tn(ya(1,h)).toVar();return tn(ya(1,c)).toVar().mul(N.mul(_.mul(v).add(T.mul(p))).add(h.mul(x.mul(v).add(b.mul(p))))).add(c.mul(N.mul(y.mul(v).add(f.mul(p))).add(h.mul(m.mul(v).add(g.mul(p))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=tn(d).toVar(),h=tn(l).toVar(),p=tn(u).toVar(),g=dn(o).toVar(),m=dn(a).toVar(),f=dn(n).toVar(),y=dn(i).toVar(),b=dn(s).toVar(),x=dn(r).toVar(),T=dn(t).toVar(),_=dn(e).toVar(),v=tn(ya(1,p)).toVar(),N=tn(ya(1,h)).toVar();return tn(ya(1,c)).toVar().mul(N.mul(_.mul(v).add(T.mul(p))).add(h.mul(x.mul(v).add(b.mul(p))))).add(c.mul(N.mul(y.mul(v).add(f.mul(p))).add(h.mul(m.mul(v).add(g.mul(p))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]})]),m_=Ki(([e,t,r])=>{const s=tn(r).toVar(),i=tn(t).toVar(),n=sn(e).toVar(),a=sn(n.bitAnd(sn(7))).toVar(),o=tn(l_(a.lessThan(sn(4)),i,s)).toVar(),u=tn(ba(2,l_(a.lessThan(sn(4)),s,i))).toVar();return d_(o,nn(a.bitAnd(sn(1)))).add(d_(u,nn(a.bitAnd(sn(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),f_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=tn(t).toVar(),o=sn(e).toVar(),u=sn(o.bitAnd(sn(15))).toVar(),l=tn(l_(u.lessThan(sn(8)),a,n)).toVar(),d=tn(l_(u.lessThan(sn(4)),n,l_(u.equal(sn(12)).or(u.equal(sn(14))),a,i))).toVar();return d_(l,nn(u.bitAnd(sn(1)))).add(d_(d,nn(u.bitAnd(sn(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),y_=Ay([m_,f_]),b_=Ki(([e,t,r])=>{const s=tn(r).toVar(),i=tn(t).toVar(),n=hn(e).toVar();return dn(y_(n.x,i,s),y_(n.y,i,s),y_(n.z,i,s))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),x_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=tn(t).toVar(),o=hn(e).toVar();return dn(y_(o.x,a,n,i),y_(o.y,a,n,i),y_(o.z,a,n,i))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),T_=Ay([b_,x_]),__=Ki(([e])=>{const t=tn(e).toVar();return ba(.6616,t)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),v_=Ki(([e])=>{const t=tn(e).toVar();return ba(.982,t)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),N_=Ay([__,Ki(([e])=>{const t=dn(e).toVar();return ba(.6616,t)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]})]),S_=Ay([v_,Ki(([e])=>{const t=dn(e).toVar();return ba(.982,t)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]})]),E_=Ki(([e,t])=>{const r=rn(t).toVar(),s=sn(e).toVar();return s.shiftLeft(r).bitOr(s.shiftRight(rn(32).sub(r)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),R_=Ki(([e,t,r])=>{e.subAssign(r),e.bitXorAssign(E_(r,rn(4))),r.addAssign(t),t.subAssign(e),t.bitXorAssign(E_(e,rn(6))),e.addAssign(r),r.subAssign(t),r.bitXorAssign(E_(t,rn(8))),t.addAssign(e),e.subAssign(r),e.bitXorAssign(E_(r,rn(16))),r.addAssign(t),t.subAssign(e),t.bitXorAssign(E_(e,rn(19))),e.addAssign(r),r.subAssign(t),r.bitXorAssign(E_(t,rn(4))),t.addAssign(e)}),A_=Ki(([e,t,r])=>{const s=sn(r).toVar(),i=sn(t).toVar(),n=sn(e).toVar();return s.bitXorAssign(i),s.subAssign(E_(i,rn(14))),n.bitXorAssign(s),n.subAssign(E_(s,rn(11))),i.bitXorAssign(n),i.subAssign(E_(n,rn(25))),s.bitXorAssign(i),s.subAssign(E_(i,rn(16))),n.bitXorAssign(s),n.subAssign(E_(s,rn(4))),i.bitXorAssign(n),i.subAssign(E_(n,rn(14))),s.bitXorAssign(i),s.subAssign(E_(i,rn(24))),s}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),w_=Ki(([e])=>{const t=sn(e).toVar();return tn(t).div(tn(sn(rn(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),C_=Ki(([e])=>{const t=tn(e).toVar();return t.mul(t).mul(t).mul(t.mul(t.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),M_=Ay([Ki(([e])=>{const t=rn(e).toVar(),r=sn(sn(1)).toVar(),s=sn(sn(rn(3735928559)).add(r.shiftLeft(sn(2))).add(sn(13))).toVar();return A_(s.add(sn(t)),s,s)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),Ki(([e,t])=>{const r=rn(t).toVar(),s=rn(e).toVar(),i=sn(sn(2)).toVar(),n=sn().toVar(),a=sn().toVar(),o=sn().toVar();return n.assign(a.assign(o.assign(sn(rn(3735928559)).add(i.shiftLeft(sn(2))).add(sn(13))))),n.addAssign(sn(s)),a.addAssign(sn(r)),A_(n,a,o)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Ki(([e,t,r])=>{const s=rn(r).toVar(),i=rn(t).toVar(),n=rn(e).toVar(),a=sn(sn(3)).toVar(),o=sn().toVar(),u=sn().toVar(),l=sn().toVar();return o.assign(u.assign(l.assign(sn(rn(3735928559)).add(a.shiftLeft(sn(2))).add(sn(13))))),o.addAssign(sn(n)),u.addAssign(sn(i)),l.addAssign(sn(s)),A_(o,u,l)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),Ki(([e,t,r,s])=>{const i=rn(s).toVar(),n=rn(r).toVar(),a=rn(t).toVar(),o=rn(e).toVar(),u=sn(sn(4)).toVar(),l=sn().toVar(),d=sn().toVar(),c=sn().toVar();return l.assign(d.assign(c.assign(sn(rn(3735928559)).add(u.shiftLeft(sn(2))).add(sn(13))))),l.addAssign(sn(o)),d.addAssign(sn(a)),c.addAssign(sn(n)),R_(l,d,c),l.addAssign(sn(i)),A_(l,d,c)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),Ki(([e,t,r,s,i])=>{const n=rn(i).toVar(),a=rn(s).toVar(),o=rn(r).toVar(),u=rn(t).toVar(),l=rn(e).toVar(),d=sn(sn(5)).toVar(),c=sn().toVar(),h=sn().toVar(),p=sn().toVar();return c.assign(h.assign(p.assign(sn(rn(3735928559)).add(d.shiftLeft(sn(2))).add(sn(13))))),c.addAssign(sn(l)),h.addAssign(sn(u)),p.addAssign(sn(o)),R_(c,h,p),c.addAssign(sn(a)),h.addAssign(sn(n)),A_(c,h,p)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]})]),P_=Ay([Ki(([e,t])=>{const r=rn(t).toVar(),s=rn(e).toVar(),i=sn(M_(s,r)).toVar(),n=hn().toVar();return n.x.assign(i.bitAnd(rn(255))),n.y.assign(i.shiftRight(rn(8)).bitAnd(rn(255))),n.z.assign(i.shiftRight(rn(16)).bitAnd(rn(255))),n}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Ki(([e,t,r])=>{const s=rn(r).toVar(),i=rn(t).toVar(),n=rn(e).toVar(),a=sn(M_(n,i,s)).toVar(),o=hn().toVar();return o.x.assign(a.bitAnd(rn(255))),o.y.assign(a.shiftRight(rn(8)).bitAnd(rn(255))),o.z.assign(a.shiftRight(rn(16)).bitAnd(rn(255))),o}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]})]),B_=Ay([Ki(([e])=>{const t=an(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=tn(h_(t.x,r)).toVar(),n=tn(h_(t.y,s)).toVar(),a=tn(C_(i)).toVar(),o=tn(C_(n)).toVar(),u=tn(p_(y_(M_(r,s),i,n),y_(M_(r.add(rn(1)),s),i.sub(1),n),y_(M_(r,s.add(rn(1))),i,n.sub(1)),y_(M_(r.add(rn(1)),s.add(rn(1))),i.sub(1),n.sub(1)),a,o)).toVar();return N_(u)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=rn().toVar(),n=tn(h_(t.x,r)).toVar(),a=tn(h_(t.y,s)).toVar(),o=tn(h_(t.z,i)).toVar(),u=tn(C_(n)).toVar(),l=tn(C_(a)).toVar(),d=tn(C_(o)).toVar(),c=tn(g_(y_(M_(r,s,i),n,a,o),y_(M_(r.add(rn(1)),s,i),n.sub(1),a,o),y_(M_(r,s.add(rn(1)),i),n,a.sub(1),o),y_(M_(r.add(rn(1)),s.add(rn(1)),i),n.sub(1),a.sub(1),o),y_(M_(r,s,i.add(rn(1))),n,a,o.sub(1)),y_(M_(r.add(rn(1)),s,i.add(rn(1))),n.sub(1),a,o.sub(1)),y_(M_(r,s.add(rn(1)),i.add(rn(1))),n,a.sub(1),o.sub(1)),y_(M_(r.add(rn(1)),s.add(rn(1)),i.add(rn(1))),n.sub(1),a.sub(1),o.sub(1)),u,l,d)).toVar();return S_(c)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]})]),L_=Ay([Ki(([e])=>{const t=an(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=tn(h_(t.x,r)).toVar(),n=tn(h_(t.y,s)).toVar(),a=tn(C_(i)).toVar(),o=tn(C_(n)).toVar(),u=dn(p_(T_(P_(r,s),i,n),T_(P_(r.add(rn(1)),s),i.sub(1),n),T_(P_(r,s.add(rn(1))),i,n.sub(1)),T_(P_(r.add(rn(1)),s.add(rn(1))),i.sub(1),n.sub(1)),a,o)).toVar();return N_(u)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn().toVar(),s=rn().toVar(),i=rn().toVar(),n=tn(h_(t.x,r)).toVar(),a=tn(h_(t.y,s)).toVar(),o=tn(h_(t.z,i)).toVar(),u=tn(C_(n)).toVar(),l=tn(C_(a)).toVar(),d=tn(C_(o)).toVar(),c=dn(g_(T_(P_(r,s,i),n,a,o),T_(P_(r.add(rn(1)),s,i),n.sub(1),a,o),T_(P_(r,s.add(rn(1)),i),n,a.sub(1),o),T_(P_(r.add(rn(1)),s.add(rn(1)),i),n.sub(1),a.sub(1),o),T_(P_(r,s,i.add(rn(1))),n,a,o.sub(1)),T_(P_(r.add(rn(1)),s,i.add(rn(1))),n.sub(1),a,o.sub(1)),T_(P_(r,s.add(rn(1)),i.add(rn(1))),n,a.sub(1),o.sub(1)),T_(P_(r.add(rn(1)),s.add(rn(1)),i.add(rn(1))),n.sub(1),a.sub(1),o.sub(1)),u,l,d)).toVar();return S_(c)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]})]),F_=Ay([Ki(([e])=>{const t=tn(e).toVar(),r=rn(c_(t)).toVar();return w_(M_(r))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),Ki(([e])=>{const t=an(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar();return w_(M_(r,s))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar();return w_(M_(r,s,i))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),Ki(([e])=>{const t=gn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar(),n=rn(c_(t.w)).toVar();return w_(M_(r,s,i,n))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]})]),I_=Ay([Ki(([e])=>{const t=tn(e).toVar(),r=rn(c_(t)).toVar();return dn(w_(M_(r,rn(0))),w_(M_(r,rn(1))),w_(M_(r,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),Ki(([e])=>{const t=an(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar();return dn(w_(M_(r,s,rn(0))),w_(M_(r,s,rn(1))),w_(M_(r,s,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),Ki(([e])=>{const t=dn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar();return dn(w_(M_(r,s,i,rn(0))),w_(M_(r,s,i,rn(1))),w_(M_(r,s,i,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),Ki(([e])=>{const t=gn(e).toVar(),r=rn(c_(t.x)).toVar(),s=rn(c_(t.y)).toVar(),i=rn(c_(t.z)).toVar(),n=rn(c_(t.w)).toVar();return dn(w_(M_(r,s,i,n,rn(0))),w_(M_(r,s,i,n,rn(1))),w_(M_(r,s,i,n,rn(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]})]),D_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar(),u=tn(0).toVar(),l=tn(1).toVar();return Uh(a,()=>{u.addAssign(l.mul(B_(o))),l.mulAssign(i),o.mulAssign(n)}),u}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),U_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar(),u=dn(0).toVar(),l=tn(1).toVar();return Uh(a,()=>{u.addAssign(l.mul(L_(o))),l.mulAssign(i),o.mulAssign(n)}),u}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),V_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar();return an(D_(o,a,n,i),D_(o.add(dn(rn(19),rn(193),rn(17))),a,n,i))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),O_=Ki(([e,t,r,s])=>{const i=tn(s).toVar(),n=tn(r).toVar(),a=rn(t).toVar(),o=dn(e).toVar(),u=dn(U_(o,a,n,i)).toVar(),l=tn(D_(o.add(dn(rn(19),rn(193),rn(17))),a,n,i)).toVar();return gn(u,l)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),G_=Ay([Ki(([e,t,r,s,i,n,a])=>{const o=rn(a).toVar(),u=tn(n).toVar(),l=rn(i).toVar(),d=rn(s).toVar(),c=rn(r).toVar(),h=rn(t).toVar(),p=an(e).toVar(),g=dn(I_(an(h.add(d),c.add(l)))).toVar(),m=an(g.x,g.y).toVar();m.subAssign(.5),m.mulAssign(u),m.addAssign(.5);const f=an(an(tn(h),tn(c)).add(m)).toVar(),y=an(f.sub(p)).toVar();return Zi(o.equal(rn(2)),()=>go(y.x).add(go(y.y))),Zi(o.equal(rn(3)),()=>Mo(go(y.x),go(y.y))),Io(y,y)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Ki(([e,t,r,s,i,n,a,o,u])=>{const l=rn(u).toVar(),d=tn(o).toVar(),c=rn(a).toVar(),h=rn(n).toVar(),p=rn(i).toVar(),g=rn(s).toVar(),m=rn(r).toVar(),f=rn(t).toVar(),y=dn(e).toVar(),b=dn(I_(dn(f.add(p),m.add(h),g.add(c)))).toVar();b.subAssign(.5),b.mulAssign(d),b.addAssign(.5);const x=dn(dn(tn(f),tn(m),tn(g)).add(b)).toVar(),T=dn(x.sub(y)).toVar();return Zi(l.equal(rn(2)),()=>go(T.x).add(go(T.y)).add(go(T.z))),Zi(l.equal(rn(3)),()=>Mo(go(T.x),go(T.y),go(T.z))),Io(T,T)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),k_=Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=an(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=an(h_(n.x,a),h_(n.y,o)).toVar(),l=tn(1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{const r=tn(G_(u,e,t,a,o,i,s)).toVar();l.assign(Co(l,r))})}),Zi(s.equal(rn(0)),()=>{l.assign(to(l))}),l}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),z_=Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=an(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=an(h_(n.x,a),h_(n.y,o)).toVar(),l=an(1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{const r=tn(G_(u,e,t,a,o,i,s)).toVar();Zi(r.lessThan(l.x),()=>{l.y.assign(l.x),l.x.assign(r)}).ElseIf(r.lessThan(l.y),()=>{l.y.assign(r)})})}),Zi(s.equal(rn(0)),()=>{l.assign(to(l))}),l}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),$_=Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=an(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=an(h_(n.x,a),h_(n.y,o)).toVar(),l=dn(1e6,1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{const r=tn(G_(u,e,t,a,o,i,s)).toVar();Zi(r.lessThan(l.x),()=>{l.z.assign(l.y),l.y.assign(l.x),l.x.assign(r)}).ElseIf(r.lessThan(l.y),()=>{l.z.assign(l.y),l.y.assign(r)}).ElseIf(r.lessThan(l.z),()=>{l.z.assign(r)})})}),Zi(s.equal(rn(0)),()=>{l.assign(to(l))}),l}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),H_=Ay([k_,Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=dn(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=rn().toVar(),l=dn(h_(n.x,a),h_(n.y,o),h_(n.z,u)).toVar(),d=tn(1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{Uh({start:-1,end:rn(1),name:"z",condition:"<="},({z:r})=>{const n=tn(G_(l,e,t,r,a,o,u,i,s)).toVar();d.assign(Co(d,n))})})}),Zi(s.equal(rn(0)),()=>{d.assign(to(d))}),d}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),W_=Ay([z_,Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=dn(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=rn().toVar(),l=dn(h_(n.x,a),h_(n.y,o),h_(n.z,u)).toVar(),d=an(1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{Uh({start:-1,end:rn(1),name:"z",condition:"<="},({z:r})=>{const n=tn(G_(l,e,t,r,a,o,u,i,s)).toVar();Zi(n.lessThan(d.x),()=>{d.y.assign(d.x),d.x.assign(n)}).ElseIf(n.lessThan(d.y),()=>{d.y.assign(n)})})})}),Zi(s.equal(rn(0)),()=>{d.assign(to(d))}),d}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),q_=Ay([$_,Ki(([e,t,r])=>{const s=rn(r).toVar(),i=tn(t).toVar(),n=dn(e).toVar(),a=rn().toVar(),o=rn().toVar(),u=rn().toVar(),l=dn(h_(n.x,a),h_(n.y,o),h_(n.z,u)).toVar(),d=dn(1e6,1e6,1e6).toVar();return Uh({start:-1,end:rn(1),name:"x",condition:"<="},({x:e})=>{Uh({start:-1,end:rn(1),name:"y",condition:"<="},({y:t})=>{Uh({start:-1,end:rn(1),name:"z",condition:"<="},({z:r})=>{const n=tn(G_(l,e,t,r,a,o,u,i,s)).toVar();Zi(n.lessThan(d.x),()=>{d.z.assign(d.y),d.y.assign(d.x),d.x.assign(n)}).ElseIf(n.lessThan(d.y),()=>{d.z.assign(d.y),d.y.assign(n)}).ElseIf(n.lessThan(d.z),()=>{d.z.assign(n)})})})}),Zi(s.equal(rn(0)),()=>{d.assign(to(d))}),d}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]})]),j_=Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=rn(e).toVar(),h=an(t).toVar(),p=an(r).toVar(),g=an(s).toVar(),m=tn(i).toVar(),f=tn(n).toVar(),y=tn(a).toVar(),b=nn(o).toVar(),x=rn(u).toVar(),T=tn(l).toVar(),_=tn(d).toVar(),v=h.mul(p).add(g),N=tn(0).toVar();return Zi(c.equal(rn(0)),()=>{N.assign(L_(v))}),Zi(c.equal(rn(1)),()=>{N.assign(I_(v))}),Zi(c.equal(rn(2)),()=>{N.assign(q_(v,m,rn(0)))}),Zi(c.equal(rn(3)),()=>{N.assign(U_(dn(v,0),x,T,_))}),N.assign(N.mul(y.sub(f)).add(f)),Zi(b,()=>{N.assign(Wo(N,f,y))}),N}).setLayout({name:"mx_unifiednoise2d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"texcoord",type:"vec2"},{name:"freq",type:"vec2"},{name:"offset",type:"vec2"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),X_=Ki(([e,t,r,s,i,n,a,o,u,l,d])=>{const c=rn(e).toVar(),h=dn(t).toVar(),p=dn(r).toVar(),g=dn(s).toVar(),m=tn(i).toVar(),f=tn(n).toVar(),y=tn(a).toVar(),b=nn(o).toVar(),x=rn(u).toVar(),T=tn(l).toVar(),_=tn(d).toVar(),v=h.mul(p).add(g),N=tn(0).toVar();return Zi(c.equal(rn(0)),()=>{N.assign(L_(v))}),Zi(c.equal(rn(1)),()=>{N.assign(I_(v))}),Zi(c.equal(rn(2)),()=>{N.assign(q_(v,m,rn(0)))}),Zi(c.equal(rn(3)),()=>{N.assign(U_(v,x,T,_))}),N.assign(N.mul(y.sub(f)).add(f)),Zi(b,()=>{N.assign(Wo(N,f,y))}),N}).setLayout({name:"mx_unifiednoise3d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"position",type:"vec3"},{name:"freq",type:"vec3"},{name:"offset",type:"vec3"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),K_=Ki(([e])=>{const t=e.y,r=e.z,s=dn().toVar();return Zi(t.lessThan(1e-4),()=>{s.assign(dn(r,r,r))}).Else(()=>{let i=e.x;i=i.sub(so(i)).mul(6).toVar();const n=rn(No(i)),a=i.sub(tn(n)),o=r.mul(t.oneMinus()),u=r.mul(t.mul(a).oneMinus()),l=r.mul(t.mul(a.oneMinus()).oneMinus());Zi(n.equal(rn(0)),()=>{s.assign(dn(r,l,o))}).ElseIf(n.equal(rn(1)),()=>{s.assign(dn(u,r,o))}).ElseIf(n.equal(rn(2)),()=>{s.assign(dn(o,r,l))}).ElseIf(n.equal(rn(3)),()=>{s.assign(dn(o,u,r))}).ElseIf(n.equal(rn(4)),()=>{s.assign(dn(l,o,r))}).Else(()=>{s.assign(dn(r,o,u))})}),s}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),Y_=Ki(([e])=>{const t=dn(e).toVar(),r=tn(t.x).toVar(),s=tn(t.y).toVar(),i=tn(t.z).toVar(),n=tn(Co(r,Co(s,i))).toVar(),a=tn(Mo(r,Mo(s,i))).toVar(),o=tn(a.sub(n)).toVar(),u=tn().toVar(),l=tn().toVar(),d=tn().toVar();return d.assign(a),Zi(a.greaterThan(0),()=>{l.assign(o.div(a))}).Else(()=>{l.assign(0)}),Zi(l.lessThanEqual(0),()=>{u.assign(0)}).Else(()=>{Zi(r.greaterThanEqual(a),()=>{u.assign(s.sub(i).div(o))}).ElseIf(s.greaterThanEqual(a),()=>{u.assign(fa(2,i.sub(r).div(o)))}).Else(()=>{u.assign(fa(4,r.sub(s).div(o)))}),u.mulAssign(1/6),Zi(u.lessThan(0),()=>{u.addAssign(1)})}),dn(u,l,d)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),Q_=Ki(([e])=>{const t=dn(e).toVar(),r=pn(Sa(t,dn(.04045))).toVar(),s=dn(t.div(12.92)).toVar(),i=dn(Uo(Mo(t.add(dn(.055)),dn(0)).div(1.055),dn(2.4))).toVar();return Ho(s,i,r)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Z_=(e,t)=>{e=tn(e),t=tn(t);const r=an(t.dFdx(),t.dFdy()).length().mul(.7071067811865476);return Xo(e.sub(r),e.add(r),t)},J_=(e,t,r,s)=>Ho(e,t,r[s].clamp()),ev=(e,t,r,s,i)=>Ho(e,t,Z_(r,s[i])),tv=Ki(([e,t,r])=>{const s=no(e).toVar(),i=ya(tn(.5).mul(t.sub(r)),cd).div(s).toVar(),n=ya(tn(-.5).mul(t.sub(r)),cd).div(s).toVar(),a=dn().toVar();a.x=s.x.greaterThan(tn(0)).select(i.x,n.x),a.y=s.y.greaterThan(tn(0)).select(i.y,n.y),a.z=s.z.greaterThan(tn(0)).select(i.z,n.z);const o=Co(a.x,a.y,a.z).toVar();return cd.add(s.mul(o)).toVar().sub(r)}),rv=Ki(([e,t])=>{const r=e.x,s=e.y,i=e.z;let n=t.element(0).mul(.886227);return n=n.add(t.element(1).mul(1.023328).mul(s)),n=n.add(t.element(2).mul(1.023328).mul(i)),n=n.add(t.element(3).mul(1.023328).mul(r)),n=n.add(t.element(4).mul(.858086).mul(r).mul(s)),n=n.add(t.element(5).mul(.858086).mul(s).mul(i)),n=n.add(t.element(6).mul(i.mul(i).mul(.743125).sub(.247708))),n=n.add(t.element(7).mul(.858086).mul(r).mul(i)),n=n.add(t.element(8).mul(.429043).mul(ba(r,r).sub(ba(s,s)))),n});var sv=Object.freeze({__proto__:null,BRDF_GGX:hg,BRDF_Lambert:Qp,BasicPointShadowFilter:KT,BasicShadowFilter:PT,Break:Vh,Const:pu,Continue:()=>Ku("continue").toStack(),DFGApprox:pg,D_GGX:lg,Discard:Yu,EPSILON:$a,F_Schlick:Yp,Fn:Ki,INFINITY:Ha,If:Zi,Loop:Uh,NodeAccess:$s,NodeShaderStage:Gs,NodeType:zs,NodeUpdateType:ks,OnMaterialUpdate:e=>hb(cb.MATERIAL,e),OnObjectUpdate:e=>hb(cb.OBJECT,e),PCFShadowFilter:BT,PCFSoftShadowFilter:LT,PI:Wa,PI2:qa,PointShadowFilter:YT,Return:()=>Ku("return").toStack(),Schlick_to_F0:mg,ScriptableNodeResources:cx,ShaderNode:Oi,Stack:Ji,Switch:(...e)=>li.Switch(...e),TBNViewMatrix:Tc,VSMShadowFilter:FT,V_GGX_SmithCorrelated:og,Var:hu,VarIntent:gu,abs:go,acesFilmicToneMapping:Qb,acos:ho,add:fa,addMethodChaining:ci,addNodeElement:function(e){console.warn("THREE.TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",e)},agxToneMapping:tx,all:ja,alphaT:Un,and:Aa,anisotropy:Vn,anisotropyB:Gn,anisotropyT:On,any:Xa,append:e=>(console.warn("THREE.TSL: append() has been renamed to Stack()."),Ji(e)),array:la,arrayBuffer:e=>Gi(new oi(e,"ArrayBuffer")),asin:co,assign:ca,atan:po,atan2:eu,atomicAdd:(e,t)=>Fx(Bx.ATOMIC_ADD,e,t),atomicAnd:(e,t)=>Fx(Bx.ATOMIC_AND,e,t),atomicFunc:Fx,atomicLoad:e=>Fx(Bx.ATOMIC_LOAD,e,null),atomicMax:(e,t)=>Fx(Bx.ATOMIC_MAX,e,t),atomicMin:(e,t)=>Fx(Bx.ATOMIC_MIN,e,t),atomicOr:(e,t)=>Fx(Bx.ATOMIC_OR,e,t),atomicStore:(e,t)=>Fx(Bx.ATOMIC_STORE,e,t),atomicSub:(e,t)=>Fx(Bx.ATOMIC_SUB,e,t),atomicXor:(e,t)=>Fx(Bx.ATOMIC_XOR,e,t),attenuationColor:Zn,attenuationDistance:Qn,attribute:rl,attributeArray:(e,t="float")=>{let r,s;!0===t.isStruct?(r=t.layout.getLength(),s=Ms("float")):(r=Ps(t),s=Ms(t));const i=new gb(e,r,s);return Bh(i,t,e)},backgroundBlurriness:Tb,backgroundIntensity:_b,backgroundRotation:vb,batch:wh,bentNormalView:vc,billboarding:Ly,bitAnd:Pa,bitNot:Ba,bitOr:La,bitXor:Fa,bitangentGeometry:fc,bitangentLocal:yc,bitangentView:bc,bitangentWorld:xc,bitcast:xy,blendBurn:yp,blendColor:_p,blendDodge:bp,blendOverlay:Tp,blendScreen:xp,blur:mm,bool:nn,buffer:gl,bufferAttribute:Fu,builtin:bl,bumpMap:wc,burn:(...e)=>(console.warn('THREE.TSL: "burn" has been renamed. Use "blendBurn" instead.'),yp(e)),bvec2:ln,bvec3:pn,bvec4:yn,bypass:Hu,cache:zu,call:pa,cameraFar:Ll,cameraIndex:Pl,cameraNear:Bl,cameraNormalMatrix:Vl,cameraPosition:Ol,cameraProjectionMatrix:Fl,cameraProjectionMatrixInverse:Il,cameraViewMatrix:Dl,cameraViewport:Gl,cameraWorldMatrix:Ul,cbrt:zo,cdl:Ob,ceil:io,checker:o_,cineonToneMapping:Kb,clamp:Wo,clearcoat:Mn,clearcoatNormalView:Rd,clearcoatRoughness:Pn,code:ix,color:en,colorSpaceToWorking:Eu,colorToDirection:e=>Gi(e).mul(2).sub(1),compute:Gu,computeKernel:Ou,computeSkinning:(e,t=null)=>{const r=new Fh(e);return r.positionNode=Bh(new L(e.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(bh).toVar(),r.skinIndexNode=Bh(new L(new Uint32Array(e.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(bh).toVar(),r.skinWeightNode=Bh(new L(e.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(bh).toVar(),r.bindMatrixNode=oa(e.bindMatrix,"mat4"),r.bindMatrixInverseNode=oa(e.bindMatrixInverse,"mat4"),r.boneMatricesNode=gl(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length),r.toPositionNode=t,Gi(r)},context:au,convert:vn,convertColorSpace:(e,t,r)=>Gi(new Nu(Gi(e),t,r)),convertToTexture:(e,...t)=>e.isSampleNode||e.isTextureNode?e:e.isPassNode?e.getTextureNode():ab(e,...t),cos:uo,cross:Do,cubeTexture:Hd,cubeTextureBase:$d,cubeToUV:XT,dFdx:xo,dFdy:To,dashSize:Wn,debug:el,decrement:Ga,decrementBefore:Va,defaultBuildStages:Ws,defaultShaderStages:Hs,defined:Ui,degrees:Ya,deltaTime:Cy,densityFog:function(e,t){return console.warn('THREE.TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),yx(e,fx(t))},densityFogFactor:fx,depth:up,depthPass:(e,t,r)=>Gi(new Wb(Wb.DEPTH,e,t,r)),determinant:Ro,difference:Fo,diffuseColor:Rn,directPointLight:n_,directionToColor:Fp,directionToFaceDirection:bd,dispersion:Jn,distance:Lo,div:xa,dodge:(...e)=>(console.warn('THREE.TSL: "dodge" has been renamed. Use "blendDodge" instead.'),bp(e)),dot:Io,drawIndex:vh,dynamicBufferAttribute:Iu,element:_n,emissive:An,equal:_a,equals:wo,equirectUV:Up,exp:Qa,exp2:Za,expression:Ku,faceDirection:yd,faceForward:Ko,faceforward:tu,float:tn,floatBitsToInt:e=>new by(e,"int","float"),floatBitsToUint:e=>new by(e,"uint","float"),floor:so,fog:yx,fract:ao,frameGroup:sa,frameId:My,frontFacing:fd,fwidth:So,gain:(e,t)=>e.lessThan(.5)?_y(e.mul(2),t).div(2):ya(1,_y(ba(ya(1,e),2),t).div(2)),gapSize:qn,getConstNodeType:Vi,getCurrentStack:Qi,getDirection:cm,getDistanceAttenuation:i_,getGeometryRoughness:ng,getNormalFromDepth:lb,getParallaxCorrectNormal:tv,getRoughness:ag,getScreenPosition:ub,getShIrradianceAt:rv,getShadowMaterial:DT,getShadowRenderObjectFunction:OT,getTextureIndex:my,getViewPosition:ob,globalId:Rx,glsl:(e,t)=>ix(e,t,"glsl"),glslFn:(e,t)=>ax(e,t,"glsl"),grayscale:Fb,greaterThan:Sa,greaterThanEqual:Ra,hash:Ty,highpModelNormalViewMatrix:od,highpModelViewMatrix:ad,hue:Ub,increment:Oa,incrementBefore:Ua,instance:Sh,instanceIndex:bh,instancedArray:(e,t="float")=>{let r,s;!0===t.isStruct?(r=t.layout.getLength(),s=Ms("float")):(r=Ps(t),s=Ms(t));const i=new pb(e,r,s);return Bh(i,t,e)},instancedBufferAttribute:Du,instancedDynamicBufferAttribute:Uu,instancedMesh:Rh,int:rn,intBitsToFloat:e=>new by(e,"float","int"),inverse:Ao,inverseSqrt:ro,inversesqrt:ru,invocationLocalIndex:_h,invocationSubgroupIndex:Th,ior:Xn,iridescence:Fn,iridescenceIOR:In,iridescenceThickness:Dn,ivec2:on,ivec3:cn,ivec4:mn,js:(e,t)=>ix(e,t,"js"),label:lu,length:fo,lengthSq:$o,lessThan:Na,lessThanEqual:Ea,lightPosition:cT,lightProjectionUV:dT,lightShadowMatrix:lT,lightTargetDirection:gT,lightTargetPosition:hT,lightViewPosition:pT,lightingContext:jh,lights:(e=[])=>Gi(new bT).setLights(e),linearDepth:lp,linearToneMapping:jb,localId:Ax,log:Ja,log2:eo,logarithmicDepthToViewZ:(e,t,r)=>{const s=e.mul(Ja(r.div(t)));return tn(Math.E).pow(s).mul(t).negate()},luminance:Vb,mat2:bn,mat3:xn,mat4:Tn,matcapUV:rf,materialAO:ph,materialAlphaTest:Pc,materialAnisotropy:Yc,materialAnisotropyVector:gh,materialAttenuationColor:ih,materialAttenuationDistance:sh,materialClearcoat:Hc,materialClearcoatNormal:qc,materialClearcoatRoughness:Wc,materialColor:Bc,materialDispersion:ch,materialEmissive:Fc,materialEnvIntensity:Id,materialEnvRotation:Dd,materialIOR:rh,materialIridescence:Qc,materialIridescenceIOR:Zc,materialIridescenceThickness:Jc,materialLightMap:hh,materialLineDashOffset:lh,materialLineDashSize:ah,materialLineGapSize:oh,materialLineScale:nh,materialLineWidth:uh,materialMetalness:zc,materialNormal:$c,materialOpacity:Ic,materialPointSize:dh,materialReference:Yd,materialReflectivity:Gc,materialRefractionRatio:Fd,materialRotation:jc,materialRoughness:kc,materialSheen:Xc,materialSheenRoughness:Kc,materialShininess:Lc,materialSpecular:Dc,materialSpecularColor:Vc,materialSpecularIntensity:Uc,materialSpecularStrength:Oc,materialThickness:th,materialTransmission:eh,max:Mo,maxMipLevel:ol,mediumpModelViewMatrix:nd,metalness:Cn,min:Co,mix:Ho,mixElement:Qo,mod:Ta,modInt:ka,modelDirection:Yl,modelNormalMatrix:rd,modelPosition:Zl,modelRadius:td,modelScale:Jl,modelViewMatrix:id,modelViewPosition:ed,modelViewProjection:mh,modelWorldMatrix:Ql,modelWorldMatrixInverse:sd,morphReference:$h,mrt:yy,mul:ba,mx_aastep:Z_,mx_add:(e,t=tn(0))=>fa(e,t),mx_atan2:(e=tn(0),t=tn(1))=>po(e,t),mx_cell_noise_float:(e=sl())=>F_(e.convert("vec2|vec3")),mx_contrast:(e,t=1,r=.5)=>tn(e).sub(r).mul(t).add(r),mx_divide:(e,t=tn(1))=>xa(e,t),mx_fractal_noise_float:(e=sl(),t=3,r=2,s=.5,i=1)=>D_(e,rn(t),r,s).mul(i),mx_fractal_noise_vec2:(e=sl(),t=3,r=2,s=.5,i=1)=>V_(e,rn(t),r,s).mul(i),mx_fractal_noise_vec3:(e=sl(),t=3,r=2,s=.5,i=1)=>U_(e,rn(t),r,s).mul(i),mx_fractal_noise_vec4:(e=sl(),t=3,r=2,s=.5,i=1)=>O_(e,rn(t),r,s).mul(i),mx_frame:()=>My,mx_heighttonormal:(e,t)=>(e=dn(e),t=tn(t),wc(e,t)),mx_hsvtorgb:K_,mx_ifequal:(e,t,r,s)=>e.equal(t).mix(r,s),mx_ifgreater:(e,t,r,s)=>e.greaterThan(t).mix(r,s),mx_ifgreatereq:(e,t,r,s)=>e.greaterThanEqual(t).mix(r,s),mx_invert:(e,t=tn(1))=>ya(t,e),mx_modulo:(e,t=tn(1))=>Ta(e,t),mx_multiply:(e,t=tn(1))=>ba(e,t),mx_noise_float:(e=sl(),t=1,r=0)=>B_(e.convert("vec2|vec3")).mul(t).add(r),mx_noise_vec3:(e=sl(),t=1,r=0)=>L_(e.convert("vec2|vec3")).mul(t).add(r),mx_noise_vec4:(e=sl(),t=1,r=0)=>{e=e.convert("vec2|vec3");return gn(L_(e),B_(e.add(an(19,73)))).mul(t).add(r)},mx_place2d:(e,t=an(.5,.5),r=an(1,1),s=tn(0),i=an(0,0))=>{let n=e;if(t&&(n=n.sub(t)),r&&(n=n.mul(r)),s){const e=s.mul(Math.PI/180),t=e.cos(),r=e.sin();n=an(n.x.mul(t).sub(n.y.mul(r)),n.x.mul(r).add(n.y.mul(t)))}return t&&(n=n.add(t)),i&&(n=n.add(i)),n},mx_power:(e,t=tn(1))=>Uo(e,t),mx_ramp4:(e,t,r,s,i=sl())=>{const n=i.x.clamp(),a=i.y.clamp(),o=Ho(e,t,n),u=Ho(r,s,n);return Ho(o,u,a)},mx_ramplr:(e,t,r=sl())=>J_(e,t,r,"x"),mx_ramptb:(e,t,r=sl())=>J_(e,t,r,"y"),mx_rgbtohsv:Y_,mx_rotate2d:(e,t)=>{e=an(e);const r=(t=tn(t)).mul(Math.PI/180);return of(e,r)},mx_rotate3d:(e,t,r)=>{e=dn(e),t=tn(t),r=dn(r);const s=t.mul(Math.PI/180),i=r.normalize(),n=s.cos(),a=s.sin(),o=tn(1).sub(n);return e.mul(n).add(i.cross(e).mul(a)).add(i.mul(i.dot(e)).mul(o))},mx_safepower:(e,t=1)=>(e=tn(e)).abs().pow(t).mul(e.sign()),mx_separate:(e,t=null)=>{if("string"==typeof t){const r={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3},s=t.replace(/^out/,"").toLowerCase();if(void 0!==r[s])return e.element(r[s])}if("number"==typeof t)return e.element(t);if("string"==typeof t&&1===t.length){const r={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};if(void 0!==r[t])return e.element(r[t])}return e},mx_splitlr:(e,t,r,s=sl())=>ev(e,t,r,s,"x"),mx_splittb:(e,t,r,s=sl())=>ev(e,t,r,s,"y"),mx_srgb_texture_to_lin_rec709:Q_,mx_subtract:(e,t=tn(0))=>ya(e,t),mx_timer:()=>wy,mx_transform_uv:(e=1,t=0,r=sl())=>r.mul(e).add(t),mx_unifiednoise2d:(e,t=sl(),r=an(1,1),s=an(0,0),i=1,n=0,a=1,o=!1,u=1,l=2,d=.5)=>j_(e,t.convert("vec2|vec3"),r,s,i,n,a,o,u,l,d),mx_unifiednoise3d:(e,t=sl(),r=an(1,1),s=an(0,0),i=1,n=0,a=1,o=!1,u=1,l=2,d=.5)=>X_(e,t.convert("vec2|vec3"),r,s,i,n,a,o,u,l,d),mx_worley_noise_float:(e=sl(),t=1)=>H_(e.convert("vec2|vec3"),t,rn(1)),mx_worley_noise_vec2:(e=sl(),t=1)=>W_(e.convert("vec2|vec3"),t,rn(1)),mx_worley_noise_vec3:(e=sl(),t=1)=>q_(e.convert("vec2|vec3"),t,rn(1)),negate:yo,neutralToneMapping:rx,nodeArray:$i,nodeImmutable:Wi,nodeObject:Gi,nodeObjectIntent:ki,nodeObjects:zi,nodeProxy:Hi,nodeProxyIntent:qi,normalFlat:_d,normalGeometry:xd,normalLocal:Td,normalMap:Sc,normalView:Sd,normalViewGeometry:vd,normalWorld:Ed,normalWorldGeometry:Nd,normalize:no,not:Ca,notEqual:va,numWorkgroups:Sx,objectDirection:$l,objectGroup:na,objectPosition:Wl,objectRadius:Xl,objectScale:ql,objectViewPosition:jl,objectWorldMatrix:Hl,oneMinus:bo,or:wa,orthographicDepthToViewZ:(e,t,r)=>t.sub(r).mul(e).sub(t),oscSawtooth:(e=wy)=>e.fract(),oscSine:(e=wy)=>e.add(.75).mul(2*Math.PI).sin().mul(.5).add(.5),oscSquare:(e=wy)=>e.fract().round(),oscTriangle:(e=wy)=>e.add(.5).fract().mul(2).sub(1).abs(),output:Hn,outputStruct:gy,overlay:(...e)=>(console.warn('THREE.TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),Tp(e)),overloadingFn:Ay,parabola:_y,parallaxDirection:_c,parallaxUV:(e,t)=>e.sub(_c.mul(t)),parameter:(e,t)=>Gi(new uy(e,t)),pass:(e,t,r)=>Gi(new Wb(Wb.COLOR,e,t,r)),passTexture:(e,t)=>Gi(new $b(e,t)),pcurve:(e,t,r)=>Uo(xa(Uo(e,t),fa(Uo(e,t),Uo(ya(1,e),r))),1/t),perspectiveDepthToViewZ:np,pmremTexture:km,pointShadow:r_,pointUV:fb,pointWidth:jn,positionGeometry:ud,positionLocal:ld,positionPrevious:dd,positionView:pd,positionViewDirection:gd,positionWorld:cd,positionWorldDirection:hd,posterize:kb,pow:Uo,pow2:Vo,pow3:Oo,pow4:Go,premultiplyAlpha:vp,property:Sn,quadBroadcast:aT,quadSwapDiagonal:eT,quadSwapX:Zx,quadSwapY:Jx,radians:Ka,rand:Yo,range:_x,rangeFog:function(e,t,r){return console.warn('THREE.TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),yx(e,mx(t,r))},rangeFogFactor:mx,reciprocal:vo,reference:jd,referenceBuffer:Xd,reflect:Bo,reflectVector:Od,reflectView:Ud,reflector:e=>Gi(new Zy(e)),refract:jo,refractVector:Gd,refractView:Vd,reinhardToneMapping:Xb,remap:qu,remapClamp:ju,renderGroup:ia,renderOutput:Zu,rendererReference:Cu,rotate:of,rotateUV:Py,roughness:wn,round:_o,rtt:ab,sRGBTransferEOTF:Tu,sRGBTransferOETF:_u,sample:(e,t=null)=>Gi(new db(e,Gi(t))),sampler:e=>(!0===e.isNode?e:cl(e)).convert("sampler"),samplerComparison:e=>(!0===e.isNode?e:cl(e)).convert("samplerComparison"),saturate:qo,saturation:Ib,screen:(...e)=>(console.warn('THREE.TSL: "screen" has been renamed. Use "blendScreen" instead.'),xp(e)),screenCoordinate:El,screenDPR:vl,screenSize:Sl,screenUV:Nl,scriptable:px,scriptableValue:ux,select:iu,setCurrentStack:Yi,setName:uu,shaderStages:qs,shadow:qT,shadowPositionWorld:TT,shapeCircle:u_,sharedUniformGroup:ra,sheen:Bn,sheenRoughness:Ln,shiftLeft:Ia,shiftRight:Da,shininess:$n,sign:mo,sin:oo,sinc:(e,t)=>oo(Wa.mul(t.mul(e).sub(1))).div(Wa.mul(t.mul(e).sub(1))),skinning:Ih,smoothstep:Xo,smoothstepElement:Zo,specularColor:kn,specularF90:zn,spherizeUV:By,split:(e,t)=>Gi(new ri(Gi(e),t)),spritesheetUV:Dy,sqrt:to,stack:dy,step:Po,stepElement:Jo,storage:Bh,storageBarrier:()=>Cx("storage").toStack(),storageObject:(e,t,r)=>(console.warn('THREE.TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),Bh(e,t,r).setPBO(!0)),storageTexture:Sb,string:(e="")=>Gi(new oi(e,"string")),struct:(e,t=null)=>{const r=new cy(e,t),s=(...t)=>{let s=null;if(t.length>0)if(t[0].isNode){s={};const r=Object.keys(e);for(let e=0;e<t.length;e++)s[r[e]]=t[e]}else s=t[0];return Gi(new hy(r,s))};return s.layout=r,s.isStruct=!0,s},sub:ya,subBuild:fu,subgroupAdd:Vx,subgroupAll:Kx,subgroupAnd:Hx,subgroupAny:Yx,subgroupBallot:Ux,subgroupBroadcast:tT,subgroupBroadcastFirst:Qx,subgroupElect:Dx,subgroupExclusiveAdd:Gx,subgroupExclusiveMul:$x,subgroupInclusiveAdd:Ox,subgroupInclusiveMul:zx,subgroupIndex:xh,subgroupMax:Xx,subgroupMin:jx,subgroupMul:kx,subgroupOr:Wx,subgroupShuffle:rT,subgroupShuffleDown:nT,subgroupShuffleUp:iT,subgroupShuffleXor:sT,subgroupSize:wx,subgroupXor:qx,tan:lo,tangentGeometry:cc,tangentLocal:hc,tangentView:pc,tangentWorld:gc,texture:cl,texture3D:Ab,textureBarrier:()=>Cx("texture").toStack(),textureBicubic:Ig,textureBicubicLevel:Fg,textureCubeUV:hm,textureLoad:hl,textureSize:nl,textureStore:(e,t,r)=>{const s=Sb(e,t,r);return null!==r&&s.toStack(),s},thickness:Yn,time:wy,toneMapping:Pu,toneMappingExposure:Bu,toonOutlinePass:(t,r,s=new e(0,0,0),i=.003,n=1)=>Gi(new qb(t,r,Gi(s),Gi(i),Gi(n))),transformDirection:ko,transformNormal:Ad,transformNormalToView:wd,transformedClearcoatNormalView:Pd,transformedNormalView:Cd,transformedNormalWorld:Md,transmission:Kn,transpose:Eo,triNoise3D:Sy,triplanarTexture:(...e)=>Uy(...e),triplanarTextures:Uy,trunc:No,uint:sn,uintBitsToFloat:e=>new by(e,"float","uint"),uniform:oa,uniformArray:yl,uniformCubeTexture:(e=kd)=>$d(e),uniformFlow:ou,uniformGroup:ta,uniformTexture:(e=ul)=>cl(e),unpremultiplyAlpha:Np,userData:(e,t,r)=>Gi(new wb(e,t,r)),uv:sl,uvec2:un,uvec3:hn,uvec4:fn,varying:bu,varyingProperty:En,vec2:an,vec3:dn,vec4:gn,vectorComponents:js,velocity:Lb,vertexColor:fp,vertexIndex:yh,vertexStage:xu,vibrance:Db,viewZToLogarithmicDepth:ap,viewZToOrthographicDepth:sp,viewZToPerspectiveDepth:ip,viewport:Rl,viewportCoordinate:wl,viewportDepthTexture:tp,viewportLinearDepth:dp,viewportMipTexture:Zh,viewportResolution:Ml,viewportSafeUV:Fy,viewportSharedTexture:Pp,viewportSize:Al,viewportTexture:Qh,viewportUV:Cl,wgsl:(e,t)=>ix(e,t,"wgsl"),wgslFn:(e,t)=>ax(e,t,"wgsl"),workgroupArray:(e,t)=>Gi(new Px("Workgroup",e,t)),workgroupBarrier:()=>Cx("workgroup").toStack(),workgroupId:Ex,workingToColorSpace:Su,xor:Ma});const iv=new oy;class nv extends wf{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,r){const s=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background;let n=!1;if(null===i)s._clearColor.getRGB(iv),iv.a=s._clearColor.a;else if(!0===i.isColor)i.getRGB(iv),iv.a=1,n=!0;else if(!0===i.isNode){const o=this.get(e),u=i;iv.copy(s._clearColor);let l=o.backgroundMesh;if(void 0===l){const c=au(gn(u).mul(_b),{getUV:()=>vb.mul(Nd),getTextureLevel:()=>Tb});let h=mh;h=h.setZ(h.w);const p=new Sp;function g(){i.removeEventListener("dispose",g),l.material.dispose(),l.geometry.dispose()}p.name="Background.material",p.side=S,p.depthTest=!1,p.depthWrite=!1,p.allowOverride=!1,p.fog=!1,p.lights=!1,p.vertexNode=h,p.colorNode=c,o.backgroundMeshNode=c,o.backgroundMesh=l=new X(new Ge(1,32,32),p),l.frustumCulled=!1,l.name="Background.mesh",l.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},i.addEventListener("dispose",g)}const d=u.getCacheKey();o.backgroundCacheKey!==d&&(o.backgroundMeshNode.node=gn(u).mul(_b),o.backgroundMeshNode.needsUpdate=!0,l.material.needsUpdate=!0,o.backgroundCacheKey=d),t.unshift(l,l.geometry,l.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);const a=s.xr.getEnvironmentBlendMode();if("additive"===a?iv.set(0,0,0,1):"alpha-blend"===a&&iv.set(0,0,0,0),!0===s.autoClear||!0===n){const m=r.clearColorValue;m.r=iv.r,m.g=iv.g,m.b=iv.b,m.a=iv.a,!0!==s.backend.isWebGLBackend&&!0!==s.alpha||(m.r*=m.a,m.g*=m.a,m.b*=m.a),r.depthClearValue=s._clearDepth,r.stencilClearValue=s._clearStencil,r.clearColor=!0===s.autoClearColor,r.clearDepth=!0===s.autoClearDepth,r.clearStencil=!0===s.autoClearStencil}else r.clearColor=!1,r.clearDepth=!1,r.clearStencil=!1}}let av=0;class ov{constructor(e="",t=[],r=0,s=[]){this.name=e,this.bindings=t,this.index=r,this.bindingsReference=s,this.id=av++}}class uv{constructor(e,t,r,s,i,n,a,o,u,l=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=r,this.transforms=l,this.nodeAttributes=s,this.bindings=i,this.updateNodes=n,this.updateBeforeNodes=a,this.updateAfterNodes=o,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings){if(!0!==t.bindings[0].groupNode.shared){const r=new ov(t.name,[],t.index,t.bindingsReference);e.push(r);for(const e of t.bindings)r.bindings.push(e.clone())}else e.push(t)}return e}}class lv{constructor(e,t,r=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=r}}class dv{constructor(e,t,r){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=r}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class cv{constructor(e,t,r=!1,s=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=r,this.count=s}}class hv extends cv{constructor(e,t,r=null,s=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=r,this.interpolationSampling=s}}class pv{constructor(e,t,r=""){this.name=e,this.type=t,this.code=r,Object.defineProperty(this,"isNodeCode",{value:!0})}}let gv=0;class mv{constructor(e=null){this.id=gv++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return void 0===t&&null!==this.parent&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class fv{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class yv{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class bv extends yv{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class xv extends yv{constructor(e,r=new t){super(e,r),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class Tv extends yv{constructor(e,t=new r){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class _v extends yv{constructor(e,t=new s){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class vv extends yv{constructor(t,r=new e){super(t,r),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class Nv extends yv{constructor(e,t=new i){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class Sv extends yv{constructor(e,t=new n){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class Ev extends yv{constructor(e,t=new a){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class Rv extends bv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Av extends xv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class wv extends Tv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Cv extends _v{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Mv extends vv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Pv extends Nv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Bv extends Sv{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class Lv extends Ev{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const Fv=new WeakMap,Iv=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),Dv=e=>/e/g.test(e)?String(e).replace(/\+/g,""):(e=Number(e))+(e%1?"":".0");class Uv{constructor(e,t,r){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=r,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=dy(),this.stacks=[],this.tab="\t",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new mv,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.currentStack=null,this.subBuildFn=null}getBindGroupsCache(){let e=Fv.get(this.renderer);return void 0===e&&(e=new Nf,Fv.set(this.renderer,e)),e}createRenderTarget(e,t,r){return new ue(e,t,r)}createCubeRenderTarget(e,t){return new Vp(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const r=this.getBindGroupsCache(),s=[];let i,n=!0;for(const e of t)s.push(e),n=n&&!0!==e.groupNode.shared;return n?(i=r.get(s),void 0===i&&(i=new ov(e,s,this.bindingsIndexes[e].group,s),r.set(s,i))):i=new ov(e,s,this.bindingsIndexes[e].group,s),i}getBindGroupArray(e,t){const r=this.bindings[t];let s=r[e];return void 0===s&&(void 0===this.bindingsIndexes[e]&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),r[e]=s=[]),s}getBindings(){let e=this.bindGroups;if(null===e){const t={},r=this.bindings;for(const e of qs)for(const s in r[e]){const i=r[e][s];(t[s]||(t[s]=[])).push(...i)}e=[];for(const r in t){const s=t[r],i=this._getBindGroup(r,s);e.push(i)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((e,t)=>e.bindings[0].groupNode.order-t.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const r=e[t];this.bindingsIndexes[r.name].group=t,r.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){!1===this.nodes.includes(e)&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){!1===this.sequentialNodes.includes(e)&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes){e.getUpdateType()!==ks.NONE&&this.updateNodes.push(e)}for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),r=e.getUpdateAfterType();t!==ks.NONE&&this.updateBeforeNodes.push(e),r!==ks.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Y||e.magFilter===ke||e.magFilter===ze||e.magFilter===U||e.minFilter===Y||e.minFilter===ke||e.minFilter===ze||e.minFilter===U}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return this.context,this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const r=this.getDataFromNode(e);return void 0===r.cache&&(r.cache=new mv(t?this.getCache():null)),r.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=void 0===t.usageCount?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,r=null){let s=this.generateArrayDeclaration(e,t)+"( ";for(let i=0;i<t;i++){const n=r?r[i]:null;s+=null!==n?n.build(this,e):this.generateConst(e),i<t-1&&(s+=", ")}return s+=" )",s}generateStruct(e,t,r=null){const s=[];for(const e of t){const{name:t,type:i}=e;r&&r[t]&&r[t].isNode?s.push(r[t].build(this,i)):s.push(this.generateConst(i))}return e+"( "+s.join(", ")+" )"}generateConst(i,n=null){if(null===n&&("float"===i||"int"===i||"uint"===i?n=0:"bool"===i?n=!1:"color"===i?n=new e:"vec2"===i?n=new t:"vec3"===i?n=new r:"vec4"===i&&(n=new s)),"float"===i)return Dv(n);if("int"===i)return`${Math.round(n)}`;if("uint"===i)return n>=0?`${Math.round(n)}u`:"0u";if("bool"===i)return n?"true":"false";if("color"===i)return`${this.getType("vec3")}( ${Dv(n.r)}, ${Dv(n.g)}, ${Dv(n.b)} )`;const a=this.getTypeLength(i),o=this.getComponentType(i),u=e=>this.generateConst(o,e);if(2===a)return`${this.getType(i)}( ${u(n.x)}, ${u(n.y)} )`;if(3===a)return`${this.getType(i)}( ${u(n.x)}, ${u(n.y)}, ${u(n.z)} )`;if(4===a&&"mat2"!==i)return`${this.getType(i)}( ${u(n.x)}, ${u(n.y)}, ${u(n.z)}, ${u(n.w)} )`;if(a>=4&&n&&(n.isMatrix2||n.isMatrix3||n.isMatrix4))return`${this.getType(i)}( ${n.elements.map(u).join(", ")} )`;if(a>4)return`${this.getType(i)}()`;throw new Error(`NodeBuilder: Type '${i}' not found in generate constant attempt.`)}getType(e){return"color"===e?"vec3":e}hasGeometryAttribute(e){return this.geometry&&void 0!==this.geometry.getAttribute(e)}getAttribute(e,t){const r=this.attributes;for(const t of r)if(t.name===e)return t;const s=new lv(e,t);return this.registerDeclaration(s),r.push(s),s}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return"void"===e||"property"===e||"sampler"===e||"samplerComparison"===e||"texture"===e||"cubeTexture"===e||"storageTexture"===e||"depthTexture"===e||"texture3D"===e}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===_)return"int";if(t===T)return"uint"}return"float"}getElementType(e){return"mat2"===e?"vec2":"mat3"===e?"vec3":"mat4"===e?"vec4":this.getComponentType(e)}getComponentType(e){if("float"===(e=this.getVectorType(e))||"bool"===e||"int"===e||"uint"===e)return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return null===t?null:"b"===t[1]?"bool":"i"===t[1]?"int":"u"===t[1]?"uint":"float"}getVectorType(e){return"color"===e?"vec3":"texture"===e||"cubeTexture"===e||"storageTexture"===e||"texture3D"===e?"vec4":e}getTypeFromLength(e,t="float"){if(1===e)return t;let r=Cs(e);const s="float"===t?"":t[0];return!0===/mat2/.test(t)&&(r=r.replace("vec","mat")),s+r}getTypeFromArray(e){return Iv.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const r=t.array,s=e.itemSize,i=e.normalized;let n;return e instanceof $e||!0===i||(n=this.getTypeFromArray(r)),this.getTypeFromLength(s,n)}getTypeLength(e){const t=this.getVectorType(e),r=/vec([2-4])/.exec(t);return null!==r?Number(r[1]):"float"===t||"bool"===t||"int"===t||"uint"===t?1:!0===/mat2/.test(e)?4:!0===/mat3/.test(e)?9:!0===/mat4/.test(e)?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return"int"===t||"uint"===t?e:this.changeComponentType(e,"int")}addStack(){this.stack=dy(this.stack);const e=Qi();return this.stacks.push(e),Yi(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,Yi(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,r=null){let s=(r=null===r?e.isGlobal(this)?this.globalCache:this.cache:r).getData(e);void 0===s&&(s={},r.setData(e,s)),void 0===s[t]&&(s[t]={});let i=s[t];const n=s.any?s.any.subBuilds:null,a=this.getClosestSubBuild(n);return a&&(void 0===i.subBuildsCache&&(i.subBuildsCache={}),i=i.subBuildsCache[a]||(i.subBuildsCache[a]={}),i.subBuilds=n),i}getNodeProperties(e,t="any"){const r=this.getDataFromNode(e,t);return r.properties||(r.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const r=this.getDataFromNode(e);let s=r.bufferAttribute;if(void 0===s){const i=this.uniforms.index++;s=new lv("nodeAttribute"+i,t,e),this.bufferAttributes.push(s),r.bufferAttribute=s}return s}getStructTypeNode(e,t=this.shaderStage){return this.types[t][e]||null}getStructTypeFromNode(e,t,r=null,s=this.shaderStage){const i=this.getDataFromNode(e,s,this.globalCache);let n=i.structType;if(void 0===n){const a=this.structs.index++;null===r&&(r="StructType"+a),n=new fv(r,t),this.structs[s].push(n),this.types[s][r]=e,i.structType=n}return n}getOutputStructTypeFromNode(e,t){const r=this.getStructTypeFromNode(e,t,"OutputType","fragment");return r.output=!0,r}getUniformFromNode(e,t,r=this.shaderStage,s=null){const i=this.getDataFromNode(e,r,this.globalCache);let n=i.uniform;if(void 0===n){const a=this.uniforms.index++;n=new dv(s||"nodeUniform"+a,t,e),this.uniforms[r].push(n),this.registerDeclaration(n),i.uniform=n}return n}getVarFromNode(e,t=null,r=e.getNodeType(this),s=this.shaderStage,i=!1){const n=this.getDataFromNode(e,s),a=this.getSubBuildProperty("variable",n.subBuilds);let o=n[a];if(void 0===o){const u=i?"_const":"_var",l=this.vars[s]||(this.vars[s]=[]),d=this.vars[u]||(this.vars[u]=0);null===t&&(t=(i?"nodeConst":"nodeVar")+d,this.vars[u]++),"variable"!==a&&(t=this.getSubBuildProperty(t,n.subBuilds));const c=e.getArrayCount(this);o=new cv(t,r,i,c),i||l.push(o),this.registerDeclaration(o),n[a]=o}return o}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode))&&(!e.cNode||this.isDeterministic(e.cNode));if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(!e.bNode||this.isDeterministic(e.bNode));if(e.isArrayNode){if(null!==e.values)for(const t of e.values)if(!this.isDeterministic(t))return!1;return!0}return!!e.isConstNode}getVaryingFromNode(e,t=null,r=e.getNodeType(this),s=null,i=null){const n=this.getDataFromNode(e,"any"),a=this.getSubBuildProperty("varying",n.subBuilds);let o=n[a];if(void 0===o){const e=this.varyings,u=e.length;null===t&&(t="nodeVarying"+u),"varying"!==a&&(t=this.getSubBuildProperty(t,n.subBuilds)),o=new hv(t,r,s,i),e.push(o),this.registerDeclaration(o),n[a]=o}return o}registerDeclaration(e){const t=this.shaderStage,r=this.declarations[t]||(this.declarations[t]={}),s=this.getPropertyName(e);let i=1,n=s;for(;void 0!==r[n];)n=s+"_"+i++;i>1&&(e.name=n,console.warn(`THREE.TSL: Declaration name '${s}' of '${e.type}' already in use. Renamed to '${n}'.`)),r[n]=e}getCodeFromNode(e,t,r=this.shaderStage){const s=this.getDataFromNode(e);let i=s.code;if(void 0===i){const e=this.codes[r]||(this.codes[r]=[]),n=e.length;i=new pv("nodeCode"+n,t),e.push(i),s.code=i}return i}addFlowCodeHierarchy(e,t){const{flowCodes:r,flowCodeBlock:s}=this.getDataFromNode(e);let i=!0,n=t;for(;n;){if(!0===s.get(n)){i=!1;break}n=this.getDataFromNode(n).parentNodeBlock}if(i)for(const e of r)this.addLineFlowCode(e)}addLineFlowCodeBlock(e,t,r){const s=this.getDataFromNode(e),i=s.flowCodes||(s.flowCodes=[]),n=s.flowCodeBlock||(s.flowCodeBlock=new WeakMap);i.push(t),n.set(r,!0)}addLineFlowCode(e,t=null){return""===e||(null!==t&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e+=";\n"),this.flow.code+=e),this}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="\t",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),r=this.flowChildNode(e,t);return this.flowsData.set(e,r),r}addInclude(e){null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new nx,r=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=r,t}flowShaderNode(e){const t=e.layout,r={[Symbol.iterator](){let e=0;const t=Object.values(this);return{next:()=>({value:t[e],done:e++>=t.length})}}};for(const e of t.inputs)r[e.name]=new uy(e.type,e.name);e.layout=null;const s=e.call(r),i=this.flowStagesNode(s,t.type);return e.layout=t,i}flowBuildStage(e,t,r=null){const s=this.getBuildStage();this.setBuildStage(t);const i=e.build(this,r);return this.setBuildStage(s),i}flowStagesNode(e,t=null){const r=this.flow,s=this.vars,i=this.declarations,n=this.cache,a=this.buildStage,o=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new mv,this.stack=dy();for(const r of Ws)this.setBuildStage(r),u.result=e.build(this,t);return u.vars=this.getVars(this.shaderStage),this.flow=r,this.vars=s,this.declarations=i,this.cache=n,this.stack=o,this.setBuildStage(a),u}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,t=null){const r=this.flow,s={code:""};return this.flow=s,s.result=e.build(this,t),this.flow=r,s}flowNodeFromShaderStage(e,t,r=null,s=null){const i=this.tab,n=this.cache,a=this.shaderStage,o=this.context;this.setShaderStage(e);const u={...this.context};delete u.nodeBlock,this.cache=this.globalCache,this.tab="\t",this.context=u;let l=null;if("generate"===this.buildStage){const i=this.flowChildNode(t,r);null!==s&&(i.code+=`${this.tab+s} = ${i.result};\n`),this.flowCode[e]=this.flowCode[e]+i.code,l=i}else l=t.build(this);return this.setShaderStage(a),this.cache=n,this.tab=i,this.context=o,l}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t,r=null){return`${null!==r?this.generateArrayDeclaration(e,r):this.getType(e)} ${t}`}getVars(e){let t="";const r=this.vars[e];if(void 0!==r)for(const e of r)t+=`${this.getVar(e.type,e.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let r="";if(void 0!==t)for(const e of t)r+=e.code+"\n";return r}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(t=e&&e.isNode?e.isShaderCallNodeInternal?e.shaderNode.subBuilds:e.isStackNode?[e.subBuild]:this.getDataFromNode(e,"any").subBuilds:e instanceof Set?[...e]:e,!t)return null;const r=this.subBuildLayers;for(let e=t.length-1;e>=0;e--){const s=t[e];if(r.includes(s))return s}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",t=null){let r,s;return r=null!==t?this.getClosestSubBuild(t):this.subBuildFn,s=r?e?r+"_"+e:r:e,s}build(){const{object:e,material:t,renderer:r}=this;if(null!==t){let e=r.library.fromMaterial(t);null===e&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),e=new Sp),e.build(this)}else this.addFlow("compute",e);for(const e of Ws){this.setBuildStage(e),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const t of qs){this.setShaderStage(t);const r=this.flowNodes[t];for(const t of r)"generate"===e?this.flowNode(t):t.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if("float"===t||"int"===t||"uint"===t)return new Rv(e);if("vec2"===t||"ivec2"===t||"uvec2"===t)return new Av(e);if("vec3"===t||"ivec3"===t||"uvec3"===t)return new wv(e);if("vec4"===t||"ivec4"===t||"uvec4"===t)return new Cv(e);if("color"===t)return new Mv(e);if("mat2"===t)return new Pv(e);if("mat3"===t)return new Bv(e);if("mat4"===t)return new Lv(e);throw new Error(`Uniform "${t}" not declared.`)}format(e,t,r){if((t=this.getVectorType(t))===(r=this.getVectorType(r))||null===r||this.isReference(r))return e;const s=this.getTypeLength(t),i=this.getTypeLength(r);return 16===s&&9===i?`${this.getType(r)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:9===s&&4===i?`${this.getType(r)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:s>4||i>4||0===i?e:s===i?`${this.getType(r)}( ${e} )`:s>i?(e="bool"===r?`all( ${e} )`:`${e}.${"xyz".slice(0,i)}`,this.format(e,this.getTypeFromLength(i,this.getComponentType(t)),r)):4===i&&s>1?`${this.getType(r)}( ${this.format(e,t,"vec3")}, 1.0 )`:2===s?`${this.getType(r)}( ${this.format(e,t,"vec2")}, 0.0 )`:(1===s&&i>1&&t!==this.getComponentType(r)&&(e=`${this.getType(this.getComponentType(r))}( ${e} )`),`${this.getType(r)}( ${e} )`)}getSignature(){return`// Three.js r${He} - Node System\n`}}class Vv{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let r=e.get(t);return void 0===r&&(r={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,r)),r}updateBeforeNode(e){const t=e.getUpdateBeforeType(),r=e.updateReference(this);if(t===ks.FRAME){const{frameMap:t}=this._getMaps(this.updateBeforeMap,r);t.get(r)!==this.frameId&&!1!==e.updateBefore(this)&&t.set(r,this.frameId)}else if(t===ks.RENDER){const{renderMap:t}=this._getMaps(this.updateBeforeMap,r);t.get(r)!==this.renderId&&!1!==e.updateBefore(this)&&t.set(r,this.renderId)}else t===ks.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),r=e.updateReference(this);if(t===ks.FRAME){const{frameMap:t}=this._getMaps(this.updateAfterMap,r);t.get(r)!==this.frameId&&!1!==e.updateAfter(this)&&t.set(r,this.frameId)}else if(t===ks.RENDER){const{renderMap:t}=this._getMaps(this.updateAfterMap,r);t.get(r)!==this.renderId&&!1!==e.updateAfter(this)&&t.set(r,this.renderId)}else t===ks.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),r=e.updateReference(this);if(t===ks.FRAME){const{frameMap:t}=this._getMaps(this.updateMap,r);t.get(r)!==this.frameId&&!1!==e.update(this)&&t.set(r,this.frameId)}else if(t===ks.RENDER){const{renderMap:t}=this._getMaps(this.updateMap,r);t.get(r)!==this.renderId&&!1!==e.update(this)&&t.set(r,this.renderId)}else t===ks.OBJECT&&e.update(this)}update(){this.frameId++,void 0===this.lastTime&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class Ov{constructor(e,t,r=null,s="",i=!1){this.type=e,this.name=t,this.count=r,this.qualifier=s,this.isConst=i}}Ov.isNodeFunctionInput=!0;class Gv extends s_{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:gT(this.light),lightColor:e}}}const kv=new a,zv=new a;let $v=null;class Hv extends s_{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=oa(new r).setGroup(ia),this.halfWidth=oa(new r).setGroup(ia),this.updateType=ks.RENDER}update(e){super.update(e);const{light:t}=this,r=e.camera.matrixWorldInverse;zv.identity(),kv.copy(t.matrixWorld),kv.premultiply(r),zv.extractRotation(kv),this.halfWidth.value.set(.5*t.width,0,0),this.halfHeight.value.set(0,.5*t.height,0),this.halfWidth.value.applyMatrix4(zv),this.halfHeight.value.applyMatrix4(zv)}setupDirectRectArea(e){let t,r;e.isAvailable("float32Filterable")?(t=cl($v.LTC_FLOAT_1),r=cl($v.LTC_FLOAT_2)):(t=cl($v.LTC_HALF_1),r=cl($v.LTC_HALF_2));const{colorNode:s,light:i}=this;return{lightColor:s,lightPosition:pT(i),halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:r}}static setLTC(e){$v=e}}class Wv extends s_{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=oa(0).setGroup(ia),this.penumbraCosNode=oa(0).setGroup(ia),this.cutoffDistanceNode=oa(0).setGroup(ia),this.decayExponentNode=oa(0).setGroup(ia),this.colorNode=oa(this.color).setGroup(ia)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:r,penumbraCosNode:s}=this;return Xo(r,s,t)}getLightCoord(e){const t=e.getNodeProperties(this);let r=t.projectionUV;return void 0===r&&(r=dT(this.light,e.context.positionWorld),t.projectionUV=r),r}setupDirect(e){const{colorNode:t,cutoffDistanceNode:r,decayExponentNode:s,light:i}=this,n=this.getLightVector(e),a=n.normalize(),o=a.dot(gT(i)),u=this.getSpotAttenuation(e,o),l=n.length(),d=i_({lightDistance:l,cutoffDistance:r,decayExponent:s});let c,h,p=t.mul(u).mul(d);if(i.colorNode?(h=this.getLightCoord(e),c=i.colorNode(h)):i.map&&(h=this.getLightCoord(e),c=cl(i.map,h.xy).onRenderUpdate(()=>i.map)),c){p=h.mul(2).sub(1).abs().lessThan(1).all().select(p.mul(c),p)}return{lightColor:p,lightDirection:a}}}class qv extends Wv{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const r=this.light.iesMap;let s=null;if(r&&!0===r.isTexture){const e=t.acos().mul(1/Math.PI);s=cl(r,an(e,0),0).r}else s=super.getSpotAttenuation(t);return s}}const jv=Ki(([e,t])=>{const r=e.abs().sub(t);return fo(Mo(r,0)).add(Co(Mo(r.x,r.y),0))});class Xv extends Wv{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),null===t.aspect){let e=1;null!==t.map&&(e=t.map.width/t.map.height),t.shadow.aspect=e}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=tn(0),r=this.penumbraCosNode,s=lT(this.light).mul(e.context.positionWorld||cd);return Zi(s.w.greaterThan(0),()=>{const e=s.xyz.div(s.w),i=jv(e.xy.sub(an(.5)),an(.5)),n=xa(-1,ya(1,ho(r)).sub(1));t.assign(qo(i.mul(-2).mul(n)))}),t}}class Kv extends s_{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class Yv extends s_{static get type(){return"HemisphereLightNode"}constructor(t=null){super(t),this.lightPositionNode=cT(t),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=oa(new e).setGroup(ia)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:r,lightDirectionNode:s}=this,i=Ed.dot(s).mul(.5).add(.5),n=Ho(r,t,i);e.context.irradiance.addAssign(n)}}class Qv extends s_{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let e=0;e<9;e++)t.push(new r);this.lightProbe=yl(t)}update(e){const{light:t}=this;super.update(e);for(let e=0;e<9;e++)this.lightProbe.array[e].copy(t.sh.coefficients[e]).multiplyScalar(t.intensity)}setup(e){const t=rv(Ed,this.lightProbe);e.context.irradiance.addAssign(t)}}class Zv{parseFunction(){console.warn("Abstract function.")}}class Jv{constructor(e,t,r="",s=""){this.type=e,this.inputs=t,this.name=r,this.precision=s}getCode(){console.warn("Abstract function.")}}Jv.isNodeFunction=!0;const eN=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,tN=/[a-z_0-9]+/gi,rN="#pragma main";class sN extends Jv{constructor(e){const{type:t,inputs:r,name:s,precision:i,inputsCode:n,blockCode:a,headerCode:o}=(e=>{const t=(e=e.trim()).indexOf(rN),r=-1!==t?e.slice(t+12):e,s=r.match(eN);if(null!==s&&5===s.length){const i=s[4],n=[];let a=null;for(;null!==(a=tN.exec(i));)n.push(a);const o=[];let u=0;for(;u<n.length;){const e="const"===n[u][0];!0===e&&u++;let t=n[u][0];"in"===t||"out"===t||"inout"===t?u++:t="";const r=n[u++][0];let s=Number.parseInt(n[u][0]);!1===Number.isNaN(s)?u++:s=null;const i=n[u++][0];o.push(new Ov(r,i,s,t,e))}const l=r.substring(s[0].length),d=void 0!==s[3]?s[3]:"";return{type:s[2],inputs:o,name:d,precision:void 0!==s[1]?s[1]:"",inputsCode:i,blockCode:l,headerCode:-1!==t?e.slice(0,t):""}}throw new Error("FunctionNode: Function is not a GLSL code.")})(e);super(t,r,s,i),this.inputsCode=n,this.blockCode=a,this.headerCode=o}getCode(e=this.name){let t;const r=this.blockCode;if(""!==r){const{type:s,inputsCode:i,headerCode:n,precision:a}=this;let o=`${s} ${e} ( ${i.trim()} )`;""!==a&&(o=`${a} ${o}`),t=n+o+r}else t="";return t}}class iN extends Zv{parseFunction(e){return new sN(e)}}const nN=new WeakMap,aN=[],oN=[];class uN extends wf{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new Vv,this.nodeBuilderCache=new Map,this.callHashCache=new Nf,this.groupsData=new Nf,this.cacheLib={}}updateGroup(e){const t=e.groupNode,r=t.name;if(r===na.name)return!0;if(r===ia.name){const t=this.get(e),r=this.nodeFrame.renderId;return t.renderId!==r&&(t.renderId=r,!0)}if(r===sa.name){const t=this.get(e),r=this.nodeFrame.frameId;return t.frameId!==r&&(t.frameId=r,!0)}aN[0]=t,aN[1]=e;let s=this.groupsData.get(aN);return void 0===s&&this.groupsData.set(aN,s={}),aN.length=0,s.version!==t.version&&(s.version=t.version,!0)}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let r=t.nodeBuilderState;if(void 0===r){const{nodeBuilderCache:s}=this,i=this.getForRenderCacheKey(e);if(r=s.get(i),void 0===r){const t=this.backend.createNodeBuilder(e.object,this.renderer);t.scene=e.scene,t.material=e.material,t.camera=e.camera,t.context.material=e.material,t.lightsNode=e.lightsNode,t.environmentNode=this.getEnvironmentNode(e.scene),t.fogNode=this.getFogNode(e.scene),t.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&t.enableMultiview(),t.build(),r=this._createNodeBuilderState(t),s.set(i,r)}r.usedTimes++,t.nodeBuilderState=r}return r}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,0===t.usedTimes&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let r=t.nodeBuilderState;if(void 0===r){const s=this.backend.createNodeBuilder(e,this.renderer);s.build(),r=this._createNodeBuilderState(s),t.nodeBuilderState=r}return r}_createNodeBuilderState(e){return new uv(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const r=this.get(e);r.environmentNode&&(t=r.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const r=this.get(e);r.backgroundNode&&(t=r.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){aN[0]=e,aN[1]=t;const r=this.renderer.info.calls,s=this.callHashCache.get(aN)||{};if(s.callId!==r){const i=this.getEnvironmentNode(e),n=this.getFogNode(e);t&&oN.push(t.getCacheKey(!0)),i&&oN.push(i.getCacheKey()),n&&oN.push(n.getCacheKey()),oN.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),oN.push(this.renderer.shadowMap.enabled?1:0),s.callId=r,s.cacheKey=Ns(oN),this.callHashCache.set(aN,s),oN.length=0}return aN.length=0,s.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),r=e.background;if(r){const s=0===e.backgroundBlurriness&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&0===t.backgroundBlurriness;if(t.background!==r||s){const i=this.getCacheNode("background",r,()=>{if(!0===r.isCubeTexture||r.mapping===Z||r.mapping===J||r.mapping===he){if(e.backgroundBlurriness>0||r.mapping===he)return km(r);{let e;return e=!0===r.isCubeTexture?Hd(r):cl(r),$p(e)}}if(!0===r.isTexture)return cl(r,Nl.flipY()).setUpdateMatrix(!0);!0!==r.isColor&&console.error("WebGPUNodes: Unsupported background configuration.",r)},s);t.backgroundNode=i,t.background=r,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,r,s=!1){const i=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let n=i.get(t);return(void 0===n||s)&&(n=r(),i.set(t,n)),n}updateFog(e){const t=this.get(e),r=e.fog;if(r){if(t.fog!==r){const e=this.getCacheNode("fog",r,()=>{if(r.isFogExp2){const e=jd("color","color",r).setGroup(ia),t=jd("density","float",r).setGroup(ia);return yx(e,fx(t))}if(r.isFog){const e=jd("color","color",r).setGroup(ia),t=jd("near","float",r).setGroup(ia),s=jd("far","float",r).setGroup(ia);return yx(e,mx(t,s))}console.error("THREE.Renderer: Unsupported fog configuration.",r)});t.fogNode=e,t.fog=r}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),r=e.environment;if(r){if(t.environment!==r){const e=this.getCacheNode("environment",r,()=>!0===r.isCubeTexture?Hd(r):!0===r.isTexture?cl(r):void console.error("Nodes: Unsupported environment configuration.",r));t.environmentNode=e,t.environment=r}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,r=null,s=null,i=null){const n=this.nodeFrame;return n.renderer=e,n.scene=t,n.object=r,n.camera=s,n.material=i,n}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return nN.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,r=this.getOutputCacheKey(),s=e.isArrayTexture?Ab(e,dn(Nl,bl("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):cl(e,Nl).renderOutput(t.toneMapping,t.currentColorSpace);return nN.set(e,r),s}updateBefore(e){const t=e.getNodeBuilderState();for(const r of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(r)}updateAfter(e){const t=e.getNodeBuilderState();for(const r of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(r)}updateForCompute(e){const t=this.getNodeFrame(),r=this.getForCompute(e);for(const e of r.updateNodes)t.updateNode(e)}updateForRender(e){const t=this.getNodeFrameForRender(e),r=e.getNodeBuilderState();for(const e of r.updateNodes)t.updateNode(e)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new Vv,this.nodeBuilderCache=new Map,this.cacheLib={}}}const lN=new Me;class dN{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new n,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,null!==e&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,r){const s=e.length;for(let i=0;i<s;i++){lN.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const s=t[r+i],n=lN.normal;s.x=-n.x,s.y=-n.y,s.z=-n.z,s.w=lN.constant}}updateGlobal(e,t){this.shadowPass=null!==e.overrideMaterial&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let r=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const i=t.clippingPlanes,n=i.length;let a,o;if(this.clipIntersection?(a=this.intersectionPlanes,o=e.intersectionPlanes.length):(a=this.unionPlanes,o=e.unionPlanes.length),a.length!==o+n){a.length=o+n;for(let e=0;e<n;e++)a[o+e]=new s;r=!0}this.projectPlanes(i,a,o),r&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return void 0===t&&(t=new dN(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class cN{constructor(e,t){this.bundleGroup=e,this.camera=t}}const hN=[];class pN{constructor(){this.bundles=new Nf}get(e,t){const r=this.bundles;hN[0]=e,hN[1]=t;let s=r.get(hN);return void 0===s&&(s=new cN(e,t),r.set(hN,s)),hN.length=0,s}dispose(){this.bundles=new Nf}}class gN{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const r=this.getMaterialNodeClass(e.type);if(null!==r){t=new r;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,r){if(r.has(t))console.warn(`Redefinition of node ${t}`);else{if("function"!=typeof e)throw new Error(`Node class ${e.name} is not a class.`);if("function"==typeof t||"object"==typeof t)throw new Error(`Base class ${t} is not a class.`);r.set(t,e)}}addClass(e,t,r){if(r.has(t))console.warn(`Redefinition of node ${t.name}`);else{if("function"!=typeof e)throw new Error(`Node class ${e.name} is not a class.`);if("function"!=typeof t)throw new Error(`Base class ${t.name} is not a class.`);r.set(t,e)}}}const mN=new bT,fN=[];class yN extends Nf{constructor(){super()}createNode(e=[]){return(new bT).setLights(e)}getNode(e,t){if(e.isQuadMesh)return mN;fN[0]=e,fN[1]=t;let r=this.get(fN);return void 0===r&&(r=this.createNode(),this.set(fN,r)),fN.length=0,r}}class bN extends ue{constructor(e=1,t=1,r={}){super(e,t,r),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const xN=new r,TN=new r;class _N extends o{constructor(e,r=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new oe,this._cameraL.viewport=new s,this._cameraR=new oe,this._cameraR.viewport=new s,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new We,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding="undefined"!=typeof XRWebGLBinding,this._frameBufferTargets=null,this._createXRLayer=RN.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new t,this._onSessionEvent=NN.bind(this),this._onSessionEnd=SN.bind(this),this._onInputSourcesChange=EN.bind(this),this._onAnimationFrame=AN.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=r,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(null!==this._glProjLayer||null!==this._glBaseLayer)return this._foveation}setFoveation(e){this._foveation=e,null!==this._glProjLayer&&(this._glProjLayer.fixedFoveation=e),null!==this._glBaseLayer&&void 0!==this._glBaseLayer.fixedFoveation&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,!0===this.isPresenting&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(null!==this._session)return this._session.environmentBlendMode}getBinding(){return null===this._glBinding&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,r,s,i,n,a,o={}){const u=new qe(e,t),l=new bN(i,n,{format:de,type:Ce,depthTexture:new V(i,n,o.stencil?we:T,void 0,void 0,void 0,void 0,void 0,void 0,o.stencil?Re:Ae),stencilBuffer:o.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});l._autoAllocateDepthBuffer=!0;const d=new se({color:16777215,side:je});d.map=l.texture,d.map.offset.y=1,d.map.repeat.y=-1;const c=new X(u,d);c.position.copy(r),c.quaternion.copy(s);const h={type:"quad",width:e,height:t,translation:r,quaternion:s,pixelwidth:i,pixelheight:n,plane:c,material:d,rendercall:a,renderTarget:l};if(this._layers.push(h),null!==this._session){h.plane.material=new se({color:16777215,side:je}),h.plane.material.blending=Xe,h.plane.material.blendEquation=Ke,h.plane.material.blendSrc=Ye,h.plane.material.blendDst=Ye,h.xrlayer=this._createXRLayer(h);const e=this._session.renderState.layers;e.unshift(h.xrlayer),this._session.updateRenderState({layers:e})}else l.isXRRenderTarget=!1;return c}createCylinderLayer(e,t,r,s,i,n,a,o,u={}){const l=new Qe(e,e,e*t/r,64,64,!0,Math.PI-t/2,t),d=new bN(n,a,{format:de,type:Ce,depthTexture:new V(n,a,u.stencil?we:T,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?Re:Ae),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});d._autoAllocateDepthBuffer=!0;const c=new se({color:16777215,side:S});c.map=d.texture,c.map.offset.y=1,c.map.repeat.y=-1;const h=new X(l,c);h.position.copy(s),h.quaternion.copy(i);const p={type:"cylinder",radius:e,centralAngle:t,aspectratio:r,translation:s,quaternion:i,pixelwidth:n,pixelheight:a,plane:h,material:c,rendercall:o,renderTarget:d};if(this._layers.push(p),null!==this._session){p.plane.material=new se({color:16777215,side:S}),p.plane.material.blending=Xe,p.plane.material.blendEquation=Ke,p.plane.material.blendSrc=Ye,p.plane.material.blendDst=Ye,p.xrlayer=this._createXRLayer(p);const e=this._session.renderState.layers;e.unshift(p.xrlayer),this._session.updateRenderState({layers:e})}else d.isXRRenderTarget=!1;return h}renderLayers(){const e=new r,s=new Ze,i=this._renderer,n=this.isPresenting,a=i.getOutputRenderTarget(),o=i._frameBufferTarget;this.isPresenting=!1;const u=new t;i.getSize(u);const l=i._quad;for(const t of this._layers)if(t.renderTarget.isXRRenderTarget=null!==this._session,t.renderTarget._hasExternalTextures=t.renderTarget.isXRRenderTarget,t.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){t.xrlayer.transform=new XRRigidTransform(t.plane.getWorldPosition(e),t.plane.getWorldQuaternion(s));const r=this._glBinding.getSubImage(t.xrlayer,this._xrFrame);i.backend.setXRRenderTargetTextures(t.renderTarget,r.colorTexture,void 0),i._setXRLayerSize(t.renderTarget.width,t.renderTarget.height),i.setOutputRenderTarget(t.renderTarget),i.setRenderTarget(null),i._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:n,quad:a}=this._frameBufferTargets.get(t.renderTarget)||{frameBufferTarget:null,quad:null};n?(i._frameBufferTarget=n,i._quad=a):(i._quad=new sb(new Sp),this._frameBufferTargets.set(t.renderTarget,{frameBufferTarget:i._getFrameBufferTarget(),quad:i._quad})),t.rendercall(),i._frameBufferTarget=null}else i.setRenderTarget(t.renderTarget),t.rendercall();i.setRenderTarget(null),i.setOutputRenderTarget(a),i._frameBufferTarget=o,i._setXRLayerSize(u.x,u.y),i._quad=l,this.isPresenting=n}getSession(){return this._session}async setSession(e){const t=this._renderer,r=t.backend;this._gl=t.getContext();const s=this._gl,i=s.getContextAttributes();if(this._session=e,null!==e){if(!0===r.isWebGPUBackend)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await r.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),!0===this._supportsLayers){let r=null,n=null,a=null;t.depth&&(a=t.stencil?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24,r=t.stencil?Re:Ae,n=t.stencil?we:T);const o={colorFormat:s.RGBA8,depthFormat:a,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(o.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();const u=this._glBinding.createProjectionLayer(o),l=[u];this._glProjLayer=u,t.setPixelRatio(1),t._setXRLayerSize(u.textureWidth,u.textureHeight);const d=this._useMultiview?2:1,c=new V(u.textureWidth,u.textureHeight,n,void 0,void 0,void 0,void 0,void 0,void 0,r,d);if(this._xrRenderTarget=new bN(u.textureWidth,u.textureHeight,{format:de,type:Ce,colorSpace:t.outputColorSpace,depthTexture:c,stencilBuffer:t.stencil,samples:i.antialias?4:0,resolveDepthBuffer:!1===u.ignoreDepthValues,resolveStencilBuffer:!1===u.ignoreDepthValues,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(const e of this._layers)e.plane.material=new se({color:16777215,side:"cylinder"===e.type?S:je}),e.plane.material.blending=Xe,e.plane.material.blendEquation=Ke,e.plane.material.blendSrc=Ye,e.plane.material.blendDst=Ye,e.xrlayer=this._createXRLayer(e),l.unshift(e.xrlayer);e.updateRenderState({layers:l})}else{const r={antialias:t.samples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},i=new XRWebGLLayer(e,s,r);this._glBaseLayer=i,e.updateRenderState({baseLayer:i}),t.setPixelRatio(1),t._setXRLayerSize(i.framebufferWidth,i.framebufferHeight),this._xrRenderTarget=new bN(i.framebufferWidth,i.framebufferHeight,{format:de,type:Ce,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:!1===i.ignoreDepthValues,resolveStencilBuffer:!1===i.ignoreDepthValues}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(null===t)return;const r=e.near,s=e.far,i=this._cameraXR,n=this._cameraL,a=this._cameraR;i.near=a.near=n.near=r,i.far=a.far=n.far=s,i.isMultiViewCamera=this._useMultiview,this._currentDepthNear===i.near&&this._currentDepthFar===i.far||(t.updateRenderState({depthNear:i.near,depthFar:i.far}),this._currentDepthNear=i.near,this._currentDepthFar=i.far),i.layers.mask=6|e.layers.mask,n.layers.mask=3&i.layers.mask,a.layers.mask=5&i.layers.mask;const o=e.parent,u=i.cameras;vN(i,o);for(let e=0;e<u.length;e++)vN(u[e],o);2===u.length?function(e,t,r){xN.setFromMatrixPosition(t.matrixWorld),TN.setFromMatrixPosition(r.matrixWorld);const s=xN.distanceTo(TN),i=t.projectionMatrix.elements,n=r.projectionMatrix.elements,a=i[14]/(i[10]-1),o=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],d=(i[8]-1)/i[0],c=(n[8]+1)/n[0],h=a*d,p=a*c,g=s/(-d+c),m=g*-d;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(g),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=a+g,r=o+g,i=h-m,n=p+(s-m),d=u*o/r*t,c=l*o/r*t;e.projectionMatrix.makePerspective(i,n,d,c,t,r),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(i,n,a):i.projectionMatrix.copy(n.projectionMatrix),function(e,t,r){null===r?e.matrix.copy(t.matrixWorld):(e.matrix.copy(r.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*et*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,i,o)}_getController(e){let t=this._controllers[e];return void 0===t&&(t=new Je,this._controllers[e]=t),t}}function vN(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}function NN(e){const t=this._controllerInputSources.indexOf(e.inputSource);if(-1===t)return;const r=this._controllers[t];if(void 0!==r){const t=this.getReferenceSpace();r.update(e.inputSource,e.frame,t),r.dispatchEvent({type:e.type,data:e.inputSource})}}function SN(){const e=this._session,t=this._renderer;e.removeEventListener("select",this._onSessionEvent),e.removeEventListener("selectstart",this._onSessionEvent),e.removeEventListener("selectend",this._onSessionEvent),e.removeEventListener("squeeze",this._onSessionEvent),e.removeEventListener("squeezestart",this._onSessionEvent),e.removeEventListener("squeezeend",this._onSessionEvent),e.removeEventListener("end",this._onSessionEnd),e.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let e=0;e<this._controllers.length;e++){const t=this._controllerInputSources[e];null!==t&&(this._controllerInputSources[e]=null,this._controllers[e].disconnect(t))}if(this._currentDepthNear=null,this._currentDepthFar=null,t._resetXRState(),this._session=null,this._xrRenderTarget=null,!0===this._sessionUsesLayers)for(const e of this._layers)e.renderTarget=new bN(e.pixelwidth,e.pixelheight,{format:de,type:Ce,depthTexture:new V(e.pixelwidth,e.pixelheight,e.stencilBuffer?we:T,void 0,void 0,void 0,void 0,void 0,void 0,e.stencilBuffer?Re:Ae),stencilBuffer:e.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),e.renderTarget.isXRRenderTarget=!1,e.plane.material=e.material,e.material.map=e.renderTarget.texture,e.material.map.offset.y=1,e.material.map.repeat.y=-1,delete e.xrlayer;this.isPresenting=!1,this._useMultiview=!1,t._animation.stop(),t._animation.setAnimationLoop(this._currentAnimationLoop),t._animation.setContext(this._currentAnimationContext),t._animation.start(),t.setPixelRatio(this._currentPixelRatio),t.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function EN(e){const t=this._controllers,r=this._controllerInputSources;for(let s=0;s<e.removed.length;s++){const i=e.removed[s],n=r.indexOf(i);n>=0&&(r[n]=null,t[n].disconnect(i))}for(let s=0;s<e.added.length;s++){const i=e.added[s];let n=r.indexOf(i);if(-1===n){for(let e=0;e<t.length;e++){if(e>=r.length){r.push(i),n=e;break}if(null===r[e]){r[e]=i,n=e;break}}if(-1===n)break}const a=t[n];a&&a.connect(i)}}function RN(e){return"quad"===e.type?this._glBinding.createQuadLayer({transform:new XRRigidTransform(e.translation,e.quaternion),width:e.width/2,height:e.height/2,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(e.translation,e.quaternion),radius:e.radius,centralAngle:e.centralAngle,aspectRatio:e.aspectRatio,space:this._referenceSpace,viewPixelWidth:e.pixelwidth,viewPixelHeight:e.pixelheight,clearOnAccess:!1})}function AN(e,t){if(void 0===t)return;const r=this._cameraXR,i=this._renderer,n=i.backend,a=this._glBaseLayer,o=this.getReferenceSpace(),u=t.getViewerPose(o);if(this._xrFrame=t,null!==u){const e=u.views;null!==this._glBaseLayer&&n.setXRTarget(a.framebuffer);let t=!1;e.length!==r.cameras.length&&(r.cameras.length=0,t=!0);for(let i=0;i<e.length;i++){const o=e[i];let u;if(!0===this._supportsLayers){const e=this._glBinding.getViewSubImage(this._glProjLayer,o);u=e.viewport,0===i&&n.setXRRenderTargetTextures(this._xrRenderTarget,e.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:e.depthStencilTexture)}else u=a.getViewport(o);let l=this._cameras[i];void 0===l&&(l=new oe,l.layers.enable(i),l.viewport=new s,this._cameras[i]=l),l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.quaternion,l.scale),l.projectionMatrix.fromArray(o.projectionMatrix),l.projectionMatrixInverse.copy(l.projectionMatrix).invert(),l.viewport.set(u.x,u.y,u.width,u.height),0===i&&(r.matrix.copy(l.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),!0===t&&r.cameras.push(l)}i.setOutputRenderTarget(this._xrRenderTarget)}for(let e=0;e<this._controllers.length;e++){const r=this._controllerInputSources[e],s=this._controllers[e];null!==r&&void 0!==s&&s.update(r,t,o)}this._currentAnimationLoop&&this._currentAnimationLoop(e,t),t.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:t}),this._xrFrame=null}const wN=new K,CN=new t,MN=new s,PN=new st,BN=new rt,LN=new a,FN=new s;class IN{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:r=!1,alpha:i=!0,depth:n=!0,stencil:a=!1,antialias:o=!1,samples:u=0,getFallback:l=null,colorBufferType:d=ce,multiview:c=!1}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=u||!0===o?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=i,this.logarithmicDepthBuffer=r,this.outputColorSpace=W,this.toneMapping=p,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=n,this.stencil=a,this.info=new Vf,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new gN,this.lighting=new yN,this._getFallback=l,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new s(0,0,this._width,this._height),this._scissor=new s(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new sb(new Sp),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const h=!0===this.alpha?0:1;this._clearColor=new oy(0,0,0,h),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=d,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:tt},this.xr=new _N(this,c),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(e,t,r)=>{await this.compileAsync(e,t);const s=this._renderLists.get(e,t),i=this._renderContexts.get(e,t,this._renderTarget),n=e.overrideMaterial||r.material,a=this._objects.get(r,n,e,t,s.lightsNode,i,i.clippingContext),{fragmentShader:o,vertexShader:u}=a.getNodeBuilderState();return{fragmentShader:o,vertexShader:u}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return null!==this._initPromise||(this._initPromise=new Promise(async(e,t)=>{let r=this.backend;try{await r.init(this)}catch(e){if(null===this._getFallback)return void t(e);try{this.backend=r=this._getFallback(e),await r.init(this)}catch(e){return void t(e)}}this._nodes=new uN(this,r),this._animation=new vf(this._nodes,this.info),this._attributes=new Ff(r),this._background=new nv(this,this._nodes),this._geometries=new Uf(this._attributes,this.info),this._textures=new ay(this,r,this.info),this._pipelines=new Hf(r,this._nodes),this._bindings=new Wf(r,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new Af(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new Qf(this.lighting),this._bundles=new pN,this._renderContexts=new iy,this._animation.start(),this._initialized=!0,e(this)})),this._initPromise}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,r=null){if(!0===this._isDeviceLost)return;!1===this._initialized&&await this.init();const s=this._nodes.nodeFrame,i=s.renderId,n=this._currentRenderContext,a=this._currentRenderObjectFunction,o=this._compilationPromises,u=!0===e.isScene?e:wN;null===r&&(r=e);const l=this._renderTarget,d=this._renderContexts.get(r,t,l),c=this._activeMipmapLevel,h=[];this._currentRenderContext=d,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=h,s.renderId++,s.update(),d.depth=this.depth,d.stencil=this.stencil,d.clippingContext||(d.clippingContext=new dN),d.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,l);const p=this._renderLists.get(e,t);if(p.begin(),this._projectObject(e,t,0,p,d.clippingContext),r!==e&&r.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&p.pushLight(e)}),p.finish(),null!==l){this._textures.updateRenderTarget(l,c);const e=this._textures.get(l);d.textures=e.textures,d.depthTexture=e.depthTexture}else d.textures=null,d.depthTexture=null;this._background.update(u,p,d);const g=p.opaque,m=p.transparent,f=p.transparentDoublePass,y=p.lightsNode;!0===this.opaque&&g.length>0&&this._renderObjects(g,t,u,y),!0===this.transparent&&m.length>0&&this._renderTransparents(m,f,t,u,y),s.renderId=i,this._currentRenderContext=n,this._currentRenderObjectFunction=a,this._compilationPromises=o,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(h)}async renderAsync(e,t){!1===this._initialized&&await this.init(),this._renderScene(e,t)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){!0===e?(this.overrideNodes.modelViewMatrix=ad,this.overrideNodes.modelNormalViewMatrix=od):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===ad&&this.overrideNodes.modelNormalViewMatrix===od}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:\n\nMessage: ${e.message}`;e.reason&&(t+=`\nReason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,r){const{bundleGroup:s,camera:i,renderList:n}=e,a=this._currentRenderContext,o=this._bundles.get(s,i),u=this.backend.get(o);void 0===u.renderContexts&&(u.renderContexts=new Set);const l=s.version!==u.version,d=!1===u.renderContexts.has(a)||l;if(u.renderContexts.add(a),d){this.backend.beginBundle(a),(void 0===u.renderObjects||l)&&(u.renderObjects=[]),this._currentRenderBundle=o;const{transparentDoublePass:e,transparent:d,opaque:c}=n;!0===this.opaque&&c.length>0&&this._renderObjects(c,i,t,r),!0===this.transparent&&d.length>0&&this._renderTransparents(d,e,i,t,r),this._currentRenderBundle=null,this.backend.finishBundle(a,o),u.version=s.version}else{const{renderObjects:e}=u;for(let t=0,r=e.length;t<r;t++){const r=e[t];this._nodes.needsRefresh(r)&&(this._nodes.updateBefore(r),this._nodes.updateForRender(r),this._bindings.updateForRender(r),this._nodes.updateAfter(r))}}this.backend.addBundle(a,o)}render(e,t){if(!1===this._initialized)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this,r=e!==p,s=t!==c.workingColorSpace;if(!1===r&&!1===s)return null;const{width:i,height:n}=this.getDrawingBufferSize(CN),{depth:a,stencil:o}=this;let u=this._frameBufferTarget;null===u&&(u=new ue(i,n,{depthBuffer:a,stencilBuffer:o,type:this._colorBufferType,format:de,colorSpace:c.workingColorSpace,generateMipmaps:!1,minFilter:Y,magFilter:Y,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const l=this.getOutputRenderTarget();return u.depthBuffer=a,u.stencilBuffer=o,null!==l?u.setSize(l.width,l.height,l.depth):u.setSize(i,n,1),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u.multiview=null!==l&&l.multiview,u.resolveDepthBuffer=null===l||l.resolveDepthBuffer,u._autoAllocateDepthBuffer=null!==l&&l._autoAllocateDepthBuffer,u}_renderScene(e,t,r=!0){if(!0===this._isDeviceLost)return;const s=r?this._getFrameBufferTarget():null,i=this._nodes.nodeFrame,n=i.renderId,a=this._currentRenderContext,o=this._currentRenderObjectFunction,u=!0===e.isScene?e:wN,l=this._renderTarget||this._outputRenderTarget,d=this._activeCubeFace,c=this._activeMipmapLevel;let h;null!==s?(h=s,this.setRenderTarget(h)):h=l;const p=this._renderContexts.get(e,t,h);this._currentRenderContext=p,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,i.renderId=this.info.calls;const g=this.coordinateSystem,m=this.xr;if(t.coordinateSystem!==g&&!1===m.isPresenting&&(t.coordinateSystem=g,t.updateProjectionMatrix(),t.isArrayCamera))for(const e of t.cameras)e.coordinateSystem=g,e.updateProjectionMatrix();!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===m.enabled&&!0===m.isPresenting&&(!0===m.cameraAutoUpdate&&m.updateCamera(t),t=m.getCamera());let f=this._viewport,y=this._scissor,b=this._pixelRatio;null!==h&&(f=h.viewport,y=h.scissor,b=1),this.getDrawingBufferSize(CN),MN.set(0,0,CN.width,CN.height);const x=void 0===f.minDepth?0:f.minDepth,T=void 0===f.maxDepth?1:f.maxDepth;p.viewportValue.copy(f).multiplyScalar(b).floor(),p.viewportValue.width>>=c,p.viewportValue.height>>=c,p.viewportValue.minDepth=x,p.viewportValue.maxDepth=T,p.viewport=!1===p.viewportValue.equals(MN),p.scissorValue.copy(y).multiplyScalar(b).floor(),p.scissor=this._scissorTest&&!1===p.scissorValue.equals(MN),p.scissorValue.width>>=c,p.scissorValue.height>>=c,p.clippingContext||(p.clippingContext=new dN),p.clippingContext.updateGlobal(u,t),u.onBeforeRender(this,e,t,h);const _=t.isArrayCamera?BN:PN;t.isArrayCamera||(LN.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),_.setFromProjectionMatrix(LN,t.coordinateSystem,t.reversedDepth));const v=this._renderLists.get(e,t);if(v.begin(),this._projectObject(e,t,0,v,p.clippingContext),v.finish(),!0===this.sortObjects&&v.sort(this._opaqueSort,this._transparentSort),null!==h){this._textures.updateRenderTarget(h,c);const e=this._textures.get(h);p.textures=e.textures,p.depthTexture=e.depthTexture,p.width=e.width,p.height=e.height,p.renderTarget=h,p.depth=h.depthBuffer,p.stencil=h.stencilBuffer}else p.textures=null,p.depthTexture=null,p.width=CN.width,p.height=CN.height,p.depth=this.depth,p.stencil=this.stencil;p.width>>=c,p.height>>=c,p.activeCubeFace=d,p.activeMipmapLevel=c,p.occlusionQueryCount=v.occlusionQueryCount,p.scissorValue.max(FN.set(0,0,0,0)),p.scissorValue.x+p.scissorValue.width>p.width&&(p.scissorValue.width=Math.max(p.width-p.scissorValue.x,0)),p.scissorValue.y+p.scissorValue.height>p.height&&(p.scissorValue.height=Math.max(p.height-p.scissorValue.y,0)),this._background.update(u,v,p),p.camera=t,this.backend.beginRender(p);const{bundles:N,lightsNode:S,transparentDoublePass:E,transparent:R,opaque:A}=v;return N.length>0&&this._renderBundles(N,u,S),!0===this.opaque&&A.length>0&&this._renderObjects(A,t,u,S),!0===this.transparent&&R.length>0&&this._renderTransparents(R,E,t,u,S),this.backend.finishRender(p),i.renderId=n,this._currentRenderContext=a,this._currentRenderObjectFunction=o,null!==s&&(this.setRenderTarget(l,d,c),this._renderOutput(h)),u.onAfterRender(this,e,t,h),p}_setXRLayerSize(e,t){this._width=e,this._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const r=this.autoClear,s=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=r,this.xr.enabled=s}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){!1===this._initialized&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,r){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=r,this.domElement.width=Math.floor(e*r),this.domElement.height=Math.floor(t*r),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setSize(e,t,r=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),!0===r&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,r,s){const i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,r,s)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,r,s,i=0,n=1){const a=this._viewport;e.isVector4?a.copy(e):a.set(e,t,r,s),a.minDepth=i,a.maxDepth=n}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,r=!0){if(!1===this._initialized)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,r);const s=this._renderTarget||this._getFrameBufferTarget();let i=null;if(null!==s){this._textures.updateRenderTarget(s);const e=this._textures.get(s);i=this._renderContexts.getForClear(s),i.textures=e.textures,i.depthTexture=e.depthTexture,i.width=e.width,i.height=e.height,i.renderTarget=s,i.depth=s.depthBuffer,i.stencil=s.stencilBuffer,i.clearColorValue=this.backend.getClearColor(),i.activeCubeFace=this.getActiveCubeFace(),i.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,r,i),null!==s&&null===this._renderTarget&&this._renderOutput(s)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,r=!0){!1===this._initialized&&await this.init(),this.clear(e,t,r)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:p}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:c.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||null===this._renderTarget}dispose(){!0===this._initialized&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),null!==this._frameBufferTarget&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{null!==e&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,r=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=r}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e,t=null){if(!0===this._isDeviceLost)return;if(!1===this._initialized)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const r=this._nodes.nodeFrame,s=r.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,r.renderId=this.info.calls;const i=this.backend,n=this._pipelines,a=this._bindings,o=this._nodes,u=Array.isArray(e)?e:[e];if(void 0===u[0]||!0!==u[0].isComputeNode)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");i.beginCompute(e);for(const r of u){if(!1===n.has(r)){const e=()=>{r.removeEventListener("dispose",e),n.delete(r),a.delete(r),o.delete(r)};r.addEventListener("dispose",e);const t=r.onInitFunction;null!==t&&t.call(r,{renderer:this})}o.updateForCompute(r),a.updateForCompute(r);const s=a.getForCompute(r),u=n.getForCompute(r,s);i.compute(e,r,s,u,t)}i.finishCompute(e),r.renderId=s}async computeAsync(e,t=null){!1===this._initialized&&await this.init(),this.compute(e,t)}async hasFeatureAsync(e){return!1===this._initialized&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return!1===this._initialized&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return!1===this._initialized?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){!1===this._initialized&&await this.init(),this._textures.updateTexture(e)}initTexture(e){!1===this._initialized&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(null!==t)if(t.isVector2)t=FN.set(t.x,t.y,e.image.width,e.image.height).floor();else{if(!t.isVector4)return void console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");t=FN.copy(t).floor()}else t=FN.set(0,0,e.image.width,e.image.height);let r,s=this._currentRenderContext;null!==s?r=s.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),null!==r&&(this._textures.updateRenderTarget(r),s=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,s,t)}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,r,s,i,n)}async readRenderTargetPixelsAsync(e,t,r,s,i,n=0,a=0){return this.backend.copyTextureToBuffer(e.textures[n],t,r,s,i,a)}_projectObject(e,t,r,s,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)r=e.renderOrder,e.isClippingGroup&&e.enabled&&(i=i.getGroupContext(e));else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)s.pushLight(e);else if(e.isSprite){const n=t.isArrayCamera?BN:PN;if(!e.frustumCulled||n.intersectsSprite(e,t)){!0===this.sortObjects&&FN.setFromMatrixPosition(e.matrixWorld).applyMatrix4(LN);const{geometry:t,material:n}=e;n.visible&&s.push(e,t,n,r,FN.z,null,i)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const n=t.isArrayCamera?BN:PN;if(!e.frustumCulled||n.intersectsObject(e,t)){const{geometry:t,material:n}=e;if(!0===this.sortObjects&&(null===t.boundingSphere&&t.computeBoundingSphere(),FN.copy(t.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(LN)),Array.isArray(n)){const a=t.groups;for(let o=0,u=a.length;o<u;o++){const u=a[o],l=n[u.materialIndex];l&&l.visible&&s.push(e,t,l,r,FN.z,u,i)}}else n.visible&&s.push(e,t,n,r,FN.z,null,i)}}if(!0===e.isBundleGroup&&void 0!==this.backend.beginBundle){const r=s;(s=this._renderLists.get(e,t)).begin(),r.pushBundle({bundleGroup:e,camera:t,renderList:s}),s.finish()}const n=e.children;for(let e=0,a=n.length;e<a;e++)this._projectObject(n[e],t,r,s,i)}_renderBundles(e,t,r){for(const s of e)this._renderBundle(s,t,r)}_renderTransparents(e,t,r,s,i){if(t.length>0){for(const{material:e}of t)e.side=S;this._renderObjects(t,r,s,i,"backSide");for(const{material:e}of t)e.side=je;this._renderObjects(e,r,s,i);for(const{material:e}of t)e.side=E}else this._renderObjects(e,r,s,i)}_renderObjects(e,t,r,s,i=null){for(let n=0,a=e.length;n<a;n++){const{object:a,geometry:o,material:u,group:l,clippingContext:d}=e[n];this._currentRenderObjectFunction(a,r,t,o,u,l,s,d,i)}}renderObject(e,t,r,s,i,n,a,o=null,u=null){let l,d,c;if(e.onBeforeRender(this,t,r,s,i,n),!0===i.allowOverride&&null!==t.overrideMaterial){const e=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(l=e.positionNode,e.positionNode=i.positionNode),e.alphaTest=i.alphaTest,e.alphaMap=i.alphaMap,e.transparent=i.transparent||i.transmission>0,e.isShadowPassMaterial&&(e.side=null===i.shadowSide?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(c=e.depthNode,e.depthNode=i.depthNode),i.castShadowNode&&i.castShadowNode.isNode&&(d=e.colorNode,e.colorNode=i.castShadowNode),i.castShadowPositionNode&&i.castShadowPositionNode.isNode&&(l=e.positionNode,e.positionNode=i.castShadowPositionNode)),i=e}!0===i.transparent&&i.side===E&&!1===i.forceSinglePass?(i.side=S,this._handleObjectFunction(e,i,t,r,a,n,o,"backSide"),i.side=je,this._handleObjectFunction(e,i,t,r,a,n,o,u),i.side=E):this._handleObjectFunction(e,i,t,r,a,n,o,u),void 0!==l&&(t.overrideMaterial.positionNode=l),void 0!==c&&(t.overrideMaterial.depthNode=c),void 0!==d&&(t.overrideMaterial.colorNode=d),e.onAfterRender(this,t,r,s,i,n)}_renderObjectDirect(e,t,r,s,i,n,a,o){const u=this._objects.get(e,t,r,s,i,this._currentRenderContext,a,o);u.drawRange=e.geometry.drawRange,u.group=n;const l=this._nodes.needsRefresh(u);if(l&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),null!==this._currentRenderBundle){this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup}this.backend.draw(u,this.info),l&&this._nodes.updateAfter(u)}_createObjectPipeline(e,t,r,s,i,n,a,o){const u=this._objects.get(e,t,r,s,i,this._currentRenderContext,a,o);u.drawRange=e.geometry.drawRange,u.group=n,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class DN{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}class UN extends DN{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return(e=this._buffer.byteLength)+(Lf-e%Lf)%Lf;var e}get buffer(){return this._buffer}update(){return!0}}class VN extends UN{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let ON=0;class GN extends VN{constructor(e,t){super("UniformBuffer_"+ON++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class kN extends VN{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}get values(){return null===this._values&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(null===e){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let r=0,s=this.uniforms.length;r<s;r++){const s=this.uniforms[r],i=s.boundary,n=s.itemSize*e,a=t%Lf,o=a%i,u=a+o;t+=o,0!==u&&Lf-u<n&&(t+=Lf-u),s.offset=t/e,t+=n}return Math.ceil(t/Lf)*Lf}update(){let e=!1;for(const t of this.uniforms)!0===this.updateByType(t)&&(e=!0);return e}updateByType(e){return e.isNumberUniform?this.updateNumber(e):e.isVector2Uniform?this.updateVector2(e):e.isVector3Uniform?this.updateVector3(e):e.isVector4Uniform?this.updateVector4(e):e.isColorUniform?this.updateColor(e):e.isMatrix3Uniform?this.updateMatrix3(e):e.isMatrix4Uniform?this.updateMatrix4(e):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i]!==s){this._getBufferForType(n)[i]=r[i]=s,t=!0}return t}updateVector2(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i+0]!==s.x||r[i+1]!==s.y){const e=this._getBufferForType(n);e[i+0]=r[i+0]=s.x,e[i+1]=r[i+1]=s.y,t=!0}return t}updateVector3(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i+0]!==s.x||r[i+1]!==s.y||r[i+2]!==s.z){const e=this._getBufferForType(n);e[i+0]=r[i+0]=s.x,e[i+1]=r[i+1]=s.y,e[i+2]=r[i+2]=s.z,t=!0}return t}updateVector4(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset,n=e.getType();if(r[i+0]!==s.x||r[i+1]!==s.y||r[i+2]!==s.z||r[i+4]!==s.w){const e=this._getBufferForType(n);e[i+0]=r[i+0]=s.x,e[i+1]=r[i+1]=s.y,e[i+2]=r[i+2]=s.z,e[i+3]=r[i+3]=s.w,t=!0}return t}updateColor(e){let t=!1;const r=this.values,s=e.getValue(),i=e.offset;if(r[i+0]!==s.r||r[i+1]!==s.g||r[i+2]!==s.b){const e=this.buffer;e[i+0]=r[i+0]=s.r,e[i+1]=r[i+1]=s.g,e[i+2]=r[i+2]=s.b,t=!0}return t}updateMatrix3(e){let t=!1;const r=this.values,s=e.getValue().elements,i=e.offset;if(r[i+0]!==s[0]||r[i+1]!==s[1]||r[i+2]!==s[2]||r[i+4]!==s[3]||r[i+5]!==s[4]||r[i+6]!==s[5]||r[i+8]!==s[6]||r[i+9]!==s[7]||r[i+10]!==s[8]){const e=this.buffer;e[i+0]=r[i+0]=s[0],e[i+1]=r[i+1]=s[1],e[i+2]=r[i+2]=s[2],e[i+4]=r[i+4]=s[3],e[i+5]=r[i+5]=s[4],e[i+6]=r[i+6]=s[5],e[i+8]=r[i+8]=s[6],e[i+9]=r[i+9]=s[7],e[i+10]=r[i+10]=s[8],t=!0}return t}updateMatrix4(e){let t=!1;const r=this.values,s=e.getValue().elements,i=e.offset;if(!1===function(e,t,r){for(let s=0,i=t.length;s<i;s++)if(e[r+s]!==t[s])return!1;return!0}(r,s,i)){this.buffer.set(s,i),function(e,t,r){for(let s=0,i=t.length;s<i;s++)e[r+s]=t[s]}(r,s,i),t=!0}return t}_getBufferForType(e){return"int"===e||"ivec2"===e||"ivec3"===e||"ivec4"===e?new Int32Array(this.buffer.buffer):"uint"===e||"uvec2"===e||"uvec3"===e||"uvec4"===e?new Uint32Array(this.buffer.buffer):this.buffer}}let zN=0;class $N extends kN{constructor(e,t){super(e),this.id=zN++,this.groupNode=t,this.isNodeUniformsGroup=!0}}class HN extends DN{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.generation=null,this.isSampler=!0}set texture(e){if(this._texture===e)return;const t=()=>{this._texture=null,this.generation=null,this.version=0};this._texture&&this._texture.removeEventListener("dispose",t),this._texture=e,this.generation=null,this.version=0,this._texture&&this._texture.addEventListener("dispose",t)}get texture(){return this._texture}update(){const{texture:e,version:t}=this;return t!==e.version&&(this.version=e.version,!0)}clone(){const e=super.clone();return e._texture=null,e.texture=this.texture,e}}let WN=0;class qN extends HN{constructor(e,t){super(e,t),this.id=WN++,this.store=!1,this.isSampledTexture=!0}}class jN extends qN{constructor(e,t,r,s=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r,this.access=s}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class XN extends jN{constructor(e,t,r,s=null){super(e,t,r,s),this.isSampledCubeTexture=!0}}class KN extends jN{constructor(e,t,r,s=null){super(e,t,r,s),this.isSampledTexture3D=!0}}const YN={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint"},QN={low:"lowp",medium:"mediump",high:"highp"},ZN={swizzleAssign:!0,storageBuffer:!1},JN={perspective:"smooth",linear:"noperspective"},eS={centroid:"centroid"},tS="\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\nprecision lowp sampler2DArrayShadow;\nprecision lowp samplerCubeShadow;\n";class rS extends Uv{constructor(e,t){super(e,t,new iN),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return!0===e.isVideoTexture&&e.colorSpace!==b}getMethod(e){return YN[e]||e}getBitcastMethod(e,t){return YN[`bitcast_${t}_${e}`]}getTernary(e,t,r){return`${e} ? ${t} : ${r}`}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,r=this.flowShaderNode(e),s=[];for(const e of t.inputs)s.push(this.getType(e.type)+" "+e.name);return`${this.getType(t.type)} ${t.name}( ${s.join(", ")} ) {\n\n\t${r.vars}\n\n${r.code}\n\treturn ${r.result};\n\n}`}setupPBO(e){const t=e.value;if(void 0===t.pbo){const e=t.array,r=t.count*t.itemSize,{itemSize:s}=t,i=t.array.constructor.name.toLowerCase().includes("int");let n=i?nt:at;2===s?n=i?dt:Ve:3===s?n=i?ct:ht:4===s&&(n=i?pt:de);const a={Float32Array:I,Uint8Array:Ce,Uint16Array:lt,Uint32Array:T,Int8Array:ut,Int16Array:ot,Int32Array:_,Uint8ClampedArray:Ce},o=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let u=Math.ceil(r/s/o);o*u*s<r&&u++;const l=o*u*s,d=new e.constructor(l);d.set(e,0),t.array=d;const c=new it(t.array,o,u,n,a[t.array.constructor.name]||I);c.needsUpdate=!0,c.isPBOTexture=!0;const h=new ll(c,null,null);h.setPrecision("high"),t.pboNode=h,t.pbo=h.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&!0!==e.node.isTextureNode&&!0!==e.node.isBufferNode?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:r}=e,s=t.value;if(this.renderer.backend.has(s)){this.renderer.backend.get(s).pbo=s.pbo}const i=this.getUniformFromNode(s.pboNode,"texture",this.shaderStage,this.context.nodeName),n=this.getPropertyName(i);this.increaseUsage(r);const a=r.build(this,"uint"),o=this.getDataFromNode(e);let u=o.propertyName;if(void 0===u){const r=this.getVarFromNode(e);u=this.getPropertyName(r);const i=this.getDataFromNode(t);let l=i.propertySizeName;void 0===l&&(l=u+"Size",this.getVarFromNode(t,l,"uint"),this.addLineFlowCode(`${l} = uint( textureSize( ${n}, 0 ).x )`,e),i.propertySizeName=l);const{itemSize:d}=s,c="."+js.join("").slice(0,d),h=`ivec2(${a} % ${l}, ${a} / ${l})`,p=this.generateTextureLoad(null,n,h,null,null,"0");let g="vec4";s.pbo.type===T?g="uvec4":s.pbo.type===_&&(g="ivec4"),this.addLineFlowCode(`${u} = ${g}(${p})${c}`,e),o.propertyName=u}return u}generateTextureLoad(e,t,r,s,i,n="0"){let a;return a=s?i?`texelFetchOffset( ${t}, ivec3( ${r}, ${s} ), ${n}, ${i} )`:`texelFetch( ${t}, ivec3( ${r}, ${s} ), ${n} )`:i?`texelFetchOffset( ${t}, ${r}, ${n}, ${i} )`:`texelFetch( ${t}, ${r}, ${n} )`,null!==e&&e.isDepthTexture&&(a+=".x"),a}generateTexture(e,t,r,s,i){return s&&(r=`vec3( ${r}, ${s} )`),e.isDepthTexture?i?`textureOffset( ${t}, ${r}, ${i} ).x`:`texture( ${t}, ${r} ).x`:i?`textureOffset( ${t}, ${r}, ${i} )`:`texture( ${t}, ${r} )`}generateTextureLevel(e,t,r,s,i){return i?`textureLodOffset( ${t}, ${r}, ${s}, ${i} )`:`textureLod( ${t}, ${r}, ${s} )`}generateTextureBias(e,t,r,s,i){return i?`textureOffset( ${t}, ${r}, ${i}, ${s} )`:`texture( ${t}, ${r}, ${s} )`}generateTextureGrad(e,t,r,s,i){return i?`textureGradOffset( ${t}, ${r}, ${s[0]}, ${s[1]}, ${i} )`:`textureGrad( ${t}, ${r}, ${s[0]}, ${s[1]} )`}generateTextureCompare(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return i?n?`textureOffset( ${t}, vec4( ${r}, ${i}, ${s} ), ${n} )`:`texture( ${t}, vec4( ${r}, ${i}, ${s} ) )`:n?`textureOffset( ${t}, vec3( ${r}, ${s} ), ${n} )`:`texture( ${t}, vec3( ${r}, ${s} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}getVars(e){const t=[],r=this.vars[e];if(void 0!==r)for(const e of r)t.push(`${this.getVar(e.type,e.name,e.count)};`);return t.join("\n\t")}getUniforms(e){const t=this.uniforms[e],r=[],s={};for(const i of t){let t=null,n=!1;if("texture"===i.type||"texture3D"===i.type){const e=i.node.value;let r="";!0!==e.isDataTexture&&!0!==e.isData3DTexture||(e.type===T?r="u":e.type===_&&(r="i")),t="texture3D"===i.type&&!1===e.isArrayTexture?`${r}sampler3D ${i.name};`:e.compareFunction?!0===e.isArrayTexture?`sampler2DArrayShadow ${i.name};`:`sampler2DShadow ${i.name};`:!0===e.isArrayTexture||!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?`${r}sampler2DArray ${i.name};`:`${r}sampler2D ${i.name};`}else if("cubeTexture"===i.type)t=`samplerCube ${i.name};`;else if("buffer"===i.type){const e=i.node,r=this.getType(e.bufferType),s=e.bufferCount,n=s>0?s:"";t=`${e.name} {\n\t${r} ${i.name}[${n}];\n};\n`}else{t=`${this.getVectorType(i.type)} ${this.getPropertyName(i,e)};`,n=!0}const a=i.node.precision;if(null!==a&&(t=QN[a]+" "+t),n){t="\t"+t;const e=i.groupNode.name;(s[e]||(s[e]=[])).push(t)}else t="uniform "+t,r.push(t)}let i="";for(const t in s){const r=s[t];i+=this._getGLSLUniformStruct(e+"_"+t,r.join("\n"))+"\n"}return i+=r.join("\n"),i}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==_){let r=e;e.isInterleavedBufferAttribute&&(r=e.data);const s=r.array;!1==(s instanceof Uint32Array||s instanceof Int32Array)&&(t=t.slice(1))}return t}getAttributes(e){let t="";if("vertex"===e||"compute"===e){const e=this.getAttributesArray();let r=0;for(const s of e)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};\n`}return t}getStructMembers(e){const t=[];for(const r of e.members)t.push(`\t${r.type} ${r.name};`);return t.join("\n")}getStructs(e){const t=[],r=this.structs[e],s=[];for(const e of r)if(e.output)for(const t of e.members)s.push(`layout( location = ${t.index} ) out ${t.type} ${t.name};`);else{let r="struct "+e.name+" {\n";r+=this.getStructMembers(e),r+="\n};\n",t.push(r)}return 0===s.length&&s.push("layout( location = 0 ) out vec4 fragColor;"),"\n"+s.join("\n")+"\n\n"+t.join("\n")}getVaryings(e){let t="";const r=this.varyings;if("vertex"===e||"compute"===e)for(const s of r){"compute"===e&&(s.needsInterpolation=!0);const r=this.getType(s.type);if(s.needsInterpolation)if(s.interpolationType){t+=`${JN[s.interpolationType]||s.interpolationType} ${eS[s.interpolationSampling]||""} out ${r} ${s.name};\n`}else{t+=`${r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":""}out ${r} ${s.name};\n`}else t+=`${r} ${s.name};\n`}else if("fragment"===e)for(const e of r)if(e.needsInterpolation){const r=this.getType(e.type);if(e.interpolationType){t+=`${JN[e.interpolationType]||e.interpolationType} ${eS[e.interpolationSampling]||""} in ${r} ${e.name};\n`}else{t+=`${r.includes("int")||r.includes("uv")||r.includes("iv")?"flat ":""}in ${r} ${e.name};\n`}}for(const r of this.builtins[e])t+=`${r};\n`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((e,t)=>e*t,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,r=this.shaderStage){const s=this.extensions[r]||(this.extensions[r]=new Map);!1===s.has(e)&&s.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if("vertex"===e){const t=this.renderer.backend.extensions;this.object.isBatchedMesh&&t.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const r=this.extensions[e];if(void 0!==r)for(const{name:e,behavior:s}of r.values())t.push(`#extension ${e} : ${s}`);return t.join("\n")}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=ZN[e];if(void 0===t){let r;switch(t=!1,e){case"float32Filterable":r="OES_texture_float_linear";break;case"clipDistance":r="WEBGL_clip_cull_distance"}if(void 0!==r){const e=this.renderer.backend.extensions;e.has(r)&&(e.get(r),t=!0)}ZN[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let r=0;r<e.length;r++){const s=e[r],i=this.getPropertyName(s.attributeNode);i&&(t+=`${s.varyingName} = ${i};\n\t`)}return t}_getGLSLUniformStruct(e,t){return`\nlayout( std140 ) uniform ${e} {\n${t}\n};`}_getGLSLVertexCode(e){return`#version 300 es\n\n${this.getSignature()}\n\n// extensions\n${e.extensions}\n\n// precision\n${tS}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\n\n// attributes\n${e.attributes}\n\n// codes\n${e.codes}\n\nvoid main() {\n\n\t// vars\n\t${e.vars}\n\n\t// transforms\n\t${e.transforms}\n\n\t// flow\n\t${e.flow}\n\n\tgl_PointSize = 1.0;\n\n}\n`}_getGLSLFragmentCode(e){return`#version 300 es\n\n${this.getSignature()}\n\n// extensions\n${e.extensions}\n\n// precision\n${tS}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\n\n// codes\n${e.codes}\n\n// structs\n${e.structs}\n\nvoid main() {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let r="// code\n\n";r+=this.flowCode[t];const s=this.flowNodes[t],i=s[s.length-1];for(const e of s){const s=this.getFlowData(e),n=e.name;n&&(r.length>0&&(r+="\n"),r+=`\t// flow -> ${n}\n\t`),r+=`${s.code}\n\t`,e===i&&"compute"!==t&&(r+="// result\n\t","vertex"===t?(r+="gl_Position = ",r+=`${s.result};`):"fragment"===t&&(e.outputNode.isOutputStructNode||(r+="fragColor = ",r+=`${s.result};`)))}const n=e[t];n.extensions=this.getExtensions(t),n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.vars=this.getVars(t),n.structs=this.getStructs(t),n.codes=this.getCodes(t),n.transforms=this.getTransforms(t),n.flow=r}null!==this.material?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,r,s=null){const i=super.getUniformFromNode(e,t,r,s),n=this.getDataFromNode(e,r,this.globalCache);let a=n.uniformGPU;if(void 0===a){const s=e.groupNode,o=s.name,u=this.getBindGroupArray(o,r);if("texture"===t)a=new jN(i.name,i.node,s),u.push(a);else if("cubeTexture"===t)a=new XN(i.name,i.node,s),u.push(a);else if("texture3D"===t)a=new KN(i.name,i.node,s),u.push(a);else if("buffer"===t){e.name=`NodeBuffer_${e.id}`,i.name=`buffer${e.id}`;const t=new GN(e,s);t.name=e.name,u.push(t),a=t}else{const e=this.uniformGroups[r]||(this.uniformGroups[r]={});let n=e[o];void 0===n&&(n=new $N(r+"_"+o,s),e[o]=n,u.push(n)),a=this.getNodeUniform(i,t),n.addUniform(a)}n.uniformGPU=a}return i}}let sS=null,iS=null;class nS{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=!0===e.trackTimestamp}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}getTimestampUID(e){const t=this.get(e);let r=!0===e.isComputeNode?"c":"r";return r+=":"+t.frameCalls+":"+e.id,r}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp)return void Be("WebGPURenderer: Timestamp tracking is disabled.");const t=this.timestampQueryPool[e];if(!t)return void Be(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);const r=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=r,r}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return sS=sS||new t,this.renderer.getDrawingBufferSize(sS)}setScissorTest(){}getClearColor(){const e=this.renderer;return iS=iS||new oy,e.getClearColor(iS),iS.getRGB(iS),iS}getDomElement(){let e=this.domElement;return null===e&&(e=void 0!==this.parameters.canvas?this.parameters.canvas:gt(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${He} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let aS,oS,uS=0;class lS{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[1^this.activeBufferIndex]}switchBuffers(){this.activeBufferIndex^=1}}class dS{constructor(e){this.backend=e}createAttribute(e,t){const r=this.backend,{gl:s}=r,i=e.array,n=e.usage||s.STATIC_DRAW,a=e.isInterleavedBufferAttribute?e.data:e,o=r.get(a);let u,l=o.bufferGPU;if(void 0===l&&(l=this._createBuffer(s,t,i,n),o.bufferGPU=l,o.bufferType=t,o.version=a.version),i instanceof Float32Array)u=s.FLOAT;else if("undefined"!=typeof Float16Array&&i instanceof Float16Array)u=s.HALF_FLOAT;else if(i instanceof Uint16Array)u=e.isFloat16BufferAttribute?s.HALF_FLOAT:s.UNSIGNED_SHORT;else if(i instanceof Int16Array)u=s.SHORT;else if(i instanceof Uint32Array)u=s.UNSIGNED_INT;else if(i instanceof Int32Array)u=s.INT;else if(i instanceof Int8Array)u=s.BYTE;else if(i instanceof Uint8Array)u=s.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+i);u=s.UNSIGNED_BYTE}let d={bufferGPU:l,bufferType:t,type:u,byteLength:i.byteLength,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:u===s.INT||u===s.UNSIGNED_INT||e.gpuType===_,id:uS++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const e=this._createBuffer(s,t,i,n);d=new lS(d,e)}r.set(e,d)}updateAttribute(e){const t=this.backend,{gl:r}=t,s=e.array,i=e.isInterleavedBufferAttribute?e.data:e,n=t.get(i),a=n.bufferType,o=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(r.bindBuffer(a,n.bufferGPU),0===o.length)r.bufferSubData(a,0,s);else{for(let e=0,t=o.length;e<t;e++){const t=o[e];r.bufferSubData(a,t.start*s.BYTES_PER_ELEMENT,s,t.start,t.count)}i.clearUpdateRanges()}r.bindBuffer(a,null),n.version=i.version}destroyAttribute(e){const t=this.backend,{gl:r}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const s=t.get(e);r.deleteBuffer(s.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:r}=t,s=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:i}=t.get(s),n=e.array,a=n.byteLength;r.bindBuffer(r.COPY_READ_BUFFER,i);const o=r.createBuffer();r.bindBuffer(r.COPY_WRITE_BUFFER,o),r.bufferData(r.COPY_WRITE_BUFFER,a,r.STREAM_READ),r.copyBufferSubData(r.COPY_READ_BUFFER,r.COPY_WRITE_BUFFER,0,0,a),await t.utils._clientWaitAsync();const u=new e.array.constructor(n.length);return r.bindBuffer(r.COPY_WRITE_BUFFER,o),r.getBufferSubData(r.COPY_WRITE_BUFFER,0,u),r.deleteBuffer(o),r.bindBuffer(r.COPY_READ_BUFFER,null),r.bindBuffer(r.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,t,r,s){const i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,r,s),e.bindBuffer(t,null),i}}class cS{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;aS={[Ke]:e.FUNC_ADD,[ft]:e.FUNC_SUBTRACT,[mt]:e.FUNC_REVERSE_SUBTRACT},oS={[Ye]:e.ZERO,[Rt]:e.ONE,[Et]:e.SRC_COLOR,[St]:e.SRC_ALPHA,[Nt]:e.SRC_ALPHA_SATURATE,[vt]:e.DST_COLOR,[_t]:e.DST_ALPHA,[Tt]:e.ONE_MINUS_SRC_COLOR,[xt]:e.ONE_MINUS_SRC_ALPHA,[bt]:e.ONE_MINUS_DST_COLOR,[yt]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),r=e.getParameter(e.VIEWPORT);this.currentScissor=(new s).fromArray(t),this.currentViewport=(new s).fromArray(r),this._tempVec4=new s}enable(e){const{enabled:t}=this;!0!==t[e]&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;!1!==t[e]&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==At?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===wt?t.cullFace(t.BACK):e===Ct?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:r}=this;e!==t&&(r.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,r,s,i,n,a,o){const{gl:u}=this;if(e!==$){if(!1===this.currentBlendingEnabled&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e===Xe)i=i||t,n=n||r,a=a||s,t===this.currentBlendEquation&&i===this.currentBlendEquationAlpha||(u.blendEquationSeparate(aS[t],aS[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),r===this.currentBlendSrc&&s===this.currentBlendDst&&n===this.currentBlendSrcAlpha&&a===this.currentBlendDstAlpha||(u.blendFuncSeparate(oS[r],oS[s],oS[n],oS[a]),this.currentBlendSrc=r,this.currentBlendDst=s,this.currentBlendSrcAlpha=n,this.currentBlendDstAlpha=a),this.currentBlending=e,this.currentPremultipledAlpha=!1;else if(e!==this.currentBlending||o!==this.currentPremultipledAlpha){if(this.currentBlendEquation===Ke&&this.currentBlendEquationAlpha===Ke||(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=Ke,this.currentBlendEquationAlpha=Ke),o)switch(e){case G:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Bt:u.blendFunc(u.ONE,u.ONE);break;case Pt:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Mt:u.blendFuncSeparate(u.DST_COLOR,u.ONE_MINUS_SRC_ALPHA,u.ZERO,u.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case G:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Bt:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE,u.ONE,u.ONE);break;case Pt:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Mt:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=o}}else!0===this.currentBlendingEnabled&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1)}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case Gt:t.depthFunc(t.NEVER);break;case Ot:t.depthFunc(t.ALWAYS);break;case Vt:t.depthFunc(t.LESS);break;case Ut:t.depthFunc(t.LEQUAL);break;case Dt:t.depthFunc(t.EQUAL);break;case It:t.depthFunc(t.GEQUAL);break;case Ft:t.depthFunc(t.GREATER);break;case Lt:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,r,s){const i=this._tempVec4.set(e,t,r,s);if(!1===this.currentScissor.equals(i)){const{gl:e}=this;e.scissor(i.x,i.y,i.z,i.w),this.currentScissor.copy(i)}}viewport(e,t,r,s){const i=this._tempVec4.set(e,t,r,s);if(!1===this.currentViewport.equals(i)){const{gl:e}=this;e.viewport(i.x,i.y,i.z,i.w),this.currentViewport.copy(i)}}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,r){this.currentStencilFunc===e&&this.currentStencilRef===t&&this.currentStencilFuncMask===r||(this.gl.stencilFunc(e,t,r),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=r)}setStencilOp(e,t,r){this.currentStencilFail===e&&this.currentStencilZFail===t&&this.currentStencilZPass===r||(this.gl.stencilOp(e,t,r),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=r)}setMaterial(e,t,r){const{gl:s}=this;e.side===E?this.disable(s.CULL_FACE):this.enable(s.CULL_FACE);let i=e.side===S;t&&(i=!i),this.setFlipSided(i),e.blending===G&&!1===e.transparent?this.setBlending($):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const n=e.stencilWrite;if(this.setStencilTest(n),n&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage&&this.backend.renderer.samples>1?this.enable(s.SAMPLE_ALPHA_TO_COVERAGE):this.disable(s.SAMPLE_ALPHA_TO_COVERAGE),r>0&&this.currentClippingPlanes!==r){const e=12288;for(let t=0;t<8;t++)t<r?this.enable(e+t):this.disable(e+t)}}setPolygonOffset(e,t,r){const{gl:s}=this;e?(this.enable(s.POLYGON_OFFSET_FILL),this.currentPolygonOffsetFactor===t&&this.currentPolygonOffsetUnits===r||(s.polygonOffset(t,r),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=r)):this.disable(s.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e&&(this.gl.useProgram(e),this.currentProgram=e,!0)}setVertexState(e,t=null){const r=this.gl;return(this.currentVAO!==e||this.currentIndex!==t)&&(r.bindVertexArray(e),null!==t&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0)}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:r,currentBoundFramebuffers:s}=this;return s[e]!==t&&(r.bindFramebuffer(e,t),s[e]=t,e===r.DRAW_FRAMEBUFFER&&(s[r.FRAMEBUFFER]=t),e===r.FRAMEBUFFER&&(s[r.DRAW_FRAMEBUFFER]=t),!0)}drawBuffers(e,t){const{gl:r}=this;let s=[],i=!1;if(null!==e.textures){s=this.currentDrawbuffers.get(t),void 0===s&&(s=[],this.currentDrawbuffers.set(t,s));const n=e.textures;if(s.length!==n.length||s[0]!==r.COLOR_ATTACHMENT0){for(let e=0,t=n.length;e<t;e++)s[e]=r.COLOR_ATTACHMENT0+e;s.length=n.length,i=!0}}else s[0]!==r.BACK&&(s[0]=r.BACK,i=!0);i&&r.drawBuffers(s)}activeTexture(e){const{gl:t,currentTextureSlot:r,maxTextures:s}=this;void 0===e&&(e=t.TEXTURE0+s-1),r!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,r){const{gl:s,currentTextureSlot:i,currentBoundTextures:n,maxTextures:a}=this;void 0===r&&(r=null===i?s.TEXTURE0+a-1:i);let o=n[r];void 0===o&&(o={type:void 0,texture:void 0},n[r]=o),o.type===e&&o.texture===t||(i!==r&&(s.activeTexture(r),this.currentTextureSlot=r),s.bindTexture(e,t),o.type=e,o.texture=t)}bindBufferBase(e,t,r){const{gl:s}=this,i=`${e}-${t}`;return this.currentBoundBufferBases[i]!==r&&(s.bindBufferBase(e,t,r),this.currentBoundBufferBases[i]=r,!0)}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:r}=this,s=r[t];void 0!==s&&void 0!==s.type&&(e.bindTexture(s.type,null),s.type=void 0,s.texture=void 0)}}class hS{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=b){const{gl:r,extensions:s}=this;let i;const n=c.getTransfer(t);if(e===Ce)return r.UNSIGNED_BYTE;if(e===kt)return r.UNSIGNED_SHORT_4_4_4_4;if(e===zt)return r.UNSIGNED_SHORT_5_5_5_1;if(e===$t)return r.UNSIGNED_INT_5_9_9_9_REV;if(e===Ht)return r.UNSIGNED_INT_10F_11F_11F_REV;if(e===ut)return r.BYTE;if(e===ot)return r.SHORT;if(e===lt)return r.UNSIGNED_SHORT;if(e===_)return r.INT;if(e===T)return r.UNSIGNED_INT;if(e===I)return r.FLOAT;if(e===ce)return r.HALF_FLOAT;if(e===Wt)return r.ALPHA;if(e===ht)return r.RGB;if(e===de)return r.RGBA;if(e===Ae)return r.DEPTH_COMPONENT;if(e===Re)return r.DEPTH_STENCIL;if(e===at)return r.RED;if(e===nt)return r.RED_INTEGER;if(e===Ve)return r.RG;if(e===dt)return r.RG_INTEGER;if(e===pt)return r.RGBA_INTEGER;if(e===qt||e===jt||e===Xt||e===Kt)if(n===h){if(i=s.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(e===qt)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===jt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Xt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Kt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=s.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(e===qt)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===jt)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Xt)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Kt)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===Yt||e===Qt||e===Zt||e===Jt){if(i=s.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(e===Yt)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Qt)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Zt)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Jt)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===er||e===tr||e===rr){if(i=s.get("WEBGL_compressed_texture_etc"),null===i)return null;if(e===er||e===tr)return n===h?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===rr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(e===sr||e===ir||e===nr||e===ar||e===or||e===ur||e===lr||e===dr||e===cr||e===hr||e===pr||e===gr||e===mr||e===fr){if(i=s.get("WEBGL_compressed_texture_astc"),null===i)return null;if(e===sr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===ir)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===nr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===ar)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===or)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===ur)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===lr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===dr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===cr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===hr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===pr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===gr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===mr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===fr)return n===h?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===yr){if(i=s.get("EXT_texture_compression_bptc"),null===i)return null;if(e===yr)return n===h?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(e===br||e===xr||e===Tr||e===_r){if(i=s.get("EXT_texture_compression_rgtc"),null===i)return null;if(e===br)return i.COMPRESSED_RED_RGTC1_EXT;if(e===xr)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===Tr)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===_r)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return e===we?r.UNSIGNED_INT_24_8:void 0!==r[e]?r[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((r,s)=>{!function i(){const n=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(n===e.WAIT_FAILED)return e.deleteSync(t),void s();n!==e.TIMEOUT_EXPIRED?(e.deleteSync(t),r()):requestAnimationFrame(i)}()})}}let pS,gS,mS,fS=!1;class yS{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},!1===fS&&(this._init(),fS=!0)}_init(){const e=this.gl;pS={[Sr]:e.REPEAT,[Nr]:e.CLAMP_TO_EDGE,[vr]:e.MIRRORED_REPEAT},gS={[v]:e.NEAREST,[Er]:e.NEAREST_MIPMAP_NEAREST,[ze]:e.NEAREST_MIPMAP_LINEAR,[Y]:e.LINEAR,[ke]:e.LINEAR_MIPMAP_NEAREST,[U]:e.LINEAR_MIPMAP_LINEAR},mS={[Br]:e.NEVER,[Pr]:e.ALWAYS,[Ue]:e.LESS,[Mr]:e.LEQUAL,[Cr]:e.EQUAL,[wr]:e.GEQUAL,[Ar]:e.GREATER,[Rr]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let r;return r=!0===e.isCubeTexture?t.TEXTURE_CUBE_MAP:!0===e.isArrayTexture||!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:!0===e.isData3DTexture?t.TEXTURE_3D:t.TEXTURE_2D,r}getInternalFormat(e,t,r,s,i=!1){const{gl:n,extensions:a}=this;if(null!==e){if(void 0!==n[e])return n[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let o=t;if(t===n.RED&&(r===n.FLOAT&&(o=n.R32F),r===n.HALF_FLOAT&&(o=n.R16F),r===n.UNSIGNED_BYTE&&(o=n.R8),r===n.UNSIGNED_SHORT&&(o=n.R16),r===n.UNSIGNED_INT&&(o=n.R32UI),r===n.BYTE&&(o=n.R8I),r===n.SHORT&&(o=n.R16I),r===n.INT&&(o=n.R32I)),t===n.RED_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.R8UI),r===n.UNSIGNED_SHORT&&(o=n.R16UI),r===n.UNSIGNED_INT&&(o=n.R32UI),r===n.BYTE&&(o=n.R8I),r===n.SHORT&&(o=n.R16I),r===n.INT&&(o=n.R32I)),t===n.RG&&(r===n.FLOAT&&(o=n.RG32F),r===n.HALF_FLOAT&&(o=n.RG16F),r===n.UNSIGNED_BYTE&&(o=n.RG8),r===n.UNSIGNED_SHORT&&(o=n.RG16),r===n.UNSIGNED_INT&&(o=n.RG32UI),r===n.BYTE&&(o=n.RG8I),r===n.SHORT&&(o=n.RG16I),r===n.INT&&(o=n.RG32I)),t===n.RG_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.RG8UI),r===n.UNSIGNED_SHORT&&(o=n.RG16UI),r===n.UNSIGNED_INT&&(o=n.RG32UI),r===n.BYTE&&(o=n.RG8I),r===n.SHORT&&(o=n.RG16I),r===n.INT&&(o=n.RG32I)),t===n.RGB){const e=i?Lr:c.getTransfer(s);r===n.FLOAT&&(o=n.RGB32F),r===n.HALF_FLOAT&&(o=n.RGB16F),r===n.UNSIGNED_BYTE&&(o=n.RGB8),r===n.UNSIGNED_SHORT&&(o=n.RGB16),r===n.UNSIGNED_INT&&(o=n.RGB32UI),r===n.BYTE&&(o=n.RGB8I),r===n.SHORT&&(o=n.RGB16I),r===n.INT&&(o=n.RGB32I),r===n.UNSIGNED_BYTE&&(o=e===h?n.SRGB8:n.RGB8),r===n.UNSIGNED_SHORT_5_6_5&&(o=n.RGB565),r===n.UNSIGNED_SHORT_5_5_5_1&&(o=n.RGB5_A1),r===n.UNSIGNED_SHORT_4_4_4_4&&(o=n.RGB4),r===n.UNSIGNED_INT_5_9_9_9_REV&&(o=n.RGB9_E5),r===n.UNSIGNED_INT_10F_11F_11F_REV&&(o=n.R11F_G11F_B10F)}if(t===n.RGB_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.RGB8UI),r===n.UNSIGNED_SHORT&&(o=n.RGB16UI),r===n.UNSIGNED_INT&&(o=n.RGB32UI),r===n.BYTE&&(o=n.RGB8I),r===n.SHORT&&(o=n.RGB16I),r===n.INT&&(o=n.RGB32I)),t===n.RGBA){const e=i?Lr:c.getTransfer(s);r===n.FLOAT&&(o=n.RGBA32F),r===n.HALF_FLOAT&&(o=n.RGBA16F),r===n.UNSIGNED_BYTE&&(o=n.RGBA8),r===n.UNSIGNED_SHORT&&(o=n.RGBA16),r===n.UNSIGNED_INT&&(o=n.RGBA32UI),r===n.BYTE&&(o=n.RGBA8I),r===n.SHORT&&(o=n.RGBA16I),r===n.INT&&(o=n.RGBA32I),r===n.UNSIGNED_BYTE&&(o=e===h?n.SRGB8_ALPHA8:n.RGBA8),r===n.UNSIGNED_SHORT_4_4_4_4&&(o=n.RGBA4),r===n.UNSIGNED_SHORT_5_5_5_1&&(o=n.RGB5_A1)}return t===n.RGBA_INTEGER&&(r===n.UNSIGNED_BYTE&&(o=n.RGBA8UI),r===n.UNSIGNED_SHORT&&(o=n.RGBA16UI),r===n.UNSIGNED_INT&&(o=n.RGBA32UI),r===n.BYTE&&(o=n.RGBA8I),r===n.SHORT&&(o=n.RGBA16I),r===n.INT&&(o=n.RGBA32I)),t===n.DEPTH_COMPONENT&&(r===n.UNSIGNED_SHORT&&(o=n.DEPTH_COMPONENT16),r===n.UNSIGNED_INT&&(o=n.DEPTH_COMPONENT24),r===n.FLOAT&&(o=n.DEPTH_COMPONENT32F)),t===n.DEPTH_STENCIL&&r===n.UNSIGNED_INT_24_8&&(o=n.DEPTH24_STENCIL8),o!==n.R16F&&o!==n.R32F&&o!==n.RG16F&&o!==n.RG32F&&o!==n.RGBA16F&&o!==n.RGBA32F||a.get("EXT_color_buffer_float"),o}setTextureParameters(e,t){const{gl:r,extensions:s,backend:i}=this,n=c.getPrimaries(c.workingColorSpace),a=t.colorSpace===b?null:c.getPrimaries(t.colorSpace),o=t.colorSpace===b||n===a?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,t.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,o),r.texParameteri(e,r.TEXTURE_WRAP_S,pS[t.wrapS]),r.texParameteri(e,r.TEXTURE_WRAP_T,pS[t.wrapT]),e!==r.TEXTURE_3D&&e!==r.TEXTURE_2D_ARRAY||t.isArrayTexture||r.texParameteri(e,r.TEXTURE_WRAP_R,pS[t.wrapR]),r.texParameteri(e,r.TEXTURE_MAG_FILTER,gS[t.magFilter]);const u=void 0!==t.mipmaps&&t.mipmaps.length>0,l=t.minFilter===Y&&u?U:t.minFilter;if(r.texParameteri(e,r.TEXTURE_MIN_FILTER,gS[l]),t.compareFunction&&(r.texParameteri(e,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(e,r.TEXTURE_COMPARE_FUNC,mS[t.compareFunction])),!0===s.has("EXT_texture_filter_anisotropic")){if(t.magFilter===v)return;if(t.minFilter!==ze&&t.minFilter!==U)return;if(t.type===I&&!1===s.has("OES_texture_float_linear"))return;if(t.anisotropy>1){const n=s.get("EXT_texture_filter_anisotropic");r.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:r,defaultTextures:s}=this,i=this.getGLTextureType(e);let n=s[i];void 0===n&&(n=t.createTexture(),r.state.bindTexture(i,n),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),s[i]=n),r.set(e,{textureGPU:n,glTextureType:i,isDefault:!0})}createTexture(e,t){const{gl:r,backend:s}=this,{levels:i,width:n,height:a,depth:o}=t,u=s.utils.convert(e.format,e.colorSpace),l=s.utils.convert(e.type),d=this.getInternalFormat(e.internalFormat,u,l,e.colorSpace,e.isVideoTexture),c=r.createTexture(),h=this.getGLTextureType(e);s.state.bindTexture(h,c),this.setTextureParameters(h,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?r.texStorage3D(r.TEXTURE_2D_ARRAY,i,d,n,a,o):e.isData3DTexture?r.texStorage3D(r.TEXTURE_3D,i,d,n,a,o):e.isVideoTexture||r.texStorage2D(h,i,d,n,a),s.set(e,{textureGPU:c,glTextureType:h,glFormat:u,glType:l,glInternalFormat:d})}copyBufferToTexture(e,t){const{gl:r,backend:s}=this,{textureGPU:i,glTextureType:n,glFormat:a,glType:o}=s.get(t),{width:u,height:l}=t.source.data;r.bindBuffer(r.PIXEL_UNPACK_BUFFER,e),s.state.bindTexture(n,i),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.texSubImage2D(n,0,0,0,u,l,a,o,0),r.bindBuffer(r.PIXEL_UNPACK_BUFFER,null),s.state.unbindTexture()}updateTexture(e,t){const{gl:r}=this,{width:s,height:i}=t,{textureGPU:n,glTextureType:a,glFormat:o,glType:u,glInternalFormat:l}=this.backend.get(e);if(!e.isRenderTargetTexture&&void 0!==n)if(this.backend.state.bindTexture(a,n),this.setTextureParameters(a,e),e.isCompressedTexture){const s=e.mipmaps,i=t.image;for(let t=0;t<s.length;t++){const n=s[t];e.isCompressedArrayTexture?e.format!==r.RGBA?null!==o?r.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,t,0,0,0,n.width,n.height,i.depth,o,n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texSubImage3D(r.TEXTURE_2D_ARRAY,t,0,0,0,n.width,n.height,i.depth,o,u,n.data):null!==o?r.compressedTexSubImage2D(r.TEXTURE_2D,t,0,0,n.width,n.height,o,n.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const n=t.images,a=e.mipmaps;for(let e=0;e<6;e++){const t=bS(n[e]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,s,i,o,u,t);for(let t=0;t<a.length;t++){const s=bS(a[t].images[e]);r.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+e,t+1,0,0,s.width,s.height,o,u,s)}}}else if(e.isDataArrayTexture||e.isArrayTexture){const s=t.image;if(e.layerUpdates.size>0){const t=Fr(s.width,s.height,e.format,e.type);for(const i of e.layerUpdates){const e=s.data.subarray(i*t/s.data.BYTES_PER_ELEMENT,(i+1)*t/s.data.BYTES_PER_ELEMENT);r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,i,s.width,s.height,1,o,u,e)}e.clearLayerUpdates()}else r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,s.width,s.height,s.depth,o,u,s.data)}else if(e.isData3DTexture){const e=t.image;r.texSubImage3D(r.TEXTURE_3D,0,0,0,0,e.width,e.height,e.depth,o,u,e.data)}else if(e.isVideoTexture)e.update(),r.texImage2D(a,0,l,o,u,t.image);else{const n=e.mipmaps;if(n.length>0)for(let e=0,t=n.length;e<t;e++){const t=n[e],s=bS(t);r.texSubImage2D(a,e,0,0,t.width,t.height,o,u,s)}else{const e=bS(t.image);r.texSubImage2D(a,0,0,0,s,i,o,u,e)}}}generateMipmaps(e){const{gl:t,backend:r}=this,{textureGPU:s,glTextureType:i}=r.get(e);r.state.bindTexture(i,s),t.generateMipmap(i)}deallocateRenderBuffers(e){const{gl:t,backend:r}=this;if(e){const s=r.get(e);if(s.renderBufferStorageSetup=void 0,s.framebuffers){for(const e in s.framebuffers)t.deleteFramebuffer(s.framebuffers[e]);delete s.framebuffers}if(s.depthRenderbuffer&&(t.deleteRenderbuffer(s.depthRenderbuffer),delete s.depthRenderbuffer),s.stencilRenderbuffer&&(t.deleteRenderbuffer(s.stencilRenderbuffer),delete s.stencilRenderbuffer),s.msaaFrameBuffer&&(t.deleteFramebuffer(s.msaaFrameBuffer),delete s.msaaFrameBuffer),s.msaaRenderbuffers){for(let e=0;e<s.msaaRenderbuffers.length;e++)t.deleteRenderbuffer(s.msaaRenderbuffers[e]);delete s.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:r}=this,{textureGPU:s,renderTarget:i}=r.get(e);this.deallocateRenderBuffers(i),t.deleteTexture(s),r.delete(e)}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){const{gl:a,backend:o}=this,{state:u}=this.backend,{textureGPU:l,glTextureType:d,glType:c,glFormat:h}=o.get(t);let p,g,m,f,y,b,x,T,_;u.bindTexture(d,l);const v=e.isCompressedTexture?e.mipmaps[n]:e.image;if(null!==r)p=r.max.x-r.min.x,g=r.max.y-r.min.y,m=r.isBox3?r.max.z-r.min.z:1,f=r.min.x,y=r.min.y,b=r.isBox3?r.min.z:0;else{const t=Math.pow(2,-i);p=Math.floor(v.width*t),g=Math.floor(v.height*t),m=e.isDataArrayTexture||e.isArrayTexture?v.depth:e.isData3DTexture?Math.floor(v.depth*t):1,f=0,y=0,b=0}null!==s?(x=s.x,T=s.y,_=s.z):(x=0,T=0,_=0),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,t.unpackAlignment);const N=a.getParameter(a.UNPACK_ROW_LENGTH),S=a.getParameter(a.UNPACK_IMAGE_HEIGHT),E=a.getParameter(a.UNPACK_SKIP_PIXELS),R=a.getParameter(a.UNPACK_SKIP_ROWS),A=a.getParameter(a.UNPACK_SKIP_IMAGES);a.pixelStorei(a.UNPACK_ROW_LENGTH,v.width),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,v.height),a.pixelStorei(a.UNPACK_SKIP_PIXELS,f),a.pixelStorei(a.UNPACK_SKIP_ROWS,y),a.pixelStorei(a.UNPACK_SKIP_IMAGES,b);const w=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const r=o.get(e),s=o.get(t),i=o.get(r.renderTarget),n=o.get(s.renderTarget),l=i.framebuffers[r.cacheKey],d=n.framebuffers[s.cacheKey];u.bindFramebuffer(a.READ_FRAMEBUFFER,l),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,d);let c=a.COLOR_BUFFER_BIT;e.isDepthTexture&&(c=a.DEPTH_BUFFER_BIT),a.blitFramebuffer(f,y,p,g,x,T,p,g,c,a.NEAREST),u.bindFramebuffer(a.READ_FRAMEBUFFER,null),u.bindFramebuffer(a.DRAW_FRAMEBUFFER,null)}else w?e.isDataTexture||e.isData3DTexture?a.texSubImage3D(d,n,x,T,_,p,g,m,h,c,v.data):t.isCompressedArrayTexture?a.compressedTexSubImage3D(d,n,x,T,_,p,g,m,h,v.data):a.texSubImage3D(d,n,x,T,_,p,g,m,h,c,v):e.isDataTexture?a.texSubImage2D(d,n,x,T,p,g,h,c,v.data):e.isCompressedTexture?a.compressedTexSubImage2D(d,n,x,T,v.width,v.height,h,v.data):a.texSubImage2D(d,n,x,T,p,g,h,c,v);a.pixelStorei(a.UNPACK_ROW_LENGTH,N),a.pixelStorei(a.UNPACK_IMAGE_HEIGHT,S),a.pixelStorei(a.UNPACK_SKIP_PIXELS,E),a.pixelStorei(a.UNPACK_SKIP_ROWS,R),a.pixelStorei(a.UNPACK_SKIP_IMAGES,A),0===n&&t.generateMipmaps&&a.generateMipmap(d),u.unbindTexture()}copyFramebufferToTexture(e,t,r){const{gl:s}=this,{state:i}=this.backend,{textureGPU:n}=this.backend.get(e),{x:a,y:o,z:u,w:l}=r,d=!0===e.isDepthTexture||t.renderTarget&&t.renderTarget.samples>0,c=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(d){const r=0!==a||0!==o;let d,h;if(!0===e.isDepthTexture?(d=s.DEPTH_BUFFER_BIT,h=s.DEPTH_ATTACHMENT,t.stencil&&(d|=s.STENCIL_BUFFER_BIT)):(d=s.COLOR_BUFFER_BIT,h=s.COLOR_ATTACHMENT0),r){const e=this.backend.get(t.renderTarget),r=e.framebuffers[t.getCacheKey()],h=e.msaaFrameBuffer;i.bindFramebuffer(s.DRAW_FRAMEBUFFER,r),i.bindFramebuffer(s.READ_FRAMEBUFFER,h);const p=c-o-l;s.blitFramebuffer(a,p,a+u,p+l,a,p,a+u,p+l,d,s.NEAREST),i.bindFramebuffer(s.READ_FRAMEBUFFER,r),i.bindTexture(s.TEXTURE_2D,n),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,a,p,u,l),i.unbindTexture()}else{const e=s.createFramebuffer();i.bindFramebuffer(s.DRAW_FRAMEBUFFER,e),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,h,s.TEXTURE_2D,n,0),s.blitFramebuffer(0,0,u,l,0,0,u,l,d,s.NEAREST),s.deleteFramebuffer(e)}}else i.bindTexture(s.TEXTURE_2D,n),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,a,c-l-o,u,l),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,r,s=!1){const{gl:i}=this,n=t.renderTarget,{depthTexture:a,depthBuffer:o,stencilBuffer:u,width:l,height:d}=n;if(i.bindRenderbuffer(i.RENDERBUFFER,e),o&&!u){let t=i.DEPTH_COMPONENT24;if(!0===s){this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(i.RENDERBUFFER,n.samples,t,l,d)}else r>0?(a&&a.isDepthTexture&&a.type===i.FLOAT&&(t=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,r,t,l,d)):i.renderbufferStorage(i.RENDERBUFFER,t,l,d);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else o&&u&&(r>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,r,i.DEPTH24_STENCIL8,l,d):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,l,d),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e));i.bindRenderbuffer(i.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,r,s,i,n){const{backend:a,gl:o}=this,{textureGPU:u,glFormat:l,glType:d}=this.backend.get(e),c=o.createFramebuffer();o.bindFramebuffer(o.READ_FRAMEBUFFER,c);const h=e.isCubeTexture?o.TEXTURE_CUBE_MAP_POSITIVE_X+n:o.TEXTURE_2D;o.framebufferTexture2D(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,h,u,0);const p=this._getTypedArrayType(d),g=s*i*this._getBytesPerTexel(d,l),m=o.createBuffer();o.bindBuffer(o.PIXEL_PACK_BUFFER,m),o.bufferData(o.PIXEL_PACK_BUFFER,g,o.STREAM_READ),o.readPixels(t,r,s,i,l,d,0),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),await a.utils._clientWaitAsync();const f=new p(g/p.BYTES_PER_ELEMENT);return o.bindBuffer(o.PIXEL_PACK_BUFFER,m),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,f),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),o.deleteFramebuffer(c),f}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_5_5_1)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_6_5)return Uint16Array;if(e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:r}=this;let s=0;return e===r.UNSIGNED_BYTE&&(s=1),e!==r.UNSIGNED_SHORT_4_4_4_4&&e!==r.UNSIGNED_SHORT_5_5_5_1&&e!==r.UNSIGNED_SHORT_5_6_5&&e!==r.UNSIGNED_SHORT&&e!==r.HALF_FLOAT||(s=2),e!==r.UNSIGNED_INT&&e!==r.FLOAT||(s=4),t===r.RGBA?4*s:t===r.RGB?3*s:t===r.ALPHA?s:void 0}}function bS(e){return e.isDataTexture?e.image.data:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?e:e.data}class xS{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return void 0===t&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class TS{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(null!==this.maxAnisotropy)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(!0===t.has("EXT_texture_filter_anisotropic")){const r=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const _S={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class vS{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:r,mode:s,object:i,type:n,info:a,index:o}=this;0!==o?r.drawElements(s,t,n,e):r.drawArrays(s,e,t),a.update(i,t,1)}renderInstances(e,t,r){const{gl:s,mode:i,type:n,index:a,object:o,info:u}=this;0!==r&&(0!==a?s.drawElementsInstanced(i,t,n,e,r):s.drawArraysInstanced(i,e,t,r),u.update(o,t,r))}renderMultiDraw(e,t,r){const{extensions:s,mode:i,object:n,info:a}=this;if(0===r)return;const o=s.get("WEBGL_multi_draw");if(null===o)for(let s=0;s<r;s++)this.render(e[s],t[s]);else{0!==this.index?o.multiDrawElementsWEBGL(i,t,0,this.type,e,0,r):o.multiDrawArraysWEBGL(i,e,0,t,0,r);let s=0;for(let e=0;e<r;e++)s+=t[e];a.update(n,s,1)}}renderMultiDrawInstances(e,t,r,s){const{extensions:i,mode:n,object:a,info:o}=this;if(0===r)return;const u=i.get("WEBGL_multi_draw");if(null===u)for(let i=0;i<r;i++)this.renderInstances(e[i],t[i],s[i]);else{0!==this.index?u.multiDrawElementsInstancedWEBGL(n,t,0,this.type,e,0,s,0,r):u.multiDrawArraysInstancedWEBGL(n,e,0,t,0,s,0,r);let i=0;for(let e=0;e<r;e++)i+=t[e]*s[e];o.update(a,i,1)}}}class NS{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class SS extends NS{constructor(e,t,r=2048){if(super(r),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext)return console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),void(this.trackTimestamp=!1);this.queries=[];for(let t=0;t<this.maxQueries;t++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Be(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(null==t)return;if(null!==this.activeQuery)return;const r=this.queries[t];if(r)try{"inactive"===this.queryStates.get(t)&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,r),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(e){console.error("Error in beginQuery:",e),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(null!=t&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(e){console.error("Error in endQuery:",e),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[t,r]of this.queryStates)if("ended"===r){const r=this.queries[t];e.push(this.resolveQuery(r))}if(0===e.length)return this.lastValue;const t=(await Promise.all(e)).reduce((e,t)=>e+t,0);return this.lastValue=t,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,t}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed)return void t(this.lastValue);let r,s=!1;const i=e=>{s||(s=!0,r&&(clearTimeout(r),r=null),t(e))},n=()=>{if(this.isDisposed)i(this.lastValue);else try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT))return void i(this.lastValue);if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE))return void(r=setTimeout(n,1));const s=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(s)/1e6)}catch(e){console.error("Error checking query:",e),t(this.lastValue)}};n()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class ES extends nS{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,r={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},s=void 0!==t.context?t.context:e.domElement.getContext("webgl2",r);function i(t){t.preventDefault();const r={api:"WebGL",message:t.statusMessage||"Unknown reason",reason:null,originalEvent:t};e.onDeviceLost(r)}this._onContextLost=i,e.domElement.addEventListener("webglcontextlost",i,!1),this.gl=s,this.extensions=new xS(this),this.capabilities=new TS(this),this.attributeUtils=new dS(this),this.textureUtils=new yS(this),this.bufferRenderer=new vS(this),this.state=new cS(this),this.utils=new hS(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return l}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){!0!==this.gl.getContextAttributes().xrCompatible&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,r=null){const s=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:s.RGBA8}),null!==r){const t=e.stencilBuffer?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:r,glInternalFormat:t}),!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&!0===e._autoAllocateDepthBuffer&&!1===e.multiview&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new SS(this.gl,e,2048));const r=this.timestampQueryPool[e];null!==r.allocateQueriesForContext(t)&&r.beginQuery(t)}prepareTimestampBuffer(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e].endQuery(t)}getContext(){return this.gl}beginRender(e){const{state:t}=this,r=this.get(e);if(r.frameCalls=this.renderer.info.render.frameCalls,e.viewport)this.updateViewport(e);else{const{width:e,height:r}=this.getDrawingBufferSize();t.viewport(0,0,e,r)}if(e.scissor){const{x:r,y:s,width:i,height:n}=e.scissorValue;t.scissor(r,e.height-n-s,i,n)}this.initTimestampQuery(Ir.RENDER,this.getTimestampUID(e)),r.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const s=e.occlusionQueryCount;s>0&&(r.currentOcclusionQueries=r.occlusionQueries,r.currentOcclusionQueryObjects=r.occlusionQueryObjects,r.lastOcclusionObject=null,r.occlusionQueries=new Array(s),r.occlusionQueryObjects=new Array(s),r.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:r}=this,s=this.get(e),i=s.previousContext;r.resetVertexState();const n=e.occlusionQueryCount;n>0&&(n>s.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const a=e.textures;if(null!==a)for(let e=0;e<a.length;e++){const t=a[e];t.generateMipmaps&&this.generateMipmaps(t)}if(this._currentContext=i,this._resolveRenderTarget(e),null!==i)if(this._setFramebuffer(i),i.viewport)this.updateViewport(i);else{const{width:e,height:t}=this.getDrawingBufferSize();r.viewport(0,0,e,t)}this.prepareTimestampBuffer(Ir.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:r,currentOcclusionQueryObjects:s}=t;if(r&&s){const e=new WeakSet,{gl:i}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const n=()=>{let a=0;for(let t=0;t<r.length;t++){const n=r[t];null!==n&&(i.getQueryParameter(n,i.QUERY_RESULT_AVAILABLE)&&(0===i.getQueryParameter(n,i.QUERY_RESULT)&&e.add(s[t]),r[t]=null,i.deleteQuery(n),a++))}a<r.length?requestAnimationFrame(n):t.occluded=e};n()}}isOccluded(e,t){const r=this.get(e);return r.occluded&&r.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:r,y:s,width:i,height:n}=e.viewportValue;t.viewport(r,e.height-n-s,i,n)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,r,s=null,i=!0,n=!0){const{gl:a,renderer:o}=this;if(null===s){s={textures:null,clearColorValue:this.getClearColor()}}let u=0;if(e&&(u|=a.COLOR_BUFFER_BIT),t&&(u|=a.DEPTH_BUFFER_BIT),r&&(u|=a.STENCIL_BUFFER_BIT),0!==u){let l;l=s.clearColorValue?s.clearColorValue:this.getClearColor();const d=o.getClearDepth(),c=o.getClearStencil();if(t&&this.state.setDepthMask(!0),null===s.textures)a.clearColor(l.r,l.g,l.b,l.a),a.clear(u);else{if(i&&this._setFramebuffer(s),e)for(let e=0;e<s.textures.length;e++)0===e?a.clearBufferfv(a.COLOR,e,[l.r,l.g,l.b,l.a]):a.clearBufferfv(a.COLOR,e,[0,0,0,1]);t&&r?a.clearBufferfi(a.DEPTH_STENCIL,0,d,c):t?a.clearBufferfv(a.DEPTH,0,[d]):r&&a.clearBufferiv(a.STENCIL,0,[c]),i&&n&&this._resolveRenderTarget(s)}}}beginCompute(e){const{state:t,gl:r}=this;this.get(e).frameCalls=this.renderer.info.compute.frameCalls,t.bindFramebuffer(r.FRAMEBUFFER,null),this.initTimestampQuery(Ir.COMPUTE,this.getTimestampUID(e))}compute(e,t,r,s,i=null){const{state:n,gl:a}=this;!1===this.discard&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:o,transformBuffers:u,attributes:l}=this.get(s),d=this._getVaoKey(l),c=this.vaoCache[d];void 0===c?this.vaoCache[d]=this._createVao(l):n.setVertexState(c),n.useProgram(o),this._bindUniforms(r);const h=this._getTransformFeedback(u);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,h),a.beginTransformFeedback(a.POINTS),i=null!==i?i:t.count,Array.isArray(i)&&(Be("WebGLBackend.compute(): The count parameter must be a single number, not an array."),i=i[0]),l[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,i):a.drawArrays(a.POINTS,0,i),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(let e=0;e<u.length;e++){const t=u[e];t.pbo&&this.has(t.pbo)&&this.textureUtils.copyBufferToTexture(t.transformBuffer,t.pbo),t.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(Ir.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:r,material:s,context:i,hardwareClippingPlanes:n}=e,{programGPU:a}=this.get(r),{gl:o,state:u}=this,l=this.get(i),d=e.getDrawParameters();if(null===d)return;this._bindUniforms(e.getBindings());const c=t.isMesh&&t.matrixWorld.determinant()<0;u.setMaterial(s,c,n),u.useProgram(a);const h=e.getAttributes(),p=this.get(h);let g=p.vaoGPU;if(void 0===g){const e=this._getVaoKey(h);g=this.vaoCache[e],void 0===g&&(g=this._createVao(h),this.vaoCache[e]=g,p.vaoGPU=g)}const m=e.getIndex(),f=null!==m?this.get(m).bufferGPU:null;u.setVertexState(g,f);const y=l.lastOcclusionObject;if(y!==t&&void 0!==y){if(null!==y&&!0===y.occlusionTest&&(o.endQuery(o.ANY_SAMPLES_PASSED),l.occlusionQueryIndex++),!0===t.occlusionTest){const e=o.createQuery();o.beginQuery(o.ANY_SAMPLES_PASSED,e),l.occlusionQueries[l.occlusionQueryIndex]=e,l.occlusionQueryObjects[l.occlusionQueryIndex]=t}l.lastOcclusionObject=t}const b=this.bufferRenderer;t.isPoints?b.mode=o.POINTS:t.isLineSegments?b.mode=o.LINES:t.isLine?b.mode=o.LINE_STRIP:t.isLineLoop?b.mode=o.LINE_LOOP:!0===s.wireframe?(u.setLineWidth(s.wireframeLinewidth*this.renderer.getPixelRatio()),b.mode=o.LINES):b.mode=o.TRIANGLES;const{vertexCount:x,instanceCount:T}=d;let{firstVertex:_}=d;if(b.object=t,null!==m){_*=m.array.BYTES_PER_ELEMENT;const e=this.get(m);b.index=m.count,b.type=e.type}else b.index=0;const v=()=>{t.isBatchedMesh?null!==t._multiDrawInstances?(Be("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),b.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?b.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):Be("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):T>1?b.renderInstances(_,x,T):b.render(_,x)};if(!0===e.camera.isArrayCamera&&e.camera.cameras.length>0&&!1===e.camera.isMultiViewCamera){const r=this.get(e.camera),s=e.camera.cameras,i=e.getBindingGroup("cameraIndex").bindings[0];if(void 0===r.indexesGPU||r.indexesGPU.length!==s.length){const e=new Uint32Array([0,0,0,0]),t=[];for(let r=0,i=s.length;r<i;r++){const s=o.createBuffer();e[0]=r,o.bindBuffer(o.UNIFORM_BUFFER,s),o.bufferData(o.UNIFORM_BUFFER,e,o.STATIC_DRAW),t.push(s)}r.indexesGPU=t}const n=this.get(i),a=this.renderer.getPixelRatio(),l=this._currentContext.renderTarget,d=this._isRenderCameraDepthArray(this._currentContext),c=this._currentContext.activeCubeFace;if(d){const e=this.get(l.depthTexture);if(e.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){e.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:t}=l;for(let e=0,r=s.length;e<r;e++)this.renderer._activeCubeFace=e,this._currentContext.activeCubeFace=e,this._setFramebuffer(this._currentContext),this.clear(!1,!0,t,this._currentContext,!1,!1);this.renderer._activeCubeFace=c,this._currentContext.activeCubeFace=c}}for(let i=0,l=s.length;i<l;i++){const l=s[i];if(t.layers.test(l.layers)){d&&(this.renderer._activeCubeFace=i,this._currentContext.activeCubeFace=i,this._setFramebuffer(this._currentContext));const t=l.viewport;if(void 0!==t){const r=t.x*a,s=t.y*a,i=t.width*a,n=t.height*a;u.viewport(Math.floor(r),Math.floor(e.context.height-n-s),Math.floor(i),Math.floor(n))}u.bindBufferBase(o.UNIFORM_BUFFER,n.index,r.indexesGPU[i]),v()}this._currentContext.activeCubeFace=c,this.renderer._activeCubeFace=c}}else v()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,s,i,n){return this.textureUtils.copyTextureToBuffer(e,t,r,s,i,n)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new rS(e,t)}createProgram(e){const t=this.gl,{stage:r,code:s}=e,i="fragment"===r?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,s),t.compileShader(i),this.set(e,{shaderGPU:i})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const r=this.gl,s=e.pipeline,{fragmentProgram:i,vertexProgram:n}=s,a=r.createProgram(),o=this.get(i).shaderGPU,u=this.get(n).shaderGPU;if(r.attachShader(a,o),r.attachShader(a,u),r.linkProgram(a),this.set(s,{programGPU:a,fragmentShader:o,vertexShader:u}),null!==t&&this.parallel){const i=new Promise(t=>{const i=this.parallel,n=()=>{r.getProgramParameter(a,i.COMPLETION_STATUS_KHR)?(this._completeCompile(e,s),t()):requestAnimationFrame(n)};n()});return void t.push(i)}this._completeCompile(e,s)}_handleSource(e,t){const r=e.split("\n"),s=[],i=Math.max(t-6,0),n=Math.min(t+6,r.length);for(let e=i;e<n;e++){const i=e+1;s.push(`${i===t?">":" "} ${i}: ${r[e]}`)}return s.join("\n")}_getShaderErrors(e,t,r){const s=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(s&&""===i)return"";const n=/ERROR: 0:(\d+)/.exec(i);if(n){const s=parseInt(n[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+this._handleSource(e.getShaderSource(t),s)}return i}_logProgramError(e,t,r){if(this.renderer.debug.checkShaderErrors){const s=this.gl,i=(s.getProgramInfoLog(e)||"").trim();if(!1===s.getProgramParameter(e,s.LINK_STATUS))if("function"==typeof this.renderer.debug.onShaderError)this.renderer.debug.onShaderError(s,e,r,t);else{const n=this._getShaderErrors(s,r,"vertex"),a=this._getShaderErrors(s,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(e,s.VALIDATE_STATUS)+"\n\nProgram Info Log: "+i+"\n"+n+"\n"+a)}else""!==i&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}_completeCompile(e,t){const{state:r,gl:s}=this,i=this.get(t),{programGPU:n,fragmentShader:a,vertexShader:o}=i;!1===s.getProgramParameter(n,s.LINK_STATUS)&&this._logProgramError(n,a,o),r.useProgram(n);const u=e.getBindings();this._setupBindings(u,n),this.set(t,{programGPU:n})}createComputePipeline(e,t){const{state:r,gl:s}=this,i={stage:"fragment",code:"#version 300 es\nprecision highp float;\nvoid main() {}"};this.createProgram(i);const{computeProgram:n}=e,a=s.createProgram(),o=this.get(i).shaderGPU,u=this.get(n).shaderGPU,l=n.transforms,d=[],c=[];for(let e=0;e<l.length;e++){const t=l[e];d.push(t.varyingName),c.push(t.attributeNode)}s.attachShader(a,o),s.attachShader(a,u),s.transformFeedbackVaryings(a,d,s.SEPARATE_ATTRIBS),s.linkProgram(a),!1===s.getProgramParameter(a,s.LINK_STATUS)&&this._logProgramError(a,o,u),r.useProgram(a),this._setupBindings(t,a);const h=n.attributes,p=[],g=[];for(let e=0;e<h.length;e++){const t=h[e].node.attribute;p.push(t),this.has(t)||this.attributeUtils.createAttribute(t,s.ARRAY_BUFFER)}for(let e=0;e<c.length;e++){const t=c[e].attribute;this.has(t)||this.attributeUtils.createAttribute(t,s.ARRAY_BUFFER);const r=this.get(t);g.push(r)}this.set(e,{programGPU:a,transformBuffers:g,attributes:p})}createBindings(e,t){if(!1===this._knownBindings.has(t)){this._knownBindings.add(t);let e=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:e});for(const t of s.bindings)t.isUniformBuffer&&e++,t.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,r=this.get(e);let s=r.uniformBuffers,i=r.textures;for(const r of e.bindings){const e=this.get(r);if(r.isUniformsGroup||r.isUniformBuffer){const i=r.buffer;let{bufferGPU:n}=this.get(i);void 0===n?(n=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW),this.set(i,{bufferGPU:n})):(t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferSubData(t.UNIFORM_BUFFER,0,i)),e.index=s++,e.bufferGPU=n,this.set(r,e)}else if(r.isSampledTexture){const{textureGPU:t,glTextureType:s}=this.get(r.texture);e.index=i++,e.textureGPU=t,e.glTextureType=s,this.set(r,e)}}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(_S).filter(t=>_S[t]===e),r=this.extensions;for(let e=0;e<t.length;e++)if(r.has(t[e]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){this.textureUtils.copyTextureToTexture(e,t,r,s,i,n)}copyFramebufferToTexture(e,t,r){this.textureUtils.copyFramebufferToTexture(e,t,r)}_setFramebuffer(e){const{gl:t,state:r}=this;let s=null;if(null!==e.textures){const i=e.renderTarget,n=this.get(i),{samples:a,depthBuffer:o,stencilBuffer:u}=i,l=!0===i.isWebGLCubeRenderTarget,d=!0===i.isRenderTarget3D,c=i.depth>1,h=!0===i.isXRRenderTarget,p=!0===h&&!0===i._hasExternalTextures;let g=n.msaaFrameBuffer,m=n.depthRenderbuffer;const f=this.extensions.get("WEBGL_multisampled_render_to_texture"),y=this.extensions.get("OVR_multiview2"),b=this._useMultisampledExtension(i),x=ey(e);let T;if(l?(n.cubeFramebuffers||(n.cubeFramebuffers={}),T=n.cubeFramebuffers[x]):h&&!1===p?T=this._xrFramebuffer:(n.framebuffers||(n.framebuffers={}),T=n.framebuffers[x]),void 0===T){T=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,T);const s=e.textures,o=[];if(l){n.cubeFramebuffers[x]=T;const{textureGPU:e}=this.get(s[0]),r=this.renderer._activeCubeFace,i=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+r,e,i)}else{n.framebuffers[x]=T;for(let r=0;r<s.length;r++){const n=s[r],o=this.get(n);o.renderTarget=e.renderTarget,o.cacheKey=x;const u=t.COLOR_ATTACHMENT0+r;if(i.multiview)y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,u,o.textureGPU,0,a,0,2);else if(d||c){const e=this.renderer._activeCubeFace,r=this.renderer._activeMipmapLevel;t.framebufferTextureLayer(t.FRAMEBUFFER,u,o.textureGPU,r,e)}else if(b)f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,u,t.TEXTURE_2D,o.textureGPU,0,a);else{const e=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,u,t.TEXTURE_2D,o.textureGPU,e)}}}const h=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(!0===i._autoAllocateDepthBuffer){const r=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(r,e,0,b),n.xrDepthRenderbuffer=r,o.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,h,t.RENDERBUFFER,r)}else if(null!==e.depthTexture){o.push(u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const r=this.get(e.depthTexture);if(r.renderTarget=e.renderTarget,r.cacheKey=x,i.multiview)y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,h,r.textureGPU,0,a,0,2);else if(p&&b)f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,h,t.TEXTURE_2D,r.textureGPU,0,a);else if(e.depthTexture.isArrayTexture){const e=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,h,r.textureGPU,0,e)}else t.framebufferTexture2D(t.FRAMEBUFFER,h,t.TEXTURE_2D,r.textureGPU,0)}n.depthInvalidationArray=o}else{if(this._isRenderCameraDepthArray(e)){r.bindFramebuffer(t.FRAMEBUFFER,T);const s=this.renderer._activeCubeFace,i=this.get(e.depthTexture),n=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,n,i.textureGPU,0,s)}if((h||b||i.multiview)&&!0!==i._isOpaqueFramebuffer){r.bindFramebuffer(t.FRAMEBUFFER,T);const s=this.get(e.textures[0]);i.multiview?y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,s.textureGPU,0,a,0,2):b?f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s.textureGPU,0);const o=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(!0===i._autoAllocateDepthBuffer){const e=n.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,o,t.RENDERBUFFER,e)}else{const r=this.get(e.depthTexture);i.multiview?y.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,o,r.textureGPU,0,a,0,2):b?f.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,o,t.TEXTURE_2D,r.textureGPU,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,o,t.TEXTURE_2D,r.textureGPU,0)}}}if(a>0&&!1===b&&!i.multiview){if(void 0===g){const s=[];g=t.createFramebuffer(),r.bindFramebuffer(t.FRAMEBUFFER,g);const i=[],l=e.textures;for(let r=0;r<l.length;r++){i[r]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,i[r]),s.push(t.COLOR_ATTACHMENT0+r);const n=e.textures[r],o=this.get(n);t.renderbufferStorageMultisample(t.RENDERBUFFER,a,o.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+r,t.RENDERBUFFER,i[r])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),n.msaaFrameBuffer=g,n.msaaRenderbuffers=i,o&&void 0===m){m=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(m,e,a),n.depthRenderbuffer=m;const r=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;s.push(r)}n.invalidationArray=s}s=n.msaaFrameBuffer}else s=T;r.drawBuffers(e,T)}r.bindFramebuffer(t.FRAMEBUFFER,s)}_getVaoKey(e){let t="";for(let r=0;r<e.length;r++){t+=":"+this.get(e[r]).id}return t}_createVao(e){const{gl:t}=this,r=t.createVertexArray();t.bindVertexArray(r);for(let r=0;r<e.length;r++){const s=e[r],i=this.get(s);let n,a;t.bindBuffer(t.ARRAY_BUFFER,i.bufferGPU),t.enableVertexAttribArray(r),!0===s.isInterleavedBufferAttribute?(n=s.data.stride*i.bytesPerElement,a=s.offset*i.bytesPerElement):(n=0,a=0),i.isInteger?t.vertexAttribIPointer(r,s.itemSize,i.type,n,a):t.vertexAttribPointer(r,s.itemSize,i.type,s.normalized,n,a),s.isInstancedBufferAttribute&&!s.isInterleavedBufferAttribute?t.vertexAttribDivisor(r,s.meshPerAttribute):s.isInterleavedBufferAttribute&&s.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(r,s.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),r}_getTransformFeedback(e){let t="";for(let r=0;r<e.length;r++)t+=":"+e[r].id;let r=this.transformFeedbackCache[t];if(void 0!==r)return r;const{gl:s}=this;r=s.createTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,r);for(let t=0;t<e.length;t++){const r=e[t];s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,t,r.transformBuffer)}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=r,r}_setupBindings(e,t){const r=this.gl;for(const s of e)for(const e of s.bindings){const s=this.get(e).index;if(e.isUniformsGroup||e.isUniformBuffer){const i=r.getUniformBlockIndex(t,e.name);r.uniformBlockBinding(t,i,s)}else if(e.isSampledTexture){const i=r.getUniformLocation(t,e.name);r.uniform1i(i,s)}}}_bindUniforms(e){const{gl:t,state:r}=this;for(const s of e)for(const e of s.bindings){const s=this.get(e),i=s.index;e.isUniformsGroup||e.isUniformBuffer?r.bindBufferBase(t.UNIFORM_BUFFER,i,s.bufferGPU):e.isSampledTexture&&r.bindTexture(s.glTextureType,s.textureGPU,t.TEXTURE0+i)}}_resolveRenderTarget(e){const{gl:t,state:r}=this,s=e.renderTarget;if(null!==e.textures&&s){const i=this.get(s);if(s.samples>0&&!1===this._useMultisampledExtension(s)){const n=i.framebuffers[e.getCacheKey()];let a=t.COLOR_BUFFER_BIT;s.resolveDepthBuffer&&(s.depthBuffer&&(a|=t.DEPTH_BUFFER_BIT),s.stencilBuffer&&s.resolveStencilBuffer&&(a|=t.STENCIL_BUFFER_BIT));const o=i.msaaFrameBuffer,u=i.msaaRenderbuffers,l=e.textures,d=l.length>1;if(r.bindFramebuffer(t.READ_FRAMEBUFFER,o),r.bindFramebuffer(t.DRAW_FRAMEBUFFER,n),d)for(let e=0;e<l.length;e++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);for(let r=0;r<l.length;r++){if(d){const{textureGPU:e}=this.get(l[r]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,u[r]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}if(e.scissor){const{x:r,y:s,width:i,height:n}=e.scissorValue,o=e.height-n-s;t.blitFramebuffer(r,o,r+i,o+n,r,o,r+i,o+n,a,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,a,t.NEAREST)}if(d)for(let e=0;e<l.length;e++){const{textureGPU:r}=this.get(l[e]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,u[e]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,r,0)}!0===this._supportsInvalidateFramebuffer&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,i.invalidationArray)}else if(!1===s.resolveDepthBuffer&&i.framebuffers){const s=i.framebuffers[e.getCacheKey()];r.bindFramebuffer(t.DRAW_FRAMEBUFFER,s),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,i.depthInvalidationArray)}}}_useMultisampledExtension(e){return!0===e.multiview||e.samples>0&&!0===this.extensions.has("WEBGL_multisampled_render_to_texture")&&!1!==e._autoAllocateDepthBuffer}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const RS="point-list",AS="line-list",wS="line-strip",CS="triangle-list",MS="triangle-strip",PS="never",BS="less",LS="equal",FS="less-equal",IS="greater",DS="not-equal",US="greater-equal",VS="always",OS="store",GS="load",kS="clear",zS="ccw",$S="cw",HS="none",WS="back",qS="uint16",jS="uint32",XS="r8unorm",KS="r8snorm",YS="r8uint",QS="r8sint",ZS="r16uint",JS="r16sint",eE="r16float",tE="rg8unorm",rE="rg8snorm",sE="rg8uint",iE="rg8sint",nE="r32uint",aE="r32sint",oE="r32float",uE="rg16uint",lE="rg16sint",dE="rg16float",cE="rgba8unorm",hE="rgba8unorm-srgb",pE="rgba8snorm",gE="rgba8uint",mE="rgba8sint",fE="bgra8unorm",yE="bgra8unorm-srgb",bE="rgb9e5ufloat",xE="rgb10a2unorm",TE="rg11b10ufloat",_E="rg32uint",vE="rg32sint",NE="rg32float",SE="rgba16uint",EE="rgba16sint",RE="rgba16float",AE="rgba32uint",wE="rgba32sint",CE="rgba32float",ME="depth16unorm",PE="depth24plus",BE="depth24plus-stencil8",LE="depth32float",FE="depth32float-stencil8",IE="bc1-rgba-unorm",DE="bc1-rgba-unorm-srgb",UE="bc2-rgba-unorm",VE="bc2-rgba-unorm-srgb",OE="bc3-rgba-unorm",GE="bc3-rgba-unorm-srgb",kE="bc4-r-unorm",zE="bc4-r-snorm",$E="bc5-rg-unorm",HE="bc5-rg-snorm",WE="bc6h-rgb-ufloat",qE="bc6h-rgb-float",jE="bc7-rgba-unorm",XE="bc7-rgba-unorm-srgb",KE="etc2-rgb8unorm",YE="etc2-rgb8unorm-srgb",QE="etc2-rgb8a1unorm",ZE="etc2-rgb8a1unorm-srgb",JE="etc2-rgba8unorm",eR="etc2-rgba8unorm-srgb",tR="eac-r11unorm",rR="eac-r11snorm",sR="eac-rg11unorm",iR="eac-rg11snorm",nR="astc-4x4-unorm",aR="astc-4x4-unorm-srgb",oR="astc-5x4-unorm",uR="astc-5x4-unorm-srgb",lR="astc-5x5-unorm",dR="astc-5x5-unorm-srgb",cR="astc-6x5-unorm",hR="astc-6x5-unorm-srgb",pR="astc-6x6-unorm",gR="astc-6x6-unorm-srgb",mR="astc-8x5-unorm",fR="astc-8x5-unorm-srgb",yR="astc-8x6-unorm",bR="astc-8x6-unorm-srgb",xR="astc-8x8-unorm",TR="astc-8x8-unorm-srgb",_R="astc-10x5-unorm",vR="astc-10x5-unorm-srgb",NR="astc-10x6-unorm",SR="astc-10x6-unorm-srgb",ER="astc-10x8-unorm",RR="astc-10x8-unorm-srgb",AR="astc-10x10-unorm",wR="astc-10x10-unorm-srgb",CR="astc-12x10-unorm",MR="astc-12x10-unorm-srgb",PR="astc-12x12-unorm",BR="astc-12x12-unorm-srgb",LR="clamp-to-edge",FR="repeat",IR="mirror-repeat",DR="linear",UR="nearest",VR="zero",OR="one",GR="src",kR="one-minus-src",zR="src-alpha",$R="one-minus-src-alpha",HR="dst",WR="one-minus-dst",qR="dst-alpha",jR="one-minus-dst-alpha",XR="src-alpha-saturated",KR="constant",YR="one-minus-constant",QR="add",ZR="subtract",JR="reverse-subtract",eA="min",tA="max",rA=0,sA=15,iA="keep",nA="zero",aA="replace",oA="invert",uA="increment-clamp",lA="decrement-clamp",dA="increment-wrap",cA="decrement-wrap",hA="storage",pA="read-only-storage",gA="write-only",mA="read-only",fA="read-write",yA="non-filtering",bA="comparison",xA="float",TA="unfilterable-float",_A="depth",vA="sint",NA="uint",SA="2d",EA="3d",RA="2d",AA="2d-array",wA="cube",CA="3d",MA="all",PA="vertex",BA="instance",LA={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"};class FA extends HN{constructor(e,t,r){super(e,t?t.value:null),this.textureNode=t,this.groupNode=r}update(){this.texture=this.textureNode.value}}class IA extends UN{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let DA=0;class UA extends IA{constructor(e,t){super("StorageBuffer_"+DA++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:$s.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class VA extends wf{constructor(e){super(),this.device=e;this.mipmapSampler=e.createSampler({minFilter:DR}),this.flipYSampler=e.createSampler({minFilter:UR}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:"\nstruct VarysStruct {\n\t@builtin( position ) Position: vec4<f32>,\n\t@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n\tvar Varys : VarysStruct;\n\n\tvar pos = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( -1.0,  1.0 ),\n\t\tvec2<f32>(  1.0,  1.0 ),\n\t\tvec2<f32>( -1.0, -1.0 ),\n\t\tvec2<f32>(  1.0, -1.0 )\n\t);\n\n\tvar tex = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( 0.0, 0.0 ),\n\t\tvec2<f32>( 1.0, 0.0 ),\n\t\tvec2<f32>( 0.0, 1.0 ),\n\t\tvec2<f32>( 1.0, 1.0 )\n\t);\n\n\tVarys.vTex = tex[ vertexIndex ];\n\tVarys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n\treturn Varys;\n\n}\n"}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vTex );\n\n}\n"}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n"})}getTransferPipeline(e){let t=this.transferPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:MS,stripIndexFormat:jS},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:MS,stripIndexFormat:jS},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,r=0){const s=t.format,{width:i,height:n}=t.size,a=this.getTransferPipeline(s),o=this.getFlipYPipeline(s),u=this.device.createTexture({size:{width:i,height:n,depthOrArrayLayers:1},format:s,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),l=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:RA,baseArrayLayer:r}),d=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:RA,baseArrayLayer:0}),c=this.device.createCommandEncoder({}),h=(e,t,r)=>{const s=e.getBindGroupLayout(0),i=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:t}]}),n=c.beginRenderPass({colorAttachments:[{view:r,loadOp:kS,storeOp:OS,clearValue:[0,0,0,0]}]});n.setPipeline(e),n.setBindGroup(0,i),n.draw(4,1,0,0),n.end()};h(a,l,d),h(o,d,l),this.device.queue.submit([c.finish()]),u.destroy()}generateMipmaps(e,t,r=0){const s=this.get(e);void 0===s.useCount&&(s.useCount=0,s.layers=[]);const i=s.layers[r]||this._mipmapCreateBundles(e,t,r),n=this.device.createCommandEncoder({});this._mipmapRunBundles(n,i),this.device.queue.submit([n.finish()]),0!==s.useCount&&(s.layers[r]=i),s.useCount++}_mipmapCreateBundles(e,t,r){const s=this.getTransferPipeline(t.format),i=s.getBindGroupLayout(0);let n=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:RA,baseArrayLayer:r});const a=[];for(let o=1;o<t.mipLevelCount;o++){const u=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:n}]}),l=e.createView({baseMipLevel:o,mipLevelCount:1,dimension:RA,baseArrayLayer:r}),d={colorAttachments:[{view:l,loadOp:kS,storeOp:OS,clearValue:[0,0,0,0]}]},c=this.device.createRenderBundleEncoder({colorFormats:[t.format]});c.setPipeline(s),c.setBindGroup(0,u),c.draw(4,1,0,0),a.push({renderBundles:[c.finish()],passDescriptor:d}),n=l}return a}_mipmapRunBundles(e,t){const r=t.length;for(let s=0;s<r;s++){const r=t[s],i=e.beginRenderPass(r.passDescriptor);i.executeBundles(r.renderBundles),i.end()}}}const OA={[Br]:"never",[Ue]:"less",[Cr]:"equal",[Mr]:"less-equal",[Ar]:"greater",[wr]:"greater-equal",[Pr]:"always",[Rr]:"not-equal"},GA=[0,1,3,2,4,5];class kA{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new V,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,r=t.device,s=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===DR&&i.minFilter===DR&&i.mipmapFilter===DR&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&null!==e.compareFunction&&(i.compare=OA[e.compareFunction]),s.sampler=r.createSampler(i)}createDefaultTexture(e){let t;const r=zA(e);t=e.isCubeTexture?this._getDefaultCubeTextureGPU(r):this._getDefaultTextureGPU(r),this.backend.get(e).texture=t}createTexture(e,t={}){const r=this.backend,s=r.get(e);if(s.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture)return s.texture=e.sourceTexture,void(s.initialized=!0);void 0===t.needsMipmaps&&(t.needsMipmaps=!1),void 0===t.levels&&(t.levels=1),void 0===t.depth&&(t.depth=1);const{width:i,height:n,depth:a,levels:o}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),l=e.internalFormat||t.format||zA(e,r.device);s.format=l;const{samples:d,primarySamples:c,isMSAA:h}=r.utils.getTextureSampleData(e);let p=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;!0===e.isStorageTexture&&(p|=GPUTextureUsage.STORAGE_BINDING),!0!==e.isCompressedTexture&&!0!==e.isCompressedArrayTexture&&l!==bE&&(p|=GPUTextureUsage.RENDER_ATTACHMENT);const g={label:e.name,size:{width:i,height:n,depthOrArrayLayers:a},mipLevelCount:o,sampleCount:c,dimension:u,format:l,usage:p};if(void 0===l)return console.warn("WebGPURenderer: Texture format not supported."),void this.createDefaultTexture(e);if(e.isCubeTexture&&(g.textureBindingViewDimension=wA),s.texture=r.device.createTexture(g),h){const e=Object.assign({},g);e.label=e.label+"-msaa",e.sampleCount=d,e.mipLevelCount=1,s.msaaTexture=r.device.createTexture(e)}s.initialized=!0,s.textureDescriptorGPU=g}destroyTexture(e){const t=this.backend,r=t.get(e);void 0!==r.texture&&r.texture.destroy(),void 0!==r.msaaTexture&&r.msaaTexture.destroy(),t.delete(e)}destroySampler(e){delete this.backend.get(e).sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let e=0;e<6;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e);else{const r=e.image.depth||1;for(let e=0;e<r;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:r}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:r,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const r=this.backend,{width:s,height:i}=r.getDrawingBufferSize(),n=this.depthTexture,a=r.get(n).texture;let o,u;if(t?(o=Re,u=we):e&&(o=Ae,u=T),void 0!==a){if(n.image.width===s&&n.image.height===i&&n.format===o&&n.type===u)return a;this.destroyTexture(n)}return n.name="depthBuffer",n.format=o,n.type=u,n.image.width=s,n.image.height=i,this.createTexture(n,{width:s,height:i}),r.get(n).texture}updateTexture(e,t){const r=this.backend.get(e),s=e.mipmaps,{textureDescriptorGPU:i}=r;if(!e.isRenderTargetTexture&&void 0!==i){if(e.isDataTexture)if(s.length>0)for(let t=0,n=s.length;t<n;t++){const n=s[t];this._copyBufferToTexture(n,r.texture,i,0,e.flipY,0,t)}else this._copyBufferToTexture(t.image,r.texture,i,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let s=0;s<t.image.depth;s++)this._copyBufferToTexture(t.image,r.texture,i,s,e.flipY,s);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,r.texture,i);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,r.texture,i);else if(s.length>0)for(let t=0,n=s.length;t<n;t++){const n=s[t];this._copyImageToTexture(n,r.texture,i,0,e.flipY,e.premultiplyAlpha,t)}else this._copyImageToTexture(t.image,r.texture,i,0,e.flipY,e.premultiplyAlpha);r.version=e.version}}async copyTextureToBuffer(e,t,r,s,i,n){const a=this.backend.device,o=this.backend.get(e),u=o.texture,l=o.textureDescriptorGPU.format,d=this._getBytesPerTexel(l);let c=s*d;c=256*Math.ceil(c/256);const h=a.createBuffer({size:(i-1)*c+s*d,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),p=a.createCommandEncoder();p.copyTextureToBuffer({texture:u,origin:{x:t,y:r,z:n}},{buffer:h,bytesPerRow:c},{width:s,height:i});const g=this._getTypedArrayType(l);a.queue.submit([p.finish()]),await h.mapAsync(GPUMapMode.READ);return new g(h.getMappedRange())}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const r=new x;r.minFilter=v,r.magFilter=v,this.createTexture(r,{width:1,height:1,format:e}),this.defaultTexture[e]=t=r}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const r=new A;r.minFilter=v,r.magFilter=v,this.createTexture(r,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=r}return this.backend.get(t).texture}_copyCubeMapToTexture(e,t,r){const s=e.images,i=e.mipmaps;for(let n=0;n<6;n++){const a=s[n],o=!0===e.flipY?GA[n]:n;a.isDataTexture?this._copyBufferToTexture(a.image,t,r,o,e.flipY):this._copyImageToTexture(a,t,r,o,e.flipY,e.premultiplyAlpha);for(let s=0;s<i.length;s++){const a=i[s].images[n];a.isDataTexture?this._copyBufferToTexture(a.image,t,r,o,e.flipY,0,s+1):this._copyImageToTexture(a,t,r,o,e.flipY,e.premultiplyAlpha,s+1)}}}_copyImageToTexture(e,t,r,s,i,n,a=0){const o=this.backend.device,u=a>0?e.width:r.size.width,l=a>0?e.height:r.size.height;o.queue.copyExternalImageToTexture({source:e,flipY:i},{texture:t,mipLevel:a,origin:{x:0,y:0,z:s},premultipliedAlpha:n},{width:u,height:l,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return null===e&&(this._passUtils=e=new VA(this.backend.device)),e}_generateMipmaps(e,t,r=0){this._getPassUtils().generateMipmaps(e,t,r)}_flipY(e,t,r=0){this._getPassUtils().flipY(e,t,r)}_copyBufferToTexture(e,t,r,s,i,n=0,a=0){const o=this.backend.device,u=e.data,l=this._getBytesPerTexel(r.format),d=e.width*l;o.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:s}},u,{offset:e.width*e.height*l*n,bytesPerRow:d},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===i&&this._flipY(t,r,s)}_copyCompressedBufferToTexture(e,t,r){const s=this.backend.device,i=this._getBlockData(r.format),n=r.size.depthOrArrayLayers>1;for(let a=0;a<e.length;a++){const o=e[a],u=o.width,l=o.height,d=n?r.size.depthOrArrayLayers:1,c=Math.ceil(u/i.width)*i.byteLength,h=c*Math.ceil(l/i.height);for(let e=0;e<d;e++)s.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:e}},o.data,{offset:e*h,bytesPerRow:c,rowsPerImage:Math.ceil(l/i.height)},{width:Math.ceil(u/i.width)*i.width,height:Math.ceil(l/i.height)*i.height,depthOrArrayLayers:1})}}_getBlockData(e){return e===IE||e===DE?{byteLength:8,width:4,height:4}:e===UE||e===VE||e===OE||e===GE?{byteLength:16,width:4,height:4}:e===kE||e===zE?{byteLength:8,width:4,height:4}:e===$E||e===HE||e===WE||e===qE||e===jE||e===XE?{byteLength:16,width:4,height:4}:e===KE||e===YE||e===QE||e===ZE?{byteLength:8,width:4,height:4}:e===JE||e===eR?{byteLength:16,width:4,height:4}:e===tR||e===rR?{byteLength:8,width:4,height:4}:e===sR||e===iR||e===nR||e===aR?{byteLength:16,width:4,height:4}:e===oR||e===uR?{byteLength:16,width:5,height:4}:e===lR||e===dR?{byteLength:16,width:5,height:5}:e===cR||e===hR?{byteLength:16,width:6,height:5}:e===pR||e===gR?{byteLength:16,width:6,height:6}:e===mR||e===fR?{byteLength:16,width:8,height:5}:e===yR||e===bR?{byteLength:16,width:8,height:6}:e===xR||e===TR?{byteLength:16,width:8,height:8}:e===_R||e===vR?{byteLength:16,width:10,height:5}:e===NR||e===SR?{byteLength:16,width:10,height:6}:e===ER||e===RR?{byteLength:16,width:10,height:8}:e===AR||e===wR?{byteLength:16,width:10,height:10}:e===CR||e===MR?{byteLength:16,width:12,height:10}:e===PR||e===BR?{byteLength:16,width:12,height:12}:void 0}_convertAddressMode(e){let t=LR;return e===Sr?t=FR:e===vr&&(t=IR),t}_convertFilterMode(e){let t=DR;return e!==v&&e!==Er&&e!==ze||(t=UR),t}_getBytesPerTexel(e){return e===XS||e===KS||e===YS||e===QS?1:e===ZS||e===JS||e===eE||e===tE||e===rE||e===sE||e===iE?2:e===nE||e===aE||e===oE||e===uE||e===lE||e===dE||e===cE||e===hE||e===pE||e===gE||e===mE||e===fE||e===yE||e===bE||e===xE||e===TE||e===LE||e===PE||e===BE||e===FE?4:e===_E||e===vE||e===NE||e===SE||e===EE||e===RE?8:e===AE||e===wE||e===CE?16:void 0}_getTypedArrayType(e){return e===YS?Uint8Array:e===QS?Int8Array:e===XS?Uint8Array:e===KS?Int8Array:e===sE?Uint8Array:e===iE?Int8Array:e===tE?Uint8Array:e===rE?Int8Array:e===gE?Uint8Array:e===mE?Int8Array:e===cE||e===hE?Uint8Array:e===pE?Int8Array:e===ZS?Uint16Array:e===JS?Int16Array:e===uE?Uint16Array:e===lE?Int16Array:e===SE?Uint16Array:e===EE?Int16Array:e===eE||e===dE||e===RE?Uint16Array:e===nE?Uint32Array:e===aE?Int32Array:e===oE?Float32Array:e===_E?Uint32Array:e===vE?Int32Array:e===NE?Float32Array:e===AE?Uint32Array:e===wE?Int32Array:e===CE?Float32Array:e===fE||e===yE?Uint8Array:e===xE||e===bE||e===TE?Uint32Array:e===LE?Float32Array:e===PE||e===BE?Uint32Array:e===FE?Float32Array:void 0}_getDimension(e){let t;return t=e.is3DTexture||e.isData3DTexture?EA:SA,t}}function zA(e,t=null){const r=e.format,s=e.type,i=e.colorSpace,n=c.getTransfer(i);let a;if(!0===e.isCompressedTexture||!0===e.isCompressedArrayTexture)switch(r){case qt:case jt:a=n===h?DE:IE;break;case Xt:a=n===h?VE:UE;break;case Kt:a=n===h?GE:OE;break;case br:a=kE;break;case xr:a=zE;break;case Tr:a=$E;break;case _r:a=HE;break;case yr:a=n===h?XE:jE;break;case tr:case er:a=n===h?YE:KE;break;case rr:a=n===h?eR:JE;break;case sr:a=n===h?aR:nR;break;case ir:a=n===h?uR:oR;break;case nr:a=n===h?dR:lR;break;case ar:a=n===h?hR:cR;break;case or:a=n===h?gR:pR;break;case ur:a=n===h?fR:mR;break;case lr:a=n===h?bR:yR;break;case dr:a=n===h?TR:xR;break;case cr:a=n===h?vR:_R;break;case hr:a=n===h?SR:NR;break;case pr:a=n===h?RR:ER;break;case gr:a=n===h?wR:AR;break;case mr:a=n===h?MR:CR;break;case fr:a=n===h?BR:PR;break;case de:a=n===h?hE:cE;break;default:console.error("WebGPURenderer: Unsupported texture format.",r)}else switch(r){case de:switch(s){case ut:a=pE;break;case ot:a=EE;break;case lt:a=SE;break;case T:a=AE;break;case _:a=wE;break;case Ce:a=n===h?hE:cE;break;case ce:a=RE;break;case I:a=CE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",s)}break;case ht:switch(s){case $t:a=bE;break;case Ht:a=TE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",s)}break;case at:switch(s){case ut:a=KS;break;case ot:a=JS;break;case lt:a=ZS;break;case T:a=nE;break;case _:a=aE;break;case Ce:a=XS;break;case ce:a=eE;break;case I:a=oE;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",s)}break;case Ve:switch(s){case ut:a=rE;break;case ot:a=lE;break;case lt:a=uE;break;case T:a=_E;break;case _:a=vE;break;case Ce:a=tE;break;case ce:a=dE;break;case I:a=NE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",s)}break;case Ae:switch(s){case lt:a=ME;break;case T:a=PE;break;case I:a=LE;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",s)}break;case Re:switch(s){case we:a=BE;break;case I:t&&!1===t.features.has(LA.Depth32FloatStencil8)&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),a=FE;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",s)}break;case nt:switch(s){case _:a=aE;break;case T:a=nE;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",s)}break;case dt:switch(s){case _:a=vE;break;case T:a=_E;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",s)}break;case pt:switch(s){case _:a=wE;break;case T:a=AE;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",s)}break;default:console.error("WebGPURenderer: Unsupported texture format.",r)}return a}const $A=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,HA=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/gi,WA={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"};class qA extends Jv{constructor(e){const{type:t,inputs:r,name:s,inputsCode:i,blockCode:n,outputType:a}=(e=>{const t=(e=e.trim()).match($A);if(null!==t&&4===t.length){const r=t[2],s=[];let i=null;for(;null!==(i=HA.exec(r));)s.push({name:i[1],type:i[2]});const n=[];for(let e=0;e<s.length;e++){const{name:t,type:r}=s[e];let i=r;i.startsWith("ptr")?i="pointer":(i.startsWith("texture")&&(i=r.split("<")[0]),i=WA[i]),n.push(new Ov(i,t))}const a=e.substring(t[0].length),o=t[3]||"void",u=void 0!==t[1]?t[1]:"";return{type:WA[o]||o,inputs:n,name:u,inputsCode:r,blockCode:a,outputType:o}}throw new Error("FunctionNode: Function is not a WGSL code.")})(e);super(t,r,s),this.inputsCode=i,this.blockCode=n,this.outputType=a}getCode(e=this.name){const t="void"!==this.outputType?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class jA extends Zv{parseFunction(e){return new qA(e)}}const XA="undefined"!=typeof self?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},KA={[$s.READ_ONLY]:"read",[$s.WRITE_ONLY]:"write",[$s.READ_WRITE]:"read_write"},YA={[Sr]:"repeat",[Nr]:"clamp",[vr]:"mirror"},QA={vertex:XA?XA.VERTEX:1,fragment:XA?XA.FRAGMENT:2,compute:XA?XA.COMPUTE:4},ZA={instance:!0,swizzleAssign:!1,storageBuffer:!0},JA={"^^":"tsl_xor"},ew={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},tw={},rw={tsl_xor:new sx("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new sx("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new sx("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new sx("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new sx("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new sx("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new sx("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new sx("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new sx("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new sx("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new sx("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new sx("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new sx("\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {\n\n\tlet res = vec2f( iRes );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n\tlet rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n\tlet rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n\tlet rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n")},sw={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};let iw="";!0!==("undefined"!=typeof navigator&&/Firefox|Deno/g.test(navigator.userAgent))&&(iw+="diagnostic( off, derivative_uniformity );\n");class nw extends Uv{constructor(e,t){super(e,t,new jA),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}_generateTextureSample(e,t,r,s,i,n=this.shaderStage){return"fragment"===n?s?i?`textureSample( ${t}, ${t}_sampler, ${r}, ${s}, ${i} )`:`textureSample( ${t}, ${t}_sampler, ${r}, ${s} )`:i?`textureSample( ${t}, ${t}_sampler, ${r}, ${i} )`:`textureSample( ${t}, ${t}_sampler, ${r} )`:this.generateTextureSampleLevel(e,t,r,"0",s)}generateTextureSampleLevel(e,t,r,s,i,n){return!1===this.isUnfilterable(e)?n?`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,n,s):this.generateTextureLod(e,t,r,i,n,s)}generateWrapFunction(e){const t=`tsl_coord_${YA[e.wrapS]}S_${YA[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let r=tw[t];if(void 0===r){const s=[],i=e.isData3DTexture?"vec3f":"vec2f";let n=`fn ${t}( coord : ${i} ) -> ${i} {\n\n\treturn ${i}(\n`;const a=(e,t)=>{e===Sr?(s.push(rw.repeatWrapping_float),n+=`\t\ttsl_repeatWrapping_float( coord.${t} )`):e===Nr?(s.push(rw.clampWrapping_float),n+=`\t\ttsl_clampWrapping_float( coord.${t} )`):e===vr?(s.push(rw.mirrorWrapping_float),n+=`\t\ttsl_mirrorWrapping_float( coord.${t} )`):(n+=`\t\tcoord.${t}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${e}" for vertex shader.`))};a(e.wrapS,"x"),n+=",\n",a(e.wrapT,"y"),e.isData3DTexture&&(n+=",\n",a(e.wrapR,"z")),n+="\n\t);\n\n}\n",tw[t]=r=new sx(n,s)}return r.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,r){const s=this.getDataFromNode(e,this.shaderStage,this.globalCache);void 0===s.dimensionsSnippet&&(s.dimensionsSnippet={});let i=s.dimensionsSnippet[r];if(void 0===s.dimensionsSnippet[r]){let n,a;const{primarySamples:o}=this.renderer.backend.utils.getTextureSampleData(e),u=o>1;a=e.isData3DTexture?"vec3<u32>":"vec2<u32>",n=u||e.isStorageTexture?t:`${t}${r?`, u32( ${r} )`:""}`,i=new du(new Xu(`textureDimensions( ${n} )`,a)),s.dimensionsSnippet[r]=i,(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)&&(s.arrayLayerCount=new du(new Xu(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(s.cubeFaceCount=new du(new Xu("6u","u32")))}return i.build(this)}generateFilteredTexture(e,t,r,s,i="0u"){this._include("biquadraticTexture");const n=this.generateWrapFunction(e),a=this.generateTextureDimension(e,t,i);return s&&(r=`${r} + vec2<f32>(${s}) / ${a}`),`tsl_biquadraticTexture( ${t}, ${n}( ${r} ), ${a}, u32( ${i} ) )`}generateTextureLod(e,t,r,s,i,n="0u"){const a=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,n),u=e.isData3DTexture?"vec3":"vec2";i&&(r=`${r} + ${u}<f32>(${i}) / ${u}<f32>( ${o} )`);const l=`${u}<u32>( ${a}( ${r} ) * ${u}<f32>( ${o} ) )`;return this.generateTextureLoad(e,t,l,s,null,n)}generateTextureLoad(e,t,r,s,i,n="0u"){let a;return i&&(r=`${r} + ${i}`),s?a=`textureLoad( ${t}, ${r}, ${s}, u32( ${n} ) )`:(a=`textureLoad( ${t}, ${r}, u32( ${n} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,t,r,s,i){let n;return n=s?`textureStore( ${t}, ${r}, ${s}, ${i} )`:`textureStore( ${t}, ${r}, ${i} )`,n}isSampleCompare(e){return!0===e.isDepthTexture&&null!==e.compareFunction}isUnfilterable(e){return"float"!==this.getComponentTypeFromTexture(e)||!this.isAvailable("float32Filterable")&&!0===e.isDataTexture&&e.type===I||!1===this.isSampleCompare(e)&&e.minFilter===v&&e.magFilter===v||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,r,s,i,n=this.shaderStage){let a=null;return a=this.isUnfilterable(e)?this.generateTextureLod(e,t,r,s,i,"0",n):this._generateTextureSample(e,t,r,s,i,n),a}generateTextureGrad(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return n?`textureSampleGrad( ${t}, ${t}_sampler, ${r},  ${s[0]}, ${s[1]}, ${n} )`:`textureSampleGrad( ${t}, ${t}_sampler, ${r},  ${s[0]}, ${s[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${a} shader.`)}generateTextureCompare(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return!0===e.isDepthTexture&&!0===e.isArrayTexture?n?`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${i}, ${s}, ${n} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${i}, ${s} )`:n?`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${r}, ${s} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}generateTextureLevel(e,t,r,s,i,n){return!1===this.isUnfilterable(e)?n?`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${r}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,r,n,s):this.generateTextureLod(e,t,r,i,n,s)}generateTextureBias(e,t,r,s,i,n,a=this.shaderStage){if("fragment"===a)return n?`textureSampleBias( ${t}, ${t}_sampler, ${r}, ${s}, ${n} )`:`textureSampleBias( ${t}, ${t}_sampler, ${r}, ${s} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${a} shader.`)}getPropertyName(e,t=this.shaderStage){if(!0===e.isNodeVarying&&!0===e.needsInterpolation){if("vertex"===t)return`varyings.${e.name}`}else if(!0===e.isNodeUniform){const t=e.name,r=e.type;return"texture"===r||"cubeTexture"===r||"storageTexture"===r||"texture3D"===r?t:"buffer"===r||"storageBuffer"===r||"indirectStorageBuffer"===r?this.isCustomStruct(e)?t:t+".value":e.groupNode.name+"."+t}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=JA[e];return void 0!==t?(this._include(t),t):null}getNodeAccess(e,t){return"compute"!==t?!0===e.isAtomic?(console.warn("WebGPURenderer: Atomic operations are only supported in compute shaders."),$s.READ_WRITE):$s.READ_ONLY:e.access}getStorageAccess(e,t){return KA[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,r,s=null){const i=super.getUniformFromNode(e,t,r,s),n=this.getDataFromNode(e,r,this.globalCache);if(void 0===n.uniformGPU){let a;const o=e.groupNode,u=o.name,l=this.getBindGroupArray(u,r);if("texture"===t||"cubeTexture"===t||"storageTexture"===t||"texture3D"===t){let s=null;const n=this.getNodeAccess(e,r);if("texture"===t||"storageTexture"===t?s=!0===e.value.is3DTexture?new KN(i.name,i.node,o,n):new jN(i.name,i.node,o,n):"cubeTexture"===t?s=new XN(i.name,i.node,o,n):"texture3D"===t&&(s=new KN(i.name,i.node,o,n)),s.store=!0===e.isStorageTextureNode,s.setVisibility(QA[r]),!1===this.isUnfilterable(e.value)&&!1===s.store){const e=new FA(`${i.name}_sampler`,i.node,o);e.setVisibility(QA[r]),l.push(e,s),a=[e,s]}else l.push(s),a=[s]}else if("buffer"===t||"storageBuffer"===t||"indirectStorageBuffer"===t){const n=new("buffer"===t?GN:UA)(e,o);n.setVisibility(QA[r]),l.push(n),a=n,i.name=s||"NodeBuffer_"+i.id}else{const e=this.uniformGroups[r]||(this.uniformGroups[r]={});let s=e[u];void 0===s&&(s=new $N(u,o),s.setVisibility(QA[r]),e[u]=s,l.push(s)),a=this.getNodeUniform(i,t),s.addUniform(a)}n.uniformGPU=a}return i}getBuiltin(e,t,r,s=this.shaderStage){const i=this.builtins[s]||(this.builtins[s]=new Map);return!1===i.has(e)&&i.set(e,{name:e,property:t,type:r}),t}hasBuiltin(e,t=this.shaderStage){return void 0!==this.builtins[t]&&this.builtins[t].has(e)}getVertexIndex(){return"vertex"===this.shaderStage?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,r=this.flowShaderNode(e),s=[];for(const e of t.inputs)s.push(e.name+" : "+this.getType(e.type));let i=`fn ${t.name}( ${s.join(", ")} ) -> ${this.getType(t.type)} {\n${r.vars}\n${r.code}\n`;return r.result&&(i+=`\treturn ${r.result};\n`),i+="\n}\n",i}getInstanceIndex(){return"vertex"===this.shaderStage?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],r=this.directives[e];if(void 0!==r)for(const e of r)t.push(`enable ${e};`);return t.join("\n")}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],r=this.builtins[e];if(void 0!==r)for(const{name:e,property:s,type:i}of r.values())t.push(`@builtin( ${e} ) ${s} : ${i}`);return t.join(",\n\t")}getScopedArray(e,t,r,s){return!1===this.scopedArrays.has(e)&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:r,bufferCount:s}),e}getScopedArrays(e){if("compute"!==e)return;const t=[];for(const{name:e,scope:r,bufferType:s,bufferCount:i}of this.scopedArrays.values()){const n=this.getType(s);t.push(`var<${r}> ${e}: array< ${n}, ${i} >;`)}return t.join("\n")}getAttributes(e){const t=[];if("compute"===e&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),"vertex"===e||"compute"===e){const e=this.getBuiltins("attribute");e&&t.push(e);const r=this.getAttributesArray();for(let e=0,s=r.length;e<s;e++){const s=r[e],i=s.name,n=this.getType(s.type);t.push(`@location( ${e} ) ${i} : ${n}`)}}return t.join(",\n\t")}getStructMembers(e){const t=[];for(const r of e.members){const s=e.output?"@location( "+r.index+" ) ":"";let i=this.getType(r.type);r.atomic&&(i="atomic< "+i+" >"),t.push(`\t${s+r.name} : ${i}`)}return e.output&&t.push(`\t${this.getBuiltins("output")}`),t.join(",\n")}getStructs(e){let t="";const r=this.structs[e];if(r.length>0){const e=[];for(const t of r){let r=`struct ${t.name} {\n`;r+=this.getStructMembers(t),r+="\n};",e.push(r)}t="\n"+e.join("\n\n")+"\n"}return t}getVar(e,t,r=null){let s=`var ${t} : `;return s+=null!==r?this.generateArrayDeclaration(e,r):this.getType(e),s}getVars(e){const t=[],r=this.vars[e];if(void 0!==r)for(const e of r)t.push(`\t${this.getVar(e.type,e.name,e.count)};`);return`\n${t.join("\n")}\n`}getVaryings(e){const t=[];if("vertex"===e&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),"vertex"===e||"fragment"===e){const r=this.varyings,s=this.vars[e];for(let i=0;i<r.length;i++){const n=r[i];if(n.needsInterpolation){let e=`@location( ${i} )`;if(n.interpolationType){const t=null!==n.interpolationSampling?`, ${n.interpolationSampling} )`:" )";e+=` @interpolate( ${n.interpolationType}${t}`}else/^(int|uint|ivec|uvec)/.test(n.type)&&(e+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${e} ${n.name} : ${this.getType(n.type)}`)}else"vertex"===e&&!1===s.includes(n)&&s.push(n)}}const r=this.getBuiltins(e);r&&t.push(r);const s=t.join(",\n\t");return"vertex"===e?this._getWGSLStruct("VaryingsStruct","\t"+s):s}isCustomStruct(e){const t=e.value,r=e.node,s=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&null!==r.structTypeNode,i=r.value&&r.value.array&&"number"==typeof r.value.itemSize&&r.value.array.length>r.value.itemSize;return s&&!i}getUniforms(e){const t=this.uniforms[e],r=[],s=[],i=[],n={};for(const i of t){const t=i.groupNode.name,a=this.bindingsIndexes[t];if("texture"===i.type||"cubeTexture"===i.type||"storageTexture"===i.type||"texture3D"===i.type){const t=i.node.value;let s;!1===this.isUnfilterable(t)&&!0!==i.node.isStorageTextureNode&&(this.isSampleCompare(t)?r.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var ${i.name}_sampler : sampler_comparison;`):r.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var ${i.name}_sampler : sampler;`));let n="";const{primarySamples:o}=this.renderer.backend.utils.getTextureSampleData(t);if(o>1&&(n="_multisampled"),!0===t.isCubeTexture)s="texture_cube<f32>";else if(!0===t.isDepthTexture)s=this.renderer.backend.compatibilityMode&&null===t.compareFunction?`texture${n}_2d<f32>`:`texture_depth${n}_2d${!0===t.isArrayTexture?"_array":""}`;else if(!0===i.node.isStorageTextureNode){const r=zA(t),n=this.getStorageAccess(i.node,e),a=i.node.value.is3DTexture,o=i.node.value.isArrayTexture;s=`texture_storage_${a?"3d":"2d"+(o?"_array":"")}<${r}, ${n}>`}else if(!0===t.isArrayTexture||!0===t.isDataArrayTexture||!0===t.isCompressedArrayTexture)s="texture_2d_array<f32>";else if(!0===t.is3DTexture||!0===t.isData3DTexture)s="texture_3d<f32>";else{s=`texture${n}_2d<${this.getComponentTypeFromTexture(t).charAt(0)}32>`}r.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var ${i.name} : ${s};`)}else if("buffer"===i.type||"storageBuffer"===i.type||"indirectStorageBuffer"===i.type){const t=i.node,r=this.getType(t.getNodeType(this)),n=t.bufferCount,o=n>0&&"buffer"===i.type?", "+n:"",u=t.isStorageBufferNode?`storage, ${this.getStorageAccess(t,e)}`:"uniform";if(this.isCustomStruct(i))s.push(`@binding( ${a.binding++} ) @group( ${a.group} ) var<${u}> ${i.name} : ${r};`);else{const e=`\tvalue : array< ${t.isAtomic?`atomic<${r}>`:`${r}`}${o} >`;s.push(this._getWGSLStructBinding(i.name,e,u,a.binding++,a.group))}}else{const e=this.getType(this.getVectorType(i.type)),t=i.groupNode.name;(n[t]||(n[t]={index:a.binding++,id:a.group,snippets:[]})).snippets.push(`\t${i.name} : ${e}`)}}for(const e in n){const t=n[e];i.push(this._getWGSLStructBinding(e,t.snippets.join(",\n"),"uniform",t.index,t.id))}let a=r.join("\n");return a+=s.join("\n"),a+=i.join("\n"),a}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const r=e[t];r.uniforms=this.getUniforms(t),r.attributes=this.getAttributes(t),r.varyings=this.getVaryings(t),r.structs=this.getStructs(t),r.vars=this.getVars(t),r.codes=this.getCodes(t),r.directives=this.getDirectives(t),r.scopedArrays=this.getScopedArrays(t);let s="// code\n\n";s+=this.flowCode[t];const i=this.flowNodes[t],n=i[i.length-1],a=n.outputNode,o=void 0!==a&&!0===a.isOutputStructNode;for(const e of i){const i=this.getFlowData(e),u=e.name;if(u&&(s.length>0&&(s+="\n"),s+=`\t// flow -> ${u}\n`),s+=`${i.code}\n\t`,e===n&&"compute"!==t)if(s+="// result\n\n\t","vertex"===t)s+=`varyings.Vertex = ${i.result};`;else if("fragment"===t)if(o)r.returnType=a.getNodeType(this),r.structs+="var<private> output : "+r.returnType+";",s+=`return ${i.result};`;else{let e="\t@location(0) color: vec4<f32>";const t=this.getBuiltins("output");t&&(e+=",\n\t"+t),r.returnType="OutputStruct",r.structs+=this._getWGSLStruct("OutputStruct",e),r.structs+="\nvar<private> output : OutputStruct;",s+=`output.color = ${i.result};\n\n\treturn output;`}}r.flow=s}if(this.shaderStage=null,null!==this.material)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{const t=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,t)}}getMethod(e,t=null){let r;return null!==t&&(r=this._getWGSLMethod(e+"_"+t)),void 0===r&&(r=this._getWGSLMethod(e)),r||e}getBitcastMethod(e){return`bitcast<${this.getType(e)}>`}getTernary(e,t,r){return`select( ${r}, ${t}, ${e} )`}getType(e){return ew[e]||e}isAvailable(e){let t=ZA[e];return void 0===t&&("float32Filterable"===e?t=this.renderer.hasFeature("float32-filterable"):"clipDistance"===e&&(t=this.renderer.hasFeature("clip-distances")),ZA[e]=t),t}_getWGSLMethod(e){return void 0!==rw[e]&&this._include(e),sw[e]}_include(e){const t=rw[e];return t.build(this),null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}\n// directives\n${e.directives}\n\n// structs\n${e.structs}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\nvar<private> varyings : VaryingsStruct;\n\n// codes\n${e.codes}\n\n@vertex\nfn main( ${e.attributes} ) -> VaryingsStruct {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n\treturn varyings;\n\n}\n`}_getWGSLFragmentCode(e){return`${this.getSignature()}\n// global\n${iw}\n\n// structs\n${e.structs}\n\n// uniforms\n${e.uniforms}\n\n// codes\n${e.codes}\n\n@fragment\nfn main( ${e.varyings} ) -> ${e.returnType} {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}_getWGSLComputeCode(e,t){const[r,s,i]=t;return`${this.getSignature()}\n// directives\n${e.directives}\n\n// system\nvar<private> instanceIndex : u32;\n\n// locals\n${e.scopedArrays}\n\n// structs\n${e.structs}\n\n// uniforms\n${e.uniforms}\n\n// codes\n${e.codes}\n\n@compute @workgroup_size( ${r}, ${s}, ${i} )\nfn main( ${e.attributes} ) {\n\n\t// system\n\tinstanceIndex = globalId.x\n\t\t+ globalId.y * ( ${r} * numWorkgroups.x )\n\t\t+ globalId.z * ( ${r} * numWorkgroups.x ) * ( ${s} * numWorkgroups.y );\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}_getWGSLStruct(e,t){return`\nstruct ${e} {\n${t}\n};`}_getWGSLStructBinding(e,t,r,s=0,i=0){const n=e+"Struct";return`${this._getWGSLStruct(n,t)}\n@binding( ${s} ) @group( ${i} )\nvar<${r}> ${e} : ${n};`}}class aw{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return null!==e.depthTexture?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=BE:e.depth&&(t=PE),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const e=this.backend.renderer,r=e.getRenderTarget();t=r?r.samples:e.samples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const r=t>1&&null!==e.renderTarget&&!0!==e.isDepthTexture&&!0!==e.isFramebufferTexture;return{samples:t,primarySamples:r?1:t,isMSAA:r}}getCurrentColorFormat(e){let t;return t=null!==e.textures?this.getTextureFormatGPU(e.textures[0]):this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return null!==e.textures?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){return e.isPoints?RS:e.isLineSegments||e.isMesh&&!0===t.wireframe?AS:e.isLine?wS:e.isMesh?CS:void 0}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return null!==e.textures?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(void 0===e)return navigator.gpu.getPreferredCanvasFormat();if(e===Ce)return fE;if(e===ce)return RE;throw new Error("Unsupported outputType")}}const ow=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);"undefined"!=typeof Float16Array&&ow.set(Float16Array,["float16"]);const uw=new Map([[$e,["float16"]]]),lw=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class dw{constructor(e){this.backend=e}createAttribute(e,t){const r=this._getBufferAttribute(e),s=this.backend,i=s.get(r);let n=i.buffer;if(void 0===n){const a=s.device;let o=r.array;if(!1===e.normalized)if(o.constructor===Int16Array||o.constructor===Int8Array)o=new Int32Array(o);else if((o.constructor===Uint16Array||o.constructor===Uint8Array)&&(o=new Uint32Array(o),t&GPUBufferUsage.INDEX))for(let e=0;e<o.length;e++)65535===o[e]&&(o[e]=4294967295);if(r.array=o,(r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute)&&3===r.itemSize){o=new o.constructor(4*r.count);for(let e=0;e<r.count;e++)o.set(r.array.subarray(3*e,3*e+3),4*e);r.itemSize=4,r.array=o,i._force3to4BytesAlignment=!0}const u=o.byteLength,l=u+(4-u%4)%4;n=a.createBuffer({label:r.name,size:l,usage:t,mappedAtCreation:!0}),new o.constructor(n.getMappedRange()).set(o),n.unmap(),i.buffer=n}}updateAttribute(e){const t=this._getBufferAttribute(e),r=this.backend,s=r.device,i=r.get(t),n=r.get(t).buffer;let a=t.array;if(!0===i._force3to4BytesAlignment){a=new a.constructor(4*t.count);for(let e=0;e<t.count;e++)a.set(t.array.subarray(3*e,3*e+3),4*e);t.array=a}const o=this._isTypedArray(a),u=t.updateRanges;if(0===u.length)s.queue.writeBuffer(n,0,a,0);else{const e=o?1:a.BYTES_PER_ELEMENT;for(let t=0,r=u.length;t<r;t++){const r=u[t];let l,d;if(!0===i._force3to4BytesAlignment){l=4*Math.floor(r.start/3)*e,d=4*Math.ceil(r.count/3)*e}else l=r.start*e,d=r.count*e;const c=l*(o?a.BYTES_PER_ELEMENT:1);s.queue.writeBuffer(n,c,a,l,d)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),r=new Map;for(let e=0;e<t.length;e++){const s=t[e],i=s.array.BYTES_PER_ELEMENT,n=this._getBufferAttribute(s);let a=r.get(n);if(void 0===a){let e,t;!0===s.isInterleavedBufferAttribute?(e=s.data.stride*i,t=s.data.isInstancedInterleavedBuffer?BA:PA):(e=s.itemSize*i,t=s.isInstancedBufferAttribute?BA:PA),!1!==s.normalized||s.array.constructor!==Int16Array&&s.array.constructor!==Uint16Array||(e=4),a={arrayStride:e,attributes:[],stepMode:t},r.set(n,a)}const o=this._getVertexFormat(s),u=!0===s.isInterleavedBufferAttribute?s.offset*i:0;a.attributes.push({shaderLocation:e,offset:u,format:o})}return Array.from(r.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,r=t.device,s=t.get(this._getBufferAttribute(e)).buffer,i=s.size,n=r.createBuffer({label:`${e.name}_readback`,size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),a=r.createCommandEncoder({label:`readback_encoder_${e.name}`});a.copyBufferToBuffer(s,0,n,0,i);const o=a.finish();r.queue.submit([o]),await n.mapAsync(GPUMapMode.READ);const u=n.getMappedRange(),l=new e.array.constructor(u.slice(0));return n.unmap(),l.buffer}_getVertexFormat(e){const{itemSize:t,normalized:r}=e,s=e.array.constructor,i=e.constructor;let n;if(1===t)n=lw.get(s);else{const e=(uw.get(i)||ow.get(s))[r?1:0];if(e){const r=s.BYTES_PER_ELEMENT*t,i=4*Math.floor((r+3)/4)/s.BYTES_PER_ELEMENT;if(i%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");n=`${e}x${i}`}}return n||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),n}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class cw{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend,r=t.device,s=[];let i=0;for(const r of e.bindings){const e={binding:i++,visibility:r.visibility};if(r.isUniformBuffer||r.isStorageBuffer){const t={};r.isStorageBuffer&&(4&r.visibility&&(r.access===$s.READ_WRITE||r.access===$s.WRITE_ONLY)?t.type=hA:t.type=pA),e.buffer=t}else if(r.isSampledTexture&&r.store){const t={};t.format=this.backend.get(r.texture).texture.format;const s=r.access;t.access=s===$s.READ_WRITE?fA:s===$s.WRITE_ONLY?gA:mA,r.texture.isArrayTexture?t.viewDimension=AA:r.texture.is3DTexture&&(t.viewDimension=CA),e.storageTexture=t}else if(r.isSampledTexture){const s={},{primarySamples:i}=t.utils.getTextureSampleData(r.texture);if(i>1&&(s.multisampled=!0,r.texture.isDepthTexture||(s.sampleType=TA)),r.texture.isDepthTexture)t.compatibilityMode&&null===r.texture.compareFunction?s.sampleType=TA:s.sampleType=_A;else if(r.texture.isDataTexture||r.texture.isDataArrayTexture||r.texture.isData3DTexture){const e=r.texture.type;e===_?s.sampleType=vA:e===T?s.sampleType=NA:e===I&&(this.backend.hasFeature("float32-filterable")?s.sampleType=xA:s.sampleType=TA)}r.isSampledCubeTexture?s.viewDimension=wA:r.texture.isArrayTexture||r.texture.isDataArrayTexture||r.texture.isCompressedArrayTexture?s.viewDimension=AA:r.isSampledTexture3D&&(s.viewDimension=CA),e.texture=s}else if(r.isSampler){const s={};r.texture.isDepthTexture&&(null!==r.texture.compareFunction?s.type=bA:t.compatibilityMode&&(s.type=yA)),e.sampler=s}else console.error(`WebGPUBindingUtils: Unsupported binding "${r}".`);s.push(e)}return r.createBindGroupLayout({entries:s})}createBindings(e,t,r,s=0){const{backend:i,bindGroupLayoutCache:n}=this,a=i.get(e);let o,u=n.get(e.bindingsReference);void 0===u&&(u=this.createBindingsLayout(e),n.set(e.bindingsReference,u)),r>0&&(void 0===a.groups&&(a.groups=[],a.versions=[]),a.versions[r]===s&&(o=a.groups[r])),void 0===o&&(o=this.createBindGroup(e,u),r>0&&(a.groups[r]=o,a.versions[r]=s)),a.group=o,a.layout=u}updateBinding(e){const t=this.backend,r=t.device,s=e.buffer,i=t.get(e).buffer;r.queue.writeBuffer(i,0,s,0)}createBindGroupIndex(e,t){const r=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,i=e[0],n=r.createBuffer({label:"bindingCameraIndex_"+i,size:16,usage:s});r.queue.writeBuffer(n,0,e,0);const a=[{binding:0,resource:{buffer:n}}];return r.createBindGroup({label:"bindGroupCameraIndex_"+i,layout:t,entries:a})}createBindGroup(e,t){const r=this.backend,s=r.device;let i=0;const n=[];for(const t of e.bindings){if(t.isUniformBuffer){const e=r.get(t);if(void 0===e.buffer){const r=t.byteLength,i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,n=s.createBuffer({label:"bindingBuffer_"+t.name,size:r,usage:i});e.buffer=n}n.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isStorageBuffer){const e=r.get(t);if(void 0===e.buffer){const s=t.attribute;e.buffer=r.get(s).buffer}n.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isSampledTexture){const e=r.get(t.texture);let a;if(void 0!==e.externalTexture)a=s.importExternalTexture({source:e.externalTexture});else{const r=t.store?1:e.texture.mipLevelCount;let s=`view-${e.texture.width}-${e.texture.height}`;if(e.texture.depthOrArrayLayers>1&&(s+=`-${e.texture.depthOrArrayLayers}`),s+=`-${r}`,a=e[s],void 0===a){const i=MA;let n;n=t.isSampledCubeTexture?wA:t.isSampledTexture3D?CA:t.texture.isArrayTexture||t.texture.isDataArrayTexture||t.texture.isCompressedArrayTexture?AA:RA,a=e[s]=e.texture.createView({aspect:i,dimension:n,mipLevelCount:r})}}n.push({binding:i,resource:a})}else if(t.isSampler){const e=r.get(t.texture);n.push({binding:i,resource:e.sampler})}i++}return s.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:n})}}class hw{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:r,material:s,geometry:i,pipeline:n}=e,{vertexProgram:a,fragmentProgram:o}=n,u=this.backend,l=u.device,d=u.utils,c=u.get(n),h=[];for(const t of e.getBindings()){const e=u.get(t);h.push(e.layout)}const p=u.attributeUtils.createShaderVertexBuffers(e);let g;s.blending===$||s.blending===G&&!1===s.transparent||(g=this._getBlending(s));let m={};!0===s.stencilWrite&&(m={compare:this._getStencilCompare(s),failOp:this._getStencilOperation(s.stencilFail),depthFailOp:this._getStencilOperation(s.stencilZFail),passOp:this._getStencilOperation(s.stencilZPass)});const f=this._getColorWriteMask(s),y=[];if(null!==e.context.textures){const t=e.context.textures;for(let e=0;e<t.length;e++){const r=d.getTextureFormatGPU(t[e]);y.push({format:r,blend:g,writeMask:f})}}else{const t=d.getCurrentColorFormat(e.context);y.push({format:t,blend:g,writeMask:f})}const b=u.get(a).module,x=u.get(o).module,T=this._getPrimitiveState(r,i,s),_=this._getDepthCompare(s),v=d.getCurrentDepthStencilFormat(e.context),N=this._getSampleCount(e.context),S={label:`renderPipeline_${s.name||s.type}_${s.id}`,vertex:Object.assign({},b,{buffers:p}),fragment:Object.assign({},x,{targets:y}),primitive:T,multisample:{count:N,alphaToCoverageEnabled:s.alphaToCoverage&&N>1},layout:l.createPipelineLayout({bindGroupLayouts:h})},E={},R=e.context.depth,A=e.context.stencil;if(!0!==R&&!0!==A||(!0===R&&(E.format=v,E.depthWriteEnabled=s.depthWrite,E.depthCompare=_),!0===A&&(E.stencilFront=m,E.stencilBack={},E.stencilReadMask=s.stencilFuncMask,E.stencilWriteMask=s.stencilWriteMask),!0===s.polygonOffset&&(E.depthBias=s.polygonOffsetUnits,E.depthBiasSlopeScale=s.polygonOffsetFactor,E.depthBiasClamp=0),S.depthStencil=E),null===t)c.pipeline=l.createRenderPipeline(S);else{const e=new Promise(e=>{l.createRenderPipelineAsync(S).then(t=>{c.pipeline=t,e()})});t.push(e)}}createBundleEncoder(e,t="renderBundleEncoder"){const r=this.backend,{utils:s,device:i}=r,n=s.getCurrentDepthStencilFormat(e),a={label:t,colorFormats:[s.getCurrentColorFormat(e)],depthStencilFormat:n,sampleCount:this._getSampleCount(e)};return i.createRenderBundleEncoder(a)}createComputePipeline(e,t){const r=this.backend,s=r.device,i=r.get(e.computeProgram).module,n=r.get(e),a=[];for(const e of t){const t=r.get(e);a.push(t.layout)}n.pipeline=s.createComputePipeline({compute:i,layout:s.createPipelineLayout({bindGroupLayouts:a})})}_getBlending(e){let t,r;const s=e.blending,i=e.blendSrc,n=e.blendDst,a=e.blendEquation;if(s===Xe){const s=null!==e.blendSrcAlpha?e.blendSrcAlpha:i,o=null!==e.blendDstAlpha?e.blendDstAlpha:n,u=null!==e.blendEquationAlpha?e.blendEquationAlpha:a;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(n),operation:this._getBlendOperation(a)},r={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(u)}}else{const i=(e,s,i,n)=>{t={srcFactor:e,dstFactor:s,operation:QR},r={srcFactor:i,dstFactor:n,operation:QR}};if(e.premultipliedAlpha)switch(s){case G:i(OR,$R,OR,$R);break;case Bt:i(OR,OR,OR,OR);break;case Pt:i(VR,kR,VR,OR);break;case Mt:i(HR,$R,VR,OR)}else switch(s){case G:i(zR,$R,OR,$R);break;case Bt:i(zR,OR,OR,OR);break;case Pt:console.error("THREE.WebGPURenderer: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Mt:console.error("THREE.WebGPURenderer: MultiplyBlending requires material.premultipliedAlpha = true")}}if(void 0!==t&&void 0!==r)return{color:t,alpha:r};console.error("THREE.WebGPURenderer: Invalid blending: ",s)}_getBlendFactor(e){let t;switch(e){case Ye:t=VR;break;case Rt:t=OR;break;case Et:t=GR;break;case Tt:t=kR;break;case St:t=zR;break;case xt:t=$R;break;case vt:t=HR;break;case bt:t=WR;break;case _t:t=qR;break;case yt:t=jR;break;case Nt:t=XR;break;case 211:t=KR;break;case 212:t=YR;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const r=e.stencilFunc;switch(r){case $r:t=PS;break;case zr:t=VS;break;case kr:t=BS;break;case Gr:t=FS;break;case Or:t=LS;break;case Vr:t=US;break;case Ur:t=IS;break;case Dr:t=DS;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",r)}return t}_getStencilOperation(e){let t;switch(e){case Qr:t=iA;break;case Yr:t=nA;break;case Kr:t=aA;break;case Xr:t=oA;break;case jr:t=uA;break;case qr:t=lA;break;case Wr:t=dA;break;case Hr:t=cA;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case Ke:t=QR;break;case ft:t=ZR;break;case mt:t=JR;break;case Jr:t=eA;break;case Zr:t=tA;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,r){const s={},i=this.backend.utils;s.topology=i.getPrimitiveTopology(e,r),null!==t.index&&!0===e.isLine&&!0!==e.isLineSegments&&(s.stripIndexFormat=t.index.array instanceof Uint16Array?qS:jS);let n=r.side===S;return e.isMesh&&e.matrixWorld.determinant()<0&&(n=!n),s.frontFace=!0===n?$S:zS,s.cullMode=r.side===E?HS:WS,s}_getColorWriteMask(e){return!0===e.colorWrite?sA:rA}_getDepthCompare(e){let t;if(!1===e.depthTest)t=VS;else{const r=e.depthFunc;switch(r){case Gt:t=PS;break;case Ot:t=VS;break;case Vt:t=BS;break;case Ut:t=FS;break;case Dt:t=LS;break;case It:t=US;break;case Ft:t=IS;break;case Lt:t=DS;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",r)}}return t}}class pw extends NS{constructor(e,t,r=2048){super(r),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const s=8*this.maxQueries;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Be(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||0===this.currentQueryIndex||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if("unmapped"!==this.resultBuffer.mapState)return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,r=8*t;this.currentQueryIndex=0,this.queryOffsets.clear();const s=this.device.createCommandEncoder();s.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),s.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,r);const i=s.finish();if(this.device.queue.submit([i]),"unmapped"!==this.resultBuffer.mapState)return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,r),this.isDisposed)return"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),this.lastValue;const n=new BigUint64Array(this.resultBuffer.getMappedRange(0,r));let a=0;for(const[,t]of e){const e=n[t],r=n[t+1];a+=Number(r-e)/1e6}return this.resultBuffer.unmap(),this.lastValue=a,a}catch(e){return console.error("Error resolving queries:",e),"mapped"===this.resultBuffer.mapState&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&"mapped"===this.resultBuffer.mapState)try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class gw extends nS{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=void 0===e.alpha||e.alpha,this.parameters.compatibilityMode=void 0!==e.compatibilityMode&&e.compatibilityMode,this.parameters.requiredLimits=void 0===e.requiredLimits?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new aw(this),this.attributeUtils=new dw(this),this.bindingUtils=new cw(this),this.pipelineUtils=new hw(this),this.textureUtils=new kA(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let r;if(void 0===t.device){const e={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},s="undefined"!=typeof navigator?await navigator.gpu.requestAdapter(e):null;if(null===s)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const i=Object.values(LA),n=[];for(const e of i)s.features.has(e)&&n.push(e);const a={requiredFeatures:n,requiredLimits:t.requiredLimits};r=await s.requestDevice(a)}else r=t.device;r.lost.then(t=>{const r={api:"WebGPU",message:t.message||"Unknown reason",reason:t.reason||null,originalEvent:t};e.onDeviceLost(r)});const s=void 0!==t.context?t.context:e.domElement.getContext("webgpu");this.device=r,this.context=s;const i=t.alpha?"premultiplied":"opaque",n=c.getToneMappingMode(this.renderer.outputColorSpace);this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:i,toneMapping:{mode:n}}),this.trackTimestamp=this.trackTimestamp&&this.hasFeature(LA.TimestampQuery),this.updateSize()}get coordinateSystem(){return d}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(null===e){const t=this.renderer;e={colorAttachments:[{view:null}]},!0!==this.renderer.depth&&!0!==this.renderer.stencil||(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(t.depth,t.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const r=e.renderTarget,s=this.get(r);let i=s.descriptors;void 0!==i&&s.width===r.width&&s.height===r.height&&s.samples===r.samples||(i={},s.descriptors=i);const n=e.getCacheKey();let a=i[n];if(void 0===a){const t=e.textures,o=[];let u;const l=this._isRenderCameraDepthArray(e);for(let s=0;s<t.length;s++){const i=this.get(t[s]),n={label:`colorAttachment_${s}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:RA};if(r.isRenderTarget3D)u=e.activeCubeFace,n.baseArrayLayer=0,n.dimension=CA,n.depthOrArrayLayers=t[s].image.depth;else if(r.isRenderTarget&&t[s].image.depth>1)if(!0===l){const t=e.camera.cameras;for(let e=0;e<t.length;e++){const t={...n,baseArrayLayer:e,arrayLayerCount:1,dimension:RA},r=i.texture.createView(t);o.push({view:r,resolveTarget:void 0,depthSlice:void 0})}}else n.dimension=AA,n.depthOrArrayLayers=t[s].image.depth;if(!0!==l){const e=i.texture.createView(n);let t,r;void 0!==i.msaaTexture?(t=i.msaaTexture.createView(),r=e):(t=e,r=void 0),o.push({view:t,resolveTarget:r,depthSlice:u})}}if(a={textureViews:o},e.depth){const t=this.get(e.depthTexture),r={};e.depthTexture.isArrayTexture&&(r.dimension=RA,r.arrayLayerCount=1,r.baseArrayLayer=e.activeCubeFace),a.depthStencilView=t.texture.createView(r)}i[n]=a,s.width=r.width,s.height=r.height,s.samples=r.samples,s.activeMipmapLevel=e.activeMipmapLevel,s.activeCubeFace=e.activeCubeFace}const o={colorAttachments:[]};for(let e=0;e<a.textureViews.length;e++){const r=a.textureViews[e];let s={r:0,g:0,b:0,a:1};0===e&&t.clearValue&&(s=t.clearValue),o.colorAttachments.push({view:r.view,depthSlice:r.depthSlice,resolveTarget:r.resolveTarget,loadOp:t.loadOp||GS,storeOp:t.storeOp||OS,clearValue:s})}return a.depthStencilView&&(o.depthStencilAttachment={view:a.depthStencilView}),o}beginRender(e){const t=this.get(e);t.frameCalls=this.renderer.info.render.frameCalls;const r=this.device,s=e.occlusionQueryCount;let i,n;s>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,i=r.createQuerySet({type:"occlusion",count:s,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=i,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(s),t.lastOcclusionObject=null),n=null===e.textures?this._getDefaultRenderPassDescriptor():this._getRenderPassDescriptor(e,{loadOp:GS}),this.initTimestampQuery(Ir.RENDER,this.getTimestampUID(e),n),n.occlusionQuerySet=i;const a=n.depthStencilAttachment;if(null!==e.textures){const t=n.colorAttachments;for(let r=0;r<t.length;r++){const s=t[r];e.clearColor?(s.clearValue=0===r?e.clearColorValue:{r:0,g:0,b:0,a:1},s.loadOp=kS):s.loadOp=GS,s.storeOp=OS}}else{const t=n.colorAttachments[0];e.clearColor?(t.clearValue=e.clearColorValue,t.loadOp=kS):t.loadOp=GS,t.storeOp=OS}e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=kS):a.depthLoadOp=GS,a.depthStoreOp=OS),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=kS):a.stencilLoadOp=GS,a.stencilStoreOp=OS);const o=r.createCommandEncoder({label:"renderContext_"+e.id});if(!0===this._isRenderCameraDepthArray(e)){const r=e.camera.cameras;t.layerDescriptors&&t.layerDescriptors.length===r.length?this._updateDepthLayerDescriptors(e,t,r):this._createDepthLayerDescriptors(e,t,n,r),t.bundleEncoders=[],t.bundleSets=[];for(let s=0;s<r.length;s++){const r=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+s),i={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(r),t.bundleSets.push(i)}t.currentPass=null}else{const r=o.beginRenderPass(n);if(t.currentPass=r,e.viewport&&this.updateViewport(e),e.scissor){const{x:t,y:s,width:i,height:n}=e.scissorValue;r.setScissorRect(t,s,i,n)}}t.descriptor=n,t.encoder=o,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,r,s){const i=r.depthStencilAttachment;t.layerDescriptors=[];const n=this.get(e.depthTexture);n.viewCache||(n.viewCache=[]);for(let a=0;a<s.length;a++){const s={...r,colorAttachments:[{...r.colorAttachments[0],view:r.colorAttachments[a].view}]};if(r.depthStencilAttachment){const t=a;n.viewCache[t]||(n.viewCache[t]=n.texture.createView({dimension:RA,baseArrayLayer:a,arrayLayerCount:1})),s.depthStencilAttachment={view:n.viewCache[t],depthLoadOp:i.depthLoadOp||kS,depthStoreOp:i.depthStoreOp||OS,depthClearValue:i.depthClearValue||1},e.stencil&&(s.depthStencilAttachment.stencilLoadOp=i.stencilLoadOp,s.depthStencilAttachment.stencilStoreOp=i.stencilStoreOp,s.depthStencilAttachment.stencilClearValue=i.stencilClearValue)}else s.depthStencilAttachment={...i};t.layerDescriptors.push(s)}}_updateDepthLayerDescriptors(e,t,r){for(let s=0;s<r.length;s++){const r=t.layerDescriptors[s];if(r.depthStencilAttachment){const t=r.depthStencilAttachment;e.depth&&(e.clearDepth?(t.depthClearValue=e.clearDepthValue,t.depthLoadOp=kS):t.depthLoadOp=GS),e.stencil&&(e.clearStencil?(t.stencilClearValue=e.clearStencilValue,t.stencilLoadOp=kS):t.stencilLoadOp=GS)}}}finishRender(e){const t=this.get(e),r=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),r>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const s=t.encoder;if(!0===this._isRenderCameraDepthArray(e)){const r=[];for(let e=0;e<t.bundleEncoders.length;e++){const s=t.bundleEncoders[e];r.push(s.finish())}for(let i=0;i<t.layerDescriptors.length;i++)if(i<r.length){const n=t.layerDescriptors[i],a=s.beginRenderPass(n);if(e.viewport){const{x:t,y:r,width:s,height:i,minDepth:n,maxDepth:o}=e.viewportValue;a.setViewport(t,r,s,i,n,o)}if(e.scissor){const{x:t,y:r,width:s,height:i}=e.scissorValue;a.setScissorRect(t,r,s,i)}a.executeBundles([r[i]]),a.end()}}else t.currentPass&&t.currentPass.end();if(r>0){const s=8*r;let i=this.occludedResolveCache.get(s);void 0===i&&(i=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,i));const n=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,r,i,0),t.encoder.copyBufferToBuffer(i,0,n,0,s),t.occlusionQueryBuffer=n,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),null!==e.textures){const t=e.textures;for(let e=0;e<t.length;e++){const r=t[e];!0===r.generateMipmaps&&this.textureUtils.generateMipmaps(r)}}}isOccluded(e,t){const r=this.get(e);return r.occluded&&r.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:r,currentOcclusionQueryObjects:s}=t;if(r&&s){const e=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await r.mapAsync(GPUMapMode.READ);const i=r.getMappedRange(),n=new BigUint64Array(i);for(let t=0;t<s.length;t++)n[t]===BigInt(0)&&e.add(s[t]);r.destroy(),t.occluded=e}}updateViewport(e){const{currentPass:t}=this.get(e),{x:r,y:s,width:i,height:n,minDepth:a,maxDepth:o}=e.viewportValue;t.setViewport(r,s,i,n,a,o)}getClearColor(){const e=super.getClearColor();return!0===this.renderer.alpha&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,r,s=null){const i=this.device,n=this.renderer;let a,o,u,l,d=[];if(e){const e=this.getClearColor();o={r:e.r,g:e.g,b:e.b,a:e.a}}if(null===s){u=n.depth,l=n.stencil;const t=this._getDefaultRenderPassDescriptor();if(e){d=t.colorAttachments;const e=d[0];e.clearValue=o,e.loadOp=kS,e.storeOp=OS}(u||l)&&(a=t.depthStencilAttachment)}else{u=s.depth,l=s.stencil;const i={loadOp:e?kS:GS,clearValue:e?o:void 0};u&&(i.depthLoadOp=t?kS:GS,i.depthClearValue=t?n.getClearDepth():void 0,i.depthStoreOp=OS),l&&(i.stencilLoadOp=r?kS:GS,i.stencilClearValue=r?n.getClearStencil():void 0,i.stencilStoreOp=OS);const c=this._getRenderPassDescriptor(s,i);d=c.colorAttachments,a=c.depthStencilAttachment}u&&a&&(t?(a.depthLoadOp=kS,a.depthClearValue=n.getClearDepth(),a.depthStoreOp=OS):(a.depthLoadOp=GS,a.depthStoreOp=OS)),l&&a&&(r?(a.stencilLoadOp=kS,a.stencilClearValue=n.getClearStencil(),a.stencilStoreOp=OS):(a.stencilLoadOp=GS,a.stencilStoreOp=OS));const c=i.createCommandEncoder({label:"clear"});c.beginRenderPass({colorAttachments:d,depthStencilAttachment:a}).end(),i.queue.submit([c.finish()])}beginCompute(e){const t=this.get(e);t.frameCalls=this.renderer.info.compute.frameCalls;const r={label:"computeGroup_"+e.id};this.initTimestampQuery(Ir.COMPUTE,this.getTimestampUID(e),r),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(r)}compute(e,t,r,s,i=null){const n=this.get(t),{passEncoderGPU:a}=this.get(e),o=this.get(s).pipeline;this.pipelineUtils.setPipeline(a,o);for(let e=0,t=r.length;e<t;e++){const t=r[e],s=this.get(t);a.setBindGroup(e,s.group)}let u;if(null===i&&(i=t.count),"number"==typeof i){const e=i;if(void 0===n.dispatchSize||n.count!==e){n.dispatchSize=[0,1,1],n.count=e;const r=t.workgroupSize;let s=r[0];for(let e=1;e<r.length;e++)s*=r[e];const i=Math.ceil(e/s),a=this.device.limits.maxComputeWorkgroupsPerDimension;u=[i,1,1],i>a&&(u[0]=Math.min(i,a),u[1]=Math.ceil(i/a)),n.dispatchSize=u}u=n.dispatchSize}else u=i;a.dispatchWorkgroups(u[0],u[1]||1,u[2]||1)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:r,material:s,context:i,pipeline:n}=e,a=e.getBindings(),o=this.get(i),u=this.get(n).pipeline,l=e.getIndex(),d=null!==l,c=e.getDrawParameters();if(null===c)return;const h=(t,r)=>{this.pipelineUtils.setPipeline(t,u),r.pipeline=u;const n=r.bindingGroups;for(let e=0,r=a.length;e<r;e++){const r=a[e],s=this.get(r);n[r.index]!==r.id&&(t.setBindGroup(r.index,s.group),n[r.index]=r.id)}if(!0===d&&r.index!==l){const e=this.get(l).buffer,s=l.array instanceof Uint16Array?qS:jS;t.setIndexBuffer(e,s),r.index=l}const c=e.getVertexBuffers();for(let e=0,s=c.length;e<s;e++){const s=c[e];if(r.attributes[e]!==s){const i=this.get(s).buffer;t.setVertexBuffer(e,i),r.attributes[e]=s}}!0===i.stencil&&!0===s.stencilWrite&&o.currentStencilRef!==s.stencilRef&&(t.setStencilReference(s.stencilRef),o.currentStencilRef=s.stencilRef)},p=(s,i)=>{if(h(s,i),!0===r.isBatchedMesh){const e=r._multiDrawStarts,i=r._multiDrawCounts,n=r._multiDrawCount,a=r._multiDrawInstances;null!==a&&Be("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let o=0;o<n;o++){const n=a?a[o]:1,u=n>1?0:o;!0===d?s.drawIndexed(i[o],n,e[o]/l.array.BYTES_PER_ELEMENT,0,u):s.draw(i[o],n,e[o],u),t.update(r,i[o],n)}}else if(!0===d){const{vertexCount:i,instanceCount:n,firstVertex:a}=c,o=e.getIndirect();if(null!==o){const e=this.get(o).buffer;s.drawIndexedIndirect(e,0)}else s.drawIndexed(i,n,a,0,0);t.update(r,i,n)}else{const{vertexCount:i,instanceCount:n,firstVertex:a}=c,o=e.getIndirect();if(null!==o){const e=this.get(o).buffer;s.drawIndirect(e,0)}else s.draw(i,n,a,0);t.update(r,i,n)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const t=this.get(e.camera),s=e.camera.cameras,n=e.getBindingGroup("cameraIndex");if(void 0===t.indexesGPU||t.indexesGPU.length!==s.length){const e=this.get(n),r=[],i=new Uint32Array([0,0,0,0]);for(let t=0,n=s.length;t<n;t++){i[0]=t;const s=this.bindingUtils.createBindGroupIndex(i,e.layout);r.push(s)}t.indexesGPU=r}const a=this.renderer.getPixelRatio();for(let e=0,u=s.length;e<u;e++){const u=s[e];if(r.layers.test(u.layers)){const r=u.viewport;let s=o.currentPass,l=o.currentSets;if(o.bundleEncoders){s=o.bundleEncoders[e],l=o.bundleSets[e]}r&&s.setViewport(Math.floor(r.x*a),Math.floor(r.y*a),Math.floor(r.width*a),Math.floor(r.height*a),i.viewportValue.minDepth,i.viewportValue.maxDepth),n&&t.indexesGPU&&(s.setBindGroup(n.index,t.indexesGPU[e]),l.bindingGroups[n.index]=n.id),p(s,l)}}}else if(o.currentPass){if(void 0!==o.occlusionQuerySet){const e=o.lastOcclusionObject;e!==r&&(null!==e&&!0===e.occlusionTest&&(o.currentPass.endOcclusionQuery(),o.occlusionQueryIndex++),!0===r.occlusionTest&&(o.currentPass.beginOcclusionQuery(o.occlusionQueryIndex),o.occlusionQueryObjects[o.occlusionQueryIndex]=r),o.lastOcclusionObject=r)}p(o.currentPass,o.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:r,material:s}=e,i=this.utils,n=i.getSampleCountRenderContext(e.context),a=i.getCurrentColorSpace(e.context),o=i.getCurrentColorFormat(e.context),u=i.getCurrentDepthStencilFormat(e.context),l=i.getPrimitiveTopology(r,s);let d=!1;return t.material===s&&t.materialVersion===s.version&&t.transparent===s.transparent&&t.blending===s.blending&&t.premultipliedAlpha===s.premultipliedAlpha&&t.blendSrc===s.blendSrc&&t.blendDst===s.blendDst&&t.blendEquation===s.blendEquation&&t.blendSrcAlpha===s.blendSrcAlpha&&t.blendDstAlpha===s.blendDstAlpha&&t.blendEquationAlpha===s.blendEquationAlpha&&t.colorWrite===s.colorWrite&&t.depthWrite===s.depthWrite&&t.depthTest===s.depthTest&&t.depthFunc===s.depthFunc&&t.stencilWrite===s.stencilWrite&&t.stencilFunc===s.stencilFunc&&t.stencilFail===s.stencilFail&&t.stencilZFail===s.stencilZFail&&t.stencilZPass===s.stencilZPass&&t.stencilFuncMask===s.stencilFuncMask&&t.stencilWriteMask===s.stencilWriteMask&&t.side===s.side&&t.alphaToCoverage===s.alphaToCoverage&&t.sampleCount===n&&t.colorSpace===a&&t.colorFormat===o&&t.depthStencilFormat===u&&t.primitiveTopology===l&&t.clippingContextCacheKey===e.clippingContextCacheKey||(t.material=s,t.materialVersion=s.version,t.transparent=s.transparent,t.blending=s.blending,t.premultipliedAlpha=s.premultipliedAlpha,t.blendSrc=s.blendSrc,t.blendDst=s.blendDst,t.blendEquation=s.blendEquation,t.blendSrcAlpha=s.blendSrcAlpha,t.blendDstAlpha=s.blendDstAlpha,t.blendEquationAlpha=s.blendEquationAlpha,t.colorWrite=s.colorWrite,t.depthWrite=s.depthWrite,t.depthTest=s.depthTest,t.depthFunc=s.depthFunc,t.stencilWrite=s.stencilWrite,t.stencilFunc=s.stencilFunc,t.stencilFail=s.stencilFail,t.stencilZFail=s.stencilZFail,t.stencilZPass=s.stencilZPass,t.stencilFuncMask=s.stencilFuncMask,t.stencilWriteMask=s.stencilWriteMask,t.side=s.side,t.alphaToCoverage=s.alphaToCoverage,t.sampleCount=n,t.colorSpace=a,t.colorFormat=o,t.depthStencilFormat=u,t.primitiveTopology=l,t.clippingContextCacheKey=e.clippingContextCacheKey,d=!0),d}getRenderCacheKey(e){const{object:t,material:r}=e,s=this.utils,i=e.context,n=t.isMesh&&t.matrixWorld.determinant()<0;return[r.transparent,r.blending,r.premultipliedAlpha,r.blendSrc,r.blendDst,r.blendEquation,r.blendSrcAlpha,r.blendDstAlpha,r.blendEquationAlpha,r.colorWrite,r.depthWrite,r.depthTest,r.depthFunc,r.stencilWrite,r.stencilFunc,r.stencilFail,r.stencilZFail,r.stencilZPass,r.stencilFuncMask,r.stencilWriteMask,r.side,n,s.getSampleCountRenderContext(i),s.getCurrentColorSpace(i),s.getCurrentColorFormat(i),s.getCurrentDepthStencilFormat(i),s.getPrimitiveTopology(t,r),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,t,r,s,i,n){return this.textureUtils.copyTextureToBuffer(e,t,r,s,i,n)}initTimestampQuery(e,t,r){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new pw(this.device,e,2048));const s=this.timestampQueryPool[e],i=s.allocateQueriesForContext(t);r.timestampWrites={querySet:s.querySet,beginningOfPassWriteIndex:i,endOfPassWriteIndex:i+1}}createNodeBuilder(e,t){return new nw(e,t)}createProgram(e){this.get(e).module={module:this.device.createShaderModule({code:e.code,label:e.stage+(""!==e.name?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const r=this.get(e),s=r.currentPass.finish();this.get(t).bundleGPU=s,r.currentSets=r._currentSets,r.currentPass=r._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,r,s){this.bindingUtils.createBindings(e,t,r,s)}updateBindings(e,t,r,s){this.bindingUtils.createBindings(e,t,r,s)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,r=null,s=null,i=0,n=0){let a=0,o=0,u=0,l=0,d=0,c=0,h=e.image.width,p=e.image.height,g=1;null!==r&&(!0===r.isBox3?(l=r.min.x,d=r.min.y,c=r.min.z,h=r.max.x-r.min.x,p=r.max.y-r.min.y,g=r.max.z-r.min.z):(l=r.min.x,d=r.min.y,h=r.max.x-r.min.x,p=r.max.y-r.min.y,g=1)),null!==s&&(a=s.x,o=s.y,u=s.z||0);const m=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),f=this.get(e).texture,y=this.get(t).texture;m.copyTextureToTexture({texture:f,mipLevel:i,origin:{x:l,y:d,z:c}},{texture:y,mipLevel:n,origin:{x:a,y:o,z:u}},[h,p,g]),this.device.queue.submit([m.finish()]),0===n&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,r){const s=this.get(t);let i=null;i=t.renderTarget?e.isDepthTexture?this.get(t.depthTexture).texture:this.get(t.textures[0]).texture:e.isDepthTexture?this.textureUtils.getDepthBuffer(t.depth,t.stencil):this.context.getCurrentTexture();const n=this.get(e).texture;if(i.format!==n.format)return void console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",i.format,n.format);let a;if(s.currentPass?(s.currentPass.end(),a=s.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:i,origin:[r.x,r.y,0]},{texture:n},[r.z,r.w]),s.currentPass){const{descriptor:e}=s;for(let t=0;t<e.colorAttachments.length;t++)e.colorAttachments[t].loadOp=GS;if(t.depth&&(e.depthStencilAttachment.depthLoadOp=GS),t.stencil&&(e.depthStencilAttachment.stencilLoadOp=GS),s.currentPass=a.beginRenderPass(e),s.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor){const{x:e,y:r,width:i,height:n}=t.scissorValue;s.currentPass.setScissorRect(e,r,i,n)}}else this.device.queue.submit([a.finish()]);e.generateMipmaps&&this.textureUtils.generateMipmaps(e)}}class mw extends es{constructor(e,t,r,s,i,n){super(e,t,r,s,i,n),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class fw extends es{constructor(e,t,r,s,i,n){super(e,t,r,s,i,n),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class yw extends gN{constructor(){super(),this.addLight(a_,ts),this.addLight(Gv,rs),this.addLight(Hv,ss),this.addLight(Wv,es),this.addLight(Kv,is),this.addLight(Yv,ns),this.addLight(Qv,as),this.addLight(qv,mw),this.addLight(Xv,fw),this.addToneMapping(jb,os),this.addToneMapping(Xb,us),this.addToneMapping(Kb,ls),this.addToneMapping(Qb,ds),this.addToneMapping(tx,cs),this.addToneMapping(rx,hs)}}class bw extends IN{constructor(e={}){let t;e.forceWebGL?t=ES:(t=gw,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new ES(e)));super(new t(e),e),this.library=new yw,this.isWebGPURenderer=!0}}class xw extends ps{constructor(){super(),this.isBundleGroup=!0,this.type="BundleGroup",this.static=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}}class Tw{constructor(e,t=gn(0,0,1,1)){this.renderer=e,this.outputNode=t,this.outputColorTransform=!0,this.needsUpdate=!0;const r=new Sp;r.name="PostProcessing",this._quadMesh=new sb(r),this._context=null}render(){const e=this.renderer;this._update(),null!==this._context.onBeforePostProcessing&&this._context.onBeforePostProcessing();const t=e.toneMapping,r=e.outputColorSpace;e.toneMapping=p,e.outputColorSpace=c.workingColorSpace;const s=e.xr.enabled;e.xr.enabled=!1,this._quadMesh.render(e),e.xr.enabled=s,e.toneMapping=t,e.outputColorSpace=r,null!==this._context.onAfterPostProcessing&&this._context.onAfterPostProcessing()}get context(){return this._context}dispose(){this._quadMesh.material.dispose()}_update(){if(!0===this.needsUpdate){const e=this.renderer,t=e.toneMapping,r=e.outputColorSpace,s={postProcessing:this,onBeforePostProcessing:null,onAfterPostProcessing:null};let i=this.outputNode;!0===this.outputColorTransform?(i=i.context(s),i=Zu(i,t,r)):(s.toneMapping=t,s.outputColorSpace=r,i=i.context(s)),this._context=s,this._quadMesh.material.fragmentNode=i,this._quadMesh.material.needsUpdate=!0,this.needsUpdate=!1}}async renderAsync(){this._update(),null!==this._context.onBeforePostProcessing&&this._context.onBeforePostProcessing();const e=this.renderer,t=e.toneMapping,r=e.outputColorSpace;e.toneMapping=p,e.outputColorSpace=c.workingColorSpace;const s=e.xr.enabled;e.xr.enabled=!1,await this._quadMesh.renderAsync(e),e.xr.enabled=s,e.toneMapping=t,e.outputColorSpace=r,null!==this._context.onAfterPostProcessing&&this._context.onAfterPostProcessing()}}class _w extends x{constructor(e=1,t=1){super(),this.image={width:e,height:t},this.magFilter=Y,this.minFilter=Y,this.isStorageTexture=!0}setSize(e,t){this.image.width===e&&this.image.height===t||(this.image.width=e,this.image.height=t,this.dispose())}}class vw extends gb{constructor(e,t){super(e,t,Uint32Array),this.isIndirectStorageBufferAttribute=!0}}class Nw extends gs{constructor(e){super(e),this.textures={},this.nodes={}}load(e,t,r,s){const i=new ms(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,r=>{try{t(this.parse(JSON.parse(r)))}catch(t){s?s(t):console.error(t),this.manager.itemError(e)}},r,s)}parseNodes(e){const t={};if(void 0!==e){for(const r of e){const{uuid:e,type:s}=r;t[e]=this.createNodeFromType(s),t[e].uuid=e}const r={nodes:t,textures:this.textures};for(const s of e){s.meta=r;t[s.uuid].deserialize(s),delete s.meta}}return t}parse(e){const t=this.createNodeFromType(e.type);t.uuid=e.uuid;const r={nodes:this.parseNodes(e.nodes),textures:this.textures};return e.meta=r,t.deserialize(e),delete e.meta,t}setTextures(e){return this.textures=e,this}setNodes(e){return this.nodes=e,this}createNodeFromType(e){return void 0===this.nodes[e]?(console.error("THREE.NodeLoader: Node type not found:",e),tn()):Gi(new this.nodes[e])}}class Sw extends fs{constructor(e){super(e),this.nodes={},this.nodeMaterials={}}parse(e){const t=super.parse(e),r=this.nodes,s=e.inputNodes;for(const e in s){const i=s[e];t[e]=r[i]}return t}setNodes(e){return this.nodes=e,this}setNodeMaterials(e){return this.nodeMaterials=e,this}createMaterialFromType(e){const t=this.nodeMaterials[e];return void 0!==t?new t:super.createMaterialFromType(e)}}class Ew extends ys{constructor(e){super(e),this.nodes={},this.nodeMaterials={},this._nodesJSON=null}setNodes(e){return this.nodes=e,this}setNodeMaterials(e){return this.nodeMaterials=e,this}parse(e,t){this._nodesJSON=e.nodes;const r=super.parse(e,t);return this._nodesJSON=null,r}parseNodes(e,t){if(void 0!==e){const r=new Nw;return r.setNodes(this.nodes),r.setTextures(t),r.parseNodes(e)}return{}}parseMaterials(e,t){const r={};if(void 0!==e){const s=this.parseNodes(this._nodesJSON,t),i=new Sw;i.setTextures(t),i.setNodes(s),i.setNodeMaterials(this.nodeMaterials);for(let t=0,s=e.length;t<s;t++){const s=e[t];r[s.uuid]=i.parse(s)}}return r}}class Rw extends ps{constructor(){super(),this.isClippingGroup=!0,this.clippingPlanes=[],this.enabled=!0,this.clipIntersection=!1,this.clipShadows=!1}}export{ds as ACESFilmicToneMapping,Wh as AONode,Ke as AddEquation,ee as AddOperation,Bt as AdditiveBlending,cs as AgXToneMapping,Wt as AlphaFormat,Pr as AlwaysCompare,Ot as AlwaysDepth,zr as AlwaysStencilFunc,is as AmbientLight,Kv as AmbientLightNode,s_ as AnalyticLightNode,We as ArrayCamera,Qs as ArrayElementNode,ua as ArrayNode,da as AssignNode,tl as AttributeNode,S as BackSide,Hp as BasicEnvironmentNode,Oe as BasicShadowMap,Ah as BatchNode,by as BitcastNode,j as BoxGeometry,ge as BufferAttribute,Lu as BufferAttributeNode,pe as BufferGeometry,pl as BufferNode,Ac as BumpMapNode,xw as BundleGroup,$u as BypassNode,ut as ByteType,ku as CacheNode,Ee as Camera,ls as CineonToneMapping,Nr as ClampToEdgeWrapping,Rw as ClippingGroup,sx as CodeNode,e as Color,c as ColorManagement,Nu as ColorSpaceNode,Vu as ComputeNode,oi as ConstNode,nu as ContextNode,Zs as ConvertNode,Q as CubeCamera,w as CubeReflectionMapping,C as CubeRefractionMapping,A as CubeTexture,zd as CubeTextureNode,he as CubeUVReflectionMapping,wt as CullFaceBack,Ct as CullFaceFront,At as CullFaceNone,Xe as CustomBlending,Qe as CylinderGeometry,F as DataArrayTexture,it as DataTexture,Ju as DebugNode,qr as DecrementStencilOp,Hr as DecrementWrapStencilOp,Ae as DepthFormat,Re as DepthStencilFormat,V as DepthTexture,rs as DirectionalLight,Gv as DirectionalLightNode,E as DoubleSide,_t as DstAlphaFactor,vt as DstColorFactor,y as DynamicDrawUsage,$m as EnvironmentNode,Cr as EqualCompare,Dt as EqualDepth,Or as EqualStencilFunc,Z as EquirectangularReflectionMapping,J as EquirectangularRefractionMapping,R as Euler,o as EventDispatcher,cb as EventNode,Xu as ExpressionNode,ms as FileLoader,$e as Float16BufferAttribute,Fe as Float32BufferAttribute,I as FloatType,D as FramebufferTexture,md as FrontFacingNode,je as FrontSide,st as Frustum,rt as FrustumArray,ha as FunctionCallNode,nx as FunctionNode,Ey as FunctionOverloadingNode,iN as GLSLNodeParser,Ar as GreaterCompare,Ft as GreaterDepth,wr as GreaterEqualCompare,It as GreaterEqualDepth,Vr as GreaterEqualStencilFunc,Ur as GreaterStencilFunc,ps as Group,ce as HalfFloatType,ns as HemisphereLight,Yv as HemisphereLightNode,mw as IESSpotLight,qv as IESSpotLightNode,jr as IncrementStencilOp,Wr as IncrementWrapStencilOp,fh as IndexNode,vw as IndirectStorageBufferAttribute,Nh as InstanceNode,L as InstancedBufferAttribute,B as InstancedInterleavedBuffer,Eh as InstancedMeshNode,_ as IntType,m as InterleavedBuffer,f as InterleavedBufferAttribute,Xr as InvertStencilOp,Xh as IrradianceNode,ei as JoinNode,Qr as KeepStencilOp,Ue as LessCompare,Vt as LessDepth,Mr as LessEqualCompare,Ut as LessEqualDepth,Gr as LessEqualStencilFunc,kr as LessStencilFunc,as as LightProbe,Qv as LightProbeNode,yN as Lighting,qh as LightingContextNode,qp as LightingModel,Hh as LightingNode,bT as LightsNode,Lp as Line2NodeMaterial,k as LineBasicMaterial,Rp as LineBasicNodeMaterial,z as LineDashedMaterial,wp as LineDashedNodeMaterial,Y as LinearFilter,Le as LinearMipMapLinearFilter,U as LinearMipmapLinearFilter,ke as LinearMipmapNearestFilter,le as LinearSRGBColorSpace,os as LinearToneMapping,Lr as LinearTransfer,gs as Loader,Dh as LoopNode,fy as MRTNode,O as Material,fs as MaterialLoader,Mc as MaterialNode,Kd as MaterialReferenceNode,u as MathUtils,i as Matrix2,n as Matrix3,a as Matrix4,Zr as MaxEquation,al as MaxMipLevelNode,ui as MemberNode,X as Mesh,se as MeshBasicMaterial,Kp as MeshBasicNodeMaterial,ie as MeshLambertMaterial,rg as MeshLambertNodeMaterial,be as MeshMatcapMaterial,nf as MeshMatcapNodeMaterial,H as MeshNormalMaterial,Dp as MeshNormalNodeMaterial,ne as MeshPhongMaterial,ig as MeshPhongNodeMaterial,fe as MeshPhysicalMaterial,Km as MeshPhysicalNodeMaterial,Qm as MeshSSSNodeMaterial,me as MeshStandardMaterial,jm as MeshStandardNodeMaterial,ye as MeshToonMaterial,tf as MeshToonNodeMaterial,Jr as MinEquation,vr as MirroredRepeatWrapping,te as MixOperation,Kl as ModelNode,zh as MorphNode,Mt as MultiplyBlending,re as MultiplyOperation,v as NearestFilter,ze as NearestMipmapLinearFilter,Er as NearestMipmapNearestFilter,hs as NeutralToneMapping,Br as NeverCompare,Gt as NeverDepth,$r as NeverStencilFunc,$ as NoBlending,b as NoColorSpace,p as NoToneMapping,Ys as Node,$s as NodeAccess,lv as NodeAttribute,Uv as NodeBuilder,mv as NodeCache,pv as NodeCode,Vv as NodeFrame,Ov as NodeFunctionInput,Nw as NodeLoader,Sp as NodeMaterial,Sw as NodeMaterialLoader,Ts as NodeMaterialObserver,Ew as NodeObjectLoader,Gs as NodeShaderStage,zs as NodeType,dv as NodeUniform,ks as NodeUpdateType,Os as NodeUtils,cv as NodeVar,hv as NodeVarying,G as NormalBlending,Nc as NormalMapNode,Rr as NotEqualCompare,Lt as NotEqualDepth,Dr as NotEqualStencilFunc,Pe as Object3D,zl as Object3DNode,ys as ObjectLoader,P as ObjectSpaceNormalMap,Rt as OneFactor,yt as OneMinusDstAlphaFactor,bt as OneMinusDstColorFactor,xt as OneMinusSrcAlphaFactor,Tt as OneMinusSrcColorFactor,ae as OrthographicCamera,py as OutputStructNode,tt as PCFShadowMap,Bm as PMREMGenerator,Gm as PMREMNode,uy as ParameterNode,Wb as PassNode,oe as PerspectiveCamera,eg as PhongLightingModel,Kg as PhysicalLightingModel,Me as Plane,qe as PlaneGeometry,ts as PointLight,a_ as PointLightNode,mb as PointUVNode,Te as PointsMaterial,hf as PointsNodeMaterial,Tw as PostProcessing,Gb as PosterizeNode,fw as ProjectorLight,Xv as ProjectorLightNode,Nn as PropertyNode,sb as QuadMesh,Ze as Quaternion,Tr as RED_GREEN_RGTC2_Format,br as RED_RGTC1_Format,He as REVISION,de as RGBAFormat,pt as RGBAIntegerFormat,gr as RGBA_ASTC_10x10_Format,cr as RGBA_ASTC_10x5_Format,hr as RGBA_ASTC_10x6_Format,pr as RGBA_ASTC_10x8_Format,mr as RGBA_ASTC_12x10_Format,fr as RGBA_ASTC_12x12_Format,sr as RGBA_ASTC_4x4_Format,ir as RGBA_ASTC_5x4_Format,nr as RGBA_ASTC_5x5_Format,ar as RGBA_ASTC_6x5_Format,or as RGBA_ASTC_6x6_Format,ur as RGBA_ASTC_8x5_Format,lr as RGBA_ASTC_8x6_Format,dr as RGBA_ASTC_8x8_Format,yr as RGBA_BPTC_Format,rr as RGBA_ETC2_EAC_Format,Jt as RGBA_PVRTC_2BPPV1_Format,Zt as RGBA_PVRTC_4BPPV1_Format,jt as RGBA_S3TC_DXT1_Format,Xt as RGBA_S3TC_DXT3_Format,Kt as RGBA_S3TC_DXT5_Format,ht as RGBFormat,ct as RGBIntegerFormat,er as RGB_ETC1_Format,tr as RGB_ETC2_Format,Qt as RGB_PVRTC_2BPPV1_Format,Yt as RGB_PVRTC_4BPPV1_Format,qt as RGB_S3TC_DXT1_Format,Ve as RGFormat,dt as RGIntegerFormat,nb as RTTNode,Tx as RangeNode,ss as RectAreaLight,Hv as RectAreaLightNode,at as RedFormat,nt as RedIntegerFormat,qd as ReferenceNode,Zy as ReflectorNode,us as ReinhardToneMapping,Wu as RemapNode,Qu as RenderOutputNode,ue as RenderTarget,wu as RendererReferenceNode,CT as RendererUtils,Sr as RepeatWrapping,Kr as ReplaceStencilOp,mt as ReverseSubtractEquation,af as RotateNode,_r as SIGNED_RED_GREEN_RGTC2_Format,xr as SIGNED_RED_RGTC1_Format,W as SRGBColorSpace,h as SRGBTransfer,K as Scene,xb as SceneNode,_l as ScreenNode,hx as ScriptableNode,ox as ScriptableValueNode,si as SetNode,xT as ShadowBaseNode,_e as ShadowMaterial,WT as ShadowNode,ff as ShadowNodeMaterial,ot as ShortType,Fh as SkinningNode,N as Sphere,Ge as SphereGeometry,ri as SplitNode,es as SpotLight,Wv as SpotLightNode,xe as SpriteMaterial,lf as SpriteNodeMaterial,Iy as SpriteSheetUVNode,St as SrcAlphaFactor,Nt as SrcAlphaSaturateFactor,Et as SrcColorFactor,ly as StackNode,g as StaticDrawUsage,Ch as StorageArrayElementNode,gb as StorageBufferAttribute,Ph as StorageBufferNode,pb as StorageInstancedBufferAttribute,_w as StorageTexture,Nb as StorageTextureNode,hy as StructNode,cy as StructTypeNode,mu as SubBuildNode,ft as SubtractEquation,Pt as SubtractiveBlending,sv as TSL,M as TangentSpaceNormalMap,Js as TempNode,x as Texture,Rb as Texture3DNode,ll as TextureNode,il as TextureSizeNode,Ir as TimestampQuery,Mu as ToneMappingNode,qb as ToonOutlinePassNode,Ie as UVMapping,Ne as Uint16BufferAttribute,ve as Uint32BufferAttribute,fl as UniformArrayNode,ea as UniformGroupNode,aa as UniformNode,Ce as UnsignedByteType,Ht as UnsignedInt101111Type,we as UnsignedInt248Type,$t as UnsignedInt5999Type,T as UnsignedIntType,kt as UnsignedShort4444Type,zt as UnsignedShort5551Type,lt as UnsignedShortType,wb as UserDataNode,De as VSMShadowMap,du as VarNode,yu as VaryingNode,t as Vector2,r as Vector3,s as Vector4,mp as VertexColorNode,rp as ViewportDepthNode,ep as ViewportDepthTextureNode,Mp as ViewportSharedTextureNode,Yh as ViewportTextureNode,_f as VolumeNodeMaterial,l as WebGLCoordinateSystem,q as WebGLCubeRenderTarget,d as WebGPUCoordinateSystem,bw as WebGPURenderer,Je as WebXRController,Ye as ZeroFactor,Yr as ZeroStencilOp,gt as createCanvasElement,Ws as defaultBuildStages,Hs as defaultShaderStages,qs as shaderStages,js as vectorComponents};
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/webxr/XRControllerModelFactory.js:	setEnvironmentMap( envMap ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:	_createMaterial( material, renderEnvironment ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:		if ( renderEnvironment ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:			new EXRLoader().load( renderEnvironment.image, function ( texture ) {
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:						material = this._createMaterial( rMaterial, data.renderEnvironment );
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:		// Handle Render Environments for Material Environment
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:		const reflectionId = doc.settings().renderSettings().renderEnvironments.reflectionId;
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:		let renderEnvironment = null;
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:							renderEnvironment = { type: 'renderEnvironment', image: backgroundImage, name: fileName };
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:			renderEnvironments: extractProperties( doc.settings().renderSettings().renderEnvironments ),
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/loaders/3DMLoader.js:		return { objects, materials, layers, views, namedViews, groups, strings, settings, renderSettings, renderEnvironment };
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/exporters/USDZExporter.js:			'bool preliminary_collidesWithEnvironment = 0',
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/DebugEnvironment.js: * A more appropriate setup for production is {@link RoomEnvironment}.
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/DebugEnvironment.js: * const environment = new DebugEnvironment();
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/DebugEnvironment.js: * @three_import import { DebugEnvironment } from 'three/addons/environments/DebugEnvironment.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/DebugEnvironment.js:class DebugEnvironment extends Scene {
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/DebugEnvironment.js:export { DebugEnvironment };
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/RoomEnvironment.js: * The implementation is based on the [EnvironmentScene](https://github.com/google/model-viewer/blob/master/packages/model-viewer/src/three-components/EnvironmentScene.ts)
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/RoomEnvironment.js: * const environment = new RoomEnvironment();
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/RoomEnvironment.js: * @three_import import { RoomEnvironment } from 'three/addons/environments/RoomEnvironment.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/RoomEnvironment.js:class RoomEnvironment extends Scene {
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/environments/RoomEnvironment.js:export { RoomEnvironment };
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/Addons.js:export * from './environments/DebugEnvironment.js';
./node_modules/.pnpm/three@0.180.0/node_modules/three/examples/jsm/Addons.js:export * from './environments/RoomEnvironment.js';
./node_modules/.pnpm/zod@3.25.76/node_modules/zod/src/v3/tests/language-server.test.ts://   // Compile file developmentEnvironment.source
./node_modules/.vite/deps/chunk-O4OP6BTO.js:var lights_physical_pars_fragment = "struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n	float dispersion;\n	#ifdef USE_CLEARCOAT\n		float clearcoat;\n		float clearcoatRoughness;\n		vec3 clearcoatF0;\n		float clearcoatF90;\n	#endif\n	#ifdef USE_IRIDESCENCE\n		float iridescence;\n		float iridescenceIOR;\n		float iridescenceThickness;\n		vec3 iridescenceFresnel;\n		vec3 iridescenceF0;\n	#endif\n	#ifdef USE_SHEEN\n		vec3 sheenColor;\n		float sheenRoughness;\n	#endif\n	#ifdef IOR\n		float ior;\n	#endif\n	#ifdef USE_TRANSMISSION\n		float transmission;\n		float transmissionAlpha;\n		float thickness;\n		float attenuationDistance;\n		vec3 attenuationColor;\n	#endif\n	#ifdef USE_ANISOTROPY\n		float anisotropy;\n		float alphaT;\n		vec3 anisotropyT;\n		vec3 anisotropyB;\n	#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n		float v = 0.5 / ( gv + gl );\n		return saturate(v);\n	}\n	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n		float a2 = alphaT * alphaB;\n		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n		highp float v2 = dot( v, v );\n		float w2 = a2 / v2;\n		return RECIPROCAL_PI * a2 * pow2 ( w2 );\n	}\n#endif\n#ifdef USE_CLEARCOAT\n	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n		vec3 f0 = material.clearcoatF0;\n		float f90 = material.clearcoatF90;\n		float roughness = material.clearcoatRoughness;\n		float alpha = pow2( roughness );\n		vec3 halfDir = normalize( lightDir + viewDir );\n		float dotNL = saturate( dot( normal, lightDir ) );\n		float dotNV = saturate( dot( normal, viewDir ) );\n		float dotNH = saturate( dot( normal, halfDir ) );\n		float dotVH = saturate( dot( viewDir, halfDir ) );\n		vec3 F = F_Schlick( f0, f90, dotVH );\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n		return F * ( V * D );\n	}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n	vec3 f0 = material.specularColor;\n	float f90 = material.specularF90;\n	float roughness = material.roughness;\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( f0, f90, dotVH );\n	#ifdef USE_IRIDESCENCE\n		F = mix( F, material.iridescenceFresnel, material.iridescence );\n	#endif\n	#ifdef USE_ANISOTROPY\n		float dotTL = dot( material.anisotropyT, lightDir );\n		float dotTV = dot( material.anisotropyT, viewDir );\n		float dotTH = dot( material.anisotropyT, halfDir );\n		float dotBL = dot( material.anisotropyB, lightDir );\n		float dotBV = dot( material.anisotropyB, viewDir );\n		float dotBH = dot( material.anisotropyB, halfDir );\n		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n	#else\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n	#endif\n	return F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n	float alpha = pow2( roughness );\n	float invAlpha = 1.0 / alpha;\n	float cos2h = dotNH * dotNH;\n	float sin2h = max( 1.0 - cos2h, 0.0078125 );\n	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float D = D_Charlie( sheenRoughness, dotNH );\n	float V = V_Neubelt( dotNV, dotNL );\n	return sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float r2 = roughness * roughness;\n	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n	return saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n	return fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	return specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	#ifdef USE_IRIDESCENCE\n		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n	#else\n		vec3 Fr = specularColor;\n	#endif\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometryNormal;\n		vec3 viewDir = geometryViewDir;\n		vec3 position = geometryPosition;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.roughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifdef USE_CLEARCOAT\n		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = dotNLcc * directLight.color;\n		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef USE_CLEARCOAT\n		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n	#endif\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	#ifdef USE_IRIDESCENCE\n		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n	#else\n		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n	#endif\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}";
./node_modules/.vite/deps/chunk-O4OP6BTO.js:var transmission_pars_fragment = "#ifdef USE_TRANSMISSION\n	uniform float transmission;\n	uniform float thickness;\n	uniform float attenuationDistance;\n	uniform vec3 attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		uniform sampler2D transmissionMap;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		uniform sampler2D thicknessMap;\n	#endif\n	uniform vec2 transmissionSamplerSize;\n	uniform sampler2D transmissionSamplerMap;\n	uniform mat4 modelMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec3 vWorldPosition;\n	float w0( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n	}\n	float w1( float a ) {\n		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n	}\n	float w2( float a ){\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n	}\n	float w3( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * a * a );\n	}\n	float g0( float a ) {\n		return w0( a ) + w1( a );\n	}\n	float g1( float a ) {\n		return w2( a ) + w3( a );\n	}\n	float h0( float a ) {\n		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n	}\n	float h1( float a ) {\n		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n	}\n	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n		uv = uv * texelSize.zw + 0.5;\n		vec2 iuv = floor( uv );\n		vec2 fuv = fract( uv );\n		float g0x = g0( fuv.x );\n		float g1x = g1( fuv.x );\n		float h0x = h0( fuv.x );\n		float h1x = h1( fuv.x );\n		float h0y = h0( fuv.y );\n		float h1y = h1( fuv.y );\n		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n	}\n	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n		vec2 fLodSizeInv = 1.0 / fLodSize;\n		vec2 cLodSizeInv = 1.0 / cLodSize;\n		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n		return mix( fSample, cSample, fract( lod ) );\n	}\n	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n		vec3 modelScale;\n		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n		return normalize( refractionVector ) * thickness * modelScale;\n	}\n	float applyIorToRoughness( const in float roughness, const in float ior ) {\n		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n	}\n	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n	}\n	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n		if ( isinf( attenuationDistance ) ) {\n			return vec3( 1.0 );\n		} else {\n			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;\n		}\n	}\n	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n		const in vec3 attenuationColor, const in float attenuationDistance ) {\n		vec4 transmittedLight;\n		vec3 transmittance;\n		#ifdef USE_DISPERSION\n			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n			for ( int i = 0; i < 3; i ++ ) {\n				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n				vec3 refractedRayExit = position + transmissionRay;\n				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n				vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n				refractionCoords += 1.0;\n				refractionCoords /= 2.0;\n				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n				transmittedLight[ i ] = transmissionSample[ i ];\n				transmittedLight.a += transmissionSample.a;\n				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n			}\n			transmittedLight.a /= 3.0;\n		#else\n			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n			vec3 refractedRayExit = position + transmissionRay;\n			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n			vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n			refractionCoords += 1.0;\n			refractionCoords /= 2.0;\n			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n		#endif\n		vec3 attenuatedColor = transmittance * transmittedLight.rgb;\n		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n	}\n#endif";
./node_modules/.vite/deps/chunk-O4OP6BTO.js:    const environmentBlendMode = renderer.xr.getEnvironmentBlendMode();
./node_modules/.vite/deps/chunk-O4OP6BTO.js:    this.getEnvironmentBlendMode = function() {
./node_modules/.vite/deps/chunk-TWYA6I3I.js:      function isConcurrentActEnvironment() {
./node_modules/.vite/deps/chunk-TWYA6I3I.js:        var isReactActEnvironmentGlobal = "undefined" !== typeof IS_REACT_ACT_ENVIRONMENT ? IS_REACT_ACT_ENVIRONMENT : void 0;
./node_modules/.vite/deps/chunk-TWYA6I3I.js:        isReactActEnvironmentGlobal || null === ReactSharedInternals.actQueue || console.error(
./node_modules/.vite/deps/chunk-TWYA6I3I.js:        return isReactActEnvironmentGlobal;
./node_modules/.vite/deps/chunk-TWYA6I3I.js:        isConcurrentActEnvironment() && null === ReactSharedInternals.actQueue && console.error(
./node_modules/.vite/deps/chunk-TWYA6I3I.js:        isConcurrentActEnvironment() && null === ReactSharedInternals.actQueue && runWithFiberInDEV(fiber, function() {
./node_modules/.vite/deps/chunk-NNIN4GSL.js:      function isConcurrentActEnvironment() {
./node_modules/.vite/deps/chunk-NNIN4GSL.js:        var isReactActEnvironmentGlobal = "undefined" !== typeof IS_REACT_ACT_ENVIRONMENT ? IS_REACT_ACT_ENVIRONMENT : void 0;
./node_modules/.vite/deps/chunk-NNIN4GSL.js:        isReactActEnvironmentGlobal || null === ReactSharedInternals.actQueue || console.error(
./node_modules/.vite/deps/chunk-NNIN4GSL.js:        return isReactActEnvironmentGlobal;
./node_modules/.vite/deps/chunk-NNIN4GSL.js:        isConcurrentActEnvironment() && null === ReactSharedInternals.actQueue && console.error(
./node_modules/.vite/deps/chunk-NNIN4GSL.js:        isConcurrentActEnvironment() && null === ReactSharedInternals.actQueue && runWithFiberInDEV(fiber, function() {
./node_modules/.vite/deps/@react-three_drei.js:            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
./node_modules/.vite/deps/@react-three_drei.js:// node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js
./node_modules/.vite/deps/@react-three_drei.js:// node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/useEnvironment.js
./node_modules/.vite/deps/@react-three_drei.js:function useEnvironment({
./node_modules/.vite/deps/@react-three_drei.js:  if (!loader2) throw new Error("useEnvironment: Unrecognized file extension: " + files);
./node_modules/.vite/deps/@react-three_drei.js:useEnvironment.preload = (preloadOptions) => {
./node_modules/.vite/deps/@react-three_drei.js:    throw new Error("useEnvironment: Preloading gainmaps is not supported");
./node_modules/.vite/deps/@react-three_drei.js:  if (!loader2) throw new Error("useEnvironment: Unrecognized file extension: " + files);
./node_modules/.vite/deps/@react-three_drei.js:useEnvironment.clear = (clearOptions) => {
./node_modules/.vite/deps/@react-three_drei.js:  if (!loader2) throw new Error("useEnvironment: Unrecognized file extension: " + files);
./node_modules/.vite/deps/@react-three_drei.js:// node_modules/.pnpm/@react-three+drei@10.7.6_@react-three+fiber@9.3.0_@types+react@19.1.13_@types+three@0.180.0_r_ey5bxf4i2rhjikmyp4rzfrlxhy/node_modules/@react-three/drei/core/Environment.js
./node_modules/.vite/deps/@react-three_drei.js:function EnvironmentMap({
./node_modules/.vite/deps/@react-three_drei.js:function EnvironmentCube({
./node_modules/.vite/deps/@react-three_drei.js:  const texture = useEnvironment(rest);
./node_modules/.vite/deps/@react-three_drei.js:function EnvironmentPortal({
./node_modules/.vite/deps/@react-three_drei.js:  }), files || preset ? React100.createElement(EnvironmentCube, {
./node_modules/.vite/deps/@react-three_drei.js:  }) : map2 ? React100.createElement(EnvironmentMap, {
./node_modules/.vite/deps/@react-three_drei.js:function EnvironmentGround(props) {
./node_modules/.vite/deps/@react-three_drei.js:  const textureDefault = useEnvironment(props);
./node_modules/.vite/deps/@react-three_drei.js:  return React100.createElement(React100.Fragment, null, React100.createElement(EnvironmentMap, _extends({}, props, {
./node_modules/.vite/deps/@react-three_drei.js:function Environment(props) {
./node_modules/.vite/deps/@react-three_drei.js:  return props.ground ? React100.createElement(EnvironmentGround, props) : props.map ? React100.createElement(EnvironmentMap, props) : props.children ? React100.createElement(EnvironmentPortal, props) : React100.createElement(EnvironmentCube, props);
./node_modules/.vite/deps/@react-three_drei.js:  }))), environment && React103.createElement(Environment, environmentProps));
./node_modules/.vite/deps/@react-three_drei.js:  Environment,
./node_modules/.vite/deps/@react-three_drei.js:  EnvironmentCube,
./node_modules/.vite/deps/@react-three_drei.js:  EnvironmentMap,
./node_modules/.vite/deps/@react-three_drei.js:  EnvironmentPortal,
./node_modules/.vite/deps/@react-three_drei.js:  useEnvironment,
./src/components/Engine3DVisualization.tsx:import { OrbitControls, Environment, ContactShadows, Html } from '@react-three/drei';
./src/components/Engine3DVisualization.tsx:          <Environment preset="hangar" />
$ cd /workspace/shadcn-ui

$ npm run build


> build
> vite build

vite v5.4.20 building for production...
transforming...
✓ 3103 modules transformed.
rendering chunks...
computing gzip size...
dist/index.html                     1.01 kB │ gzip:   0.52 kB
dist/assets/index-CMmFfDSv.css     66.12 kB │ gzip:  11.43 kB
dist/assets/index-DupC0Uws.js   1,831.78 kB │ gzip: 514.88 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 14.61s
npm notice 
npm notice New major version of npm available! 10.2.4 -> 11.6.0
npm notice Changelog: <https://github.com/npm/cli/releases/tag/v11.6.0>
npm notice Run `npm install -g npm@11.6.0` to update!
npm notice 
